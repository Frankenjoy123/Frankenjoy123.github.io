<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[WebÂçèËÆÆËØ¶Ëß£‰∏éÊäìÂåÖÂÆûÊàò]]></title>
    <url>%2F2019%2F09%2F11%2FWeb%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3%E4%B8%8E%E6%8A%93%E5%8C%85%E5%AE%9E%E6%88%98%2F</url>
    <content type="text"><![CDATA[ÂèÇËÄÉ https://github.com/Frankenjoy123/geektime-webprotocol ÊûÅÂÆ¢Êó∂Èó¥„ÄäWebÂçèËÆÆËØ¶Ëß£‰∏éÊäìÂåÖÂÆûÊàò„ÄãËØæÁ®ã HTTP/1.1ÂçèËÆÆABNFËåÉÂºè Á©∫ÁôΩÂ≠óÁ¨¶ÔºöÁî®Êù•ÂàÜÈöîÂÆö‰πâ‰∏≠ÁöÑÂêÑ‰∏™ÂÖÉÁ¥† method SP request-target SP HTTP-version CRLF ÈÄâÊã© /ÔºöË°®Á§∫Â§ö‰∏™ËßÑÂàôÈÉΩÊòØÂèØ‰æõÈÄâÊã©ÁöÑËßÑÂàô start-line = request-line / status-line ÂÄºËåÉÂõ¥ %c##-## Ôºö OCTAL = ‚Äú0‚Äù / ‚Äú1‚Äù / ‚Äú2‚Äù / ‚Äú3‚Äù / ‚Äú4‚Äù / ‚Äú5‚Äù / ‚Äú6‚Äù / ‚Äú7‚Äù ‰∏é OCTAL = %x30-37 Á≠â‰ª∑ Â∫èÂàóÁªÑÂêà ()ÔºöÂ∞ÜËßÑÂàôÁªÑÂêàËµ∑Êù•ÔºåËßÜ‰∏∫Âçï‰∏™ÂÖÉÁ¥† ‰∏çÂÆöÈáèÈáçÂ§ç m*nÔºö * ÂÖÉÁ¥†Ë°®Á§∫Èõ∂‰∏™ÊàñÊõ¥Â§öÂÖÉÁ¥†Ôºö*( header-field CRLF ) 1*ÂÖÉÁ¥†Ë°®Á§∫‰∏Ä‰∏™ÊàñÊõ¥Â§öÂÖÉÁ¥†Ôºå2*4 ÂÖÉÁ¥†Ë°®Á§∫‰∏§‰∏™Ëá≥Âõõ‰∏™ÂÖÉÁ¥† ÂèØÈÄâÂ∫èÂàó []Ôºö [ message-body ] Áü≠ËøûÊé•‰∏éÈïøËøûÊé• Connection Â§¥ÈÉ® Keep-AliveÔºöÈïøËøûÊé• ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÈïøËøûÊé• Connection: Keep-Alive ÊúçÂä°Âô®Ë°®Á§∫ÊîØÊåÅÈïøËøûÊé• Connection: Keep-Alive‚Ä¢ ÂÆ¢Êà∑Á´ØÂ§çÁî®ËøûÊé• HTTP/1.1 ÈªòËÆ§ÊîØÊåÅÈïøËøûÊé• Connection: Keep-Alive Êó†ÊÑè‰πâ CloseÔºöÁü≠ËøûÊé• ÂØπ‰ª£ÁêÜÊúçÂä°Âô®ÁöÑË¶ÅÊ±Ç ‰∏çËΩ¨Âèë Connection ÂàóÂá∫Â§¥ÈÉ®ÔºåËØ•Â§¥ÈÉ®‰ªÖ‰∏éÂΩìÂâçËøûÊé•Áõ∏ÂÖ≥]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DubboÊ∫êÁ†ÅÂàÜÊûê‚Äî‚ÄîNIO-ÊúçÂä°Âô®Ôºà‰∏ÄÔºâ‰πãÊäΩË±°API]]></title>
    <url>%2F2019%2F08%2F23%2FDubbo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94NIO-%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88%E4%B8%80%EF%BC%89%E4%B9%8B%E6%8A%BD%E8%B1%A1API%2F</url>
    <content type="text"><![CDATA[1. Ê¶ÇËø∞‰ªéÊú¨Â∞èËäÇÂºÄÂßãÔºåÊàë‰ª¨Êù•ÂàÜ‰∫´ Dubbo Ëá™Â∑±ÂÆûÁé∞ÁöÑ NIO ÊúçÂä°Âô®Ôºå‰ΩøÁî®Âú® dubbo:// Âíå thrift:// ÂçèËÆÆ‰∏ä„ÄÇ Âú® NIO Ê°ÜÊû∂ÁöÑÈÄâÂûã‰∏äÔºåÂº∫Â§ßÁöÑ Java Á§æÂå∫ÈáåÊúâ mina„ÄÅnetty„ÄÅgrizzly Á≠âÔºåÁîöËá≥ netty Êèê‰æõ‰∫Ü 3.x Âíå 4.x ÁöÑÁâàÊú¨„ÄÇÈÇ£‰πàËØ•ÂíãÂäûÂë¢Ôºü Dubbo ÂºÄÂèëÂõ¢ÈòüÁöÑÈÄâÊã©ÊòØÔºö API Â±ÇÔºö dubbo-remoting-api ÂÆûÁé∞Â±ÇÔºö dubbo-remoting-netty3 dubbo-remoting-netty4 dubbo-remoting-mina dubbo-remoting-grizzly dubbo-remoting-p2p ÂÜçÈÖçÂêà‰∏ä Dubbo SPI ÁöÑÊú∫Âà∂Ôºå‰ΩøÁî®ËÄÖÂèØ‰ª•Ëá™ÂÆö‰πâ‰ΩøÁî®Âì™‰∏ÄÁßçÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇ 2. ‰∏ÄËßàËøòÊòØËÄÅÊ†∑Â≠êÔºåÁ¨îËÄÖ‰π†ÊÉØÊÄßÂØπ‰ª£Á†ÅÈáèËøõË°å‰∏ãÁªüËÆ°Ôºådubbo-remoting ÁöÑ‰ª£Á†ÅÈáèÂ¶Ç‰∏ãÂõæÔºö dubbo-remoting-api ÁöÑ‰ª£Á†ÅÈáèÁ´üÁÑ∂Ëøë‰∏áË°åÔºü Êàë‰ª¨Êù•È¶ñÂÖàÁúã‰∏ÄÂº†ÂõæÔºö FROM „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Ê°ÜÊû∂ËÆæËÆ°„Äã Á∫¢Ê°ÜÈÉ®ÂàÜÔºåProtocol =&gt; Exchange =&gt; Transport =&gt; Serialize ÁöÑË∞ÉÁî®È°∫Â∫è„ÄÇ exchange ‰ø°ÊÅØ‰∫§Êç¢Â±ÇÔºöÂ∞ÅË£ÖËØ∑Ê±ÇÂìçÂ∫îÊ®°ÂºèÔºåÂêåÊ≠•ËΩ¨ÂºÇÊ≠•Ôºå‰ª• Request, Response ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Exchanger, ExchangeChannel, ExchangeClient, ExchangeServer„ÄÇ transport ÁΩëÁªú‰º†ËæìÂ±ÇÔºöÊäΩË±° mina Âíå netty ‰∏∫Áªü‰∏ÄÊé•Âè£Ôºå‰ª• Message ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Channel, Transporter, Client, Server, Codec serialize Êï∞ÊçÆÂ∫èÂàóÂåñÂ±ÇÔºöÂèØÂ§çÁî®ÁöÑ‰∏Ä‰∫õÂ∑•ÂÖ∑ÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Serialization, ObjectInput, ObjectOutput, ThreadPool Âú®Á¨îËÄÖÂàùÁúã dubbo-remoting-api ÁöÑ‰ª£Á†ÅÊó∂ÔºåÂØπ exchange Âíå transport ÁöÑÁêÜËß£ÊòØÊØîËæÉÊ®°Á≥äÁöÑ„ÄÇÁÆÄÂçïÊù•ËØ¥Ôºåexchange Âú® transport ‰πã‰∏äÔºåÊûÑÈÄ†‰∫Ü RequestÔºåResponse Ê®°ÂûãÔºå‰∏Ä‰∏™ËØ∑Ê±ÇÂØπÂ∫î‰∏Ä‰∏™ÂìçÂ∫î„ÄÇËøôÊ†∑ÁöÑÊñπÂºèÔºåÊâçÁ¨¶ÂêàÊàë‰ª¨ÂÆûÈôÖ‰∏öÂä°ÂºÄÂèëÁöÑÈúÄË¶Å„ÄÇÂΩìÁÑ∂ÔºåÂç≥‰ΩøÊòØ RequestÔºåResponse ‰πüÂàÜÊàêÂêåÊ≠•ÂíåÂºÇÊ≠•ËøîÂõûÔºåÈáçË¶ÅÁöÑÊòØÔºåËÉΩÂ§ü‰∏Ä‰∏ÄÊò†Â∞Ñ„ÄÇ Â¶ÇÊûúÊúâÂÖ¥Ë∂£ÔºåÂèØ‰ª•ÁúãÁúãÔºö „ÄäRequest‚Äìresponse„Äã „ÄäClient‚Äìserver model„Äã ÁúãÂÆå‰ª•‰∏äÁü•ËØÜÔºåÊàë‰ª¨Âú®ÂõûËøáÂ§¥Áúã dubbo-remoting-api ÁöÑÈ°πÁõÆÁªìÊûÑÂ∞±Ê∏ÖÊô∞‰∫ÜÔºö ÊúÄÂ§ñÂ±ÇÔºöÈÄöÁî®Êé•Âè£„ÄÇ buffer ÂåÖÔºöÁºìÂÜ≤Âå∫„ÄÇ exchange ÂåÖÔºö‰ø°ÊÅØ‰∫§Êç¢Â±Ç transporter ÂåÖÔºöÁΩëÁªú‰º†ËæìÂ±Ç telnet ÂåÖÔºöTelnet ÂëΩ‰ª§ Â¶Ç‰∏äÁöÑÊØè‰∏ÄÂ±Ç/ÂåÖÔºåÊàë‰ª¨ÈÉΩ‰ºöÁã¨Á´ã‰∏ÄÁØáÊñáÁ´†ÔºåËøõË°åÂàÜ‰∫´„ÄÇÂΩìÁÑ∂Ôºådubbo-remoting-api Ê®°ÂùóÔºåÂè™Ë¥üË¥£ API Â±ÇÊäΩË±°ÂíåÈÉ®ÂàÜÂÆûÁé∞ÔºåÊúÄÁªàËÉΩÂ§üÁúüÊ≠£ÈÄö‰ø°ÔºåÈúÄË¶Å dubbo-remoting-netty Á≠âÁ≠âÊ®°ÂùóÊù•ÂÆûÁé∞„ÄÇÂØπÂ∫îÁöÑÊØè‰∏Ä‰∏™ÂÆûÁé∞Ê®°ÂùóÔºåÊàë‰ª¨‰πüÊòØÁã¨Á´ã‰∏ÄÁØáÊñáÁ´†„ÄÇ üôÇ ÊòØ‰∏çÊòØÂæàÊ∏ÖÊô∞ÔºåÁæéÊªãÊªãÔºü 3. ÊúÄÂ§ñÂ±ÇÔºöÈÄöÁî®Êé•Âè£ÂÖàÁúãÁúã „ÄäNetty4.0Â≠¶‰π†Á¨îËÆ∞Á≥ªÂàó‰πã‰∏ÄÔºöServer‰∏éClientÁöÑÈÄöËÆØ„Äã ÊïôÁ®ãÊñáÁ´†„ÄÇÂú®ËØ•ÊñáÁ´†‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ΩøÁî® Netty Âú®Âõõ‰∏™Á±ªÔºö 1„ÄÅHelloServer ÔºöserverÁ±ªÔºåÂêØÂä®Netty server 2„ÄÅHelloServerInHandlerÔºöserverÁöÑhandlerÔºåÊé•Êî∂ÂÆ¢Êà∑Á´ØÊ∂àÊÅØÔºåÂπ∂ÂêëÂÆ¢Êà∑Á´ØÂèëÈÄÅÊ∂àÊÅØ 3„ÄÅHelloClientÔºöclientÁ±ªÔºåÂª∫Á´ã‰∫éNetty serverÁöÑËøûÊé• 4„ÄÅHelloClientIntHandlerÔºöclientÁöÑhandlerÔºåÊé•Êî∂serverÁ´ØÁöÑÊ∂àÊÅØÔºåÂπ∂ÂêëÊúçÂä°Á´ØÂèëÈÄÅÊ∂àÊÅØ ÊÅ∞Â•ΩÔºåÂíå dubbo-remoting-api Ê®°ÂùóÔºåÂÆö‰πâÁöÑ Server„ÄÅClient„ÄÅChannelHandler Êé•Âè£ÂØπÂ∫î„ÄÇÊàë‰ª¨‰ª• dubbo-remoting-netty4 Ê®°ÂùóÁöÑÔºå‰∏æ‰æãÂ≠ê„ÄÇÊï¥ÁêÜÂ¶Ç‰∏ãÔºö ‰∏äÊñá dubbo-remoting-api dubbo-remoting-netty4 HelloServer Server Êé•Âè£ NettyServer ÂÆûÁé∞Á±ª HelloServerInHandlerÔºöserver ChannelHandler Êé•Âè£ NettyServerHandler ÂÆûÁé∞Á±ª HelloClient Client Êé•Âè£ NettyClient ÂÆûÁé∞Á±ª HelloServerInHandler ChannelHandler Êé•Âè£ NettyClientHandler ÂÆûÁé∞Á±ª Âõ†‰∏∫ÊïôÁ®ãÊñáÁ´†Ôºå‰ª•ÊïôÁ®ã Demo ‰∏∫ÂáÜÔºåÂÆûÈôÖ‰ºöÊúâÊõ¥Â§öÈúÄË¶ÅÊäΩË±°ÁöÑÔºå‰æãÂ¶ÇÔºöCodec ÂçèËÆÆÁºñËß£Á†ÅÔºåDispatcher Ê∂àÊÅØÁ≠âÂàÜÂèë„ÄÇÂÜçÊù•ÁúãÁúã dubbo:// ÁöÑÂ§ÑÁêÜÊµÅÁ®ãÔºö FROM „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo://„Äã Transporter: mina, netty, grizzy Serialization: dubbo, hessian2, java, json Dispatcher: all, direct, message, execution, connection ThreadPool: fixed, cached Â¶ÇÊûúËøô‰∏™ÂõæËØª‰∏çÊáÇÔºåÊ≤°ÂÖ≥Á≥ªÔºå‰∏ãÈù¢Êàë‰ª¨Êù•ÁúãÁúãÊØè‰∏™Êé•Âè£„ÄÇÂêéÈù¢ÔºåÂèØ‰ª•ÂõûËøáÂ§¥Êù•ÁêÜËß£Ëøô‰∏™Âõæ„ÄÇ Êú¨ÊñáÊ∂âÂèäÁöÑÁ±ªÂõæÂ¶Ç‰∏ãÔºö 4. Endpointcom.alibaba.dubbo.remoting.Endpoint ÔºåÁ´ØÁÇπÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö Â±ûÊÄßÁõ∏ÂÖ≥ 12345URL getUrl();InetSocketAddress getLocalAddress();ChannelHandler getChannelHandler(); ÂèëÈÄÅÊ∂àÊÅØ 12void send(Object message) throws RemotingException;void send(Object message, boolean sent) throws RemotingException; ÂÖ≥Á≥ªÁõ∏ÂÖ≥ 123456void close();void close(int timeout);void startClose();boolean isClosed(); Endpoint Ôºå‰ªé‰∏≠Êñá‰∏äËß£ÈáäÊù•ËØ¥ÊòØÔºå‚ÄúÁ´ØÁÇπ‚Äù„ÄÇ‰ªéÂ≠óÈù¢‰∏äÊù•ÁúãÔºå‰∏çÂ§™ÂÆπÊòìÁêÜËß£„ÄÇÂú® dubbo-remoting-api ‰∏≠Ôºå‰∏Ä‰∏™ Client Êàñ Server ÔºåÈÉΩÊòØ‰∏Ä‰∏™ Endpoint „ÄÇ‰∏çÂêåÁ≥ªÁªüÁöÑÔºåEndpoint ‰ª£Ë°®ÁöÑ‰ºöÁï•ÊúâÂ∑ÆË∑ùÔºå‰æãÂ¶Ç SpringMVC ‰∏≠Ôºå‰∏Ä‰∏™ËØ∑Ê±Ç Restful URL ‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™ Endpoint ÔºåÂèØ‰ª• Google Êü•ËØ¢ÔºåÁêÜËß£Êõ¥Â§ö„ÄÇ 4.1 Channelcom.alibaba.dubbo.remoting.Channel ÔºåÁªßÊâø Endpoint Êé•Âè£ÔºåÈÄöÈÅìÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö ËøûÊé•Áõ∏ÂÖ≥ 12InetSocketAddress getRemoteAddress();boolean isConnected(); Â±ûÊÄßÁõ∏ÂÖ≥ 1234boolean hasAttribute(String key);Object getAttribute(String key);void setAttribute(String key, Object value);void removeAttribute(String key); Âíå Netty Channel ‰∏ÄËá¥ÔºåÈÄöËÆØÁöÑËΩΩ‰Ωì„ÄÇÂú®ÂêéÈù¢ÁöÑÊñáÁ´†ÔºåÊàë‰ª¨‰ºöÁúãÂà∞Âú® dubbo-remoting-netty4 È°πÁõÆ‰∏≠ÔºåNettyChannel ÊòØ Dubbo Channel ÁöÑÂÆûÁé∞ÔºåÂÜÖÈÉ®ÊúâÁúüÊ≠£ÁöÑ Netty Channel Â±ûÊÄßÔºåÁî®‰∫éÈÄöËÆØ„ÄÇ 4.2 Clientcom.alibaba.dubbo.remoting.Client ÔºåÂÆûÁé∞ Endpoint Âíå Channel Âíå Resetable Êé•Âè£ÔºåÂÆ¢Êà∑Á´ØÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12// ÈáçËøûvoid reconnect() throws RemotingException; 4.3 Servercom.alibaba.dubbo.remoting.Server ÔºåÁªßÊâø Endpoint Âíå Resetable Êé•Âè£ÔºåÊúçÂä°Âô®Êé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 123456// ÊòØÂê¶ÁªëÂÆöÊú¨Âú∞Á´ØÂè£ÔºåÊèê‰æõÊúçÂä°„ÄÇÂç≥ÔºåÊòØÂê¶ÂêØÂä®ÊàêÂäüÔºåÂèØËøûÊé•ÔºåÊé•Êî∂Ê∂àÊÅØÁ≠â„ÄÇboolean isBound();// Ëé∑ÂæóËøûÊé•‰∏äÊúçÂä°Âô®ÁöÑÈÄöÈÅìÔºàÂÆ¢Êà∑Á´ØÔºâ‰ª¨Collection&lt;Channel&gt; getChannels();Channel getChannel(InetSocketAddress remoteAddress); 4.3.1 Resetablecom.alibaba.dubbo.common.Resetable ÔºåÂèØÈáçÁΩÆÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1void reset(URL url); Server ÂÆûÁé∞ Resetable Êé•Âè£ÔºåÂú®ÂÆûÁé∞ #reset(url) ÊñπÊ≥ïÔºåÁî®‰∫éÊ†πÊçÆÊñ∞‰º†ÂÖ•ÁöÑ url Â±ûÊÄßÔºåÈáçÁΩÆËá™Â∑±ÂÜÖÈÉ®ÁöÑ‰∏Ä‰∫õÂ±ûÊÄßÔºå‰æãÂ¶Ç AbstractServer#reset(url) ÊñπÊ≥ï„ÄÇ 5. ChannelHandlercom.alibaba.dubbo.remoting.ChannelHandler ÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®Êé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567void connected(Channel channel) throws RemotingException;void disconnected(Channel channel) throws RemotingException;void sent(Channel channel, Object message) throws RemotingException;void received(Channel channel, Object message) throws RemotingException;void caught(Channel channel, Throwable exception) throws RemotingException; Âíå Netty ChannelHandler ‰∏ÄËá¥ÔºåË¥üË¥£ Channel ‰∏≠ÁöÑÈÄªËæëÂ§ÑÁêÜ„ÄÇÂú®ÂêéÈù¢ÁöÑÊñáÁ´†ÔºåÊàë‰ª¨‰ºöÁúãÂà∞Âú® dubbo-remoting-netty4 È°πÁõÆ‰∏≠ÔºåNettyServerHandler ÊòØ Netty ChannelHandler ÁöÑÂÆûÁé∞ÔºåÂÜÖÈÉ®Ë∞ÉÁî® Netty ChannelHandler ÁöÑÊñπÊ≥ïÔºåËøõË°åÈÄªËæëÂ§ÑÁêÜ„ÄÇ 6. Transportercom.alibaba.dubbo.remoting.Transporter ÔºåÁΩëÁªú‰º†ËæìÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132@SPI("netty")public interface Transporter &#123; /** * Bind a server. * * ÁªëÂÆö‰∏Ä‰∏™ÊúçÂä°Âô® * * @param url server url * @param handler ÈÄöÈÅìÂ§ÑÁêÜÂô® * @return server ÊúçÂä°Âô® * @throws RemotingException ÂΩìÁªëÂÆöÂèëÁîüÂºÇÂ∏∏Êó∂ * @see com.alibaba.dubbo.remoting.Transporters#bind(URL, Receiver, ChannelHandler) */ @Adaptive(&#123;Constants.SERVER_KEY, Constants.TRANSPORTER_KEY&#125;) Server bind(URL url, ChannelHandler handler) throws RemotingException; /** * Connect to a server. * * ËøûÊé•‰∏Ä‰∏™ÊúçÂä°Âô®ÔºåÂç≥ÂàõÂª∫‰∏Ä‰∏™ÂÆ¢Êà∑Á´Ø * * @param url server url ÊúçÂä°Âô®Âú∞ÂùÄ * @param handler ÈÄöÈÅìÂ§ÑÁêÜÂô® * @return client ÂÆ¢Êà∑Á´Ø * @throws RemotingException ÂΩìËøûÊé•ÂèëÁîüÂºÇÂ∏∏Êó∂ * @see com.alibaba.dubbo.remoting.Transporters#connect(URL, Receiver, ChannelListener) */ @Adaptive(&#123;Constants.CLIENT_KEY, Constants.TRANSPORTER_KEY&#125;) Client connect(URL url, ChannelHandler handler) throws RemotingException;&#125; @SPI(&quot;netty&quot;) Ê≥®Ëß£ÔºåDubbo SPI ÊãìÂ±ïÁÇπÔºåÈªòËÆ§‰∏∫ &quot;netty&quot; „ÄÇÊ≥®ÊÑèÔºåÊ≠§Â§ÑÁöÑ netty ÂØπÂ∫îÁöÑÊòØ netty3 ÔºåÂõ†‰∏∫ Dubbo È°πÁõÆÂú®ÂºÄÂèëÊó∂Ôºånetty4 Âπ∂Êú™ÂèëÂ∏É„ÄÇÈÖçÁΩÆÊñπÂºèËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Netty4„Äã ÊñáÊ°£„ÄÇ @Adaptive({Constants.SERVER_KEY, Constants.TRANSPORTER_KEY}) Ê≥®Ëß£ÔºåÂü∫‰∫é Dubbo SPI Adaptive Êú∫Âà∂ÔºåÂä†ËΩΩÂØπÂ∫îÁöÑ Server ÂÆûÁé∞Ôºå‰ΩøÁî® URL.server Êàñ URL.transporter Â±ûÊÄß„ÄÇ @Adaptive({Constants.CLIENT_KEY, Constants.TRANSPORTER_KEY}) Ê≥®Ëß£ÔºåÂü∫‰∫é Dubbo SPI Adaptive Êú∫Âà∂ÔºåÂä†ËΩΩÂØπÂ∫îÁöÑ Client ÂÆûÁé∞Ôºå‰ΩøÁî® URL.client Êàñ URL.transporter Â±ûÊÄß„ÄÇ 6.1 Transporterscom.alibaba.dubbo.remoting.Transporters ÔºåTransporter Èó®Èù¢Á±ª„ÄÇ ÂèãÊÉÖÊèêÁ§∫ÔºöFacade ËÆæËÆ°Ê®°ÂºèÔºåÂèÇËßÅ „Ää ËÆæËÆ°Ê®°ÂºèÔºà‰πùÔºâÂ§ñËßÇÊ®°ÂºèFacadeÔºàÁªìÊûÑÂûãÔºâ„Äã ÊñáÁ´†„ÄÇ #bind(String url, ChannelHandler... handler) ÈùôÊÄÅÊñπÊ≥ïÔºåÁªëÂÆö‰∏Ä‰∏™ÊúçÂä°Âô®„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021 1: public static Server bind(String url, ChannelHandler... handler) throws RemotingException &#123; 2: return bind(URL.valueOf(url), handler); 3: &#125; 4: 5: public static Server bind(URL url, ChannelHandler... handlers) throws RemotingException &#123; 6: if (url == null) &#123; 7: throw new IllegalArgumentException("url == null"); 8: &#125; 9: if (handlers == null || handlers.length == 0) &#123;10: throw new IllegalArgumentException("handlers == null");11: &#125;12: // ÂàõÂª∫ handler13: ChannelHandler handler;14: if (handlers.length == 1) &#123;15: handler = handlers[0];16: &#125; else &#123;17: handler = new ChannelHandlerDispatcher(handlers);18: &#125;19: // ÂàõÂª∫ Server ÂØπË±°20: return getTransporter().bind(url, handler);21: &#125; Âíå Transporter#bind(url, handler) ÊñπÊ≥ïÔºåÂØπÂ∫î„ÄÇ Á¨¨ 12 Ëá≥ 18 Ë°åÔºöÂàõÂª∫ handler „ÄÇËã• handlers ÊòØÂ§ö‰∏™Ôºå‰ΩøÁî® ChannelHandlerDispatcher ËøõË°åÂ∞ÅË£Ö„ÄÇÂú® ChannelHandlerDispatcher ‰∏≠Ôºå‰ºöÂæ™ÁéØË∞ÉÁî® handlers ÔºåÂØπÂ∫îÁöÑÊñπÊ≥ï„ÄÇ Á¨¨ 20 Ë°åÔºöË∞ÉÁî® #getTransporter() ÊñπÊ≥ïÔºåÂü∫‰∫é Dubbo SPI Êú∫Âà∂ÔºåËé∑Âæó Transporter$Adaptive ÂØπË±°„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123public static Transporter getTransporter() &#123; return ExtensionLoader.getExtensionLoader(Transporter.class).getAdaptiveExtension();&#125; Á¨¨ 20 Ë°åÔºöË∞ÉÁî® Transporter#bind(url, handler) ÊñπÊ≥ïÔºåÂú® Transporter$Adaptive ÂØπË±°‰∏≠Ôºå‰ºöÊ†πÊçÆ url ÂèÇÊï∞ÔºåËé∑ÂæóÂØπÂ∫îÁöÑ Transporter ÂÆûÁé∞ÂØπË±°Ôºà‰æãÂ¶ÇÔºå NettyTransporterÔºâÔºå‰ªéËÄåÂàõÂª∫ÂØπÂ∫îÁöÑ Server ÂØπË±°Ôºà‰æãÂ¶ÇÔºå NettyServerÔºâ„ÄÇ Âè¶Â§ñÔºåËøòÊúâ‰∏Ä‰∏™ #connect(url, handler) ÈùôÊÄÅÊñπÊ≥ïÔºåËøûÊé•‰∏Ä‰∏™ÊúçÂä°Âô®ÔºåÂç≥ÂàõÂª∫‰∏Ä‰∏™ÂÆ¢Êà∑Á´Ø„ÄÇüôÇ Âíå‰∏äÈù¢ÊñπÊ≥ïÁ±ª‰ººÔºåËá™Â∑±ÁúãÂíØ„ÄÇ 7. Codec2com.alibaba.dubbo.remoting.Codec2 ÔºåÁºñËß£Á†ÅÂô®Êé•Âè£„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021/** * ÁºñÁ†Å * * @param channel ÈÄöÈÅì * @param buffer Buffer * @param message Ê∂àÊÅØ * @throws IOException ÂΩìÁºñÁ†ÅÂèëÁîüÂºÇÂ∏∏Êó∂ */@Adaptive(&#123;Constants.CODEC_KEY&#125;)void encode(Channel channel, ChannelBuffer buffer, Object message) throws IOException;/** * Ëß£Á†Å * * @param channel ÈÄöÈÅì * @param buffer Buffer * @return Ê∂àÊÅØ * @throws IOException ÂΩìËß£Á†ÅÂèëÁîüÂºÇÂ∏∏Êó∂ */@Adaptive(&#123;Constants.CODEC_KEY&#125;)Object decode(Channel channel, ChannelBuffer buffer) throws IOException; @SPI(&quot;netty&quot;) Ê≥®Ëß£ÔºåDubbo SPI ÊãìÂ±ïÁÇπ„ÄÇ @Adaptive({Constants.CODEC_KEY}) Ê≥®Ëß£ÔºåÂü∫‰∫é Dubbo SPI Adaptive Êú∫Âà∂ÔºåÂä†ËΩΩÂØπÂ∫îÁöÑ Codec2 ÂÆûÁé∞Ôºå‰ΩøÁî® URL.codec Â±ûÊÄß„ÄÇ Âè¶Â§ñÔºåËß£Á†ÅËøáÁ®ã‰∏≠ÔºåÈúÄË¶ÅËß£ÂÜ≥ TCP ÊãÜÂåÖ„ÄÅÁ≤òÂåÖÁöÑÂú∫ÊôØÔºåÂõ†Ê≠§Ëß£Á†ÅÁªìÊûúÂ¶Ç‰∏ãÔºö 1234567891011// Codec2.javaenum DecodeResult &#123; /** * ÈúÄË¶ÅÊõ¥Â§öËæìÂÖ• */ NEED_MORE_INPUT, /** * ÂøΩÁï•‰∏Ä‰∫õËæìÂÖ• */ SKIP_SOME_INPUT&#125; ÁõÆÂâç SKIP_SOME_INPUT ÔºåÊöÇÊú™‰ΩøÁî®„ÄÇ ÊÑüÂÖ¥Ë∂£ÁöÑÔºåÂèØ‰ª•ÊèêÂâçÁúã‰∏ã „ÄäÈ´òÊÄßËÉΩÁΩëÁªúÊ°ÜÊû∂NettyÁöÑTCPÊãÜÂåÖ„ÄÅÁ≤òÂåÖËß£ÂÜ≥ÊñπÊ°à„Äã ÊñáÁ´†„ÄÇÂú®ÂêéÁª≠ÁöÑÊñáÁ´†‰∏≠ÔºåÊàë‰ª¨Êó¢‰ºöÁúãÂà∞Âü∫‰∫éÈïøÂ∫¶ÁöÑÊñπÊ°àÔºå‰πü‰ºöÁúãÂà∞Âü∫‰∫éÁïåÂÆöÁ¨¶ÁöÑÊñπÊ°à„ÄÇ 7.1 Codeccom.alibaba.dubbo.remoting.Codec ÔºåËÄÅÁöÑÁºñËß£Á†ÅÂô®Êé•Âè£ÔºåË¢´ Codec2 Âèñ‰ª£„ÄÇ ÈÄöËøá CodecAdapter ÔºåÂ∞Ü Codec ÈÄÇÈÖçÊàê Codec2 „ÄÇ 7.2 Decodeablecom.alibaba.dubbo.remoting.Decodeable ÔºåÂèØËß£Á†ÅÁöÑÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12// Ëß£Á†Åvoid decode() throws Exception; 8. Dispatchercom.alibaba.dubbo.remoting.Dispatcher ÔºåË∞ÉÂ∫¶Âô®Êé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12345678@SPI(AllDispatcher.NAME)public interface Dispatcher &#123; @Adaptive(&#123;Constants.DISPATCHER_KEY, "dispather", "channel.handler"&#125;) // The last two parameters are reserved for compatibility with the old configuration ChannelHandler dispatch(ChannelHandler handler, URL url);&#125; @SPI(AllDispatcher.NAME) Ê≥®Ëß£ÔºåDubbo SPI ÊãìÂ±ïÁÇπÔºåÈªòËÆ§‰∏∫ &quot;all&quot; „ÄÇ @Adaptive({Constants.DISPATCHER_KEY, &quot;dispather&quot;, &quot;channel.handler&quot;}) Ê≥®Ëß£ÔºåÂü∫‰∫é Dubbo SPI Adaptive Êú∫Âà∂ÔºåÂä†ËΩΩÂØπÂ∫îÁöÑ ChanelHander ÂÆûÁé∞Ôºå‰ΩøÁî® URL.dispatcher Â±ûÊÄß„ÄÇ ‰∏∫‰ªÄ‰πà‰º†ÂÖ•ÁöÑ handler ÂèÇÊï∞ÔºåÂàõÂª∫ËøîÂõûÁöÑËøòÊòØ ChannelHandler ÂØπË±°Âë¢ÔºüÊÑüÂÖ¥Ë∂£ÁöÑÔºåÂèØ‰ª•ÊèêÂâçÁúã‰∏ã AllChannelHandler Âíå „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Á∫øÁ®ãÊ®°Âûã„Äã „ÄÇüôÇ ÊñáÁ´†ÔºåÂêéÈù¢ËßÅ„ÄÇ 9. RemotingExceptioncom.alibaba.dubbo.remoting.RemotingException ÔºåÂÆûÁé∞ Exception Á±ªÔºådubbo-remoting-api ÁöÑÂü∫Á°ÄÂºÇÂ∏∏„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213public class RemotingException extends Exception &#123; /** * Êú¨Âú∞Âú∞ÂùÄ */ private InetSocketAddress localAddress; /** * ËøúÁ®ãÂú∞ÂùÄ */ private InetSocketAddress remoteAddress; // ... ÁúÅÁï•ÊñπÊ≥ï&#125; 9.1 ExecutionExceptioncom.alibaba.dubbo.remoting.ExecutionException ÔºåÂÆûÁé∞ RemotingException Á±ªÔºåÊâßË°åÂºÇÂ∏∏„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789public class ExecutionException extends RemotingException &#123; /** * ËØ∑Ê±Ç */ private final Object request; // ... ÁúÅÁï•ÊñπÊ≥ï&#125; 9.2 TimeoutExceptioncom.alibaba.dubbo.remoting.TimeoutException ÔºåÂÆûÁé∞ RemotingException Á±ªÔºåË∂ÖÊó∂ÂºÇÂ∏∏„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718public class TimeoutException extends RemotingException &#123; /** * ÂÆ¢Êà∑Á´Ø */ public static final int CLIENT_SIDE = 0; /** * ÊúçÂä°Á´Ø */ public static final int SERVER_SIDE = 1; /** * Èò∂ÊÆµ */ private final int phase; // ... ÁúÅÁï•ÊñπÊ≥ï&#125; dubbo-remoting-api Ê®°ÂùóÔºåÊ∂âÂèäÂà∞Â§ßÈáèÁöÑÂ∞ÅË£ÖÔºåÂ¶ÇÊûú‰∏çÂ§™ÁêÜËß£ÁöÑÔºåÂª∫ËÆÆÂ§öÂ§öË∞ÉËØï„ÄÇ]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DubboÊ∫êÁ†ÅÂàÜÊûê‚Äî‚ÄîNIO ÊúçÂä°Âô®Ôºà‰∫åÔºâ‰πãTransportÂ±Ç]]></title>
    <url>%2F2019%2F08%2F23%2FDubbo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94NIO-%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88%E4%BA%8C%EF%BC%89%E4%B9%8BTransport%E5%B1%82%2F</url>
    <content type="text"><![CDATA[1. Ê¶ÇËø∞Êú¨ÊñáÊé• „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî NIO ÊúçÂä°Âô®Ôºà‰∏ÄÔºâ‰πãÊäΩË±° API„Äã‰∏ÄÊñáÔºåÂàÜ‰∫´ dubbo-remoting-api Ê®°ÂùóÔºå transportÂåÖÔºåÁΩëÁªú‰º†ËæìÂ±Ç„ÄÇ transport ÁΩëÁªú‰º†ËæìÂ±ÇÔºöÊäΩË±° mina Âíå netty ‰∏∫Áªü‰∏ÄÊé•Âè£Ôºå‰ª• Message ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Channel, Transporter, Client, Server, Codec Ê∂âÂèäÁöÑÁ±ªÂõæÂ¶Ç‰∏ãÔºö ÁôΩËâ≤ÈÉ®ÂàÜÔºå‰∏∫ÈÄöÁî®Êé•Âè£„ÄÇ ËìùËâ≤ÈÉ®ÂàÜÔºå‰∏∫ transport ÂåÖ‰∏ãÁöÑÁ±ª„ÄÇ Êï¥‰∏™Á±ªÂõæÔºåÊàë‰ª¨ÂàÜÊàê ÂÖ≠‰∏™ ÈÉ®ÂàÜÔºö Client Server Channel ChannelHandler Codec Dispacher ‰ªéÊµÅÁ®ã‰∏äÊù•ËØ¥ÔºåÊàë‰ª¨ÂàÜÊàêÔºö Server ÂêØÂä® ÂÖ≥Èó≠ Client ÂêØÂä® ÂÖ≥Èó≠ ChannelHandler Â§ÑÁêÜËøûÊé• Â§ÑÁêÜÊñ≠ÂºÄ ÂèëÈÄÅÊ∂àÊÅØ Êé•Êî∂Ê∂àÊÅØ Â§ÑÁêÜÂºÇÂ∏∏ ËâøËâøÁöÑÊóÅÁôΩÔºöÊ∂âÂèäËæÉÂ§öÁ±ªÂíåÊµÅÁ®ãÔºåÂÜÖÂÆπ‰∏çÊòØÂæàÁ∫øÊÄßÔºåÂèØËÉΩÂàÜ‰∫´ÁöÑÊØîËæÉÂáå‰π±ÔºåËøòÊúõËÉñÂèãË∞ÖËß£„ÄÇÂª∫ËÆÆÔºåËØª 2-3 ÈÅçÔºåÂπ∂‰∏îÂÅö‰∏Ä‰∫õË∞ÉËØï„ÄÇ 2. AbstractPeercom.alibaba.dubbo.remoting.transport.AbstractPeer ÔºåÂÆûÁé∞ Endpoint„ÄÅChannelHandler Êé•Âè£ÔºåPeer ÊäΩË±°Á±ª„ÄÇ ÊûÑÈÄ†ÊñπÊ≥ï 1234567891011121314151617181920212223242526272829303132 1: /** 2: * ÈÄöÈÅìÂ§ÑÁêÜÂô® 3: */ 4: private final ChannelHandler handler; 5: /** 6: * URL 7: */ 8: private volatile URL url; 9: /**10: * Ê≠£Âú®ÂÖ≥Èó≠11: *12: * &#123;@link #startClose()&#125;13: */14: // closing closed means the process is being closed and close is finished15: private volatile boolean closing;16: /**17: * ÂÖ≥Èó≠ÂÆåÊàê18: *19: * &#123;@link #close()&#125;20: */21: private volatile boolean closed;22:23: public AbstractPeer(URL url, ChannelHandler handler) &#123;24: if (url == null) &#123;25: throw new IllegalArgumentException("url == null");26: &#125;27: if (handler == null) &#123;28: throw new IllegalArgumentException("handler == null");29: &#125;30: this.url = url;31: this.handler = handler;32: &#125; 1handler Â±ûÊÄßÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®ÔºåÈÄöËøáÊûÑÈÄ†ÊñπÊ≥ï‰º†ÂÖ•„ÄÇÂÆûÁé∞ÁöÑ ChannelHandler ÁöÑÊé•Âè£ÊñπÊ≥ïÔºåÁõ¥Êé•Ë∞ÉÁî® 1handler ÁöÑÊñπÊ≥ïÔºåËøõË°åÊâßË°åÈÄªËæëÂ§ÑÁêÜ„ÄÇ ÂèÇËßÅ‰ª£Á†ÅÔºö‰º†ÈÄÅÈó® ËøôÁßçÊñπÂºèÂú®ËÆæËÆ°Ê®°Âºè‰∏≠Ë¢´Áß∞‰Ωú ‚ÄúË£ÖÈ•∞Ê®°Âºè‚Äú „ÄÇÂú®‰∏ãÊñá‰∏≠ÔºåÊàë‰ª¨‰ºöÁúãÂà∞Â§ßÈáèÁöÑË£ÖÈ•∞Ê®°ÂºèÁöÑ‰ΩøÁî®„ÄÇÂÆûÈôÖ‰∏äÔºåËøô‰πüÊòØ dubbo-remoting ÊäΩË±° API + ÂÆûÁé∞ÊúÄÊ†∏ÂøÉÁöÑÊñπÂºè‰πã‰∏Ä„ÄÇ url Â±ûÊÄßÔºåURL ÔºåÈÄöËøáÊûÑÈÄ†ÊñπÊ≥ï‰º†ÂÖ•„ÄÇÈÄöËøáËØ•Â±ûÊÄßÔºå‰º†ÈÄí Dubbo ÊúçÂä°ÂºïÁî®ÂíåÊúçÂä°Êö¥Èú≤ÁöÑÈÖçÁΩÆÈ°π„ÄÇ closing Â±ûÊÄßÔºåÊ≠£Âú®ÂÖ≥Èó≠ÔºåË∞ÉÁî® #startClose() ÊñπÊ≥ïÔºåÂèòÊõ¥„ÄÇ close Â±ûÊÄßÔºåÂÖ≥Èó≠ÂÆåÊàêÔºåË∞ÉÁî® #close() ÊñπÊ≥ïÔºåÂèòÊõ¥„ÄÇ ÂèëÈÄÅÊ∂àÊÅØ 1234@Overridepublic void send(Object message) throws RemotingException &#123; send(message, url.getParameter(Constants.SENT_KEY, false));&#125; 1sent ÈÖçÁΩÆÈ°πÔºö true Á≠âÂæÖÊ∂àÊÅØÂèëÂá∫ÔºåÊ∂àÊÅØÂèëÈÄÅÂ§±Ë¥•Â∞ÜÊäõÂá∫ÂºÇÂ∏∏„ÄÇ false ‰∏çÁ≠âÂæÖÊ∂àÊÅØÂèëÂá∫ÔºåÂ∞ÜÊ∂àÊÅØÊîæÂÖ• IO ÈòüÂàóÔºåÂç≥ÂàªËøîÂõû„ÄÇ ËØ¶ÁªÜÂèÇËßÅÔºö„ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂºÇÊ≠•Ë∞ÉÁî®„Äã ÂÖ∂‰ªñÊñπÊ≥ï ËÉñÂèãÁÇπÂáª AbstractPeer ÔºåÂÜçÁúãÁúãÊâÄÊúâÁöÑÊñπÊ≥ï„ÄÇ 2.1 AbstractEndpintcom.alibaba.dubbo.remoting.transport.AbstractPeer.AbstractEndpint ÔºåÂÆûÁé∞ Resetable Êé•Âè£ÔºåÁªßÊâø AbstractPeer ÊäΩË±°Á±ªÔºåÁ´ØÁÇπÊäΩË±°Á±ª„ÄÇ ÊûÑÈÄ†ÊñπÊ≥ï 12345678910111213141516171819 1: /** 2: * ÁºñËß£Á†ÅÂô® 3: */ 4: private Codec2 codec; 5: /** 6: * Ë∂ÖÊó∂Êó∂Èó¥ 7: */ 8: private int timeout; 9: /**10: * ËøûÊé•Ë∂ÖÊó∂Êó∂Èó¥11: */12: private int connectTimeout;13:14: public AbstractEndpoint(URL url, ChannelHandler handler) &#123;15: super(url, handler);16: this.codec = getChannelCodec(url);17: this.timeout = url.getPositiveParameter(Constants.TIMEOUT_KEY, Constants.DEFAULT_TIMEOUT);18: this.connectTimeout = url.getPositiveParameter(Constants.CONNECT_TIMEOUT_KEY, Constants.DEFAULT_CONNECT_TIMEOUT);19: &#125; codec Â±ûÊÄßÔºåÁºñËß£Á†ÅÂô®„ÄÇÂú®ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî® #getChannelCodec(url) ÊñπÊ≥ïÔºåÂü∫‰∫é url ÂèÇÊï∞ÔºåÂä†ËΩΩÂØπÂ∫îÁöÑ Codec ÂÆûÁé∞ÂØπË±°„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456781: protected static Codec2 getChannelCodec(URL url) &#123;2: String codecName = url.getParameter(Constants.CODEC_KEY, "telnet");3: if (ExtensionLoader.getExtensionLoader(Codec2.class).hasExtension(codecName)) &#123; // ‰æãÂ¶ÇÔºåÂú® DubboProtocol ‰∏≠Ôºå‰ºöËé∑Âæó DubboCodec4: return ExtensionLoader.getExtensionLoader(Codec2.class).getExtension(codecName);5: &#125; else &#123;6: return new CodecAdapter(ExtensionLoader.getExtensionLoader(Codec.class).getExtension(codecName));7: &#125;8: &#125; Á¨¨ 3 Ë°åÔºöÂü∫‰∫é Dubbo SPI Êú∫Âà∂ÔºåÂä†ËΩΩÂØπÂ∫îÁöÑ Codec ÂÆûÁé∞ÂØπË±°„ÄÇ‰æãÂ¶ÇÔºåÂú® DubboProtocol ‰∏≠Ôºå‰ºöËé∑Âæó DubboCodec ÂØπË±°„ÄÇ Á¨¨ 6 Ë°åÔºöCodec Êé•Âè£ÔºåÂ∑≤ÁªèÂ∫üÂºÉ‰∫ÜÔºåÁõÆÂâç Dubbo È°πÁõÆÈáåÔºå‰πüÊ≤°ÊúâÂÆÉÁöÑÊãìÂ±ïÂÆûÁé∞„ÄÇ ÈáçÁΩÆÂ±ûÊÄß #reset(url) ÂÆûÁé∞ÊñπÊ≥ïÔºå‰ΩøÁî®Êñ∞ÁöÑ url Â±ûÊÄßÔºåÂèØÈáçÁΩÆ codec timeout connectTimeout Â±ûÊÄß„ÄÇ 3. Client3.1 AbstractClientcom.alibaba.dubbo.remoting.transport.AbstractClient ÔºåÂÆûÁé∞ Client Êé•Âè£ÔºåÁªßÊâø AbstractEndpoint ÊäΩË±°Á±ªÔºåÂÆ¢Êà∑Á´ØÊäΩË±°Á±ªÔºåÈáçÁÇπÂÆûÁé∞‰∫ÜÂÖ¨Áî®ÁöÑÈáçËøûÈÄªËæëÔºåÂêåÊó∂ÊäΩË±°‰∫ÜËøûÊé•Á≠âÊ®°ÊùøÊñπÊ≥ïÔºå‰æõÂ≠êÁ±ªÂÆûÁé∞„ÄÇÊäΩË±°ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567protected abstract void doOpen() throws Throwable;protected abstract void doClose() throws Throwable;protected abstract void doConnect() throws Throwable;protected abstract void doDisConnect() throws Throwable;protected abstract Channel getChannel(); ÊûÑÈÄ†ÊñπÊ≥ï 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970 1: /** 2: * ÈáçËøûÂÆöÊó∂‰ªªÂä°ÊâßË°åÂô® 3: */ 4: private static final ScheduledThreadPoolExecutor reconnectExecutorService = new ScheduledThreadPoolExecutor(2, new NamedThreadFactory("DubboClientReconnectTimer", true)); 5: /** 6: * ÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåËã•Êñ≠ÂºÄÔºåÊòØÂê¶ÈáçËøû 7: */ 8: private final boolean send_reconnect; 9: /**10: * ÈáçËøû warning ÁöÑÈó¥Èöî.(waringÂ§öÂ∞ëÊ¨°‰πãÂêéÔºåwarning‰∏ÄÊ¨°) //for test11: */12: // reconnect warning period. Reconnect warning interval (log warning after how many times) //for test13: private final int reconnect_warning_period;14: /**15: * ÂÖ≥Èó≠Ë∂ÖÊó∂Êó∂Èó¥16: */17: private final long shutdown_timeout;18: /**19: * Á∫øÁ®ãÊ±†20: *21: * Âú®Ë∞ÉÁî® &#123;@link #wrapChannelHandler(URL, ChannelHandler)&#125; Êó∂Ôºå‰ºöË∞ÉÁî® &#123;@link com.alibaba.dubbo.remoting.transport.dispatcher.WrappedChannelHandler&#125; ÂàõÂª∫22: */23: protected volatile ExecutorService executor;24:25: public AbstractClient(URL url, ChannelHandler handler) throws RemotingException &#123;26: super(url, handler);27: // ‰ªé URL ‰∏≠ÔºåËé∑ÂæóÈáçËøûÁõ∏ÂÖ≥ÈÖçÁΩÆÈ°π28: send_reconnect = url.getParameter(Constants.SEND_RECONNECT_KEY, false);29: shutdown_timeout = url.getParameter(Constants.SHUTDOWN_TIMEOUT_KEY, Constants.DEFAULT_SHUTDOWN_TIMEOUT);30: // The default reconnection interval is 2s, 1800 means warning interval is 1 hour.31: reconnect_warning_period = url.getParameter("reconnect.waring.period", 1800);32:33: // ÂàùÂßãÂåñÂÆ¢Êà∑Á´Ø34: try &#123;35: doOpen();36: &#125; catch (Throwable t) &#123;37: close(); // Â§±Ë¥•ÔºåÂàôÂÖ≥Èó≠38: throw new RemotingException(url.toInetSocketAddress(), null,39: "Failed to start " + getClass().getSimpleName() + " " + NetUtils.getLocalAddress()40: + " connect to the server " + getRemoteAddress() + ", cause: " + t.getMessage(), t);41: &#125;42:43: // ËøûÊé•ÊúçÂä°Âô®44: try &#123;45: // connect.46: connect();47: if (logger.isInfoEnabled()) &#123;48: logger.info("Start " + getClass().getSimpleName() + " " + NetUtils.getLocalAddress() + " connect to the server " + getRemoteAddress());49: &#125;50: &#125; catch (RemotingException t) &#123;51: if (url.getParameter(Constants.CHECK_KEY, true)) &#123;52: close(); // Â§±Ë¥•ÔºåÂàôÂÖ≥Èó≠53: throw t;54: &#125; else &#123;55: logger.warn("Failed to start " + getClass().getSimpleName() + " " + NetUtils.getLocalAddress()56: + " connect to the server " + getRemoteAddress() + " (check == false, ignore and retry later!), cause: " + t.getMessage(), t);57: &#125;58: &#125; catch (Throwable t) &#123;59: close(); // Â§±Ë¥•ÔºåÂàôÂÖ≥Èó≠60: throw new RemotingException(url.toInetSocketAddress(), null,61: "Failed to start " + getClass().getSimpleName() + " " + NetUtils.getLocalAddress()62: + " connect to the server " + getRemoteAddress() + ", cause: " + t.getMessage(), t);63: &#125;64:65: // Ëé∑ÂæóÁ∫øÁ®ãÊ±†66: executor = (ExecutorService) ExtensionLoader.getExtensionLoader(DataStore.class).getDefaultExtension()67: .get(Constants.CONSUMER_SIDE, Integer.toString(url.getPort()));68: ExtensionLoader.getExtensionLoader(DataStore.class).getDefaultExtension()69: .remove(Constants.CONSUMER_SIDE, Integer.toString(url.getPort()));70: &#125; reconnectExecutorService Â±ûÊÄßÔºåÈáçËøûÂÆöÊó∂‰ªªÂä°ÊâßË°åÂô®„ÄÇÂú®ÂÆ¢Êà∑Á´ØËøûÊé•ÊúçÂä°Á´ØÊó∂Ôºå‰ºöÂàõÂª∫ÂêéÂè∞‰ªªÂä°ÔºåÂÆöÊó∂Ê£ÄÊü•ËøûÊé•ÔºåËã•Êñ≠ÂºÄÔºå‰ºöËøõË°åÈáçËøû„ÄÇ Á¨¨ 27 Ëá≥ 31 Ë°åÔºö‰ªé URL ‰∏≠ÔºåËé∑ÂæóÈáçËøûÁõ∏ÂÖ≥ÈÖçÁΩÆÈ°π„ÄÇ Á¨¨ 33 Ëá≥ 41 Ë°åÔºöË∞ÉÁî® #doOpen() ÊäΩË±°ÊñπÊ≥ïÔºåÂàùÂßãÂåñÂÆ¢Êà∑Á´Ø„ÄÇËã•ÂºÇÂ∏∏ÔºåË∞ÉÁî® #close() ÊñπÊ≥ïÔºåËøõË°åÂÖ≥Èó≠„ÄÇ Á¨¨ 43 Ëá≥ 63 Ë°åÔºöË∞ÉÁî® 1#connect() ÂÆûÁé∞ ÊñπÊ≥ïÔºåËøûÊé•ÊúçÂä°Âô®„ÄÇËã•ÂºÇÂ∏∏ÔºåË∞ÉÁî® 1#close() ÊñπÊ≥ïÔºåËøõË°åÂÖ≥Èó≠„ÄÇ Á¨¨ 51 Ëá≥ 57 Ë°åÔºöËã•ÊòØËøûÊé•Â§±Ë¥• RemotingException ÔºåËã•ÂºÄÂêØ‰∫Ü ÂêØÂä®Êó∂Ê£ÄÊü• ÔºåÂàôË∞ÉÁî® #close() ÊñπÊ≥ïÔºåËøõË°åÂÖ≥Èó≠„ÄÇ Á¨¨ 66 Ëá≥ 69 Ë°åÔºö‰ªéDataStore‰∏≠ÔºåËé∑ÂæóÁ∫øÁ®ãÊ±†„ÄÇ DataStore Âú® dubbo-common Ê®°ÂùóÔºåstore ÂåÖ‰∏ãÂÆûÁé∞„ÄÇÁõÆÂâçÁöÑÂÆûÁé∞ÊØîËæÉÁÆÄÂçïÔºåÂèØ‰ª•ËÆ§‰∏∫ÊòØ ConcurrentMap&lt;String, ConcurrentMap&lt;String, Object&gt;&gt; ÁöÑÈõÜÂêà„ÄÇËÉñÂèãÂèØ‰ª•Ëá™Â∑±ÁúãÁõ∏ÂÖ≥ÂÆûÁé∞„ÄÇ Ê≠§Â§ÑÁöÑÁ∫øÁ®ãÊ±†ÔºåÂÆûÈôÖÂ∞±ÊòØ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Á∫øÁ®ãÊ®°Âûã„Äã ‰∏≠ËØ¥ÁöÑÁ∫øÁ®ãÊ±†„ÄÇÂú® „Äå8. Dispacher„Äç ‰∏≠ÔºåËØ¶ÁªÜËß£Êûê„ÄÇ ËøûÊé•ÊúçÂä°Âô® 123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * ËøûÊé•ÈîÅÔºåÁî®‰∫éÂÆûÁé∞ÂèëËµ∑ËøûÊé•ÂíåÊñ≠ÂºÄËøûÊé•‰∫íÊñ•ÔºåÈÅøÂÖçÂπ∂Âèë„ÄÇ */private final Lock connectLock = new ReentrantLock(); 1: protected void connect() throws RemotingException &#123; 2: // Ëé∑ÂæóÈîÅ 3: connectLock.lock(); 4: try &#123; 5: // Â∑≤ËøûÊé•Ôºå 6: if (isConnected()) &#123; 7: return; 8: &#125; 9: // ÂàùÂßãÂåñÈáçËøûÁ∫øÁ®ã 10: initConnectStatusCheckCommand(); 11: // ÊâßË°åËøûÊé• 12: doConnect(); 13: // ËøûÊé•Â§±Ë¥•ÔºåÊäõÂá∫ÂºÇÂ∏∏ 14: if (!isConnected()) &#123; 15: throw new RemotingException(this, "Failed connect to server " + getRemoteAddress() + " from " + getClass().getSimpleName() + " " 16: + NetUtils.getLocalHost() + " using dubbo version " + Version.getVersion() 17: + ", cause: Connect wait timeout: " + getTimeout() + "ms."); 18: // ËøûÊé•ÊàêÂäüÔºåÊâìÂç∞Êó•Âøó 19: &#125; else &#123; 20: if (logger.isInfoEnabled()) &#123; 21: logger.info("Successed connect to server " + getRemoteAddress() + " from " + getClass().getSimpleName() + " " 22: + NetUtils.getLocalHost() + " using dubbo version " + Version.getVersion() 23: + ", channel is " + this.getChannel()); 24: &#125; 25: &#125; 26: // ËÆæÁΩÆÈáçËøûÊ¨°Êï∞ÂΩíÈõ∂ 27: reconnect_count.set(0); 28: // ËÆæÁΩÆÊú™ÊâìÂç∞ËøáÈîôËØØÊó•Âøó 29: reconnect_error_log_flag.set(false); 30: &#125; catch (RemotingException e) &#123; 31: throw e; 32: &#125; catch (Throwable e) &#123; 33: throw new RemotingException(this, "Failed connect to server " + getRemoteAddress() + " from " + getClass().getSimpleName() + " " 34: + NetUtils.getLocalHost() + " using dubbo version " + Version.getVersion() 35: + ", cause: " + e.getMessage(), e); 36: &#125; finally &#123; 37: // ÈáäÊîæÈîÅ 38: connectLock.unlock(); 39: &#125; 40: &#125; Á¨¨ 3 Ë°åÔºöËé∑ÂæóÈîÅ„ÄÇÂú®ËøûÊé•ÂíåÊñ≠ÂºÄËøûÊé•Êó∂ÔºåÈÄöËøáÈîÅÔºåÈÅøÂÖçÂπ∂ÂèëÂÜ≤Á™Å„ÄÇ Á¨¨ 5 Ëá≥ 8 Ë°åÔºöË∞ÉÁî® #isConnected() ÊñπÊ≥ïÔºåÂà§Êñ≠ËøûÊé•Áä∂ÊÄÅ„ÄÇËã•Â∑≤ÁªèËøûÊé•ÔºåÂ∞±‰∏çÈáçÂ§çËøûÊé•„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345@Overridepublic boolean isConnected() &#123; Channel channel = getChannel(); return channel != null &amp;&amp; channel.isConnected();&#125; ËØ•ÊñπÊ≥ïÔºåÊòØÂõ†‰∏∫ÂÆûÁé∞ Channel Êé•Âè£( Client ÂÆûÁé∞ Channel Êé•Âè£ )ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÆûÁé∞ÁöÑ„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÂÆûÈôÖÊñπÊ≥ïÂÜÖÈÉ®ÔºåË∞ÉÁî®ÁöÑÊòØ channelÂØπË±°ÔºåËøõË°åÂà§Êñ≠„ÄÇÂÖ∂ÂÆÉÂÆûÁé∞ Channel ÁöÑÊñπÊ≥ïÔºå‰πüÊòØËøô‰πàÂ§ÑÁêÜÁöÑÔºå‰æãÂ¶Ç #getAttribute(key) Á≠âÊñπÊ≥ï„ÄÇ Á¨¨ 10 Ë°åÔºöË∞ÉÁî® #initConnectStatusCheckCommand() ÊñπÊ≥ïÔºåÂàùÂßãÂåñÈáçËøûÁ∫øÁ®ã„ÄÇ ÊñπÊ≥ï‰ºöÂ§çÊùÇ‰∏Ä‰∫õÔºå‰∏çÊùÇÁ≥ÖÂú®ËøôÈáåËÆ≤„ÄÇ Á¨¨ 14 Ëá≥ 17 Ë°åÔºöËøûÊé•Â§±Ë¥•ÔºåÊäõÂá∫ÂºÇÂ∏∏ RemotingException „ÄÇ Á¨¨ 18 Ëá≥ 25 Ë°åÔºöËøûÊé•ÊàêÂäüÔºåÊâìÂç∞Êó•Âøó„ÄÇ Á¨¨ 26 Ëá≥ 29 Ë°åÔºöËÆæÁΩÆÈáçËøûÊ¨°Êï∞ÂΩíÈõ∂ÔºåÊâìÂç∞ËøáÈîôËØØÊó•ÂøóÁä∂ÊÄÅ‰∏∫Âê¶„ÄÇ‰∏ãÈù¢ÔºåÊàë‰ª¨‰ºöÁúãÂà∞Ëøô‰∫õÁä∂ÊÄÅÂ≠óÊÆµÁöÑÂèòÊõ¥„ÄÇ Á¨¨ 38 Ë°åÔºöÈáäÊîæÈîÅ„ÄÇ ÂàùÂßãÂåñÈáçËøûÁ∫øÁ®ã 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/** * ÈáçËøûÊ¨°Êï∞ */private final AtomicInteger reconnect_count = new AtomicInteger(0);/** * ÈáçËøûÊó∂ÔºåÊòØÂê¶Â∑≤ÁªèÊâìÂç∞ËøáÈîôËØØÊó•Âøó„ÄÇ */// Reconnection error log has been called before?private final AtomicBoolean reconnect_error_log_flag = new AtomicBoolean(false);/** * ÈáçËøûÊâßË°å‰ªªÂä° Future */private volatile ScheduledFuture&lt;?&gt; reconnectExecutorFuture = null;/** * ÊúÄÂêéÊàêÂäüËøûÊé•Êó∂Èó¥ */// the last successed connected timeprivate long lastConnectedTime = System.currentTimeMillis(); 1: private synchronized void initConnectStatusCheckCommand() &#123; 2: //reconnect=false to close reconnect 3: // Ëé∑ÂæóËé∑ÂæóÈáçËøûÈ¢ëÁéáÔºåÈªòËÆ§ÂºÄÂêØ„ÄÇ 4: int reconnect = getReconnectParam(getUrl()); 5: // Ëã•ÂºÄÂêØÈáçËøûÂäüËÉΩÔºåÂàõÂª∫ÈáçËøûÁ∫øÁ®ã 6: if (reconnect &gt; 0 &amp;&amp; (reconnectExecutorFuture == null || reconnectExecutorFuture.isCancelled())) &#123; 7: // ÂàõÂª∫ Runnable ÂØπË±° 8: Runnable connectStatusCheckCommand = new Runnable() &#123; 9: public void run() &#123; 10: try &#123; 11: // Êú™ËøûÊé•ÔºåÈáçËøû 12: if (!isConnected()) &#123; 13: connect(); 14: // Â∑≤ËøûÊé•ÔºåËÆ∞ÂΩïÊúÄÂêéËøûÊé•Êó∂Èó¥ 15: &#125; else &#123; 16: lastConnectedTime = System.currentTimeMillis(); 17: &#125; 18: &#125; catch (Throwable t) &#123; 19: // Ë∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥Êú™ËøûÊé•‰∏äÔºåÊâçÊâìÂç∞ÂºÇÂ∏∏Êó•Âøó„ÄÇÂπ∂‰∏îÔºå‰ªÖÊâìÂç∞‰∏ÄÊ¨°„ÄÇÈªòËÆ§Ôºå15 ÂàÜÈíü„ÄÇ 20: String errorMsg = "client reconnect to " + getUrl().getAddress() + " find error . url: " + getUrl(); 21: // wait registry sync provider list 22: if (System.currentTimeMillis() - lastConnectedTime &gt; shutdown_timeout) &#123; 23: if (!reconnect_error_log_flag.get()) &#123; 24: reconnect_error_log_flag.set(true); 25: logger.error(errorMsg, t); 26: return; 27: &#125; 28: &#125; 29: // ÊØè‰∏ÄÂÆöÊ¨°ÂèëÁé∞Êú™ÈáçËøûÔºåÊâçÊâìÂç∞ÂëäË≠¶Êó•Âøó„ÄÇÈªòËÆ§Ôºå1800 Ê¨°Ôºå1 Â∞èÊó∂„ÄÇ 30: if (reconnect_count.getAndIncrement() % reconnect_warning_period == 0) &#123; 31: logger.warn(errorMsg, t); 32: &#125; 33: &#125; 34: &#125; 35: &#125;; 36: // ÂèëËµ∑ÂÆöÊó∂‰ªªÂä° 37: reconnectExecutorFuture = reconnectExecutorService.scheduleWithFixedDelay(connectStatusCheckCommand, reconnect, reconnect, TimeUnit.MILLISECONDS); 38: &#125; 39: &#125; Á¨¨ 4 Ë°åÔºöË∞ÉÁî® #getReconnectParam(url) ÊñπÊ≥ïÔºåËé∑ÂæóÈáçËøûÈ¢ëÁéá„ÄÇÈªòËÆ§ÂºÄÂêØÔºå2000 ÊØ´Áßí„ÄÇ ‰ª£Á†ÅÊØîËæÉÁÆÄÂçïÔºåËÉñÂèãËá™Â∑±ÁÇπÂáªÊñπÊ≥ïÊü•Áúã„ÄÇ Á¨¨ 6 Ëá≥ 38 Ë°åÔºöËã• ÂºÄÂêØ ÈáçËøûÂäüËÉΩÔºå ÂàõÂª∫ÈáçËøûÁ∫øÁ®ã„ÄÇ Á¨¨ 8 Ëá≥ 35 Ë°åÔºöÂàõÂª∫ Runnable ÂØπË±°„ÄÇ Á¨¨ 11 Ëá≥ 13 Ë°åÔºöÊú™ËøûÊé•Êó∂ÔºåË∞ÉÁî® #connect() ÊñπÊ≥ïÔºåËøõË°åÈáçËøû„ÄÇ Á¨¨ 14 Ëá≥ 17 Ë°åÔºöÂ∑≤ËøûÊé•Êó∂ÔºåËÆ∞ÂΩïÊúÄÂêéËøûÊé•Êó∂Èó¥„ÄÇ Á¨¨ 18 Ëá≥ 33 Ë°åÔºöÁ¨¶ÂêàÊù°‰ª∂Êó∂ÔºåÊâìÂç∞ÈîôËØØÊàñÂëäË≠¶Êó•Âøó„ÄÇ‰∏∫‰ªÄ‰πàË¶ÅÁ¨¶ÂêàÊù°‰ª∂ÊâçÊâìÂç∞Âë¢Ôºü‰πãÂâç‰πüÂíåÊúãÂèãËÅäËµ∑Êù•ËøáÔºåÁ∫ø‰∏äÂõ†‰∏∫‰∏≠Èó¥‰ª∂ÁªÑ‰ª∂ÔºåÊâìÂç∞‰∫ÜÂ§™Â§öÁöÑÊó•ÂøóÔºåÁªìÊûúÊï¥‰∏™ JVM Â¥©‰∫Ü„ÄÇÁâπÂà´Âú®ÁΩëÁªúÂú∫ÊôØ + Â§ßÈáè‚ÄúÊó†Èôê‚ÄùÈáçËØïÁöÑÂú∫ÊôØÔºåÁâπÂà´ÂÆπÊòìÊâìÂá∫Êª°Â±èÁöÑÊó•Âøó„ÄÇËøôÂùóÔºåÊàë‰ª¨ÂèØ‰ª•Â≠¶‰π†‰∏ã„ÄÇÂè¶Â§ñÔºåEureka Âú®ÈõÜÁæ§ÂêåÊ≠•Ôºå‰πüÊúâÁ±ª‰ººÂ§ÑÁêÜ„ÄÇ Á¨¨ 36 Ë°åÔºöÂèëËµ∑‰ªªÂä°ÔºåÂÆöÊó∂Ê£ÄÊü•ÔºåÊòØÂê¶ÈúÄË¶ÅÈáçËøû„ÄÇ reconnect=false to close reconnect Ôºå‰ªéÁõÆÂâç‰ª£Á†Å‰∏äÊù•ÁúãÔºåÊú™ÂÆûÁé∞ #reset(url) ÊñπÊ≥ïÔºåÂú® URL ÁöÑ reconnect=false ÈÖçÁΩÆÈ°πÊó∂ÔºåÂÖ≥Èó≠ÈáçËøûÁ∫øÁ®ã„ÄÇ ÂèëÈÄÅÊ∂àÊÅØ 1234567891011121314@Overridepublic void send(Object message, boolean sent) throws RemotingException &#123; // Êú™ËøûÊé•Êó∂ÔºåÂºÄÂêØÈáçËøûÂäüËÉΩÔºåÂàôÂÖàÂèëËµ∑ËøûÊé• if (send_reconnect &amp;&amp; !isConnected()) &#123; connect(); &#125; // ÂèëÈÄÅÊ∂àÊÅØ Channel channel = getChannel(); //TODO Can the value returned by getChannel() be null? need improvement. if (channel == null || !channel.isConnected()) &#123; throw new RemotingException(this, "message can not send, because channel is closed . url:" + getUrl()); &#125; channel.send(message, sent);&#125; ÂåÖË£ÖÈÄöÈÅìÂ§ÑÁêÜÂô® 1234567891011121314151617181920// Constants.javapublic static final String DEFAULT_CLIENT_THREADPOOL = "cached";protected static final String CLIENT_THREAD_POOL_NAME = "DubboClientHandler"; 1: /** 2: * ÂåÖË£ÖÈÄöÈÅìÂ§ÑÁêÜÂô® 3: * 4: * @param url URL 5: * @param handler Ë¢´ÂåÖË£ÖÁöÑÈÄöÈÅìÂ§ÑÁêÜÂô® 6: * @return ÂåÖË£ÖÂêéÁöÑÈÄöÈÅìÂ§ÑÁêÜÂô® 7: */ 8: protected static ChannelHandler wrapChannelHandler(URL url, ChannelHandler handler) &#123; 9: // ËÆæÁΩÆÁ∫øÁ®ãÂêç 10: url = ExecutorUtil.setThreadName(url, CLIENT_THREAD_POOL_NAME); 11: // ËÆæÁΩÆ‰ΩøÁî®ÁöÑÁ∫øÁ®ãÊ±†Á±ªÂûã 12: url = url.addParameterIfAbsent(Constants.THREADPOOL_KEY, Constants.DEFAULT_CLIENT_THREADPOOL); 13: // ÂåÖË£ÖÈÄöÈÅìÂ§ÑÁêÜÂô® 14: return ChannelHandlers.wrap(handler, url); 15: &#125; Á¨¨ 10 Ë°åÔºöË∞ÉÁî® ExecutorUtil#setThreadName(url, CLIENT_THREAD_POOL_NAME)ÊñπÊ≥ïÔºåËÆæÁΩÆÁ∫øÁ®ãÂêçÔºåÂç≥ URL.threadname=xxx „ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456public static URL setThreadName(URL url, String defaultName) &#123; String name = url.getParameter(Constants.THREAD_NAME_KEY, defaultName); name = new StringBuilder(32).append(name).append("-").append(url.getAddress()).toString(); url = url.addParameter(Constants.THREAD_NAME_KEY, name); return url;&#125; Ê≥®ÊÑèÔºåÁ∫øÁ®ãÂêç‰∏≠ÔºåÂåÖÂê´ URL ÁöÑÂú∞ÂùÄ‰ø°ÊÅØ„ÄÇ Á¨¨ 12 Ë°åÔºöËÆæÁΩÆÁ∫øÁ®ãÁ±ªÂûãÔºåÂç≥ URL.threadpool=xxx „ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî® &quot;cached&quot; Á±ªÂûãÔºåËøô‰∏™Âíå Server ÊòØ‰∏çÂêåÁöÑÔºå‰∏ãÈù¢Êàë‰ª¨‰ºöÁúãÂà∞„ÄÇ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Á∫øÁ®ãÊ±†„Äã Á¨¨ 14 Ë°åÔºöË∞ÉÁî® ChannelHandlers#wrap(handler, url) ÊñπÊ≥ïÔºåÂåÖË£ÖÈÄöÈÅìÂ§ÑÁêÜÂô®„ÄÇËøôÈáåÊàë‰ª¨‰∏çÁªÜËØ¥ÔºåÂú® „Äå8. Dispacher„Äç ‰∏≠ÔºåÁªìÂêàËß£Êûê„ÄÇ ËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÂÖ≥ÈîÆÁöÑÊñπÊ≥ïÔºåÂú®‰æãÂ¶Ç NettyClient Á≠âÈáåÔºåÈÉΩ‰ºöË∞ÉÁî®ËØ•ÊñπÊ≥ï„ÄÇ ÂÖ∂‰ªñÊñπÊ≥ï Â¶Ç‰∏ãÊñπÊ≥ïÊØîËæÉÁÆÄÂçïÔºåËâøËâøÂ∞±‰∏çÈáçÂ§çÂï∞Âó¶‰∫Ü„ÄÇ #disconnect() ÊñπÊ≥ïÔºåÊñ≠ÂºÄËøûÊé•„ÄÇ #reconnect() ÊñπÊ≥ïÔºå‰∏ªÂä®ÈáçËøû„ÄÇ #close() ÊñπÊ≥ïÔºåÂº∫Âà∂ÂÖ≥Èó≠„ÄÇ #close(timeout) ÊñπÊ≥ïÔºå‰ºòÈõÖÂÖ≥Èó≠„ÄÇ Â≠êÁ±ªÁ±ªÂõæ 3.2 ClientDelegatecom.alibaba.dubbo.remoting.transport.ClientDelegate ÔºåÂÆûÁé∞ Client Êé•Âè£ÔºåÂÆ¢Êà∑Á´ØË£ÖÈ•∞ËÄÖÂÆûÁé∞Á±ª„ÄÇÂú®ÊØè‰∏™ÂÆûÁé∞ÁöÑÊñπÊ≥ïÈáåÔºåÁõ¥Êé•Ë∞ÉÁî®Ë¢´Ë£ÖÈ•∞ÁöÑ client Â±ûÊÄßÁöÑÊñπÊ≥ï„ÄÇ ÁõÆÂâç dubbo-rpc-default Ê®°Âùó‰∏≠ÔºåChannelWrapper ÁªßÊâø‰∫Ü ClientDelegate Á±ª„ÄÇ‰ΩÜÂÆûÈôÖ‰∏äÔºåChannelWrapper ÈáçÊñ∞ÂÆûÁé∞‰∫ÜÊâÄÊúâÁöÑÊñπÊ≥ïÔºåÂπ∂‰∏îÔºåÂπ∂Êú™Â§çÁî®‰ªª‰ΩïÊñπÊ≥ï„ÄÇÊâÄ‰ª•ÔºåClientDelegate ÁõÆÂâçÁî®ÈÄî‰∏çÂ§ß„ÄÇ 4. Server4.1 AbstractServercom.alibaba.dubbo.remoting.transport.AbstractServer ÔºåÂÆûÁé∞ Server Êé•Âè£ÔºåÁªßÊâø AbstractEndpoint ÊäΩË±°Á±ªÔºåÊúçÂä°Âô®ÊäΩË±°Á±ªÔºåÈáçÁÇπÂÆûÁé∞‰∫ÜÂÖ¨Áî®ÁöÑÈÄªËæëÔºåÂêåÊó∂ÊäΩË±°‰∫ÜÂºÄÂêØ„ÄÅÂÖ≥Èó≠Á≠âÊ®°ÊùøÊñπÊ≥ïÔºå‰æõÂ≠êÁ±ªÂÆûÁé∞„ÄÇÊäΩË±°ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 123protected abstract void doOpen() throws Throwable;protected abstract void doClose() throws Throwable; ÊûÑÈÄ†ÊñπÊ≥ï 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253 1: /** 2: * Á∫øÁ®ãÊ±† 3: */ 4: ExecutorService executor; 5: /** 6: * ÊúçÂä°Âú∞ÂùÄ 7: */ 8: private InetSocketAddress localAddress; 9: /**10: * ÁªëÂÆöÂú∞ÂùÄ11: */12: private InetSocketAddress bindAddress;13: /**14: * ÊúçÂä°Âô®ÊúÄÂ§ßÂèØÊé•ÂèóËøûÊé•Êï∞15: */16: private int accepts;17: /**18: * Á©∫Èó≤Ë∂ÖÊó∂Êó∂Èó¥ÔºåÂçï‰ΩçÔºöÊØ´Áßí19: */20: private int idleTimeout; //600 seconds21:22: public AbstractServer(URL url, ChannelHandler handler) throws RemotingException &#123;23: super(url, handler);24: // ÊúçÂä°Âú∞ÂùÄ25: localAddress = getUrl().toInetSocketAddress();26: // ÁªëÂÆöÂú∞ÂùÄ27: String bindIp = getUrl().getParameter(Constants.BIND_IP_KEY, getUrl().getHost());28: int bindPort = getUrl().getParameter(Constants.BIND_PORT_KEY, getUrl().getPort());29: if (url.getParameter(Constants.ANYHOST_KEY, false) || NetUtils.isInvalidLocalHost(bindIp)) &#123;30: bindIp = NetUtils.ANYHOST;31: &#125;32: bindAddress = new InetSocketAddress(bindIp, bindPort);33: // ÊúçÂä°Âô®ÊúÄÂ§ßÂèØÊé•ÂèóËøûÊé•Êï∞34: this.accepts = url.getParameter(Constants.ACCEPTS_KEY, Constants.DEFAULT_ACCEPTS);35: // Á©∫Èó≤Ë∂ÖÊó∂Êó∂Èó¥36: this.idleTimeout = url.getParameter(Constants.IDLE_TIMEOUT_KEY, Constants.DEFAULT_IDLE_TIMEOUT);37:38: // ÂºÄÂêØÊúçÂä°Âô®39: try &#123;40: doOpen();41: if (logger.isInfoEnabled()) &#123;42: logger.info("Start " + getClass().getSimpleName() + " bind " + getBindAddress() + ", export " + getLocalAddress());43: &#125;44: &#125; catch (Throwable t) &#123;45: throw new RemotingException(url.toInetSocketAddress(), null, "Failed to bind " + getClass().getSimpleName()46: + " on " + getLocalAddress() + ", cause: " + t.getMessage(), t);47: &#125;48:49: // Ëé∑ÂæóÁ∫øÁ®ãÊ±†50: //fixme replace this with better method51: DataStore dataStore = ExtensionLoader.getExtensionLoader(DataStore.class).getDefaultExtension();52: executor = (ExecutorService) dataStore.get(Constants.EXECUTOR_SERVICE_COMPONENT_KEY, Integer.toString(url.getPort()));53: &#125; Á¨¨ 24 Ëá≥ 36 Ë°åÔºö‰ªé URL ‰∏≠ÔºåÂä†ËΩΩ 1localAddress 1bindAddress 1accepts 1idleTimeout ÈÖçÁΩÆÈ°π„ÄÇÊØîËæÉÈöæÁêÜËß£ÁöÑÔºåÂèØËÉΩÊòØ‰∏§‰∏™Âú∞ÂùÄÂ±ûÊÄßÔºåÂ¶Ç‰∏ãÊòØÊØî‰æãÊèê‰æõÁöÑ‰∏Ä‰∏™‰æãÂ≠êÔºö ÈÖçÁΩÆÈ°πÂèØÂú® #reset(url) ÊñπÊ≥ï‰∏≠ÔºåÈáçÁΩÆÂ±ûÊÄß„ÄÇ Á¨¨ 38 Ëá≥ 47 Ë°åÔºöË∞ÉÁî® #doOpen() ÊñπÊ≥ïÔºåÂºÄÂêØÊúçÂä°Âô®„ÄÇ Á¨¨ 49 Ëá≥ 52 Ë°åÔºö‰ªéDataStore‰∏≠ÔºåËé∑ÂæóÁ∫øÁ®ãÊ±†„ÄÇ fixme replace this with better method ÔºåËØ¥ÊòéÂÆòÊñπÂú®ËøôÂùóÂÆûÁé∞‰∏äÔºå‰πü‰∏çÊòØÂæàÊª°ÊÑèÔºåÂêéÈù¢‰ºö‰ºòÂåñÊéâ„ÄÇ Ë¢´ÂÆ¢Êà∑Á´ØËøûÊé• 12345678910111213141516171819@Overridepublic void connected(Channel ch) throws RemotingException &#123; // If the server has entered the shutdown process, reject any new connection if (this.isClosing() || this.isClosed()) &#123; logger.warn("Close new channel " + ch + ", cause: server is closing or has been closed. For example, receive a new connect request while in shutdown process."); ch.close(); return; &#125; // Ë∂ÖËøá‰∏äÈôêÔºåÂÖ≥Èó≠Êñ∞ÁöÑÈìæÊé• Collection&lt;Channel&gt; channels = getChannels(); if (accepts &gt; 0 &amp;&amp; channels.size() &gt; accepts) &#123; logger.error("Close channel " + ch + ", cause: The server " + ch.getLocalAddress() + " connections greater than max config " + accepts); ch.close(); // ÂÖ≥Èó≠Êñ∞ÁöÑÈìæÊé• return; &#125; // ËøûÊé• super.connected(ch);&#125; ÂèëÈÄÅÊ∂àÊÅØ 1234567891011@Overridepublic void send(Object message, boolean sent) throws RemotingException &#123; // Ëé∑ÂæóÊâÄÊúâÁöÑÂÆ¢Êà∑Á´ØÁöÑÈÄöÈÅì Collection&lt;Channel&gt; channels = getChannels(); // Áæ§ÂèëÊ∂àÊÅØ for (Channel channel : channels) &#123; if (channel.isConnected()) &#123; channel.send(message, sent); &#125; &#125;&#125; ÂÖ∂‰ªñÊñπÊ≥ï Â¶Ç‰∏ãÊñπÊ≥ïÊØîËæÉÁÆÄÂçïÔºåËâøËâøÂ∞±‰∏çÈáçÂ§çÂï∞Âó¶‰∫Ü„ÄÇ #disconnect() ÊñπÊ≥ïÔºåÊñ≠ÂºÄËøûÊé•„ÄÇ #close() ÊñπÊ≥ïÔºåÂº∫Âà∂ÂÖ≥Èó≠„ÄÇ #close(timeout) ÊñπÊ≥ïÔºå‰ºòÈõÖÂÖ≥Èó≠„ÄÇ Â≠êÁ±ªÁ±ªÂõæ 4.2 ServerDelegatecom.alibaba.dubbo.remoting.transport.ServerDelegate ÔºåÂÆûÁé∞ Client Êé•Âè£ÔºåÂÆ¢Êà∑Á´ØË£ÖÈ•∞ËÄÖÂÆûÁé∞Á±ª„ÄÇÂú®ÊØè‰∏™ÂÆûÁé∞ÁöÑÊñπÊ≥ïÈáåÔºåÁõ¥Êé•Ë∞ÉÁî®Ë¢´Ë£ÖÈ•∞ÁöÑ server Â±ûÊÄßÁöÑÊñπÊ≥ï„ÄÇ ÁõÆÂâç dubbo-remoting-p2p Ê®°Âùó‰∏≠ÔºåPeerServer ‰ºöÁªßÊâøËØ•Á±ªÔºåÂêéÁª≠ÂÜçÁúã„ÄÇ 5. Channel5.1 AbstractChannelcom.alibaba.dubbo.remoting.transport.AbstractChannel ÔºåÂÆûÁé∞ Channel Êé•Âè£ÔºåÂÆûÁé∞ AbstractPeer ÊäΩË±°Á±ªÔºåÈÄöÈÅìÊäΩË±°Á±ª„ÄÇ ÂèëÈÄÅÊ∂àÊÅØ 12345678@Overridepublic void send(Object message, boolean sent) throws RemotingException &#123; if (isClosed()) &#123; throw new RemotingException(this, "Failed to send message " + (message == null ? "" : message.getClass().getName()) + ":" + message + ", cause: Channel closed. channel: " + getLocalAddress() + " -&gt; " + getRemoteAddress()); &#125;&#125; ÂÖ∑‰ΩìÁöÑÂèëÈÄÅÊñπÊ≥ïÔºåÂ≠êÁ±ªÂÆûÁé∞„ÄÇÂú® AbstractChannel ‰∏≠ÔºåÁõÆÂâçÂè™ÂÅöÁä∂ÊÄÅÊ£ÄÊü•„ÄÇ Â≠êÁ±ªÁ±ªÂõæ 5.2 ChannelDelegatecom.alibaba.dubbo.remoting.transport.ChannelDelegate ÔºåÂÆûÁé∞ Channel Êé•Âè£ÔºåÈÄöÈÅìË£ÖÈ•∞ËÄÖÂÆûÁé∞Á±ª„ÄÇÂú®ÊØè‰∏™ÂÆûÁé∞ÁöÑÊñπÊ≥ïÈáåÔºåÁõ¥Êé•Ë∞ÉÁî®Ë¢´Ë£ÖÈ•∞ÁöÑ channel Â±ûÊÄßÁöÑÊñπÊ≥ï„ÄÇ ÁõÆÂâç Dubbo ‰∏≠ÔºåÊöÇÊú™Áî®Âà∞„ÄÇ 7. ChannelHandler7.1 ChannelHandlerAdaptercom.alibaba.dubbo.remoting.transport.ChannelHandlerAdapter ÔºåÂÆûÁé∞ ChannelHandler Êé•Âè£ÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®ÈÄÇÈÖçÂô®ÔºåÊØè‰∏™ÊñπÊ≥ï‰∏∫Á©∫ÂÆûÁé∞„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789@Override public void connected(Channel channel) throws RemotingException &#123; &#125;@Override public void disconnected(Channel channel) throws RemotingException &#123; &#125;@Override public void sent(Channel channel, Object message) &#123; &#125;@Override public void received(Channel channel, Object message) throws RemotingException &#123; &#125;@Override public void caught(Channel channel, Throwable exception) throws RemotingException &#123; &#125; Â≠êÁ±ªÔºåÂèØÁªßÊâøÂÆÉÔºå‰ªÖÂÆûÁé∞ÊÉ≥Ë¶ÅÁöÑÊñπÊ≥ï„ÄÇ 7.2 ChannelHandlerDispatchercom.alibaba.dubbo.remoting.transport.ChannelHandlerDispatcher ÔºåÂÆûÁé∞ ChannelHandler Êé•Âè£ÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®Ë∞ÉÂ∫¶Âô®„ÄÇÂú®ÂÆÉÂÜÖÈÉ®ÔºåÊúâ‰∏Ä‰∏™ÈÄöÈÅìÂ§ÑÁêÜÂô®Êï∞ÁªÑ channelHandlers Â±ûÊÄß„ÄÇ ÊØè‰∏™ÂÆûÁé∞ÁöÑÊñπÊ≥ïÔºåÈÉΩ‰ºöÂæ™ÁéØË∞ÉÁî® channelHandlers ÁöÑÊñπÊ≥ïÔºå‰æãÂ¶ÇÔºö 123456789public void received(Channel channel, Object message) &#123; for (ChannelHandler listener : channelHandlers) &#123; try &#123; listener.received(channel, message); &#125; catch (Throwable t) &#123; logger.error(t.getMessage(), t); &#125; &#125;&#125; ÊêúÁ¥¢‰∫Ü‰∏ã ChannelHandlerDispatcher ÁöÑ‰ΩøÁî®ÊÉÖÂÜµÔºå‰∏ªË¶ÅÁî®Âú® dubbo-remoting-p2p ÁöÑ AbstractGroup ‰∏≠„ÄÇ 7.3 ChannelHandlerDelegatecom.alibaba.dubbo.remoting.transport.ChannelHandlerDelegate ÔºåÂÆûÁé∞ ChannelHandler Êé•Âè£ÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®Ë£ÖÈ•∞ËÄÖÊé•Âè£„ÄÇÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1ChannelHandler getHandler(); Ê≠£Â¶ÇÔºåÊàë‰ª¨Âú®‰∏äÊñá‰∏≠ËØ¥ÈÅìÔºåË£ÖÈ•∞Âô®Ê®°ÂºèÔºåÂú® dubbo-remoting-api ÊâÆÊºî‰∫ÜÈùûÂ∏∏ÈáçË¶ÅÁöÑËßíËâ≤ÔºåÈÇ£‰πàÊúÄ‰Ω≥ÊºîÂëòÂ∞±ÊòØ ChannelHandlerDelegate ‰ª¨„ÄÇ‰∏ãÈù¢ÔºåÂºÄÂßã‰ªñ‰ª¨ÁöÑË°®Êºî„ÄÇ 7.3.1 AbstractChannelHandlerDelegatecom.alibaba.dubbo.remoting.transport.AbstractChannelHandlerDelegate ÔºåÂÆûÁé∞ ChannelHandlerDelegate Êé•Âè£ÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®Ë£ÖÈ•∞ËÄÖÊäΩË±°ÂÆûÁé∞Á±ª„ÄÇÂú®ÊØè‰∏™ÂÆûÁé∞ÁöÑÊñπÊ≥ïÈáåÔºåÁõ¥Êé•Ë∞ÉÁî®Ë¢´Ë£ÖÈ•∞ÁöÑ handler Â±ûÊÄßÁöÑÊñπÊ≥ï„ÄÇ 7.3.2 DecodeHandlercom.alibaba.dubbo.remoting.transport.DecodeHandler ÔºåÂÆûÁé∞ AbstractChannelHandlerDelegate ÊäΩË±°Á±ªÔºåËß£Á†ÅÂ§ÑÁêÜÂô®ÔºåÂ§ÑÁêÜÊé•Êî∂Âà∞ÁöÑÊ∂àÊÅØÔºåÂÆûÁé∞‰∫Ü Decodeable Êé•Âè£ÁöÑÊÉÖÂÜµ„ÄÇ Ë¶ÜÂÜô‰∫Ü #received(channel, message) ÊñπÊ≥ï 12345678910111213141516 1: @Override 2: public void received(Channel channel, Object message) throws RemotingException &#123; 3: if (message instanceof Decodeable) &#123; 4: decode(message); 5: &#125; 6: 7: if (message instanceof Request) &#123; 8: decode(((Request) message).getData()); 9: &#125;10:11: if (message instanceof Response) &#123;12: decode(((Response) message).getResult());13: &#125;14:15: handler.received(channel, message);16: &#125; Á¨¨ 3 Ëá≥ 5 Ë°åÔºöÂΩìÊ∂àÊÅØÊòØ Decodeable Á±ªÂûãÊó∂ÔºåË∞ÉÁî® #decode(message) ÊñπÊ≥ïÔºåËß£ÊûêÊ∂àÊÅØ„ÄÇ Á¨¨ 7 Ëá≥ 9 Ë°åÔºöÂΩìÊ∂àÊÅØÊòØ Request Á±ªÂûãÊó∂ÔºåË∞ÉÁî® #decode(message) ÊñπÊ≥ïÔºåËß£Êûê data Â±ûÊÄß„ÄÇ Á¨¨ 11 Ëá≥ 13 Ë°åÔºöÂΩìÊ∂àÊÅØÊòØ Response Á±ªÂûãÊó∂ÔºåË∞ÉÁî® #decode(message) ÊñπÊ≥ïÔºåËß£Êûê result Â±ûÊÄß„ÄÇ Á¨¨ 15 Ë°åÔºöË∞ÉÁî® ChannelHandler#received(channel, message) ÊñπÊ≥ïÔºåÂ∞ÜÊ∂àÊÅØ‰∫§ÁªôÂßîÊâòÁöÑ handler ÔºåÁªßÁª≠Â§ÑÁêÜ„ÄÇüôÇ ËÉñÂèãÊòØÂê¶ÊÑüÂèóÂà∞ÔºåË£ÖÈ•∞Âô®Ê®°ÂºèÁöÑÂ•ΩÂ§ÑÔºöÈÄöËøáÁªÑÂêàÁöÑÊñπÂºèÔºåÂÆûÁé∞ÂäüËÉΩÁöÑÂè†Âä†„ÄÇ Ëß£ÊûêÊ∂àÊÅØ 1234567891011121314 1: private void decode(Object message) &#123; 2: if (message != null &amp;&amp; message instanceof Decodeable) &#123; 3: try &#123; 4: ((Decodeable) message).decode(); // Ëß£ÊûêÊ∂àÊÅØ 5: if (log.isDebugEnabled()) &#123; 6: log.debug(new StringBuilder(32).append("Decode decodeable message ").append(message.getClass().getName()).toString()); 7: &#125; 8: &#125; catch (Throwable e) &#123; 9: if (log.isWarnEnabled()) &#123;10: log.warn(new StringBuilder(32).append("Call Decodeable.decode failed: ").append(e.getMessage()).toString(), e);11: &#125;12: &#125; // ~ end of catch13: &#125; // ~ end of if14: &#125; // ~ end of method decode Á¨¨ 2 Ëá≥ 4 Ë°åÔºöÂΩìÁ±ªÂûãÊòØ Decodeable Êó∂ÔºåË∞ÉÁî® Decodeable#decode() ÊñπÊ≥ïÔºåËøõ‰∏ÄÊ≠•Ëß£Êûê„ÄÇ Âú® dubbo-rpc-default È°πÁõÆ‰∏≠ÔºåDecodeableRpcInvocation Âíå DecodeableRpcResult ÂÆûÁé∞ Decodeable Êé•Âè£ÔºåÂêéÈù¢Êàë‰ª¨Êù•ÂàÜ‰∫´„ÄÇ 7.3.3 MultiMessageHandlercom.alibaba.dubbo.remoting.transport.MultiMessageHandler ÔºåÂÆûÁé∞ AbstractChannelHandlerDelegate ÊäΩË±°Á±ªÔºåÂ§öÊ∂àÊÅØÂ§ÑÁêÜÂô®ÔºåÂ§ÑÁêÜ‰∏ÄÊ¨°ÊÄßÊé•Êî∂Âà∞Â§öÊù°Ê∂àÊÅØÁöÑÊÉÖÂÜµ„ÄÇ Ë¶ÜÂÜô‰∫Ü #received(channel, message) ÊñπÊ≥ï 1234567891011 1: @Override 2: public void received(Channel channel, Object message) throws RemotingException &#123; 3: if (message instanceof MultiMessage) &#123; // Â§öÊ∂àÊÅØ 4: MultiMessage list = (MultiMessage) message; 5: for (Object obj : list) &#123; 6: handler.received(channel, obj); 7: &#125; 8: &#125; else &#123; 9: handler.received(channel, message);10: &#125;11: &#125; Á¨¨ 3 Ëá≥ 7 Ë°åÔºöÂΩìÊ∂àÊÅØÊòØ MultiMessage Á±ªÂûãÔºåÂç≥Â§öÊ∂àÊÅØÔºåÂæ™ÁéØÊèê‰∫§Áªô handler Â§ÑÁêÜ„ÄÇ Á¨¨ 8 Ëá≥ 10 Ë°åÔºöÂΩìÂçïÊ∂àÊÅØÊó∂ÔºåÁõ¥Êé•Êèê‰∫§Áªô handler Â§ÑÁêÜ„ÄÇ üôÇ Âú®‰∏ãÈù¢ÁöÑÊñáÁ´†ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ ChannelHandlerDelegate ÁöÑÁªÑÂêà‰ΩøÁî®ÁöÑ‰æãÂ≠ê„ÄÇ 8. DispacherÊú¨Â∞èËäÇÂÜÖÂÆπÔºåÂØπÂ∫î „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Á∫øÁ®ãÊ®°Âûã„Äã „ÄÇ ÁÆÄÂçïÊ¶ÇÊã¨ËøôËäÇÔºå‰ª•Êé•Êî∂Ê∂àÊÅØ‰∏æ‰æãÂ≠êÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123executor.execute(new Runnable() &#123; handler.received(channel, message)&#125;); Â∞Ü ChannelHandler ÁöÑÂÖ∑‰ΩìÊìç‰ΩúÔºåË∞ÉÂ∫¶Âà∞Á∫øÁ®ãÊ±†‰∏≠ÔºåËøô‰πüÊòØ‰∏∫‰ªÄ‰πàËøô‰∏™Ê®°ÂùóÂè´ dispacher ÁöÑÂéüÂõ†„ÄÇ 8.1 ChannelHandlerscom.alibaba.dubbo.remoting.transport.dispatcher.ChannelHandlers ÔºåÈÄöÈÅìÂ§ÑÁêÜÂô®Â∑•ÂéÇ„ÄÇÂú®‰∏äÊñá „Äå3.1 AbstractClient„Äç ÔºåÊàë‰ª¨ÁúãÂà∞ AbstractClient#wrapChannelHandler(url, handler) ÊñπÊ≥ï‰∏≠Ôºå‰ºöË∞ÉÁî® ChannelHandlers#wrap(url, handler) ÊñπÊ≥ï„ÄÇÂÆûÈôÖ‰∏äÔºåServer ÈÉ®ÂàÜ‰πü‰ºöÊúâËøôÊ†∑Á±ª‰ººÁöÑÈÄªËæëÔºåÂè™ÊòØ‰ª£Á†ÅÂÆûÁé∞‰∏äÊöÇÊú™Áªü‰∏Ä„ÄÇ‰ª• dubbo-remoting-netty4 Êù•‰∏æ‰æãÂ≠êÔºö NettyClient Ôºö 123public NettyClient(final URL url, final ChannelHandler handler) throws RemotingException &#123; super(url, wrapChannelHandler(url, handler));&#125; NettyServer Ôºö 123public NettyServer(URL url, ChannelHandler handler) throws RemotingException &#123; super(url, ChannelHandlers.wrap(handler, ExecutorUtil.setThreadName(url, SERVER_THREAD_POOL_NAME) /* ËÆæÁΩÆÁ∫øÁ®ãÂêçÂà∞ URL ‰∏ä */));&#125; Êó†ËÆ∫ Client ËøòÊòØ Server ÔºåÈÉΩÊòØÁ±ª‰ººÁöÑÔºåÂ∞Ü‰º†ÂÖ•ÁöÑ handler ÔºåÊúÄÁªà‰ΩøÁî® ChannelHandlers ËøõË°å‰∏ÄÊ¨°ÂåÖË£Ö„ÄÇOK ÔºåÊàë‰ª¨Êù•ÁúãÁúãÂåÖË£ÖÈÄöÈÅìÂ§ÑÁêÜÂô®ÁöÑÂÖ∑‰Ωì‰ª£Á†ÅÔºö 12345678910111213141516 1: /** 2: * Âçï‰æã 3: */ 4: private static ChannelHandlers INSTANCE = new ChannelHandlers(); 5: 6: public static ChannelHandler wrap(ChannelHandler handler, URL url) &#123; 7: return ChannelHandlers.getInstance().wrapInternal(handler, url); 8: &#125; 9:10: protected ChannelHandler wrapInternal(ChannelHandler handler, URL url) &#123;11: return new MultiMessageHandler(12: new HeartbeatHandler(13: ExtensionLoader.getExtensionLoader(Dispatcher.class).getAdaptiveExtension().dispatch(handler, url)14: )15: );16: &#125; Á¨¨ 11 Ëá≥ 15 Ë°åÔºöÂú®ËøôÈáåÔºåÊàë‰ª¨Â∞±ÁúãÂà∞‰∫ÜÂ§ö‰∏™ ChannelHandlerDelegate ÁöÑÁªÑÂêà„ÄÇÂåÖÊã¨ÔºåÁ¨¨ 15 Ë°åÁöÑÔºåDispatcher#dispatch(handler, url) ÊñπÊ≥ïÔºåÂÆûÈôÖ‰∏ä‰πüÊòØËøîÂõû‰∏Ä‰∏™ ChannelHandlerDelegate ÂØπË±°„ÄÇ 8.2 Dispatcher ÂÆûÁé∞Á±ªÂú® Dubbo ‰∏≠ÔºåÊúâÂ§öÁßç Dispatcher ÁöÑÂÆûÁé∞ÔºåÂ¶Ç‰∏ãÔºö FROM „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Á∫øÁ®ãÊ®°Âûã„Äã all ÊâÄÊúâÊ∂àÊÅØÈÉΩÊ¥æÂèëÂà∞Á∫øÁ®ãÊ±†ÔºåÂåÖÊã¨ËØ∑Ê±ÇÔºåÂìçÂ∫îÔºåËøûÊé•‰∫ã‰ª∂ÔºåÊñ≠ÂºÄ‰∫ã‰ª∂ÔºåÂøÉË∑≥Á≠â„ÄÇ direct ÊâÄÊúâÊ∂àÊÅØÈÉΩ‰∏çÊ¥æÂèëÂà∞Á∫øÁ®ãÊ±†ÔºåÂÖ®ÈÉ®Âú® IO Á∫øÁ®ã‰∏äÁõ¥Êé•ÊâßË°å„ÄÇ message Âè™ÊúâËØ∑Ê±ÇÂìçÂ∫îÊ∂àÊÅØÊ¥æÂèëÂà∞Á∫øÁ®ãÊ±†ÔºåÂÖ∂ÂÆÉËøûÊé•Êñ≠ÂºÄ‰∫ã‰ª∂ÔºåÂøÉË∑≥Á≠âÊ∂àÊÅØÔºåÁõ¥Êé•Âú® IO Á∫øÁ®ã‰∏äÊâßË°å„ÄÇ execution Âè™ËØ∑Ê±ÇÊ∂àÊÅØÊ¥æÂèëÂà∞Á∫øÁ®ãÊ±†Ôºå‰∏çÂê´ÂìçÂ∫îÔºåÂìçÂ∫îÂíåÂÖ∂ÂÆÉËøûÊé•Êñ≠ÂºÄ‰∫ã‰ª∂ÔºåÂøÉË∑≥Á≠âÊ∂àÊÅØÔºåÁõ¥Êé•Âú® IO Á∫øÁ®ã‰∏äÊâßË°å„ÄÇ connection Âú® IO Á∫øÁ®ã‰∏äÔºåÂ∞ÜËøûÊé•Êñ≠ÂºÄ‰∫ã‰ª∂ÊîæÂÖ•ÈòüÂàóÔºåÊúâÂ∫èÈÄê‰∏™ÊâßË°åÔºåÂÖ∂ÂÆÉÊ∂àÊÅØÊ¥æÂèëÂà∞Á∫øÁ®ãÊ±†„ÄÇ Â≠êÁ±ªÁ±ªÂõæ 8.2.1 AllDispatcherÊàë‰ª¨‰ª• all ÂØπÂ∫îÁöÑ AllDispatcher ‰∏æ‰æãÂ≠êÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789public class AllDispatcher implements Dispatcher &#123; public static final String NAME = "all"; public ChannelHandler dispatch(ChannelHandler handler, URL url) &#123; return new AllChannelHandler(handler, url); &#125;&#125; Âú®ËØ•Á±ªÁöÑ #dispatch(...) ÁöÑÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂàõÂª∫ AllChannelHandler ÂØπË±°ÔºåÂπ∂‰º†ÂÖ• handler Â±ûÊÄß„ÄÇüôÇ ËÅ™ÊÖßÂ¶Ç‰Ω†ÔºåÂ∑≤ÁªèÁåúÂà∞ AllChannelHandler ‰πüÊòØ ChannelHandlerDelegate Á±ªÂûã„ÄÇ‰πüÂ∞±ÊòØËØ¥‚ÄúÁ∫øÁ®ãÊ®°Âûã‚ÄùÔºå‰πüÊòØÈÄöËøáË£ÖÈ•∞Âô®Ê®°ÂºèÔºåÁªÑÂêàËÄåÊàê„ÄÇ ÊØè‰∏™ Dispatcher ÂÆûÁé∞Á±ªÔºåÈÉΩÂØπÂ∫î‰∏Ä‰∏™ ChannelHandler ÂÆûÁé∞Á±ª„ÄÇÈªòËÆ§Êú™ÈÖçÁΩÆÁöÑÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî® AllDispatcher Ë∞ÉÂ∫¶„ÄÇ 8.2.2 AllChannelHandlercom.alibaba.dubbo.remoting.transport.dispatcher.all.AllChannelHandler ÔºåÂÆûÁé∞ WrappedChannelHandler ÊäΩË±°Á±ª„ÄÇË¶ÜÂÜô #connected(channel) ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö WrappedChannelHandler ÊòØÂÆûÁé∞ ChannelHandlerDelegate ÁöÑÊäΩË±°Á±ªÔºå‰∏ãÊñáÂÜçÁúã„ÄÇ 123456789@Overridepublic void connected(Channel channel) throws RemotingException &#123; ExecutorService cexecutor = getExecutorService(); try &#123; cexecutor.execute(new ChannelEventRunnable(channel, handler, ChannelState.CONNECTED)); &#125; catch (Throwable t) &#123; throw new ExecutionException("connect event", channel, getClass() + " error when process connected event .", t); &#125;&#125; ÂàõÂª∫ ChannelEventRunnable ÂØπË±°ÔºåÊèê‰∫§ÁªôÁ∫øÁ®ãÊ±†ÊâßË°å„ÄÇ Ê≥®ÊÑèÔºå‰º†ÂÖ•ÁöÑÁä∂ÊÄÅ‰∏∫ ChannelState.CONNECTED „ÄÇ‰∏çÂêåÁöÑÂÆûÁé∞ÊñπÊ≥ïÔºåÂØπÂ∫î‰∏çÂêåÁöÑÁä∂ÊÄÅ„ÄÇ 8.3 ChannelEventRunnablecom.alibaba.dubbo.remoting.transport.dispatcher.ChannelEventRunnable ÔºåÂÆûÁé∞ Runnable Êé•Âè£„ÄÇ‰ª£Á†ÅÊØîËæÉÁÆÄÂçïÔºåËÉñÂèãËá™Â∑±ÁúãÂô¢„ÄÇ‰∏ªË¶ÅÂàÜÊàê‰∏âÈÉ®ÂàÜÔºö ÊûÑÈÄ†ÊñπÊ≥ï ChannelState #run() ÊñπÊ≥ïÔºåÁÆÄÂåñ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011@Overridepublic void run() &#123; switch (state) &#123; case CONNECTED: handler.connected(channel); break; case DISCONNECTED:handler.disconnected(channel); break; case SENT:handler.sent(channel, message);break; case RECEIVED:handler.received(channel, message);break; case CAUGHT:handler.caught(channel, exception);break; default: logger.warn("unknown state: " + state + ", message is " + message); &#125;&#125; 8.4 WrappedChannelHandlercom.alibaba.dubbo.remoting.transport.dispatcher.WrappedChannelHandler ÔºåÂÆûÁé∞ ChannelHandlerDelegate Êé•Âè£ÔºåÂåÖË£ÖÁöÑ WrappedChannelHandler ÂÆûÁé∞Á±ª„ÄÇ ‰ªéÁõÆÂâçÁöÑÂÆûÁé∞Êù•ÁúãÔºåWrappedChannelHandler ÁªßÊâø AbstractChannelHandlerDelegate Êõ¥ÂêàÈÄÇÔºåÂõ†‰∏∫ #connected(channel) Á≠âÔºåÂÆûÁé∞ÁöÑÊñπÊ≥ïÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇ ÊûÑÈÄ†ÊñπÊ≥ï 12345678910111213141516171819202122232425262728 1: /** 2: * Á∫øÁ®ãÊ±† 3: */ 4: protected final ExecutorService executor; 5: /** 6: * ÈÄöÈÅìÂ§ÑÁêÜÂô® 7: */ 8: protected final ChannelHandler handler; 9: /**10: * URL11: */12: protected final URL url;13:14: public WrappedChannelHandler(ChannelHandler handler, URL url) &#123;15: this.handler = handler;16: this.url = url;17:18: // ÂàõÂª∫Á∫øÁ®ãÊ±†19: executor = (ExecutorService) ExtensionLoader.getExtensionLoader(ThreadPool.class).getAdaptiveExtension().getExecutor(url);20:21: // Ê∑ªÂä†Á∫øÁ®ãÊ±†Âà∞ DataStore ‰∏≠22: String componentKey = Constants.EXECUTOR_SERVICE_COMPONENT_KEY;23: if (Constants.CONSUMER_SIDE.equalsIgnoreCase(url.getParameter(Constants.SIDE_KEY))) &#123;24: componentKey = Constants.CONSUMER_SIDE;25: &#125;26: DataStore dataStore = ExtensionLoader.getExtensionLoader(DataStore.class).getDefaultExtension();27: dataStore.put(componentKey, Integer.toString(url.getPort()), executor);28: &#125; Á¨¨ 19 Ë°åÔºöÂü∫‰∫é Dubbo SPI Adaptive Êú∫Âà∂ÔºåÂàõÂª∫Á∫øÁ®ãÊ±†„ÄÇ Á¨¨ 21 Ëá≥ 27 Ë°åÔºöÊ∑ªÂä†Á∫øÁ®ãÊ±†Âà∞ DataStore ‰∏≠„ÄÇüôÇ ËøôÂ∞±ÊòØ‰∏äÊñá AbstractClient Êàñ AbstractServer ‰ªé DataStore Ëé∑ÂæóÁ∫øÁ®ãÊ±†ÁöÑÊñπÂºè„ÄÇÂΩìÁÑ∂ÔºåÂÆòÊñπ‰πüËØ¥‰∫ÜÔºåËøôÁßçÊñπÂºè‰∏çÊòØÂæà‰ºòÈõÖÔºåÊúâÁÇπÂ•áÊ∑´ÊäÄÂ∑ßÔºåÊú™Êù•‰ºö‰ºòÂåñÊéâ„ÄÇ ÂÖ±‰∫´Á∫øÁ®ãÊ±† Âú® WrappedChannelHandler ‰∏≠ÔºåÊúâ‰∏Ä‰∏™ÂÜÖÁΩÆÁöÑÂÖ±‰∫´Á∫øÁ®ãÊ±†ÔºåÂ¶Ç‰∏ãÔºö 1protected static final ExecutorService SHARED_EXECUTOR = Executors.newCachedThreadPool(new NamedThreadFactory("DubboSharedHandler", true)); „ÄêTODO 8024„ÄëÊêû‰∏çÊáÇÔºåËøô‰∏™ËÆæËÆ°ÁöÑÊÑèÂõæÔºåÂÖàmarkÁïôÁùÄ„ÄÇ Â≠êÁ±ªÁ±ªÂõæ 9. Codec9.1 CodecSupportcom.alibaba.dubbo.remoting.transport.CodecSupport ÔºåÁºñËß£Á†ÅÂ∑•ÂÖ∑Á±ªÔºåÊèê‰æõÊü•ËØ¢ Serialization ÁöÑÂäüËÉΩ„ÄÇ ÂàùÂßãÂåñ 1234567891011121314151617181920212223242526272829/** * Â∫èÂàóÂåñÂØπË±°ÈõÜÂêà * keyÔºöÂ∫èÂàóÂåñÁ±ªÂûãÁºñÂè∑ &#123;@link Serialization#getContentTypeId()&#125; */private static Map&lt;Byte, Serialization&gt; ID_SERIALIZATION_MAP = new HashMap&lt;Byte, Serialization&gt;();/** * Â∫èÂàóÂåñÂêçÈõÜÂêà * keyÔºöÂ∫èÂàóÂåñÁ±ªÂûãÁºñÂè∑ &#123;@link Serialization#getContentTypeId()&#125; * value: Â∫èÂàóÂåñÊãìÂ±ïÂêç */private static Map&lt;Byte, String&gt; ID_SERIALIZATIONNAME_MAP = new HashMap&lt;Byte, String&gt;();static &#123; // Âü∫‰∫é Dubbo SPI ÔºåÂàùÂßãÂåñ Set&lt;String&gt; supportedExtensions = ExtensionLoader.getExtensionLoader(Serialization.class).getSupportedExtensions(); for (String name : supportedExtensions) &#123; Serialization serialization = ExtensionLoader.getExtensionLoader(Serialization.class).getExtension(name); byte idByte = serialization.getContentTypeId(); if (ID_SERIALIZATION_MAP.containsKey(idByte)) &#123; logger.error("Serialization extension " + serialization.getClass().getName() + " has duplicate id to Serialization extension " + ID_SERIALIZATION_MAP.get(idByte).getClass().getName() + ", ignore this Serialization extension"); continue; &#125; ID_SERIALIZATION_MAP.put(idByte, serialization); ID_SERIALIZATIONNAME_MAP.put(idByte, name); &#125;&#125; Dubbo Êèê‰æõ‰∫ÜÂ§öÁßçÂ∫èÂàóÂåñÊñπÂºèÔºåÊ≠§Â§ÑÂàùÂßãÂåñÁªìÊûúÔºåÂ¶Ç‰∏ãÂõæÔºö Êü•Êâæ Serialization ÂØπË±° 123456789101112public static Serialization getSerialization(URL url, Byte id) throws IOException &#123; Serialization serialization = getSerializationById(id); String serializationName = url.getParameter(Constants.SERIALIZATION_KEY, Constants.DEFAULT_REMOTING_SERIALIZATION); // ÈªòËÆ§Ôºåhessian2 // Âá∫‰∫éÂÆâÂÖ®ÁöÑÁõÆÁöÑÔºåÈíàÂØπ JDK ÁöÑÂ∫èÂàóÂåñÊñπÂºèÔºàÂØπÂ∫îÁºñÂè∑‰∏∫ 3„ÄÅ4„ÄÅ7ÔºâÔºåÊ£ÄÊü•ËøûÊé•Âà∞ÊúçÂä°Âô®ÁöÑ URL ÂíåÂÆûÈôÖ‰º†ËæìÁöÑÊï∞ÊçÆÔºåÂçèËÆÆÊòØÂê¶‰∏ÄËá¥„ÄÇ // https://github.com/apache/incubator-dubbo/issues/1138 // Check if "serialization id" passed from network matches the id on this side(only take effect for JDK serialization), for security purpose. if (serialization == null || ((id == 3 || id == 7 || id == 4) &amp;&amp; !(serializationName.equals(ID_SERIALIZATIONNAME_MAP.get(id))))) &#123; throw new IOException("Unexpected serialization id:" + id + " received from network, please check if the peer send the right id."); &#125; return serialization;&#125; üôÇ Âú®ÊúÄÊñ∞ÁöÑ Dubbo ÁâàÊú¨‰∏≠ÔºåÂ∑≤ÁªèÂ∞Ü serialization Ê®°ÂùóÔºå‰ªé dubbo-common ‰∏≠ÔºåÁã¨Á´ãÊàê dubbo-serialization „ÄÇSo ÔºåÊàë‰ª¨ÂêéÈù¢ÂºÄ‰∏Ä‰∏™Á≥ªÂàóÊù•ÂàÜ‰∫´„ÄÇ 9.2 AbstractCodeccom.alibaba.dubbo.remoting.transport.AbstractCodec ÔºåÂÆûÁé∞ Codec2 Êé•Âè£ÔºåÊèê‰æõÂ¶Ç‰∏ãÂÖ¨Áî®ÊñπÊ≥ïÔºö #checkPayload(channel, size) ÈùôÊÄÅÊñπÊ≥ïÔºåÊ†°È™åÊ∂àÊÅØÈïøÂ∫¶„ÄÇ #getSerialization(channel) ÊñπÊ≥ïÔºåËé∑Âæó Serialization ÂØπË±°„ÄÇ #isClientSide(channel) ÊñπÊ≥ïÔºåÊòØÂê¶‰∏∫ÂÆ¢Êà∑Á´Ø‰æßÁöÑÈÄöÈÅì„ÄÇ #isServerSide(channel) ÊñπÊ≥ïÔºåÊòØÂê¶‰∏∫ÊúçÂä°Á´Ø‰æßÁöÑÈÄöÈÅì„ÄÇ Â≠êÁ±ªÁ±ªÂõæ ÁºñËß£Á†ÅÂô®ÁöÑÂÆûÁé∞ÔºåÈÄöËøáÁªßÊâøÁöÑÊñπÂºèÔºåËé∑ÂæóÊõ¥Â§öÁöÑÂäüËÉΩ„ÄÇÊØè‰∏Ä‰∏™ Codec2 Á±ªÂÆûÁé∞ÂØπ‰∏çÂêåÊ∂àÊÅØÁöÑÁºñËß£Á†Å„ÄÇÈÄöËøáÂçèËÆÆÂ§¥Êù•Âà§Êñ≠ÔºåÂÖ∑‰Ωì‰ΩøÁî®Âì™‰∏™ÁºñËß£Á†ÅÈÄªËæë„ÄÇÂê¨Ëµ∑Êù•ÊúâÁÇπÁªïÔºåÊàë‰ª¨Êù•Áúã‰∏ÄÊÆµÁÆÄÂåñ ExchangeCodec ÁöÑ #decode(...) ‰æãÂ≠êÔºö 1234567891011121: protected Object decode(Channel channel, ChannelBuffer buffer, int readable, byte[] header) throws IOException &#123;2: // check magic number.3: if (readable &gt; 0 &amp;&amp; header[0] != MAGIC_HIGH4: || readable &gt; 1 &amp;&amp; header[1] != MAGIC_LOW) &#123;5: // ... ÁúÅÁï•6: return super.decode(channel, buffer, readable, header);7: &#125;8:9: // ... ÁúÅÁï•10:11: return decodeBody(channel, is, header);12: &#125; Á¨¨ 2 Ëá≥ 7 Ë°åÔºöÈÄöËøá magic number Âà§Êñ≠Âà∞ÔºåÂπ∂Èùû Dubbo Exchange ‰ø°ÊÅØ‰∫§ÊòìÁöÑÂçèËÆÆÂ§¥ÔºåËΩ¨‰∫§ÁªôÁà∂Á±ª TelnetCodec Â§ÑÁêÜÔºå‰∏ÄËà¨Ê≠§Êó∂ÊòØ Telnet Ê∂àÊÅØ„ÄÇ Á¨¨ 8 Ëá≥ 11 Ë°åÔºöÈÄöËøá magic number Âà§Êñ≠Âà∞ÔºåÁ¨¶Âêà Dubbo Exchange ‰ø°ÊÅØ‰∫§ÊòìÁöÑÂçèËÆÆÂ§¥ÔºåExchangeCodec Ëá™Â∑±Â§ÑÁêÜ„ÄÇ 9.2.1 TransportCodeccom.alibaba.dubbo.remoting.transport.codec.TransportCodec Ôºå‰º†ËæìÁºñËß£Á†ÅÂô®Ôºå‰ΩøÁî® Serialization ËøõË°åÂ∫èÂàóÂåñ/ÂèçÂ∫èÂàóÂåñÔºåÁõ¥Êé•ÁºñËß£Á†Å„ÄÇ ÁºñÁ†ÅÊ∂àÊÅØ 12345678910111213 1: @Override 2: public void encode(Channel channel, ChannelBuffer buffer, Object message) throws IOException &#123; 3: // Ëé∑ÂæóÂèçÂ∫èÂàóÂåñÁöÑ ObjectOutput ÂØπË±° 4: OutputStream output = new ChannelBufferOutputStream(buffer); 5: ObjectOutput objectOutput = getSerialization(channel).serialize(channel.getUrl(), output); 6: // ÂÜôÂÖ• ObjectOutput 7: encodeData(channel, objectOutput, message); 8: objectOutput.flushBuffer(); 9: // ÈáäÊîæ10: if (objectOutput instanceof Cleanable) &#123;11: ((Cleanable) objectOutput).cleanup();12: &#125;13: &#125; Á¨¨ 3 Ëá≥ 5 Ë°åÔºöËé∑ÂæóÂØπÂ∫îÁöÑ Serialization ÂØπË±°ÔºåÂπ∂ÂàõÂª∫Áî®‰∫éÂèçÂ∫èÂàóÂåñÁöÑ ObjectOutput ÂØπË±°„ÄÇ‰∏çÂêåÁöÑ Serialization ÂÆûÁé∞ÔºåÂØπÂ∫î‰∏çÂêåÁöÑ ObjectOutput ÂÆûÁé∞Á±ª„ÄÇüôÇ ËøôÈáåÔºåÊàë‰ª¨Âè™Ë¶ÅËØªÊáÇÂ§ß‰ΩìÊµÅÁ®ãÔºåËØ¶ÁªÜÁöÑÔºåÊàë‰ª¨ÂêéÈù¢ÊñáÁ´†ËßÅ„ÄÇ Á¨¨ 7 Ë°åÔºöË∞ÉÁî® #encodeData(channel, objectOutput, message) ÊñπÊ≥ïÔºåÂÜôÂÖ• ObjectOutput„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567protected void encodeData(Channel channel, ObjectOutput output, Object message) throws IOException &#123; encodeData(output, message);&#125;protected void encodeData(ObjectOutput output, Object message) throws IOException &#123; output.writeObject(message);&#125; Á¨¨ 9 Ëá≥ 12 Ë°åÔºöÈáäÊîæËµÑÊ∫ê„ÄÇÁõÆÂâçÔºå‰ªÖÊúâ kryo ÁöÑ KryoObjectInput „ÄÅKryoObjectOutput ÂÆûÁé∞‰∫Ü Cleanable Êé•Âè£ÔºåÈúÄË¶ÅÈáäÊîæËµÑÊ∫ê„ÄÇ Ëß£Á†ÅÊ∂àÊÅØ #decode(channel, buffer) ÂÆûÁé∞ÊñπÊ≥ïÔºåÂíåËß£Á†ÅÊ∂àÊÅØÂü∫Êú¨‰∏ÄËá¥ÔºåËÉñÂèãËá™Â∑±Êü•Áúã„ÄÇ 9.3 CodecAdaptercom.alibaba.dubbo.remoting.transport.codec.CodecAdapter ÔºåÂÆûÁé∞ Code2 Êé•Âè£ÔºåCodec ÈÄÇÈÖçÂô®ÔºåÂ∞Ü Codec ÈÄÇÈÖçÊàê Codec2 „ÄÇ üôÇ ‰ª£Á†ÅÊØîËæÉÁÆÄÂçïÔºåËÉñÂèãËá™Â∑±Êü•Áúã„ÄÇ 666. ÂΩ©Ëõã ‰ª£Á†ÅÊØîËæÉÂ§öÔºåÂ¶ÇÊûú‰∏çÁÜüÊÇâ Netty Á≠âÊ°ÜÊû∂ÁöÑËÉñÂèãÔºåÂèØËÉΩ‰ºö‰∏ÄËÑ∏ÊáµÈÄºÁöÑÁúãÂà∞ÊñáÊú´„ÄÇÂª∫ËÆÆËÉñÂèãÁªìÂêàÂ¶Ç‰∏ãÁöÑ‰ª£Á†ÅÔºö 12345678910// Netty.javanew ChannelInitializer&lt;NioSocketChannel&gt;() &#123; @Override protected void initChannel(NioSocketChannel ch) &#123; NettyCodecAdapter adapter = new NettyCodecAdapter(getCodec(), getUrl(), NettyServer.this); ch.pipeline().addLast("decoder", adapter.getDecoder()) // Ëß£Á†Å .addLast("encoder", adapter.getEncoder()) // Ëß£Á†Å .addLast("handler", nettyServerHandler); // Â§ÑÁêÜÂô® &#125;&#125; Âú®ËÑëË°• Debug + IDE Debug ÔºåÂ§öËÄÉËôë‰∏ã„ÄÇ Êé®ËçêÈòÖËØªÔºö „ÄäDubboÊ∫ê‰ª£Á†ÅÂÆûÁé∞ÂÖ≠ÔºöÁ∫øÁ®ãÊ±†Ê®°Âûã‰∏éÊèê‰æõËÄÖ„Äã „ÄäDubboÊ∫ê‰ª£Á†ÅÂàÜÊûêÂÖ´ÔºöÂÜçËØ¥ProviderÁ∫øÁ®ãÊ±†Ë¢´EXHAUSTED„Äã]]></content>
      <categories>
        <category>Dubbo</category>
        <category>remoting-api-interface</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SparkÂéüÁêÜÊ°à‰æãÂèäÊê≠Âª∫]]></title>
    <url>%2F2019%2F08%2F02%2FSpark%E5%8E%9F%E7%90%86%E6%A1%88%E4%BE%8B%E5%8F%8A%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÂü∫‰∫éSpark 2.3.1 scala 2.11 RDDÁÆóÂ≠êa resilient distributed dataset (RDD), which is a collection of elements partitioned across the nodes of the cluster that can be operated on in parallel TransformationÁÆóÂ≠êhttp://spark.apache.org/docs/latest/rdd-programming-guide.html#transformations ÊáíÊâßË°åÔºåËøîÂõûÂÄº‰æùÁÑ∂ÊòØRDD map filter flatMap groupByKey reduceByKey mapValues sort ActionÁÆóÂ≠êhttp://spark.apache.org/docs/latest/rdd-programming-guide.html#actions Ëß¶ÂèëÁúüÊ≠£ÊâßË°åÔºåËøîÂõûÂÄº‰∏çÂÜçÊòØRDD reduce‰∏çÈúÄË¶ÅÊ†πÊçÆkeyÂàÜÁªÑÔºåÁõ¥Êé•ËøõË°åËÅöÂêàÔºåreduceÂèåÂ≠êÊ≤°ÂøÖË¶ÅÂøÖÈ°ª‰ΩúÁî®Âú®KVÊ†ºÂºèÁöÑRDD‰∏ä collectÂ∞ÜRDDÁöÑÂÖÉÁ¥†Êî∂ÈõÜÂõûÊù•ÔºåÊî∂ÈõÜÂà∞‰∏Ä‰∏™ÈõÜÂêà‰∏≠„ÄÇÊÖéÁî®Ôºå‰∏ÄËà¨Âú®ÊµãËØïÁéØÂ¢É‰ΩøÁî® countRDDÊåÅ‰πÖÂåñhttp://spark.apache.org/docs/latest/rdd-programming-guide.html#rdd-persistence cache cacheÁÆóÂ≠êÂ∞ÜÊï∞ÊçÆ‰øùÂ≠òÂà∞ÂÜÖÂ≠ò‰∏≠ cacheÁÆóÂ≠êÊòØÊáíÂä†ËΩΩÁÆóÂ≠êÔºåÈúÄË¶ÅActionÁÆóÂ≠êËß¶ÂèëÊâßË°å cache ÊòØ persistÁÆÄÂåñÁâà StorageLevel ÂçäÁîüÂØπË±° deseriliezd ‰∏çÂ∫èÂàóÂåñÁöÑÊÑèÊÄùÔºå Â∫èÂàóÂåñÔºåÂç†Áî®Á©∫Èó¥Â∞è persistStorageLevel‰ºòÂÖàÁ∫ß MEMORY_ONLY Âè™ÊîæÂÜÖÂ≠òÔºå‰∏çÂ§üÊîæÂºÉ„ÄÇÈáäÊîæÔºö1.Ëá™Âä®ttlÔºå2.ÊâãÂä®ÈáäÊîæÂÜÖÂ≠ò unpersist„ÄÇ MEMORY_ONLY_SER MEMORY_AND_DISK_SER ÂÜÖÂ≠òÊîæ‰∏ç‰∫ÜÔºåÂÜçÊîæÁ£ÅÁõò DISK_ONLY ‰∏çÂª∫ËÆÆ‰ΩøÁî® ‰∏Ä‰∏™actionÁÆóÂ≠êÔºåÂ∞±ÊòØ‰∏Ä‰∏™Job standloneÈÉ®ÁΩ≤spark-env.sh ‰øÆÊîπ123456789101112131415161718# masterIPSPARK_MASTER_HOST=node01# masterÈÄö‰ø°Á´ØÂè£SPARK_MASTER_PORT=7077# ÂøÉË∑≥Ë∂ÖÊó∂Êó∂Èó¥SPARK_MASTER_OPTS="-Dspark.worker.timeout=100"# webUIÁ´ØÂè£SPARK_MASTER_WEBUI_PORT=8888# Êó•ÂøóÂ≠òÊîæ‰ΩçÁΩÆSPARK_LOCAL_DIRS="/var/zfg/spark"# workerËøõÁ®ãÊâÄÁÆ°ÁêÜÁöÑÊ†∏ÂøÉÊï∞SPARK_WORKER_CORES=2# workerËøõÁ®ãÊâÄÁÆ°ÁêÜÁöÑÂÜÖÂ≠òÊï∞SPARK_WORKER_MEMORY=3G# ËÆ°ÁÆóÂ∑•‰ΩúÂå∫SPARK_WORKER_DIR="/var/zfg/spark/work"# Â∑•‰ΩúÂå∫Êñá‰ª∂ÁöÑÊúâÊïàÊúüSPARK_WORKER_OPTS="-Dspark.worker.cleanup.enabled=true -Dspark.worker.cleanup.appDataTtl=259200" slave‰øÆÊîπ123node02node03node04 sbinÁöÑÁõÆÂΩï‰∏ãÁöÑspark-config.sh Êñá‰ª∂‰∏ãÊ∑ªÂä† 1export JAVA_HOME=/usr/install/jdk/jdk1.8.0_171 ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáèÔºåsbin binÊ∑ªÂä†Âà∞path start-all.sh ÊîπÂêçstart-spark.sh scpÂà∞node02 node03 node04ÂêØÂä®ÂêØÂä® start-spark.sh ËÆøÈóÆ http://node01:8888 Âä®ÊÄÅÊ∑ªÂä†worker1./sbin/start-slave.sh &lt;master-spark-URL&gt; spark shellÈõÜÁæ§ÊñπÂºè 1./bin/spark-shell --master spark://IP:PORT Êú¨Âú∞ÊñπÂºè 1./bin/spark-shell REPLËØª„ÄÅÊâßË°å„ÄÅÊâìÂç∞„ÄÅÂæ™ÁéØ standalone HAÈÉ®ÁΩ≤Spark Standalone Mode - Spark 2.4.3 Documentation Configuration - Spark 2.4.3 Documentation Â§Ñ‰∫éactiveÁä∂ÊÄÅÁöÑmasterÔºå‰ºöÂ∞ÜÊî∂ÈõÜÁöÑÂÖÉ‰ø°ÊÅØÊîæÂà∞zookeeperÔºåÂåÖÊã¨worker‰∏™Êï∞ÔºåÂú∞ÂùÄ„ÄÇ Â§áÁî®masterÁõëÂê¨zkÔºåÈÄöÁü•activeÊåÇ‰∫Ü„ÄÇÂ§áÁî®master‰ºö‰ªézk‰∏≠ËØªÂèñÂÖÉÊï∞ÊçÆÂà∞ÂÜÖÂ≠òÔºåÈÄöÁü•worker‰ª•ÂêéÁöÑ‰∏ª„ÄÅÂøÉË∑≥ÂèëÈÄÅ ÈÖçÁΩÆSPARK_DAEMON_JAVA_OPTS in spark-env by configuring spark.deploy.recoveryMode and related spark.deploy.zookeeper.* configurations. 1SPARK_DAEMON_JAVA_OPTS="-Dspark.deploy.recoveryMode=ZOOKEEPER spark.deploy.zookeeper.url=node02:2181,node03:2181,node04:2181 -Dspark.deploy.zookeeper.dir=spark201908" Â∞Üspark-env.sh ÂêåÊ≠•Âà∞ÂÖ∂‰ªñËäÇÁÇπ ÂêØÂä®start-spark.shÔºåÂèëÁé∞Âè™Êúâ‰∏Ä‰∏™master Âú®node02‰∏≠Ôºå‰øÆÊîπSPARK_MASTER_HOST=node02ÔºåÂÜç start-masterÂêØÂä® Â§áÁî® node02 start-master.shMaster=node02 RECAVering ÂáÜÂ§áÂàáÊç¢Áä∂ÊÄÅ ÊúØËØ≠ Master(standalone)ÔºöËµÑÊ∫êÁÆ°ÁêÜÁöÑ‰∏ªËäÇÁÇπ(ËøõÁ®ã) Cluster ManagerÔºöÂú®ÈõÜÁæ§‰∏äËé∑ÂèñËµÑÊ∫êÁöÑÂ§ñÈÉ®ÊúçÂä°(‰æãÂ¶Çstandalone,Mesos,Yarn ) Worker Node(standalone)ÔºöËµÑÊ∫êÁÆ°ÁêÜÁöÑ‰ªéËäÇÁÇπ(ËøõÁ®ã) ÊàñËÄÖËØ¥ÁÆ°ÁêÜÊú¨Êú∫ËµÑÊ∫êÁöÑËøõÁ®ã ApplicationÔºöÂü∫‰∫éSparkÁöÑ‚Ω§Áî®Êà∑Á®ãÂ∫èÔºåÂåÖÂê´‰∫ÜdriverÁ®ãÂ∫èÂíåËøêË°åÂú®ÈõÜÁæ§‰∏äÁöÑexecutorÁ®ãÂ∫è Driver ProgramÔºöÁî®Êù•ËøûÊé•Â∑•‰ΩúËøõÁ®ãÔºàWorkerÔºâÁöÑÁ®ãÂ∫è ExecutorÔºöÊòØÂú®‰∏Ä‰∏™workerËøõÁ®ãÊâÄÁÆ°ÁêÜÁöÑËäÇÁÇπ‰∏ä‰∏∫ÊüêApplicationÂêØÂä®ÁöÑ‚ºÄ‰∏Ä‰∏™ËøõÁ®ãÔºåËØ•Ëøõ Á®ãË¥üË¥£ËøêË°å‰ªªÂä°ÔºåÂπ∂‰∏îË¥üË¥£Â∞ÜÊï∞ÊçÆÂ≠òÂú®ÂÜÖÂ≠òÊàñËÄÖÁ£ÅÁõò‰∏ä„ÄÇÊØè‰∏™Â∫î‚Ω§Áî®ÈÉΩÊúâÂêÑËá™Áã¨‚Ω¥Á´ãÁöÑ executors TaskÔºöË¢´ÈÄÅÂà∞Êüê‰∏™executor‰∏äÁöÑÂ∑•‰ΩúÂçïÂÖÉ JobÔºöÂåÖÂê´ÂæàÂ§ö‰ªªÂä°(Task)ÁöÑÂπ∂Ë°åËÆ°ÁÆóÔºåÂèØ‰ª•ÁúãÂÅöÂíåactionÂØπJobÔºöÂåÖÂê´ÂæàÂ§ö‰ªªÂä°(Task)ÁöÑÂπ∂Ë°åËÆ°ÁÆóÔºåÂèØ‰ª•ÁúãÂÅöÂíåactionÂØπvÂ∫î StageÔºö‚ºÄ‰∏™Job‰ºöË¢´ÊãÜÂàÜÂæàÂ§öÁªÑ‰ªªÂä°ÔºåÊØèÁªÑ‰ªªÂä°Ë¢´Áß∞‰∏∫Stage(Â∞±ÂÉèMapreduceÂàÜmap task Âíåreduce task‰∏ÄÊ†∑) ÂÆΩ‰æùËµñ ÂÆΩ‰æùËµñÔºöÁà∂RDDÁöÑÂàÜÂå∫ÔºöÂ≠êRDDÁöÑÂàÜÂå∫Ôºå1ÂØπÂ§ö ÂØºËá¥ÂÆΩ‰æùËµñÁöÑÁÆóÂ≠ê: groupByKey ÂÆΩ‰æùËµñÂíåshuffleÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ Á™Ñ‰æùËµñ map fitler union ‰∏ç‰ºöÂØºËá¥ÂÆΩ‰æùËµñ Á™Ñ‰æùËµñ‰∏ÄËà¨‰∏ç‰ºöÂèëÁîüshuffle StageÂàáÂâ≤ËßÑÂàô ÊåâÂÆΩ‰æùËµñËøõË°åÂàíÂàÜÔºåËøûÁùÄÁöÑÁ™Ñ‰æùËµñ‰∏∫‰∏Ä‰∏™stage Ê≠£ÊòØÊúâ‰∫ÜÂÆΩÁ™Ñ‰æùËµñÔºåÊâçËÉΩÂ∞ÜjobÂàáÂàÜÊàê‰∏Ä‰∏™‰∏™stage ‰∏Ä‰∏™stageÁöÑtask‰∏™Êï∞ÔºàÂπ∂ÂèëÊï∞ÔºâÔºå‰ª•ÊúÄÂêé‰∏Ä‰∏™RDDÁöÑÂàÜÂå∫Êï∞‰∏∫ÂáÜ pipelineÊìç‰Ωú ‰∏Ä‰∏™stageÂÜÖÔºàÈÉΩÊòØÁ™Ñ‰æùËµñÔºâËøõË°åpipelineÊìç‰Ωú ËÆ°ÁÆóÂêëÊï∞ÊçÆÁßªÂä®ÔºåC„ÄÅD„ÄÅFÁöÑËÆ°ÁÆóÈÉΩÂèØ‰ª•ÁßªÂä®Âà∞CÊìç‰Ωú ‰∏∫‰ªÄ‰πàÊúâÊáíÊâßË°åÁÆóÂ≠êÔºåÂ∞±ÊòØ‰∏∫‰∫ÜÊûÑÂª∫pipelineÔºåÂ¢ûÂä†Âπ∂Ë°åÂ∫¶ ‰∏æ‰æã12345val RDD = sc.textFile(hdfs)val filterRDD = RDD.filter(x =&gt; x.contains("Ab"))val mapRDD = filterRDD.map(x =&gt; x+"~")val flatMapRDD = mapRDD.flatMap(x =&gt; x.split(" "))flatMapRDD.collect task1ÊúÄÂ•ΩÂú®B1ÊâßË°å task2ÊúÄÂ•ΩÂú®B2ÊâßË°å ÊåÅ‰πÖÂåñÁÆ°ÈÅì‰∏≠ÁöÑÊï∞ÊçÆ‰ªÄ‰πàÊó∂ÂÄôÊåÅ‰πÖÂåñÂà∞Á£ÅÁõò shuttle ÁöÑwriteÁöÑÈò∂ÊÆµÔºàstageÂíåstage‰πãÈó¥Ôºåshuttfle write Âíå shuttfle readÔºâ ÂØπ‰∏Ä‰∏™RDDÊâßË°å‰∫ÜÊåÅ‰πÖÂåñÁÆóÂ≠ê(persist) ‰ªªÂä°Ë∞ÉÂ∫¶ ‰ªªÂä°ÈáçËØï ÈªòËÆ§ÂÄºÈáçËØï3Ê¨° Ôºå Âä†‰∏ä1Ê¨°Ôºå‰∏ÄÂÖ±4Ê¨°„ÄÇÈáçËØïÊ¨°Êï∞‰∏∫4-1=3 http://spark.apache.org/docs/latest/configuration.html#scheduling spark.task.maxFailures 4 Number of failures of any particular task before giving up on the job. The total number of failures spread across different tasks will not cause the job to fail; a particular task has to fail this number of attempts. Should be greater than or equal to 1. Number of allowed retries = this value - 1. 1.‰ª£Á†ÅÈÖçÁΩÆ 2.spark-default.xmlÈÖçÁΩÆÊñá‰ª∂ 3.Êèê‰∫§ApplicationÁöÑÊó∂ÂÄôÔºåÂ∏∏Áî® 1spark-submit --conf spark.task.maxFailures=10 Êå£ÊâéÁöÑ‰ªªÂä°TaskSchedulerË¥üË¥£‰ªªÂä°ÁöÑÈáçËØïÔºåÂíåÊå£ÊâéÁöÑ‰ªªÂä°(Êé®ÊµãÊâßË°å) Êé®ÊµãËøáÁ®ã 75%ÁöÑ‰ªªÂä°ÈÉΩÊâßË°åÂÆåÊàêÂêéÔºå‰ºöÊØèÈöî100msÊù•Èâ¥ÂÆö‰∏ÄÊ¨°Ââ©‰ΩôÁöÑtaskÊòØÂê¶ÊòØÊå£ÊâéÁöÑtask„ÄÇÈâ¥ÂÆöËøáÁ®ãÔºö25taskÁöÑÊâßË°åÊó∂Èó¥ÔºåÊåâÁÖßÊâßË°åÊó∂Èó¥Êù•ÊéíÂ∫èÔºåÂèñ‰∏≠‰ΩçÊï∞10sÔºå10s*1.5ÂÄçÊï∞=15s„ÄÇ25task‰∏≠Â§ß‰∫éËøô‰∏™15sÁöÑ‰ªªÂä°Â∞±ÊòØÊå£ÊâéÁöÑ‰ªªÂä°„ÄÇ spark.speculation false If set to ‚Äútrue‚Äù, performs speculative execution of tasks. This means if one or more tasks are running slowly in a stage, they will be re-launched. spark.speculation.interval 100ms How often Spark will check for tasks to speculate. spark.speculation.multiplier 1.5 How many times slower a task is than the median to be considered for speculation. spark.speculation.quantile 0.75 Fraction of tasks which must be complete before speculation is enabled for a particular stage. stageÈáçËØïDAGSchedulerË¥üË¥£ÈáçËØïstageÔºåÈªòËÆ§ÈáçËØïÊ¨°Êï∞‰∏∫4 spark.stage.maxConsecutiveAttempts 4 Number of consecutive stage attempts allowed before a stage is aborted. ÂçïÊú∫ÊâßË°å3hÔºåSparkÂπ∂Ë°åÊâßË°åÂç¥Ë¶Å12hÔºüÔºü ÂèØËÉΩÂèëÁîüÊï∞ÊçÆÂÄæÊñúÔºå99task 100MÔºå1task 1T-100M ÂèØËÉΩÂºÄÂêØ‰∫ÜÊé®ÊµãÊâßË°åÔºåÈÇ£‰πàÂæàÊúâÂèØËÉΩ1task‰∏∫Êå£ÊâéÁöÑtaskÔºåÈÇ£‰πàTaskScheduler‰ºöÊñ∞Ëµ∑‰∏Ä‰∏™taskÂíåÊå£ÊâéÁöÑtaskÊØîËµõÊâßË°å Ëß£ÂÜ≥ÊñπÊ°àÔºö ÂÖ≥Èó≠Êé®ÊµãÊâßË°å Ëß£ÂÜ≥Êï∞ÊçÆÂÄæÊñúÈóÆÈ¢ò ËµÑÊ∫êË∞ÉÂ∫¶ DAGScheduler taskshceduler Â≠òÂú®‰∫édriver‰∏≠ ‰∏∫‰∫ÜÈò≤Ê≠¢masterÂéãÂäõËøáÂ§ßÔºåÈÉΩË¶ÅÂ¢ûÂä†client client spark-submit ÈÄöËøáÊâßË°åMainÂáΩÊï∞ÔºåÂêØÂä®‰∏Ä‰∏™driverËøõÁ®ã„ÄÇÂàõÂª∫sparkContextÔºåÂêåÊó∂ÂàõÂª∫‰∏§‰∏™ÂØπË±°ÔºåDAGScheduler,TaskScheduler„ÄÇ ËµÑÊ∫êË∞ÉÂ∫¶ËøáÁ®ã TaskSchedulerÂàõÂª∫ÊàêÂäüÂêéÔºå‰ºöÊâæmasterÔºåÁªôÂΩìÂâçapplicationÁî≥ËØ∑ËµÑÊ∫ê„ÄÇ master‰ºöÊü•ÁúãËá™Â∑±ÁöÑËµÑÊ∫êÊÉÖÂÜµÔºåÂëäËØâworkerËäÇÁÇπÔºåÂêØÂä®‰∏Ä‰∏™executorËøõÁ®ã„ÄÇÈªòËÆ§‰ΩøÁî®1GÂÜÖÂ≠òÔºåÊâÄÊúâÊ†∏„ÄÇ excutorÂêØÂä®ÊàêÂäüÂêéÔºå‰ºöÂèçÂêëÊ≥®ÂÜåÁªôTaskScheduler DAGSchedulerÔºåÊ†πÊçÆRDDÁöÑÂÆΩÁ™Ñ‰æùËµñÂàáÂàÜstageÔºåÂ∞Ü‰∏Ä‰∏™‰∏™stageÊèê‰∫§ÁªôtaskSehduler TaskSchedulerÔºåÊé•Êî∂Âà∞stage‰πãÂêéÔºåÈÅçÂéÜÊãøÂà∞ÊØè‰∏™taskÔºåË∞ÉÁî®HDFSÁöÑÊñπÊ≥ïÔºåÂæóÂà∞block‰ΩçÁΩÆ„ÄÇÂ∞ÜtaskÂàÜÂèëÂà∞Êï∞ÊçÆËäÇÁÇπÊâßË°å„ÄÇ Â§áÊ≥® ÂÆåÂÖ®‰∏ÄËá¥ÈÉ®ÁΩ≤Ôºå‰πü‰∏çËÉΩÈÅøÂÖçÊï∞ÊçÆÁßªÂä®„ÄÇ‰πüÊúâÂèØËÉΩ‰ªéÂÖ∂‰ªñËäÇÁÇπÊãâÂèñÊï∞ÊçÆÔºåÂú®ËäÇÁÇπËÆ°ÁÆó„ÄÇ ÂêØÂä®ExetorÊàñËÄÖÁî≥ËØ∑ËµÑÊ∫êÔºå‰∏ç‰ºöËÄÉËôëÊï∞ÊçÆÁöÑ‰ΩçÁΩÆ„ÄÇ ÂØπÊØî Spark MR on YARN Á±ªÂûã Á≤óÁ≤íÂ∫¶ÁöÑËµÑÊ∫êË∞ÉÂ∫¶ ÁªÜÁ≤íÂ∫¶ÁöÑËµÑÊ∫êË∞ÉÂ∫¶ ËøáÁ®ã Âú®Êèê‰∫§ApplicationÁöÑÊó∂ÂÄôÔºåtaskSchedulerÂÖàÂéªÁî≥ËØ∑ËµÑÊ∫ê„ÄÇÁÑ∂ÂêétaskSchedulerÂàÜÂèë‰ªªÂä°ÔºåÊâßË°åÊâÄÊúâtaskÊâßË°åÂÆåÊØïÔºåÊâçÈáäÊîæËøôÈÉ®ÂàÜËµÑÊ∫ê„ÄÇ Âú®Êèê‰∫§ApplicaitonÁöÑÊó∂ÂÄôÔºåÂÖàÂêëÊï∞ÊçÆËäÇÁÇπÂàÜÂèëtaskÔºåtaskËá™Â∑±ÂéªÁî≥ËØ∑ËµÑÊ∫ê„ÄÇÂ¶ÇÊûúÁî≥ËØ∑Âà∞‰∫ÜËµÑÊ∫êÔºåÁ´ãÂç≥ÊâßË°å„ÄÇÂê¶Âàô‰∏ÄÁõ¥Á≠âÂæÖ„ÄÇÂΩìtaskÊâßË°åÂÆåÊØïÔºåÁ´ãÂç≥ÈáäÊîæËµÑÊ∫ê„ÄÇ ‰ºòÁÇπ 1. ÊØè‰∏Ä‰∏™taskÁöÑÁ≠âÂæÖÊó∂Èó¥ÂèòÁü≠‰∫Ü 2.ÂèØ‰ª•ËµÑÊ∫êÂ§çÁî® ÈõÜÁæ§ËµÑÊ∫êËÉΩÂÖÖÂàÜÂà©Áî® Áº∫ÁÇπ 10000task 9999task 1taskÊ≤°ÊâßË°åÂÆåÔºåÊó†Ê≥ïÂÖÖÂàÜÂà©Áî®ÈõÜÁæ§ËµÑÊ∫ê taskÁöÑÁ≠âÂæÖÊó∂Èó¥Â§™Èïø Ê∫êÁ†ÅËß£ËØª workerËøõÁ®ãÂêØÂä®ÊàêÂäüÂêéÔºå‰ºöÂêëmasterÊ≥®ÂÜåÔºåÂèëÈÄÅworkerÁöÑÁÆ°ÁêÜÁöÑËµÑÊ∫ê‰ø°ÊÅØ ÂΩìworkerÂêØÂä®ÂÆåÊØïÂêéÔºå‰ºöÂÆöÊúüÂêëmasterÂèëÈÄÅÂøÉË∑≥ÔºåÊ≠§Êó∂‰∏ç‰ºöÊê∫Â∏¶workerÁöÑËµÑÊ∫ê‰ø°ÊÅØÔºåÂè™‰ºöÊê∫Â∏¶ÂΩìÂâçworkerÁöÑidÂè∑„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊØè‰∏Ä‰∏™workerËäÇÁÇπ‰∏∫ÂΩìÂâçÁöÑApplicationÊåáÂÆöÂêØÂä®‰∏Ä‰∏™1executorÔºåËøô‰∏™executorÈªòËÆ§‰ΩøÁî®1G ÊâÄÊúâÁöÑcore clientÊåáÂÆödriver‰∏çÂú®Êú¨Âú∞ÊâßË°åÔºå‰∏∫DriverÁî≥ËØ∑ËµÑÊ∫êÔºå1G 1core masterÊü•ËØ¢workers‰ø°ÊÅØÔºåÈöèÊú∫ÊåáÂÆöworker2ÂêØÂä®ÂêØÂä®DriverËøõÁ®ã„ÄÇ 1spark-submit --class org.apache.spark.examples.SparkPi --master spark://node01:7077 --deploy-mode cluster --driver-memory 1g --num-executors 2 --executor-memory 1g --executor-cores 1 /opt/sxt/spark-2.3.1/examples/jars/spark-examples_2.11-2.3.1.jar 1spark-submit --class org.apache.spark.examples.SparkPi --master spark://node01:7077 --deploy-mode cluster --total-executor-cores=6 --executor-memory 1g --executor-cores 1 /opt/sxt/spark-2.3.1/examples/jars/spark-examples_2.11-2.3.1.jar ` 1spark.deploy.spreadOut=true ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºàÂú®Êèê‰∫§ApplicationÁöÑÊó∂ÂÄôÔºåÊ≤°ÊúâÊåáÂÆö‚Äìexecutor-coresÔºâÔºåÊØè‰∏Ä‰∏™workerËäÇÁÇπ‰∏∫ÂΩìÂâçÁöÑApplicationÂè™ÂêØÂä®1‰∏™ExecutorÔºåËøô‰∏™Executor‰ΩøÁî®ÊâÄÊúâÁöÑÊ†∏ Â¶ÇÊûúÊÉ≥Ë¶Å‰∏Ä‰∏™WorkerËäÇÁÇπ‰∏äÂêØÂä®Â§ö‰∏™ExecutorÔºåÈÇ£‰πàÂú®Êèê‰∫§ApplicationÁöÑÊó∂ÂÄôÈúÄË¶ÅÊåáÂÆö--executor-coresËøô‰∏™ÈÄâÈ°π spark.deploy.spreadOutÈªòËÆ§‰∏∫trueÔºåË°®Á§∫ËΩÆËØ¢Âú®workersÂêØÂä®executor 1spark-submit --class org.apache.spark.examples.SparkPi --master spark://node01:7077 --deploy-mode cluster --total-executor-cores=6 --executor-memory 1g --executor-cores 1 --spark.deploy.spreadOut false /opt/sxt/spark-2.3.1/examples/jars/spark-examples_2.11-2.3.1.jar ÂèÇËÄÉ https://spark.apache.org/docs/latest/spark-standalone.html]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[stormÊê≠Âª∫ÂèäÂéüÁêÜÂàÜÊûê]]></title>
    <url>%2F2019%2F06%2F23%2Fstorm%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[http://storm.apache.org/ ÁºñÁ®ãÊ®°Âûã DAG ÔºàTopologyÔºâÊúâÂêëÊó†ÁéØÂõæSpout ‚Äì Êï∞ÊçÆÊ∫ê nextTuple Spout‰∏≠ÊúÄÊ†∏ÂøÉÁöÑÊñπÊ≥ïÊòØnextTupleÔºåËØ•ÊñπÊ≥ï‰ºöË¢´StormÁ∫øÁ®ã‰∏çÊñ≠Ë∞ÉÁî®„ÄÅ‰∏ªÂä®‰ªéÊï∞ÊçÆÊ∫êÊãâÂèñÊï∞ÊçÆÔºåÂÜçÈÄöËøáemitÊñπÊ≥ïÂ∞ÜÊï∞ÊçÆÁîüÊàêÂÖÉÁªÑÔºàTupleÔºâÂèëÈÄÅÁªô‰πãÂêéÁöÑBoltËÆ°ÁÆó OutputFieldsDeclarer ÂèØÂÖàÈÄöËøáOutputFieldsDeclarer‰∏≠ÁöÑdeclareÊñπÊ≥ïÂ£∞ÊòéÂÆö‰πâÁöÑ‰∏çÂêåÊï∞ÊçÆÊµÅÔºåÂèëÈÄÅÊï∞ÊçÆÊó∂ÈÄöËøáSpoutOutputCollector‰∏≠ÁöÑemitÊñπÊ≥ïÊåáÂÆöÊï∞ÊçÆÊµÅIdÔºàstreamIdÔºâÂèÇÊï∞Â∞ÜÊï∞ÊçÆÂèëÈÄÅÂá∫Âéª Bolt ‚Äì Êï∞ÊçÆÊµÅÂ§ÑÁêÜÁªÑ‰ª∂BoltÔºöÂ§ÑÁêÜËÄÖÔºåÂèØ‰ª•ÊúâÂ§ö‰∏™„ÄÇÂ§ö‰∏™boltÂèØ‰ª•Âπ∂Ë°åÊâßË°å„ÄÇ ‰∏Ä‰∏™BoltÂèØ‰ª•ÂèëÈÄÅÂ§ö‰∏™Êï∞ÊçÆÊµÅÔºàStreamÔºâ OutputFieldsDeclarer ÂèØÂÖàÈÄöËøáOutputFieldsDeclarer‰∏≠ÁöÑdeclareÊñπÊ≥ïÂ£∞ÊòéÂÆö‰πâÁöÑ‰∏çÂêåÊï∞ÊçÆÊµÅÔºåÂèëÈÄÅÊï∞ÊçÆÊó∂ÈÄöËøáSpoutOutputCollector‰∏≠ÁöÑemitÊñπÊ≥ïÊåáÂÆöÊï∞ÊçÆÊµÅIdÔºàstreamIdÔºâÂèÇÊï∞Â∞ÜÊï∞ÊçÆÂèëÈÄÅÂá∫Âéª execute Bolt‰∏≠ÊúÄÊ†∏ÂøÉÁöÑÊñπÊ≥ïÊòØexecuteÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïË¥üË¥£Êé•Êî∂Âà∞‰∏Ä‰∏™ÂÖÉÁªÑÔºàTupleÔºâÊï∞ÊçÆ„ÄÅÁúüÊ≠£ÂÆûÁé∞Ê†∏ÂøÉÁöÑ‰∏öÂä°ÈÄªËæë Stream Grouping ‚Äì Êï∞ÊçÆÊµÅÂàÜÁªÑÔºàÂç≥Êï∞ÊçÆÂàÜÂèëÁ≠ñÁï•ÔºâÈ´òÂèØÈù†ÊÄßÂºÇÂ∏∏Â§ÑÁêÜ Ê∂àÊÅØÂèØÈù†ÊÄß‰øùÈöúÊú∫Âà∂(ACK) ÊµÅÂºèÂ§ÑÁêÜÂºÇÊ≠•ÊñπÂºè ÊµÅÂºèÂ§ÑÁêÜÔºàÂºÇÊ≠• ‰∏é ÂêåÊ≠•Ôºâ ÂÆ¢Êà∑Á´ØÊèê‰∫§Êï∞ÊçÆËøõË°åÁªìÁÆóÔºåÂπ∂‰∏ç‰ºöÁ≠âÂæÖÊï∞ÊçÆËÆ°ÁÆóÁªìÊûú ÈÄêÊù°Â§ÑÁêÜ ‰æãÔºöETLÔºàÊï∞ÊçÆÊ∏ÖÊ¥óÔºâextracted transform load ÁªüËÆ°ÂàÜÊûê ‰æãÔºöËÆ°ÁÆóPV„ÄÅUV„ÄÅËÆøÈóÆÁÉ≠ÁÇπ ‰ª•Âèä Êüê‰∫õÊï∞ÊçÆÁöÑËÅöÂêà„ÄÅÂä†Âíå„ÄÅÂπ≥ÂùáÁ≠â ‚Äã ÂÆ¢Êà∑Á´ØÊèê‰∫§Êï∞ÊçÆ‰πãÂêéÔºåËÆ°ÁÆóÂÆåÊàêÁªìÊûúÂ≠òÂÇ®Âà∞Redis„ÄÅHBase„ÄÅMySQLÊàñËÄÖÂÖ∂‰ªñMQÂΩì‰∏≠Ôºå ‚Äã ÂÆ¢Êà∑Á´ØÂπ∂‰∏çÂÖ≥ÂøÉÊúÄÁªàÁªìÊûúÊòØÂ§öÂ∞ë„ÄÇ ÂêåÊ≠•ÊñπÂºèÂÆ¢Êà∑Á´ØÊèê‰∫§Êï∞ÊçÆËØ∑Ê±Ç‰πãÂêéÔºåÁ´ãÂàªÂèñÂæóËÆ°ÁÆóÁªìÊûúÂπ∂ËøîÂõûÁªôÂÆ¢Êà∑Á´Ø ÂÆ¢Êà∑Á´ØÈÄöËøáÂíåDRPC server‰∫§‰∫íÔºåÁ´ãÂàªÂèñÂæóËøîÂõûÁªìÊûú ÂíåMapReduceÊØîËæÉ StormÔºöËøõÁ®ã„ÄÅÁ∫øÁ®ãÂ∏∏È©ªÂÜÖÂ≠òËøêË°åÔºåÊï∞ÊçÆ‰∏çËøõÂÖ•Á£ÅÁõòÔºåÊï∞ÊçÆÈÄöËøáÁΩëÁªú‰º†ÈÄí„ÄÇ MapReduceÔºö‰∏∫TB„ÄÅPBÁ∫ßÂà´Êï∞ÊçÆËÆæËÆ°ÁöÑÊâπÂ§ÑÁêÜËÆ°ÁÆóÊ°ÜÊû∂„ÄÇ ÂíåSpark StreamingÊØîËæÉ StormÔºöÁ∫ØÊµÅÂºèÂ§ÑÁêÜÔºåÊØ´ÁßíÁ∫ß ‰∏ìÈó®‰∏∫ÊµÅÂºèÂ§ÑÁêÜËÆæËÆ° Êï∞ÊçÆ‰º†ËæìÊ®°ÂºèÊõ¥‰∏∫ÁÆÄÂçïÔºåÂæàÂ§öÂú∞Êñπ‰πüÊõ¥‰∏∫È´òÊïà Âπ∂‰∏çÊòØ‰∏çËÉΩÂÅöÊâπÂ§ÑÁêÜÔºåÂÆÉ‰πüÂèØ‰ª•Êù•ÂÅöÂæÆÊâπÂ§ÑÁêÜÔºåÊù•ÊèêÈ´òÂêûÂêê Spark StreamingÔºöÂæÆÊâπÂ§ÑÁêÜÔºåÁßíÁ∫ß Â∞ÜRDDÂÅöÁöÑÂæàÂ∞èÊù•Áî®Â∞èÁöÑÊâπÂ§ÑÁêÜÊù•Êé•ËøëÊµÅÂºèÂ§ÑÁêÜ Âü∫‰∫éÂÜÖÂ≠òÂíåDAGÂèØ‰ª•ÊääÂ§ÑÁêÜ‰ªªÂä°ÂÅöÁöÑÂæàÂø´ Êï∞ÊçÆÁ¥ØÂä†demo‰ª£Á†ÅÂèÇËÄÉeclipse-hadoop-workspace/ws ÈõÜÁæ§ÂÆâË£Ö1python -V nimbus supervisor zookeeper node01 * node02 * * node03 * * node04 * scpÂÆâË£ÖÂåÖÂà∞node01 apache-storm-0.10.0.tar.gz 12345678910111213141516$ vim conf/storm.yamlstorm.zookeeper.servers: - "node02" - "node03" - "node04"storm.local.dir: "/tmp/storm"nimbus.host: "node01"# slot ‰ª£Ë°®‰∏Ä‰∏™ËøõÁ®ãsupervisor.slots.ports: - 6700 - 6701 - 6702 - 6703 12scp -r apache-storm-0.10.0 root@node02:`pwd`scp -r apache-storm-0.10.0 root@node03:`pwd` 123ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆexport STORM_HOME=/opt/sxt/stormexport PATH=$PATH:$STORM_HOME/bin Âú®stormÁõÆÂΩï‰∏≠ÂàõÂª∫logsÁõÆÂΩï12cd $STORM_HOMEmkdir logs node01‰∏äÂêØÂä®Nimbus1234storm nimbus &gt;&gt; ./logs/nimbus.out 2&gt;&amp;1 &amp;tail -f logs/nimbus.logstorm ui &gt;&gt; ./logs/ui.out 2&gt;&amp;1 &amp;tail -f logs/ui.log ËäÇÁÇπnode2Âíånode3ÂêØÂä®supervisorÔºåÊåâÁÖßÈÖçÁΩÆÔºåÊØèÂêØÂä®‰∏Ä‰∏™supervisorÂ∞±Êúâ‰∫Ü4‰∏™slots1234cd $STORM_HOMEmkdir logsstorm supervisor &gt;&gt; ./logs/supervisor.out 2&gt;&amp;1 &amp;tail -f logs/supervisor.log Â∏ÆÂä©ÂëΩ‰ª§12storm helpstorm help jar kill1storm kill test webËøêÁª¥È°µÈù¢ http://node01:8080/ ÈõÜÁæ§Êèê‰∫§Êèê‰∫§‰ªªÂä°Âà∞StormÈõÜÁæ§ÂΩì‰∏≠ËøêË°åÔºö‰ª£Á†ÅÂèÇËÄÉ(eclipse-hadoop-workspace/wordcount) srcÊâìÂåÖÔºåtest‰∏∫ÂèÇÊï∞Ë°®Á§∫ÈõÜÁæ§ÊñπÂºèËøêË°åÔºå‰Ωú‰∏∫topologyÂêçÁß∞ 1storm jar wordcount.jar com.sxt.storm.test.Test test 123456789101112131415if (args.length&gt;0) &#123; try &#123; StormSubmitter.submitTopology(args[0], config, tb.createTopology()); &#125; catch (AlreadyAliveException e) &#123; e.printStackTrace(); &#125; catch (InvalidTopologyException e) &#123; e.printStackTrace(); &#125;&#125; else &#123; LocalCluster lc = new LocalCluster(); lc.submitTopology("wordcount", config, tb.createTopology());&#125; ÊµÅÁ®ãÔºö spout ‚Äî&gt; bolt(ÂàáÂàÜÂçïËØç)‚Äî&gt; bolt(ËÆ°Êï∞) Êû∂ÊûÑËÆæËÆ° Nimbus ËµÑÊ∫êË∞ÉÂ∫¶ ‰ªªÂä°ÂàÜÈÖç Êé•Êî∂jarÂåÖ Supervisor Êé•Êî∂nimbusÂàÜÈÖçÁöÑ‰ªªÂä° ÂêØÂä®„ÄÅÂÅúÊ≠¢Ëá™Â∑±ÁÆ°ÁêÜÁöÑworkerËøõÁ®ãÔºàÂΩìÂâçsupervisor‰∏äworkerÊï∞ÈáèÁî±ÈÖçÁΩÆÊñá‰ª∂ËÆæÂÆöÔºâ Worker ËøêË°åÂÖ∑‰ΩìÂ§ÑÁêÜËøêÁÆóÁªÑ‰ª∂ÁöÑËøõÁ®ãÔºàÊØè‰∏™WorkerÂØπÂ∫îÊâßË°å‰∏Ä‰∏™TopologyÁöÑÂ≠êÈõÜÔºâ worker‰ªªÂä°Á±ªÂûãÔºåÂç≥spout‰ªªÂä°„ÄÅbolt‰ªªÂä°‰∏§Áßç ÂêØÂä®executor ‚Äã ÔºàexecutorÂç≥worker JVMËøõÁ®ã‰∏≠ÁöÑ‰∏Ä‰∏™javaÁ∫øÁ®ãÔºå‰∏ÄËà¨ÈªòËÆ§ÊØè‰∏™executorË¥üË¥£ÊâßË°å‰∏Ä‰∏™task‰ªªÂä°Ôºâ ‰∏éhadoop yarnÂØπÊØî Hadoop Storm ‰∏ªËäÇÁÇπ ResourceManager Nimbus ‰ªéËäÇÁÇπ NodeManager Supervisor Â∫îÁî®Á®ãÂ∫è Job Topology Â∑•‰ΩúËøõÁ®ã Child Worker ËÆ°ÁÆóÊ®°Âûã Map/Reduce(split,map,shuffle,reduce) Spout/Bolt ËøêË°åËøáÁ®ã Êèê‰∫§jarÂåÖÂà∞nimbus/inboxÁõÆÂΩï‰∏ã ÂØπtopologyËøõË°åÊ†°È™åÂ§ÑÁêÜ nimbus/stormdist/${topology-id}‰∏ãÔºåÂåÖÂê´jarÂåÖ„ÄÅstormcodeÂ∫èÂàóÂåñÊñπÊ≥ï„ÄÅstormconfËøêË°åÈÖçÁΩÆ nimbusÂàùÂßãÂåñspout/boltÁöÑtaskÔºåÂÜôÂà∞zookeeperÁöÑ/tasksËäÇÁÇπ‰∏ã nimbusÂàõÂª∫/taskbeatsÁöÑzkËäÇÁÇπÔºåÁõëÊéßtaskÂøÉË∑≥ Â∞Ü‰ªªÂä°ÂàÜÈÖç‰ø°ÊÅØÔºåÂÜôÂà∞zk assignment/${topology-id}ËäÇÁÇπ‰∏≠ÔºåÊ≠§Êó∂ËÆ§‰∏∫‰ªªÂä°Êèê‰∫§ÂÆåÊØï Âú®zkÁöÑstorms/${topology-id}‰∏ãÂ≠òÊîæ‰ªªÂä°ÁöÑËøêË°åÊó∂Èó¥„ÄÅÁä∂ÊÄÅ‰ø°ÊÅØ Êú¨Âú∞ÁõÆÂΩïÊ†ë zookeeperÁõÆÂΩïÊ†ë Storm DRPCÂéüÁêÜ DRPC (Distributed RPC) remote procedure call ÂàÜÂ∏ÉÂºèËøúÁ®ãËøáÁ®ãË∞ÉÁî® DRPC ÊòØÈÄöËøá‰∏Ä‰∏™ DRPC ÊúçÂä°Á´Ø(DRPC server)Êù•ÂÆûÁé∞ÂàÜÂ∏ÉÂºè RPC ÂäüËÉΩÁöÑ„ÄÇ DRPC Server Ë¥üË¥£Êé•Êî∂ RPC ËØ∑Ê±ÇÔºåÂπ∂Â∞ÜËØ•ËØ∑Ê±ÇÂèëÈÄÅÂà∞ Storm‰∏≠ËøêË°åÁöÑ TopologyÔºåÁ≠âÂæÖÊé•Êî∂ Topology ÂèëÈÄÅÁöÑÂ§ÑÁêÜÁªìÊûúÔºåÂπ∂Â∞ÜËØ•ÁªìÊûúËøîÂõûÁªôÂèëÈÄÅËØ∑Ê±ÇÁöÑÂÆ¢Êà∑Á´Ø„ÄÇ ÔºàÂÖ∂ÂÆûÔºå‰ªéÂÆ¢Êà∑Á´ØÁöÑËßíÂ∫¶Êù•ËØ¥ÔºåDPRC ‰∏éÊôÆÈÄöÁöÑ RPC Ë∞ÉÁî®Âπ∂Ê≤°Êúâ‰ªÄ‰πàÂå∫Âà´„ÄÇÔºâ DRPCËÆæËÆ°ÁõÆÁöÑÔºö ‰∏∫‰∫ÜÂÖÖÂàÜÂà©Áî®StormÁöÑËÆ°ÁÆóËÉΩÂäõÂÆûÁé∞È´òÂØÜÂ∫¶ÁöÑÂπ∂Ë°åÂÆûÊó∂ËÆ°ÁÆó„ÄÇ ÔºàStormÊé•Êî∂Ëã•Âπ≤‰∏™Êï∞ÊçÆÊµÅËæìÂÖ•ÔºåÊï∞ÊçÆÂú®TopologyÂΩì‰∏≠ËøêË°åÂÆåÊàêÔºåÁÑ∂ÂêéÈÄöËøáDRPCÂ∞ÜÁªìÊûúËøõË°åËæìÂá∫„ÄÇÔºâ ÈÉ®ÁΩ≤1vi storm.yaml 12drpc.servers: - "node01" 12scp storm.yaml root@node02:`pwd`scp storm.yaml root@node03:`pwd` node01ÊâßË°å 123456nohup storm nimbus &gt;&gt; ./logs/nimbus.out 2&gt;&amp;1 &amp;tail -f logs/nimbus.lognohup storm drpc &gt;&gt; ./logs/drpc.out 2&gt;&amp;1 &amp;tail -f logs/drpc.lognohup storm ui &gt;&gt; ./logs/ui.out 2&gt;&amp;1 &amp;tail -f logs/ui.log node02 node03ÊâßË°å 123cd $STORM_HOMEnohup storm supervisor &gt;&gt; ./logs/supervisor.out 2&gt;&amp;1 &amp;tail -f logs/supervisor.log ‰ª£Á†ÅÂèÇËÄÉeclipse-hadoop-workspace/StormDemo 1scp drpc.jar root@node01:/root/ 1storm jar drpc.jar com.sxt.storm.drpc.BasicDRPCTopology test ÂÆ¢Êà∑Á´ØÊâßË°åÁªìÊûú 123456789101112131415public class MyDRPCclient &#123; public static void main(String[] args) &#123; DRPCClient client = new DRPCClient("node01", 3772); try &#123; String result = client.execute("exclamation", "11,22"); System.out.println(result); &#125; catch (TException e) &#123; e.printStackTrace(); &#125; catch (DRPCExecutionException e) &#123; e.printStackTrace(); &#125; &#125;&#125; Storm ÂÆπÈîôÊú∫Âà∂ÈõÜÁæ§ËäÇÁÇπÂÆïÊú∫ NimbusÊúçÂä°Âô® ÂçïÁÇπÊïÖÈöúÔºü ÈùûNimbusÊúçÂä°Âô® ÊïÖÈöúÊó∂ÔºåËØ•ËäÇÁÇπ‰∏äÊâÄÊúâTask‰ªªÂä°ÈÉΩ‰ºöË∂ÖÊó∂ÔºåNimbus‰ºöÂ∞ÜËøô‰∫õTask‰ªªÂä°ÈáçÊñ∞ÂàÜÈÖçÂà∞ÂÖ∂‰ªñÊúçÂä°Âô®‰∏äËøêË°å ËøõÁ®ãÊåÇÊéâWorkerÊåÇÊéâÊó∂ÔºåSupervisor‰ºöÈáçÊñ∞ÂêØÂä®Ëøô‰∏™ËøõÁ®ã„ÄÇÂ¶ÇÊûúÂêØÂä®ËøáÁ®ã‰∏≠‰ªçÁÑ∂‰∏ÄÁõ¥Â§±Ë¥•ÔºåÂπ∂‰∏îÊó†Ê≥ïÂêëNimbusÂèëÈÄÅÂøÉË∑≥ÔºåNimbus‰ºöÂ∞ÜËØ•WorkerÈáçÊñ∞ÂàÜÈÖçÂà∞ÂÖ∂‰ªñÊúçÂä°Âô®‰∏ä SupervisorÊó†Áä∂ÊÄÅÔºàÊâÄÊúâÁöÑÁä∂ÊÄÅ‰ø°ÊÅØÈÉΩÂ≠òÊîæÂú®Zookeeper‰∏≠Êù•ÁÆ°ÁêÜÔºâ Âø´ÈÄüÂ§±Ë¥•ÔºàÊØèÂΩìÈÅáÂà∞‰ªª‰ΩïÂºÇÂ∏∏ÊÉÖÂÜµÔºåÈÉΩ‰ºöËá™Âä®ÊØÅÁÅ≠Ôºâ NimbusÊó†Áä∂ÊÄÅÔºàÊâÄÊúâÁöÑÁä∂ÊÄÅ‰ø°ÊÅØÈÉΩÂ≠òÊîæÂú®Zookeeper‰∏≠Êù•ÁÆ°ÁêÜÔºâ Âø´ÈÄüÂ§±Ë¥•ÔºàÊØèÂΩìÈÅáÂà∞‰ªª‰ΩïÂºÇÂ∏∏ÊÉÖÂÜµÔºåÈÉΩ‰ºöËá™Âä®ÊØÅÁÅ≠Ôºâ Ê∂àÊÅØÁöÑÂÆåÊï¥ÊÄß ‰ªéSpout‰∏≠ÂèëÂá∫ÁöÑTupleÔºå‰ª•ÂèäÂü∫‰∫é‰ªñÊâÄ‰∫ßÁîüTupleÔºà‰æãÂ¶Ç‰∏ä‰∏™‰æãÂ≠êÂΩì‰∏≠SpoutÂèëÂá∫ÁöÑÂè•Â≠êÔºå‰ª•ÂèäÂè•Â≠êÂΩì‰∏≠ÂçïËØçÁöÑtupleÁ≠âÔºâ Áî±Ëøô‰∫õÊ∂àÊÅØÂ∞±ÊûÑÊàê‰∫Ü‰∏ÄÊ£µtupleÊ†ë ÂΩìËøôÊ£µtupleÊ†ëÂèëÈÄÅÂÆåÊàêÔºåÂπ∂‰∏îÊ†ëÂΩì‰∏≠ÊØè‰∏ÄÊù°Ê∂àÊÅØÈÉΩË¢´Ê≠£Á°ÆÂ§ÑÁêÜÔºåÂ∞±Ë°®ÊòéspoutÂèëÈÄÅÊ∂àÊÅØË¢´‚ÄúÂÆåÊï¥Â§ÑÁêÜ‚ÄùÔºåÂç≥Ê∂àÊÅØÁöÑÂÆåÊï¥ÊÄß ‰∏≠ÂõΩÁßªÂä®È°πÁõÆ‰ª£Á†ÅÂèÇËÄÉcmccstormjk02 Âíåcmcc02_hbase hbase1create 'cell_monitor_table','cf']]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[hadoopÊó•ÂøóÂàÜÊûêÂÆûÊàòÈ°πÁõÆÊê≠Âª∫ÂèäÂàÜÊûê]]></title>
    <url>%2F2019%2F06%2F21%2Fhadoop%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Êï¥‰ΩìÈ°πÁõÆÊµÅÁ®ã jsÊàñËÄÖjava sdkËÆøÈóÆnginxÊèê‰æõÁöÑÊé•Âè£ÔºånginxÂÜôÂÖ•ËÆøÈóÆÊó•ÂøóÊñá‰ª∂ flume tail -FÁõëÊéßÊó•ÂøóÊñá‰ª∂ÔºåÂ≠òÂÇ®Êó•ÂøóÂà∞hdfs ÈÄöËøáMapper Reducer ‰ªªÂä°ÔºåÊ∏ÖÊ¥óÊó•Âøó‰∏∫Ê†áÂáÜÁöÑÊï∞ÊçÆÔºåÂ≠òÂÇ®Âà∞hbase ÈÄöËøámap reduce ‰ªªÂä°ÔºåÊåâ‰∏çÂêåÁöÑÁª¥Â∫¶ÔºåÁªüËÆ°Êï∞ÊçÆÔºåÂÜôÂÖ•Âà∞mysql„ÄÇÊàñËÄÖ‰ΩøÁî®hiveÂª∫Á´ãÂ§ñÈÉ®Ë°®ÔºåÂÖ≥ËÅîhbaseÔºåÈÄöËøáspoopÔºåËΩ¨Êç¢hiveÊï∞ÊçÆÂà∞mysql„ÄÇ tengineÂÆâË£ÖÂèÇËÄÉ http://tengine.taobao.org/document/install.html NginxÊñáÊ°£ngx_http_log_moduleÊ®°Âùó ÂÆâË£Ö1234yum install gcc openssl-devel pcre-devel zlib-devel -y# ÊêúÁ¥¢yum search ÈÖçÁΩÆnginx.confÁöÑhttpÊ®°Âùó‰∏ãÈÖçÁΩÆ 1log_format my_format '$remote_addr^A$msec^A$http_host^A$request_uri'; serverÈÖçÁΩÆËÆøÈóÆÊó•ÂøóÁöÑÊ†ºÂºèÂíåÊñá‰ª∂Âú∞ÂùÄ 1234location = /log.gif &#123; default_type image/gif; access_log /opt/data/access.log my_format;&#125; ÂêØÂä®1./n flumeÂÆâË£ÖÂçïËäÇÁÇπÂèÇËÄÉÊñáÊ°£ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#a-simple-example ‰∏ä‰º†Ëß£Âéã123scp apache-flume-1.6.0-bin.tar.gz root@node02:/roottar -zxvf apache-flume-1.6.0-bin.tar.gzmv apache-flume-1.6.0-bin/ /usr/install/ ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè12vi /etc/profilesource /etc/profile 12export FLUME_HOME=/usr/install/apache-flume-1.6.0-binexport PATH=$PATH:$ZOOKEEPER_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$HIVE_HOME/bin:$HBASE_HOME/bin:$FLUME_HOME/bin ‰øÆÊîπconf/flume-env.sh Êñá‰ª∂‰∏≠ÁöÑJDKÁõÆÂΩï12cp flume-env.sh.template flume-env.shvi flume-env.sh 1export JAVA_HOME=/usr/install/jdk/jdk1.8.0_171 È™åËØÅÂÆâË£ÖÊòØÂê¶ÊàêÂäü1flume-ng version ‰øÆÊîπÈÖçÁΩÆ12cd conf/vi simple.conf 12345678910111213141516171819202122# Name the components on this agenta1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = netcata1.sources.r1.bind = node02a1.sources.r1.port = 44444# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®flume1flume-ng agent -n a1 -c conf -f simple.conf -Dflume.root.logger=INFO,console ÂèëÈÄÅÊï∞ÊçÆ1telnet node02 44444 ‰∏§‰∏™flumeÂÅöÈõÜÁæ§ÂèÇËÄÉÊñáÊ°£ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#setting-multi-agent-flow Âè≥‰æßËäÇÁÇπ(node03)ÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#avro-source 1vi double-flume.conf 123456789101112131415161718192021# Name the components on this agenta1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = avroa1.sources.r1.bind = node03a1.sources.r1.port = 60000# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f double-flume.conf -Dflume.root.logger=INFO,console Â∑¶‰æßËäÇÁÇπ(node02)ÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#avro-sink 1scp -r apache-flume-1.6.0-bin/ root@node03:/usr/install 1vi double-flume.conf 1234567891011121314151617181920212223a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = netcata1.sources.r1.bind = node02a1.sources.r1.port = 44444# Describe the sinka1.sinks.k1.type = avroa1.sinks.k1.hostname = node03a1.sinks.k1.port = 60000# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f double-flume.conf -Dflume.root.logger=INFO,console ÂèëÈÄÅÊï∞ÊçÆ1telnet node02 44444 Exec SourceÊñπÂºèÔºåÁõëÊéßÊñá‰ª∂tailÂëΩ‰ª§ÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#exec-source ÈÖçÁΩÆ1vi exec.conf 12345678910111213141516171819a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = execa1.sources.r1.command = tail -F /root/test.txt# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f exec.conf -Dflume.root.logger=INFO,console Ê∑ªÂä†Êï∞ÊçÆÂæ™ÁéØÊ∑ªÂä†Êï∞ÊçÆ 1for i in &#123;1..50&#125;; do echo "$i hi flume" &gt;&gt; /root/test.txt ; sleep 0.1; done Spooling Directory SourceÁõëÊéßÁõÆÂΩïÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#spooling-directory-source ÈÖçÁΩÆ1vi spool.conf 1234567891011121314151617181920a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = spooldira1.sources.r1.spoolDir = /root/logsa1.sources.r1.fileHeader = true# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f spool.conf -Dflume.root.logger=INFO,console Êã∑Ë¥ùÊñá‰ª∂ÊºîÁ§∫mkdir logs mv aa logs/ flumeÂíåkafka‰∏§ËÄÖÁªèÂ∏∏ÈÖçÂØπ‰ΩøÁî®ÔºåË∞ÅÂú®ÂâçÂêéÈÉΩÂèØ‰ª• hdfs sinkÊñπÂºèÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#hdfs-sink ÈÖçÁΩÆ1vi hdfs-sink.conf 12345678910111213141516171819202122232425262728293031323334353637383940414243a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = spooldira1.sources.r1.spoolDir = /root/logsa1.sources.r1.fileHeader = true# Describe the sink Êñá‰ª∂ÁõÆÂΩïÊ†ºÂºèa1.sinks.k1.type=hdfsa1.sinks.k1.hdfs.path=hdfs://mycluster/flume/%Y-%m-%d/%H%M##ÊØèÈöî60sÊàñËÄÖÊñá‰ª∂Â§ßÂ∞èË∂ÖËøá10MÁöÑÊó∂ÂÄô‰∫ßÁîüÊñ∞Êñá‰ª∂ÔºårollÂØπÊñá‰ª∂ËÆæÁΩÆ# hdfsÊúâÂ§öÂ∞ëÊù°Ê∂àÊÅØÊó∂Êñ∞Âª∫Êñá‰ª∂Ôºå0‰∏çÂü∫‰∫éÊ∂àÊÅØ‰∏™Êï∞a1.sinks.k1.hdfs.rollCount=0# hdfsÂàõÂª∫Â§öÈïøÊó∂Èó¥Êñ∞Âª∫Êñá‰ª∂Ôºå0‰∏çÂü∫‰∫éÊó∂Èó¥a1.sinks.k1.hdfs.rollInterval=60# hdfsÂ§öÂ§ßÊó∂Êñ∞Âª∫Êñá‰ª∂Ôºå0‰∏çÂü∫‰∫éÊñá‰ª∂Â§ßÂ∞èa1.sinks.k1.hdfs.rollSize=10240# ÂΩìÁõÆÂâçË¢´ÊâìÂºÄÁöÑ‰∏¥Êó∂Êñá‰ª∂Âú®ËØ•ÂèÇÊï∞ÊåáÂÆöÁöÑÊó∂Èó¥ÔºàÁßíÔºâÂÜÖÔºåÊ≤°Êúâ‰ªª‰ΩïÊï∞ÊçÆÂÜôÂÖ•ÔºåÂàôÂ∞ÜËØ•‰∏¥Êó∂Êñá‰ª∂ÂÖ≥Èó≠Âπ∂ÈáçÂëΩÂêçÊàêÁõÆÊ†áÊñá‰ª∂a1.sinks.k1.hdfs.idleTimeout=3a1.sinks.k1.hdfs.fileType=DataStreama1.sinks.k1.hdfs.useLocalTimeStamp=true## ÊØè‰∫îÂàÜÈíüÁîüÊàê‰∏Ä‰∏™ÁõÆÂΩïÔºåroundÂØπÁõÆÂΩïËÆæÁΩÆ# ÊòØÂê¶ÂêØÁî®Êó∂Èó¥‰∏äÁöÑ‚ÄùËàçÂºÉ‚ÄùÔºåËøôÈáåÁöÑ‚ÄùËàçÂºÉ‚ÄùÔºåÁ±ª‰ºº‰∫é‚ÄùÂõõËàç‰∫îÂÖ•‚ÄùÔºåÂêéÈù¢ÂÜç‰ªãÁªç„ÄÇÂ¶ÇÊûúÂêØÁî®ÔºåÂàô‰ºöÂΩ±ÂìçÈô§‰∫Ü%tÁöÑÂÖ∂‰ªñÊâÄÊúâÊó∂Èó¥Ë°®ËææÂºèa1.sinks.k1.hdfs.round=true# Êó∂Èó¥‰∏äËøõË°å‚ÄúËàçÂºÉ‚ÄùÁöÑÂÄºÔºõa1.sinks.k1.hdfs.roundValue=5# Êó∂Èó¥‰∏äËøõË°å‚ÄùËàçÂºÉ‚ÄùÁöÑÂçï‰ΩçÔºåÂåÖÂê´Ôºösecond,minute,houra1.sinks.k1.hdfs.roundUnit=minute# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f hdfs-sink.conf -Dflume.root.logger=INFO,console Êã∑Ë¥ùÊñá‰ª∂ÊºîÁ§∫12mkdir logsmv aa logs/ tengineÂíåflumeÈõÜÊàêÈÖçÁΩÆ1vi tengine_project.conf 12345678910111213141516171819202122232425a1.sources = r1a1.sinks = k1a1.channels = c1## ÁõëÂê¨tengineÁöÑaccess logÊñá‰ª∂a1.sources.r1.type = execa1.sources.r1.command = tail -F /opt/data/access.loga1.sinks.k1.type=hdfsa1.sinks.k1.hdfs.path=hdfs://mycluster/log/%Y%m%da1.sinks.k1.hdfs.rollCount=0a1.sinks.k1.hdfs.rollInterval=0a1.sinks.k1.hdfs.rollSize=10240a1.sinks.k1.hdfs.idleTimeout=5a1.sinks.k1.hdfs.fileType=DataStreama1.sinks.k1.hdfs.useLocalTimeStamp=truea1.sinks.k1.hdfs.callTimeout=40000a1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100a1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f tengine_project.conf -Dflume.root.logger=INFO,console Êã∑Ë¥ùÊñá‰ª∂ÊºîÁ§∫12mkdir logsmv aa logs/ ÁªèËøáETLÊ∏ÖÊ¥óÂ≠òÂÇ®Âà∞hbaseÁõÆÊ†á ËøáÊª§ËÑèÊï∞ÊçÆ ÂàÜÊûêIPÔºåÂæóÂà∞ÁúÅ„ÄÅÂ∏ÇÂå∫ ÂàÜÊûêuseragentÔºåÂæóÂà∞ÊµèËßàÂô®ÁâàÊú¨ AnalyserLogDataRunner123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152package com.sxt.etl.mr.ald;import java.io.IOException;import org.apache.commons.lang.StringUtils;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.hbase.HBaseConfiguration;import org.apache.hadoop.hbase.client.Put;import org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.mapreduce.Job;import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;import org.apache.hadoop.util.Tool;import org.apache.hadoop.util.ToolRunner;import org.apache.log4j.Logger;import com.sxt.common.EventLogConstants;import com.sxt.common.GlobalConstants;import com.sxt.util.TimeUtil;/** * ÁºñÂÜômapreduceÁöÑrunnerÁ±ª * * @author root * */public class AnalyserLogDataRunner implements Tool &#123; private static final Logger logger = Logger .getLogger(AnalyserLogDataRunner.class); private Configuration conf = null; public static void main(String[] args) &#123; try &#123; ToolRunner.run(new Configuration(), new AnalyserLogDataRunner(), args); &#125; catch (Exception e) &#123; logger.error("ÊâßË°åÊó•ÂøóËß£ÊûêjobÂºÇÂ∏∏", e); throw new RuntimeException(e); &#125; &#125; @Override public void setConf(Configuration conf) &#123; conf.set("fs.defaultFS", "hdfs://node01:8020");// conf.set("yarn.resourcemanager.hostname", "node3"); conf.set("hbase.zookeeper.quorum", "node02,node03,node04"); this.conf = HBaseConfiguration.create(conf); &#125; @Override public Configuration getConf() &#123; return this.conf; &#125; @Override public int run(String[] args) throws Exception &#123; Configuration conf = this.getConf(); this.processArgs(conf, args); Job job = Job.getInstance(conf, "analyser_logdata"); // ËÆæÁΩÆÊú¨Âú∞Êèê‰∫§jobÔºåÈõÜÁæ§ËøêË°åÔºåÈúÄË¶Å‰ª£Á†Å // File jarFile = EJob.createTempJar("target/classes"); // ((JobConf) job.getConfiguration()).setJar(jarFile.toString()); // ËÆæÁΩÆÊú¨Âú∞Êèê‰∫§jobÔºåÈõÜÁæ§ËøêË°åÔºåÈúÄË¶Å‰ª£Á†ÅÁªìÊùü job.setJarByClass(AnalyserLogDataRunner.class); job.setMapperClass(AnalyserLogDataMapper.class); job.setMapOutputKeyClass(NullWritable.class); job.setMapOutputValueClass(Put.class); // ËÆæÁΩÆreducerÈÖçÁΩÆ // 1. ÈõÜÁæ§‰∏äËøêË°åÔºåÊâìÊàêjarËøêË°å(Ë¶ÅÊ±ÇaddDependencyJarsÂèÇÊï∞‰∏∫trueÔºåÈªòËÆ§Â∞±ÊòØtrue) // TableMapReduceUtil.initTableReducerJob(EventLogConstants.HBASE_NAME_EVENT_LOGS, // null, job); // 2. Êú¨Âú∞ËøêË°åÔºåË¶ÅÊ±ÇÂèÇÊï∞addDependencyJars‰∏∫false TableMapReduceUtil.initTableReducerJob( EventLogConstants.HBASE_NAME_EVENT_LOGS, null, job, null, null, null, null, false); job.setNumReduceTasks(0); // ËÆæÁΩÆËæìÂÖ•Ë∑ØÂæÑ this.setJobInputPaths(job); return job.waitForCompletion(true) ? 0 : -1; &#125; /** * Â§ÑÁêÜÂèÇÊï∞ * * @param conf * @param args */ private void processArgs(Configuration conf, String[] args) &#123; String date = null; for (int i = 0; i &lt; args.length; i++) &#123; if ("-d".equals(args[i])) &#123; if (i + 1 &lt; args.length) &#123; date = args[++i]; break; &#125; &#125; &#125; System.out.println("-----" + date); // Ë¶ÅÊ±ÇdateÊ†ºÂºè‰∏∫: yyyy-MM-dd if (StringUtils.isBlank(date) || !TimeUtil.isValidateRunningDate(date)) &#123; // dateÊòØ‰∏Ä‰∏™Êó†ÊïàÊó∂Èó¥Êï∞ÊçÆ date = TimeUtil.getYesterday(); // ÈªòËÆ§Êó∂Èó¥ÊòØÊò®Â§© System.out.println(date); &#125; conf.set(GlobalConstants.RUNNING_DATE_PARAMES, date); &#125; /** * ËÆæÁΩÆjobÁöÑËæìÂÖ•Ë∑ØÂæÑ * * @param job */ private void setJobInputPaths(Job job) &#123; Configuration conf = job.getConfiguration(); FileSystem fs = null; try &#123; fs = FileSystem.get(conf); String date = conf.get(GlobalConstants.RUNNING_DATE_PARAMES); // Path inputPath = new Path("/flume/" + // TimeUtil.parseLong2String(TimeUtil.parseString2Long(date), // "MM/dd/")); Path inputPath = new Path("/log/" + TimeUtil.parseLong2String( TimeUtil.parseString2Long(date), "yyyyMMdd") + "/"); if (fs.exists(inputPath)) &#123; FileInputFormat.addInputPath(job, inputPath); &#125; else &#123; throw new RuntimeException("Êñá‰ª∂‰∏çÂ≠òÂú®:" + inputPath); &#125; &#125; catch (IOException e) &#123; throw new RuntimeException("ËÆæÁΩÆjobÁöÑmapreduceËæìÂÖ•Ë∑ØÂæÑÂá∫Áé∞ÂºÇÂ∏∏", e); &#125; finally &#123; if (fs != null) &#123; try &#123; fs.close(); &#125; catch (IOException e) &#123; // nothing &#125; &#125; &#125; &#125;&#125; AnalyserLogDataMapper123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141package com.sxt.etl.mr.ald;import java.io.IOException;import java.util.Map;import java.util.zip.CRC32;import org.apache.commons.lang.StringUtils;import org.apache.hadoop.hbase.client.Put;import org.apache.hadoop.hbase.util.Bytes;import org.apache.hadoop.io.LongWritable;import org.apache.hadoop.io.NullWritable;import org.apache.hadoop.io.Text;import org.apache.hadoop.mapreduce.Mapper;import org.apache.log4j.Logger;import com.sxt.common.EventLogConstants;import com.sxt.common.EventLogConstants.EventEnum;import com.sxt.etl.util.LoggerUtil;/** * Ëá™ÂÆö‰πâÊï∞ÊçÆËß£ÊûêmapÁ±ª * * @author root * */public class AnalyserLogDataMapper extends Mapper&lt;LongWritable, Text, NullWritable, Put&gt; &#123; private final Logger logger = Logger.getLogger(AnalyserLogDataMapper.class); private int inputRecords, filterRecords, outputRecords; // ‰∏ªË¶ÅÁî®‰∫éÊ†áÂøóÔºåÊñπ‰æøÊü•ÁúãËøáÊª§Êï∞ÊçÆ private byte[] family = Bytes.toBytes(EventLogConstants.EVENT_LOGS_FAMILY_NAME); private CRC32 crc32 = new CRC32(); @Override protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException &#123; this.inputRecords++; this.logger.debug("Analyse data of :" + value); try &#123; // Ëß£ÊûêÊó•Âøó Map&lt;String, String&gt; clientInfo = LoggerUtil.handleLog(value.toString()); // ËøáÊª§Ëß£ÊûêÂ§±Ë¥•ÁöÑÊï∞ÊçÆ if (clientInfo.isEmpty()) &#123; this.filterRecords++; return; &#125; // Ëé∑Âèñ‰∫ã‰ª∂ÂêçÁß∞ String eventAliasName = clientInfo.get(EventLogConstants.LOG_COLUMN_NAME_EVENT_NAME); EventEnum event = EventEnum.valueOfAlias(eventAliasName); switch (event) &#123; case LAUNCH: case PAGEVIEW: case CHARGEREQUEST: case CHARGEREFUND: case CHARGESUCCESS: case EVENT: // Â§ÑÁêÜÊï∞ÊçÆ this.handleData(clientInfo, event, context); break; default: this.filterRecords++; this.logger.warn("ËØ•‰∫ã‰ª∂Ê≤°Ê≥ïËøõË°åËß£ÊûêÔºå‰∫ã‰ª∂ÂêçÁß∞‰∏∫:" + eventAliasName); &#125; &#125; catch (Exception e) &#123; this.filterRecords++; this.logger.error("Â§ÑÁêÜÊï∞ÊçÆÂèëÂá∫ÂºÇÂ∏∏ÔºåÊï∞ÊçÆ:" + value, e); &#125; &#125; @Override protected void cleanup(Context context) throws IOException, InterruptedException &#123; super.cleanup(context); logger.info("ËæìÂÖ•Êï∞ÊçÆ:" + this.inputRecords + "ÔºõËæìÂá∫Êï∞ÊçÆ:" + this.outputRecords + "ÔºõËøáÊª§Êï∞ÊçÆ:" + this.filterRecords); &#125; /** * ÂÖ∑‰ΩìÂ§ÑÁêÜÊï∞ÊçÆÁöÑÊñπÊ≥ï * * @param clientInfo * @param context * @param event * @throws InterruptedException * @throws IOException */ private void handleData(Map&lt;String, String&gt; clientInfo, EventEnum event, Context context) throws IOException, InterruptedException &#123; String uuid = clientInfo.get(EventLogConstants.LOG_COLUMN_NAME_UUID); String memberId = clientInfo .get(EventLogConstants.LOG_COLUMN_NAME_MEMBER_ID); String serverTime = clientInfo .get(EventLogConstants.LOG_COLUMN_NAME_SERVER_TIME); if (StringUtils.isNotBlank(serverTime)) &#123; // Ë¶ÅÊ±ÇÊúçÂä°Âô®Êó∂Èó¥‰∏ç‰∏∫Á©∫ clientInfo.remove(EventLogConstants.LOG_COLUMN_NAME_USER_AGENT); // ÊµèËßàÂô®‰ø°ÊÅØÂéªÊéâ String rowkey = this.generateRowKey(uuid, memberId, event.alias, serverTime); // timestamp // + // (uuid+memberid+event).crc Put put = new Put(Bytes.toBytes(rowkey)); for (Map.Entry&lt;String, String&gt; entry : clientInfo.entrySet()) &#123; if (StringUtils.isNotBlank(entry.getKey()) &amp;&amp; StringUtils.isNotBlank(entry.getValue())) &#123; put.add(family, Bytes.toBytes(entry.getKey()), Bytes.toBytes(entry.getValue())); &#125; &#125; context.write(NullWritable.get(), put); this.outputRecords++; &#125; else &#123; this.filterRecords++; &#125; &#125; /** * Ê†πÊçÆuuid memberid servertimeÂàõÂª∫rowkey * * @param uuid * @param memberId * @param eventAliasName * @param serverTime * @return */ private String generateRowKey(String uuid, String memberId, String eventAliasName, String serverTime) &#123; StringBuilder sb = new StringBuilder(); sb.append(serverTime).append("_"); this.crc32.reset(); if (StringUtils.isNotBlank(uuid)) &#123; this.crc32.update(uuid.getBytes()); &#125; if (StringUtils.isNotBlank(memberId)) &#123; this.crc32.update(memberId.getBytes()); &#125; this.crc32.update(eventAliasName.getBytes()); sb.append(this.crc32.getValue() % 100000000L); return sb.toString(); &#125;&#125; map reduceÂàÜÊûêhbaseÁöÑÊï∞ÊçÆÔºåËêΩÂà∞mysqlÁªèËøá‰∏çÂêåÁª¥Â∫¶ mysqlÊï∞ÊçÆÂ∫ìÂáÜÂ§á1create database 'result_db'; ‰ΩøÁî®mysql_Ë°®ËÆæËÆ°.sqlÂàõÂª∫Ë°® Êñ∞Áî®Êà∑Ê®°ÂùóNewInstallUserMapperÁªèËøá1Ê¨°mapÔºåËæìÂá∫Â§ö‰∏™Áª¥Â∫¶ÔºåÂáèÂ∞ëÁΩëÁªúIO ËæìÂá∫ÁöÑkey StatsUserDimensionÔºåÂåÖÂê´‰ª•‰∏ã‰∏§‰∏™Áª¥Â∫¶„ÄÇÂàÜÂà´ÊòØÊôÆÈÄöÁªüËÆ°Áî®Êà∑ Êñ∞Áî®Êà∑ËÆøÈóÆÊï∞ÊçÆÔºö Êó∂Èó¥ ËÆøÈóÆÂπ≥Âè∞(jsÊµèËßàÂô®) ËÆøÈóÆÊµèËßàÂô® ËøôÊ†∑ÊµèËßàÂô®Êñ∞Áî®Êà∑KPIÔºåÂèØ‰ª•ÁªèËøáÁ¨õÂç°Â∞îÁßØ2*2ÔºåÁªüËÆ°4‰∏™Áª¥Â∫¶ÁöÑ‰ø°ÊÅØ„ÄÇ ÂΩìÂâçÊµèËßàÂô®(ÂÖ®ÈÉ®ÁâàÊú¨) ÂΩìÂâçÊµèËßàÂô®(ÁâàÊú¨1.0) ÂΩìÂâçÂπ≥Âè∞(jsÊµèËßàÂô®Á´ØÊàñËÄÖÊâãÊú∫ÂÆâÂçì) ÂÖ®ÈÉ®Âπ≥Âè∞ Âè¶Â§ñÔºåÂè™ÁªüËÆ°Êñ∞Áî®Êà∑KPIÔºåÂπ≥Âè∞‰ø°ÊÅØÊîØÊåÅËæìÂá∫Ôºå‰∏çÂ∏¶ÊµèËßàÂô®ÔºåÊúâ2ÁßçÁªìÊûú„ÄÇËøôÊ†∑4+2=6ÁßçÁªìÊûú„ÄÇ 12private StatsCommonDimension statsCommon = new StatsCommonDimension();private BrowserDimension browser = new BrowserDimension(); 12private StatsUserDimension statsUserDimension = new StatsUserDimension(); private TimeOutputValue timeOutputValue = new TimeOutputValue(); 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091package com.sxt.transformer.mr.nu;import java.io.IOException;import java.util.List;import org.apache.commons.lang.StringUtils;import org.apache.hadoop.hbase.client.Result;import org.apache.hadoop.hbase.io.ImmutableBytesWritable;import org.apache.hadoop.hbase.mapreduce.TableMapper;import org.apache.hadoop.hbase.util.Bytes;import org.apache.log4j.Logger;import com.sxt.common.DateEnum;import com.sxt.common.EventLogConstants;import com.sxt.common.KpiType;import com.sxt.transformer.model.dim.StatsCommonDimension;import com.sxt.transformer.model.dim.StatsUserDimension;import com.sxt.transformer.model.dim.base.BrowserDimension;import com.sxt.transformer.model.dim.base.DateDimension;import com.sxt.transformer.model.dim.base.KpiDimension;import com.sxt.transformer.model.dim.base.PlatformDimension;import com.sxt.transformer.model.value.map.TimeOutputValue;public class NewInstallUserMapper extends TableMapper&lt;StatsUserDimension, TimeOutputValue&gt;&#123; private static final Logger logger = Logger.getLogger(NewInstallUserMapper.class); private StatsUserDimension statsUserDimension = new StatsUserDimension(); private TimeOutputValue timeOutputValue = new TimeOutputValue(); private byte[] family = Bytes.toBytes(EventLogConstants.EVENT_LOGS_FAMILY_NAME); //‰ª£Ë°®Áî®Êà∑ÂàÜÊûêÊ®°ÂùóÁöÑÁªüËÆ° private KpiDimension newInstallUserKpi = new KpiDimension(KpiType.NEW_INSTALL_USER.name); //ÊµèËßàÂô®ÂàÜÊûêÊ®°ÂùóÁöÑÁªüËÆ° private KpiDimension newInstallUserOfBrowserKpi = new KpiDimension(KpiType.BROWSER_NEW_INSTALL_USER.name); @Override protected void map(ImmutableBytesWritable key, Result value, Context context) throws IOException, InterruptedException &#123; String uuid = Bytes.toString(value.getValue(family, Bytes.toBytes(EventLogConstants.LOG_COLUMN_NAME_UUID))); String serverTime = Bytes.toString(value.getValue(family, Bytes.toBytes(EventLogConstants.LOG_COLUMN_NAME_SERVER_TIME))); String platform = Bytes.toString(value.getValue(family, Bytes.toBytes(EventLogConstants.LOG_COLUMN_NAME_PLATFORM))); System.out.println(uuid + "-" + serverTime +"-"+ platform); if (StringUtils.isBlank(uuid) || StringUtils.isBlank(serverTime) || StringUtils.isBlank(platform)) &#123; logger.warn("uuid&amp;servertime&amp;platform‰∏çËÉΩ‰∏∫Á©∫"); return; &#125; long longOfTime = Long.valueOf(serverTime.trim()); timeOutputValue.setTime(longOfTime); timeOutputValue.setId(uuid); DateDimension dateDimension = DateDimension.buildDate(longOfTime, DateEnum.DAY); // ËÆæÁΩÆdateÁª¥Â∫¶ StatsCommonDimension statsCommonDimension = this.statsUserDimension.getStatsCommon(); statsCommonDimension.setDate(dateDimension); List&lt;PlatformDimension&gt; platformDimensions = PlatformDimension.buildList(platform); String browserName = Bytes.toString(value.getValue(family, Bytes.toBytes(EventLogConstants.LOG_COLUMN_NAME_BROWSER_NAME))); String browserVersion = Bytes.toString(value.getValue(family, Bytes.toBytes(EventLogConstants.LOG_COLUMN_NAME_BROWSER_VERSION))); List&lt;BrowserDimension&gt; browserDimensions = BrowserDimension.buildList(browserName, browserVersion); //Á©∫ÊµèËßàÂô®Áª¥Â∫¶Ôºå‰∏çËÄÉËôëÊµèËßàÂô®Áª¥Â∫¶ BrowserDimension defaultBrowser = new BrowserDimension("", ""); for(PlatformDimension pfDimension : platformDimensions) &#123; statsUserDimension.setBrowser(defaultBrowser); statsCommonDimension.setKpi(newInstallUserKpi); statsCommonDimension.setPlatform(pfDimension); context.write(statsUserDimension, timeOutputValue); for(BrowserDimension browserDimension : browserDimensions) &#123; statsUserDimension.setBrowser(browserDimension); statsCommonDimension.setKpi(newInstallUserOfBrowserKpi); context.write(statsUserDimension, timeOutputValue); &#125; &#125; &#125;&#125; NewInstallUserReducer12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152package com.sxt.transformer.mr.nu;import java.io.IOException;import org.apache.hadoop.mapreduce.Reducer;import com.sxt.transformer.model.dim.StatsUserDimension;import com.sxt.transformer.model.value.map.TimeOutputValue;import com.sxt.transformer.model.value.reduce.MapWritableValue;import java.io.IOException;import java.util.HashSet;import java.util.Set;import org.apache.hadoop.io.IntWritable;import org.apache.hadoop.io.MapWritable;import org.apache.hadoop.mapreduce.Reducer;import com.sxt.common.KpiType;public class NewInstallUserReducer extends Reducer&lt;StatsUserDimension, TimeOutputValue, StatsUserDimension, MapWritableValue&gt;&#123; private MapWritableValue outputValue = new MapWritableValue(); private Set&lt;String&gt; unique = new HashSet&lt;String&gt;(); @Override protected void reduce(StatsUserDimension key, Iterable&lt;TimeOutputValue&gt; values, Reducer&lt;StatsUserDimension, TimeOutputValue, StatsUserDimension, MapWritableValue&gt;.Context context) throws IOException, InterruptedException &#123; this.unique.clear(); for(TimeOutputValue value : values) &#123; this.unique.add(value.getId()); &#125; MapWritable map = new MapWritable(); map.put(new IntWritable(-1), new IntWritable(unique.size())); outputValue.setValue(map); String kpiName = key.getStatsCommon().getKpi().getKpiName(); if (KpiType.NEW_INSTALL_USER.name.equals(kpiName)) &#123; outputValue.setKpi(KpiType.NEW_INSTALL_USER); &#125;else if (KpiType.BROWSER_NEW_INSTALL_USER.name.equals(kpiName)) &#123; outputValue.setKpi(KpiType.BROWSER_NEW_INSTALL_USER); &#125; context.write(key, outputValue); &#125;&#125; Ê≥®ÊÑèÊ£ÄÊü•ÈÖçÁΩÆjdbc:mysql://node01:3306/result_db zkÈÖçÁΩÆ Âíå hdfsÈÖçÁΩÆÊ≠£Á°Æ„ÄÇ TransformerOutputFormat123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161package com.sxt.transformer.mr;import java.io.IOException;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.SQLException;import java.util.HashMap;import java.util.Map;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.mapreduce.JobContext;import org.apache.hadoop.mapreduce.OutputCommitter;import org.apache.hadoop.mapreduce.OutputFormat;import org.apache.hadoop.mapreduce.RecordWriter;import org.apache.hadoop.mapreduce.TaskAttemptContext;import org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter;import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;import org.apache.log4j.Logger;import com.sxt.common.GlobalConstants;import com.sxt.common.KpiType;import com.sxt.transformer.model.dim.base.BaseDimension;import com.sxt.transformer.model.value.BaseStatsValueWritable;import com.sxt.transformer.service.IDimensionConverter;import com.sxt.transformer.service.impl.DimensionConverterImpl;import com.sxt.util.JdbcManager;/** * Ëá™ÂÆö‰πâËæìÂá∫Âà∞mysqlÁöÑoutputformatÁ±ª * BaseDimension:reducerËæìÂá∫ÁöÑkey * BaseStatsValueWritableÔºöreducerËæìÂá∫ÁöÑvalue * @author root * */public class TransformerOutputFormat extends OutputFormat&lt;BaseDimension, BaseStatsValueWritable&gt; &#123; private static final Logger logger = Logger.getLogger(TransformerOutputFormat.class); /** * ÂÆö‰πâÊØèÊù°Êï∞ÊçÆÁöÑËæìÂá∫Ê†ºÂºèÔºå‰∏ÄÊù°Êï∞ÊçÆÂ∞±ÊòØreducer‰ªªÂä°ÊØèÊ¨°ÊâßË°åwriteÊñπÊ≥ïËæìÂá∫ÁöÑÊï∞ÊçÆ„ÄÇ */ @Override public RecordWriter&lt;BaseDimension, BaseStatsValueWritable&gt; getRecordWriter(TaskAttemptContext context) throws IOException, InterruptedException &#123; Configuration conf = context.getConfiguration(); Connection conn = null; IDimensionConverter converter = new DimensionConverterImpl(); try &#123; conn = JdbcManager.getConnection(conf, GlobalConstants.WAREHOUSE_OF_REPORT); conn.setAutoCommit(false); &#125; catch (SQLException e) &#123; logger.error("Ëé∑ÂèñÊï∞ÊçÆÂ∫ìËøûÊé•Â§±Ë¥•", e); throw new IOException("Ëé∑ÂèñÊï∞ÊçÆÂ∫ìËøûÊé•Â§±Ë¥•", e); &#125; return new TransformerRecordWriter(conn, conf, converter); &#125; @Override public void checkOutputSpecs(JobContext context) throws IOException, InterruptedException &#123; // Ê£ÄÊµãËæìÂá∫Á©∫Èó¥ÔºåËæìÂá∫Âà∞mysql‰∏çÁî®Ê£ÄÊµã &#125; @Override public OutputCommitter getOutputCommitter(TaskAttemptContext context) throws IOException, InterruptedException &#123; return new FileOutputCommitter(FileOutputFormat.getOutputPath(context), context); &#125; /** * Ëá™ÂÆö‰πâÂÖ∑‰ΩìÊï∞ÊçÆËæìÂá∫writer * * @author root * */ public class TransformerRecordWriter extends RecordWriter&lt;BaseDimension, BaseStatsValueWritable&gt; &#123; private Connection conn = null; private Configuration conf = null; private IDimensionConverter converter = null; private Map&lt;KpiType, PreparedStatement&gt; map = new HashMap&lt;KpiType, PreparedStatement&gt;(); private Map&lt;KpiType, Integer&gt; batch = new HashMap&lt;KpiType, Integer&gt;(); public TransformerRecordWriter(Connection conn, Configuration conf, IDimensionConverter converter) &#123; super(); this.conn = conn; this.conf = conf; this.converter = converter; &#125; @Override /** * ÂΩìreduce‰ªªÂä°ËæìÂá∫Êï∞ÊçÆÊòØÔºåÁî±ËÆ°ÁÆóÊ°ÜÊû∂Ëá™Âä®Ë∞ÉÁî®„ÄÇÊääreducerËæìÂá∫ÁöÑÊï∞ÊçÆÂÜôÂà∞mysql‰∏≠ */ public void write(BaseDimension key, BaseStatsValueWritable value) throws IOException, InterruptedException &#123; if (key == null || value == null) &#123; return; &#125; try &#123; KpiType kpi = value.getKpi(); PreparedStatement pstmt = null;//ÊØè‰∏Ä‰∏™pstmtÂØπË±°ÂØπÂ∫î‰∏Ä‰∏™sqlËØ≠Âè• int count = 1;//sqlËØ≠Âè•ÁöÑÊâπÂ§ÑÁêÜÔºå‰∏ÄÊ¨°ÊâßË°å10 if (map.get(kpi) == null) &#123; // ‰ΩøÁî®kpiËøõË°åÂå∫ÂàÜÔºåËøîÂõûsql‰øùÂ≠òÂà∞config‰∏≠ pstmt = this.conn.prepareStatement(conf.get(kpi.name)); map.put(kpi, pstmt); &#125; else &#123; pstmt = map.get(kpi); count = batch.get(kpi); count++; &#125; batch.put(kpi, count); // ÊâπÈáèÊ¨°Êï∞ÁöÑÂ≠òÂÇ® String collectorName = conf.get(GlobalConstants.OUTPUT_COLLECTOR_KEY_PREFIX + kpi.name); Class&lt;?&gt; clazz = Class.forName(collectorName); IOutputCollector collector = (IOutputCollector) clazz.newInstance();//ÊäävalueÊèíÂÖ•Âà∞mysqlÁöÑÊñπÊ≥ï„ÄÇÁî±‰∫ékpiÁª¥Â∫¶‰∏ç‰∏ÄÊ†∑„ÄÇÊèíÂÖ•Âà∞‰∏çËÉΩË°®ÈáåÈù¢„ÄÇ collector.collect(conf, key, value, pstmt, converter); if (count % Integer.valueOf(conf.get(GlobalConstants.JDBC_BATCH_NUMBER, GlobalConstants.DEFAULT_JDBC_BATCH_NUMBER)) == 0) &#123; pstmt.executeBatch(); conn.commit(); batch.put(kpi, 0); // ÂØπÂ∫îÊâπÈáèËÆ°ÁÆóÂà†Èô§ &#125; &#125; catch (Throwable e) &#123; logger.error("Âú®writer‰∏≠ÂÜôÊï∞ÊçÆÂá∫Áé∞ÂºÇÂ∏∏", e); throw new IOException(e); &#125; &#125; @Override public void close(TaskAttemptContext context) throws IOException, InterruptedException &#123; try &#123; for (Map.Entry&lt;KpiType, PreparedStatement&gt; entry : this.map.entrySet()) &#123; entry.getValue().executeBatch(); &#125; &#125; catch (SQLException e) &#123; logger.error("ÊâßË°åexecuteUpdateÊñπÊ≥ïÂºÇÂ∏∏", e); throw new IOException(e); &#125; finally &#123; try &#123; if (conn != null) &#123; conn.commit(); // ËøõË°åconnectionÁöÑÊèê‰∫§Âä®‰Ωú &#125; &#125; catch (Exception e) &#123; // nothing &#125; finally &#123; for (Map.Entry&lt;KpiType, PreparedStatement&gt; entry : this.map.entrySet()) &#123; try &#123; entry.getValue().close(); &#125; catch (SQLException e) &#123; // nothing &#125; &#125; if (conn != null) try &#123; conn.close(); &#125; catch (Exception e) &#123; // nothing &#125; &#125; &#125; &#125; &#125;&#125; ËøêË°årun as java application Ê∑ªÂä† ËøêË°åÂèÇÊï∞ -d 2019-06-15 Ë∑ëÂá∫ÁªìÊûúÔºådimension_ÂºÄÂ§¥‰∏∫Áª¥Â∫¶Ë°®Ôºåstats_ÂºÄÂ§¥‰∏∫ÁúüÊ≠£ÁöÑÁªüËÆ°Êï∞ÊçÆ hiveÂíåhbaseÊï¥ÂêàÂèÇËÄÉ https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration ÈÖçÁΩÆlibÊäähive-hbase-handler-1.2.1.jar cpÂà∞hbase/lib ‰∏ã 1cp hive-hbase-handler-1.2.1.jar $HBASE_HOME/lib/ ÂêåÊó∂Êäähbase‰∏≠ÁöÑÊâÄÊúâÁöÑjarÔºåcpÂà∞hive/lib 1cp -r $HBASE_HOME/lib/* ./ Âú®hiveÁöÑÈÖçÁΩÆÊñá‰ª∂Â¢ûÂä†Â±ûÊÄßÔºö1234&lt;property&gt; &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt; &lt;value&gt;node02,node03,node04&lt;/value&gt;&lt;/property&gt; Âú®hive‰∏≠ÂàõÂª∫‰∏¥Êó∂Ë°®12345678910CREATE EXTERNAL TABLE tmp_order(key string, id string, user_id string)STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,order:order_id,order:user_id")TBLPROPERTIES ("hbase.table.name" = "t_order");CREATE TABLE hbasetbl(key int, value string)STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf1:val")TBLPROPERTIES ("hbase.table.name" = "xyz", "hbase.mapred.output.outputtable" = "xyz"); hiveÂàÜÊûêsqoopËæìÂá∫Âà∞mysqlÂú®hive‰∏≠ÂàõÂª∫hbaseÁöÑevent_logÂØπÂ∫îË°®123456CREATE EXTERNAL TABLE event_logs(key string, pl string, en string, s_time bigint, p_url string, u_ud string, u_sd string) ROW FORMAT SERDE 'org.apache.hadoop.hive.hbase.HBaseSerDe'STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'with serdeproperties('hbase.columns.mapping'=':key,log:pl,log:en,log:s_time,log:p_url,log:u_ud,log:u_sd')tblproperties('hbase.table.name'='eventlog'); ÂàõÂª∫mysqlÂú®hive‰∏≠ÁöÑÂØπÂ∫îË°®123456789101112131415161718-- 2. ÂàõÂª∫mysqlÂú®hive‰∏≠ÁöÑÂØπÂ∫îË°®Ôºåhive‰∏≠ÁöÑË°®ÔºåÊâßË°åHQL‰πãÂêéÂàÜÊûêÁöÑÁªìÊûú‰øùÂ≠òËØ•Ë°®ÔºåÁÑ∂ÂêéÈÄöËøásqoopÂ∑•ÂÖ∑ÂØºÂá∫Âà∞mysqlCREATE TABLE `stats_view_depth` ( `platform_dimension_id` bigint , `data_dimension_id` bigint , `kpi_dimension_id` bigint , `pv1` bigint , `pv2` bigint , `pv3` bigint , `pv4` bigint , `pv5_10` bigint , `pv10_30` bigint , `pv30_60` bigint , `pv60_plus` bigint , `created` string) row format delimited fields terminated by '\t';-- 3. hiveÂàõÂª∫‰∏¥Êó∂Ë°®:ÊäähqlÂàÜÊûê‰πãÂêéÁöÑ‰∏≠Èó¥ÁªìÊûúÂ≠òÊîæÂà∞ÂΩìÂâçÁöÑ‰∏¥Êó∂Ë°®„ÄÇCREATE TABLE `stats_view_depth_tmp`(`pl` string, `date` string, `col` string, `ct` bigint); ÁºñÂÜôUDFÁºñÂÜôUDF(platformdimension &amp; datedimension)ÈúÄË¶ÅÊ≥®ÊÑèÔºåË¶ÅÂà†Èô§DimensionConvertClientÁ±ª‰∏≠ÊâÄÊúâFileSystemÂÖ≥Èó≠ÁöÑÊìç‰Ωú node03ÊâßË°å 1hive 1add jar /root/transform_date.jar; ÂàõÂª∫hiveÁöÑfunction 1create function date_convert as 'com.sxt.transformer.hive.DateDimensionUDF'; ÁªüËÆ°Áî®Êà∑ËßíÂ∫¶ÁöÑÊµèËßàÊ∑±Â∫¶ÂàÜÊûêÂæóÂà∞‰∏¥Êó∂Ë°®stats_view_depth_tmp tmpË°® ÂèØ‰ª•Â∞ÜtmpÔºåÊãÜÂàÜ‰∫ÜÁúãÊØîËæÉÊ∏ÖÊô∞„ÄÇ ÁªüËÆ°ÊØè‰∏™Áî®Êà∑„ÄÅÊØè‰∏™Âπ≥Âè∞ÔºåÂú®ÂΩìÂ§©ÁöÑËÆøÈóÆÊ¨°Êï∞ stats_view_depth_tmp groupby pl,day,pvÊï∞ÔºåÂ∞Üu_ud distinctÊ±ÇÂíåÔºåÂæóÂá∫ÂΩìÂ§©ÁöÑÂπ≥Âè∞ÁöÑÊüê‰∏™pvÊï∞ÁöÑÁî®Êà∑Êï∞ÔºåÂç≥pv 123456789101112131415161718192021222324-- 7. hqlÁºñÂÜô(ÁªüËÆ°Áî®Êà∑ËßíÂ∫¶ÁöÑÊµèËßàÊ∑±Â∫¶)&lt;Ê≥®ÊÑèÔºöÊó∂Èó¥‰∏∫Â§ñÈÉ®ÁªôÂÆö&gt;from ( select pl, from_unixtime(cast(s_time/1000 as bigint),'yyyy-MM-dd') as day, u_ud, (case when count(p_url) = 1 then "pv1" when count(p_url) = 2 then "pv2" when count(p_url) = 3 then "pv3" when count(p_url) = 4 then "pv4" when count(p_url) &gt;= 5 and count(p_url) &lt;10 then "pv5_10" when count(p_url) &gt;= 10 and count(p_url) &lt;30 then "pv10_30" when count(p_url) &gt;=30 and count(p_url) &lt;60 then "pv30_60" else 'pv60_plus' end) as pv from event_logs where en='e_pv' and p_url is not null and pl is not null and s_time &gt;= unix_timestamp('2019-06-15','yyyy-MM-dd')*1000 and s_time &lt; unix_timestamp('2019-06-16','yyyy-MM-dd')*1000 group by pl, from_unixtime(cast(s_time/1000 as bigint),'yyyy-MM-dd'), u_ud) as tmpinsert overwrite table stats_view_depth_tmp select pl,day,pv,count(distinct u_ud) as ct where u_ud is not null group by pl,day,pv; Â§öË°åËΩ¨1Ë°åÂπ≥Âè∞ Êó•Êúü pv1 Áî®Êà∑Êï∞ Â±ïÂºÄËΩ¨Êç¢‰∏∫ pv2 pv5 pv10 Á≠âÈÉΩ‰∏∫0 Âπ≥Âè∞ Êó•Êúü pv1 0 0 0 0 Áî®Êà∑Êï∞ pl date pv1 pv2 pv3 pv4 pv5 pv10 pv30 pv60 web_site 2019-06-15 5 0 0 0 0 0 0 0 1select pl,`date` as date1,ct as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv1' ËøôÊ†∑‰πãÂêéÔºåpv1Âà∞pv60ÔºåÈÉΩÂêàÂπ∂Ê±ÇÂíå„ÄÇÂêàÂπ∂Êàê1Ë°å„ÄÇ 12345678910111213141516171819202122232425--Êää‰∏¥Êó∂Ë°®ÁöÑÂ§öË°åÊï∞ÊçÆÔºåËΩ¨Êç¢‰∏ÄË°åwith tmp as(select pl,`date` as date1,ct as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv1' union allselect pl,`date` as date1,0 as pv1,ct as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv2' union allselect pl,`date` as date1,0 as pv1,0 as pv2,ct as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv3' union allselect pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,ct as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv4' union allselect pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,ct as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv5_10' union allselect pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,ct as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv10_30' union allselect pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,ct as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv30_60' union allselect pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,ct as pv60_plus from stats_view_depth_tmp where col='pv60_plus' union allselect 'all' as pl,`date` as date1,ct as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv1' union allselect 'all' as pl,`date` as date1,0 as pv1,ct as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv2' union allselect 'all' as pl,`date` as date1,0 as pv1,0 as pv2,ct as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv3' union allselect 'all' as pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,ct as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv4' union allselect 'all' as pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,ct as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv5_10' union allselect 'all' as pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,ct as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv10_30' union allselect 'all' as pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,ct as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv30_60' union allselect 'all' as pl,`date` as date1,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,ct as pv60_plus from stats_view_depth_tmp where col='pv60_plus')from tmpinsert overwrite table stats_view_depthselect 2,3,6,sum(pv1),sum(pv2),sum(pv3),sum(pv4),sum(pv5_10),sum(pv10_30),sum(pv30_60),sum(pv60_plus),'2019-06-15' group by pl,date1; ‰∏äÈù¢sql‰∏≠ÁöÑ2Ôºå3Ôºå6Ë¶ÅÂÖàËÆ°ÁÆóÂá∫Êù•ÔºåËøôÈáåÂÖàÊâãÂ∑•Â°´ÂÖ•„ÄÇ sqoopËÑöÊú¨ÁºñÂÜô(ÁªüËÆ°Áî®Êà∑ËßíÂ∫¶)1sqoop export --connect jdbc:mysql://node01:3306/result_db --username root --password 123 --table stats_view_depth --export-dir /user/hive/warehouse/stats_view_depth/* --input-fields-terminated-by "\t" --update-mode allowinsert --update-key platform_dimension_id,data_dimension_id,kpi_dimension_id ‚Äìexport-dir hiveË°®ÂØπÂ∫îÁöÑhdfs‰ΩçÁΩÆ ‚Äìinput-fields-terminated-by hiveË°®ÁöÑÂ≠óÊÆµÂàÜÈöîÁ¨¶ ‚Äìupdate-mode Êõ¥Êñ∞Ê®°Âºè ‚Äìupdate-key Êõ¥Êñ∞key ÊàêÂäüËæìÂá∫Âà∞mysql 12 3 6 0 0 0 0 1 0 0 0 2019-06-15 shellÂÆöÊó∂‰ªªÂä°‰ΩøÁî®cron ÂÆöÊó∂ÊâßË°åsqoopÂëΩ‰ª§ ÂèÇËÄÉ `` ÁªüËÆ°‰ºöËØùËßíÂ∫¶ÁöÑÊµèËßàÊ∑±Â∫¶ÁªüËÆ°ÂΩìÂ§©ÊØè‰∏™‰ºöËØùÊï∞ÊÆµÁöÑtmpË°®Ôºö group by pl,date , u_sd ÊØè‰∏™‰ºöËØùidÁöÑ pvÊï∞ stats_view_depth_tmpÔºö ÊØè‰∏™‰ºöËØùÊï∞ÊÆµÁöÑ ‰ºöËØùÊï∞ 12345678-- 8. hqlÁºñÂÜô(ÁªüËÆ°‰ºöËØùËßíÂ∫¶ÁöÑÊµèËßàÊ∑±Â∫¶)&lt;Ê≥®ÊÑèÔºöÊó∂Èó¥‰∏∫Â§ñÈÉ®ÁªôÂÆö&gt;from (select pl, from_unixtime(cast(s_time/1000 as bigint),'yyyy-MM-dd') as day, u_sd, (case when count(p_url) = 1 then "pv1" when count(p_url) = 2 then "pv2" when count(p_url) = 3 then "pv3" when count(p_url) = 4 then "pv4" when count(p_url) &gt;= 5 and count(p_url) &lt;10 then "pv5_10" when count(p_url) &gt;= 10 and count(p_url) &lt;30 then "pv10_30" when count(p_url) &gt;=30 and count(p_url) &lt;60 then "pv30_60" else 'pv60_plus' end) as pvfrom event_logswhere en='e_pv' and p_url is not null and pl is not null and s_time &gt;= unix_timestamp('2019-06-15','yyyy-MM-dd')*1000 and s_time &lt; unix_timestamp('2019-06-16','yyyy-MM-dd')*1000group by pl, from_unixtime(cast(s_time/1000 as bigint),'yyyy-MM-dd'), u_sd) as tmpinsert overwrite table stats_view_depth_tmp select pl,day,pv,count(distinct u_sd) as ct where u_sd is not null group by pl,day,pv; Â§öË°åËΩ¨1Ë°ådate_convert Êó•ÊúüËΩ¨Êç¢ÂáΩÊï∞ platform_convert Âπ≥Âè∞ËΩ¨ÂåñÂáΩÊï∞ 1234567891011121314151617181920212223242526272829with tmp as(select pl,date,ct as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv1' union allselect pl,date,0 as pv1,ct as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv2' union allselect pl,date,0 as pv1,0 as pv2,ct as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv3' union allselect pl,date,0 as pv1,0 as pv2,0 as pv3,ct as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv4' union allselect pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,ct as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv5_10' union allselect pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,ct as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv10_30' union allselect pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,ct as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv30_60' union allselect pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,ct as pv60_plus from stats_view_depth_tmp where col='pv60_plus' union allselect 'all' as pl,date,ct as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv1' union allselect 'all' as pl,date,0 as pv1,ct as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv2' union allselect 'all' as pl,date,0 as pv1,0 as pv2,ct as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv3' union allselect 'all' as pl,date,0 as pv1,0 as pv2,0 as pv3,ct as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv4' union allselect 'all' as pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,ct as pv5_10,0 as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv5_10' union allselect 'all' as pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,ct as pv10_30,0 as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv10_30' union allselect 'all' as pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,ct as pv30_60,0 as pv60_plus from stats_view_depth_tmp where col='pv30_60' union allselect 'all' as pl,date,0 as pv1,0 as pv2,0 as pv3,0 as pv4,0 as pv5_10,0 as pv10_30,0 as pv30_60,ct as pv60_plus from stats_view_depth_tmp where col='pv60_plus')from tmpinsert overwrite table stats_view_depthselect platform_convert(pl),date_convert(date),6,sum(pv1),sum(pv2),sum(pv3),sum(pv4),sum(pv5_10),sum(pv10_30),sum(pv30_60),sum(pv60_plus),'2019-06-15' group by pl,date;-- 9. sqoopËÑöÊ≠•ÁºñÂÜô(ÁªüËÆ°‰ºöËØùËßíÂ∫¶)sqoop export --connect jdbc:mysql://node01:3306/result_db --username root --password 123 --table stats_view_depth --export-dir /user/hive/warehouse/stats_view_depth/* --input-fields-terminated-by "\t" --update-mode allowinsert --update-key platform_dimension_id,data_dimension_id,kpi_dimension_id-- 10. shellËÑöÊ≠•ÁºñÂÜô sqoop Â∞ÜÂÖ≥Á≥ªÊï∞ÊçÆÂ∫ìÔºàoracle„ÄÅmysql„ÄÅpostgresqlÁ≠âÔºâÊï∞ÊçÆ‰∏éhadoopÊï∞ÊçÆËøõË°åËΩ¨Êç¢ÁöÑÂ∑•ÂÖ∑ sqoopÁî±clientÁ´ØÁõ¥Êé•Êé•ÂÖ•hadoopÔºå‰ªªÂä°ÈÄöËøáËß£ÊûêÁîüÊàêÂØπÂ∫îÁöÑmaprecueÊâßË°å ÂÆâË£Önode04‰∏≠Ëß£ÂéãÂÆâË£ÖÔºåÊ≥®ÊÑè‰∏ãËΩΩÂÆåÊï¥Áâà http://www.apache.org/dyn/closer.lua/sqoop/1.4.7 1scp /Users/zhouxiaowu/big-data/sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz root@node04:/root/ 12mv sqoop-1.4.7.tar.gz /usr/install/tar -zxvf sqoop-1.4.7.tar.gz ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè 123456vi /etc/profileexport SQOOP_HOME=/usr/install/sqoop-1.4.7export PATH=$PATH:$JAVA_HOME/bin:$ZOOKEEPER_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$HBASE_HOME/bin:$SQOOP_HOME/binsource /etc/profile Ê∑ªÂä†Êï∞ÊçÆÂ∫ìÈ©±Âä®ÂåÖ 1scp /Users/zhouxiaowu/big-data/hadoopÈ°πÁõÆ1/01ËµÑÊñô/mysql-connector-java-5.1.26-bin.jar root@node04:/root/ 1mv ~/mysql-connector-java-5.1.26-bin.jar lib/ ÈáçÂëΩÂêçÈÖçÁΩÆÊñá‰ª∂ 1mv sqoop-env-template.sh sqoop-env.sh ÊµãËØï 12sqoop versionsqoop list-databases -connect jdbc:mysql://node01:3306/ -username root -password 123 ÂéªÈô§Ë≠¶Âëä 1vi configure-sqoop ÂéªÊéâÊú™ÂÆâË£ÖÊúçÂä°Áõ∏ÂÖ≥ÂÜÖÂÆπÔºå ‰æãÂ¶ÇÔºàHBase„ÄÅHCatalog„ÄÅAccumuloÔºâ 1234#if [ ! -d "$&#123;HBASE_HOME&#125;" ]; then# echo "Error: $HBASE_HOME does not exist!"# echo 'Please set $HBASE_HOME to the root of your HBase installation.'# exit 1 http://sqoop.apache.org/docs/1.4.7/SqoopUserGuide.html ÂØºÂÖ• ÂëΩ‰ª§Ë°åÊñπÂºè Êñá‰ª∂ÈÖçÁΩÆÊñπÂºè 123$ sqoop import --connect jdbc:mysql://localhost/db --username foo --table TEST$ sqoop --options-file /users/homer/work/import.txt --table TEST ÂèÇËÄÉ http://sqoop.apache.org/docs/1.4.6/SqoopUserGuide.html#_literal_sqoop_import_literal 123456create table t_test( id int default '0' null, name varchar(100) default '' null); mysqlÂØºÂÖ•Âà∞hdfsvi option1 1234567891011121314151617import--connectjdbc:mysql://node01:3306/test--usernameroot--password123--as-textfile--columnsid,name--tablet_test--delete-target-dir--target-dir/sqoop/data-m1 1sqoop --options-file /root/sqoop_option/option1 mysqlÂØºÂÖ•Âà∞hdfsÔºåÂ∏¶Êü•ËØ¢1vi option2 123456789101112131415161718192021import--connectjdbc:mysql://node01/test--usernameroot--password123--as-textfile--query'select id, name, msg from psn where id like "1%" and $CONDITIONS'--delete-target-dir--target-dir/sqoop/tmp-m1--hive-home/home/hive-1.2.1--hive-import--create-hive-table--hive-tablet_test ÂØºÂá∫ÂèÇËÄÉ http://sqoop.apache.org/docs/1.4.6/SqoopUserGuide.html#_literal_sqoop_export_literal ÂàõÂª∫mysqlË°® 12345create table t_test2( id int default '0' null, name varchar(100) default '' null) ÂàõÂª∫ÂëΩ‰ª§ÈÖçÁΩÆ 1vi option3 123456789101112131415export--connectjdbc:mysql://node01/test--usernameroot--password123-m1--columnsid,name--export-dir/sqoop/data--tablet_test2 ÊâßË°å 1sqoop --options-file /root/sqoop_option/option3]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[javaÁ∫øÁ®ãÊ±†ËÆæÁΩÆÊåáÂçó]]></title>
    <url>%2F2019%2F06%2F12%2Fjava%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AE%BE%E7%BD%AE%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[Á∫øÁ®ãÊï∞ËÆæÁΩÆÂÖ¨Âºè1ÊúÄ‰Ω≥Á∫øÁ®ãÊï∞ÁõÆ = ÔºàÔºàÁ∫øÁ®ãÁ≠âÂæÖÊó∂Èó¥+Á∫øÁ®ãCPUÊó∂Èó¥Ôºâ/Á∫øÁ®ãCPUÊó∂Èó¥ Ôºâ* CPUÊï∞ÁõÆ ÊúçÂä°Âô®CPUÊ†∏Êï∞‰∏∫4Ê†∏Ôºå‰∏Ä‰∏™‰ªªÂä°Á∫øÁ®ãcpuËÄóÊó∂‰∏∫20msÔºåÁ∫øÁ®ãÁ≠âÂæÖÔºàÁΩëÁªúIO„ÄÅÁ£ÅÁõòIOÔºâËÄóÊó∂80msÔºåÈÇ£ÊúÄ‰Ω≥Á∫øÁ®ãÊï∞ÁõÆÔºö( 80 + 20 )/20 * 4 = 20„ÄÇ‰πüÂ∞±ÊòØËÆæÁΩÆ20‰∏™Á∫øÁ®ãÊï∞ÊúÄ‰Ω≥„ÄÇ ‰ªéËøô‰∏™ÂÖ¨Âºè‰∏äÈù¢Êàë‰ª¨Â∞±ÂæóÂá∫ÔºåÁ∫øÁ®ãÁöÑÁ≠âÂæÖÊó∂Èó¥Ë∂äÂ§ßÔºåÁ∫øÁ®ãÊï∞Â∞±Ë¶ÅËÆæÁΩÆË∂äÂ§ßÔºåËøô‰∏™Ê≠£Â•ΩÁ¨¶ÂêàÊàë‰ª¨‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÂèØÊèêÂçáCPUÂà©Áî®Áéá„ÄÇÈÇ£‰ªéÂè¶‰∏Ä‰∏™ËßíÂ∫¶‰∏äÈù¢ËØ¥ÔºåÁ∫øÁ®ãÊï∞ËÆæÁΩÆÂ§öÂ§ßÔºåÊòØÊ†πÊçÆÊàë‰ª¨Ëá™Ë∫´ÁöÑ‰∏öÂä°ÁöÑÔºåÈúÄË¶ÅËá™Â∑±ÂéªÂéãÂäõÊµãËØïÔºåËÆæÁΩÆ‰∏Ä‰∏™ÂêàÁêÜÁöÑÊï∞ÂÄº„ÄÇ Â∏∏Áî®Ê†áÂáÜËÆæÁΩÆCPUÂØÜÈõÜÂûãÔºöÊìç‰ΩúÂÜÖÂ≠òÂ§ÑÁêÜÁöÑ‰∏öÂä°Ôºå‰∏ÄËà¨Á∫øÁ®ãÊï∞ËÆæÁΩÆ‰∏∫ÔºöCPUÊ†∏Êï∞ + 1 ÊàñËÄÖ CPUÊ†∏Êï∞2Ê†∏Êï∞‰∏∫4ÁöÑËØùÔºå‰∏ÄËà¨ËÆæÁΩÆ 5 Êàñ 8*IOÂØÜÈõÜÂûãÔºö Êñá‰ª∂Êìç‰ΩúÔºåÁΩëÁªúÊìç‰ΩúÔºåÊï∞ÊçÆÂ∫ìÊìç‰ΩúÔºå‰∏ÄËà¨Á∫øÁ®ãËÆæÁΩÆ‰∏∫ÔºöcpuÊ†∏Êï∞ / (1-0.9)Ê†∏Êï∞‰∏∫4ÁöÑËØùÔºå‰∏ÄËà¨ËÆæÁΩÆ 40]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[jfrÈááÈõÜ‰ΩøÁî®ÂèäjmcÂàÜÊûê]]></title>
    <url>%2F2019%2F06%2F11%2Fjfr%E9%87%87%E9%9B%86%E4%BD%BF%E7%94%A8%E5%8F%8Ajmc%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÊâæÂà∞javaËøõÁ®ã1ps -ef | grep java Ëß£ÈîÅJavaÁ®ãÂ∫èÁöÑÂïÜ‰∏öÁâπÊÄß1234jcmd 12174 VM.check_commercial_features12174:Commercial Features are locked. ÈááÈõÜJFRÂõ∫ÂÆöÊó∂ÈïøÈááÈõÜ123jcmd $pid JFR.start name=myrec settings=temple delay=20s duration=2m filename=/tmp/$pid.jfrjcmd 12174 JFR.start name=10min.jfr settings=profile delay=3s duration=5m ÊåÅÁª≠ÈááÈõÜJFR1jcmd 12174 JFR.start name=endless settings=profile delay=3s duration=0 compress=true ÂØπ‰∫éËøôÁßçÊåÅÁª≠ÈááÈõÜÁöÑ‰ªªÂä°ÔºåÊàë‰ª¨ÈúÄË¶ÅÊâãÂä®ËΩ¨Â≠òÔºö 1jcmd 12174 JFR.dump recording=3 filename="/Users/jianyuan/Personal/dump_endless.jfr" compress=true ÂàÜÊûêJFRÊñá‰ª∂Á∫ø‰∏ãËæìÂÖ•jmc 1jmc ÊâìÂºÄjava mission control ÈÄâÊã©ÊâìÂºÄÂØºÂá∫ÁöÑjfrÊñá‰ª∂ ÂàÜÊûêËßíÂ∫¶‰∏ÄËà¨Êù•ËØ¥ÂèØ‰ª•‰ªé‰∏ãÈù¢Âá†‰∏™ÊñπÂºèÊù•ÂÖ•ÊâãÔºö Â∫îÁî®ÂºÇÂ∏∏ ÁÉ≠ÁÇπÁ∫øÁ®ãÂíåÊñπÊ≥ï ‰∏çÂêàÈ¢ÑÊúüÁöÑIO ËøáÈïøÁöÑGC ÂèÇËÄÉ https://blog.csdn.net/yue530tomtom/article/details/80805412 http://www.manongjc.com/article/7589.html]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Arthas‰ΩøÁî®ÊñáÊ°£]]></title>
    <url>%2F2019%2F06%2F11%2FArthas%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[ÂÆâË£ÖÊâãÂä®ÂÆâË£ÖÊé®Ëçêhttps://alibaba.github.io/arthas/manual-install.html ‰ΩøÁî®ÂëΩ‰ª§watch Êü•ÁúãÊñπÊ≥ïÁöÑËøîÂõûÂÄº12watch demo.MathGame primeFactors returnObjwatch stack Êü•ÁúãÊñπÊ≥ïË∞ÉÁî®Ê†àÂèÇËÄÉ https://alibaba.github.io/arthas/stack.html 1stack demo.MathGame primeFactors threadÂèÇËÄÉ https://alibaba.github.io/arthas/thread.html ÂΩìÂâçÊúÄÂøôÁöÑÂâçN‰∏™Á∫øÁ®ã1thread -n 3 ÊâæÂá∫ÂΩìÂâçÈòªÂ°ûÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÁ∫øÁ®ã1thread -b]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[HBaseÂéüÁêÜÊ°à‰æãÂèäÊê≠Âª∫]]></title>
    <url>%2F2019%2F06%2F08%2FHBase%E5%8E%9F%E7%90%86%E6%A1%88%E4%BE%8B%E5%8F%8A%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[HBase Êï∞ÊçÆÊ®°Âûã Row Key Time Stamp CF1 CF2 CF3 11248112 t6 CF2:q1=val1 CF3:q3=val3 t3 t2 CF1:q2=val2 ROW KEY ÂÜ≥ÂÆö‰∏ÄË°åÊï∞ÊçÆ ÊåâÁÖßÂ≠óÂÖ∏È°∫Â∫èÊéíÂ∫èÁöÑ„ÄÇ Row keyÂè™ËÉΩÂ≠òÂÇ®64kÁöÑÂ≠óËäÇÊï∞ÊçÆ Column FamilyÂàóÊóè HBaseË°®‰∏≠ÁöÑÊØè‰∏™ÂàóÈÉΩÂΩíÂ±û‰∫éÊüê‰∏™ÂàóÊóèÔºåÂàóÊóèÂøÖÈ°ª‰Ωú‰∏∫Ë°®Ê®°Âºè(schema)ÂÆö‰πâÁöÑ‰∏ÄÈÉ®ÂàÜÈ¢ÑÂÖàÁªôÂá∫„ÄÇÂ¶Çcreate &#39;tbl&#39;, ‚Äòcf‚Äô ÂàóÂêç‰ª•ÂàóÊóè‰Ωú‰∏∫ÂâçÁºÄÔºåcf:name ÊùÉÈôêÊéßÂà∂„ÄÅÂ≠òÂÇ®‰ª•ÂèäË∞É‰ºòÈÉΩÊòØÂú®ÂàóÊóèÂ±ÇÈù¢ËøõË°åÁöÑÔºõ HBaseÊääÂêå‰∏ÄÂàóÊóèÈáåÈù¢ÁöÑÊï∞ÊçÆÂ≠òÂÇ®Âú®Âêå‰∏ÄÁõÆÂΩï‰∏ãÔºåÁî±Âá†‰∏™Êñá‰ª∂‰øùÂ≠ò„ÄÇ TimestampÊó∂Èó¥Êà≥ Âú®HBaseÊØè‰∏™cellÂ≠òÂÇ®ÂçïÂÖÉÂØπÂêå‰∏Ä‰ªΩÊï∞ÊçÆÊúâÂ§ö‰∏™ÁâàÊú¨ÔºåÊ†πÊçÆÂîØ‰∏ÄÁöÑÊó∂Èó¥Êà≥Êù•Âå∫ÂàÜÊØè‰∏™ÁâàÊú¨‰πãÈó¥ÁöÑÂ∑ÆÂºÇÔºå‰∏çÂêåÁâàÊú¨ÁöÑÊï∞ÊçÆÊåâÁÖßÊó∂Èó¥ÂÄíÂ∫èÊéíÂ∫èÔºåÊúÄÊñ∞ÁöÑÊï∞ÊçÆÁâàÊú¨ÊéíÂú®ÊúÄÂâçÈù¢„ÄÇ Êó∂Èó¥Êà≥ÁöÑÁ±ªÂûãÊòØ 64‰ΩçÊï¥Âûã„ÄÇ Êó∂Èó¥Êà≥ÂèØ‰ª•Áî±HBase(Âú®Êï∞ÊçÆÂÜôÂÖ•Êó∂Ëá™Âä®)ËµãÂÄºÔºåÊ≠§Êó∂Êó∂Èó¥Êà≥ÊòØÁ≤æÁ°ÆÂà∞ÊØ´ÁßíÁöÑÂΩìÂâçÁ≥ªÁªüÊó∂Èó¥„ÄÇ Êó∂Èó¥Êà≥‰πüÂèØ‰ª•Áî±ÂÆ¢Êà∑ÊòæÂºèËµãÂÄºÔºåÂ¶ÇÊûúÂ∫îÁî®Á®ãÂ∫èË¶ÅÈÅøÂÖçÊï∞ÊçÆÁâàÊú¨ÂÜ≤Á™ÅÔºåÂ∞±ÂøÖÈ°ªËá™Â∑±ÁîüÊàêÂÖ∑ÊúâÂîØ‰∏ÄÊÄßÁöÑÊó∂Èó¥Êà≥„ÄÇ CellÂçïÂÖÉÊ†º Áî±{row keyÔºå column(&lt;family&gt; +&lt;qualifier&gt;)Ôºå version}ÂîØ‰∏ÄÁ°ÆÂÆöÁöÑÂçïÂÖÉ„ÄÇ cell‰∏≠ÁöÑÊï∞ÊçÆÊòØÊ≤°ÊúâÁ±ªÂûãÁöÑÔºåÂÖ®ÈÉ®ÊòØÂ≠óËäÇÁ†ÅÂΩ¢ÂºèÂ≠òË¥Æ„ÄÇ HLog(WAL log) HLogÊñá‰ª∂Â∞±ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑHadoop Sequence FileÔºåSequence File ÁöÑKeyÊòØHLogKeyÂØπË±°ÔºåHLogKey‰∏≠ËÆ∞ÂΩï‰∫ÜÂÜôÂÖ•Êï∞ÊçÆÁöÑÂΩíÂ±û‰ø°ÊÅØÔºåÈô§‰∫ÜtableÂíåregionÂêçÂ≠óÂ§ñÔºåÂêåÊó∂ËøòÂåÖÊã¨ sequence numberÂíåtimestampÔºåtimestampÊòØ‚Äù ÂÜôÂÖ•Êó∂Èó¥‚ÄùÔºåsequence numberÁöÑËµ∑ÂßãÂÄº‰∏∫0ÔºåÊàñËÄÖÊòØÊúÄËøë‰∏ÄÊ¨°Â≠òÂÖ•Êñá‰ª∂Á≥ªÁªü‰∏≠sequence number„ÄÇ Á±ª‰ººbinlog HBase Êû∂ÊûÑ ÂÜôÊµÅÁ®ã clientËÆ∞ÂΩïÂÜôÂÖ•Êï∞ÊçÆÔºåÂà∞Hlog memstore memstoreËææÂà∞ÈòàÂÄº,ÂÜôÂÖ•Âà∞store file Client ÂåÖÂê´ËÆøÈóÆHBaseÁöÑÊé•Âè£Âπ∂Áª¥Êä§cacheÊù•Âä†Âø´ÂØπHBaseÁöÑËÆøÈóÆ Zookeeper ‰øùËØÅ‰ªª‰ΩïÊó∂ÂÄôÔºåÈõÜÁæ§‰∏≠Âè™Êúâ‰∏Ä‰∏™master Â≠òË¥ÆÊâÄÊúâRegionÁöÑÂØªÂùÄÂÖ•Âè£„ÄÇ ÂÆûÊó∂ÁõëÊéßRegion serverÁöÑ‰∏äÁ∫øÂíå‰∏ãÁ∫ø‰ø°ÊÅØ„ÄÇÂπ∂ÂÆûÊó∂ÈÄöÁü•Master Â≠òÂÇ®HBaseÁöÑschemaÂíåtableÂÖÉÊï∞ÊçÆ Master ‰∏∫Region serverÂàÜÈÖçregion Ë¥üË¥£Region serverÁöÑË¥üËΩΩÂùáË°° ÂèëÁé∞Â§±ÊïàÁöÑRegion serverÂπ∂ÈáçÊñ∞ÂàÜÈÖçÂÖ∂‰∏äÁöÑregion ÁÆ°ÁêÜÁî®Êà∑ÂØπtableÁöÑÂ¢ûÂà†ÊîπÊìç‰Ωú RegionServer Region serverÁª¥Êä§regionÔºåÂ§ÑÁêÜÂØπËøô‰∫õregionÁöÑIOËØ∑Ê±Ç Region serverË¥üË¥£ÂàáÂàÜÂú®ËøêË°åËøáÁ®ã‰∏≠ÂèòÂæóËøáÂ§ßÁöÑregion Region HBaseËá™Âä®ÊääË°®Ê∞¥Âπ≥ÂàíÂàÜÊàêÂ§ö‰∏™Âå∫Âüü(region)ÔºåÊØè‰∏™region‰ºö‰øùÂ≠ò‰∏Ä‰∏™Ë°®ÈáåÈù¢ÊüêÊÆµËøûÁª≠ÁöÑÊï∞ÊçÆ ÊØè‰∏™Ë°®‰∏ÄÂºÄÂßãÂè™Êúâ‰∏Ä‰∏™regionÔºåÈöèÁùÄÊï∞ÊçÆ‰∏çÊñ≠ÊèíÂÖ•Ë°®Ôºåregion‰∏çÊñ≠Â¢ûÂ§ßÔºåÂΩìÂ¢ûÂ§ßÂà∞‰∏Ä‰∏™ÈòÄÂÄºÁöÑÊó∂ÂÄôÔºåregionÂ∞±‰ºöÁ≠âÂàÜ‰ºö‰∏§‰∏™Êñ∞ÁöÑregionÔºàË£ÇÂèòÔºâ ÂΩìtable‰∏≠ÁöÑË°å‰∏çÊñ≠Â¢ûÂ§öÔºåÂ∞±‰ºöÊúâË∂äÊù•Ë∂äÂ§öÁöÑregion„ÄÇËøôÊ†∑‰∏ÄÂº†ÂÆåÊï¥ÁöÑË°®Ë¢´‰øùÂ≠òÂú®Â§ö‰∏™Regionserver ‰∏ä„ÄÇ HRegionÊòØHBase‰∏≠ÂàÜÂ∏ÉÂºèÂ≠òÂÇ®ÂíåË¥üËΩΩÂùáË°°ÁöÑÊúÄÂ∞èÂçïÂÖÉ„ÄÇÊúÄÂ∞èÂçïÂÖÉÂ∞±Ë°®Á§∫‰∏çÂêåÁöÑHRegionÂèØ‰ª•ÂàÜÂ∏ÉÂú®‰∏çÂêåÁöÑ HRegion server‰∏ä„ÄÇ HRegionÁî±‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™StoreÁªÑÊàêÔºåÊØè‰∏™store‰øùÂ≠ò‰∏Ä‰∏™columns family„ÄÇ ÊØè‰∏™StroreÂèàÁî±‰∏Ä‰∏™memStoreÂíå0Ëá≥Â§ö‰∏™StoreFileÁªÑÊàê„ÄÇÂ¶ÇÂõæÔºöStoreFile‰ª•HFileÊ†ºÂºè‰øùÂ≠òÂú®HDFS‰∏ä„ÄÇ memstore ‰∏é storefile ‰∏Ä‰∏™regionÁî±Â§ö‰∏™storeÁªÑÊàêÔºå‰∏Ä‰∏™storeÂØπÂ∫î‰∏Ä‰∏™CFÔºàÂàóÊóèÔºâ storeÂåÖÊã¨‰Ωç‰∫éÂÜÖÂ≠ò‰∏≠ÁöÑmemstoreÂíå‰Ωç‰∫éÁ£ÅÁõòÁöÑstorefileÂÜôÊìç‰ΩúÂÖàÂÜôÂÖ•memstoreÔºåÂΩìmemstore‰∏≠ÁöÑÊï∞ÊçÆËææÂà∞Êüê‰∏™ÈòàÂÄºÔºåhregionserver‰ºöÂêØÂä®flashcacheËøõÁ®ãÂÜôÂÖ•storefileÔºåÊØèÊ¨°ÂÜôÂÖ•ÂΩ¢ÊàêÂçïÁã¨ÁöÑ‰∏Ä‰∏™storefile ÂΩìstorefileÊñá‰ª∂ÁöÑÊï∞ÈáèÂ¢ûÈïøÂà∞‰∏ÄÂÆöÈòàÂÄºÂêéÔºåÁ≥ªÁªü‰ºöËøõË°åÂêàÂπ∂Ôºàminor„ÄÅmajor compactionÔºâÔºåÂú®ÂêàÂπ∂ËøáÁ®ã‰∏≠‰ºöËøõË°åÁâàÊú¨ÂêàÂπ∂ÂíåÂà†Èô§Â∑•‰ΩúÔºàmajarÔºâÔºåÂΩ¢ÊàêÊõ¥Â§ßÁöÑstorefile ÂΩì‰∏Ä‰∏™regionÊâÄÊúâstorefileÁöÑÂ§ßÂ∞èÂíåÊï∞ÈáèË∂ÖËøá‰∏ÄÂÆöÈòàÂÄºÂêéÔºå‰ºöÊääÂΩìÂâçÁöÑregionÂàÜÂâ≤‰∏∫‰∏§‰∏™ÔºåÂπ∂Áî±hmasterÂàÜÈÖçÂà∞Áõ∏Â∫îÁöÑregionserverÊúçÂä°Âô®ÔºåÂÆûÁé∞Ë¥üËΩΩÂùáË°° ÂÆ¢Êà∑Á´ØÊ£ÄÁ¥¢Êï∞ÊçÆÔºåÂÖàÂú®memstoreÊâæÔºåÊâæ‰∏çÂà∞ÂÜçÊâæstorefile SequeceFileÁöÑValueÊòØHBaseÁöÑKeyValueÂØπË±°ÔºåÂç≥ÂØπÂ∫îHFile‰∏≠ÁöÑKeyValue StoreFile Á≠â‰ª∑‰∫éhdfs file ËØªÈ°∫Â∫è 1.ËØªmemstoreÔºåÊ≤°ÊúâÂàô‰∏ã‰∏ÄÊ≠• 2.ËØªblock cacheÔºåÊ≤°ÊúâÂàô‰∏ã‰∏ÄÊ≠• 3.ËØªstore file ÂÜôÈ°∫Â∫è 1.ÂÜômemstoreÔºåËææÂà∞ÈòàÂÄºÔºå‰∏ã‰∏ÄÊ≠• 2.ÂÜôstore file HBase ÂÆåÂÖ®HAÂàÜÂ∏ÉÂºèÊê≠Âª∫ zookeeper master region server master backup node01 * node02 * * node03 * * node04 * * hbase-env.sh ÈÖçÁΩÆconf‰∏≠ jdkÂú∞ÂùÄ ‰ΩøÁî®Ëá™Â∑±ÈÖçÁΩÆzkÔºå‰∏çÈÄÇÁî®hbaseËá™Â∏¶ÂÜÖÁΩÆÁöÑzk 1234vi hbase-env.shexport JAVA_HOME=/usr/install/jdk/jdk1.8.0_171/export HBASE_MANAGES_ZK=false hbase-site.xmlÈÖçÁΩÆ hbaseÂú®hdfsÁöÑÁõÆÂΩï ÊòØÂê¶ÂàÜÂ∏ÉÂºè zkÂú∞ÂùÄ 123456789101112131415vi hbase-site.xml&lt;property&gt; &lt;name&gt;hbase.rootdir&lt;/name&gt; &lt;value&gt;hdfs://mycluster/hbase&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hbase.cluster.distributed&lt;/name&gt; &lt;value&gt;true&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt; &lt;value&gt;node02,node03,node04&lt;/value&gt;&lt;/property&gt; regionserversÈÖçÁΩÆ123vi regionserversnode02 node03 backup-mastersÈÖçÁΩÆÊ∑ªÂä† backup-masters 123vi backup-mastersnode04 hdfs-site.xmlÂ§çÂà∂1cp /opt/sxt/hadoop-2.6.5/etc/hadoop/hdfs-site.xml ./ ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆ123456vi /etc/profileexport HBASE_HOME=/root/hbase-0.98.12.1-hadoop2export PATH=$PATH:$ZOOKEEPER_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$HBASE_HOME/binsource /etc/profile Ê≥®ÊÑèÂêÑËäÇÁÇπÁöÑÊó∂Èó¥‰∏ÄËá¥ ÁªôÂÖ∂‰ªñËäÇÁÇπscp‰∏Ä‰ªΩ123scp -r hbase-0.98.12.1-hadoop2 root@node02:/root/scp -r hbase-0.98.12.1-hadoop2 root@node03:/root/scp -r hbase-0.98.12.1-hadoop2 root@node04:/root/ ÂêØÂä®start-hbase.shÈúÄË¶ÅÊèêÂâçÂêØÂä®node02„ÄÅ03„ÄÅ04ÁöÑzkÔºåstart-hdfs.shÊúçÂä° 1start-hbase.sh È™åËØÅÊòØÂê¶ÂêØÂä®ÊàêÂäü123hbase shellhelpcreate 'tbl','cf' 123456hbase(main):023:0&gt; scan 'tbl'ROW COLUMN+CELL 1111 column=cf:age, timestamp=1559984836555, value=12 1111 column=cf:name, timestamp=1559984734803, value=zhangsan 2222 column=cf:sex, timestamp=1559984896283, value=boy2 row(s) in 0.0480 seconds 1get 'tbl','1111' Êï∞ÊçÆÂÜÖÂÆπÂÖàÂÜôÂà∞memstore ÊâßË°åflushÔºåÊü•Áúãfilestore http://node02:50070/explorer.html#/hbase/data/default/tbl/78a2935308b5f14d4c23a999ee797ed2/cf 1flush 'tbl' http://node02:50070/explorer.html#/hbase/data/default/tbl 1node01:60010 DDLÊìç‰ΩúËøõÂÖ•client shell1hbase shell Â∏ÆÂä©1help ÂàõÂª∫Ë°®ÂàóÊóèÊï∞Èáè2Âà∞3‰∏™ 1create 'tbl','cf1','cf2' ÊèèËø∞Ë°®1desc 'tbl' ÂàóË°®list1list Âà†Èô§Ë°®12disable 'tbl'drop 'tbl' ÊèíÂÖ•Êï∞ÊçÆ123put 'tbl','1111','cf:name','zhangsan'put 'tbl','1111','cf:age','12'put 'tbl','2222','cf:sex','boy' flushÊï∞ÊçÆÔºåmemstoreÁ´ãÂç≥Âà∞store fileÔºåÂà∞hdfs‰∏≠ 1flush 'tbl' Êü•ÁúãÊï∞ÊçÆÊü•ÁúãÂÖ®Ë°®1scan 'tbl' Êü•ÁúãÂçïÊù°1get 'tbl','1111' Ê∫¢ÂÜôÊï∞ÊçÆhbase shellÊâßË°å 1flush 'eventlog' Êü•ÁúãhdfsÁöÑÂ≠òÂÇ®Êñá‰ª∂hdfsÊü•ÁúãÁõÆÂΩï /hbase/data/default/eventlog/43169c43dc06d3e24836e3291149f8e5/log Áõ¥Êé•ÊúçÂä°Âô®ÊâßË°å 1hbase hfile -p -f /hbase/data/default/eventlog/43169c43dc06d3e24836e3291149f8e5/log/9bb18168d5e2437491a5adeaae62f864 hbase javaÂÆûÊàòË°®ÂàõÂª∫1234567891011121314151617181920private static void createTable() &#123; try &#123; Configuration conf = new Configuration(); conf.set("hbase.zookeeper.quorum", "node02,node03,node04"); admin = new HBaseAdmin(conf); HTableDescriptor desc = new HTableDescriptor(tableName); HColumnDescriptor columnDescriptor = new HColumnDescriptor("cf"); desc.addFamily(columnDescriptor); admin.createTable(desc); if (admin != null) &#123; admin.close(); &#125; &#125; catch (Exception e) &#123; // TODO: handle exception &#125;&#125; ÊèíÂÖ•12345678910111213141516171819202122private static void insertTable() &#123; try &#123; Configuration conf = new Configuration(); conf.set("hbase.zookeeper.quorum", "node02,node03,node04"); HTable hTable = new HTable(conf, tableName); Put put = new Put("1111".getBytes()); put.add("cf".getBytes(), "name".getBytes(), "zhangsan".getBytes()); put.add("cf".getBytes(), "age".getBytes(), "12".getBytes()); put.add("cf".getBytes(), "sex".getBytes(), "boy".getBytes()); hTable.put(put); if (admin != null) &#123; admin.close(); &#125; &#125; catch (Exception e) &#123; // TODO: handle exception &#125;&#125; Êü•ËØ¢12345678910111213141516171819202122232425262728293031 private static void getTable() &#123; try &#123; Configuration conf = new Configuration(); conf.set("hbase.zookeeper.quorum", "node02,node03,node04"); HTable hTable = new HTable(conf, tableName); Get get = new Get("1111".getBytes()); // define return columns in family get.addColumn("cf".getBytes(), "name".getBytes()); get.addColumn("cf".getBytes(), "age".getBytes()); get.addColumn("cf".getBytes(), "sex".getBytes()); Result result = hTable.get(get); Cell cell = result.getColumnLatestCell("cf".getBytes(), "name".getBytes()); Cell cell2 = result.getColumnLatestCell("cf".getBytes(), "age".getBytes()); Cell cell3 = result.getColumnLatestCell("cf".getBytes(), "sex".getBytes());// System.out.println(new String( cell.getValue())); System.out.println(new String(CellUtil.cloneValue(cell))); System.out.println(new String(CellUtil.cloneValue(cell2))); System.out.println(new String(CellUtil.cloneValue(cell3))); if (admin != null) &#123; admin.close(); &#125; &#125; catch (Exception e) &#123; // TODO: handle exception &#125; &#125; HbaseÂá∫Áé∞ServerNotRunningYetExceptionÁöÑËß£ÂÜ≥ÊñπÊ°àÂõ†‰∏∫hadoopÂ§ÑÂú®ÂÆâÂÖ®Ê®°Âºè‰∏ã„ÄÇÊâÄ‰ª•hbaseÁöÑÊìç‰Ωú‰ºöÂá∫Áé∞ÂºÇÂ∏∏„ÄÇ 1hadoop dfsadmin -safemode leave hbase shell‰∏≠‰ΩøÁî®listÂëΩ‰ª§Êä•Èîô https://blog.csdn.net/hll19950830/article/details/80022676]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[HiveÂéüÁêÜÊ°à‰æãÂèäÊê≠Âª∫]]></title>
    <url>%2F2019%2F05%2F21%2FHive%E5%8E%9F%E7%90%86%E6%A1%88%E4%BE%8B%E5%8F%8A%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[HiveÊê≠Âª∫in-memory derbyÂÜÖÂ≠òÊï∞ÊçÆÂ∫ìÔºåÂÆûÈôÖ‰∏çÁî® ËøúÁ®ãÊúçÂä°Âô®Ê®°Âºè ÂâçÈù¢‰∏∫hadoopÈÉ®ÂàÜ ÂÖÉÊï∞ÊçÆ ‰øùÂ≠òÂú®MySQL namenode ‰∏ªÂ§á ZKFC datanode zookeeper JNN mysql hive Metastore Server hive client node01 * * * * node02 * * * * * * node03 * * * * node04 * * Thrift MetaStore Server mysqlÂÆâË£Ö123Ëß£ÂÜ≥Êó†ÂåÖÂèØÁî®Ôºå‰∏ãËΩΩÂú∞ÂùÄ http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpmrpm -ivh mysql-community-release-el7-5.noarch.rpmyum install -y mysql-server ÊúçÂä°mysqlÂêØÂä® 1service mysqld start 12345mysqlshow databasesuse mysqlshow tablesdesc user; ‰øÆÊîπÊéàÊùÉÁî®Êà∑ÂØÜÁ†Å 123456789select Host , User , Password from user;GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123' WITH GRANT OPTION;delete from user where Host != '%';flush privileges;quitmysql -uroot -p;Âê´‰πâÔºöALL PRIVILEGESÊâÄÊúâÊùÉÈôêÔºå*.*ÊâÄÊúâÂ∫ìÊâÄÊúâË°®Ôºå %‰ªª‰Ωïhost rootÁî®Êà∑Âêç 123ÂØÜÁ†Å hive Metastore Server1234ÊúçÂä°Á´ØÈúÄË¶ÅËøûÊé•mysqlscp apache-hive-1.2.1-bin.tar.gz mysql-connector-java-5.1.32-bin.jar root@node02:/root/tar zxvf apache-hive-1.2.1-bin.tar.gzcp mysql-connector-java-5.1.32-bin.jar apache-hive-1.2.1-bin/lib/ ÁéØÂ¢ÉÂèòÈáè 1234vi /etc/profileexport HIVE_HOME=/root/apache-hive-1.2.1-binexport PATH=$PATH:$ZOOKEEPER_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$HIVE_HOME/binsource /etc/profile ÈÖçÁΩÆÊñá‰ª∂ ÂèÇËÄÉ https://cwiki.apache.org/confluence/display/Hive/AdminManual+Configuration https://cwiki.apache.org/confluence/display/Hive/AdminManual+Metastore+Administration https://cwiki.apache.org/confluence/display/Hive/AdminManual+Metastore+Administration#AdminManualMetastoreAdministration-RemoteMetastoreServer 12345cd conf/mv hive-default.xml.template hive-site.xmlvi hive-site.xml‰ªéÂΩìÂâçË°å &lt;configuration&gt;‰∏ãÈù¢‰∏ÄË°åÔºå Âà†Èô§Âà∞ÂÄíÊï∞-1Ë°å:.,$-1d 123456789101112131415161718192021222324&lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive/warehouse&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://node01:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123&lt;/value&gt; &lt;/property&gt; ÂêØÂä®metastore server1hive --service metastore ‰πüÂèØ‰ΩøÁî®hiveserver2 beelineÊñπÂºè hive clientvi hive-site.xml 1:.,$-1d ËøûÊé•metastore ÁéØÂ¢ÉÂèòÈáè ./hive 1234567891011121314&lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive/warehouse&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.local&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.uris&lt;/name&gt; &lt;value&gt;thrift://node02:9083&lt;/value&gt; &lt;/property&gt; 12345&lt;property&gt; &lt;name&gt;hive.metastore.local&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; ÂèØ‰ª•ÂéªÊéâ,ÈÅøÂÖçwaringMetastore is remote. Note: This is no longer needed as of Hive 0.10. Setting hive.metastore.uri is sufficient. ÈÅøÂÖçjlineÊä•Èîô 123cd /opt/sxt/hadoop-2.6.5/share/hadoop/yarn/librm jline-0.9.94.jarcp /root/apache-hive-1.2.1-bin/lib/jline-2.12.jar ./ ÂêØÂä® 1hive hiveÊìç‰Ωú12create table tbl(id int,age int);show tables; 1insert into tbl values(1,1); Time taken: 175.393 seconds Êü•Áúãmap reduece ÊâßË°åjobÁä∂ÊÄÅ http://node03:8088/cluster 1select * from tbl; Êü•ÁúãhdfsÂ≠òÂÇ® http://node01:50070/explorer.html#/user/hive/warehouse/tbl 1hdfs dfs -cat /user/hive/warehouse/tbl/* hiveÊï∞ÊçÆÁ±ªÂûã: primitive_type | array_type Êï∞ÁªÑ | map_type mapÁ±ªÂûã | struct_type ÁªìÊûÑ‰Ωì Ôºöprimitive_type |TINYINT | SMALLINT | INT | BIGINT | BOOLEAN | FLOAT | DOUBLE | STRING ÂèÇËÄÉ https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateTable ÂàõÂª∫Ë°®ÂÜÖÈÉ®Ë°®12345678910create table psn(id int,name string,likes array&lt;string&gt;,address map&lt;string,string&gt;)row format DELIMITEDFIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY '-'MAP KEYS TERMINATED BY ':'; 1234‰∫∫ÂëòË°®id,ÂßìÂêç,Áà±Â•ΩÔºå‰ΩèÂùÄ1,Â∞èÊòé1,lol-book-movie,zhejiang:hangzhou-guangdong:shenzhen2,Â∞èÊòé2,lol-book,zhejiang:hangzhou-guangdong:shenzhen ÊèèËø∞Ë°®1234desc psn;desc formatted psn;Table Type: MANAGED_TABLE ÂÜÖÈÉ®Ë°® Êï∞ÊçÆÊèíÂÖ•ÂèÇËÄÉ https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-Loadingfilesintotables Êñá‰ª∂ÂØºÂÖ• 1LOAD DATA LOCAL INPATH '/root/persondata' INTO TABLE psn; 1234hive&gt; select * from psn;OK1 Â∞èÊòé1 ["lol","book","movie"] &#123;"zhejiang":"hangzhou","guangdong":"shenzhen"&#125;2 Â∞èÊòé2 ["lol","book"] &#123;"zhejiang":"hangzhou","guangdong":"shenzhen"&#125; Â§ñÈÉ®Ë°®persondata‰∏∫Êï∞ÊçÆtxt 12hdfs dfs mkdir /external_tablehdfs dfs -put persondata /external_table/ ÂàõÂª∫table 1234567891011create EXTERNAL table psn_external(id int,name string,likes array&lt;string&gt;,address map&lt;string,string&gt;)row format DELIMITEDFIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY '-'MAP KEYS TERMINATED BY ':'LOCATION '/external_table'; 123select * from psn_external;desc formatted psn_external;Table Type: EXTERNAL_TABLE ÂÜÖÈÉ®ÔºöÂà†Èô§ÂÖÉÊï∞ÊçÆÔºåÂèäÁõÆÂΩï Â§ñÈÉ®ÔºöÂè™Âà†Èô§ÂÖÉÊï∞ÊçÆÔºåÂ≠òÊîæÁõÆÂΩï‰∏ç‰ºöÂà†Èô§ ÂÖ∂‰ªñÂàõÂª∫Ë°®ÊñπÂºè1create table like table; 1create table psn2 as select id,name,likes from psn; ÂàÜÂå∫Ë°®Âçï‰∏™Â≠óÊÆµÂàÜÂå∫ÊåâÂπ¥ÈæÑÂàÜÂå∫ 123id,Âπ¥ÈæÑÁà±Â•ΩÔºå‰ΩèÂùÄ1,Â∞èÊòé1,lol-book-movie,zhejiang:hangzhou-guangdong:shenzhen2,Â∞èÊòé2,lofl-book,zhejiang:hangzhou-guangdong:shenzhen 1234567891011create table psn_partition(id int,name string,likes array&lt;string&gt;,address map&lt;string,string&gt;)PARTITIONED BY (age int)row format DELIMITEDFIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY '-'MAP KEYS TERMINATED BY ':'; ÈÄöËøáÂàÜÂå∫ÊåáÂÆöÂπ¥ÈæÑ 12LOAD DATA LOCAL INPATH '/root/persondata' INTO TABLE psn_partition partition(age=10);LOAD DATA LOCAL INPATH '/root/persondata' INTO TABLE psn_partition partition(age=20); Â§ö‰∏™Â≠óÊÆµÂàÜÂå∫ÊåâÂπ¥ÈæÑÂíåÊÄßÂà´ÂàÜÂå∫ 1234567891011create table psn_partition_multi(id int,name string,likes array&lt;string&gt;,address map&lt;string,string&gt;)PARTITIONED BY (age int,sex string)row format DELIMITEDFIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY '-'MAP KEYS TERMINATED BY ':'; ÈÄöËøáÂàÜÂå∫ÊåáÂÆöÂπ¥ÈæÑ„ÄÅÊÄßÂà´ 123LOAD DATA LOCAL INPATH '/root/persondata' INTO TABLE psn_partition_multi partition(age=10,sex='boy');LOAD DATA LOCAL INPATH '/root/persondata' INTO TABLE psn_partition_multi partition(age=10,sex='girl');LOAD DATA LOCAL INPATH '/root/persondata' INTO TABLE psn_partition_multi partition(age=20,sex='girl'); Âà†Èô§ÂàÜÂå∫ÂèÇËÄÉÊñáÊ°£ https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DropPartitions 10Âíå20ÁöÑgirl‰∫åÁ∫ßÂàÜÂå∫ÈÉΩÂà†Êéâ 1ALTER TABLE psn_partition_multi DROP PARTITION (sex='girl'); Ê∑ªÂä†ÂàÜÂå∫ÂøÖÈ°ªÊåáÂÆöÁ¨¨‰∏ÄÁ∫ßÂàÜÂå∫Âπ¥ÈæÑ 1ALTER TABLE psn_partition_multi ADD PARTITION (age=10,sex='girl'); DMLfrom insert selectÊñπÂºè1create table psn_copy like psn; 123FROM psnINSERT OVERWRITE TABLE psn_copySELECT id,name,likes,address; Hive Beelinehiveserver2node02 1hiveserver2 beelinenode03 1beeline Áîü‰∫ßÁéØÂ¢ÉÁî® Áî®Êà∑Âêç„ÄÅÂØÜÁ†Å‰∏çÊ†°È™å 123!connect jdbc:hive2://node02:10000/default; root 123show tables; 123456780: jdbc:hive2://node02:10000/default&gt; select * from psn;+---------+-----------+-------------------------+-------------------------------------------------+--+| psn.id | psn.name | psn.likes | psn.address |+---------+-----------+-------------------------+-------------------------------------------------+--+| 1 | Â∞èÊòé1 | ["lol","book","movie"] | &#123;"zhejiang":"hangzhou","guangdong":"shenzhen"&#125; || 2 | Â∞èÊòé2 | ["lol","book"] | &#123;"zhejiang":"hangzhou","guangdong":"shenzhen"&#125; |+---------+-----------+-------------------------+-------------------------------------------------+--+2 rows selected (3.391 seconds) ÈÄÄÂá∫ 1!quit hive jdbc demoÂèÇËÄÉhivedemo 1234567891011121314151617181920public class HiveJdbcClient &#123; private static String driverName = "org.apache.hive.jdbc.HiveDriver"; public static void main(String[] args) throws SQLException &#123; try &#123; Class.forName(driverName); &#125; catch (ClassNotFoundException e) &#123; e.printStackTrace(); &#125; Connection conn = DriverManager.getConnection("jdbc:hive2://node02:10000/default", "root", ""); Statement stmt = conn.createStatement(); String sql = "select * from psn limit 5"; ResultSet res = stmt.executeQuery(sql); while (res.next()) &#123; System.out.println(res.getString(1) + "-" + res.getString("name")); &#125; &#125;&#125; hive ÂáΩÊï∞UDF Áî®Êà∑Ëá™ÂÆö‰πâÂáΩÊï∞12345678910111213141516package cn.laolian;import org.apache.hadoop.hive.ql.exec.UDF;import org.apache.hadoop.io.Text;public class TuoMin extends UDF &#123; public Text evaluate(final Text s) &#123; if (s == null) &#123; return null; &#125; String str = s.toString().substring(0, 3) + "***"; return new Text(str); &#125;&#125; eclipse ÂØºÂá∫jar ÂåÖexport jar node02 1hive --service metastore node03 12345hiveadd jar /root/tuomin.jar;create temporary function tm AS 'cn.laolian.TuoMin';select tm(name) from psn; ‰∏¥Êó∂ÂáΩÊï∞ÔºåÂΩìÂâç‰ºöËØùÊúâÊïà 1234hive&gt; select tm(name) from psn;OKÂ∞èÊòé1***Â∞èÊòé2*** UDAFUDTF ‰∏ÄËøõÂ§öÂá∫1select explode(likes) from psn; 12345678910: jdbc:hive2://node02:10000/default&gt; select explode(likes) from psn;+--------+--+| col |+--------+--+| lol || book || movie || lol || book |+--------+--+ hiveÂèÇÊï∞ÊâìÂç∞Â§¥‰ø°ÊÅØ ÊñπÂºè‰∏Ä12hiveset hive.cli.print.header=true; 1set; ËøõË°åÊèêÁ§∫ÔºåÂØºÂá∫ÈÖçÁΩÆ ÊñπÂºè‰∫å ÂêØÂä®Êó∂ËÆæÁΩÆ1hive --hiveconf hive.cli.print.header=true; Âè™Âú®ÂΩìÂâç‰ºöËØùÊúâÊïà 12345hive&gt; select * from psn;OKpsn.id psn.name psn.likes psn.address1 Â∞èÊòé1 ["lol","book","movie"] &#123;"zhejiang":"hangzhou","guangdong":"shenzhen"&#125;2 Â∞èÊòé2 ["lol","book"] &#123;"zhejiang":"hangzhou","guangdong":"shenzhen"&#125; ÊñπÂºè‰∏â ÊâÄÊúâ‰ºöËØùÊúâÊïà123vi .hiverchive.cli.print.header=true; ÂéÜÂè≤ÂëΩ‰ª§1cat .hivehistory Hive Âä®ÊÄÅÂàÜÂå∫‰∏•Ê†ºÊ®°ÂºèÔºöËá≥Â∞ë‰øùËØÅÊúâ‰∏Ä‰∏™ÈùôÊÄÅÂàÜÂå∫ 12set hive.exec.dynamic.partition=true;set hive.exec.dynamic.partition.mode=nostrict; 1vi persondata_daynamic_partition 12345id,ÂßìÂêçÔºåÂπ¥ÈæÑÔºåÊÄßÂà´ÔºåÁà±Â•ΩÔºå‰ΩèÂùÄ1,Â∞èÊòé1,10,boy,lol-book-movie,zhejiang:hangzhou-guangdong:shenzhen2,Â∞èÊòé2,10,man,lofl-book,zhejiang:hangzhou-guangdong:shenzhen3,Â∞èÊòé3,20,boy,lofl-book,zhejiang:hangzhou-guangdong:shenzhen2,Â∞èÊòé3,20,man,lofl-book,zhejiang:hangzhou-guangdong:shenzhen ÂéüÂßãË°®123456789101112create table psn_dynamic_partition(id int,name string,age int,sex string,likes array&lt;string&gt;,address map&lt;string,string&gt;)row format DELIMITEDFIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY '-'MAP KEYS TERMINATED BY ':'; 1load data local inpath '/root/persondata_daynamic_partition' into table psn_dynamic_partition; ÂàÜÂå∫Ë°®1234567891011create table psn_dynamic_partition_r(id int,name string,likes array&lt;string&gt;,address map&lt;string,string&gt;)PARTITIONED BY (age int , sex string)row format DELIMITEDFIELDS TERMINATED BY ','COLLECTION ITEMS TERMINATED BY '-'MAP KEYS TERMINATED BY ':'; ‰ªéÂéüÂßãË°®ÂØºÂÖ•Âà∞ÂàÜÂå∫Ë°®Ê≥®ÊÑèage,sexÁöÑÈ°∫Â∫è 123from psn_dynamic_partitioninsert overwrite table psn_dynamic_partition_r partition(age,sex)select id,name,likes,address,age,sex distribute by age,sex; HiveËÑöÊú¨ËøêË°åÊñπÂºè12345hive -e "select * from psn"ÈáçÂÆöÂêëhive -e "select * from psn" &gt; aaaÈùôÈªòËæìÂá∫hive -S -e "select * from psn" &gt; aaa Êñá‰ª∂ËÑöÊú¨12vi sqlselect * from psn 1hive -f sql hive clientÁªàÁ´Ø‰∫§‰∫íhdfs‰∫§‰∫í1234567hive&gt; dfs -ls / ;Found 5 itemsdrwxr-xr-x - root supergroup 0 2019-04-17 22:08 /datadrwxr-xr-x - root supergroup 0 2019-06-02 19:25 /external_table-rw-r--r-- 2 root supergroup 118 2019-06-02 19:10 /persondatadrwx------ - root supergroup 0 2019-06-02 11:55 /tmpdrwxr-xr-x - root supergroup 0 2019-06-02 12:06 /user linux‰∫§‰∫í12hive&gt; !pwd;/root Hive‰ºòÂåñÊ†∏ÂøÉÊÄùÊÉ≥Ôºöhive SQL ÂΩìÂÅöMap ReduceÁ®ãÂ∫èÂéª‰ºòÂåñ‰∏§Áßç‰∏ç‰ºöËΩ¨Âåñ‰∏∫MapreduceÊâßË°å select‰ªÖÊü•ËØ¢Êú¨Ë°®Â≠óÊÆµ 1select * from psn; select‰ªÖÂØπÊú¨Ë°®Â≠óÊÆµÂÅöÊù°‰ª∂ËøáÊª§ 1select * from psn where id=1; ExplainÊâßË°åËÆ°Âàí12explain select * from psn;explain extended select * from psn; ÊäìÂèñÁ≠ñÁï•ËøôÊ†∑‰ºöÊâßË°åmapreduceÔºåÈªòËÆ§ÂÄºmore 12set hive.fetch.task.conversion=none;select * from psn; hiveËøêË°åÊñπÂºèÊú¨Âú∞Ê®°ÂºèÊú¨Âú∞Ê®°ÂºèÔºåÂºÄÂèëÊµãËØïÁî®ÔºåÁîü‰∫ß‰∏çË¶ÅÁî® 12set hive.exec.mode.local.auto=true;select count(*) from psn; hive.exec.mode.local.inputbytes.max ÈªòËÆ§ÂÄº128MÔºåÂ§ß‰∫éËØ•ÈÖçÁΩÆÔºå‰πü‰ºö‰ª•ÈõÜÁæ§ÊñπÊ≥ïËøêË°å Âπ∂Ë°åËÆ°ÁÆó]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring framworkÊäÄÊúØ‰ΩìÁ≥ªÁõÆÂΩï]]></title>
    <url>%2F2019%2F05%2F15%2FSpring-framwork%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB%E7%9B%AE%E5%BD%95%2F</url>
    <content type="text"><![CDATA[ÂºÇÂ∏∏Â§ÑÁêÜÂú®Spring‰∏≠Â∏∏ËßÅÁöÑÂÖ®Â±ÄÂºÇÂ∏∏Â§ÑÁêÜÔºå‰∏ªË¶ÅÊúâ‰∏âÁßçÔºö Ê≥®Ëß£ @ExceptionHandler Âú® Controller ÂÜÖÈÉ®ÔºåÁî® @ExceptionHandlerÊ≥®Ëß£ÁöÑÊñπÊ≥ïÔºåÂ∞±‰ºö‰Ωú‰∏∫ËØ•ControllerÂÜÖÈÉ®ÁöÑÂºÇÂ∏∏Â§ÑÁêÜÊñπÊ≥ï„ÄÇ ËØ•ÊñπÂºèÈúÄË¶ÅÂú®ÊØè‰∏™Á±ª‰∏≠Â§ÑÁêÜÂºÇÂ∏∏Ôºå‰∏çÈÄÇÂêàÂÖ®Â±ÄÂºÇÂ∏∏Â§ÑÁêÜ„ÄÇ ÁªßÊâøHandlerExceptionResolverÊé•Âè£ 1234567891011121314151617181920212223@Component@Slf4jpublic class CustomHandlerExceptionResolver implements HandlerExceptionResolver &#123; @Override public ModelAndView resolveException(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) &#123; Method method = null; if (handler != null &amp;&amp; handler instanceof HandlerMethod) &#123; method = ((HandlerMethod) handler).getMethod(); &#125; log.error("[&#123;&#125;] system error", method, ex); ResponseDTO response = ResponseDTO.builder() .errorCode(ErrorCode.SYSTEM_ERROR) .build(); byte[] bytes = JSON.toJSONString(response).getBytes(StandardCharsets.UTF_8)); try &#123; FileCopyUtils.copy(bytes, response.getOutputStream()); &#125; catch (IOException e) &#123; log.error("error", e); throw new RuntimeException(e); &#125; return new ModelAndView(); &#125;&#125; ÂáΩÊï∞ËøòÂèØ‰ª•ËøîÂõû‰∏Ä‰∏™ ModelAndView ÂØπË±°ÔºåË°®Á§∫Ê∏≤Êüì‰∏Ä‰∏™ËßÜÂõæÔºåÊØîÊñπËØ¥ÈîôËØØÈ°µÈù¢„ÄÇ‰∏çËøáÔºåÂú®ÂâçÂêéÁ´ØÂàÜÁ¶ª‰∏∫‰∏ªÊµÅÊû∂ÊûÑÁöÑ‰ªäÂ§©ÔºåËøô‰∏™ÂæàÂ∞ëÁî®‰∫Ü„ÄÇÂ¶ÇÊûúÂáΩÊï∞ËøîÂõûÁöÑËßÜÂõæ‰∏∫Á©∫ÔºåÂàôË°®Á§∫‰∏çÈúÄË¶ÅËßÜÂõæ„ÄÇ Ê≥®Ëß£ @ControllerAdvice 1234567891011@ControllerAdvice(assignableTypes = &#123;GlobalExceptionHandlerMixin.class&#125;)public class ExceptionAdvice &#123; @ExceptionHandler(ErrorCodeWrapperException.class) @ResponseBody public ResponseDTO&lt;?&gt; exceptionHandler(ErrorCodeWrapperException e) &#123; if ((errCodeException.getErrorCode().equals(ErrorCode.SYSTEM_ERROR))) &#123; log.error(e); &#125; return ResponseDTO.ofErroCodeWrapperException(errCodeException); &#125;&#125; ControllerAdvice ÊîØÊåÅÁöÑÈôêÂÆöËåÉÂõ¥ ÊåâÊ≥®Ëß£Ôºö@ControllerAdvice(annotations = RestController.class) ÊåâÂåÖÂêçÔºö@ControllerAdvice(&quot;org.example.controllers&quot;) ÊåâÁ±ªÂûãÔºö@ControllerAdvice(assignableTypes = {ControllerInterface.class, AbstractController.class}) Ê∫êÁ†ÅÂØπÂ∫î ExceptionHandlerExceptionResolver @ExceptionHandler @ControllerAdvice ResponseStatusExceptionResolver DefaultHandlerExceptionResolver MyHandlerExceptionResolver ÂèÇËÄÉÊñáÊ°£ Â∏∏ËßÅÁöÑSpringÂºÇÂ∏∏ÂàÜÊûêÂèäÂ§ÑÁêÜ https://my.oschina.net/u/4007037/blog/3049044 Spring‰∏≠ÁöÑÁªü‰∏ÄÂºÇÂ∏∏Â§ÑÁêÜ http://www.importnew.com/29962.html SpringÂÖ®Â±ÄÂºÇÂ∏∏Â§ÑÁêÜÁöÑ‰∏âÁßçÊñπÂºè https://www.jianshu.com/p/f968b8dcf95a Spring RestFul APIÁªü‰∏ÄÂºÇÂ∏∏Â§ÑÁêÜ http://daobin.wang/2017/05/spring-restful-api/]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÂçïÁÇπÁôªÂΩïÂÆûÁé∞‚Äî‚ÄîÂü∫‰∫éOAuth2.0ÂçèËÆÆÁöÑÊé•ÂÖ•ÊñπÊ°à]]></title>
    <url>%2F2019%2F04%2F16%2F%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EOAuth2-0%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%8E%A5%E5%85%A5%E6%96%B9%E6%A1%88%2F</url>
    <content type="text"><![CDATA[ÂèÇËÄÉ ÂçïÁÇπÁôªÂΩïÂÆûÁé∞‚Äî‚ÄîÂü∫‰∫éOAuth2.0ÂçèËÆÆÁöÑÊé•ÂÖ•ÊñπÊ°à Spring Security Oauth2 ÂçïÁÇπÁôªÂΩïÊ°à‰æãÂÆûÁé∞ÂíåÊâßË°åÊµÅÁ®ãÂâñÊûê ÂçïÁÇπÁôªÂΩïÂéüÁêÜ‰∏éÁÆÄÂçïÂÆûÁé∞ CASÂÆûÁé∞ÂçïÁÇπÁôªÂΩïSSOÊâßË°åÂéüÁêÜÊé¢Á©∂]]></content>
      <categories>
        <category>ÂçïÁÇπÁôªÂΩï</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Hadoop MapReduceÂéüÁêÜÊ°à‰æãÂèäÊê≠Âª∫]]></title>
    <url>%2F2019%2F04%2F14%2FHadoop-MapReduce%E5%8E%9F%E7%90%86%E6%A1%88%E4%BE%8B%E5%8F%8A%E6%90%AD%E5%BB%BA%2F</url>
    <content type="text"><![CDATA[MapReduceËØ≠‰πâ MapTask(Â∑¶Ëæπ) a. blockÂíåÂàáÁâáÔºöblockÊòØÁâ©ÁêÜÁöÑÂ≠òÂÇ®ÔºåÂÅèÁßªÈáèÂíå‰ΩçÁΩÆ‰ø°ÊÅØÔºõÂàáÁâáÊòØÈÄªËæëÊ¶ÇÂøµ„ÄÇ1:1 1:N N:1ÂÖ≥Á≥ª b. ÂàáÁâáÂíåmapÔºö1Ôºö1ÂÖ≥Á≥ª „ÄÇ Êï∞ÊçÆÂ§ö‰∏™ÂàáÁâáÔºåÂ§ö‰∏™map„ÄÇ‰∏Ä‰∏™mapÊúâÂ§ö‰∏™key„ÄÇ c. Âêå‰∏Ä‰∏™mapÔºåÊ†πÊçÆpartionÁöÑÂàÜÂå∫‰ø°ÊÅØÊéíÂ∫èÔºåÂÜçÊ†πÊçÆkeyÔºåËøõË°å‰∏ÄÊ¨°Âø´Êéí„ÄÇ ReduceTask(Âè≥Ëæπ) a. reduceÊúÄÁªàÊï∞ÈáèÁî±‰∫∫ÔºåÈªòËÆ§‰∏Ä‰∏™reduce„ÄÇmapÂíåreduceÁöÑÂÖ≥Á≥ªÊï∞ÁõÆ‰∏çÂõ∫ÂÆö„ÄÇ b. ‰ªéÂÖ∂‰ªñmapÊãøÂà∞Áõ∏ÂêåÁöÑkeyÔºåÂÅöÂΩíÂπ∂ÊéíÂ∫è„ÄÇ1‰∏™key‰∏çËÉΩÂàÜÂâ≤ÔºåÂè™ËÉΩÂú®‰∏Ä‰∏™ÂàÜÂå∫partitionÔºàÂéüËØ≠Ôºâ„ÄÇ shufferÊ¥óÁâå a. ‰∏Ä‰∏™ÂàáÁâásplit =&gt; ‰∏Ä‰∏™map=&gt; ÂÜÖÂ≠òÊ†πÊçÆÂàÜÂå∫ÂíåKeyÂÅö‰∏ÄÊ¨°Âø´Êéí , (partition,key,value) ÁéØÂΩ¢ÁºìÂÜ≤Âå∫ÔºåËææÂà∞80%Ôºå‰∫ßÁîüÊ∫¢ÂÜôÔºåÂø´Êéí b. reduceTaskÊòØÂú®‰∏Ä‰∏™ÂàÜÂå∫partitionÔºå‰ªé‰∏çÂêåÁöÑmapÔºåÊãøÂà∞Áõ∏ÂêåÁöÑkey„ÄÇÂÜÖÈÉ®ÊúâÂ∫èÔºåÂ§ñÈÉ®Êó†Â∫èÔºåËøõË°åÂΩíÂπ∂ÊéíÂ∫è„ÄÇ Â¶Ç‰∏äÂõæ a. splitËøõË°åÈÄªËæëÂàÜÂâ≤ÔºåÈªòËÆ§ÊòØ‰∏Ä‰∏™block‰∏∫‰∏Ä‰∏™split b. mapÊìç‰ΩúÔºå(key,value,partition)‰ø°ÊÅØÔºåÊéíÂ∫èÂèØÈÄâ c. shufflerÔºåÊ¥óÁâåÔºå‰ªé‰∏çÂêåÁöÑmapÊãøÂà∞Áõ∏ÂêåÁöÑKeyÔºåÂΩíÂπ∂ d. reduceËÆ°ÁÆó e. ÂêàÂπ∂ÊãøÂà∞ÊúÄÂêéÁªìÊûú YARN HAÈÉ®ÁΩ≤ a. clientÊèê‰∫§‰ªªÂä°ÔºåÂåÖÂê´ËÆ°ÁÆóÊ∏ÖÂçï b. ResourceManagerÊ†πÊçÆNodeManagerÁöÑÁä∂ÊÄÅÔºåÊåëÈÄâ‰∏ÄÂè∞Ôºå‰Ωú‰∏∫App Master c. App MasterÂêëResourceMangerÂèëËµ∑ËµÑÊ∫êËØ∑Ê±ÇÔºåÂàÜÈÖçContainer„ÄÇÂΩìContainerÂ§±Ë¥•ÂêéÔºåResourceManagerÂèà‰ºöÈáçÊñ∞ÂàÜÈÖç„ÄÇ HDFSËåÉÂõ¥ YARNËåÉÂõ¥ namenode ‰∏ªÂ§á ZKFC datanode zookeeper JNN ResourceMangager NodeManager node01 * * * node02 * * * * * * node03 * * * * * node04 * * * * HDFS ÂàÜÂ∏ÉÂºèHAÊê≠Âª∫ÂèÇËÄÉ‰∏äÁØáÊñáÊ°£ hdfs1.0 Â∞±Êúâ‰∫ÜÔºåËÄÉËôëÂÖºÂÆπÔºåÂ¢ûÂä†zkfc‰øùËØÅHA „ÄÇyarnÊòØÂú®2.0ÂºÄÂèëÁöÑÔºåresourcemanger‰∏çÁî®zkfc nodeManageer Âíå dataNode 1ÊØî1ÂÖ≥Á≥ª mapred-site.xml 1234&lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; Ê†áËØÜmapreduceÁöÑÊ°ÜÊû∂‰∏∫yarn yarn-site.xml 12345678910111213141516171819202122232425262728 &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt;&lt;property&gt; &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt; &lt;value&gt;cluster1&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt; &lt;value&gt;rm1,rm2&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt; &lt;value&gt;node03&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt; &lt;value&gt;node04&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt; &lt;value&gt;node02:2181,node03:2181,node04:2181&lt;/value&gt; &lt;/property&gt; a. mapreduce_shuffleÊ†áËØÜÔºå‰ªéÂ§ö‰∏™mapÂèñÂá∫Áõ∏ÂêåÁöÑkeyÔºåshuffleËøáÁ®ã b.ÂºÄÂêØha c. yarnÁöÑresourcemanagerÁöÑÈÄªËæëÂíåÁâ©ÁêÜÂÖ≥Á≥ª d. yarnÁöÑresourcemanagerÁöÑzkÈÖçÁΩÆ ÂàÜÂà´Â§çÂà∂Âà∞node02 node03 node04 1scp -r mapred-site.xml yarn-site.xml node02:/`pwd` node01‰∏äÂêØÂä®NodeManagerÔºånode02 node03 node04 1start-yarn.sh node03 node04ÊâãÂ∑•ÂêØÁî®resourcemanager 1yarn-daemon.sh start resourcemanager http://node03:8088/cluster/cluster Êü•Áúãyarn resourcemanagerÁä∂ÊÄÅ ÊâßË°åexampleÂçïËØçËÆ°Êï∞ 12345cd /opt/sxt/hadoop-2.6.5/share/hadoop/mapreduce#ÊâßË°å‰ªªÂä°hadoop jar hadoop-mapreduce-examples-2.6.5.jar wordcount /user/root/test.txt /data/output/#‰ªéhdfsÂà∞Êú¨Âú∞hdfs dfs -get /data/output/part-r-00000 ~/result_count.txt ÂºÄÂèëMapReduceÔºåÂçïËØçËÆ°Êï∞hadoop-2.6.5/share/hadoop ‰∏≠ÁöÑjarÂåÖÔºåÊ†πÁõÆÂΩïÂèälibÔºåÂ§çÂà∂Âà∞hadoop-user-lib‰∏≠„ÄÇÈÖçÁΩÆÊàêÂÖ®Â±ÄÁöÑuser-libaray ÔºåÊ∑ªÂä†hadoop-2.6.5/share/hadoop/mapreduce/sourcesÁ≠â‰Ωú‰∏∫sourceÊ∫êÁ†Å„ÄÇ ÂêØÂä®Main 12345678910111213141516171819202122232425262728293031323334353637public class MyWC &#123; public static void main(String[] args) throws Exception &#123; Configuration conf = new Configuration(true); Job job =Job.getInstance(conf); job.setJarByClass(MyWC.class); job.setJobName("sxt-wc"); Path path = new Path("/user/root/test.txt"); FileInputFormat.addInputPath(job,path); Path output = new Path("/data/wc/output"); //Â≠òÂú®Âà†Èô§Êñá‰ª∂ if (output.getFileSystem(conf).exists(output))&#123; output.getFileSystem(conf).delete(output,true); &#125; FileOutputFormat.setOutputPath(job,output); job.setMapperClass(MyMapper.class); job.setReducerClass(MyReducer.class); //mapÁöÑkev vauleÁ±ªÂûã job.setMapOutputKeyClass(Text.class); job.setMapOutputValueClass(IntWritable.class); //outputÁöÑkey valueÁ±ªÂûã job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); // Submit the job, then poll for progress until the job is complete job.waitForCompletion(true); &#125;&#125; Mapper 123456789101112131415public class MyMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt;&#123; private final static IntWritable one = new IntWritable(1); private Text word = new Text(); //hello sxt 1 public void map(Object key, Text value, Context context) throws IOException, InterruptedException &#123; StringTokenizer itr = new StringTokenizer(value.toString()); while (itr.hasMoreTokens()) &#123; word.set(itr.nextToken()); context.write(word, one); &#125; &#125;&#125; Reducer 12345678910111213public class MyReducer extends Reducer&lt;Text,IntWritable, Text,IntWritable&gt; &#123; private IntWritable result = new IntWritable(); public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException &#123; int sum = 0; for (IntWritable val : values) &#123; sum += val.get(); &#125; result.set(sum); context.write(key, result); &#125;&#125; Build Artifact jarÂåÖÔºå‰∏ä‰º†Âà∞ÊúçÂä°Âô®node01 1hadoop jar wordcount.jar com.sxt.hadoop.mapreduce.MyWC http://node04:8088 Êü•ÁúãjobÊâßË°å MapReduce JobËøêË°åÊ∫êÁ†ÅËß£ËØªÂÆ¢Êà∑Á´ØÊ∫êÁ†ÅËß£ËØª ÂÖ•Âè£ job.waitForCompletion(true); 1submit(); -&gt; submitter.submitJobInternal(Job.this, cluster); org.apache.hadoop.mapreduce.JobSubmitter#submitJobInternal ÊñπÊ≥ï ËÆ°ÁÆóÂàáÁâáÂíåmapÔºåJobSubmitter197Ë°å 123int maps = writeSplits(job, submitJobDir);maps = writeNewSplits(job, jobSubmitDir); ReflectionUtils.newInstatnce ÈªòËÆ§ TextInputFormat.class ÁªßÊâø FileInputFormat input.getSplits(jb) FileInputFormat#getSplits ÂæóÂà∞ blocklocations 1blkLocations = fs.getFileBlockLocations(file, 0, length); ËÆ°ÁÆóÂàáÁâáÁöÑÂ§ßÂ∞è Ëã•Ë¶ÅÂàáÁâáÊØîÂùóÂ§ßÔºåÈÖçÁΩÆminSize ÊØîÂùóÂ§ßÔºåÂæóÂá∫ÁöÑÂàáÁâáÂ§ßÂ∞èÂ§ß‰∫éÂùó 123long splitSize = computeSplitSize(blockSize, minSize, maxSize);Math.max(minSize, Math.min(maxSize, blockSize)); 123456789101112131415161718long blockSize = file.getBlockSize();long splitSize = computeSplitSize(blockSize, minSize, maxSize);long bytesRemaining = length;while (((double) bytesRemaining)/splitSize &gt; SPLIT_SLOP) &#123; int blkIndex = getBlockIndex(blkLocations, length-bytesRemaining); splits.add(makeSplit(path, length-bytesRemaining, splitSize, blkLocations[blkIndex].getHosts(), blkLocations[blkIndex].getCachedHosts())); bytesRemaining -= splitSize;&#125;if (bytesRemaining != 0) &#123; int blkIndex = getBlockIndex(blkLocations, length-bytesRemaining); splits.add(makeSplit(path, length-bytesRemaining, bytesRemaining, blkLocations[blkIndex].getHosts(), blkLocations[blkIndex].getCachedHosts()));&#125; bytesRemainingÂâ©‰ΩôÁöÑÂ≠óËäÇÊï∞ length-bytesRemaining ÂæóÂá∫ÁöÑÂ∞±ÊòØÊØè‰∏™ÂàáÁâáÁöÑÂÅèÁßªÈáè getBlockIndex Áî®ÂàáÁâáÁöÑÂÅèÁßªÈáèÔºåÂú®Âì™‰∏™ÂùóÁöÑÂÅèÁßªÈáèÂíåÁªàÊ≠¢ÂÅèÁßªÈáè‰πãÈó¥ÔºåÂæóÂà∞Á¨¨Âá†‰∏™Âùó 1234567for (int i = 0 ; i &lt; blkLocations.length; i++) &#123; // is the offset inside this block? if ((blkLocations[i].getOffset() &lt;= offset) &amp;&amp; (offset &lt; blkLocations[i].getOffset() + blkLocations[i].getLength()))&#123; return i; &#125;&#125; makeSplit ÂÆåÊàêÂàáÁâáÔºå‰º†ÈÄípathÔºåÂàáÁâáÁöÑÂÅèÁßªÈáèÔºåÂàáÁâáÁöÑÂ§ßÂ∞èÔºåblockÁöÑlocationsÁöÑ‰∏ªÊú∫‰ø°ÊÅØ 1234protected FileSplit makeSplit(Path file, long start, long length, String[] hosts, String[] inMemoryHosts) &#123; return new FileSplit(file, start, length, hosts, inMemoryHosts);&#125; waitForCompletion submit() -&gt; submitter.submitJob -&gt; 197 line -&gt; writeSplites -&gt; writeNewSplits -&gt; ReflectionUtils.newInstatnce ÈªòËÆ§ TextInputFormat.class input.getSplits(jb) -&gt; FileInputFormatÁªßÊâø -&gt; minSizeÊúÄÂ∞è1 maxSize LongÊúÄÂ§ßÂÄº -„Äã file.getLen blkLocatons -&gt; fs.getFileSystem -&gt; fs.getFileBlockLocations(file ,0 ,length) ÊãøÂà∞Êñá‰ª∂ÁöÑblockÊ∏ÖÂçï ÂèØÂàáÁâá -„Äã splitSize = computeSpliteSize() ÈªòËÆ§ÂàáÁâáÂ§ßÂ∞èÔºåminSize ÊØîÂùóÂ§ßÂ∞èÂ§ßÔºåÂæóÂá∫ÁöÑÂàáÁâáÂ§ßÂ∞èÂ§ß‰∫éÂùó =„Äã FileInputFormt.setMinInputSplitSize(job,128) getBlockIndex ÂæóÂà∞Â±û‰∫éÁ¨¨Âá†‰∏™Âùó lenth-byteRemainging ÂàáÁâáÁöÑÂÅèÁßªÈáè Ôºå ÂàáÁâáÁöÑÂÅèÁßªÈáè Âú®ÂùóÁöÑÂÅèÁßªÈáè Âíå ÂùóÁöÑÁªìÊùüÂÅèÁßªÈáè‰πãÈó¥ÔºåÂæóÂà∞blockÁöÑindex Êñá‰ª∂ ÂàáÁâáÂÅèÁßªÈáè Â§ßÂ∞è getHosts‰∏ªÊú∫ Thread.sleep -&gt; .tmp/haddp-yarn/staging/root.stagging/_003/ -&gt; jarÂåÖ job.split ; job.xml ËøêË°åÈÖçÁΩÆÊ∏ÖÂçï Mapper class Reduce.class TextFormat.minSize Map TaskËøáÁ®ã Mapper.java 12345678910public void run(Context context) throws IOException, InterruptedException &#123; setup(context); try &#123; while (context.nextKeyValue()) &#123; map(context.getCurrentKey(), context.getCurrentValue(), context); &#125; &#125; finally &#123; cleanup(context); &#125;&#125; MapTask.java 12345678910111213141516171819202122232425262728293031323334353637public void run(final JobConf job, final TaskUmbilicalProtocol umbilical) throws IOException, ClassNotFoundException, InterruptedException &#123; this.umbilical = umbilical; if (isMapTask()) &#123; if (conf.getNumReduceTasks() == 0) &#123; mapPhase = getProgress().addPhase("map", 1.0f); &#125; else &#123; mapPhase = getProgress().addPhase("map", 0.667f); sortPhase = getProgress().addPhase("sort", 0.333f); &#125; &#125; TaskReporter reporter = startReporter(umbilical); boolean useNewApi = job.getUseNewMapper(); initialize(job, getJobID(), reporter, useNewApi); if (jobCleanup) &#123; runJobCleanupTask(umbilical, reporter); return; &#125; if (jobSetup) &#123; runJobSetupTask(umbilical, reporter); return; &#125; if (taskCleanup) &#123; runTaskCleanupTask(umbilical, reporter); return; &#125; if (useNewApi) &#123; runNewMapper(job, splitMetaInfo, umbilical, reporter); &#125; else &#123; runOldMapper(job, splitMetaInfo, umbilical, reporter); &#125; done(umbilical, reporter);&#125; a. conf.getNumReduceTasks() == 0 Ê≤°ÊúâreduceÁéØËäÇÔºåmapÊó∂Èó¥Âç†ÊØî100% ÊØîÂ¶ÇÊï∞ÊçÆËøáÊª§Ôºå‰∏çÁªèËøáreducer b. Âê¶ÂàôÁöÑËØùÔºå ÁªèËøá map„ÄÅ ÊéíÂ∫è 12mapPhase = getProgress().addPhase("map", 0.667f);sortPhase = getProgress().addPhase("sort", 0.333f); c. ÊúÄÂêérunNewMapper(job, splitMetaInfo, umbilical, reporter); runNewMapper 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667void runNewMapper(final JobConf job, final TaskSplitIndex splitIndex, final TaskUmbilicalProtocol umbilical, TaskReporter reporter ) throws IOException, ClassNotFoundException, InterruptedException &#123; // make a task context so we can get the classes org.apache.hadoop.mapreduce.TaskAttemptContext taskContext = new org.apache.hadoop.mapreduce.task.TaskAttemptContextImpl(job, getTaskID(), reporter); // make a mapper org.apache.hadoop.mapreduce.Mapper&lt;INKEY,INVALUE,OUTKEY,OUTVALUE&gt; mapper = (org.apache.hadoop.mapreduce.Mapper&lt;INKEY,INVALUE,OUTKEY,OUTVALUE&gt;) ReflectionUtils.newInstance(taskContext.getMapperClass(), job); // make the input format org.apache.hadoop.mapreduce.InputFormat&lt;INKEY,INVALUE&gt; inputFormat = (org.apache.hadoop.mapreduce.InputFormat&lt;INKEY,INVALUE&gt;) ReflectionUtils.newInstance(taskContext.getInputFormatClass(), job); // rebuild the input split org.apache.hadoop.mapreduce.InputSplit split = null; split = getSplitDetails(new Path(splitIndex.getSplitLocation()), splitIndex.getStartOffset()); LOG.info("Processing split: " + split); org.apache.hadoop.mapreduce.RecordReader&lt;INKEY,INVALUE&gt; input = new NewTrackingRecordReader&lt;INKEY,INVALUE&gt; (split, inputFormat, reporter, taskContext); job.setBoolean(JobContext.SKIP_RECORDS, isSkipping()); org.apache.hadoop.mapreduce.RecordWriter output = null; // get an output object if (job.getNumReduceTasks() == 0) &#123; output = new NewDirectOutputCollector(taskContext, job, umbilical, reporter); &#125; else &#123; output = new NewOutputCollector(taskContext, job, umbilical, reporter); &#125; org.apache.hadoop.mapreduce.MapContext&lt;INKEY, INVALUE, OUTKEY, OUTVALUE&gt; mapContext = new MapContextImpl&lt;INKEY, INVALUE, OUTKEY, OUTVALUE&gt;(job, getTaskID(), input, output, committer, reporter, split); org.apache.hadoop.mapreduce.Mapper&lt;INKEY,INVALUE,OUTKEY,OUTVALUE&gt;.Context mapperContext = new WrappedMapper&lt;INKEY, INVALUE, OUTKEY, OUTVALUE&gt;().getMapContext( mapContext); try &#123; input.initialize(split, mapperContext); mapper.run(mapperContext); mapPhase.complete(); setPhase(TaskStatus.Phase.SORT); statusUpdate(umbilical); input.close(); input = null; output.close(mapperContext); output = null; &#125; finally &#123; closeQuietly(input); closeQuietly(output, mapperContext); &#125;&#125; ÂèçÂ∞ÑÂàùÂßãÂåñMapperÔºå‰∏öÂä°ÂÆûÁé∞ÁöÑMapper„ÄÇJobContextImplÊü•ÁúãÈªòËÆ§ÂÆûÁé∞„ÄÇ 123org.apache.hadoop.mapreduce.Mapper&lt;INKEY,INVALUE,OUTKEY,OUTVALUE&gt; mapper = (org.apache.hadoop.mapreduce.Mapper&lt;INKEY,INVALUE,OUTKEY,OUTVALUE&gt;) ReflectionUtils.newInstance(taskContext.getMapperClass(), job); ÂèçÂ∞ÑÂ∑•ÂÖ∑ Mapper ÂÆû‰æãÂåñ InputFormatÂÆû‰æãÂåñÔºåJobContextImpl ÈªòËÆ§TextINputFormat 12345public Class&lt;? extends InputFormat&lt;?,?&gt;&gt; getInputFormatClass() throws ClassNotFoundException &#123; return (Class&lt;? extends InputFormat&lt;?,?&gt;&gt;) conf.getClass(INPUT_FORMAT_CLASS_ATTR, TextInputFormat.class);&#125; ÂÆû‰æãÂåñNewTrakingRecordReader 123org.apache.hadoop.mapreduce.RecordReader&lt;INKEY,INVALUE&gt; input = new NewTrackingRecordReader&lt;INKEY,INVALUE&gt; (split, inputFormat, reporter, taskContext); MapTask.NewTrackingRecordReaderline 512 ÂàõÂª∫ RecordReader 1this.real = inputFormat.createRecordReader(split, taskContext); TextInputFormatÂÆûÁé∞ Ôºå ÂèÇÊï∞‰∏∫Â≠óËäÇÊï∞ÁªÑÔºåËøîÂõû LineRecordReader 12345678910public RecordReader&lt;LongWritable, Text&gt; createRecordReader(InputSplit split, TaskAttemptContext context) &#123; String delimiter = context.getConfiguration().get( "textinputformat.record.delimiter"); byte[] recordDelimiterBytes = null; if (null != delimiter) recordDelimiterBytes = delimiter.getBytes(Charsets.UTF_8); return new LineRecordReader(recordDelimiterBytes);&#125; MapContextImplÁöÑÂÆûÁé∞ÈÉΩÊòØÂßîÊâòÁªôLIneRecordReder reader.getCurrentKey reader.nestKeyValue() LineRecordReader1234567891011121314151617181920212223242526public LineRecordReader(Configuration job, FileSplit split, byte[] recordDelimiter) throws IOException &#123; this.maxLineLength = job.getInt(org.apache.hadoop.mapreduce.lib.input. LineRecordReader.MAX_LINE_LENGTH, Integer.MAX_VALUE); start = split.getStart(); end = start + split.getLength(); final Path file = split.getPath(); compressionCodecs = new CompressionCodecFactory(job); codec = compressionCodecs.getCodec(file); final FileSystem fs = file.getFileSystem(job); fileIn = fs.open(file); if (isCompressedInput()) &#123; ... &#125; else &#123; fileIn.seek(start); in = new UncompressedSplitLineReader( fileIn, job, recordDelimiter, split.getLength()); filePosition = fileIn; &#125; if (start != 0) &#123; start += in.readLine(new Text(), 0, maxBytesToConsume(start)); &#125; this.pos = start;&#125; fileIn.seek(start)Áõ¥Êé•‰ªéÂàáÁâáÁöÑÂÅèÁßªÈáèÂºÄÂßãËØª start !=0 Á¨¨‰∫å‰∏™ÂàáÁâáÂºÄÂßãÈÉΩË¶ÅÂ§ÑÁêÜÔºå in.readLine(new Text(),0,) ËØªÂá∫Á¨¨‰∏ÄË°åÔºåÊç¢Ë°åÁ¨¶Ôºå‰∏çÁî®ÔºåÁÆóÂá∫Â≠óËäÇÊï∞ start = start + Êï∞ÂÄº ÔºåËøôÊ†∑Â§ÑÁêÜ‰∏ÄË°åÊñáÊú¨ÔºåË¢´ÊãÜÂàÜÂà∞Â§ö‰∏™blockÁöÑÊÉÖÂÜµ„ÄÇ mappper -&gt; map ÈáçÂÜô -&gt; ËæìÂÖ• ËæìÂá∫ context.write 340Ë°å runNewMapper try finally ÂàùÂßãÂåñ mapper.run ÊéíÂ∫è ÈáäÊîæ ÂÖ≥Èó≠ ÂèçÂ∞ÑÂ∑•ÂÖ∑ Mapper ÂÆû‰æãÂåñ InputFormatÂÆû‰æãÂåñÔºåÈªòËÆ§TextINputFormat hadoop‰∏≠spilte spark‰∏≠ÊòØpartition NewTrakingRecordReader 512Ë°å inputFormat.createRecordReader -&gt; new LIneRecordReder ÈáçË¶Å MapContextImplÁöÑÂÆûÁé∞ ÈÉΩÊòØLIneRecordReder reader.getCurrentKey reader.nestKeyValue() LIneRecordReader initlize host‰ø°ÊÅØÂ∑≤ÁªèÂú®ÂàÜÈÖçcontainerÂÅö‰∫ÜÔºåfileIn.seek(start)Áõ¥Êé•ÂÜ≤ÂàáÁâáÁöÑÂÅèÁßªÈáèÂºÄÂßãËØª start !=0 Á¨¨‰∫å‰∏™ÂàáÁâáÂºÄÂßãÈÉΩË¶ÅÂ§ÑÁêÜÔºå in.readLine(new Text(),0,) ËØªÂá∫Á¨¨‰∏ÄË°åÔºåÊç¢Ë°åÁ¨¶Ôºå‰∏çÈÄÇÁî®ÔºåÁÆóÂá∫Â≠óËäÇÊï∞Ôºåstart = start + Êï∞ÂÄº ÊØè‰∏™ÂàáÁâáÈÉΩ‰ºöÂ§öËØª1Ë°åÔºåLineRecordReader Ôºå Êï∞ÊçÆÁßªÂä®ÈÉΩÊòØÂ∞èÈáèÁöÑ ËÆ°ÁÆóÈÉΩÊòØÂíåfsÊãøÊñá‰ª∂Ôºå‰∏çÊòØblockÂùó this.pos = start ÂàáÁâáÁöÑÁ¨¨‰∫åË°åÁöÑÂÅèÁßªÈáè LIneRecordReader nextKeyValue key valueËµãÂÄº output reducerÊï∞ÊçÆ‰∏∫0 Áõ¥Êé•ÈÄüÂá∫ NewOUtputCollerctor reduceÊï∞ÈáèÂ∞±ÊòØpartitionÊï∞ Âè™Êúâ1‰∏™ÂàÜÂå∫ÔºåPartionerÂàÜÂå∫Âô®Ôºå0 Â§ß‰∫é1ÁöÑÊó∂ÂÄôÔºåmorning hashPartitioner key.hashCOde &amp; Integer.max % reducetaskNum ËæìÂá∫ k ,v ÔºåÂèò‰∏∫ k,v,p createSorting MapoutBuffer ÂàùÂßãÂåñ sortmb ÂÜÖÂ≠òÁºìÂÜ≤Âå∫ sorter Âø´Êéí comparotor ÈªòËÆ§ ËÆæÁΩÆÊéíÂ∫èÂô®ÔºåÊ≤°ÊúâÂèñkeyÁöÑTextÁöÑÈªòËÆ§ MapTask combiner: Ë¢´ÁßªÊ§çÂà∞mapÈò∂ÊÆµÁöÑreducerTask Â∞èreducer mapËæìÂá∫‰∏ÄÊ¨°ÔºåÂΩíÂπ∂‰∏ÄÊ¨° MapoutBuffer 80%Ê∫¢Âá∫ÂÜôÔºå‰∏≠Èó¥20%ÁªßÁª≠Ôºå‰∏ç‰ºöÈòªÂ°û mapÁöÑËæìÂá∫ Âà∞ ÁéØÂΩ¢ÁºìÂÜ≤Âô® keyÂíåÁ¥¢ÂºïÈÉΩÊîæËøõÂéªÂéª Ëµ§ÈÅì ÊØîËæÉÔºåÁ¥¢ÂºïÊç¢‰ΩçÁΩÆÂç≥ÂèØ MapTask&amp;MapOutBuffer spillyixie Ê¨°Êï∞ Â∞è‰∫é SplliThread run Reducer ËøáÁ®ã ReducerTask ReducerTask runÊñπÊ≥ï line 376 Ëß¶ÂèëshufferËøáÁ®ã ÊãâÂèñÊï∞ÊçÆ„ÄÇRawKeyValueIterator rIter Ëé∑ÂèñÁúüËø≠‰ª£Âô®Ôºå‰º†ÂÖ•Âà∞reducerContext‰∏≠„ÄÇ 1234567891011121314 org.apache.hadoop.mapreduce.Reducer.Context reducerContext = createReduceContext(reducer, job, getTaskID(), rIter, reduceInputKeyCounter, reduceInputValueCounter, trackedRW, committer, reporter, comparator, keyClass, valueClass);try &#123; reducer.run(reducerContext); &#125; finally &#123; trackedRW.close(reducerContext); &#125; 627 reduce.run ÂàõÂª∫‰∏ä‰∏ãÊñá Reducer 1234567891011121314public void run(Context context) throws IOException, InterruptedException &#123; setup(context); try &#123; while (context.nextKey()) &#123; reduce(context.getCurrentKey(), context.getValues(), context); Iterator&lt;VALUEIN&gt; iter = context.getValues().iterator(); if(iter instanceof ReduceContext.ValueIterator) &#123; ((ReduceContext.ValueIterator&lt;VALUEIN&gt;)iter).resetBackupStore(); &#125; &#125; &#125; finally &#123; cleanup(context); &#125;&#125; reduceÊñπÊ≥ïÁî®Êà∑ÈáçÂÜô ReduceContextImpl nextKeyValue() ‰ªéÁúüËø≠‰ª£Âô®ÂèñÂÄºÔºåline138 1DataInputBuffer nextKey = input.getKey(); line 158 nextKeyIsSameÊ†πÊçÆÂàÜÁªÑÊØîËæÉÂô®ÔºåÊØîËæÉ‰∏ã‰∏ÄÊ¨°ÁöÑkeyÊòØÂê¶Áõ∏Âêå„ÄÇ 123456789101112hasMore = input.next();if (hasMore) &#123; nextKey = input.getKey(); nextKeyIsSame = comparator.compare(currentRawKey.getBytes(), 0, currentRawKey.getLength(), nextKey.getData(), nextKey.getPosition(), nextKey.getLength() - nextKey.getPosition() ) == 0;&#125; else &#123; nextKeyIsSame = false;&#125; ÂÅáËø≠‰ª£Âô®ÔºågetValuesÊñπÊ≥ïËøîÂõû 1private ValueIterable iterable = new ValueIterable(); docÊñáÊ°£ map‰∏≠ÊòØÊó†Â∫èÂà∞ÊúâÂ∫è reducerÈÉΩÊòØÂΩíÂπ∂ÊéíÂ∫è ReduceTask run line 376 Ëß¶ÂèëshufferËøáÁ®ã ÊãâÂèñÊï∞ÊçÆÔºåÊ≤°Êúâspark‰ºòÁæé,ÔºåÁúüËø≠‰ª£Âô®rIter 386 map task ÁéØÂΩ¢ÁºìÂÜ≤Âå∫ ÁöÑ „ÄÇ ÂàÜÂå∫ÊØîËæÉÂô® map task Áî®Êà∑ËÆæÁΩÆÔºåÊ≤°ÊúâÂàôÂèñkeyËá™Ë∫´ÁöÑÊéíÂ∫èÂô® reduce task Áî®Êà∑ËÆæÁΩÆÔºåÂàÜÁªÑÊØîËæÉÂô®-„Äã ÊéíÂ∫èÊØîËæÉÂô®ÔºåÊ≤°ÊúâÂèñvalueËá™Ë∫´ÁöÑÊéíÂ∫è 627 reduce.run ÂàõÂª∫‰∏ä‰∏ãÊñá Reducer.class run nexyKye nextKey ÊîæÁ©∫Ëøá ReduceContestImpl.class nextKeyValue() ‰ªéÁúüËø≠‰ª£Âô®ÂèñÂÄº hasMore nextKeyIsSmae ÂàÜÁªÑÊØîËæÉÂô® ÂΩìÂâçÂíåÂèñ‰∏ã‰∏ÄÊ¨°ÁöÑÊØîËæÉ getValues iterable ValueIterrable ÂÅá„ÄÇËø≠‰ª£Âô® 239Ë°å Ê°à‰æã ÊØè‰∏™ÊúàÊúÄÈ´òÊ∞îÊ∏©ÁöÑ2Â§© MyMain ‰∏ªÂÖ•Âè£ TMapper TSorterComparator ÊéíÂ∫èÊØîËæÉÂô®„ÄÇMapTaskÈò∂ÊÆµÁî®Ôºå80%ÁéØÂΩ¢ÁºìÂÜ≤Âå∫Ê∫¢ÂÜôÔºåÂø´Êéí„ÄÇ TPartition ÂàÜÂå∫ÊØîËæÉÂô®ÔºåÂÜ≥ÂÆökeyÂà∞Âì™‰∏™ÂàÜÂå∫„ÄÇÂàÜÂå∫Êï∞Âç≥reducerTaskÊï∞„ÄÇË¶Å‰πàÈáçÂÜôkeyÁöÑhash equals ,Âê¶ÂàôÈáçÂÜôÂàÜÂå∫Âô®„ÄÇ TGroupComparator ÂàÜÁªÑÊØîËæÉÂô®ÔºåReducerTaskÈò∂ÊÆµÁî®„ÄÇÂÜ≥ÂÆökeyÊòØ‰∏çÊòØ‰∏ÄÁªÑ„ÄÇ Ê°à‰æã ËØçÈ¢ëÊêúÁ¥¢ TF*IDFÂæÆÂçöË¥¶Âè∑ÊÄªÊï∞„ÄÅ‰∏Ä‰∏™ËØçÊúâÂ§öÂ∞ë‰∏™ÂæÆÂçöÂåÖÂê´ addCacheFile ÊØè‰∏™mapÂèëÈÄÅËøáÂéªÔºå‰Ωú‰∏∫Êú¨Âú∞Êñá‰ª∂ TF * idF LastJob LastMapper setup Êï∞ÊçÆÈõÜ‰∏çÊòØÂæàÂ§ßÔºåÂæàÂÖ∂‰ªñmapÈÉΩË¶ÅÂÖ≥ËÅî cmap : count ÂæÆÂçöÊÄªÊï∞ dfÔºö ‰∏Ä‰∏™ËØçÊúâÂ§öÂ∞ë‰∏™ÂæÆÂçöÂåÖÂê´ Ê°à‰æã ÁîµÂïÜÂπøÂëäÊé®ËçêUserCF Áî®Êà∑ÁöÑÁõ∏‰ººÊÄßÔºåÂçèÂêåËøáÊª§ ItemCF Âü∫‰∫éÁâ©ÂìÅÁöÑÂçèÂêåËøáÊª§ MapReducer Áî®Êà∑ËØÑÂàÜÂêëÈáè u1 : i1 i2 i3 u2: i2 i3 setp1 NullWrite.get() ‰∏çÂÜô Run as java Application setp2 Áî®Êà∑ËØÑÂàÜÂêëÈáè setp3 ÂêåÁé∞Áü©Èòµ ÂØπÁß∞Áü©Èòµ setp4 setup Áü©Èòµ * ÂêëÈáè reduceÁõ∏ÂêåÁöÑkey‰∏∫‰∏ÄÁªÑÔºåÁâ©ÂìÅ‰Ωú‰∏∫Key]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[centos7ËôöÊãüÊú∫ÈÖçÁΩÆÂèäÁΩëÁªúÈÖçÁΩÆ]]></title>
    <url>%2F2019%2F03%2F31%2Fcentos7%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8F%8A%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[ËôöÊãüÊú∫ÈÖçÁΩÆ Ê∑ªÂä†ËôöÊãüÊú∫ÔºåÈÄâÊã©centos7ÈïúÂÉè ÁßªÈô§ÂéüÊúâÁöÑÁΩëÁªúÈÄÇÈÖçÂô®ÔºåÊ∑ªÂä†ÁΩëÁªúÈÄÇÈÖçÂô®ÔºåÈÄâÊã©Ê°•Êé•ÊñπÂºè ÈùôÊÄÅipÈÖçÁΩÆ1.ip addrÊü•ÁúãÁΩëÂç°ÈÖçÁΩÆ 2.cd /etc/sysconfig/network-scripts ‰øÆÊîπifcfg-ens33Êñá‰ª∂ÔºåÊ≥®ÊÑèNAMEÂíåDEVICEÁöÑÂêçÁß∞ÂêåÊ≠•„ÄÇ 12345678910111213141516171819202122232425TYPE="Ethernet"#BOOTPROTO="dhcp"DEFROUTE="yes"PEERDNS="yes"PEERROUTES="yes"IPV4_FAILURE_FATAL="no"IPV6INIT="yes"IPV6_AUTOCONF="yes"IPV6_DEFROUTE="yes"IPV6_PEERDNS="yes"IPV6_PEERROUTES="yes"IPV6_FAILURE_FATAL="no"NAME="ens33"UUID="157c8fb5-23b3-414c-8519-25bef9b20a54"DEVICE="ens33"#ONBOOT="yes"#static assignmentNM_CONTROLLED=no #Ë°®Á§∫ËØ•Êé•Âè£Â∞ÜÈÄöËøáËØ•ÈÖçÁΩÆÊñá‰ª∂ËøõË°åËÆæÁΩÆÔºåËÄå‰∏çÊòØÈÄöËøáÁΩëÁªúÁÆ°ÁêÜÂô®ËøõË°åÁÆ°ÁêÜONBOOT=yes #ÂºÄÊú∫ÂêØÂä®BOOTPROTO=static #ÈùôÊÄÅIPIPADDR=192.168.0.151 #Êú¨Êú∫Âú∞ÂùÄNETMASK=255.255.255.0 #Â≠êÁΩëÊé©Á†ÅGATEWAY=192.168.0.255 #ÈªòËÆ§ÁΩëÂÖ≥ 3.ÈÖçÁΩÆ/etc/sysconfig/network 123NETWORKING=yesHOSTNAME=node01GATEWAY=192.168.0.255 4.ÈáçÂêØÊúçÂä° service network restart]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[flumeÈõÜÁæ§ÂÆâË£ÖÈÉ®ÁΩ≤ÊñáÊ°£]]></title>
    <url>%2F2019%2F03%2F28%2Fflume%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E6%96%87%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[ÂÆâË£ÖÂçïËäÇÁÇπÂèÇËÄÉÊñáÊ°£ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#a-simple-example ‰∏ä‰º†Ëß£Âéã123scp apache-flume-1.6.0-bin.tar.gz root@node02:/roottar -zxvf apache-flume-1.6.0-bin.tar.gzmv apache-flume-1.6.0-bin/ /usr/install/ ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè12vi /etc/profilesource /etc/profile 12export FLUME_HOME=/usr/install/apache-flume-1.6.0-binexport PATH=$PATH:$ZOOKEEPER_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$HIVE_HOME/bin:$HBASE_HOME/bin:$FLUME_HOME/bin ‰øÆÊîπconf/flume-env.sh Êñá‰ª∂‰∏≠ÁöÑJDKÁõÆÂΩï12cp flume-env.sh.template flume-env.shvi flume-env.sh 1export JAVA_HOME=/usr/install/jdk/jdk1.8.0_171 È™åËØÅÂÆâË£ÖÊòØÂê¶ÊàêÂäü1flume-ng version ‰øÆÊîπÈÖçÁΩÆ12cd conf/vi simple.conf 12345678910111213141516171819202122# Name the components on this agenta1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = netcata1.sources.r1.bind = node02a1.sources.r1.port = 44444# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®flume1flume-ng agent -n a1 -c conf -f simple.conf -Dflume.root.logger=INFO,console ÂèëÈÄÅÊï∞ÊçÆ1telnet node02 44444 ‰∏§‰∏™flumeÂÅöÈõÜÁæ§ÂèÇËÄÉÊñáÊ°£ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#setting-multi-agent-flow Âè≥‰æßËäÇÁÇπ(node03)ÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#avro-source 1vi double-flume.conf 123456789101112131415161718192021# Name the components on this agenta1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = avroa1.sources.r1.bind = node03a1.sources.r1.port = 60000# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f double-flume.conf -Dflume.root.logger=INFO,console Â∑¶‰æßËäÇÁÇπ(node02)ÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#avro-sink 1scp -r apache-flume-1.6.0-bin/ root@node03:/usr/install 1vi double-flume.conf 1234567891011121314151617181920212223a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = netcata1.sources.r1.bind = node02a1.sources.r1.port = 44444# Describe the sinka1.sinks.k1.type = avroa1.sinks.k1.hostname = node03a1.sinks.k1.port = 60000# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f double-flume.conf -Dflume.root.logger=INFO,console ÂèëÈÄÅÊï∞ÊçÆ1telnet node02 44444 Exec SourceÊñπÂºèÔºåÁõëÊéßÊñá‰ª∂tailÂëΩ‰ª§ÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#exec-source ÈÖçÁΩÆ1vi exec.conf 12345678910111213141516171819a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = execa1.sources.r1.command = tail -F /root/test.txt# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f exec.conf -Dflume.root.logger=INFO,console Ê∑ªÂä†Êï∞ÊçÆÂæ™ÁéØÊ∑ªÂä†Êï∞ÊçÆ 1for i in &#123;1..50&#125;; do echo "$i hi flume" &gt;&gt; /root/test.txt ; sleep 0.1; done Spooling Directory SourceÁõëÊéßÁõÆÂΩïÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#spooling-directory-source ÈÖçÁΩÆ1vi spool.conf 1234567891011121314151617181920a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = spooldira1.sources.r1.spoolDir = /root/logsa1.sources.r1.fileHeader = true# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f spool.conf -Dflume.root.logger=INFO,console Êã∑Ë¥ùÊñá‰ª∂ÊºîÁ§∫mkdir logs mv aa logs/ flumeÂíåkafka‰∏§ËÄÖÁªèÂ∏∏ÈÖçÂØπ‰ΩøÁî®ÔºåË∞ÅÂú®ÂâçÂêéÈÉΩÂèØ‰ª• hdfs sinkÊñπÂºèÂèÇËÄÉ http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#hdfs-sink ÈÖçÁΩÆ1vi hdfs-sink.conf 12345678910111213141516171819202122232425262728293031323334353637383940414243a1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = spooldira1.sources.r1.spoolDir = /root/logsa1.sources.r1.fileHeader = true# Describe the sink Êñá‰ª∂ÁõÆÂΩïÊ†ºÂºèa1.sinks.k1.type=hdfsa1.sinks.k1.hdfs.path=hdfs://mycluster/flume/%Y-%m-%d/%H%M##ÊØèÈöî60sÊàñËÄÖÊñá‰ª∂Â§ßÂ∞èË∂ÖËøá10MÁöÑÊó∂ÂÄô‰∫ßÁîüÊñ∞Êñá‰ª∂ÔºårollÂØπÊñá‰ª∂ËÆæÁΩÆ# hdfsÊúâÂ§öÂ∞ëÊù°Ê∂àÊÅØÊó∂Êñ∞Âª∫Êñá‰ª∂Ôºå0‰∏çÂü∫‰∫éÊ∂àÊÅØ‰∏™Êï∞a1.sinks.k1.hdfs.rollCount=0# hdfsÂàõÂª∫Â§öÈïøÊó∂Èó¥Êñ∞Âª∫Êñá‰ª∂Ôºå0‰∏çÂü∫‰∫éÊó∂Èó¥a1.sinks.k1.hdfs.rollInterval=60# hdfsÂ§öÂ§ßÊó∂Êñ∞Âª∫Êñá‰ª∂Ôºå0‰∏çÂü∫‰∫éÊñá‰ª∂Â§ßÂ∞èa1.sinks.k1.hdfs.rollSize=10240# ÂΩìÁõÆÂâçË¢´ÊâìÂºÄÁöÑ‰∏¥Êó∂Êñá‰ª∂Âú®ËØ•ÂèÇÊï∞ÊåáÂÆöÁöÑÊó∂Èó¥ÔºàÁßíÔºâÂÜÖÔºåÊ≤°Êúâ‰ªª‰ΩïÊï∞ÊçÆÂÜôÂÖ•ÔºåÂàôÂ∞ÜËØ•‰∏¥Êó∂Êñá‰ª∂ÂÖ≥Èó≠Âπ∂ÈáçÂëΩÂêçÊàêÁõÆÊ†áÊñá‰ª∂a1.sinks.k1.hdfs.idleTimeout=3a1.sinks.k1.hdfs.fileType=DataStreama1.sinks.k1.hdfs.useLocalTimeStamp=true## ÊØè‰∫îÂàÜÈíüÁîüÊàê‰∏Ä‰∏™ÁõÆÂΩïÔºåroundÂØπÁõÆÂΩïËÆæÁΩÆ# ÊòØÂê¶ÂêØÁî®Êó∂Èó¥‰∏äÁöÑ‚ÄùËàçÂºÉ‚ÄùÔºåËøôÈáåÁöÑ‚ÄùËàçÂºÉ‚ÄùÔºåÁ±ª‰ºº‰∫é‚ÄùÂõõËàç‰∫îÂÖ•‚ÄùÔºåÂêéÈù¢ÂÜç‰ªãÁªç„ÄÇÂ¶ÇÊûúÂêØÁî®ÔºåÂàô‰ºöÂΩ±ÂìçÈô§‰∫Ü%tÁöÑÂÖ∂‰ªñÊâÄÊúâÊó∂Èó¥Ë°®ËææÂºèa1.sinks.k1.hdfs.round=true# Êó∂Èó¥‰∏äËøõË°å‚ÄúËàçÂºÉ‚ÄùÁöÑÂÄºÔºõa1.sinks.k1.hdfs.roundValue=5# Êó∂Èó¥‰∏äËøõË°å‚ÄùËàçÂºÉ‚ÄùÁöÑÂçï‰ΩçÔºåÂåÖÂê´Ôºösecond,minute,houra1.sinks.k1.hdfs.roundUnit=minute# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f hdfs-sink.conf -Dflume.root.logger=INFO,console Êã∑Ë¥ùÊñá‰ª∂ÊºîÁ§∫12mkdir logsmv aa logs/ tengineÂíåflumeÈõÜÊàêÈ°πÁõÆÈÖçÁΩÆ1vi tengine_project.conf 12345678910111213141516171819202122232425a1.sources = r1a1.sinks = k1a1.channels = c1## ÁõëÂê¨tengineÁöÑaccess logÊñá‰ª∂a1.sources.r1.type = execa1.sources.r1.command = tail -F /opt/data/access.loga1.sinks.k1.type=hdfsa1.sinks.k1.hdfs.path=hdfs://mycluster/log/%Y%m%da1.sinks.k1.hdfs.rollCount=0a1.sinks.k1.hdfs.rollInterval=0a1.sinks.k1.hdfs.rollSize=10240a1.sinks.k1.hdfs.idleTimeout=5a1.sinks.k1.hdfs.fileType=DataStreama1.sinks.k1.hdfs.useLocalTimeStamp=truea1.sinks.k1.hdfs.callTimeout=40000a1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100a1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ÂêØÂä®1flume-ng agent -n a1 -c conf -f tengine_project.conf -Dflume.root.logger=INFO,console Êã∑Ë¥ùÊñá‰ª∂ÊºîÁ§∫12mkdir logsmv aa logs/]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
      <tags>
        <tag>Â§ßÊï∞ÊçÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoop HDFSÈõÜÁæ§ÂÆâË£ÖÈÉ®ÁΩ≤ÊñáÊ°£]]></title>
    <url>%2F2019%2F03%2F28%2Fhadoop%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E6%96%87%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[‰º™ÈõÜÁæ§ÂÆâË£ÖÊñπÂºè1.JAVA_HOMEÈÖçÁΩÆÁºñËæë/etc/profileÔºåÈÖçÁΩÆÂ¶Ç‰∏ã 12export JAVA_HOME=/usr/install/jdk/jdk1.8.0_171export PATH=$PATH:$&#123;JAVA_HOME&#125;/bin 2.HADOOP_HOMEÈÖçÁΩÆÁºñËæë/etc/profileÔºåÈÖçÁΩÆÂ¶Ç‰∏ã 12export HADOOP_HOME=/opt/sxt/hadoop-2.6.5export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin 3.ÈÖçÁΩÆhostnameÁºñËæë/etc/hostname 1node01 ÁºñËæë/etc/sysconfig\networkÔºåÈÖçÁΩÆÂ¶Ç‰∏ã 123NETWORKING=yesHOSTNAME=node01GATEWAY=192.168.0.255 ÈÖçÁΩÆÈùôÊÄÅipÔºåÂèÇËÄÉ‚Äúcentos7ËôöÊãüÊú∫ÈÖçÁΩÆ‚Äù ÈÖçÁΩÆhosts vi /etc/hosts 1234192.168.0.151 node01192.168.0.152 node02192.168.0.153 node03192.168.0.154 node04 ÊâßË°åhostname node01 ÊâßË°åuname -nÔºåÊü•Áúãhostname Ôºå‰∏∫node1ÈÖçÁΩÆÊ≠£Â∏∏„ÄÇ 4.ÈÖçÁΩÆssh12ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsacat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys ÊâßË°åssh node01ÔºåÊ≠£Â∏∏ËøûÊé•„ÄÇ 5.ÈÖçÁΩÆcore-site.xmlÁºñËæë/opt/sxt/hadoop-2.6.5/etc/hadoop/core-site.xml ÈÖçÁΩÆnamenodeÁöÑÂÜÖÂ≠òÊåÅ‰πÖÂåñÂ≠òÂÇ®Âú∞ÂùÄÔºåhdfsÊòØÂÖ∂‰∏≠‰∏ÄÁßç„ÄÇ 1234&lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://node01:9000&lt;/value&gt;&lt;/property&gt; viÂëΩ‰ª§,4yyÂ§çÂà∂4Ë°åÔºånpÂÜçËøõË°åÁ≤òË¥¥ ÈÖçÁΩÆhadoop.tmp.dirÔºåÊ†πÊçÆcore-default.xmlÁöÑÈÖçÁΩÆÔºåÈªòËÆ§ÈÖçÁΩÆÊòØ‰∏¥Êó∂tmpÁõÆÂΩï/tmp/hadoop-${user.name}Ôºå‰ºöÊúâË¢´Âà†Èô§ÁöÑÈ£éÈô©„ÄÇÊ†πÊçÆhdfs-default.xmlÁöÑÈÖçÁΩÆÔºådfs.namenode.name.dirÁöÑÈªòËÆ§ÈÖçÁΩÆ‰∏∫file://${hadoop.tmp.dir}/dfs/nameÔºådfs.datanode.data.dirÁöÑÈªòËÆ§ÈÖçÁΩÆ‰∏∫file://${hadoop.tmp.dir}/dfs/data„ÄÇ 1234&lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/var/sxt/hadoop/local&lt;/value&gt;&lt;/property&gt; 6.ÈÖçÁΩÆhdfs-site.xmlÁºñËæë/opt/sxt/hadoop-2.6.5/etc/hadoop/hdfs-site.xml ÈÖçÁΩÆdfs.replication blockÁöÑÂâØÊú¨‰∏∫1ÔºåÂõ†‰∏∫‰º™ÈõÜÁæ§Âè™Êúâ‰∏Ä‰∏™ËäÇÁÇπ„ÄÇ 1234&lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;value&gt;1&lt;/value&gt;&lt;/property&gt; vi 4yyÔºåÂÜçnpÁ≤òË¥¥ ÈÖçÁΩÆsecondaryÁöÑÂú∞ÂùÄ 1234&lt;property&gt; &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt; &lt;value&gt;node01:50090&lt;/value&gt;&lt;/property&gt; 7.ÈÖçÁΩÆhadoop-env.shÁºñËæë/opt/sxt/hadoop-2.6.5/etc/hadoop/hadoop-env.xmlÔºåÂõ†‰∏∫sshÂÖçÁôª‰ºöËØª‰∏çÂà∞JAVA_HOMEÁöÑÁéØÂ¢ÉÂèòÈáè„ÄÇ 12# The java implementation to use.export JAVA_HOME=/usr/install/jdk/jdk1.8.0_171 8.hdfsÊ†ºÂºèÂåñÊ†ºÂºèÂåñnamenodeÔºå/var/sxt/hadoop/localÁõÆÂΩï‰∏ã‰ºöÂá∫Áé∞„ÄÇÁîü‰∫ßÁéØÂ¢ÉÔºåË∞®ÊÖéÊìç‰Ωú data name namesecondary 1hdfs namenode -format 1start-dfs.sh Ê≠§Êó∂jpsÊü•ÁúãÂêØÂä®NameNode DataNode SecondaryNameNode ‰∏â‰∏™ËøõÁ®ã cat /var/sxt/hadoop/local/dfs/data/current/VERSIONÔºåclusterID‰∏∫ÈõÜÁæ§idÔºå‰∏Ä‰∏™ÈõÜÁæ§ÁöÑÁõ∏Âêå„ÄÇ 1234567#Fri Mar 29 23:44:23 CST 2019storageID=DS-ecfbb1c3-3054-432b-adc1-3d0420278192clusterID=CID-56727752-38bd-4609-8a00-e3166867c072cTime=0datanodeUuid=43d62867-0669-4277-b37f-859f7194bc51storageType=DATA_NODElayoutVersion=-56 9.‰∏∫rootÁî®Êà∑ÂàõÂª∫Áî®Êà∑ÁõÆÂΩïhdfs dfs -mkdir /user/root ÊµèËßàÂô®Êü•Áúã[http://192.168.0.117:50070](http://192.168.0.117:50070/) 10. ‰∏ä‰º†Êñá‰ª∂Âà∞Áî®Êà∑ÁõÆÂΩï1hdfs dfs -put hadoop-2.6.5.tar.gz /user/root Êü•Áúã‰∏ä‰º†ÁöÑÊñá‰ª∂ ÁîüÊàêÊñá‰ª∂ 1for i in ` seq 100000 `; do echo "hello sxt $i" &gt;&gt; test.txt;done ÈÖçÁΩÆblocksizeÁöÑÂ§ßÂ∞èÔºå‰∏ä‰º†Êñá‰ª∂ 1hdfs dfs -D dfs.blocksize=1048576 -put test.txt /user/root blockÂùó‰ª•Êñá‰ª∂ÁöÑÂΩ¢ÂºèÂ≠òÂÇ® 1/var/sxt/hadoop/local/dfs/data/current/BP-280976167-127.0.0.1-1553874062300/current/finalized/subdir0/subdir0 1234567891011# hadoop-2.6.5.tar.gz‰∏§‰∏™block-rw-r--r--. 1 root root 134217728 3Êúà 29 23:56 blk_1073741825-rw-r--r--. 1 root root 1048583 3Êúà 29 23:56 blk_1073741825_1001.meta-rw-r--r--. 1 root root 49377148 3Êúà 29 23:56 blk_1073741826-rw-r--r--. 1 root root 385767 3Êúà 29 23:56 blk_1073741826_1002.meta# test.txtÁöÑ‰∏§‰∏™block-rw-r--r--. 1 root root 1048576 3Êúà 30 21:31 blk_1073741827-rw-r--r--. 1 root root 8199 3Êúà 30 21:31 blk_1073741827_1003.meta-rw-r--r--. 1 root root 540319 3Êúà 30 21:31 blk_1073741828-rw-r--r--. 1 root root 4231 3Êúà 30 21:31 blk_1073741828_1004.meta ÂàÜÂ∏ÉÂºèÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè namenode datanode secondarynode node01(192.168.0.151) * node02(192.168.0.152) * * node03(192.168.0.153) * node04(192.168.0.154) * 1. sshÈÖçÁΩÆnode01Âà∞node02 node03 node04ÂàáÊç¢Âà∞node01 12cd .sshscp id_dsa.pub root@192.168.0.152:`pwd`/node01.pub ÂàáÊç¢Âà∞node02 12cd .sshcat node01.pub &gt;&gt; authorized_keys Â¶ÇÊ≠§ÈÖçÁΩÆnode03 node04 2.hostsÈÖçÁΩÆ4Âè∞Êú∫Âô®1vi /etc/hosts ÈÖçÁΩÆÂ¶Ç‰∏ã 1234192.168.0.151 node01192.168.0.152 node02192.168.0.153 node03192.168.0.154 node04 3. ÈÖçÁΩÆcore-site.xml12cd /opt/sxt/hadoop-2.6.5/etc/hadoopvi core-site.xml ÈÖçÁΩÆÂ¶Ç‰∏ã 1234567891011&lt;configuration&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; # namenodeÂêØÂä®ËäÇÁÇπÂèäÁ´ØÂè£ &lt;value&gt;hdfs://node01:9000&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/var/sxt/hadoop/full&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; 4.ÈÖçÁΩÆdatanodeÁöÑslaveËäÇÁÇπ12cd /opt/sxt/hadoop-2.6.5/etc/hadoopvi slaves ÈÖçÁΩÆÂ¶Ç‰∏ã 123node02node03node04 5.ÈÖçÁΩÆhdfs-site.xmlÔºådatanodeÊï∞ÊçÆÊï∞ÈáèÔºåsecondarynodeÁöÑÂêØÂä®ËäÇÁÇπ1vi hdfs-site.xml 123456789101112&lt;configuration&gt; &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; # datanodeÂâØÊú¨Êï∞Èáè &lt;value&gt;2&lt;/value&gt; &lt;/property&gt; &lt;property&gt; #secondarynodeÁöÑÂêØÂä®ËäÇÁÇπ &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt; &lt;value&gt;node02:50090&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; 6.scpÈÖçÁΩÆÂ•ΩÁöÑÂÆâË£ÖÁõÆÂΩïÂà∞ÂÖ∂‰ªñ3Âè∞12cd /optscp -r sxt root@192.168.0.152:/opt/ 7.formatÂíåÂêØÂä®Âú®node01formatÂíåÂêØÂä® http://192.168.0.151:50070/dfshealth.html#tab-datanode ÂèØ‰ª•Êü•ÁúãdatanodeËäÇÁÇπ 12hdfs namenode -formatstart-dfs.sh haÈ´òÂèØÁî®ÈõÜÁæ§ÈÉ®ÁΩ≤ÊñπÂºè namenode ‰∏ªÂ§áÔºåfsimage + editLog JournalNode Êõ¥Êñ∞Êó•Âøó ZKFC‰∫âÊä¢ÈîÅÔºå‰∏∫namenodeÂà§Êñ≠‰∏ªËäÇÁÇπ namenode ‰∏ªÂ§á ZKFC datanode zookeeper JNN node01 * * * node02 * * * * * node03 * * * node04 * * ÈúÄË¶ÅÈÖçÁΩÆnode01 Âíå node02‰πãÈó¥ÁöÑÁõ∏‰∫íÂÖçÂØÜ ÈúÄË¶ÅÈÖçÁΩÆnode01 Âà∞ node02 node03 node04ÁöÑÂÖçÂØÜ ÈúÄË¶ÅÈÖçÁΩÆnode02 Âà∞ node01 node03 node04ÁöÑÂÖçÂØÜ 1.zookeeperÂÆâË£Ö(node02 node03 node04)ÁºñËæëÂêØÁî®node02(192.168.0.152) 12345dataDir=/var/sxt/zkserver.1=192.168.0.152:2888:3888server.2=192.168.0.153:2888:3888server.3=192.168.0.154:2888:3888 12mkdir -p /var/sxt/zkecho "1" &gt; /var/sxt/zk/myid ‰æùÊ¨°ÂêØÂä®node03 node04 ‰ºöÂèëÁé∞node03‰Ωú‰∏∫leaderËäÇÁÇπÔºåÊØîËæÉÁâàÊú¨ÊúÄÊñ∞ÔºåÁâàÊú¨‰∏ÄÊ¨°ÊØîËæÉmyidÁöÑÂ§ßÂ∞è„ÄÇ ÂêØÂä®ÂÆånode02Ôºånode03ÁöÑmyidÊØîËæÉÂ§ßÔºå‰Ωú‰∏∫leader„ÄÇÂêØÂä®node04ÁöÑÊó∂ÂÄôÔºåleaderËäÇÁÇπÂ∑≤Â≠òÂú®„ÄÇ 12zkServer.sh startzkServer.sh status 2.ÈÖçÁΩÆhdfs-site.xmlÈÖçÁΩÆÈÄªËæëÂíåÁâ©ÁêÜÁöÑÂÖ≥Á≥ª 123456789101112131415161718192021222324&lt;property&gt; &lt;name&gt;dfs.nameservices&lt;/name&gt; &lt;value&gt;mycluster&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.ha.namenodes.mycluster&lt;/name&gt; &lt;value&gt;nn1,nn2&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.rpc-address.mycluster.nn1&lt;/name&gt; &lt;value&gt;node01:8020&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.rpc-address.mycluster.nn2&lt;/name&gt; &lt;value&gt;node02:8020&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.http-address.mycluster.nn1&lt;/name&gt; &lt;value&gt;node01:50070&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.http-address.mycluster.nn2&lt;/name&gt; &lt;value&gt;node02:50070&lt;/value&gt;&lt;/property&gt; ÈÖçÁΩÆjournalnode Âíå ssh 123456789101112131415161718192021222324&lt;property&gt; &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt; &lt;value&gt;qjournal://node01:8485;node02:8485;node03:8485/mycluster&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt; &lt;value&gt;/var/sxt/hadoop/ha/jn&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.client.failover.proxy.provider.mycluster&lt;/name&gt; &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt; &lt;value&gt;sshfence&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt; &lt;value&gt;/root/.ssh/id_dsa&lt;/value&gt;&lt;/property&gt; ÂêØÁî®zkfcÈÖçÁΩÆ 1234&lt;property&gt; &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; 3.ÈÖçÁΩÆcore-site.xmlÈÖçÁΩÆnamenodeÁöÑÂ≠òÂÇ®ÈÖçÁΩÆÔºå‰ª•ÂèäzookeeperÁöÑÈÖçÁΩÆ 1234567891011121314&lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://mycluster&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/var/sxt/hadoop/ha&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt; &lt;value&gt;node02:2181,node03:2181,node04:2181&lt;/value&gt; &lt;/property&gt; Â§çÂà∂ÈÖçÁΩÆÊñá‰ª∂Âà∞node02 node03 node04 1scp hdfs-site.xml core-site.xml node02:`pwd` 4.ÂêØÂä®journalnodeÔºånode01 node02 node031hadoop-daemon.sh start journalnode 5.Ê†ºÂºèÂåñnamenode Ê†ºÂºèÂåñzkfczookeeper ÂêØÂä®namenode123hdfs namenode -formathdfs zkfc -formtZKhadoop-daemon.sh start namenode Êü•ÁúãzkCli.sh 1ls /hadoop-ha/mycluster 6.node02 Â§çÂà∂ÈÖçÁΩÆÔºå‰ª•standbyÊñπÂºèÂêØÂä®1hdfs namenode -bootstrapStandby 7.ÊúÄÂêéÂêØÂä® hdfs1start-dfs.sh 8.ÈáçÂêØÂè™ÈúÄË¶ÅÂêØÂä®zkÔºåÂêØÂä®start-dfs.sh9.È™åËØÅhahttp://node01:50070/dfshealth.html#tab-overview Êü•Áúãnode01‰∏∫activeÁä∂ÊÄÅ ÊùÄÊéânode01kill -9 namenode http://node02:50070/dfshealth.html#tab-overview node02Âèò‰∏∫activeÁä∂ÊÄÅ ‰ªézkËäÇÁÇπÊü•Áúã‰∫âÊä¢ÈîÅÁä∂ÊÄÅ 1get /hadoop-ha/mycluster/ActiveStandbyElectorLock 123456789101112 myclusternn2node02cZxid = 0x100000175ctime = Sat Apr 06 23:58:59 EDT 2019mZxid = 0x100000175mtime = Sat Apr 06 23:58:59 EDT 2019pZxid = 0x100000175cversion = 0dataVersion = 0aclVersion = 0ephemeralOwner = 0x269f5aa4c8b003adataLength = 30numChildren = 0 ÈáçÊñ∞ÂêØÁî®node01 1hadoop-daemon.sh start namenode zkFC down‰πãÂêéÔºåÂ∫îËØ•ÊòØzk‰∫âÊä¢ÈîÅËäÇÁÇπÔºåÂ§±ÂéªÂøÉË∑≥ÈìæÊé• ÊúçÂä°Âô®down‰πãÂêéÁöÑÂêéÊûúÔºå‰πüÂèØÊ≠£Â∏∏ÂàáÊç¢ ÂºÄÂèëÂàÜÂ∏ÉÂºèÂ≠òÂÇ®windows eclipseÂºÄÂèëÈÖçÁΩÆ1.‰ΩøÁî®eclipse marsËß£ÂéãÔºåËß£Âéãhadoop-2.6.5Ôºå 2.Â§çÂà∂hadoop-2.6.5\sharre\hadoop‰∏≠comon„ÄÅhdfs„ÄÅmapreduce„ÄÅtools„ÄÅyarn‰∏≠ÁöÑÊ†πÁõÆÂΩïÁöÑjarÂåÖÔºå‰ª•ÂèälibÁõÆÂΩï‰∏ãÁöÑjarÂåÖÔºåÁªü‰∏ÄÂ§çÂà∂Âà∞ÁõÆÂΩïÔºåÂÖ±121‰∏™ÔºåÈÖçÁΩÆÊàêuser-library 3.ÈÖçÁΩÆHADOOP_HOMEÁéØÂ¢ÉÂèòÈáèÔºåHADOOP_USER_NAMEÁéØÂ¢ÉÂèòÈáè‰∏∫rootÔºåÈÖçÁΩÆpath 4.hadoop.dll ÊîæÂà∞ c:/windows/system32‰∏ã 5.Â§çÂà∂ÊúçÂä°Êú∫Âô®ÈÖçÁΩÆ‰∏≠ÁöÑcore-site.xml hdfs-site.xml Âà∞confÁõÆÂΩï‰∏ãÔºåÂπ∂Â∞ÜÊñá‰ª∂Â§πËÆæÁΩÆ‰∏∫resource ÊµãËØïÁî®‰æã 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475package com.sxt.hadoop.hdfs;import java.io.BufferedInputStream;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.IOException;import java.io.InputStream;import org.apache.hadoop.conf.Configuration;import org.apache.hadoop.fs.BlockLocation;import org.apache.hadoop.fs.FSDataOutputStream;import org.apache.hadoop.fs.FileStatus;import org.apache.hadoop.fs.FileSystem;import org.apache.hadoop.fs.Path;import org.apache.hadoop.io.IOUtils;import org.junit.After;import org.junit.Before;import org.junit.Test;public class TetsHDFS &#123; Configuration conf = null; FileSystem fs = null; @Before public void connect() throws IOException&#123; conf = new Configuration(true); fs = FileSystem.get(conf); &#125; @After public void close() throws IOException&#123; fs.close(); &#125; @Test public void mkdir() throws IOException&#123; Path dirs = new Path("/data"); if(fs.exists(dirs))&#123; fs.delete(dirs,true); &#125; fs.mkdirs(dirs); &#125; @Test public void upload() throws IOException&#123; InputStream input = new BufferedInputStream(new FileInputStream( new File("D:\\uninstall\\redis\\redis\\redis.windows.conf"))); Path f = new Path("/data/ooxx.txt"); FSDataOutputStream out = fs.create(f); IOUtils.copyBytes(input, out, conf , true); &#125; @Test public void blocksize() throws IOException&#123; Path path = new Path("/user/root/test.txt"); FileStatus fileStatus = fs.getFileStatus(path); BlockLocation[] lcts = fs.getFileBlockLocations(fileStatus, 0, fileStatus.getLen()); for(BlockLocation lct : lcts)&#123; System.out.println(lct); &#125; &#125;&#125; 1234567891011121314for i in `seq 100` ;do echo "" &gt;&gt; test.txt;donefs.getFileStatus(f);Boclocatin[] fs.getFileBOckeLocations(file,0.file.getLen);sout(locaiton);FSInput fs.open(f);sout((cahr)in.redfByte());Á¨¨‰∫å‰∏™Âùóindexin.seek(1048576);Ë∑≥Ëøá]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
      <tags>
        <tag>Â§ßÊï∞ÊçÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Netty ByteBuf]]></title>
    <url>%2F2019%2F03%2F08%2FNetty-ByteBuf%2F</url>
    <content type="text"><![CDATA[Êú¨Á´†‰∏ªË¶ÅÂÜÖÂÆπByteBufByteBufHolderByteBufAllocator‰ΩøÁî®‰∏äËø∞Êé•Âè£‰º†ËæìÊï∞ÊçÆÊó∂‰∏ÄËà¨ÈÉΩ‰ºö‰ΩøÁî®‰∏Ä‰∏™ÁºìÂÜ≤Âå∫ÂåÖË£ÖÊï∞ÊçÆ„ÄÇJavaÁöÑNIOÊúâËá™Â∑±ÁöÑBufferÁ±ªÔºåÔºåÂÆÉ‰ª¨ÂÆûÁé∞ÁöÑÂäüËÉΩÊúâÈôêÂπ∂‰∏îÊ≤°Êúâ‰ºòÂåñËøá„ÄÇ‰ΩøÁî®JDKÁöÑByteBufferÂæÄÂæÄÊòØÊØîËæÉÈ∫ªÁÉ¶‰πüÊØîËæÉÂ§çÊùÇÁöÑ„ÄÇÁºìÂÜ≤Âå∫ÊòØÁΩëÁªúÂ∫îÁî®ÈùûÂ∏∏ÈáçË¶ÅÁöÑ‰∏Ä‰∏™ÁªÑ‰ª∂ÔºåÊúâÂøÖË¶ÅÊèê‰æõÁªôÂºÄÂèëËÄÖÔºåÂπ∂‰∏îÂ∫îËØ•ÊòØAPIÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂπ∏ËøêÁöÑÊòØÔºåNettyÊèê‰æõ‰∫ÜÂäüËÉΩÂº∫Â§ßÁöÑÁºìÂÜ≤Âå∫ÂÆûÁé∞ÔºåÂÆÉÁî®Êù•Ë°®Á§∫‰∏Ä‰∏™Â≠óËäÇÂ∫èÂàóÔºåÂ∏ÆÂä©ÂºÄÂèëËÄÖÊìç‰ΩúÂéüÂßãÂ≠óËäÇÊï∞ÊçÆÊàñËÄÖËá™ÂÆö‰πâÁöÑJavaÂØπË±°„ÄÇNetty‰∏≠ÁöÑÁºìÂÜ≤Âå∫Âè´ByteBufÔºåÂÆûÈôÖ‰∏äÁ≠â‰ª∑‰∫éJDKÁöÑByteBuffer„ÄÇByteBufÁöÑ‰ΩúÁî®ÊòØÈÄöËøáNettyÁöÑÁÆ°ÈÅì‰º†ËæìÊï∞ÊçÆ„ÄÇÂÆÉ‰ªéÊ†πÊú¨‰∏äËß£ÂÜ≥‰∫ÜJDKÁºìÂÜ≤Âå∫ÁöÑÈóÆÈ¢òÔºåÂπ∂‰∏îNettyÂ∫îÁî®ÂºÄÂèëËÄÖÁªèÂ∏∏‰ºö‰ΩøÁî®Âà∞ÂÆÉÔºåËøô‰∫õÂõ†Á¥†ÈÉΩËÆ©ÂÆÉÊúâÂæàÂº∫ÁöÑÁîü‰∫ßÂäõ„ÄÇÂú®‰∏éJDKÁöÑÁºìÂÜ≤ÊúüÁõ∏ÊØîÊúâÂæàÂ§ß‰ºòÂäø„ÄÇÂõ†‰∏∫ÁºìÂÜ≤Âå∫‰º†ÈÄÅÊï∞ÊçÆÈÉΩÊòØÈÄöËøáNettyÁöÑChannelPipelineÂíåChannelHandlerÔºåÊâÄ‰ª•NettyÂ∫îÁî®ÈÉΩ‰ºö‰ΩøÁî®Âà∞ÁºìÂÜ≤Âå∫API„ÄÇ ‰∏Ä„ÄÅBuffer APINettyÁöÑBuffer API‰∏ªË¶ÅÊúâ‰∏§‰∏™Êé•Âè£ÔºöByteBufByteBufHolderNettyÁºìÂÜ≤APIÊúâ‰ª•‰∏ãÂá†‰∏™‰ºòÁÇπÔºöÂ¶ÇÊûúÊúâÈúÄË¶Å‰Ω†ÂèØ‰ª•Ëá™ÂÆö‰πâÁºìÂÜ≤Á±ªÂûãÂÜÖÁΩÆÂ§çÂêàÁºìÂÜ≤Á±ªÂûãÂÆûÁé∞Èõ∂Êã∑Ë¥ùÂÆπÈáèÊòØÊåâÈúÄÊâ©Â±ïÁöÑÔºåÁ±ª‰ººStringBuffer‰∏çÈúÄË¶ÅÈÄöËøáË∞ÉÁî®flip()ÊñπÊ≥ïÂàáÊç¢ËØªÂÜôÊ®°ÂºèËØªÁ¥¢ÂºïÂíåÂÜôÁ¥¢ÂºïÊòØÂàÜÂºÄÁöÑÊñπÊ≥ïË∞ÉÁî®ÊòØÈìæÂºèÁªìÊûÑÁöÑÂºïÁî®ÊäÄÊúØÂäüËÉΩËá™Âä®ÈáäÊîæËµÑÊ∫êÊ±†‰ºòÂåñÊäÄÊúØ‰∏äÈù¢Ëøô‰∫õÊàë‰ª¨ÂêéÈù¢ÈÉΩ‰ºö‰ªãÁªçÔºåÂåÖÊã¨Ê±†‰ºòÂåñÊäÄÊúØ„ÄÇÁé∞Âú®Êàë‰ª¨ÂÖà‰ªéÊúÄÂ∏∏Áî®ÁöÑÂ≠óËäÇÂÆπÂô®ÂºÄÂßã„ÄÇ ‰∫å„ÄÅÂ≠óËäÇÂÆπÂô®ByteBufÂΩì‰Ω†ÈúÄË¶ÅÈÄöËøáÁΩëÁªú‰∏éÂØπÁ´ØÂ¶ÇÊï∞ÊçÆÂ∫ì‰∫§Êç¢Êï∞ÊçÆÊó∂ÔºåÈÉΩÊòØÈÄöËøáÂ≠óËäÇÊù•Ê≤üÈÄöÁöÑ ByteBufÊòØ‰∏Ä‰∏™ÂèØ‰ª•ËÆ©‰Ω†ÊúâÊïàÁöÑËØªÂÜôÂ≠óËäÇÊï∞ÊçÆÁöÑÊï∞ÊçÆÂÆπÂô®„ÄÇ‰∏∫‰∫ÜÊòì‰∫éÊìç‰ΩúÔºåÂÆÉ‰ΩøÁî®‰∫Ü‰∏§‰∏™Á¥¢ÂºïÔºö‰∏Ä‰∏™Áî®Êù•ËØª‰∏Ä‰∏™Áî®Êù•ÂÜô„ÄÇËøôÊ†∑‰Ω†Âè™ÈúÄË¶ÅË∞ÉÊï¥ËØªÁ¥¢ÂºïÂ∞±ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÈáçÂ§çËØªÂèñÂÆπÂô®ÂÜÖÁöÑÊï∞ÊçÆ‰∫Ü„ÄÇ 2.1„ÄÅÂ∑•‰ΩúÊñπÂºèÂΩìÂêëByteBufÂÜôÊï∞ÊçÆÊó∂ÔºåÂÜôÁ¥¢Âºï‰ºöÊ†πÊçÆÊ†πÊçÆÂÜôÂÖ•ÁöÑÂ≠óÁ¨¶Êï∞Â¢ûÂä†ÂêåÊ†∑Êï∞ÂÄº„ÄÇÂΩì‰Ω†ÂºÄÂßãËØªÊï∞ÊçÆÊó∂ÔºåËØªÁ¥¢Âºï‰πü‰ºöÂ¢ûÂä†ÔºåÂè™ÊúâËØªÂÜôÁ¥¢ÂºïÂ§Ñ‰∫éÂêå‰∏Ä‰ΩçÁΩÆ„ÄÇÁÑ∂ÂêéByteBufÂ∞±‰∏çÂèØËØª‰∫ÜÔºåÂ¶ÇÊûúÁªßÁª≠ËØªÁöÑËØùÂ∞±‰ºöÊäõÂá∫IndexOutOfBoundsExceptionÂºÇÂ∏∏ÔºåÁ±ª‰ººËØªÊï∞ÁªÑË∂äÁïå‰∏ÄÊ†∑„ÄÇÂΩìË∞ÉÁî®‰ªª‰Ωï‰ª•readÊàñwriteÂºÄÂ§¥ÁöÑÊñπÊ≥ïÊó∂ÔºåËØªÂÜôÁ¥¢ÂºïÈÉΩ‰ºöËá™Âä®Â¢ûÈïø„ÄÇ‰πüÊúâ‰∏Ä‰∫õÁõ∏ÂØπÊìç‰ΩúÊñπÊ≥ïÂ¶ÇgetÊàñsetÔºåËøô‰∫õÊñπÊ≥ï‰∏ç‰ºöÂéªÁßªÂä®Á¥¢ÂºïÔºå‰ΩÜ‰ºöÂéªÊìç‰ΩúÁªôÂÆöÁöÑÁõ∏ÂØπÁ¥¢Âºï„ÄÇByteBufÊòØÊúâÂÆπÈáè‰∏äÈôêÁöÑÔºåÂ¶ÇÊûúÂ∞ÜÂÜôÁ¥¢ÂºïÁßªÂà∞Ë∂ÖËøáÂÆπÈáè‰∏äÈôêÁöÑ‰ΩçÁΩÆÂ∞±‰ºöÂá∫Áé∞ÂºÇÂ∏∏„ÄÇÈªòËÆ§ÁöÑÂÆπÈáè‰∏äÈôêÊòØInteger.MAX_VALUE„ÄÇ‰∏ãÂõæÂ±ïÁ§∫‰∫ÜByteBufÁöÑÂü∫Êú¨ÁªìÊûÑÂõæ„ÄÇ‰ªé‰∏äÂõæÂèØ‰ª•ÁúãÂá∫ÔºåByteBufÂæàÁ±ª‰ººÂ≠óËäÇÊï∞ÁªÑÔºåÊúÄÊòéÊòæÁöÑÂå∫Âà´Â∞±ÊòØByteBufÊúâÂàÜÂºÄ‰∫ÜËØªÂÜôÁ¥¢ÂºïËøõË°åËÆøÈóÆÊï∞ÊçÆ„ÄÇ 2.2„ÄÅ‰∏çÂêåÁ±ªÂûãÁöÑByteBufÂ∏∏Áî®ÁöÑByteBuf‰∏ÄÂÖ±Êúâ‰∏âÁßçÔºåÂÖ∂‰ªñÁöÑ‰πüÊúâ‰∏çÂ∞ëÔºå‰∏çËøá‰∏ÄËà¨ÂºÄÂèëËÄÖÂæàÂ∞ë‰ºöÁî®Âà∞ÔºåÈÉΩÊòØNettyÂÜÖÈÉ®‰ΩøÁî®„ÄÇÂèØËÉΩ‰Ω†Ëøò‰ºöÂÆûÁé∞Ëá™Â∑±ÁöÑÁºìÂÜ≤Âå∫Ôºå‰∏çËøáËøô‰∏™‰∏çÂú®Êú¨Á´†ÂÜÖÂÆπ‰πãÂÜÖ„ÄÇÈ¶ñÂÖàÊù•ÁúãÁúã‰Ω†ÂèØËÉΩÊúÄÊÑüÂÖ¥Ë∂£ÁöÑÁºìÂÜ≤„ÄÇ Â†ÜÁºìÂÜ≤ÊúÄÂ∏∏Áî®ÁöÑByteBufÊòØÂ≠òÂÇ®Êï∞ÊçÆÂú®JVMÂ†ÜÂÜÖÂ≠ò‰∏äÁöÑÁºìÂÜ≤Âå∫„ÄÇËøôÁßçÁºìÂÜ≤Âå∫ÂÜÖÈÉ®ÂÆûÁé∞Â∞±ÊòØ‰∏Ä‰∏™Êï∞ÁªÑ„ÄÇ‰∏ãÈù¢Â±ïÁ§∫‰∏Ä‰∏ãÂÆÉÁöÑÂü∫Êú¨Áî®Ê≥ï„ÄÇ 123456789101112ByteBuf heapBuf = ...;//Ê£ÄÊµãByteBufÊòØÂê¶ÊúâÊï∞ÁªÑif (heapBuf.hasArray()) &#123; //Ëé∑ÂèñÊï∞ÁªÑÂºïÁî® byte[] array = heapBuf.array(); //ËÆ°ÁÆóÁ¨¨‰∏Ä‰∏™Â≠óËäÇÊâÄÂú®‰ΩçÁΩÆ int offset = heapBuf.arrayOffset() + heapBuf.position(); //Ëé∑ÂèñÂèØËØªÂ≠óËäÇÊÄªÊï∞ int length = heapBuf.readableBytes(); //‰ΩøÁî®Ëá™Â∑±ÁöÑ‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜÊï∞ÊçÆ YourImpl.method(array, offset, length);&#125; Â¶ÇÊûúËÆøÈóÆÈùûÂ†ÜÂÜÖÂ≠òByteBufÁöÑÊï∞ÁªÑÔºåÂ∞±‰ºöÊäõÂá∫UnsupportedOperationException„ÄÇÂõ†Ê≠§ËÆøÈóÆByteBufÊï∞ÁªÑ‰πãÂâçÂ∫îËØ•‰ΩøÁî®hasArray()ÊñπÊ≥ïÊ£ÄÊµãÊ≠§ÁºìÂÜ≤Âå∫ÊòØÂê¶ÊîØÊåÅÊï∞ÁªÑ„ÄÇ Áõ¥Êé•ÁºìÂÜ≤Âå∫Âè¶‰∏Ä‰∏™ByteBufÁöÑÂÆûÁé∞ÊòØÁõ¥Êé•ÁºìÂÜ≤Âå∫„ÄÇÁõ¥Êé•ÁöÑÊÑèÊÄùÂ∞±ÊòØËøô‰∏™ÁºìÂÜ≤Âå∫ÂàÜÈÖçÁöÑÂÜÖÂ≠òÊòØÂú®JVMÂ†ÜÂÜÖÂ≠òÂ§ñÈÉ®„ÄÇ‰ΩøÁî®Áõ¥Êé•ÂÜÖÂ≠òÊó∂‰Ω†‰∏ç‰ºöÂú®JVMÂ†ÜÁ©∫Èó¥‰∏≠ÁúãËßÅÂÆÉÁöÑ‰ΩøÁî®Èáè„ÄÇÊâÄ‰ª•‰Ω†ËÆ°ÁÆó‰Ω†ÁöÑÂ∫îÁî®ÂÜÖÂ≠ò‰ΩøÁî®ÈáèÊó∂ÔºåÁõ¥Êé•ÂÜÖÂ≠òÂå∫Âüü‰πüË¶ÅÁÆó‰∏äÔºåÁÑ∂ÂêéÈôêÂà∂ÂÆÉÁöÑÊúÄÂ§ß‰ΩøÁî®ÈáèÔºåÈò≤Ê≠¢Á≥ªÁªüÂÜÖÂ≠ò‰∏çÂ§üÁî®Âá∫Áé∞ÈîôËØØ„ÄÇÈÄöËøáÁΩëÁªú‰º†ËæìÊï∞ÊçÆÊó∂‰ΩøÁî®Áõ¥Êé•ÁºìÂÜ≤ÊÄßËÉΩÊòØÂæàÈ´òÁöÑ„ÄÇ‰∏ãÈù¢ÁöÑ‰∏ÄÈÉ®ÂàÜ‰ª£Á†ÅÂ±ïÁ§∫‰∫ÜÂ¶Ç‰ΩïÈÄöËøáÊï∞ÁªÑÁöÑÊñπÂºèËÆøÈóÆÁõ¥Êé•ÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆ„ÄÇ 123456789101112ByteBuf directBuf = ...;//Ê£ÄÊü•ÁºìÂÜ≤Âå∫ÊòØÂê¶ÊúâÊï∞ÁªÑÔºåËøîÂõûflaseÂ∞±ÊòØÁõ¥Êé•ÁºìÂÜ≤if (!directBuf.hasArray()) &#123;//Ëé∑ÂèñÂèØËØªÂ≠óËäÇÊï∞Èáèint length = directBuf.readableBytes();//ÂàùÂßãÂåñÁõ∏ÂêåÈïøÂ∫¶ÁöÑÁõ¥Êé•Êï∞ÁªÑbyte[] array = new byte[length];//ËØªÂèñÊï∞ÊçÆÂà∞Êï∞ÁªÑ‰∏≠directBuf.getBytes(array);//Áî®Êà∑‰∏öÂä°ÈÄªËæëÊìç‰ΩúÂ≠óËäÇÊï∞ÁªÑYourImpl.method(array, 0, array.length);&#125; ÂèØ‰ª•ÁúãÂá∫ÔºåÁõ¥Êé•ÁºìÂÜ≤Âå∫ÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆÂ§çÂà∂Âà∞Êï∞ÁªÑÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥Áõ¥Êé•ÈÄöËøáÂ≠óËäÇÊï∞ÁªÑËÆøÈóÆÊï∞ÊçÆÔºåÁî®Â†ÜÁºìÂÜ≤Âå∫Êõ¥Â•Ω‰∏Ä‰∫õ„ÄÇ ÁªÑÂêàÁºìÂÜ≤Âå∫Áé∞Âú®Êù•‰ªãÁªç‰∏Ä‰∏™ÁªÑÂêàÁºìÂÜ≤Âå∫ÔºåÂÆÉÁöÑÂêçÂ≠óÂè´CompositeByteBuf„ÄÇ‰∫∫Â¶ÇÂÖ∂ÂêçÔºåÂÆÉÂÖÅËÆ∏‰Ω†Â∞Ü‰∏çÂêåÁ±ªÂûãÁöÑByteBufÁªÑÂêàÂú®‰∏ÄËµ∑Âπ∂‰∏îÊèê‰æõËÆøÈóÆ‰ªñ‰ª¨ÁöÑÊñπÂºè„ÄÇCompositeByteBuf‰πüÂÉèÊòØÂêÑÁßçÁ±ªÂûãByteBufÁöÑËßÜÂõæÔºåÂÆÉÁöÑhasArray()ÊñπÊ≥ïËøîÂõûÁöÑfalseÔºåÂõ†‰∏∫ÂÆÉÈáåÈù¢ÂèØËÉΩÂåÖÂê´Â§ö‰∏™Â†ÜÁºìÂÜ≤ÊàñÁõ¥Êé•ÁºìÂÜ≤„ÄÇ‰æãÂ¶ÇÔºå‰∏ÄÊù°Ê∂àÊÅØÂèØËÉΩÁî±‰∏§‰∏™ÈÉ®ÂàÜÁªÑÊàêÔºöÊ∂àÊÅØÂ§¥ÂíåÊ∂àÊÅØ‰Ωì„ÄÇÊ®°ÂùóÂåñÂ∫îÁî®‰∏≠ÔºåËøô‰∏§ÈÉ®ÂàÜÂèØËÉΩÊòØÁî±‰∏çÂêåÊ®°ÂùóÁöÑ‰∫ßÁîüÂπ∂ÁªÑÂêàÂú®‰∏ÄËµ∑ÁÑ∂ÂêéÂÜçÂèëÈÄÅ„ÄÇÂæàÂ§öÊó∂ÂÄôÔºå‰Ω†ÂèëÈÄÅÁöÑÊ∂àÊÅØÂæÄÂæÄÂè™‰øÆÊîπ‰∏ÄÈÉ®ÂàÜÔºåÊØîÂ¶ÇÊ∂àÊÅØ‰Ωì‰∏ÄÊ†∑ÔºåÊîπÂèòÊ∂àÊÅØÂ§¥„ÄÇËøôÈáåÂ∞±‰∏çÁî®ÊØèÊ¨°ÈÉΩÈáçÊñ∞ÂàÜÈÖçÁºìÂ≠ò‰∫Ü ‰∏äÈù¢ËøôÁßçÂú∫ÊôØÂ∞±ÂæàÈÄÇÂêàCompositeByteBufÔºå‰∏çÈúÄË¶ÅÂÜÖÂ≠òÊã∑Ë¥ùÔºåËÄå‰∏î‰ΩøÁî®ÁöÑÊòØÂíåÈùûÁªÑÂêàÁºìÂÜ≤Áõ∏ÂêåÁöÑAPI„ÄÇ‰∏ãÂõæÂ±ïÁ§∫‰∫Ü‰∏ãÈù¢ÁöÑ‰º™‰ª£Á†ÅÂ±ïÁ§∫Ëøô‰∏§‰∏™ÊñπÂºè„ÄÇ 12345678//Á¨¨‰∏ÄÁßç‰ΩøÁî®Êï∞ÁªÑÁªÑÂêàByteBuffer[] message = new ByteBuffer[] &#123; header, body &#125;;//Á¨¨‰∫åÁßçÂ∞ÜÂ§¥Â∞æÈÉΩÂ§çÂà∂Âà∞Êñ∞ÁöÑByteBufferByteBuffer message2 = ByteBuffer.allocate(header.remaining()+ body.remaining());message2.put(header);message2.put(body);message2.flip(); ‰∏äÈù¢ÁöÑÊñπÂºèÈÉΩÊúâÂæàÊòéÊòæÁöÑÁº∫ÁÇπÔºö‰ΩøÁî®Êï∞ÁªÑÂ§ÑÁêÜÔºå‰ª£Á†ÅÈáèÂèäAPIÈÉΩÊØîËæÉÂ§çÊùÇ„ÄÇ‰ΩøÁî®Êï∞ÊçÆÂ§çÂà∂‰ª£‰ª∑ÊúâÂæàÂ§ßÔºåÊµ™Ë¥πÊó∂Èó¥ÂíåËµÑÊ∫ê„ÄÇ‰∏ãÈù¢Êàë‰ª¨ÁúãÁúãNettyÁöÑCompositeByteBufÊÄé‰πàÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµ„ÄÇ CompositeByteBufÁªÑÂêàÊ∂àÊÅØÂ§¥ÂíåÊ∂àÊÅØ‰ΩìÁöÑÁªìÊûÑ CompositeBytebuf‰πüÊòØ‰∏çËÉΩÈÄöËøáÊï∞ÁªÑÁöÑÊñπÂºèÁõ¥Êé•ËÆøÈóÆÂÖ∂ÈáåÈù¢ÁöÑÊï∞ÊçÆ„ÄÇ‰∏ãÈù¢Â±ïÁ§∫CompositeBytebufÊÄé‰πàËÆøÈóÆÊï∞ÊçÆ 123456789101112CompositeByteBuf compBuf = ...;ByteBuf heapBuf = ...;ByteBuf directBuf = ...;//Â∞ÜÊï∞ÊçÆÈÉΩÊîæÂÖ•Âà∞CompositeByteBufcompBuf.addComponent(heapBuf, directBuf).....//ÁßªÈô§Á¥¢ÂºïÊòØ0ÁöÑÊï∞ÊçÆÔºåÂ∞±ÂÉèListcompBuf.removeComponent(0);//ÈÅçÂéÜÁªÑÂêàÁºìÂÜ≤‰∏≠ÁöÑÁºìÂÜ≤ÂÆû‰æãfor (ByteBuf buf: compBuf) &#123; System.out.println(buf.toString());&#125; ‰∏â„ÄÅByteBufÁöÑÂ≠óËäÇÊìç‰ΩúByteBufÊèê‰æõ‰∫ÜÂæàÂ§öËØªÂÜôÂÜÖÂÆπÁöÑÊñπÊ≥ï„ÄÇ 3.1„ÄÅÈöèÊú∫ËÆøÈóÆÂíåÂéüÂßãÂ≠óËäÇÊï∞ÁªÑ‰∏ÄÊ†∑ÔºåByteBufÁöÑÁ¥¢Âºï‰πüÊòØ‰ªé0ÂºÄÂßãÁöÑ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÂÆÉÁöÑÁ¨¨‰∏Ä‰∏™Â≠óËäÇÁöÑ‰ΩçÁΩÆÊòØ0ÔºåÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÁöÑ‰ΩçÁΩÆÊòØÂÆπÈáè-1„ÄÇ‰æãÂ¶Ç‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºåÂèØ‰ª•Áõ¥Êé•ÈÅçÂéÜByteBufÁöÑÊâÄÊúâÂ≠óËäÇÔºåËÄå‰∏çÁî®ÂéªÁÆ°ÂÆÉÂÜÖÈÉ®Â¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇÂâçÈù¢ËØ¥ËøáÔºå‰ΩøÁî®setÊàñgetÂºÄÂ§¥ÁöÑÊñπÊ≥ï‰∏ç‰ºöÂ¢ûÈïøÂÆÉÁöÑËØªÂÜôÁ¥¢ÂºïÔºåÊâÄ‰ª•Â¶ÇÊûú‰Ω†‰ΩøÁî®‰∏äÈù¢ÁöÑÊñπÂºèËØªÂèñÊï∞ÊçÆÔºåÂèØ‰ª•ÂÜô‰ª£Á†ÅÊõ¥Êñ∞ËØªÂÜôÁ¥¢Âºï„ÄÇ 12345ByteBuf buffer = ...;for (int i = 0; i &lt; buffer.capacity(); i ++) &#123; byte b = buffer.getByte(i); System.out.println((char) b);&#125; 3.2„ÄÅÈ°∫Â∫èËÆøÈóÆByteBufÊèê‰æõ‰∫Ü‰∏§‰∏™Á¥¢ÂºïÊù•ÊîØÊåÅÈ°∫Â∫èËÆøÈóÆÁöÑÈúÄÊ±ÇÔºå‰∏Ä‰∏™ÊòØreaderIndexËØªÁ¥¢ÂºïÊîØÊåÅËØªÊìç‰ΩúÁöÑÔºå‰∏Ä‰∏™ÊòØwriterIndexÂÜôÁ¥¢ÂºïÊîØÊåÅÂÜôÊìç‰ΩúÁöÑÔºåÂêÑËá™‰πãÈó¥ÂàÜÂ∑•ÂæàÊòéÁ°Æ„ÄÇËÄåJDKÁöÑByteBufferÂè™Êúâ‰∏Ä‰∏™Á¥¢ÂºïÔºåÊâÄ‰ª•ÊØèÊ¨°ÂàáÊç¢ËØªÂÜôÊ®°ÂºèÁöÑÊó∂ÂÄô‰Ω†ÈÉΩÈúÄË¶ÅË∞ÉÁî®‰∏Ä‰∏ãflip()ÊñπÊ≥ï„ÄÇ‰∏ãÂõæÂ±ïÁ§∫‰∫ÜByteBufË¢´‰∏§‰∏™Á¥¢ÂºïÂàÜÊàê‰∏â‰∏™Âå∫ÂüüÁöÑÁªìÊûÑ„ÄÇ 3.3„ÄÅÂèØËØªÂ≠óËäÇÂÜÖÂÆπ(ÂÆûÈôÖÂÜÖÂÆπ)ByteBuf‰∏≠ÁöÑÂÆûÈôÖÂÜÖÂÆπÂ≠òÂÇ®Âú®ÂèØËØªÂ≠óËäÇÂå∫Âüü„ÄÇ‰ª•readÊàñskipÂºÄÂ§¥ÁöÑÊñπÊ≥ïÔºå‰Ω†ËØª‰∫ÜÂ§öÂ∞ëÊï∞ÈáèÁöÑÂ≠óËäÇÔºåÁõ∏Â∫îÁöÑËØªÁ¥¢ÂºïÂ∞±‰ºöÂ¢ûÂä†Â§öÂ∞ë‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂ±ïÁ§∫‰∫ÜÂ¶Ç‰ΩïËØªÂèñByteBuf‰∏≠ÁöÑÊâÄÊúâÂèØËØªÂÜÖÂÆπ„ÄÇ 1234ByteBuf buffer = ...;while (buffer.readable()) &#123; System.out.println(buffer.readByte());&#125; 3.4„ÄÅÂèØÂÜôÂ≠óËäÇËøôÂùóÂå∫ÂüüÊòØÈúÄË¶ÅÂ°´ÂÖÖÁöÑÊú™ÂÆö‰πâÂå∫Âüü„ÄÇ‰ª•writeÂºÄÂ§¥ÁöÑÊñπÊ≥ï‰ºö‰ªéÂΩìÂâçÁöÑwriterIndex‰ΩçÁΩÆÂÜôÂÖ•Êï∞ÊçÆÔºåÂπ∂‰∏îÂÜô‰∫ÜÂ§öÂ∞ëÊï∞ÊçÆ,Ëøô‰∏™writerIndex‰πü‰ºöÂ¢ûÂä†Áõ∏Â∫îÁöÑÊï∞Èáè„ÄÇÂ¶ÇÊûúÂÜôÊìç‰ΩúÊñπÊ≥ïÁöÑÂèÇÊï∞‰πüÊòØ‰∏Ä‰∏™ByteBufÂπ∂‰∏îÊ≤°ÊúâÊåáÂÆöÊ∫êÁ¥¢ÂºïÔºåÂàôËøô‰∏™ÂèÇÊï∞ÁöÑËØªÁ¥¢Âºï‰πü‰ºöÂ¢ûÈïøÁõ∏Â∫îÁöÑÊï∞Èáè„ÄÇÂ¶ÇÊûúÊ≤°ÊúâË∂≥Â§üÁöÑÂèØÂÜôÂå∫Âüü‰∫ÜËøòÁªßÁª≠‰ΩøÁî®ÂÜôÊìç‰ΩúÂ∞±‰ºöÊäõÂá∫IndexOutOfBoundExceptionÂºÇÂ∏∏„ÄÇÊñ∞ÂàÜÈÖçÁöÑByteBufÁöÑÂÜôÁ¥¢ÂºïÈªòËÆ§ÂÄº‰πüÊòØ0„ÄÇ‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂ±ïÁ§∫‰∫ÜÁî®IntÁ±ªÂûãÊï∞ÊçÆÂ°´Êª°ÂèØÂÜôÂå∫Âüü„ÄÇ 1234ByteBuf buffer = ...;while (buffer.writableBytes() &gt;= 4) &#123; buffer.writeInt(random.nextInt());&#125; 3.5„ÄÅÊ¥æÁîüÁºìÂÜ≤Âå∫Ê¥æÁîüÁºìÂÜ≤Âå∫Ôºå‰πüÂ∞±ÊòØÂàõÂª∫‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÁºìÂÜ≤Âå∫ÁöÑËßÜÂõæÔºåÂèØ‰ª•Ë∞ÉÁî®duplicate(),slice(),slice(int, int),readOnly()Âíåorder(ByteOrder)Á≠âÊñπÊ≥ïÂÆûÁé∞„ÄÇÊ¥æÁîüÁºìÂÜ≤Âå∫‰ºö‰∫ßÁîüËá™Â∑±ÁöÑËØªÂÜôÁ¥¢ÂºïÂíåÂÖ∂‰ªñÊ†áËÆ∞Á¥¢ÂºïÔºå‰ΩÜÊòØ‰ªñ‰ª¨ÂÖ±‰∫´ÂÜÖÈÉ®ÁöÑÊï∞ÊçÆ„ÄÇÂõ†‰∏∫ÂÆÉ‰ª¨ÂÖ±‰∫´ÂÜÖÈÉ®ÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•ÂàõÂª∫Ê¥æÁîüÁºìÂÜ≤ÊòØÊ≤°Êúâ‰ªÄ‰πàÊÄßËÉΩÊçüËÄóÁöÑÔºåËÄå‰∏îÊòØÊØîËæÉÂ•ΩÁöÑÊñπÂºèÔºå‰æãÂ¶Ç‰Ω†ÊÉ≥Êã•Êúâ‰∏Ä‰∏™ÁºìÂÜ≤Âå∫ÁöÑÂàáÁâá„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂ§çÂà∂‰∏Ä‰∏™ÁºìÂÜ≤Âå∫ÔºåÂèØ‰ª•‰ΩøÁî®copy()Êàñcopy(int, int)ÊñπÊ≥ï„ÄÇ‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂ±ïÁ§∫‰∫ÜÊÄé‰πàËé∑Âèñ‰∏Ä‰∏™ByteBufÁöÑÂàáÁâá„ÄÇ 1234567891011Charset utf8 = Charset.forName(‚ÄúUTF-8‚Äú);//Ê†πÊçÆÁªôÂÆöÁöÑÂ≠óÁ¨¶‰∏≤ÂÜÖÂÆπÂàõÂª∫‰∏Ä‰∏™ByteBufByteBuf buf = Unpooled.copiedBuffer(‚Äúxxxx‚Äú, utf8);//ÂàõÂª∫ByteBufÁöÑÂàáÁâáÔºåËµ∑Âßã‰ΩçÁΩÆÊòØ0ÔºåÊà™Ê≠¢‰ΩçÁΩÆÊòØ14ByteBuf sliced = buf.slice(0, 14);//ÊâìÂç∞ÂàáÁâáÂÜÖÂÆπÔºåÊ≠£Â∏∏Â∫îËØ•ÊòØ"xxxx"System.out.println(sliced.toString(utf8);//‰øÆÊîπÁ¥¢Âºï0ÂÜÖÂÆπbuf.setByte(0, (byte) ‚ÄôJ‚Äô);//Êñ≠Ë®Ä‰ºöÊàêÂäüÔºåÂõ†‰∏∫‰ªñ‰ª¨ÂÖ±‰∫´ÂÜÖÈÉ®ÁöÑÊï∞ÊçÆÔºåÂÖ∂ÂÆû‰øÆÊîπÁöÑÂ∞±ÊòØ‰ªñ‰ª¨ÂÜÖÈÉ®ÊåáÂêëÁöÑÂÖ±ÂêåÊï∞ÊçÆÂùóassert buf.get(0) == sliced.get(0); ÂèØ‰ª•ÂèëÁé∞ÔºåÂàáÁâáÂíåÂéüÂßãByteBufÈáåÈù¢ÁöÑÂÜÖÂÆπÂÖ∂ÂÆûÊòØÂêå‰∏ÄÂùóÂÜÖÂ≠òÂå∫Âüü„ÄÇÁé∞Âú®Êàë‰ª¨Êù•ÁúãÁúãÊÄé‰πàÂ§çÂà∂ByteBufÔºå‰ª•ÂèäÂÆÉÂíåÂàáÁâáByteBufÊúâ‰ªÄ‰πà‰∏çÂêåÔºåËØ∑Áúã‰∏ãÈù¢ÁöÑ‰ª£Á†Å„ÄÇ 1234567891011Charset utf8 = Charset.forName(‚ÄúUTF-8‚Äú);//ÂêåÊ†∑Ê†πÊçÆÁªôÂÆöÂ≠óÁ¨¶‰∏≤ÂàõÂª∫ByteBufByteBuf buf = Unpooled.copiedBuffer(‚Äúxxx!‚Äú, utf8);//Â§çÂà∂ByteBuf 0-14‰ΩçÁΩÆÁöÑÂÜÖÂÆπByteBuf copy = buf.copy(0, 14);//ËæìÂá∫Â§çÂà∂ÁöÑByteBufÂÜÖÂÆπÔºåÊ≠£Â∏∏Â∫îËØ•ÊòØ"xxx"System.out.println(copy.toString(utf8);//ÂêåÊ†∑‰øÆÊîπÂÜÖÂÆπbuf.setByte(0, (byte) ‚ÄôJ‚Äô);//Êñ≠Ë®Ä‰ºöÊàêÂäüÔºåÂõ†‰∏∫Â§çÂà∂ÁºìÂÜ≤ÂíåÂéüÂßãÁºìÂÜ≤Âπ∂Ê≤°ÊúâÂÖ±‰∫´Êï∞ÊçÆassert buf.get(0) != copy.get(0); APIÂü∫Êú¨‰∏äÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÔºå‰∏çËøá‰∏çÂêåÁöÑÊñπÂºèÊ¥æÁîüÁöÑByteBufÔºåÂÜÖÈÉ®‰πü‰ºöÊúâÁªÜÂæÆÂ∑ÆÂà´‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÂª∫ËÆÆ‰ΩøÁî®ÂàáÁâáÔºåÈô§ÈùûÂøÖÈ°ª‰∏çÂÖ±‰∫´Êï∞ÊçÆÊâç‰ΩøÁî®Â§çÂà∂ÊñπÂºè„ÄÇÂõ†‰∏∫Â§çÂà∂ByteBufÈúÄË¶ÅËøõË°åÂÜÖÂ≠òÂ§çÂà∂Êìç‰ΩúÔºå‰∏ç‰ªÖÊ∂àËÄóÊõ¥Â§öËµÑÊ∫êÔºåÊâßË°åÊñπÊ≥ï‰πü‰ºöÊõ¥ËÄóÊó∂„ÄÇ 3.6„ÄÅËØªÂÜôÊìç‰ΩúByteBufÁöÑËØªÂÜôÊìç‰ΩúÂÖ±Êúâ‰∏§Â§ßÁ±ªÔºöÂü∫‰∫éÁ¥¢ÂºïÁöÑÔºåÊåáÂÆöÁ¥¢ÂºïËØªÂÜôÁõ∏Â∫î‰ΩçÁΩÆÁöÑÊï∞ÊçÆ‰ªéÂΩìÂâçÁ¥¢ÂºïËØªÂÜôÊï∞ÊçÆÔºåÁÑ∂ÂêéÂ¢ûÈïøËØªÂÜôÁ¥¢ÂºïÂÖàÊù•Áúã‰∏Ä‰∏ãËøô‰∫õÊñπÊ≥ïÔºå‰∏ãÈù¢ÂàóÂá∫Êù•ÁöÑÈÉΩÊòØÊØîËæÉÂ∏∏Áî®ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÊûúÊÉ≥ÁúãÂÖ∂‰ªñÊñπÊ≥ïÔºåËØ∑ÂèÇËÄÉAPI DOC„ÄÇÂÖàÁúã‰∏Ä‰∏ãËØªÊìç‰ΩúÁöÑ„ÄÇ ÂêçÁß∞ÊèèËø∞getBoolean(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑBooleanÁ±ªÂûãÊï∞ÊçÆgetByte(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÂ≠óËäÇÂÜÖÂÆπgetUnsignedByte(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊó†Á¨¶Âè∑Â≠óËäÇÂÜÖÂÆπgetMedium(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑ24‰ΩçÊï¥Êï∞ÂÜÖÂÆπgetUnsignedMedium(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊó†Á¨¶Âè∑24‰ΩçÊï¥Êï∞ÂÜÖÂÆπgetInt(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑIntÁ±ªÂûãÂÜÖÂÆπgetUnsignedInt(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊó†Á¨¶Âè∑IntÁ±ªÂûãÂÜÖÂÆπgetLong(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑLongÁ±ªÂûãÂÜÖÂÆπgetUnsignedLong(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊó†Á¨¶Âè∑LongÁ±ªÂûãÂÜÖÂÆπgetShort(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑShortÁ±ªÂûãÂÜÖÂÆπgetUnsignedShort(int) Ëé∑ÂèñÊåáÂÆö‰ΩçÁΩÆÁöÑÊó†Á¨¶Âè∑ShortÁ±ªÂûãÂÜÖÂÆπgetBytes(int, ‚Ä¶) ‰ªéÁªôÂÆö‰ΩçÁΩÆÂºÄÂßãÂ∞ÜÊï∞ÊçÆËΩ¨Êç¢Âà∞ÁõÆÊ†áÂÆπÂô®‰∏≠ÂêçÁß∞ÊèèËø∞setBoolean(int, boolean) ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆÁöÑBooleanÁ±ª‰ººÊï∞ÊçÆsetByte(int, int) ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆÂ≠óËäÇÊï∞ÊçÆsetMedium(int, int) ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆ24‰ΩçÊï¥Êï∞Êï∞ÊçÆsetInt(int, int) ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆIntÁ±ªÂûãÊï∞ÊçÆsetLong(int, long) ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆLongÁ±ªÂûãÊï∞ÊçÆsetShort(int, int) ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆShortÁ±ªÂûãÊï∞ÊçÆsetBytes(int,‚Ä¶) ‰ªéÊåáÂÆö‰ΩçÁΩÆÂ∞ÜÊ∫êÊï∞ÊçÆÂÆπÂô®‰∏≠ËΩ¨Êç¢ËøáÊù•ÂÆÉÁöÑsetÊìç‰ΩúÂíågetÊìç‰ΩúÈÉΩÂæàÁ±ª‰ººÔºåËØ∑Áúã‰∏ãÈù¢ÁöÑË°®Ê†º„ÄÇ‰Ω†ÂèØËÉΩ‰ºöÂèëÁé∞setÊñπÊ≥ïÊ≤°ÊúâÊó†Á¨¶Âè∑Á±ªÂûãÁöÑ„ÄÇËøôÊòØÂõ†‰∏∫Âú®ËÆæÁΩÆÊï∞ÊçÆÁöÑÊó∂ÂÄôÊ≤°ÊúâÊó†Á¨¶Âè∑ÁöÑÊ¶ÇÂøµ„ÄÇ‰∏äÈù¢Â∑≤Áªè‰ªãÁªç‰∫ÜÁõ∏ÂÖ≥ÁöÑÊñπÊ≥ïÔºåÁé∞Âú®Êàë‰ª¨Êù•ÁúãÁúãÊÄé‰πàÂú®ÂÆûÈôÖ‰ª£Á†Å‰∏≠‰ΩøÁî®ÂÆÉ‰ª¨„ÄÇCharset utf8 = Charset.forName(‚ÄúUTF-8‚Äù);//Ê†πÊçÆÂ≠óÁ¨¶‰∏≤ÂàõÂª∫ByteBufByteBuf buf = Unpooled.copiedBuffer(‚ÄúNetty in Action rocks!‚Äù, utf8);//ÊâìÂç∞‰ΩçÁΩÆ0ÁöÑÂ≠óÁ¨¶ÔºåÊ≠£Â∏∏ËæìÂá∫‚ÄôN‚ÄôSystem.out.println((char) buf.getByte(0));//Êü•ËØ¢Áé∞Âú®ÁöÑËØªÂÜôÁ¥¢ÂºïÂêçÁß∞ÊèèËø∞readBoolean() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïBooleanÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readByte() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïByteÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readUnsignedByte() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïÊó†Á¨¶Âè∑ByteÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readMedium() ËØªÂèñÂΩìÂâçËØªÁ¥¢Âºï24‰ΩçÊï¥Êï∞Êï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readUnsignedMedium() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïÊó†Á¨¶Âè∑24‰ΩçÊï¥Êï∞Êï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readInt() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïIntÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readUnsignedInt() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïÊó†Á¨¶Âè∑IntÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readLong() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïLongÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readUnsignedLong() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïÊó†Á¨¶Âè∑LongÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readShort() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïShortÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readUnsignedShort() ËØªÂèñÂΩìÂâçËØªÁ¥¢ÂºïÊó†Á¨¶Âè∑ShortÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ËØªÁ¥¢Âºï‰ºöÂä†1readBytes(int) ‰ªéÂΩìÂâçËØªÁ¥¢ÂºïËØªÂèñÊåáÂÆöÈïøÂ∫¶ÁöÑÂ≠óËäÇÂÜÖÂÆπÔºåËØªÁ¥¢Âºï‰πü‰ºöÂ¢ûÂä†ÊåáÂÆöÈïøÂ∫¶Êé•‰∏ãÊù•‰ªãÁªçÂà∞ÁöÑËØªÂÜôÊìç‰ΩúÂ∞±ÊòØreadÂíåwriteÂºÄÂ§¥ÁöÑÊñπÊ≥ïÔºåÂâçÈù¢ËØ¥ËøáÔºåËøô‰∫õÊñπÊ≥ï‰πü‰ºöÂΩ±ÂìçÂà∞ÁºìÂÜ≤ÁöÑËØªÂÜôÁ¥¢Âºï„ÄÇËøôÈáåÈù¢Áî®Âà∞ÊúÄÂ§öÁöÑÊñπÊ≥ïÂ∞±ÊòØÊääByteBufÂΩìÊàê‰∏Ä‰∏™ÊµÅÊù•ËØªÂèñÊï∞ÊçÆ„ÄÇÂêåÊ†∑ÔºåwriteÊñπÊ≥ïÁõ∏ÂΩì‰∫éÂú®ByteBuf‰∏äËøΩÂä†Êï∞ÊçÆ„ÄÇÂ∏∏Áî®ÁöÑreadÊñπÊ≥ïÂ¶Ç‰∏ãË°®Ê†º„ÄÇÂÆÉÁöÑwriteÊñπÊ≥ïÂü∫Êú¨‰∏äÂíåreadÊñπÊ≥ï‰πüÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ„ÄÇint readerIndex = buf.readerIndex();int writerIndex = buf.writerIndex();//‰øÆÊîπ‰ΩçÁΩÆ0ÁöÑÊï∞ÊçÆbuf.setByte(0, (byte)‚ÄùB‚Äù);//ÂÜçÊ¨°ÊâìÂç∞‰ΩçÁΩÆ0ÁöÑÊï∞ÊçÆÔºåËøôÊ¨°Â∫îËØ•ÊòØ‚ÄôB‚ÄôSystem.out.println((char) buf.getByte(0));//setÊàñgetÊñπÊ≥ï‰∏ç‰ºöÊîπÂèòËØªÂÜôÁ¥¢Âºïassert readerIndex = buf.readerIndex();assert writerIndex = buf.writerIndex();ÂêçÁß∞ÊèèËø∞writeBoolean(boolean) Âú®ÂΩìÂâçÂÜôÁ¥¢Âºï‰ΩçÁΩÆÂÜôÂÖ•BooleanÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ÂÜôÁ¥¢ÂºïÂä†1writeByte(int) ÂΩìÂâçÂÜôÁ¥¢ÂºïÂÜôÂÖ•ByteÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ÂÜôÁ¥¢ÂºïÂä†1writeMedium(int) ÂΩìÂâçÂÜôÁ¥¢ÂºïÂÜôÂÖ•24‰ΩçÊï¥Êï∞Êï∞ÊçÆÔºåÂêåÊó∂ÂÜôÁ¥¢Âºï‰ºöÂä†3Ôºå24‰Ωç=3Â≠óËäÇwriteInt(int) Âú®ÂΩìÂâçÂÜôÁ¥¢ÂºïÂÜôÂÖ•32‰ΩçÊï¥Êï∞Êï∞ÊçÆÔºåÂêåÊó∂ÂÜôÁ¥¢ÂºïÂä†4Ôºå32‰Ωç=4Â≠óËäÇwriteLong(long) ÂΩìÂâçÂÜôÁ¥¢ÂºïÂÜôÂÖ•64‰ΩçÊï¥Êï∞Êï∞ÊçÆÔºåÂêåÊó∂ÂÜôÁ¥¢ÂºïÂä†8Ôºå64‰Ωç=8Â≠óËäÇwriteShort(int) ÂΩìÂâçÂÜôÁ¥¢ÂºïÂÜôÂÖ•ShortÁ±ªÂûãÊï∞ÊçÆÔºåÂêåÊó∂ÂÜôÁ¥¢ÂºïÂä†2writeBytes(ByteBuf src, intlength)‰ªéÊ∫êÊï∞ÊçÆ‰∏≠ËΩ¨Êç¢ÊåáÂÆöÈïøÂ∫¶Êï∞ÊçÆÂà∞ÂΩìÂâçÂÜôÁ¥¢ÂºïÔºåÂêåÊó∂ÂÜôÁ¥¢ÂºïÂ¢ûÂä†Áõ∏Â∫îÊï∞ÈáèÁé∞Âú®Êàë‰ª¨Êù•ÁúãÁúã‰∏äÈù¢Ëøô‰∫õreadÂíåwriteÊñπÊ≥ïÂú®ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÁöÑÂ∫îÁî®„ÄÇ‰∏ÄÁõ¥ÂøòËÆ∞‰∫ÜËØ¥‰∏Ä‰ª∂‰∫ãÔºåËé∑ÂèñÂΩìÂâçËØªÂÜôÁ¥¢ÂºïÁöÑÊñπÊ≥ïÊòØ‰∏ç‰ºö‰øÆÊîπËØªÂÜôÁ¥¢Âºï„ÄÇ‰∏äÈù¢Â∑≤Áªè‰ªãÁªç‰∫ÜÂæàÂ§öËØªÂÜôÊï∞ÊçÆÁöÑÊñπÊ≥ïÔºåÂΩìÁÑ∂ËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÂæàÊúâÁî®ÁöÑÊñπÊ≥ïÔºå‰∏ãÈù¢‰ºö‰ªãÁªçËøô‰∫õÊñπÊ≥ï„ÄÇ3.11„ÄÅÂÖ∂‰ªñÂ∏∏Áî®ÊñπÊ≥ïËøòÊúâ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÊñπÊ≥ïÊàë‰ª¨Ê≤°Êúâ‰ªãÁªçÂà∞Ôºå‰∏ãË°®ÂàóÂá∫Êù•Ëøô‰∫õÂ∏∏Áî®ÊñπÊ≥ïÔºåÂπ∂ÁÆÄË¶Å‰ªãÁªçÂÆÉ‰ª¨ÁöÑÁî®Ê≥ï„ÄÇCharset utf8 = Charset.forName(‚ÄúUTF-8‚Äù);//Ê†πÊçÆÂ≠óÁ¨¶‰∏≤ÂàõÂª∫ByteBufByteBuf buf = Unpooled.copiedBuffer(‚Äúxxx‚Äù, utf8);//ÊâìÂç∞È¶ñ‰ΩçÁΩÆÂ≠óÁ¨¶ÔºåÊ≠£Â∏∏ÊòØ‚Äôx‚ÄôSystem.out.println((char) buf.readByte());//Ëé∑ÂèñÂΩìÂâçÁöÑËØªÂÜôÁ¥¢Âºïint readerIndex = buf.readerIndex();int writerIndex = buf.writerIndex();//‰øÆÊîπÂÜôÁ¥¢Âºï0‰ΩçÁΩÆÁöÑÊï∞ÊçÆbuf.writeByte( (byte) ‚Äò?‚Äô);//ÂÜôÊï∞ÊçÆËØªÁ¥¢Âºï‰∏ç‰ºöÂèòÂåñÔºåÂÜôÁ¥¢Âºï‰ºöÂä†1assert readerIndex = buf.readerIndex();assert writerIndex != buf.writerIndex();ÂêçÁß∞ÊèèËø∞isReadable() Êúâ‰∏Ä‰∏™Â≠óËäÇÂèØËØªÂ∞±‰ºöËøîÂõûtrueisWritable() Êúâ‰∏Ä‰∏™ÂèØÂÜôÂ≠óËäÇÁ©∫Èó¥Â∞±‰ºöËøîÂõûtruereadableBytes() ËøîÂõûÂèØËØªÂ≠óËäÇÂÜÖÂÆπÊÄªÊï∞writablesBytes() ËøîÂõûÂèØÂÜôÂÜÖÂÆπÂå∫ÂüüÊÄªÊï∞capacity()ËøîÂõûÁºìÂÜ≤Âå∫ÁõÆÂâçÂÆπÈáèÔºåÂ¶ÇÊûúË∂ÖËøáËøô‰∏™Êï∞ÂÄºÔºåÁºìÂÜ≤Âå∫‰ºöÊâ©ÂÆπÔºå Âè™Âà∞ËææÂà∞maxCapacity()ÁöÑÈôêÂà∂maxCapacity() ËøîÂõûÁºìÂÜ≤Âå∫ÊúÄÂ§ßÂÆπÈáèhasArray() Â¶ÇÊûúÁºìÂÜ≤Âå∫ÂÜÖÈÉ®‰ª•Êï∞ÁªÑÂ≠òÂÇ®ËøîÂõûtruearray() ËøîÂõûÂÜÖÈÉ®Â≠òÂÇ®ÁöÑÊï∞ÁªÑÔºåÂ¶ÇÊûúÊ≤°ÊúâÊï∞ÁªÑÂàô ÊäõÂá∫UnsupportedOperationExceptionÂêçÁß∞ÊèèËø∞content() ËøîÂõûÂÆÉÂ≠òÂÇ®ÁöÑÂÜÖÂÆπÁöÑByteBufcopy() ËøîÂõû‰∏Ä‰∏™Ê∑±Êã∑Ë¥ùÁöÑByteBufHolderÔºå‰πüÂ∞±ÊòØ‰ªñ‰ª¨ÁöÑÊï∞ÊçÆ‰∏çÂÖ±‰∫´ÂâçÈù¢‰ªãÁªçÁöÑÈÉΩÊòØJavaÂü∫Á°ÄÁ±ªÂûãÔºå‰ΩÜÂæàÂ§öÊó∂ÂÄôÊàë‰ª¨ÁΩëÁªúÂ∫îÁî®ÈúÄË¶ÅÂ§ÑÁêÜÊôÆÈÄöJavaÂØπË±°Ôºå‰πüÂ∞±ÊòØJava Bean„ÄÇÈúÄË¶ÅÂ≠òÂÇ®ÂíåÊ£ÄÊü•ÔºåËÄå‰∏îÂú®ÂÆπÂô®‰∏≠ÊåâÁÖßÈ°∫Â∫èÂ≠òÂÇ®‰πüÂæàÈáçË¶Å„ÄÇÂõ†Ê≠§ÔºåNettyÊèê‰æõ‰∫ÜÂè¶‰∏Ä‰∏™Êï∞ÊçÆÂÆπÂô®MessageBuf„ÄÇ Âõõ„ÄÅByteBufHolder‰Ω†Êúâ‰∏Ä‰∏™ÂØπË±°ÔºåÈáåÈù¢ÂæàÂ§öÂ±ûÊÄßÔºå‰ΩÜÊòØÈÉΩÊòØÈÄöËøáÂ≠óËäÇÂéª‰º†ËæìÁöÑ„ÄÇ‰æãÂ¶ÇÔºåHTTPÂçèËÆÆ‰∏≠ÁöÑÁõ∏Â∫îÊï∞ÊçÆÂ∞±ÂæàÁ¨¶ÂêàËøôÁßçÊÉÖÂÜµ„ÄÇHTTPÂìçÂ∫îÊï∞ÊçÆÊúâÂæàÂ§öÂ±ûÊÄßÔºåÂ¶ÇÊûúÁä∂ÊÄÅÁ†ÅÔºåCookieÁ≠âÁ≠âÔºåËÄå‰∏îÂÆÉÂÆûÈôÖÁöÑÂÜÖÂÆπÈÉΩÊòØ‰ª•Â≠óËäÇÊñπÂºè‰º†ËæìÁöÑ„ÄÇÂõ†‰∏∫ËøôÁßçÊÉÖÂÜµÂæàÊôÆÈÅçÔºåÊâÄ‰ª•NettyÊäΩË±°‰∫Ü‰∏Ä‰∏™Êé•Âè£ByteBufHolder„ÄÇËøôÊ†∑ÂÅöÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØNettyÂèØ‰ª•‰ºòÂåñÂàÜÈÖçByteBufÔºå‰æãÂ¶Ç‰ΩøÁî®Ê±†ÊäÄÊúØÔºå‰πüËÉΩÂ§üËá™Âä®ÈáäÊîæËøôÈÉ®ÂàÜËµÑÊ∫ê„ÄÇByteBufHolderÂÆûÈôÖ‰∏äÊØîËæÉÊúâÁî®ÁöÑÊñπÊ≥ïÂ∞±ÊòØËÆøÈóÆÂÆÉÈáåÈù¢Â≠òÂÇ®ÁöÑÊï∞ÊçÆ‰ª•Âèä‰ΩøÁî®ÂºïÁî®ËÆ°Êï∞ÂäüËÉΩ„ÄÇ‰∏ãË°®Â±ïÁ§∫‰∫ÜÂÆÉÂ∏∏Áî®ÁöÑÊñπÊ≥ï„ÄÇÂ¶ÇÊûú‰Ω†‰º†ËæìÁöÑÊï∞ÊçÆÂ≠òÂÇ®ÁöÑÊòØByteBufÔºåÈÇ£‰πà‰ΩøÁî®ByteBufHolderÊòØ‰∏Ä‰∏™‰∏çÈîôÁöÑÈÄâÊã©„ÄÇ 4.1„ÄÅNettyÁºìÂÜ≤Âå∫Â∏ÆÂä©Á±ª‰ΩøÁî®JDKÁöÑNIO APIÁöÑ‰∏Ä‰∏™Âõ∞ÈöæÊòØÂÆåÊàê‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰ªªÂä°ÊúâÂæàÂ§öÈáçÂ§çÊÄßÁöÑ‰ª£Á†Å„ÄÇËôΩÁÑ∂NettyÊèê‰æõÁöÑÁºìÂÜ≤Âå∫APIÂ∑≤ÁªèÂæàÂÆπÊòì‰ΩøÁî®‰∫ÜÔºå‰ΩÜÊòØNettyËøòÊòØÊèê‰æõ‰∫ÜÂæàÂ§öÂ∑•ÂÖ∑Á±ªÊñπ‰æøÂºÄÂèëËÄÖÂàõÂª∫Êàñ‰ΩøÁî®ÁºìÂÜ≤Âå∫„ÄÇÂêçÁß∞ÊèèËø∞buffer() ÂàõÂª∫ByteBufÔºåÁ±ª‰ººÂèØËÉΩÊòØÂ†ÜÊàñÁõ¥Êé•ÁöÑÔºå‰æùËµñÂÖ∑‰ΩìÁöÑÂÆûÁé∞buffer(int)buffer(int, int)heapBuffer() ÂàõÂª∫Â†ÜÁ±ªÂûãByteBufheapBuffer(int)heapBuffer(int, int)directBuffer() ÂàõÂª∫Áõ¥Êé•Á±ªÂûãByteBufdirectBuffer(int)directBuffer(int, int)compositeBuffer() ÂàõÂª∫Â§çÂêàÁ±ªÂûãÁºìÂÜ≤Âå∫compositeBuffer(int)heapCompositeBuffer() ÂÜÖÈÉ®‰∏∫Â†ÜÁ±ªÂûãByteBufÁöÑÂ§çÂêàÁºìÂÜ≤Âå∫heapCompositeBuffer(int)directCompositeBuffer() ÂÜÖÈÉ®‰∏∫Áõ¥Êé•Á±ªÂûãByteBufÁöÑÂ§çÂêàÁºìÂÜ≤Âå∫directCompositeBuffer(int)ioBuffer() ÂàõÂª∫Áî®‰∫éIOÊìç‰ΩúÁöÑByteBuf 4.2„ÄÅByteBufAllocatorÂâçÈù¢ÊèêÂà∞ËøáÔºåNettyÊèê‰æõ‰∫ÜÊ±†ÊäÄÊúØ‰ºòÂåñ‰∫ÜÂêÑÁßçByteBuf„ÄÇ‰∏∫‰∫ÜÂÆûÁé∞Ëøô‰∏™ÂäüËÉΩNettyÊäΩË±°‰∫Ü‰∏Ä‰∏™ByteBufAllocatorÊé•Âè£„ÄÇÂÆÉ‰∏ªË¶ÅÊòØÁî®Êù•ÂàÜÈÖçByteBufÂÆû‰æãÁöÑ„ÄÇÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãByteBufAllocatorÊèê‰æõ‰∫ÜÂì™‰∫õÊìç‰Ωú„ÄÇÊúâ‰∫õÊñπÊ≥ïÂêéÈù¢Â∏¶‰∫Ü‰∏Ä‰∏™Êàñ‰∏§‰∏™IntÁ±ªÂûãÂèÇÊï∞ÔºåËøô‰∏§‰∏™ÂèÇÊï∞Â∞±ÊòØÊåáÂÆöByteBufÁöÑÂàùÂßãÂÆπÈáèÂíåÊúÄÂ§ßÂÆπÈáèÁöÑ„ÄÇ‰Ω†Â∫îËØ•ËÆ∞ÂæóByteBufÊòØÂèØ‰ª•Êâ©ÂÆπÁöÑ„ÄÇByteBufÂèØ‰ª•‰∏çÊñ≠Êâ©ÂÆπÂè™Âà∞ËææÂà∞‰∫ÜÊúÄÂ§ßÂÆπÈáè„ÄÇËé∑ÂèñByteBufAllocatorÁöÑÂºïÁî®‰πüÊòØÂæàÂÆπÊòìÁöÑ‰∫ãÊÉÖ„ÄÇÈÄöËøáChannelÊàñËÄÖ‰Ω†ÂÆûÁé∞ÁöÑChannelHandlerÁöÑÊñπÊ≥ï‰∏≠ÁöÑChannelHandlerContext„ÄÇÊõ¥Â§öÂÖ≥‰∫éChannelHandlerContextÂíåChannelHandlerÁöÑÁü•ËØÜÂ∞Ü‰ºöÂú®Á¨¨ÂÖ≠Á´†‰ªãÁªç„ÄÇ‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂ±ïÁ§∫‰∫ÜËé∑ÂèñByteBufAllocatorÁöÑÊñπÂºè„ÄÇÂêçÁß∞ÊèèËø∞buffer() ÂàõÂª∫Êú™‰ΩøÁî®Ê±†ÊäÄÊúØÁöÑÂ†ÜÁºìÂÜ≤ByteBufbuffer(int)buffer(int, int)directBuffer() ÂàõÂª∫Êú™‰ΩøÁî®Ê±†ÊäÄÊúØÁöÑÁõ¥Êé•ÁºìÂÜ≤ByteBufdirectBuffer(int)directBuffer(int, int)wrappedBuffer() ÂàõÂª∫ÂåÖÂê´ÁªôÂÆöÊï∞ÊçÆÁöÑByteBufcopiedBuffer() Â§çÂà∂ÁªôÂÆöÊï∞ÊçÆÁÑ∂ÂêéÂàõÂª∫ByteBuf 4.3„ÄÅUnpooledÊúâÊó∂ÂÄô‰Ω†Ê≤°ÂäûÊ≥ïËé∑ÂèñByteBufAllocatorÁöÑÂÆû‰æãÔºå‰πüÂ∞±ÊòØÊ≤°ÂäûÊ≥ï‰ΩøÁî®‰∏ä‰∏ÄËäÇ‰ªãÁªçÁöÑÊñπÂºèÂàõÂª∫ByteBufÂÆû‰æã„ÄÇ‰∏∫‰∫ÜÂ∫îÂØπËøôÁßçÊÉÖÂÜµÔºåNettyÊèê‰æõ‰∫Ü‰∏Ä‰∏™Â∑•ÂÖ∑Á±ªUnpooled„ÄÇËøô‰∏™Â∑•ÂÖ∑Á±ªÊèê‰æõ‰∫ÜÂæàÂ§öÈùôÊÄÅÊñπÊ≥ïÂ∏ÆÂä©Êàë‰ª¨ÂàõÂª∫ByteBufÂÆû‰æãÔºå‰∏çËøáÊ≤°Êúâ‰ΩøÁî®Ê±†ÊäÄÊúØ„ÄÇ ÂÖàÊù•ÁúãÁúãÂÆÉÊèê‰æõ‰∫ÜÂì™‰∫õÂ∏∏Áî®ÊñπÊ≥ïÁªôÊàë‰ª¨‰ΩøÁî®„ÄÇ‰Ω†‰πüÂèØ‰ª•Âú®ÈùûNettyÈ°πÁõÆ‰∏≠‰ΩøÁî®UnpooledÔºåÂõ†‰∏∫ÂÆÉÁöÑAPIÂæàÁÆÄÂçïÔºåÊÄßËÉΩ‰πüÂæàÈ´òÔºåÈ°πÁõÆ‰∏≠Â¶ÇÊûúÈúÄË¶ÅËøôÁßçÈ´òÊÄßËÉΩÁºìÂÜ≤Âå∫ÁöÑÂú∞ÊñπÂèØ‰ª•Â∞ùËØï‰∏Ä‰∏ã„ÄÇ 4.4„ÄÅByteBufUtilÂè¶‰∏Ä‰∏™ÊØîËæÉÊúâÁî®ÁöÑÁ±ªÊòØByteBufUtil„ÄÇËøô‰∏™Á±ªÊèê‰æõ‰∫ÜÂæàÂ§öÈùôÊÄÅÊñπÊ≥ïÁõ¥Êé•Êìç‰ΩúByteBuf„ÄÇÁõ∏ÊØîËæÉ‰∏äÈù¢ÁöÑUnpooledÔºåËøô‰∏™Á±ªÊèê‰æõÁöÑÊñπÊ≥ïÊòØÊØîËæÉÈÄöÁî®ÁöÑÂπ∂‰∏î‰∏çÁî®ÂÖ≥ÂøÉ‰Ω†ÁöÑByteBufÊòØ‰ΩøÁî®‰∫ÜÊ±†ÊäÄÊúØÁöÑËøòÊòØÊ≤°Êúâ‰ΩøÁî®„ÄÇ ‰æãÂ¶ÇÂÆÉÊúÄÂ∏∏Áî®ÁöÑÊñπÊ≥ïhexdump()ÔºåËøô‰∏™ÊñπÊ≥ïËøîÂõûByteBufÂÜÖÂÆπÁöÑÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè„ÄÇËøô‰∏™ÊñπÊ≥ïÂèØ‰ª•‰ΩøÁî®Âú®ÂæàÂ§öÂú∫ÊôØÔºå‰æãÂ¶ÇÊó•ÂøóÂú∫ÊôØ„ÄÇÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèÁöÑÂÜÖÂÆπ‰πüÂæàÂÆπÊòìËΩ¨ÊàêÂ≠óËäÇË°®Á§∫„ÄÇ‰Ω†‰πüËÆ∏Â•áÊÄ™‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•ÊòæÁ§∫Â≠óËäÇÂÜÖÂÆπ„ÄÇ‰∏ªË¶ÅÊòØÂõ†‰∏∫Â≠óËäÇÂÜÖÂÆπ‰∫∫Á±ªÈöæ‰ª•ÈòÖËØªÔºåËÄå16ËøõÂà∂Â∞±ÊØîËæÉÂèãÂ•Ω‰∫Ü„ÄÇ Ëøô‰∏™Á±ªÊèê‰æõ‰∫ÜÂæàÂ§öByteBufÁõ∏ÂÖ≥ÁöÑÈùôÊÄÅÊñπÊ≥ïÔºå‰æãÂ¶ÇÂ§çÂà∂„ÄÅÁºñÁ†Å„ÄÅËß£Á†ÅÁ≠âÁ≠âÔºåËøô‰∏™Â§ßÂÆ∂Âú®‰ª•ÂêéÂºÄÂèë‰∏≠‰ºöÊÖ¢ÊÖ¢Áî®Âà∞ÔºåÁîöËá≥ÂΩì‰Ω†ÈúÄË¶ÅÂÆûÁé∞Ëá™Â∑±ÁöÑByteBufÁöÑÊó∂ÂÄô‰πü‰ºöÁî®Âà∞ÂÆÉ‰ª¨„ÄÇ ‰∫î„ÄÅÊÄªÁªìÊàë‰ª¨ËøòÂ≠¶‰π†‰∫ÜNettyÁöÑÊï∞ÊçÆÂÆπÂô®ÊúâÂì™‰∫õÁ±ªÂûãÁöÑÂÆûÁé∞ÔºåÂ∑≤ÁªèÂêÑËá™ÁöÑ‰ΩøÁî®Âú∫ÊôØÂíåÊÄßËÉΩÈ´ò‰ΩéÔºåËøòÊúâÂàÜÈÖçÊàñÈáäÊîæÈúÄË¶ÅÁöÑËµÑÊ∫ê‰ª£‰ª∑„ÄÇChannel channel = ‚Ä¶;ByteBufAllocator allocator = channel.alloc();‚Ä¶.ChannelHandlerContext ctx = ‚Ä¶;ByteBufAllocator allocator2 = ctx.alloc();]]></content>
      <categories>
        <category>Netty</category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DES„ÄÅAES„ÄÅRSAÁ≠âÂ∏∏Áî®Âä†ÂØÜÁÆóÊ≥ï‰ªãÁªç‰∏éÊØîËæÉ]]></title>
    <url>%2F2019%2F03%2F04%2FDES%E3%80%81AES%E3%80%81RSA%E7%AD%89%E5%B8%B8%E7%94%A8%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%AF%94%E8%BE%83%2F</url>
    <content type="text"><![CDATA[Âä†ÂØÜÁÆóÊ≥ïÂàÜÂØπÁß∞Âä†ÂØÜÂíåÈùûÂØπÁß∞ÁÆóÊ≥ïÔºåÂÖ∂‰∏≠ÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁöÑÂä†ÂØÜ‰∏éËß£ÂØÜÂØÜÈí•Áõ∏ÂêåÔºåÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁöÑÂä†ÂØÜÂØÜÈí•‰∏éËß£ÂØÜÂØÜÈí•‰∏çÂêåÔºåÊ≠§Â§ñÔºåËøòÊúâ‰∏ÄÁ±ª‰∏çÈúÄË¶ÅÂØÜÈí•ÁöÑÊï£ÂàóÁÆóÊ≥ï„ÄÇ ‚Äã Â∏∏ËßÅÁöÑÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ï‰∏ªË¶ÅÊúâDES„ÄÅ3DES„ÄÅAESÁ≠âÔºåÂ∏∏ËßÅÁöÑÈùûÂØπÁß∞ÁÆóÊ≥ï‰∏ªË¶ÅÊúâRSA„ÄÅDSAÁ≠âÔºåÊï£ÂàóÁÆóÊ≥ï‰∏ªË¶ÅÊúâSHA-1„ÄÅMD5Á≠â„ÄÇ ÈùûÂØπÁß∞ÁÆóÊ≥ïÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁöÑÂä†ÂØÜÂØÜÈí•‰∏éËß£ÂØÜÂØÜÈí•‰∏çÂêå ÈùûÂØπÁß∞Âä†ÂØÜÔºåÂÖ¨Èí•Âä†ÂØÜÔºåÁßÅÈí•Ëß£ÂØÜÔºåÂèç‰πã‰∫¶ÁÑ∂„ÄÇÁî±‰∫éÈúÄË¶ÅÂ§ßÊï∞ÁöÑ‰πòÂπÇÊ±ÇÊ®°Á≠âÁÆóÊ≥ïÔºåËøêË°åÈÄüÂ∫¶ÊÖ¢Ôºå‰∏çÊòì‰∫éÁ°¨‰ª∂ÂÆûÁé∞„ÄÇ ÈÄöÂ∏∏ÁßÅÈí•ÈïøÂ∫¶Êúâ512bitÔºå1024bitÔºå2048bitÔºå4096bitÔºåÈïøÂ∫¶Ë∂äÈïøÔºåË∂äÂÆâÂÖ®Ôºå‰ΩÜÊòØÁîüÊàêÂØÜÈí•Ë∂äÊÖ¢ÔºåÂä†Ëß£ÂØÜ‰πüË∂äËÄóÊó∂„ÄÇ Êó¢ÁÑ∂ÊòØÂä†ÂØÜÔºåÈÇ£ËÇØÂÆöÊòØ‰∏çÂ∏åÊúõÂà´‰∫∫Áü•ÈÅìÊàëÁöÑÊ∂àÊÅØÔºåÊâÄ‰ª•Âè™ÊúâÊàëÊâçËÉΩËß£ÂØÜÔºåÊâÄ‰ª•ÂèØÂæóÂá∫ÂÖ¨Èí•Ë¥üË¥£Âä†ÂØÜÔºåÁßÅÈí•Ë¥üË¥£Ëß£ÂØÜÔºõ ÂêåÁêÜÔºåÊó¢ÁÑ∂ÊòØÁ≠æÂêçÔºåÈÇ£ËÇØÂÆöÊòØ‰∏çÂ∏åÊúõÊúâ‰∫∫ÂÜíÂÖÖÊàëÂèëÊ∂àÊÅØÔºåÂè™ÊúâÊàëÊâçËÉΩÂèëÂ∏ÉËøô‰∏™Á≠æÂêçÔºåÊâÄ‰ª•ÂèØÂæóÂá∫ÁßÅÈí•Ë¥üË¥£Á≠æÂêçÔºåÂÖ¨Èí•Ë¥üË¥£È™åËØÅ„ÄÇ ÈùûÂØπÁß∞ÂºèÂä†ÂØÜÂ∞±ÊòØÂä†ÂØÜÂíåËß£ÂØÜÊâÄ‰ΩøÁî®ÁöÑ‰∏çÊòØÂêå‰∏Ä‰∏™ÂØÜÈí•ÔºåÈÄöÂ∏∏Êúâ‰∏§‰∏™ÂØÜÈí•ÔºåÁß∞‰∏∫‚ÄùÂÖ¨Èí•‚ÄùÂíå‚ÄùÁßÅÈí•‚ÄùÔºåÂÆÉ‰ª¨‰∏§‰∏™ÂøÖÈúÄÈÖçÂØπ‰ΩøÁî®ÔºåÂê¶Âàô‰∏çËÉΩÊâìÂºÄÂä†ÂØÜÊñá‰ª∂„ÄÇÂèëÈÄÅÂèåÊñπA,B‰∫ãÂÖàÂùáÁîüÊàê‰∏ÄÂ†ÜÂØÜÂåôÔºåÁÑ∂ÂêéAÂ∞ÜËá™Â∑±ÁöÑÂÖ¨ÊúâÂØÜÂåôÂèëÈÄÅÁªôBÔºåBÂ∞ÜËá™Â∑±ÁöÑÂÖ¨ÊúâÂØÜÂåôÂèëÈÄÅÁªôAÔºåÂ¶ÇÊûúAË¶ÅÁªôBÂèëÈÄÅÊ∂à ÊÅØÔºåÂàôÂÖàÈúÄË¶ÅÁî®BÁöÑÂÖ¨ÊúâÂØÜÂåôËøõË°åÊ∂àÊÅØÂä†ÂØÜÔºåÁÑ∂ÂêéÂèëÈÄÅÁªôBÁ´ØÔºåÊ≠§Êó∂BÁ´ØÂÜçÁî®Ëá™Â∑±ÁöÑÁßÅÊúâÂØÜÂåôËøõË°åÊ∂àÊÅØËß£ÂØÜÔºåBÂêëAÂèëÈÄÅÊ∂àÊÅØÊó∂‰∏∫ÂêåÊ†∑ÁöÑÈÅìÁêÜ„ÄÇ RSAÈùûÂØπÁß∞Âä†ÂØÜÔºåÂÖ¨Èí•Âä†ÂØÜÔºåÁßÅÈí•Ëß£ÂØÜÔºåÂèç‰πã‰∫¶ÁÑ∂„ÄÇÁî±‰∫éÈúÄË¶ÅÂ§ßÊï∞ÁöÑ‰πòÂπÇÊ±ÇÊ®°Á≠âÁÆóÊ≥ïÔºåËøêË°åÈÄüÂ∫¶ÊÖ¢Ôºå‰∏çÊòì‰∫éÁ°¨‰ª∂ÂÆûÁé∞„ÄÇ ÈÄöÂ∏∏ÁßÅÈí•ÈïøÂ∫¶Êúâ512bitÔºå1024bitÔºå2048bitÔºå4096bitÔºåÈïøÂ∫¶Ë∂äÈïøÔºåË∂äÂÆâÂÖ®Ôºå‰ΩÜÊòØÁîüÊàêÂØÜÈí•Ë∂äÊÖ¢ÔºåÂä†Ëß£ÂØÜ‰πüË∂äËÄóÊó∂„ÄÇ Êó¢ÁÑ∂ÊòØÂä†ÂØÜÔºåÈÇ£ËÇØÂÆöÊòØ‰∏çÂ∏åÊúõÂà´‰∫∫Áü•ÈÅìÊàëÁöÑÊ∂àÊÅØÔºåÊâÄ‰ª•Âè™ÊúâÊàëÊâçËÉΩËß£ÂØÜÔºåÊâÄ‰ª•ÂèØÂæóÂá∫ÂÖ¨Èí•Ë¥üË¥£Âä†ÂØÜÔºåÁßÅÈí•Ë¥üË¥£Ëß£ÂØÜÔºõ ÂêåÁêÜÔºåÊó¢ÁÑ∂ÊòØÁ≠æÂêçÔºåÈÇ£ËÇØÂÆöÊòØ‰∏çÂ∏åÊúõÊúâ‰∫∫ÂÜíÂÖÖÊàëÂèëÊ∂àÊÅØÔºåÂè™ÊúâÊàëÊâçËÉΩÂèëÂ∏ÉËøô‰∏™Á≠æÂêçÔºåÊâÄ‰ª•ÂèØÂæóÂá∫ÁßÅÈí•Ë¥üË¥£Á≠æÂêçÔºåÂÖ¨Èí•Ë¥üË¥£È™åËØÅ„ÄÇ DSADSAÔºàDigital Signature AlgorithmÔºâÔºöÊï∞Â≠óÁ≠æÂêçÁÆóÊ≥ïÔºåÊòØ‰∏ÄÁßçÊ†áÂáÜÁöÑ DSSÔºàÊï∞Â≠óÁ≠æÂêçÊ†áÂáÜÔºâÔºå‰∏•Ê†ºÊù•ËØ¥‰∏çÁÆóÂä†ÂØÜÁÆóÊ≥ï„ÄÇ ECCECCÔºàElliptic Curves CryptographyÔºâÔºöÊ§≠ÂúÜÊõ≤Á∫øÂØÜÁ†ÅÁºñÁ†ÅÂ≠¶„ÄÇECCÂíåRSAÁõ∏ÊØîÔºåÂÖ∑ÊúâÂ§öÊñπÈù¢ÁöÑÁªùÂØπ‰ºòÂäøÔºå‰∏ªË¶ÅÊúâÔºöÊäóÊîªÂáªÊÄßÂº∫„ÄÇÁõ∏ÂêåÁöÑÂØÜÈí•ÈïøÂ∫¶ÔºåÂÖ∂ÊäóÊîªÂáªÊÄßË¶ÅÂº∫ÂæàÂ§öÂÄç„ÄÇËÆ°ÁÆóÈáèÂ∞èÔºåÂ§ÑÁêÜÈÄüÂ∫¶Âø´„ÄÇECCÊÄªÁöÑÈÄüÂ∫¶ÊØîRSA„ÄÅDSAË¶ÅÂø´ÂæóÂ§ö„ÄÇÂ≠òÂÇ®Á©∫Èó¥Âç†Áî®Â∞è„ÄÇECCÁöÑÂØÜÈí•Â∞∫ÂØ∏ÂíåÁ≥ªÁªüÂèÇÊï∞‰∏éRSA„ÄÅDSAÁõ∏ÊØîË¶ÅÂ∞èÂæóÂ§öÔºåÊÑèÂë≥ÁùÄÂÆÉÊâÄÂç†ÁöÑÂ≠òË¥ÆÁ©∫Èó¥Ë¶ÅÂ∞èÂæóÂ§ö„ÄÇËøôÂØπ‰∫éÂä†ÂØÜÁÆóÊ≥ïÂú®ICÂç°‰∏äÁöÑÂ∫îÁî®ÂÖ∑ÊúâÁâπÂà´ÈáçË¶ÅÁöÑÊÑè‰πâ„ÄÇÂ∏¶ÂÆΩË¶ÅÊ±Ç‰Ωé„ÄÇÂΩìÂØπÈïøÊ∂àÊÅØËøõË°åÂä†Ëß£ÂØÜÊó∂Ôºå‰∏âÁ±ªÂØÜÁ†ÅÁ≥ªÁªüÊúâÁõ∏ÂêåÁöÑÂ∏¶ÂÆΩË¶ÅÊ±ÇÔºå‰ΩÜÂ∫îÁî®‰∫éÁü≠Ê∂àÊÅØÊó∂ECCÂ∏¶ÂÆΩË¶ÅÊ±ÇÂç¥‰ΩéÂæóÂ§ö„ÄÇÂ∏¶ÂÆΩË¶ÅÊ±Ç‰Ωé‰ΩøECCÂú®Êó†Á∫øÁΩëÁªúÈ¢ÜÂüüÂÖ∑ÊúâÂπøÊ≥õÁöÑÂ∫îÁî®ÂâçÊôØ„ÄÇ ÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÂØπÁß∞ÂºèÂä†ÂØÜÂ∞±ÊòØÂä†ÂØÜÂíåËß£ÂØÜ‰ΩøÁî®Âêå‰∏Ä‰∏™ÂØÜÈí•„ÄÇ‰ø°ÊÅØÊé•Êî∂ÂèåÊñπÈÉΩÈúÄ‰∫ãÂÖàÁü•ÈÅìÂØÜÂåôÂíåÂä†Ëß£ÂØÜÁÆóÊ≥ï‰∏îÂÖ∂ÂØÜÂåôÊòØÁõ∏ÂêåÁöÑÔºå‰πãÂêé‰æøÊòØÂØπÊï∞ÊçÆËøõË°åÂä†Ëß£ÂØÜ‰∫Ü„ÄÇÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁî®Êù•ÂØπÊïèÊÑüÊï∞ÊçÆÁ≠â‰ø°ÊÅØËøõË°åÂä†ÂØÜ„ÄÇ ÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁöÑÂä†ÂØÜ‰∏éËß£ÂØÜÂØÜÈí•Áõ∏Âêå AESAESÔºàAdvanced Encryption StandardÔºâÔºöÈ´òÁ∫ßÂä†ÂØÜÊ†áÂáÜÔºåÊòØ‰∏ã‰∏Ä‰ª£ÁöÑÂä†ÂØÜÁÆóÊ≥ïÊ†áÂáÜÔºåÈÄüÂ∫¶Âø´ÔºåÂÆâÂÖ®Á∫ßÂà´È´òÔºõAESÊòØ‰∏Ä‰∏™‰ΩøÁî®128‰∏∫ÂàÜÁªÑÂùóÁöÑÂàÜÁªÑÂä†ÂØÜÁÆóÊ≥ïÔºåÂàÜÁªÑÂùóÂíå128„ÄÅ192Êàñ256‰ΩçÁöÑÂØÜÈí•‰∏ÄËµ∑‰Ωú‰∏∫ËæìÂÖ•ÔºåÂØπ4√ó4ÁöÑÂ≠óËäÇÊï∞ÁªÑ‰∏äËøõË°åÊìç‰Ωú„ÄÇ‰ºóÊâÄÂë®‰πãAESÊòØÁßçÂçÅÂàÜÈ´òÊïàÁöÑÁÆóÊ≥ïÔºåÂ∞§ÂÖ∂Âú®8‰ΩçÊû∂ÊûÑ‰∏≠ÔºåËøôÊ∫ê‰∫éÂÆÉÈù¢ÂêëÂ≠óËäÇÁöÑËÆæËÆ°„ÄÇAES ÈÄÇÁî®‰∫é8‰ΩçÁöÑÂ∞èÂûãÂçïÁâáÊú∫ÊàñËÄÖÊôÆÈÄöÁöÑ32‰ΩçÂæÆÂ§ÑÁêÜÂô®,Âπ∂‰∏îÈÄÇÂêàÁî®‰∏ìÈó®ÁöÑÁ°¨‰ª∂ÂÆûÁé∞ÔºåÁ°¨‰ª∂ÂÆûÁé∞ËÉΩÂ§ü‰ΩøÂÖ∂ÂêûÂêêÈáèÔºàÊØèÁßíÂèØ‰ª•Âà∞ËææÁöÑÂä†ÂØÜ/Ëß£ÂØÜbitÊï∞ÔºâËææÂà∞ÂçÅ‰∫øÈáèÁ∫ß„ÄÇÂêåÊ†∑ÔºåÂÖ∂‰πüÈÄÇÁî®‰∫éRFIDÁ≥ªÁªü„ÄÇ ÂØπÁß∞Âä†ÂØÜÔºåÂØÜÈí•ÊúÄÈïøÂè™Êúâ256‰∏™bitÔºåÊâßË°åÈÄüÂ∫¶Âø´ÔºåÊòì‰∫éÁ°¨‰ª∂ÂÆûÁé∞„ÄÇÁî±‰∫éÊòØÂØπÁß∞Âä†ÂØÜÔºåÂØÜÈí•ÈúÄË¶ÅÂú®‰º†ËæìÂâçÈÄöËÆØÂèåÊñπËé∑Áü•„ÄÇ Âü∫‰∫é‰ª•‰∏äÁâπÁÇπÔºåÈÄöÂ∏∏‰ΩøÁî®RSAÊù•È¶ñÂÖà‰º†ËæìAESÁöÑÂØÜÈí•ÁªôÂØπÊñπÔºåÁÑ∂ÂêéÂÜç‰ΩøÁî®AESÊù•ËøõË°åÂä†ÂØÜÈÄöËÆØ„ÄÇ DESDESÔºàData Encryption StandardÔºâÔºöÊï∞ÊçÆÂä†ÂØÜÊ†áÂáÜÔºåÈÄüÂ∫¶ËæÉÂø´ÔºåÈÄÇÁî®‰∫éÂä†ÂØÜÂ§ßÈáèÊï∞ÊçÆÁöÑÂú∫Âêà„ÄÇ 3DES3DESÔºàTriple DESÔºâÔºöÊòØÂü∫‰∫éDESÔºåÂØπ‰∏ÄÂùóÊï∞ÊçÆÁî®‰∏â‰∏™‰∏çÂêåÁöÑÂØÜÈí•ËøõË°å‰∏âÊ¨°Âä†ÂØÜÔºåÂº∫Â∫¶Êõ¥È´ò„ÄÇ Êï£ÂàóÁÆóÊ≥ïÊï£ÂàóÁÆóÊ≥ïÔºåÂèàÁß∞ÂìàÂ∏åÂáΩÊï∞ÔºåÊòØ‰∏ÄÁßçÂçïÂêëÂä†ÂØÜÁÆóÊ≥ï„ÄÇÂú®‰ø°ÊÅØÂÆâÂÖ®ÊäÄÊúØ‰∏≠ÔºåÁªèÂ∏∏ÈúÄË¶ÅÈ™åËØÅÊ∂àÊÅØÁöÑÂÆåÊï¥ÊÄßÔºåÊï£Âàó(Hash)ÂáΩÊï∞Êèê‰æõ‰∫ÜËøô‰∏ÄÊúçÂä°ÔºåÂÆÉÂØπ‰∏çÂêåÈïøÂ∫¶ÁöÑËæìÂÖ•Ê∂àÊÅØÔºå‰∫ßÁîüÂõ∫ÂÆöÈïøÂ∫¶ÁöÑËæìÂá∫„ÄÇËøô‰∏™Âõ∫ÂÆöÈïøÂ∫¶ÁöÑËæìÂá∫Áß∞‰∏∫ÂéüËæìÂÖ•Ê∂àÊÅØÁöÑ‚ÄùÊï£Âàó‚ÄùÊàñ‚ÄùÊ∂àÊÅØÊëòË¶Å‚Äù(Message digest)„ÄÇÊï£ÂàóÁÆóÊ≥ï‰∏çÁÆóÂä†ÂØÜÁÆóÊ≥ïÔºåÂõ†‰∏∫ÂÖ∂ÁªìÊûúÊòØ‰∏çÂèØÈÄÜÁöÑÔºåÊó¢ÁÑ∂ÊòØ‰∏çÂèØÈÄÜÁöÑÔºåÈÇ£‰πàÂΩìÁÑ∂‰∏çÊòØÁî®Êù•Âä†ÂØÜÁöÑÔºåËÄåÊòØÁ≠æÂêç„ÄÇ Êï£ÂàóÁÆóÊ≥ï‰∏ªË¶ÅÊúâSHA-1„ÄÅMD5Á≠â MD5ËæìÂá∫128bit„ÄÅSHA1ËæìÂá∫160bit„ÄÅSHA256ËæìÂá∫256bitSHA-1ÊòØ160‰ΩçÁöÑÂìàÂ∏åÂÄºÔºåËÄåSHA-2ÊòØÁªÑÂêàÂÄºÔºåÊúâ‰∏çÂêåÁöÑ‰ΩçÊï∞ÔºåÂÖ∂‰∏≠ÊúÄÂèóÊ¨¢ËøéÁöÑÊòØ256‰Ωç„ÄÇ Âõ†‰∏∫SHA-2ÊúâÂ§öÁßç‰∏çÂêåÁöÑ‰ΩçÊï∞ÔºåÂØºËá¥Ëøô‰∏™ÂêçËØçÊúâ‰∏Ä‰∫õÊ∑∑‰π±„ÄÇ‰ΩÜÊòØÊó†ËÆ∫ÊòØ‚ÄúSHA-2‚ÄùÔºå‚ÄúSHA-256‚ÄùÊàñ‚ÄúSHA-256‰Ωç‚ÄùÔºåÂÖ∂ÂÆûÈÉΩÊòØÊåáÂêå‰∏ÄÁßçÂä†ÂØÜÁÆóÊ≥ï„ÄÇ‰ΩÜÊòØSHA-224Ôºå‚ÄúSHA-384‚ÄùÊàñ‚ÄúSHA-512‚ÄùÔºåË°®Á§∫SHA-2ÁöÑ‰∫åËøõÂà∂ÈïøÂ∫¶„ÄÇËøòË¶ÅÂè¶‰∏ÄÁßçÂ∞±ÊòØ‰ºöÊääÁÆóÊ≥ïÂíå‰∫åËøõÂà∂ÈïøÂ∫¶ÈÉΩÂÜô‰∏äÔºåÂ¶Ç‚ÄúSHA-2 384‚Äù„ÄÇ SSLË°å‰∏öÈÄâÊã©SHA‰Ωú‰∏∫Êï∞Â≠óÁ≠æÂêçÁöÑÊï£ÂàóÁÆóÊ≥ïÔºå‰ªé2011Âà∞2015Ôºå‰∏ÄÁõ¥‰ª•SHA-1‰Ωç‰∏ªÂØºÁÆóÊ≥ï„ÄÇ‰ΩÜÈöèÁùÄ‰∫íËÅîÁΩëÊäÄÊúØÁöÑÊèêÂçáÔºåSHA-1ÁöÑÁº∫ÁÇπË∂äÊù•Ë∂äÁ™ÅÊòæ„ÄÇ‰ªéÂéªÂπ¥Ëµ∑ÔºåSHA-2Êàê‰∏∫‰∫ÜÊñ∞ÁöÑÊ†áÂáÜÔºåÊâÄ‰ª•Áé∞Âú®Á≠æÂèëÁöÑSSLËØÅ‰π¶ÔºåÂøÖÈ°ª‰ΩøÁî®ËØ•ÁÆóÊ≥ïÁ≠æÂêç„ÄÇ ‰πüËÆ∏Êúâ‰∫∫ÂÅ∂Â∞î‰ºöÁúãÂà∞SHA-2 384‰ΩçÁöÑËØÅ‰π¶ÔºåÂæàÂ∞ë‰ºöÁúãÂà∞224‰ΩçÔºåÂõ†‰∏∫224‰Ωç‰∏çÂÖÅËÆ∏Áî®‰∫éÂÖ¨ÂÖ±‰ø°‰ªªÁöÑËØÅ‰π¶Ôºå512‰ΩçÔºå‰∏çË¢´ËΩØ‰ª∂ÊîØÊåÅ„ÄÇÂàùÊ≠•È¢ÑËÆ°ÔºåSHA-2ÁöÑ‰ΩøÁî®Âπ¥Èôê‰∏∫‰∫îÂπ¥Ôºå‰ΩÜ‰πüËÆ∏‰ºöË¢´ÊèêÂâçÊ∑òÊ±∞„ÄÇËøôÈúÄË¶ÅÊó∂Èó¥Êù•È™åËØÅ„ÄÇ ‰ª•‰∏Ä‰∏™60MÁöÑÊñá‰ª∂‰∏∫ÊµãËØïÊ†∑Êú¨ÔºåÁªèËøá1000Ê¨°ÁöÑÊµãËØïÂπ≥ÂùáÂÄºÔºå‰∏âÁßçÁÆóÊ≥ïÁöÑË°®Áé∞‰∏∫Ôºö 123MD5ÁÆóÊ≥ïËøêË°å1000Ê¨°ÁöÑÂπ≥ÂùáÊó∂Èó¥‰∏∫Ôºö226msSHA1ÁÆóÊ≥ïËøêË°å1000Ê¨°ÁöÑÂπ≥ÂùáÊó∂Èó¥‰∏∫Ôºö308msSHA256ÁÆóÊ≥ïËøêË°å1000Ê¨°ÁöÑÂπ≥ÂùáÊó∂Èó¥‰∏∫Ôºö473ms123 ÂÆâÂÖ®ÊÄßÊñπÈù¢ÔºåÊòæÁÑ∂SHA256ÔºàÂèàÁß∞SHA2ÔºâÁöÑÂÆâÂÖ®ÊÄßÊúÄÈ´òÔºå‰ΩÜÊòØËÄóÊó∂Ë¶ÅÊØîÂÖ∂‰ªñ‰∏§ÁßçÂ§öÂæàÂ§ö„ÄÇMD5Áõ∏ÂØπËæÉÂÆπÊòìÁ†¥Ëß£ÔºåÂõ†Ê≠§ÔºåSHA1Â∫îËØ•ÊòØËøô‰∏âÁßç‰∏≠ÊÄßËÉΩÊúÄÂ•ΩÁöÑ‰∏ÄÊ¨æÂä†ÂØÜÁÆóÊ≥ï„ÄÇ]]></content>
      <categories>
        <category>ÂÆâÂÖ®</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî®Spring5ÁöÑWebfluxÂºÄÂèëReactiveÂ∫îÁî®ÔºàSSE „ÄÅWebsocket)]]></title>
    <url>%2F2019%2F02%2F26%2F%E4%BD%BF%E7%94%A8Spring5%E7%9A%84Webflux%E5%BC%80%E5%8F%91Reactive%E5%BA%94%E7%94%A8%EF%BC%88SSE-%E3%80%81Websocket%2F</url>
    <content type="text"><![CDATA[ÂØπ Java ÂºÄÂèëËÄÖÊù•ËØ¥Ôºå2017 Âπ¥ 9 ÊúàÊòØ‰∏™ÁÉ≠ÈóπÁöÑÊúà‰ªΩÔºåJava SE 9„ÄÅJava EE 8 Áõ∏ÁªßÂèëÂ∏ÉÔºåËÄå Spring ‰πüÂú®ËøôÊÆµÊó∂Èó¥ÔºåÂèëÂ∏É‰∫Ü 5.0 Ê≠£ÂºèÁâàÊú¨„ÄÇ Ë∫´‰∏∫ Java ÂºÄÂèëËÄÖÔºåÂØπ‰∫é Spring Ê°ÜÊû∂Âπ∂‰∏çÈôåÁîü„ÄÇSpring Âú® Rod Johnson ÂçÅÂá†Âπ¥Ââç‰∏Ä‰∏™‰∫∫ÂçïÊåë J2EE ‰ΩìÁ≥ªÂºÄÂßãÔºåÂà∞ÂçÅÂπ¥ÂâçÂºÄÂßãÂ§ßË°åÂÖ∂ÈÅìËá≥‰ªäÔºåÂü∫Êú¨‰∏äÂ∑≤ÊòØ Java ÂºÄÂèëÈ¢ÜÂüüÁöÑ‰∫ãÂÆûÊ†áÂáÜ‰∫Ü„ÄÇ Spring 5 ‰∏≠ÊúÄÈáçË¶ÅÊîπÂä®ÊòØÊääÂèçÂ∫îÂºèÁºñÁ®ãÁöÑÊÄùÊÉ≥Â∫îÁî®Âà∞‰∫ÜÊ°ÜÊû∂ÁöÑÂêÑ‰∏™ÊñπÈù¢ÔºåSpring 5 ÁöÑÂèçÂ∫îÂºèÁºñÁ®ã‰ª• Reactor Â∫ì‰∏∫Âü∫Á°Ä„ÄÇSpring 5 Ê°ÜÊû∂ÊâÄÂåÖÂê´ÁöÑÂÜÖÂÆπÂæàÂ§öÔºåËøôÈáåÂè™ÈáçÁÇπ‰ªãÁªçÂÖ∂‰∏≠Êñ∞Â¢ûÁöÑ WebFlux Ê®°Âùó„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® WebFlux ÂàõÂª∫È´òÊÄßËÉΩÁöÑ Web Â∫îÁî®ÂíåÂÆ¢Êà∑Á´Ø„ÄÇÊú¨ÊñáÂØπ WebFlux Ê®°ÂùóËøõË°å‰∫ÜËØ¶ÁªÜ‰ªãÁªçÔºåÂåÖÊã¨ÂÖ∂‰∏≠ÁöÑ HTTP„ÄÅÊúçÂä°Âô®Êé®ÈÄÅ‰∫ã‰ª∂ÔºàSSEÔºâÂíå WebSocket ÊîØÊåÅ„ÄÇ WebFlux ÁÆÄ‰ªãWebFlux Ê®°ÂùóÁöÑÂêçÁß∞ÊòØ spring-webfluxÔºåÂêçÁß∞‰∏≠ÁöÑ Flux Êù•Ê∫ê‰∫é Reactor ‰∏≠ÁöÑÁ±ª Flux„ÄÇËØ•Ê®°Âùó‰∏≠ÂåÖÂê´‰∫ÜÂØπÂèçÂ∫îÂºè HTTP„ÄÅÊúçÂä°Âô®Êé®ÈÄÅ‰∫ã‰ª∂Âíå WebSocket ÁöÑÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Âô®Á´ØÁöÑÊîØÊåÅ„ÄÇÂØπ‰∫éÂºÄÂèë‰∫∫ÂëòÊù•ËØ¥ÔºåÊØîËæÉÈáçË¶ÅÁöÑÊòØÊúçÂä°Âô®Á´ØÁöÑÂºÄÂèëÔºåËøô‰πüÊòØÊú¨ÊñáÁöÑÈáçÁÇπ„ÄÇÂú®ÊúçÂä°Âô®Á´ØÔºåWebFlux ÊîØÊåÅ‰∏§Áßç‰∏çÂêåÁöÑÁºñÁ®ãÊ®°ÂûãÔºöÁ¨¨‰∏ÄÁßçÊòØ Spring MVC ‰∏≠‰ΩøÁî®ÁöÑÂü∫‰∫é Java Ê≥®Ëß£ÁöÑÊñπÂºèÔºõÁ¨¨‰∫åÁßçÊòØÂü∫‰∫é Java 8 ÁöÑ Lambda Ë°®ËææÂºèÁöÑÂáΩÊï∞ÂºèÁºñÁ®ãÊ®°Âûã„ÄÇËøô‰∏§ÁßçÁºñÁ®ãÊ®°ÂûãÂè™ÊòØÂú®‰ª£Á†ÅÁºñÂÜôÊñπÂºè‰∏äÂ≠òÂú®‰∏çÂêå„ÄÇÂÆÉ‰ª¨ËøêË°åÂú®ÂêåÊ†∑ÁöÑÂèçÂ∫îÂºèÂ∫ïÂ±ÇÊû∂ÊûÑ‰πã‰∏äÔºåÂõ†Ê≠§Âú®ËøêË°åÊó∂ÊòØÁõ∏ÂêåÁöÑ„ÄÇWebFlux ÈúÄË¶ÅÂ∫ïÂ±ÇÊèê‰æõËøêË°åÊó∂ÁöÑÊîØÊåÅÔºåWebFlux ÂèØ‰ª•ËøêË°åÂú®ÊîØÊåÅ Servlet 3.1 ÈùûÈòªÂ°û IO API ÁöÑ Servlet ÂÆπÂô®‰∏äÔºåÊàñÊòØÂÖ∂‰ªñÂºÇÊ≠•ËøêË°åÊó∂ÁéØÂ¢ÉÔºåÂ¶Ç Netty Âíå Undertow„ÄÇ Spring Boot 2 ÊòØÂü∫‰∫é Spring 5 ÁöÑÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÊØîËæÉÂ§ßÁöÑÊõ¥Êñ∞Â∞±Âú®‰∫éÊîØÊåÅÂåÖÊã¨ spring-webflux ÂíåÂìçÂ∫îÂºèÁöÑ spring-data Âú®ÂÜÖÁöÑÂìçÂ∫îÂºèÊ®°ÂùóÔºå‰∏ãËæπÁöÑ‰æãÂ≠êÊàë‰ª¨Â∞±Áî® Spring Boot 2 Âú®ËøõË°åÊê≠Âª∫„ÄÇ Êú¨Êñá‰ªé‰∏â‰∏™ÊñπÈù¢ÂØπ WebFlux ËøõË°å‰ªãÁªç„ÄÇÈ¶ñÂÖàÊòØ‰ΩøÁî®ÁªèÂÖ∏ÁöÑÂü∫‰∫é Java Ê≥®Ëß£ÁöÑÁºñÁ®ãÊ®°ÂûãÊù•ËøõË°åÂºÄÂèëÔºåÂÖ∂Ê¨°ÊòØ‰ΩøÁî® WebFlux Êñ∞Â¢ûÁöÑÂáΩÊï∞ÂºèÁºñÁ®ãÊ®°ÂûãÊù•ËøõË°åÂºÄÂèëÔºåÊúÄÂêé‰ªãÁªç WebFlux Â∫îÁî®ÁöÑÊµãËØï„ÄÇÈÄöËøáËøôÊ†∑Âæ™Â∫èÊ∏êËøõÁöÑÊñπÂºèËÆ©ËØªËÄÖ‰∫ÜËß£ WebFlux Â∫îÁî®ÂºÄÂèëÁöÑÁªÜËäÇ„ÄÇ Java Ê≥®Ëß£ÁºñÁ®ãÊ®°ÂûãÂü∫‰∫é Java Ê≥®Ëß£ÁöÑÁºñÁ®ãÊ®°ÂûãÔºåÂØπ‰∫é‰ΩøÁî®Ëøá Spring MVC ÁöÑ‰∫∫Êù•ËØ¥ÊòØÂÜçÁÜüÊÇâ‰∏çËøáÁöÑ„ÄÇÂú® WebFlux Â∫îÁî®‰∏≠‰ΩøÁî®ÂêåÊ†∑ÁöÑÊ®°ÂºèÔºåÂÆπÊòìÁêÜËß£Âíå‰∏äÊâã„ÄÇÊàë‰ª¨ÂÖà‰ªéÊúÄÁªèÂÖ∏ÁöÑ Hello World ÂºÄÂßãËØ¥Êòé„ÄÇ Êàë‰ª¨ÈÄöËøá Spring Initializ ÂàõÂª∫‰∏Ä‰∏™ Spring Boot Â∑•Á®ãÔºåÂõ†‰∏∫ÁõÆÂâçÊàë‰ª¨Ëøò‰∏çÊ∂âÂèä DAO Â±ÇÔºåÊâÄ‰ª•Âè™ÈÄâÊã© Reactive Web Â∞±Ë°å‰∫Ü ‰πüÂèØ‰ª•‰ΩøÁî®ÁΩëÈ°µÁâàÁöÑ https://start.spring.io Êù•ÂàõÂª∫È°πÁõÆÔºö ÂàõÂª∫ÂêéÁöÑÈ°πÁõÆ POM ‰∏≠ÔºåÂåÖÂê´‰∏ãËæπÁöÑ‰æùËµñÔºåÂç≥Ë°®Á§∫Âü∫‰∫é Spring WebFluxÔºö 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;&lt;/dependency&gt; ÂàõÂª∫ Controller Á±ªHelloControllerÔºå‰ªÖÊèê‰æõ‰∏Ä‰∏™ Endpoint/helloÔºö 123456789@RestControllerpublic class HelloController &#123; @GetMapping("/hello") public Mono&lt;String&gt; sayHello()&#123; return Mono.just("Hello World!"); &#125;&#125; Êàë‰ª¨ÂêØÂä®Â∫îÁî®ÔºåÈÄöËøáËÆøÈóÆ http://localhost:8080/hello ÂèØ‰ª•ÂæóÂà∞ËøîÂõûÂÄºHello World!„ÄÇ ÈÄöËøáËøô‰∏™ÁÆÄÂçïÁöÑ Hello World Á§∫‰æãÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ΩøÁî® WebFlux ‰∏é Spring MVC ÁöÑ‰∏çÂêåÂú®‰∫éÔºåWebFlux ÊâÄ‰ΩøÁî®ÁöÑÁ±ªÂûãÊòØ‰∏éÂèçÂ∫îÂºèÁºñÁ®ãÁõ∏ÂÖ≥ÁöÑ Flux Âíå Mono Á≠âÔºåËÄå‰∏çÊòØÁÆÄÂçïÁöÑÂØπË±°„ÄÇÂØπ‰∫éÁÆÄÂçïÁöÑ Hello World Á§∫‰æãÊù•ËØ¥ÔºåËøô‰∏§ËÄÖ‰πãÈó¥Âπ∂Ê≤°Êúâ‰ªÄ‰πàÂ§™Â§ßÁöÑÂ∑ÆÂà´„ÄÇÂØπ‰∫éÂ§çÊùÇÁöÑÂ∫îÁî®Êù•ËØ¥ÔºåÂèçÂ∫îÂºèÁºñÁ®ãÂíåË¥üÂéãÁöÑ‰ºòÂäø‰ºö‰ΩìÁé∞Âá∫Êù•ÔºåÂèØ‰ª•Â∏¶Êù•Êï¥‰ΩìÁöÑÊÄßËÉΩÁöÑÊèêÂçá„ÄÇ RESTful APIÁÆÄÂçïÁöÑ Hello World Á§∫‰æãÂπ∂‰∏çË∂≥‰ª•ËØ¥Êòé WebFlux ÁöÑÁî®Ê≥ï„ÄÇÂú®‰∏ãÈù¢ÁöÑÂ∞èËäÇ‰∏≠ÔºåÊú¨ÊñáÂ∞Ü‰ªãÁªçÂÖ∂‰ªñÂÖ∑‰ΩìÁöÑÂÆû‰æã„ÄÇÂÖà‰ªé RESTful API ÂºÄÂßãËØ¥Ëµ∑„ÄÇRESTful API Âú® Web ÊúçÂä°Âô®Á´ØÂ∫îÁî®‰∏≠Âç†ÊçÆ‰∫ÜÂæàÂ§ßÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÊàë‰ª¨ÈÄöËøá‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÂÆû‰æãÊù•ËØ¥ÊòéÂ¶Ç‰Ωï‰ΩøÁî® WebFlux Êù•ÂºÄÂèë RESTful APIÔºåËØ• RESTful API Áî®Êù•ÂØπÁî®Êà∑Êï∞ÊçÆËøõË°åÂü∫Êú¨ÁöÑ CRUD Êìç‰Ωú„ÄÇ ‰Ωú‰∏∫È¢ÜÂüüÂØπË±°ÁöÑUserÁ±ª‰∏≠ÂåÖÂê´‰∫Üid„ÄÅnameÂíåemail‰∏â‰∏™Âü∫Êú¨ÁöÑÂ±ûÊÄß„ÄÇ 123456789101112@Data // ÁîüÊàêÊó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ï getter setter hashCode equals toString@AllArgsConstructor // ÁîüÊàêÊâÄÊúâÂèÇÊï∞ÊûÑÈÄ†ÊñπÊ≥ï@NoArgsConstructor // @AllArgsConstructor ‰ºöÂØºËá¥ @Data ‰∏çÁîüÊàêÊó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ïÔºåÈúÄË¶ÅÊâãÂä®Ê∑ªÂä† @NoArgsConstructorÔºåÂ¶ÇÊûúÊ≤°ÊúâÊó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ïÔºåÂèØËÉΩ‰ºöÂØºËá¥ÊØîÂ¶Ç com.fasterxml.jackson Âú®Â∫èÂàóÂåñÂ§ÑÁêÜÊó∂Êä•Èîôpublic class User &#123; private Integer id; private String name; private String email;&#125; ‰∏∫‰∫ÜÂØπUserÁ±ªËøõË°åÊìç‰ΩúÔºåÊàë‰ª¨ÈúÄË¶ÅÊèê‰æõÊúçÂä°Á±ªUserService„ÄÇUserService‰ΩøÁî®‰∏Ä‰∏™ Map Êù•‰øùÂ≠òÊâÄÊúâÁî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÂπ∂‰∏çÊòØ‰∏Ä‰∏™ÊåÅ‰πÖÂåñÁöÑÂÆûÁé∞ÔºåËøôÂØπ‰∫éÁ§∫‰æãÂ∫îÁî®Êù•ËØ¥Â∑≤ÁªèË∂≥Â§ü‰∫Ü„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839@Servicepublic class UserService &#123; private final Map&lt;Integer, User&gt; data = new ConcurrentHashMap&lt;&gt;(); @PostConstruct private void init() &#123; data.put(1, new User(1, "Âº†‰∏â", "z3@qq.com")); data.put(2, new User(2, "ÊùéÂõõ", "l4@qq.com")); data.put(3, new User(3, "Áéã‰∫î", "w5@qq.com")); &#125; public Flux&lt;User&gt; list() &#123; return Flux.fromIterable(this.data.values()); &#125; public Flux&lt;User&gt; getByIds(Flux&lt;Integer&gt; ids) &#123; return ids.flatMap(id -&gt; Mono.justOrEmpty(this.data.get(id))); &#125; public Mono&lt;User&gt; getById(Integer id) &#123; return Mono.justOrEmpty(this.data.get(id)) .switchIfEmpty(Mono.error(new ResourceNotFoundException())); &#125; public Flux&lt;User&gt; createOrUpdate(Flux&lt;User&gt; users) &#123; return users.doOnNext(user -&gt; this.data.put(user.getId(), user)); &#125; public Mono&lt;User&gt; createOrUpdate(User user) &#123; this.data.put(user.getId(), user); return Mono.just(user); &#125; public Mono&lt;User&gt; delete(Integer id) &#123; return Mono.justOrEmpty(this.data.remove(id)); &#125;&#125; UserControllerÊòØÂÖ∑‰ΩìÁöÑ Spring MVC ÊéßÂà∂Âô®Á±ªÔºåÂÆÉ‰ΩøÁî®UserServiceÊù•ÂÆåÊàêÂÖ∑‰ΩìÁöÑÂäüËÉΩ„ÄÇUserController‰∏≠‰ΩøÁî®‰∫ÜÊ≥®Ëß£@ExceptionHandlerÊù•Ê∑ªÂä†‰∫ÜResourceNotFoundExceptionÂºÇÂ∏∏ÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºåÂπ∂ËøîÂõû 404 ÈîôËØØ„ÄÇUserController‰∏≠ÁöÑÊñπÊ≥ïÈÉΩÂæàÁÆÄÂçïÔºåÂè™ÊòØÁÆÄÂçïÂú∞‰ª£ÁêÜÁªôUserService‰∏≠ÁöÑÂØπÂ∫îÊñπÊ≥ï„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839@RestController@RequestMapping("/user")public class UserController &#123; @Autowired private UserService userService; @ExceptionHandler(ResourceNotFoundException.class) @ResponseStatus(code = HttpStatus.NOT_FOUND, reason = "User not found") public void notFound()&#123;&#125; @GetMapping("") public Flux&lt;User&gt; list() &#123; return userService.list(); &#125; @GetMapping("/&#123;id&#125;") public Mono&lt;User&gt; getById(@PathVariable Integer id)&#123; return userService.getById(id); &#125; @PostMapping("") public Flux&lt;User&gt; create(@RequestBody Flux&lt;User&gt; users)&#123; return userService.createOrUpdate(users); &#125; @PutMapping("/&#123;id&#125;") public Mono&lt;User&gt; update(@PathVariable Integer id, @RequestBody User user)&#123; Objects.requireNonNull(user); user.setId(id); return userService.createOrUpdate(user); &#125; @DeleteMapping("/&#123;id&#125;") public Mono&lt;User&gt; delete(@PathVariable Integer id)&#123; return userService.delete(id); &#125;&#125; Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáËÆøÈóÆ http://127.0.0.1:8080/user Ëé∑ÂèñÂà∞Áî®Êà∑‰ø°ÊÅØÔºåÂÖ∂‰ªñÁöÑ CRUD Êìç‰ΩúÂèØ‰ª•Ëá™Ë°åÊµãËØï 1234567891011121314151617[ &#123; "id": 1, "name": "Âº†‰∏â", "email": "z3@qq.com" &#125;, &#123; "id": 2, "name": "ÊùéÂõõ", "email": "l4@qq.com" &#125;, &#123; "id": 3, "name": "Áéã‰∫î", "email": "w5@qq.com" &#125;] ÊúçÂä°Âô®Êé®ÈÄÅ‰∫ã‰ª∂ÔºàSSEÔºâÊúçÂä°Âô®Êé®ÈÄÅ‰∫ã‰ª∂ÔºàServer-Sent EventsÔºåSSEÔºâÂÖÅËÆ∏ÊúçÂä°Âô®Á´Ø‰∏çÊñ≠Âú∞Êé®ÈÄÅÊï∞ÊçÆÂà∞ÂÆ¢Êà∑Á´Ø„ÄÇÁõ∏ÂØπ‰∫é WebSocket ËÄåË®ÄÔºåÊúçÂä°Âô®Êé®ÈÄÅ‰∫ã‰ª∂Âè™ÊîØÊåÅÊúçÂä°Âô®Á´ØÂà∞ÂÆ¢Êà∑Á´ØÁöÑÂçïÂêëÊï∞ÊçÆ‰º†ÈÄí„ÄÇËôΩÁÑ∂ÂäüËÉΩËæÉÂº±Ôºå‰ΩÜ‰ºòÂäøÂú®‰∫é SSE Âú®Â∑≤ÊúâÁöÑ HTTP ÂçèËÆÆ‰∏ä‰ΩøÁî®ÁÆÄÂçïÊòìÊáÇÁöÑÊñáÊú¨Ê†ºÂºèÊù•Ë°®Á§∫‰º†ËæìÁöÑÊï∞ÊçÆ„ÄÇ‰Ωú‰∏∫ W3C ÁöÑÊé®ËçêËßÑËåÉÔºåSSE Âú®ÊµèËßàÂô®Á´ØÁöÑÊîØÊåÅ‰πüÊØîËæÉÂπøÊ≥õÔºåÈô§‰∫Ü IE ‰πãÂ§ñÁöÑÂÖ∂‰ªñÊµèËßàÂô®ÈÉΩÊèê‰æõ‰∫ÜÊîØÊåÅ„ÄÇÂú® IE ‰∏ä‰πüÂèØ‰ª•‰ΩøÁî® polyfill Â∫ìÊù•Êèê‰æõÊîØÊåÅ„ÄÇÂú®ÊúçÂä°Âô®Á´ØÊù•ËØ¥ÔºåSSE ÊòØ‰∏Ä‰∏™‰∏çÊñ≠‰∫ßÁîüÊñ∞Êï∞ÊçÆÁöÑÊµÅÔºåÈùûÂ∏∏ÈÄÇÂêà‰∫éÁî®ÂèçÂ∫îÂºèÊµÅÊù•Ë°®Á§∫„ÄÇÂú® WebFlux ‰∏≠ÂàõÂª∫ SSE ÁöÑÊúçÂä°Âô®Á´ØÊòØÈùûÂ∏∏ÁÆÄÂçïÁöÑ„ÄÇÂè™ÈúÄË¶ÅËøîÂõûÁöÑÂØπË±°ÁöÑÁ±ªÂûãÊòØ FluxÔºåÂ∞±‰ºöË¢´Ëá™Âä®ÊåâÁÖß SSE ËßÑËåÉË¶ÅÊ±ÇÁöÑÊ†ºÂºèÊù•ÂèëÈÄÅÂìçÂ∫î„ÄÇ ‰∏ãÈù¢ÁöÑSseControllerÊòØ‰∏Ä‰∏™‰ΩøÁî® SSE ÁöÑÊéßÂà∂Âô®ÁöÑÁ§∫‰æã„ÄÇ 123456789101112131415161718@RestController@RequestMapping("/sse")public class SseController &#123; @GetMapping("/random") public Flux&lt;ServerSentEvent&lt;Integer&gt;&gt; random() &#123; return Flux.interval(Duration.ofSeconds(1)) // 1 .map(seq -&gt; &#123; return ServerSentEvent.&lt;Integer&gt;builder() // 2 .event("random") .id(seq.toString()) .data(ThreadLocalRandom.current().nextInt()) .build(); &#125; ); &#125;&#125; ÊØè 1 ÁßíÂèëÂá∫‰∏Ä‰∏™Ëá™Â¢ûÁöÑ Long ÂÄº ‰ΩøÁî®ServerSentEvent.BuilderÊù•ÂàõÂª∫ServerSentEventÂØπË±° Âú®ÊµãËØï SSE Êó∂ÔºåÊàë‰ª¨Âè™ÈúÄË¶Å‰ΩøÁî® curl Êù•ËÆøÈóÆÂç≥ÂèØ„ÄÇ 123456789101112$ curl http://localhost:8080/sse/randomid:0event:randomdata:-244762412id:1event:randomdata:-1757349679id:2event:randomdata:496598301 WebSocketWebSocket ÊîØÊåÅÂÆ¢Êà∑Á´Ø‰∏éÊúçÂä°Âô®Á´ØÁöÑÂèåÂêëÈÄöËÆØ„ÄÇÂΩìÂÆ¢Êà∑Á´Ø‰∏éÊúçÂä°Âô®Á´Ø‰πãÈó¥ÁöÑ‰∫§‰∫íÊñπÂºèÊØîËæÉÂ§çÊùÇÊó∂ÔºåÂèØ‰ª•‰ΩøÁî® WebSocket„ÄÇWebSocket Âú®‰∏ªÊµÅÁöÑÊµèËßàÂô®‰∏äÈÉΩÂæóÂà∞‰∫ÜÊîØÊåÅ„ÄÇWebFlux ‰πüÂØπÂàõÂª∫ WebSocket ÊúçÂä°Âô®Á´ØÊèê‰æõ‰∫ÜÊîØÊåÅ„ÄÇÂú®ÊúçÂä°Âô®Á´ØÔºåÊàë‰ª¨ÈúÄË¶ÅÂÆûÁé∞Êé•Âè£org.springframework.web.reactive.socket.WebSocketHandlerÊù•Â§ÑÁêÜ WebSocket ÈÄöËÆØÔºåÂÖ∂handleÊñπÊ≥ïÁöÑÂèÇÊï∞ÊòØWebSocketSessionÂØπË±°ÔºåÂèØ‰ª•Áî®Êù•Ëé∑ÂèñÂÆ¢Êà∑Á´Ø‰ø°ÊÅØ„ÄÅÊé•ÈÄÅÊ∂àÊÅØÂíåÂèëÈÄÅÊ∂àÊÅØ„ÄÇ ‰∏ãÈù¢ÁöÑEchoHandlerÂØπ‰∫éÊØè‰∏™Êé•Êî∂Âà∞ÁöÑÊ∂àÊÅØÔºåÈÉΩ‰ºöÂú®ÂÖ∂ÂâçËæπÊ∑ªÂä†‰∏Ä‰∏™ÂâçÁºÄEcho -&gt;ÂÜçÂèëÈÄÅÂá∫Âéª„ÄÇWebSocketSessionÁöÑreceive()ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÊòØ‰∏Ä‰∏™Flux&lt;WebSocketMessage&gt;ÂØπË±°ÔºåË°®Á§∫ÁöÑÊòØÊé•Êî∂Âà∞ÁöÑÊ∂àÊÅØÊµÅÔºåËÄåsend()ÊñπÊ≥ïÁöÑÂèÇÊï∞ÊòØ‰∏Ä‰∏™Publisher&lt;WebSocketMessage&gt;ÂØπË±°ÔºåË°®Á§∫Ë¶ÅÂèëÈÄÅÁöÑÊ∂àÊÅØÊµÅ„ÄÇ 12345678910@Componentpublic class EchoHandler implements WebSocketHandler &#123; @Override public Mono&lt;Void&gt; handle(WebSocketSession session) &#123; return session.send( session.receive() .map(msg -&gt; session.textMessage("Echo -&gt; " + msg.getPayloadAsText()))); &#125;&#125; ‰ªÖÂàõÂª∫‰∏Ä‰∏™WebSocketHandlerÊòØ‰∏çÂ§üÁöÑÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÊääÂÆÉÊ≥®ÂÜåÂà∞ WebFlux ‰∏≠„ÄÇÊàë‰ª¨ÂÜçÊù•ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™WebSocketHandlerAdapterÂØπË±°ÔºåËØ•ÂØπË±°Ë¥üË¥£Êää WebSocketHandler ÂÖ≥ËÅîÂà∞ WebFlux ‰∏≠„ÄÇÂÖ∂‰∏≠Êàë‰ª¨‰ΩøÁî®HandlerMappingÊääEchoHandlerÊò†Â∞ÑÂà∞/echoÁ´ØÁÇπ„ÄÇ 123456789101112131415161718192021@Configurationpublic class WebSocketConfiguration &#123; @Autowired @Bean public HandlerMapping webSocketMapping(EchoHandler echoHandler)&#123; Map&lt;String, WebSocketHandler&gt; map = new HashMap&lt;&gt;(1); map.put("/echo", echoHandler); SimpleUrlHandlerMapping mapping = new SimpleUrlHandlerMapping(); mapping.setOrder(Ordered.HIGHEST_PRECEDENCE); mapping.setUrlMap(map); return mapping; &#125; @Bean public WebSocketHandlerAdapter webSocketHandlerAdapter()&#123; return new WebSocketHandlerAdapter(); &#125;&#125; ËøêË°åÂ∫îÁî®‰πãÂêéÔºåÂèØ‰ª•‰ΩøÁî®Â∑•ÂÖ∑Êù•ÊµãËØïËØ• WebSocket ÊúçÂä°„ÄÇÊâìÂºÄÂ∑•ÂÖ∑È°µÈù¢ÔºåÁÑ∂ÂêéËøûÊé•Âà∞ws://localhost:8080/echoÂèØ‰ª•ÂèëÈÄÅÊ∂àÊÅØÂπ∂Êü•ÁúãÊúçÂä°Âô®Á´ØËøîÂõûÁöÑÁªìÊûú„ÄÇ ÂáΩÊï∞ÂºèÁºñÁ®ãÊ®°ÂûãÂâçÈù¢‰ªãÁªç‰∫ÜÂü∫‰∫é Java Ê≥®Ëß£ÁöÑÁºñÁ®ãÊ®°ÂûãÔºåWebFlux ËøòÊîØÊåÅÂü∫‰∫é Lambda Ë°®ËææÂºèÁöÑÂáΩÊï∞ÂºèÁºñÁ®ãÊ®°Âûã„ÄÇ‰∏éÂü∫‰∫é Java Ê≥®Ëß£ÁöÑÁºñÁ®ãÊ®°ÂûãÁõ∏ÊØîÔºåÂáΩÊï∞ÂºèÁºñÁ®ãÊ®°ÂûãÁöÑÊäΩË±°Â±ÇÊ¨°Êõ¥‰ΩéÔºå‰ª£Á†ÅÁºñÂÜôÊõ¥ÁÅµÊ¥ªÔºåÂèØ‰ª•Êª°Ë∂≥‰∏Ä‰∫õÂØπÂä®ÊÄÅÊÄßË¶ÅÊ±ÇÊõ¥È´òÁöÑÂú∫ÊôØ„ÄÇ‰∏çËøáÂú®ÁºñÂÜôÊó∂ÁöÑ‰ª£Á†ÅÂ§çÊùÇÂ∫¶‰πüËæÉÈ´òÔºåÂ≠¶‰π†Êõ≤Á∫ø‰πüËæÉÈô°„ÄÇ ÁõÆÂâç Spring Boot Â∑≤ÊîØÊåÅÂú®‰∏Ä‰∏™Â∫îÁî®‰∏≠ÂêåÊó∂‰ΩøÁî®‰∏§Áßç‰∏çÂêåÁöÑÁºñÁ®ãÊ®°ÂºèÔºåÊàë‰ª¨ÂèØ‰ª•Ê†πÊçÆÂÆûÈôÖÁöÑÈúÄË¶ÅÊù•ÈÄâÊã©ÂêàÈÄÇÁöÑÁºñÁ®ãÊ®°Âûã„ÄÇ Âú®ÂáΩÊï∞ÂºèÁºñÁ®ãÊ®°Âûã‰∏≠ÔºåÊØè‰∏™ËØ∑Ê±ÇÊòØÁî±‰∏Ä‰∏™ÂáΩÊï∞Êù•Â§ÑÁêÜÁöÑÔºå ÈÄöËøáÊé•Âè£org.springframework.web.reactive.function.server.HandlerFunctionÊù•Ë°®Á§∫„ÄÇHandlerFunctionÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÂºèÊé•Âè£ÔºåÂÖ∂‰∏≠Âè™Êúâ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂõ†Ê≠§ÂèØ‰ª•Áî® Labmda Ë°®ËææÂºèÊù•ÂÆûÁé∞ËØ•Êé•Âè£Ôºö 1Mono&lt;T extends ServerResponse&gt; handle(ServerRequest request); ÁÑ∂ÂêéÈÄöËøáÂáΩÊï∞ÂºèÊé•Âè£org.springframework.web.reactive.function.server.RouterFunctionÊù•‰∏∫Ëøô‰∫õHandlerFunctionÊèê‰æõË∑ØÁî±‰ø°ÊÅØÔºåËæìÂÖ•‰∏∫ËØ∑Ê±ÇÔºåËæìÂá∫‰∏∫Ë£ÖÂú® Mono ÈáåËæπÁöÑHandlerfunction 1Mono&lt;HandlerFunction&lt;T&gt;&gt; route(ServerRequest request); Êàë‰ª¨ÁúãÂà∞ÔºåÂú® WebFlux ‰∏≠ÔºåËØ∑Ê±ÇÂíåÂìçÂ∫î‰∏çÂÜçÊòØ WebMVC ‰∏≠ÁöÑServletRequestÂíåServletResponseÔºåËÄåÊòØServerRequestÂíåServerResponse„ÄÇÂêéËÄÖÊòØÂú®ÂìçÂ∫îÂºèÁºñÁ®ã‰∏≠‰ΩøÁî®ÁöÑÊé•Âè£ÔºåÂÆÉ‰ª¨Êèê‰æõ‰∫ÜÂØπÈùûÈòªÂ°ûÂíåÂõûÂéãÁâπÊÄßÁöÑÊîØÊåÅÔºå‰ª•Âèä HTTP Ê∂àÊÅØ‰Ωì‰∏éÂìçÂ∫îÂºèÁ±ªÂûã Mono Âíå Flux ÁöÑËΩ¨Êç¢ÊñπÊ≥ï„ÄÇ ‰∏ãÈù¢Êàë‰ª¨Áî®ÂáΩÊï∞ÂºèÁöÑÊñπÂºèÂºÄÂèë‰∏Ä‰∏™ÁÆÄÂçïÁöÑËÆ°ÁÆóÂô®ÔºåÊúâadd„ÄÅsubtract„ÄÅmultiplyÂíådivideÂõõ‰∏™ÊñπÊ≥ïÔºåÈÉΩÊòØÊé•Âè£HandlerFunctionÁöÑÂÆûÁé∞ÔºåÂàÜÂà´ÂØπÂ∫îÂä†„ÄÅÂáè„ÄÅ‰πò„ÄÅÈô§ÂõõÁßçËøêÁÆó„ÄÇ ÂØπ‰∫éËøô‰∏™ÈúÄÊ±ÇÔºåHandlerFunction ÂæàÂÆπÊòìÂÜôÔºö 12345678910HandlerFunction&lt;ServerResponse&gt; add = request -&gt; ServerResponse.ok() .body(Mono.just(parseOperand(request, "v1") + parseOperand(request, "v2")), Integer.class);private int parseOperand(final ServerRequest request, final String param) &#123; try &#123; return Integer.parseInt(request.queryParam(param).orElse("0")); &#125; catch (final NumberFormatException e) &#123; return 0; &#125;&#125; ÈÇ£‰πà RouterFunction ‰∏∫Ôºö 1234@Beanpublic RouterFunction&lt;ServerResponse&gt; routerFunction() &#123; return RouterFunctions.route(RequestPredicates.GET("/add"), add);&#125; ÂêØÂä®ÊúçÂä°ÔºåËÆøÈóÆ http://localhost:8080/add?v1=2&amp;v2=3 Âç≥ËÆ°ÁÆó 2+3 ÂæóÂà∞ËøîÂõûÂÄº5„ÄÇ ‰∏çËøáËøô‰πàÂÜôÂú®‰∏öÂä°ÈÄªËæëÂ§çÊùÇÁöÑÊó∂ÂÄô‰∏çÂ§™Â•ΩÁªÑÁªáÔºåÊàë‰ª¨ÈÄöÂ∏∏ÈááÁî®Ë∑ü MVC Á±ª‰ººÁöÑ‰ª£Á†ÅÁªÑÁªáÊñπÂºèÔºåÂ∞ÜÂêåÁ±ª‰∏öÂä°ÁöÑ HandlerFunction ÊîæÂú®‰∏Ä‰∏™Á±ª‰∏≠ÔºåÁÑ∂ÂêéÂú® Java Config ‰∏≠Â∞Ü RouterFunction ÈÖçÁΩÆ‰∏∫ Spring ÂÆπÂô®ÁöÑ Bean„ÄÇÊàë‰ª¨ÁªßÁª≠Âú®Ëøô‰∏™ËÆ°ÁÆóÂô®ÁöÑ‰ª£Á†Å‰∏äÂºÄÂèëÔºö 12345678910111213141516171819202122232425262728293031323334353637383940@Componentpublic class CalculatorHandler &#123; public Mono&lt;ServerResponse&gt; add(final ServerRequest request) &#123; return calculate(request, (v1, v2) -&gt; v1 + v2); &#125; public Mono&lt;ServerResponse&gt; subtract(final ServerRequest request) &#123; return calculate(request, (v1, v2) -&gt; v1 - v2); &#125; public Mono&lt;ServerResponse&gt; multiply(final ServerRequest request) &#123; return calculate(request, (v1, v2) -&gt; v1 * v2); &#125; public Mono&lt;ServerResponse&gt; divide(final ServerRequest request) &#123; return calculate(request, (v1, v2) -&gt; v1 / v2); &#125; private Mono&lt;ServerResponse&gt; calculate(final ServerRequest request, final BiFunction&lt;Integer, Integer, Integer&gt; calculateFunc) &#123; final Tuple2&lt;Integer, Integer&gt; operands = extractOperands(request); return ServerResponse .ok() .body(Mono.just(calculateFunc.apply(operands.getT1(), operands.getT2())), Integer.class); &#125; private Tuple2&lt;Integer, Integer&gt; extractOperands(final ServerRequest request) &#123; return Tuples.of(parseOperand(request, "v1"), parseOperand(request, "v2")); &#125; private int parseOperand(final ServerRequest request, final String param) &#123; try &#123; return Integer.parseInt(request.queryParam(param).orElse("0")); &#125; catch (final NumberFormatException e) &#123; return 0; &#125; &#125;&#125; Êàë‰ª¨ÈááÁî® Spring Áé∞Âú®ÊØîËæÉÊé®ËçêÁöÑ Java Config ÁöÑÈÖçÁΩÆ Bean ÁöÑÊñπÂºèÔºåÂàõÂª∫Áî®‰∫éÂ≠òÊîæ Router ÁöÑÈÖçÁΩÆÁ±ªRouterConfig.javaÔºö 123456789101112131415@Configurationpublic class RouterConfig &#123; @Bean @Autowired public RouterFunction&lt;ServerResponse&gt; routerFunction(final CalculatorHandler calculatorHandler) &#123; return RouterFunctions.route(RequestPredicates.path("/calculator"), request -&gt; request.queryParam("operator").map(operator -&gt; Mono.justOrEmpty(ReflectionUtils.findMethod(CalculatorHandler.class, operator, ServerRequest.class)) .flatMap(method -&gt; (Mono&lt;ServerResponse&gt;) ReflectionUtils.invokeMethod(method, calculatorHandler, request)) .switchIfEmpty(ServerResponse.badRequest().build()) .onErrorResume(ex -&gt; ServerResponse.status(HttpStatus.INTERNAL_SERVER_ERROR).build())) .orElse(ServerResponse.badRequest().build())); &#125;&#125; Âú®‰∏äËæπÁöÑ‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨È¶ñÂÖàÁî®RouterFunctions.routeÊù•Ê†πÊçÆPredicateÊòØÂê¶ÂåπÈÖçÊù•Á°ÆÂÆöHandlerFunctionÊòØÂê¶Ë¢´Â∫îÁî®„ÄÇRequestPredicates‰∏≠ÂåÖÂê´‰∫ÜÂæàÂ§öÈùôÊÄÅÊñπÊ≥ïÊù•ÂàõÂª∫Â∏∏Áî®ÁöÑÂü∫‰∫é‰∏çÂêåÂåπÈÖçËßÑÂàôÁöÑPredicateÔºåÂ¶ÇRequestPredicates.pathÁî®Êù•Ê†πÊçÆ HTTP ËØ∑Ê±ÇÁöÑË∑ØÂæÑÊù•ËøõË°åÂåπÈÖçÔºåÊ≠§Â§ÑÊàë‰ª¨Ê£ÄÊü•ËØ∑Ê±ÇÁöÑË∑ØÂæÑÊòØ/calculator„ÄÇÁÑ∂Âêé‰ΩøÁî®ServerRequestÁöÑqueryParamÊñπÊ≥ïÊù•Ëé∑ÂèñÂà∞ÂèÇÊï∞operatorÁöÑÂÄºÔºåÁÑ∂ÂêéÈÄöËøáÂèçÂ∞Ñ API Âú®CalculatorHandler‰∏≠ÊâæÂà∞‰∏éÂèÇÊï∞operatorÁöÑÂÄºÂêçÁß∞Áõ∏ÂêåÁöÑÊñπÊ≥ïÊù•Á°ÆÂÆöË¶ÅË∞ÉÁî®ÁöÑHandlerFunctionÁöÑÂÆûÁé∞ÔºåÊúÄÂêéË∞ÉÁî®Êü•ÊâæÂà∞ÁöÑÊñπÊ≥ïÊù•Â§ÑÁêÜËØ•ËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúÊâæ‰∏çÂà∞ÂèÇÊï∞operatorÔºåÊúçÂä°Âô®Á´ØËøîÂõû 400 ÈîôËØØÔºõÂ¶ÇÊûúÂèçÂ∞Ñ API ÁöÑÊñπÊ≥ïË∞ÉÁî®‰∏≠Âá∫Áé∞ÈîôËØØÔºåÊúçÂä°Âô®Á´ØËøîÂõû 500 ÈîôËØØ„ÄÇ ÈáçÂêØÊúçÂä°ÁÑ∂ÂêéÊàë‰ª¨ËÆøÈóÆ http://127.0.0.1:8080/calculator?operator=add&amp;v1=2&amp;v2=3 ÂæóÂà∞ËøîÂõûÂÄº5„ÄÇ ÂÆ¢Êà∑Á´ØÈô§‰∫ÜÊúçÂä°Âô®Á´ØÂÆûÁé∞‰πãÂ§ñÔºåWebFlux ‰πüÊèê‰æõ‰∫ÜÂèçÂ∫îÂºèÂÆ¢Êà∑Á´ØÔºåÂèØ‰ª•ËÆøÈóÆ HTTP„ÄÅSSE Âíå WebSocket ÊúçÂä°Âô®Á´Ø„ÄÇ HTTPÂØπ‰∫é HTTP Âíå SSEÔºåÂèØ‰ª•‰ΩøÁî® WebFlux Ê®°Âùó‰∏≠ÁöÑÁ±ªorg.springframework.web.reactive.function.client.WebClient„ÄÇ‰∏ãÈù¢ÁöÑ‰ª£Á†Å‰∏≠Êàë‰ª¨Â∞ÜÁî®RESTClientÊù•ËÆøÈóÆÂâçÈù¢Â∞èËäÇ‰∏≠ÂàõÂª∫ÁöÑ REST API„ÄÇ 1234567891011121314@Testpublic void testRESTClient() throws InterruptedException &#123; User user = new User(4, "ËµµÂÖ≠", "z6@qq.com"); WebClient client = WebClient.create("http://localhost:8080/user"); // 1 Flux&lt;User&gt; createdUser = client.post() // 2 .uri("") // 3 .accept(MediaType.APPLICATION_JSON) // 4 .body(Mono.just(user), User.class) // 5 .retrieve() // 6 .bodyToFlux(User.class); // 7 createdUser.subscribe(System.out::println); // 8 TimeUnit.SECONDS.sleep(1); // 9&#125; ‰ΩøÁî®WebClient.createÊñπÊ≥ïÊù•ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑWebClientÂØπË±° ‰ΩøÁî®postÊñπÊ≥ïÊù•ÂàõÂª∫‰∏Ä‰∏™ POST ËØ∑Ê±Ç ÊåáÂÆö baseUrl ÈÖçÁΩÆËØ∑Ê±Ç HeaderÔºöContent-Type: application/json ‰ΩøÁî®body()ÊñπÊ≥ïÊù•ËÆæÁΩÆ POST ËØ∑Ê±ÇÁöÑÂÜÖÂÆπ ÂºÇÊ≠•Âú∞Ëé∑Âèñ response ‰ø°ÊÅØÔºåËøîÂõûÂÄº‰∏∫WebClient.ResponseSpecÔºåretrive()ÂèØ‰ª•ÁúãÂÅöÊòØexchange()ÊñπÊ≥ïÁöÑ ‚ÄúÂø´Êç∑Áâà‚ÄùÔºàexchange()ÁöÑËøîÂõûÂÄº‰∏∫ClientResponseÔºâ WebClient.ResponseSpecÁöÑbodyToFluxÊñπÊ≥ïÊääÂìçÂ∫îÂÜÖÂÆπËΩ¨Êç¢ÊàêUserÂØπË±°ÔºåÊúÄÁªàÂæóÂà∞ÁöÑÁªìÊûúÊòØFlux&lt;User&gt; ÊâìÂç∞Âá∫Êù• Áî±‰∫éÊòØÂºÇÊ≠•ÁöÑÔºåÊàë‰ª¨Â∞ÜÊµãËØïÁ∫øÁ®ã sleep 1 ÁßíÁ°Æ‰øùÊãøÂà∞ responseÔºå‰πüÂèØ‰ª•Áî®CountDownLatch SEEWebClient ËøòÂèØ‰ª•Áî®ÂêåÊ†∑ÁöÑÊñπÂºèÊù•ËÆøÈóÆ SSE ÊúçÂä°„ÄÇËøôÈáåÊàë‰ª¨ËÆøÈóÆÁöÑÊòØÂú®‰πãÂâçÁöÑÂ∞èËäÇ‰∏≠ÂàõÂª∫ÁöÑÁîüÊàêÈöèÊú∫Êï∞ÁöÑ SSE ÊúçÂä°„ÄÇ‰ΩøÁî® WebClient ËÆøÈóÆ SSE Âú®ÂèëÈÄÅËØ∑Ê±ÇÈÉ®ÂàÜ‰∏éËÆøÈóÆ REST API ÊòØÁõ∏ÂêåÁöÑÔºåÊâÄ‰∏çÂêåÁöÑÂú∞ÊñπÂú®‰∫éÂØπ HTTP ÂìçÂ∫îÁöÑÂ§ÑÁêÜ„ÄÇ 1234567891011121314151617181920@Testpublic void testSEEClient() &#123; final WebClient client = WebClient.create(); client.get() .uri("http://localhost:8080/sse/random") .accept(MediaType.TEXT_EVENT_STREAM) .exchange() .flatMapMany(response -&gt; // 1 response.body( BodyExtractors.toFlux( new ParameterizedTypeReference&lt;ServerSentEvent&lt;String&gt;&gt;() &#123;&#125; ) ) ) .filter(sse -&gt; Objects.nonNull(sse.data())) .map(ServerSentEvent::data) .buffer(10) // 2 .doOnNext(System.out::println) // 3 .blockFirst(); // 4&#125; Áî±‰∫é SSE ÊúçÂä°ÁöÑÂìçÂ∫îÊòØ‰∏Ä‰∏™Ê∂àÊÅØÊµÅÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®flatMapManyÊää Mono&lt;ServerResponse&gt;ËΩ¨Êç¢Êàê‰∏Ä‰∏™Flux&lt;ServerSentEvent&gt;ÂØπË±°ÔºåËøôÊòØÈÄöËøáÊñπÊ≥ïBodyExtractors.toFluxÊù•ÂÆåÊàêÁöÑÔºåÂÖ∂‰∏≠ÁöÑÂèÇÊï∞new ParameterizedTypeReference&lt;ServerSentEvent&lt;String&gt;&gt;() {}Ë°®Êòé‰∫ÜÂìçÂ∫îÊ∂àÊÅØÊµÅ‰∏≠ÁöÑÂÜÖÂÆπÊòØServerSentEventÂØπË±° Áî±‰∫é SSE ÊúçÂä°Âô®‰ºö‰∏çÊñ≠Âú∞ÂèëÈÄÅÊ∂àÊÅØÔºåËøôÈáåÊàë‰ª¨Âè™ÊòØÈÄöËøábufferÊñπÊ≥ïÊù•Ëé∑ÂèñÂâç 10 Êù°Ê∂àÊÅØÂπ∂ËæìÂá∫ Âè™ËØªÂú∞ peek ÊØè‰∏™ÂÖÉÁ¥†ÔºåÁÑ∂ÂêéÊâìÂç∞Âá∫Êù•ÔºåÂÆÉÂπ∂‰∏çÊòØ subscribeÔºåÊâÄ‰ª•‰∏ç‰ºöËß¶ÂèëÊµÅ blockFirstÊñπÊ≥ïÔºåÈ°æÂêçÊÄù‰πâÔºåÂú®Êî∂Âà∞Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ââç‰ºöÈòªÂ°ûÔºåÂìçÂ∫îÂºè‰∏öÂä°Âú∫ÊôØ‰∏≠ÊÖéÁî® ËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö ÊàñËÄÖ‰πüÂèØ‰ª•ÂÉè‰∏ãËæπËøôÊ†∑ 123456789101112@Testpublic void testSEEClient2() &#123; WebClient client = WebClient.create(); client.get() .uri("http://localhost:8080/sse/random") .accept(MediaType.TEXT_EVENT_STREAM) .retrieve() .bodyToFlux(String.class) .log() .take(10) .blockLast();&#125; ËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö WebSocketËÆøÈóÆ WebSocket ‰∏çËÉΩ‰ΩøÁî® WebClientÔºåËÄåÂ∫îËØ•‰ΩøÁî®‰∏ìÈó®ÁöÑ WebSocketClient ÂÆ¢Êà∑Á´Ø„ÄÇSpring Boot ÁöÑ WebFlux Ê®°Êùø‰∏≠ÈªòËÆ§‰ΩøÁî®ÁöÑÊòØ Reactor Netty Â∫ì„ÄÇReactor Netty Â∫ìÊèê‰æõ‰∫Ü WebSocketClient ÁöÑÂÆûÁé∞„ÄÇÊàë‰ª¨ËøôÈáåËÆøÈóÆÂâçÈù¢ÂàõÂª∫ÁöÑ WebSocket ÊúçÂä°„ÄÇ 12345678910@Testpublic void testWSClient() &#123; WebSocketClient client = new ReactorNettyWebSocketClient(); // 1 client.execute(URI.create("ws://localhost:8080/echo"), session -&gt; // 2 session.send(Flux.just(session.textMessage("Hello"))) // 3 .thenMany(session.receive().take(1).map(WebSocketMessage::getPayloadAsText)) // 4 .doOnNext(System.out::println) .then()) .block(Duration.ofMillis(5000));&#125; ÂàõÂª∫‰∏Ä‰∏™ WebSocketClient ÂÆû‰æã ‰ΩøÁî® WebSocketClient ÁöÑexecuteÊñπÊ≥ï‰∏é WebSocket ÊúçÂä°Âô®Âª∫Á´ãËøûÊé•ÔºåÂπ∂ÊâßË°åÁªôÂÆöÁöÑ WebSocketHandler ÂØπË±° ÈÄöËøá WebSocketSession ÁöÑsendÊñπÊ≥ïÊù•ÂèëÈÄÅÂ≠óÁ¨¶‰∏≤‚ÄùHello‚Äù Âà∞ÊúçÂä°Âô®Á´Ø ÈÄöËøáreceiveÊñπÊ≥ïÊù•Á≠âÂæÖÊúçÂä°Âô®Á´ØÁöÑÂìçÂ∫îÂπ∂ËæìÂá∫Ôºåtake(1)ÁöÑ‰ΩúÁî®ÊòØË°®ÊòéÂÆ¢Êà∑Á´ØÂè™Ëé∑ÂèñÊúçÂä°Âô®Á´ØÂèëÈÄÅÁöÑÁ¨¨‰∏ÄÊù°Ê∂àÊÅØ ËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö ÊµãËØïÂú® spring-test Ê®°Âùó‰∏≠‰πüÊ∑ªÂä†‰∫ÜÂØπ WebFlux ÁöÑÊîØÊåÅ„ÄÇÈÄöËøáÁ±ª org.springframework.test.web.reactive.server.WebTestClientÂèØ‰ª•ÊµãËØï WebFlux ÊúçÂä°Âô®„ÄÇËøõË°åÊµãËØïÊó∂Êó¢ÂèØ‰ª•ÈÄöËøá mock ÁöÑÊñπÂºèÊù•ËøõË°åÔºå‰πüÂèØ‰ª•ÂØπÂÆûÈôÖËøêË°åÁöÑÊúçÂä°Âô®ËøõË°åÈõÜÊàêÊµãËØï„ÄÇ Êàë‰ª¨ÈÄöËøá‰∏Ä‰∏™ÈõÜÊàêÊµãËØïÊù•ÊµãËØïUserController‰∏≠ÁöÑÂàõÂª∫Áî®Êà∑ÁöÑÂäüËÉΩ„ÄÇÊñπÊ≥ï WebTestClient.bindToServerÁªëÂÆöÂà∞‰∏Ä‰∏™ËøêË°åÁöÑÊúçÂä°Âô®Âπ∂ËÆæÁΩÆ‰∫ÜÂü∫Á°Ä URL„ÄÇÂèëÈÄÅ HTTP ËØ∑Ê±ÇÁöÑÊñπÂºè‰∏é‰πãÂâçÁöÑ‰ª£Á†ÅÁõ∏ÂêåÔºå‰∏çÂêåÁöÑÊòØexchangeÊñπÊ≥ïÁöÑËøîÂõûÂÄºÊòØResponseSpecÂØπË±°ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫ÜexpectStatusÂíåexpectBodyÁ≠âÊñπÊ≥ïÊù•È™åËØÅ HTTP ÂìçÂ∫îÁöÑÁä∂ÊÄÅÁ†ÅÂíåÂÜÖÂÆπ„ÄÇÊñπÊ≥ïjsonPathÂèØ‰ª•Ê†πÊçÆ JSON ÂØπË±°‰∏≠ÁöÑË∑ØÂæÑÊù•ËøõË°åÈ™åËØÅ„ÄÇ 1234567891011121314151617public class UserControllerTest &#123; private final WebTestClient client = WebTestClient.bindToServer().baseUrl("http://localhost:8080").build(); @Test public void testCreateUser() throws Exception &#123; User user = new User(5, "Èí±‰∏É", "q7@qq.com"); client.post().uri("/user") .contentType(MediaType.APPLICATION_JSON) .body(Mono.just(user), User.class) .exchange() .expectStatus().isOk() .expectBody().jsonPath("$[0].name") .isEqualTo("Èí±‰∏É"); &#125;&#125; JsonPath ÁöÑËØ≠Ê≥ïÂèØ‰ª•Áúã https://github.com/json-path/JsonPath ÊÄªÁªìÂèçÂ∫îÂºèÁºñÁ®ãËåÉÂºè‰∏∫ÂºÄÂèëÈ´òÊÄßËÉΩ Web Â∫îÁî®Â∏¶Êù•‰∫ÜÊñ∞ÁöÑÊú∫‰ºöÂíåÊåëÊàò„ÄÇSpring 5 ‰∏≠ÁöÑ WebFlux Ê®°ÂùóÂèØ‰ª•‰Ωú‰∏∫ÂºÄÂèëÂèçÂ∫îÂºè Web Â∫îÁî®ÁöÑÂü∫Á°Ä„ÄÇÁî±‰∫é Spring Ê°ÜÊû∂ÁöÑÊµÅË°åÔºåWebFlux ‰ºöÊàê‰∏∫ÂºÄÂèë Web Â∫îÁî®ÁöÑÈáçË¶ÅË∂ãÂäø‰πã‰∏Ä„ÄÇÊú¨ÊñáÂØπ Spring 5 ‰∏≠ÁöÑ WebFlux Ê®°ÂùóËøõË°å‰∫ÜËØ¶ÁªÜÁöÑ‰ªãÁªçÔºåÂåÖÊã¨Â¶Ç‰ΩïÁî® WebFlux ÂºÄÂèë HTTP„ÄÅSSE Âíå WebSocket ÊúçÂä°Âô®Á´ØÂ∫îÁî®Ôºå‰ª•Âèä‰Ωú‰∏∫ÂÆ¢Êà∑Á´ØÊù•ËÆøÈóÆ HTTP„ÄÅSSE Âíå WebSocket ÊúçÂä°„ÄÇÂØπ‰∫é WebFlux ÁöÑÂü∫‰∫é Java Ê≥®Ëß£ÂíåÂáΩÊï∞ÂºèÁºñÁ®ãÁ≠â‰∏§ÁßçÊ®°ÂûãÈÉΩËøõË°å‰∫Ü‰ªãÁªç„ÄÇÊúÄÂêé‰ªãÁªç‰∫ÜÂ¶Ç‰ΩïÊµãËØï WebFlux Â∫îÁî®„ÄÇ Á§∫‰æã‰ª£Á†ÅÔºöGithub ÂèÇËÄÉWeb on Reactive Stack23. WebFlux framework‰ΩøÁî® Spring 5 ÁöÑ WebFlux ÂºÄÂèëÂèçÂ∫îÂºè Web Â∫îÁî®‰ΩøÁî® Reactor ËøõË°åÂèçÂ∫îÂºèÁºñÁ®ãReactor NettySpring WebFlux Âø´ÈÄü‰∏äÊâã]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>SSE</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[java nioÂ∏∏Áî®ÊñπÊ≥ï]]></title>
    <url>%2F2019%2F02%2F23%2Fjava-nio%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ByteBuffer1„ÄÅÂÆû‰æãÂåñjava.nio.BufferÁ±ªÊòØ‰∏Ä‰∏™ÊäΩË±°Á±ªÔºå‰∏çËÉΩË¢´ÂÆû‰æãÂåñ„ÄÇBufferÁ±ªÁöÑÁõ¥Êé•Â≠êÁ±ªÔºåÂ¶ÇByteBufferÁ≠â‰πüÊòØÊäΩË±°Á±ªÔºåÊâÄ‰ª•‰πü‰∏çËÉΩË¢´ÂÆû‰æãÂåñ„ÄÇ ‰ΩÜÊòØByteBufferÁ±ªÊèê‰æõ‰∫Ü4‰∏™ÈùôÊÄÅÂ∑•ÂéÇÊñπÊ≥ïÊù•Ëé∑ÂæóByteBufferÁöÑÂÆû‰æãÔºö ÊñπÊ≥ï ÊèèËø∞ allocate(int capacity) ‰ªéÂ†ÜÁ©∫Èó¥‰∏≠ÂàÜÈÖç‰∏Ä‰∏™ÂÆπÈáèÂ§ßÂ∞è‰∏∫capacityÁöÑbyteÊï∞ÁªÑ‰Ωú‰∏∫ÁºìÂÜ≤Âå∫ÁöÑbyteÊï∞ÊçÆÂ≠òÂÇ®Âô® allocateDirect(int capacity) ÊòØ‰∏ç‰ΩøÁî®JVMÂ†ÜÊ†àËÄåÊòØÈÄöËøáÊìç‰ΩúÁ≥ªÁªüÊù•ÂàõÂª∫ÂÜÖÂ≠òÂùóÁî®‰ΩúÁºìÂÜ≤Âå∫ÔºåÂÆÉ‰∏éÂΩìÂâçÊìç‰ΩúÁ≥ªÁªüËÉΩÂ§üÊõ¥Â•ΩÁöÑËÄ¶ÂêàÔºåÂõ†Ê≠§ËÉΩËøõ‰∏ÄÊ≠•ÊèêÈ´òI/OÊìç‰ΩúÈÄüÂ∫¶„ÄÇ‰ΩÜÊòØÂàÜÈÖçÁõ¥Êé•ÁºìÂÜ≤Âå∫ÁöÑÁ≥ªÁªüÂºÄÈîÄÂæàÂ§ßÔºåÂõ†Ê≠§Âè™ÊúâÂú®ÁºìÂÜ≤Âå∫ËæÉÂ§ßÂπ∂ÈïøÊúüÂ≠òÂú®ÔºåÊàñËÄÖÈúÄË¶ÅÁªèÂ∏∏ÈáçÁî®Êó∂ÔºåÊâç‰ΩøÁî®ËøôÁßçÁºìÂÜ≤Âå∫ wrap(byte[] array) Ëøô‰∏™ÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆ‰ºöÂ≠òÊîæÂú®byteÊï∞ÁªÑ‰∏≠ÔºåbytesÊï∞ÁªÑÊàñbuffÁºìÂÜ≤Âå∫‰ªª‰Ωï‰∏ÄÊñπ‰∏≠Êï∞ÊçÆÁöÑÊîπÂä®ÈÉΩ‰ºöÂΩ±ÂìçÂè¶‰∏ÄÊñπ„ÄÇÂÖ∂ÂÆûByteBufferÂ∫ïÂ±ÇÊú¨Êù•Â∞±Êúâ‰∏Ä‰∏™bytesÊï∞ÁªÑË¥üË¥£Êù•‰øùÂ≠òbufferÁºìÂÜ≤Âå∫‰∏≠ÁöÑÊï∞ÊçÆÔºåÈÄöËøáallocateÊñπÊ≥ïÁ≥ªÁªü‰ºöÂ∏Æ‰Ω†ÊûÑÈÄ†‰∏Ä‰∏™byteÊï∞ÁªÑ wrap(byte[] array, int offset, int length) Âú®‰∏ä‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÂü∫Á°Ä‰∏äÂèØ‰ª•ÊåáÂÆöÂÅèÁßªÈáèÂíåÈïøÂ∫¶ÔºåËøô‰∏™offset‰πüÂ∞±ÊòØÂåÖË£ÖÂêébyteBufferÁöÑpositionÔºåËÄålengthÂë¢Â∞±ÊòØlimit-positionÁöÑÂ§ßÂ∞èÔºå‰ªéËÄåÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞limitÁöÑ‰ΩçÁΩÆ‰∏∫length+position(offset) 2„ÄÅÂè¶Â§ñ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÊñπÊ≥ï ÊñπÊ≥ï ÊèèËø∞ limit(), limit(10)Á≠â ÂÖ∂‰∏≠ËØªÂèñÂíåËÆæÁΩÆËøô4‰∏™Â±ûÊÄßÁöÑÊñπÊ≥ïÁöÑÂëΩÂêçÂíåjQuery‰∏≠ÁöÑval(),val(10)Á±ª‰ººÔºå‰∏Ä‰∏™Ë¥üË¥£getÔºå‰∏Ä‰∏™Ë¥üË¥£set reset() ÊääpositionËÆæÁΩÆÊàêmarkÁöÑÂÄºÔºåÁõ∏ÂΩì‰∫é‰πãÂâçÂÅöËøá‰∏Ä‰∏™Ê†áËÆ∞ÔºåÁé∞Âú®Ë¶ÅÈÄÄÂõûÂà∞‰πãÂâçÊ†áËÆ∞ÁöÑÂú∞Êñπ clear() position = 0;limit = capacity;mark = -1; ÊúâÁÇπÂàùÂßãÂåñÁöÑÂë≥ÈÅìÔºå‰ΩÜÊòØÂπ∂‰∏çÂΩ±ÂìçÂ∫ïÂ±ÇbyteÊï∞ÁªÑÁöÑÂÜÖÂÆπ flip() limit = position;position = 0;mark = -1; ÁøªËΩ¨Ôºå‰πüÂ∞±ÊòØËÆ©flip‰πãÂêéÁöÑpositionÂà∞limitËøôÂùóÂå∫ÂüüÂèòÊàê‰πãÂâçÁöÑ0Âà∞positionËøôÂùóÔºåÁøªËΩ¨Â∞±ÊòØÂ∞Ü‰∏Ä‰∏™Â§Ñ‰∫éÂ≠òÊï∞ÊçÆÁä∂ÊÄÅÁöÑÁºìÂÜ≤Âå∫Âèò‰∏∫‰∏Ä‰∏™Â§Ñ‰∫éÂáÜÂ§áÂèñÊï∞ÊçÆÁöÑÁä∂ÊÄÅ rewind() ÊääpositionËÆæ‰∏∫0ÔºåmarkËÆæ‰∏∫-1Ôºå‰∏çÊîπÂèòlimitÁöÑÂÄº remaining() return limit - position; ËøîÂõûlimitÂíåposition‰πãÈó¥Áõ∏ÂØπ‰ΩçÁΩÆÂ∑Æ hasRemaining() return position &lt; limitËøîÂõûÊòØÂê¶ËøòÊúâÊú™ËØªÂÜÖÂÆπ compact() Êää‰ªépositionÂà∞limit‰∏≠ÁöÑÂÜÖÂÆπÁßªÂà∞0Âà∞limit-positionÁöÑÂå∫ÂüüÂÜÖÔºåpositionÂíålimitÁöÑÂèñÂÄº‰πüÂàÜÂà´ÂèòÊàêlimit-position„ÄÅcapacity„ÄÇÂ¶ÇÊûúÂÖàÂ∞ÜpositonËÆæÁΩÆÂà∞limitÔºåÂÜçcompactÔºåÈÇ£‰πàÁõ∏ÂΩì‰∫éclear() get() Áõ∏ÂØπËØªÔºå‰ªéposition‰ΩçÁΩÆËØªÂèñ‰∏Ä‰∏™byteÔºåÂπ∂Â∞Üposition+1Ôºå‰∏∫‰∏ãÊ¨°ËØªÂÜô‰ΩúÂáÜÂ§á get(int index) ÁªùÂØπËØªÔºåËØªÂèñbyteBufferÂ∫ïÂ±ÇÁöÑbytes‰∏≠‰∏ãÊ†á‰∏∫indexÁöÑbyteÔºå‰∏çÊîπÂèòposition get(byte[] dst, int offset, int length) ‰ªéposition‰ΩçÁΩÆÂºÄÂßãÁõ∏ÂØπËØªÔºåËØªlength‰∏™byteÔºåÂπ∂ÂÜôÂÖ•dst‰∏ãÊ†á‰ªéoffsetÂà∞offset+lengthÁöÑÂå∫Âüü put(byte b) Áõ∏ÂØπÂÜôÔºåÂêëpositionÁöÑ‰ΩçÁΩÆÂÜôÂÖ•‰∏Ä‰∏™byteÔºåÂπ∂Â∞Üpostion+1Ôºå‰∏∫‰∏ãÊ¨°ËØªÂÜô‰ΩúÂáÜÂ§á put(int index, byte b) ÁªùÂØπÂÜôÔºåÂêëbyteBufferÂ∫ïÂ±ÇÁöÑbytes‰∏≠‰∏ãÊ†á‰∏∫indexÁöÑ‰ΩçÁΩÆÊèíÂÖ•byte bÔºå‰∏çÊîπÂèòposition put(ByteBuffer src) Áî®Áõ∏ÂØπÂÜôÔºåÊääsrc‰∏≠ÂèØËØªÁöÑÈÉ®ÂàÜÔºà‰πüÂ∞±ÊòØpositionÂà∞limitÔºâÂÜôÂÖ•Ê≠§byteBuffer put(byte[] src, int offset, int length) ‰ªésrcÊï∞ÁªÑ‰∏≠ÁöÑoffsetÂà∞offset+lengthÂå∫ÂüüËØªÂèñÊï∞ÊçÆÂπ∂‰ΩøÁî®Áõ∏ÂØπÂÜôÂÜôÂÖ•Ê≠§byteBuffer ‰ª£Á†ÅÂèÇËÄÉhttps://github.com/Frankenjoy123/nettystudy java.nio.charset.Charsetencode(java.nio.CharBuffer)FileChanneljava.nio.file.Paths##get(java.lang.String, java.lang.String‚Ä¶) ‚Äã]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>nio</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQLÂ∏∏Áî®ÂáΩÊï∞]]></title>
    <url>%2F2019%2F02%2F21%2FMySQL%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%2F</url>
    <content type="text"><![CDATA[Â≠óÁ¨¶‰∏≤Êà™Âèñ1. Â≠óÁ¨¶‰∏≤Êà™ÂèñÔºöleft(str, length)123456mysql&gt; select left('sqlstudy.com', 3);+-------------------------+| left('sqlstudy.com', 3) |+-------------------------+| sql |+-------------------------+ 2. Â≠óÁ¨¶‰∏≤Êà™ÂèñÔºöright(str, length)123456mysql&gt; select right('sqlstudy.com', 3);+--------------------------+| right('sqlstudy.com', 3) |+--------------------------+| com |+--------------------------+ 3. Â≠óÁ¨¶‰∏≤Êà™ÂèñÔºösubstring(str, pos); substring(str, pos, len)3.1 ‰ªéÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨ 4 ‰∏™Â≠óÁ¨¶‰ΩçÁΩÆÂºÄÂßãÂèñÔºåÁõ¥Âà∞ÁªìÊùü„ÄÇ 123456mysql&gt; select substring('sqlstudy.com', 4);+------------------------------+| substring('sqlstudy.com', 4) |+------------------------------+| study.com |+------------------------------+ 3.2 ‰ªéÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨ 4 ‰∏™Â≠óÁ¨¶‰ΩçÁΩÆÂºÄÂßãÂèñÔºåÂè™Âèñ 2 ‰∏™Â≠óÁ¨¶„ÄÇ 123456mysql&gt; select substring('sqlstudy.com', 4, 2);+---------------------------------+| substring('sqlstudy.com', 4, 2) |+---------------------------------+| st |+---------------------------------+ 3.3 ‰ªéÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨ 4 ‰∏™Â≠óÁ¨¶‰ΩçÁΩÆÔºàÂÄíÊï∞ÔºâÂºÄÂßãÂèñÔºåÁõ¥Âà∞ÁªìÊùü„ÄÇ 123456mysql&gt; select substring('sqlstudy.com', -4);+-------------------------------+| substring('sqlstudy.com', -4) |+-------------------------------+| .com |+-------------------------------+ 3.4 ‰ªéÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨ 4 ‰∏™Â≠óÁ¨¶‰ΩçÁΩÆÔºàÂÄíÊï∞ÔºâÂºÄÂßãÂèñÔºåÂè™Âèñ 2 ‰∏™Â≠óÁ¨¶„ÄÇ 123456mysql&gt; select substring('sqlstudy.com', -4, 2);+----------------------------------+| substring('sqlstudy.com', -4, 2) |+----------------------------------+| .c |+----------------------------------+ Êàë‰ª¨Ê≥®ÊÑèÂà∞Âú®ÂáΩÊï∞ substring(str,pos, len)‰∏≠Ôºå pos ÂèØ‰ª•ÊòØË¥üÂÄºÔºå‰ΩÜ len ‰∏çËÉΩÂèñË¥üÂÄº„ÄÇ 4. Â≠óÁ¨¶‰∏≤Êà™ÂèñÔºösubstring_index(str,delim,count)4.1 Êà™ÂèñÁ¨¨‰∫å‰∏™ ‚Äò.‚Äô ‰πãÂâçÁöÑÊâÄÊúâÂ≠óÁ¨¶„ÄÇ 123456mysql&gt; select substring_index('www.sqlstudy.com.cn', '.', 2);+------------------------------------------------+| substring_index('www.sqlstudy.com.cn', '.', 2) |+------------------------------------------------+| www.sqlstudy |+------------------------------------------------+ 4.2 Êà™ÂèñÁ¨¨‰∫å‰∏™ ‚Äò.‚Äô ÔºàÂÄíÊï∞Ôºâ‰πãÂêéÁöÑÊâÄÊúâÂ≠óÁ¨¶„ÄÇ 123456mysql&gt; select substring_index('www.sqlstudy.com.cn', '.', -2);+-------------------------------------------------+| substring_index('www.sqlstudy.com.cn', '.', -2) |+-------------------------------------------------+| com.cn |+-------------------------------------------------+ 4.3 Â¶ÇÊûúÂú®Â≠óÁ¨¶‰∏≤‰∏≠Êâæ‰∏çÂà∞ delim ÂèÇÊï∞ÊåáÂÆöÁöÑÂÄºÔºåÂ∞±ËøîÂõûÊï¥‰∏™Â≠óÁ¨¶‰∏≤ 123456mysql&gt; select substring_index('www.sqlstudy.com.cn', '.coc', 1);+---------------------------------------------------+| substring_index('www.sqlstudy.com.cn', '.coc', 1) |+---------------------------------------------------+| www.sqlstudy.com.cn |+---------------------------------------------------+]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑËß£ÂÜ≥ÊñπÊ°à]]></title>
    <url>%2F2019%2F02%2F17%2F%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%2F</url>
    <content type="text"><![CDATA[ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑËß£ÂÜ≥ÊñπÊ°àÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºàzkÔºâ ‰∏∫‰ªÄ‰πà‰ºöÊúâÂàÜÂ∏ÉÂºè‰∫ãÂä°Êàë‰ª¨ÂÅáËÆæÊúâÂ¶Ç‰∏ã‰∏Ä‰∏™Êû∂ÊûÑÔºåËøôÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÁîµÂïÜÊû∂ÊûÑÂπ≥Âè∞Ôºå‰∏§‰∏™Â∫îÁî®ËäÇÁÇπÔºå‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÔºå‰∏Ä‰∏™Ë¥üËΩΩÂùáË°°Âô®„ÄÇËøô‰∏™Êû∂ÊûÑ‰∏ãÔºåÊØèÂ§©‰ºö‰∫ßÁîüÂ∞ÜËøë100WÁöÑËÆ¢ÂçïÈáè„ÄÇÈÇ£‰πà‰∏Ä‰∏™ÊúàÁöÑÊï∞ÊçÆÈáèÂ∞±‰ºöË∂ÖËøá3000W„ÄÇËÄåÈöèÁùÄÊï∞ÊçÆÈáèÁöÑ‰∏çÊñ≠Êâ©Â§ßÔºåÂØπ‰∫éËÆ¢ÂçïË°®ÁöÑÁõ∏ÂÖ≥Êü•ËØ¢Êìç‰ΩúÁöÑÊÄßËÉΩÂºÄÈîÄÂ∞±Ë∂äÊù•Ë∂äÂ§ß„ÄÇÂπ∂‰∏îÂìçÂ∫îËÄóÊó∂‰πüË∂äÊù•Ë∂äÈïø„ÄÇËøô‰∏™Êó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅËÄÉËôëÂà∞Êï∞ÊçÆÂ∫ìÁöÑ‰ºòÂåñÈóÆÈ¢ò„ÄÇ‰πüÂ∞±ÊòØÂØπÊï∞ÊçÆÂ∫ìËøõË°åÂàÜË°®ÂàÜÂ∫ìÔºåËææÂà∞ÂàÜÊëäÊï∞ÊçÆÂ∫ìÂéãÂäõ‰ª•ÂèäÂáèÂ∞ëÊï∞ÊçÆÂ∫ìÂçïË°®Êï∞ÊçÆÈáèÁöÑÁõÆÁöÑ„ÄÇ ÂàÜÂ∫ìÂàÜË°®‰ª•ÂêéÂ∏¶Êù•ÁöÑÈóÆÈ¢òÂàÜÂ∫ìÂàÜË°®‰ª•ÂêéÔºå‰∏ÄÊñπÈù¢ÂàÜÊãÖ‰∫ÜÂçïÂ∫ìÂ∏¶Êù•ÁöÑÊÄßËÉΩÂéãÂäõÔºõÂè¶‰∏ÄÊñπÈù¢ÔºåÂáèÂ∞ë‰∫ÜÂçïË°®ÁöÑÊï∞ÊçÆÈáè„ÄÇÂÆåÁæéÁöÑËß£ÂÜ≥‰∫ÜÊàë‰ª¨ÈÅáÂà∞ÁöÑÊÄßËÉΩÈóÆÈ¢ò„ÄÇ‰ΩÜÊòØÔºåÈöèÁùÄËÄåÊù•ÁöÑÂèàÊúâÂè¶Â§ñÁöÑÈóÆÈ¢ò„ÄÇ ÊØîÂ¶ÇÊúâËøôÊ†∑‰∏Ä‰∏™Âú∫ÊôØÔºåËÆ¢ÂçïÊîØ‰ªòÊàêÂäü‰ª•ÂêéÈúÄË¶ÅÊâ£ÂáèÂ∫ìÂ≠ò„ÄÇÂú®Êï∞ÊçÆÂ∫ìÂàÜÂ∫ìÂàÜË°®‰πãÂâçÔºåÊâÄÊúâÊï∞ÊçÆÈÉΩÂú®Âêå‰∏Ä‰∏™Â∫ìÈáåÈù¢ÔºåÂèØ‰ª•ÈÄöËøá‰∫ãÂä°Êìç‰ΩúÂ∞±ÂæàÂÆπÊòìËææÂà∞Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÁöÑÁõÆÁöÑ„ÄÇ‰ΩÜÊòØÂú®Êï∞ÊçÆÂ∫ìÂÅö‰∫ÜÊãÜÂàÜÂêéÔºåËÆ¢ÂçïÁä∂ÊÄÅÊõ¥Êñ∞ÊòØÂ±û‰∫éËÆ¢ÂçïÁöÑÊï∞ÊçÆÂ∫ìÔºåËÄåÂ∫ìÂ≠òÊâ£ÂáèÊòØÂ±û‰∫éÂ∫ìÂ≠òÁöÑÊï∞ÊçÆÂ∫ì„ÄÇÂéüÊú¨ÂçïÂ∫ìÁöÑ‰∫ãÂä°Êìç‰ΩúÂ∞±ÂèòÊàê‰∫ÜÂ§öÂ∫ìÁöÑ‰∫ãÂä°Êìç‰Ωú„ÄÇ ‰ΩÜÊòØÊØè‰∏™Â∫ìÁöÑ‰∫ãÂä°Âè™ÊúâËá™Â∑±Áü•ÈÅìÔºåËÆ¢ÂçïÂ∫ìÂπ∂‰∏çÁü•ÈÅìÂ∫ìÂ≠òÂ∫ìÁöÑ‰∫ãÂä°ÊâßË°åÁªìÊûúÔºåÂ∫ìÂ≠òÂ∫ì‰πü‰∏çÁü•ÈÅìËÆ¢ÂçïÂ∫ìÁöÑ‰øÆÊîπÁªìÊûú„ÄÇÊâÄ‰ª•Â∞±ÈÄ†Êàê‰∫ÜÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÈóÆÈ¢ò„ÄÇÂÖ∂ÂÆû‰πüÂè´ÂàÜÂ∏ÉÂºèÊï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÇ ËÆ§ËØÜÂàÜÂ∏ÉÂºè‰∫ãÂä°Êó¢ÁÑ∂Â≠òÂú®ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÈóÆÈ¢òÔºåÈÇ£Â∞±‰∏ÄÂÆöÊúâÊàêÁÜüÁöÑËß£ÂÜ≥ÊñπÊ°àÔºåÈÇ£‰πàÊé•‰∏ãÊù•Êàë‰ª¨‰∫ÜËß£‰∏ã‰∏öÂÜÖÁöÑÂ∏∏Áî®Ëß£ÂÜ≥ÊñπÊ≥ïÂèäÂéüÁêÜ ÁªèÂÖ∏ÁöÑX/OpenDTP‰∫ãÂä°Ê®°Âûã X/Open DTP(X/Open Distributed Transaction Processing Reference Model) ÊòØX/OpenËøô‰∏™ÁªÑÁªáÂÆö‰πâÁöÑ‰∏ÄÂ•óÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÊ†áÂáÜÔºå‰πüÂ∞±ÊòØÂÆö‰πâ‰∫ÜËßÑËåÉÂíåAPIÊé•Âè£ÔºåÁî±ÂêÑ‰∏™ÂéÇÂïÜËøõË°åÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇ Ëøô‰∏™Ê†áÂáÜÊèêÂá∫‰∫Ü‰ΩøÁî®‰∫åÈò∂ÊÆµÊèê‰∫§(2PC ‚Äì Two-Phase-Commit)Êù•‰øùËØÅÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÂÆåÊï¥ÊÄß„ÄÇÂêéÊù•J2EE‰πüÈÅµÂæ™‰∫ÜX/OpenDTPËßÑËåÉÔºåËÆæËÆ°Âπ∂ÂÆûÁé∞‰∫ÜjavaÈáåÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁºñÁ®ãÊé•Âè£ËßÑËåÉ-JTA X/OpenDTPËßíËâ≤ Âú®X/OpenDTP‰∫ãÂä°Ê®°Âûã‰∏≠ÔºåÂÆö‰πâ‰∫Ü‰∏â‰∏™ËßíËâ≤ AP: application, Â∫îÁî®Á®ãÂ∫èÔºå‰πüÂ∞±ÊòØ‰∏öÂä°Â±Ç„ÄÇÂì™‰∫õÊìç‰ΩúÂ±û‰∫é‰∏Ä‰∏™‰∫ãÂä°ÔºåÂ∞±ÊòØAPÂÆö‰πâÁöÑ RMÔºö Resource ManagerÔºåËµÑÊ∫êÁÆ°ÁêÜÂô®„ÄÇ‰∏ÄËà¨ÊòØÊï∞ÊçÆÂ∫ìÔºå‰πüÂèØ‰ª•ÊòØÂÖ∂‰ªñËµÑÊ∫êÁÆ°ÁêÜÂô®ÔºåÊØîÂ¶ÇÊ∂àÊÅØÈòüÂàóÔºåÊñá‰ª∂Á≥ªÁªü TMÔºö Transaction Manager Ôºå‰∫ãÂä°ÁÆ°ÁêÜÂô®„ÄÅ‰∫ãÂä°ÂçèË∞ÉËÄÖÔºåË¥üË¥£Êé•Êî∂Êù•Ëá™Áî®Êà∑Á®ãÂ∫èÔºàAPÔºâÂèëËµ∑ÁöÑXA‰∫ãÂä°Êåá‰ª§ÔºåÂπ∂Ë∞ÉÂ∫¶ÂíåÂçèË∞ÉÂèÇ‰∏é‰∫ãÂä°ÁöÑÊâÄÊúâRMÔºàÊï∞ÊçÆÂ∫ìÔºâÔºåÁ°Æ‰øù‰∫ãÂä°Ê≠£Á°ÆÂÆåÊàê Âú®ÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÔºåÊØè‰∏Ä‰∏™Êú∫Âô®ËäÇÁÇπËôΩÁÑ∂ÈÉΩËÉΩÂ§üÊòéÁ°ÆÁü•ÈÅìËá™Â∑±Âú®ËøõË°å‰∫ãÂä°Êìç‰ΩúËøáÁ®ã‰∏≠ÁöÑÁªìÊûúÊòØÊàêÂäüËøòÊòØÂ§±Ë¥•Ôºå‰ΩÜÂç¥Êó†Ê≥ïÁõ¥Êé•Ëé∑ÂèñÂà∞ÂÖ∂‰ªñÂàÜÂ∏ÉÂºèËäÇÁÇπÁöÑÊìç‰ΩúÁªìÊûú„ÄÇÂõ†Ê≠§ÂΩì‰∏Ä‰∏™‰∫ãÂä°Êìç‰ΩúÈúÄË¶ÅË∑®Ë∂äÂ§ö‰∏™ÂàÜÂ∏ÉÂºèËäÇÁÇπÁöÑÊó∂ÂÄôÔºå‰∏∫‰∫Ü‰øùÊåÅ‰∫ãÂä°Â§ÑÁêÜÁöÑACIDÁâπÊÄßÔºåÂ∞±ÈúÄË¶ÅÂºïÂÖ•‰∏Ä‰∏™‚ÄúÂçèË∞ÉËÄÖ‚ÄùÔºàTMÔºâÊù•Áªü‰∏ÄË∞ÉÂ∫¶ÊâÄÊúâÂàÜÂ∏ÉÂºèËäÇÁÇπÁöÑÊâßË°åÈÄªËæëÔºåËøô‰∫õË¢´Ë∞ÉÂ∫¶ÁöÑÂàÜÂ∏ÉÂºèËäÇÁÇπË¢´Áß∞‰∏∫AP„ÄÇTMË¥üË¥£Ë∞ÉÂ∫¶APÁöÑË°å‰∏∫ÔºåÂπ∂ÊúÄÁªàÂÜ≥ÂÆöËøô‰∫õAPÊòØÂê¶Ë¶ÅÊää‰∫ãÂä°ÁúüÊ≠£ËøõË°åÊèê‰∫§Âà∞ÔºàRMÔºâ ÂèÇ‰∏éÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÂ∫îÁî®Á®ãÂ∫è(AP)ÂÖàÂà∞TM‰∏äÊ≥®ÂÜåÂÖ®Â±Ä‰∫ãÂä° ÁÑ∂ÂêéÂêÑ‰∏™APÁõ¥Êé•Âú®Áõ∏Â∫îÁöÑËµÑÊ∫êÁÆ°ÁêÜÂô®(RM)‰∏äËøõË°å‰∫ãÂä°Êìç‰Ωú Êìç‰ΩúÂÆåÊàê‰ª•ÂêéÔºåÂêÑ‰∏™APÂèçÈ¶à‰∫ãÂä°ÁöÑÂ§ÑÁêÜÁªìÊûúÁªôÂà∞TM TMÊî∂Âà∞ÊâÄÊúâAPÁöÑÂèçÈ¶à‰ª•ÂêéÔºåÈÄöËøáÊï∞ÊçÆÂ∫ìÊèê‰æõÁöÑXAÊé•Âè£ËøõË°åÊï∞ÊçÆÊèê‰∫§ÊàñËÄÖÂõûÊªöÊìç‰Ωú 2pcÊèê‰∫§Ôºàtwo -phaseCommitÔºâÂú®X/OpenDTPÊ®°Âûã‰∏≠Ôºå‰∏Ä‰∏™ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊâÄÊ∂âÂèäÁöÑSQLÈÄªËæëÈÉΩÊâßË°åÂÆåÊàêÔºåÂπ∂Âà∞‰∫ÜÔºàRMÔºâË¶ÅÊúÄÂêéÊèê‰∫§‰∫ãÂä°ÁöÑÂÖ≥ÈîÆÊó∂ÂàªÔºå‰∏∫‰∫ÜÈÅøÂÖçÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊâÄÂõ∫ÊúâÁöÑ‰∏çÂèØÈù†ÊÄßÂØºËá¥Êèê‰∫§‰∫ãÂä°ÊÑèÂ§ñÂ§±Ë¥•ÔºåTM ÊûúÊñ≠ÂÜ≥ÂÆöÂÆûÊñΩ‰∏§Ê≠•Ëµ∞ÁöÑÊñπÊ°àÔºåËøô‰∏™Â∞±Áß∞‰∏∫‰∫åÈò∂Êèê‰∫§ ‰∫åÈò∂ÊÆµÊèê‰∫§ÔºåÊòØËÆ°ÁÆóÊú∫ÁΩëÁªúÂ∞§ÂÖ∂ÊòØÂú®Êï∞ÊçÆÂ∫ìÈ¢ÜÂüüÂÜÖÔºå‰∏∫‰∫Ü‰ΩøÂü∫‰∫éÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊû∂ÊûÑ‰∏ãÁöÑÊâÄÊúâËäÇÁÇπÂú®ËøõË°å‰∫ãÂä°Â§ÑÁêÜËøáÁ®ã‰∏≠ËÉΩÂ§ü‰øùÊåÅÂéüÂ≠êÊÄßÂíå‰∏ÄËá¥ÊÄßËÄåËÆæËÆ°ÁöÑ‰∏ÄÁßçÁÆóÊ≥ï„ÄÇ ÈÄöÂ∏∏Ôºå‰∫åÈò∂ÊÆµÊèê‰∫§ÂçèËÆÆ‰πüË¢´ËÆ§‰∏∫ÊòØ‰∏ÄÁßç‰∏ÄËá¥ÊÄßÂçèËÆÆÔºåÁî®Êù•‰øùËØÅÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄß„ÄÇÁõÆÂâçÔºåÁªùÂ§ßÈÉ®ÂàÜÁöÑÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÈÉΩÊòØÈááÁî®‰∫åÈò∂ÊÆµÊèê‰∫§ÂçèËÆÆÊù•ÂÆåÊàêÂàÜÂ∏ÉÂºè‰∫ãÂä°Â§ÑÁêÜÁöÑÔºåÂà©Áî®ËØ•ÂçèËÆÆËÉΩÂ§üÈùûÂ∏∏Êñπ‰æøÂú∞ÂÆåÊàêÊâÄÊúâÂàÜÂ∏ÉÂºè‰∫ãÂä°APÁöÑÂçèË∞ÉÔºåÁªü‰∏ÄÂÜ≥ÂÆö‰∫ãÂä°ÁöÑÊèê‰∫§ÊàñÂõûÊªöÔºå‰ªéËÄåËÉΩÂ§üÊúâÊïà‰øùËØÅÂàÜÂ∏ÉÂºèÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºåÂõ†Ê≠§2pc‰πüË¢´ÂπøÊ≥õËøêÁî®Âú®ËÆ∏Â§öÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ Á¨¨‰∏ÄÈò∂ÊÆµ ‰∫ãÂä°ËØ¢ÈóÆ TMÂêëÊâÄÊúâÁöÑAPÂèëÈÄÅ‰∫ãÂä°ÂÜÖÂÆπÔºåËØ¢ÈóÆÊòØÂê¶ÂèØ‰ª•ÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÂπ∂ÂºÄÂßãÁ≠âÂæÖÂêÑAPÁöÑÂìçÂ∫î ÊâßË°å‰∫ãÂä° ÂêÑ‰∏™APËäÇÁÇπÊâßË°å‰∫ãÂä°Êìç‰ΩúÔºåÂπ∂Â∞ÜUndoÂíåRedo‰ø°ÊÅØËÆ∞ÂΩïÂà∞‰∫ãÂä°Êó•Âøó‰∏≠ÔºåÂ∞ΩÈáèÊääÊèê‰∫§ËøáÁ®ã‰∏≠ÊâÄÊúâÊ∂àËÄóÊó∂Èó¥ÁöÑÊìç‰ΩúÂíåÂáÜÂ§áÈÉΩÊèêÂâçÂÆåÊàêÁ°Æ‰øùÂêéÈù¢100%ÊàêÂäüÊèê‰∫§‰∫ãÂä° ÂêÑ‰∏™APÂêëTMÂèçÈ¶à‰∫ãÂä°ËØ¢ÈóÆÁöÑÂìçÂ∫î Â¶ÇÊûúÂêÑ‰∏™APÊàêÂäüÊâßË°å‰∫Ü‰∫ãÂä°Êìç‰ΩúÔºåÈÇ£‰πàÂ∞±ÂèçÈ¶àÁªôAP yesÁöÑÂìçÂ∫îÔºåË°®Á§∫‰∫ãÂä°ÂèØ‰ª•ÊâßË°åÔºõÂ¶ÇÊûúAPÊ≤°ÊúâÊàêÂäüÊâßË°å‰∫ãÂä°ÔºåÂ∞±ÂèçÈ¶àÁªôTM noÁöÑÂìçÂ∫îÔºåË°®Á§∫‰∫ãÂä°‰∏çÂèØ‰ª•ÊâßË°å ‰∏äÈù¢Ëøô‰∏™Èò∂ÊÆµÊúâÁÇπÁ±ª‰ººTMÁªÑÁªáÂêÑ‰∏™APÂØπ‰∏ÄÊ¨°‰∫ãÂä°Êìç‰ΩúÁöÑÊäïÁ•®Ë°®ÊÄÅËøáÁ®ãÔºåÂõ†Ê≠§2pcÂçèËÆÆÁöÑÁ¨¨‰∏Ä‰∏™Èò∂ÊÆµÁß∞‰∏∫‚ÄúÊäïÁ•®Èò∂ÊÆµ‚ÄùÔºåÂç≥ÂêÑAPÊäïÁ•®Ë°®ÂêçÊòØÂê¶ÈúÄË¶ÅÁªßÁª≠ÊâßË°åÊé•‰∏ãÂéªÁöÑ‰∫ãÂä°Êèê‰∫§Êìç‰Ωú„ÄÇ Á¨¨‰∫åÈò∂ÊÆµ‰∫ãÂä°Êèê‰∫§Âú®Ëøô‰∏™Èò∂ÊÆµÔºåTM‰ºöÊ†πÊçÆÂêÑAPÁöÑÂèçÈ¶àÊÉÖÂÜµÊù•ÂÜ≥ÂÆöÊúÄÁªàÊòØÂê¶ÂèØ‰ª•ËøõË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÂåÖÂê´‰∏§ÁßçÂèØËÉΩ ÂÅáÂ¶ÇTM‰ªéÊâÄÊúâÂèÇ‰∏éËÄÖËé∑ÂæóÁöÑÂèçÈ¶àÈÉΩÊòØyesÂìçÂ∫îÔºåÈÇ£‰πàÂ∞±‰ºöÊâßË°å‰∫ãÂä°Êèê‰∫§ ÂèëÈÄÅÊèê‰∫§ËØ∑Ê±Ç TMÂêëÊâÄÊúâAPËäÇÁÇπÂèëÂá∫commitËØ∑Ê±Ç ‰∫ãÂä°Êèê‰∫§ APÊé•Êî∂Âà∞CommitËØ∑Ê±ÇÂêéÔºå‰ºöÊ≠£ÂºèÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÂπ∂Âú®ÂÆåÊàêÊèê‰∫§‰πãÂêéÈáäÊîæÂú®Êï¥‰∏™‰∫ãÂä°ÊâßË°åÊúüÈó¥Âç†Áî®ÁöÑ‰∫ãÂä°ËµÑÊ∫ê ÂèçÈ¶à‰∫ãÂä°Êèê‰∫§ÁªìÊûú APÂú®ÂÆåÊàê‰∫ãÂä°Êèê‰∫§‰πãÂêéÔºåÂêëTMÂèëÈÄÅAckÊ∂àÊÅØ ÂÆåÊàê‰∫ãÂä° TMÊé•Êî∂Âà∞ÊâÄÊúâAPÂèçÈ¶àÁöÑackÊ∂àÊÅØÂêéÔºåÂÆåÊàê‰∫ãÂä° ‰∫ãÂä°ÂõûÊªöÂ¶ÇÊûúÁ¨¨‰∏Ä‰∏™Èò∂ÊÆµ‰∏≠ÁöÑÊüê‰∏Ä‰∏™ËµÑÊ∫êÈ¢ÑÊèê‰∫§Â§±Ë¥•ÔºåÈÇ£‰πàÁ¨¨‰∫å‰∏™Èò∂ÊÆµÂ∞±ÂõûÊªöÁ¨¨‰∏ÄÈò∂ÊÆµÂ∑≤ÁªèÈ¢ÑÊèê‰∫§ÊàêÂäüÁöÑËµÑÊ∫ê ÂÅáËÆæ‰ªª‰Ωï‰∏Ä‰∏™APÂêëTMÂèçÈ¶à‰∫ÜNOÁöÑÂìçÂ∫îÔºåÊàñËÄÖÂú®Á≠âÂæÖË∂ÖÊó∂‰πãÂêéÔºåTMÊó†Ê≥ïÊé•Êî∂Âà∞ÊâÄÊúâAPÁöÑÂèçÈ¶àÂìçÂ∫îÔºåÈÇ£‰πàÂ∞±‰ºö‰∏≠Êñ≠‰∫ãÂä° ÂèëÈÄÅÂõûÊªöËØ∑Ê±Ç TMÂêëÊâÄÊúâAPÂèëÂá∫abortËØ∑Ê±Ç ‰∫ãÂä°ÂõûÊªö APÊî∂Âà∞abortËØ∑Ê±ÇÂêéÔºå‰ºöÂà©Áî®Âú®Á¨¨‰∏ÄÈò∂ÊÆµËÆ∞ÂΩïÁöÑUndo‰ø°ÊÅØÊù•ÊâßË°å‰∫ãÂä°ÂõûÊªöÊìç‰ΩúÔºåÂπ∂Âú®ÂÆåÊàêÂõûÊªö‰πãÂêéÈáäÊîæÂú®Êï¥‰∏™‰∫ãÂä°ÊâßË°åÊúüÈó¥Âç†Áî®ÁöÑËµÑÊ∫ê ÂèçÈ¶à‰∫ãÂä°ÂõûÊªöÁªìÊûú ÂêÑAPÂú®ÂÆåÊàê‰∫ãÂä°ÂõûÊªö‰πãÂêéÔºåÂêëTMÂèëÈÄÅAckÊ∂àÊÅØ ‰∏≠Á´Ø‰∫ãÂä° TM Êé•Êî∂Âà∞ÊâÄÊúâAPÂèçÈ¶àÁöÑackÊ∂àÊÅØÂêéÔºåÂÆåÊàê‰∫ãÂä°‰∏≠Êñ≠ ‰∫åÈò∂ÊÆµÊèê‰∫§Â∞Ü‰∏Ä‰∏™‰∫ãÂä°ÁöÑÂ§ÑÁêÜËøáÁ®ãÂàÜ‰∏∫ÊäïÁ•®ÂíåÊâßË°å‰∏§‰∏™Èò∂ÊÆµ. ‰∫åÈò∂ÊÆµÊèê‰∫§ÁöÑ‰ºòÁÇπÂú®‰∫éÔºåÂÆÉÂÖÖÂàÜËÄÉËôëÂà∞‰∫ÜÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑ‰∏çÂèØÈù†Âõ†Á¥†ÔºåÂπ∂‰∏îÈááÁî®ÈùûÂ∏∏ÁÆÄÂçïÁöÑÊñπÂºèÔºà‰∏§Èò∂ÊÆµÊèê‰∫§ÔºâÂ∞±ÊääÁî±‰∫éÁ≥ªÁªü‰∏çÂèØÈù†‰ªéËÄåÂØºËá¥‰∫ãÂä°Êèê‰∫§Â§±Ë¥•ÁöÑÊ¶ÇÁéáÈôçÂà∞ÊúÄÂ∞è ÂÅáÂ¶Ç‰∏Ä‰∏™‰∫ãÂä°ÁöÑÊèê‰∫§ËøáÁ®ãÊÄªÂÖ±ÈúÄË¶Å30ÁßíÁöÑÊìç‰ΩúÔºåÂÖ∂‰∏≠prepareÈò∂ÊÆµÈúÄË¶Å28ÁßíÔºà‰∏ªË¶ÅÊòØÁ°Æ‰øù‰∫ãÂä°Êó•ÂøóËêΩÂú∞Á£ÅÁõòÁ≠âÂêÑÁßçËÄóÊó∂ÁöÑI/OÊìç‰ΩúÔºâÔºåÁúüÊ≠£ÁöÑcommitÈò∂ÊÆµÂè™ÈúÄË¶ÅËä±Ë¥π‰∏§ÁßíÔºåÈÇ£‰πàCommitÈò∂ÊÆµÂèëÁîüÈîôËØØÁöÑÊ¶ÇÁéá‰∏éPrepareÈò∂ÊÆµÁõ∏ÊØîÔºåÂè™ÊòØÂÆÉÁöÑ2/28(&lt;10%)Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûúPrepareÈò∂ÊÆµÊàêÂäü‰∫ÜÔºåÂàôCommitÈò∂ÊÆµÁî±‰∫éÊó∂Èó¥ÈùûÂ∏∏Á´ØÔºåÂ§±Ë¥•Ê¶ÇÁéáÂ∞èÔºå‰ºöÂ§ßÂ§ßÂ¢ûÂä†ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊàêÂäüÁöÑÊ¶ÇÁéá„ÄÇ 2pcÂçèËÆÆÁöÑ‰ºòÁº∫ÁÇπ ÂéüÁêÜÁÆÄÂçïÔºåÂÆûÁé∞ÂæàÊñπ‰æø ÊØè‰∏Ä‰∏™Èò∂ÊÆµÈÉΩÊòØÂêåÊ≠•ÈòªÂ°ûÔºå‰ºöÈÄ†ÊàêÊÄßËÉΩÊçüËÄó„ÄÇ ÂçèË∞ÉËÄÖÂ≠òÂú®ÂçïÁÇπÈóÆÈ¢òÔºåÂ¶ÇÊûúÂçèË∞ÉËÄÖÂú®Á¨¨‰∫åÈò∂ÊÆµÂá∫Áé∞ÊïÖÈöúÔºåÈÇ£‰πàÂÖ∂‰ªñÂèÇ‰∏éËÄÖ‰ºö‰∏ÄÁõ¥Â§Ñ‰∫éÈîÅÂÆöÁä∂ÊÄÅ„ÄÇ Â§™Ëøá‰øùÂÆàÔºå‰ªªÊÑè‰∏Ä‰∏™ËäÇÁÇπÂ§±Ë¥•ÈÉΩ‰ºöÂØºËá¥Êï∞ÊçÆÂõûÊªö Êï∞ÊçÆ‰∏ç‰∏ÄËá¥ÈóÆÈ¢ò: Âú®Èò∂ÊÆµ‰∫å‰∏≠ÔºåÂΩìÂçèË∞ÉËÄÖÂêëÊâÄÊúâÁöÑÂèÇ‰∏éËÄÖÂèëÈÄÅcommitËØ∑Ê±ÇÂêéÔºåÂèëÁîü‰∫ÜÁΩëÁªúÂºÇÂ∏∏ÂØºËá¥ÂçèË∞ÉËÄÖÂú®Â∞öÊú™ÂèëÂÆåcommitËØ∑Ê±Ç‰πãÂâçÂ¥©Ê∫ÉÔºåÂèØËÉΩ‰ºöÂØºËá¥Âè™ÊúâÈÉ®ÂàÜÁöÑÂèÇ‰∏éËÄÖÊé•Êî∂Âà∞commitËØ∑Ê±ÇÔºåÂâ©‰∏ãÊ≤°Êî∂Âà∞commitËØ∑Ê±ÇÁöÑÂèÇ‰∏éËÄÖÂ∞ÜÊó†Ê≥ïÊèê‰∫§‰∫ãÂä°Ôºå‰πüÂ∞±ÂèØËÉΩÂØºËá¥Êï∞ÊçÆ‰∏ç‰∏ÄËá¥ÁöÑÈóÆÈ¢ò 3PC3PCÂçèËÆÆ‰∏ªË¶ÅÁî®Êù•Ëß£ÂÜ≥2PCÁöÑÂêåÊ≠•ÈòªÂ°ûÈóÆÈ¢òÁöÑ‰∏ÄÁßç‰ºòÂåñÊñπÊ°àÔºå3pcÂàÜ‰∏∫3‰∏™Èò∂ÊÆµÂàÜÂà´‰∏∫Ôºöcancommit„ÄÅPrecommit„ÄÅdoCommit„ÄÇ Âíå2Èò∂ÊÆµÊèê‰∫§ÁöÑÂå∫Âà´Âú®‰∫éÔºö (1) Âú®ÂçèË∞ÉËÄÖÂíåÂèÇ‰∏éËÄÖ‰∏≠ÂºïÂÖ•‰∫ÜË∂ÖÊó∂Êú∫Âà∂Ôºå2pcÂè™ÊúâÂú®ÂçèË∞ÉËÄÖÊã•ÊúâË∂ÖÊó∂Êú∫Âà∂,ÂçèË∞ÉËÄÖÂú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÊ≤°ÂèóÂà∞ÂèÇ‰∏éËÄÖÁöÑ‰ø°ÊÅØÂàôÈªòËÆ§‰∏∫Â§±Ë¥•Ôºõ (2) Êää2Èò∂ÊÆµÊèê‰∫§ÁöÑÁ¨¨‰∏Ä‰∏™Èò∂ÊÆµÊãÜÂàÜÊàê‰∫Ü‰∏§‰∏™Ê≠•È™§„ÄÇ cancommitÈò∂ÊÆµÂçèË∞ÉËÄÖÂêëÂèÇ‰∏éËÄÖÂèëÈÄÅcommitËØ∑Ê±ÇÔºåÂèÇ‰∏éËÄÖÂ¶ÇÊûúÂèØ‰ª•Êèê‰∫§Â∞±ËøîÂõûyesÁöÑÂìçÂ∫îÔºåÂê¶ÂàôËøîÂõûNoÁöÑÂìçÂ∫î„ÄÇËøô‰∏ÄÈò∂ÊÆµ‰∏ªË¶ÅÊòØÁ°ÆÂÆöÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÂèÇ‰∏éËÄÖÊòØÂê¶ÂÖ∑Â§á‰∫ÜÂÆåÊàêcommitÁöÑÊù°‰ª∂ÔºåÂπ∂‰∏ç‰ºöÊâßË°å‰∫ãÂä°Êìç‰Ωú„ÄÇ ËØ¢ÈóÆÂèÇ‰∏éËÄÖÊòØÂê¶ÂèØ‰ª•ÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰Ωú Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÂè™Ë¶ÅËÉΩÂ§üÈ°∫Âà©ÊâßË°å‰∫ãÂä°ÔºåÂ∞±ËøîÂõûyesÁöÑÂìçÂ∫îÔºåÂπ∂ËøõÂÖ•È¢ÑÂ§áÁä∂ÊÄÅ„ÄÇ precommitÈò∂ÊÆµ‰∫ãÂä°ÂçèË∞ÉËÄÖÊ†πÊçÆÂèÇ‰∏éËÄÖÁöÑÂèçÈ¶àÊÉÖÂÜµÊù•ÂÜ≥ÂÆöÊòØÂê¶ÁªßÁª≠ÊâßË°å‰∫ãÂä°ÁöÑprecommitÊìç‰ΩúÔºåÂú®Ëøô‰∏Ä‰∏™Èò∂ÊÆµÔºå‰ºöÊúâ‰∏§ÁßçÂèØËÉΩÊÄßÔºåÁ¨¨‰∏ÄÁßçÊòØÔºåÂú®cancommitÈò∂ÊÆµÊâÄÊúâÂèÇ‰∏éËÄÖÈÉΩÂèçÈ¶àÁöÑÊòØyesÔºåÂàô‰ºöËøõË°å‰∫ãÂä°È¢ÑÊâßË°å ÂçèË∞ÉËÄÖTMÂêëÂèÇ‰∏éËÄÖAPÂèëÈÄÅprecommitËØ∑Ê±Ç ÂèÇ‰∏éËÄÖÊî∂Âà∞precommitËØ∑Ê±ÇÂêéÔºåÊâßË°å‰∫ãÂä°Êìç‰ΩúÔºåÂπ∂Êää‰∫ãÂä°ÁöÑundoÂíåredo‰ø°ÊÅØËÆ∞ÂΩïÂà∞‰∫ãÂä°Êó•Âøó‰∏≠ ËøîÂõû‰∫ãÂä°ÁöÑÊâßË°åÁªìÊûúÁªôÂà∞ÂçèË∞ÉËÄÖÔºåÂπ∂Á≠âÂæÖÊúÄÁªàÁöÑÊèê‰∫§Êåá‰ª§ Â¶ÇÊûú‰ªªÊÑè‰∏Ä‰∏™‰∫ãÂä°ÂèÇ‰∏éËÄÖÂú®Á¨¨‰∏ÄÈò∂ÊÆµËøîÂõû‰∫ÜnoÔºåÂàôÊâßË°å‰∫ãÂä°‰∏≠Êñ≠ËØ∑Ê±Ç ÂêëÊâÄÊúâ‰∫ãÂä°ÂèÇ‰∏éËÄÖÂèëÈÄÅ‰∫ãÂä°‰∏≠Êñ≠ËØ∑Ê±Ç ÂØπ‰∫é‰∫ãÂä°ÂèÇ‰∏éËÄÖÊù•ËØ¥ÔºåÊó†ËÆ∫ÊòØÊî∂Âà∞ÂçèË∞ÉËÄÖÁöÑ‰∏≠Êñ≠ËØ∑Ê±ÇÔºåËøòÊòØÁ≠âÂæÖÂçèË∞ÉËÄÖÊåá‰ª§‰πãÂâçÂá∫Áé∞Ë∂ÖÊó∂ÔºåÂèÇ‰∏éËÄÖÈÉΩ‰ºö‰∏≠Êñ≠‰∫ãÂä° doCommitÈò∂ÊÆµËøô‰∏™Èò∂ÊÆµÂêåÊ†∑Â≠òÂú®‰∏§ÁßçÊÉÖÂÜµÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºåprecommitÈÉΩÂìçÂ∫î‰∫ÜackÁªôÂà∞ÂçèË∞ÉËÄÖÔºåÈÇ£‰πàÂçèË∞ÉËÄÖ‰ºöÂèëËµ∑‰∫ãÂä°Êèê‰∫§ËØ∑Ê±Ç„ÄÇ ÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖÂèëÈÄÅdocommitËØ∑Ê±Ç ÂèÇ‰∏éËÄÖÊî∂Âà∞docommitËØ∑Ê±ÇÂêéÔºåÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÂπ∂ÈáäÊîæÊâÄÊúâ‰∫ãÂä°ËµÑÊ∫ê ‰∫ãÂä°Êèê‰∫§‰ª•ÂêéËøîÂõûackÁªôÂà∞ÂçèË∞ÉËÄÖ ÂçèË∞ÉËÄÖÊî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑÂìçÂ∫îÂêéÔºåÂÆåÊàê‰∫ãÂä° Â¶ÇÊûúÂú®precommitÈò∂ÊÆµÔºåÊúâÂèÇ‰∏éËÄÖÊ≤°ÊúâÂèëÈÄÅackÁªôÂà∞ÂçèË∞ÉËÄÖÔºåÈÇ£‰πàÂàôÊâßË°å‰∫ãÂä°‰∏≠Êñ≠Êåá‰ª§ ÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖÂèëÈÄÅ‰∏≠Êñ≠‰∫ãÂä°ÁöÑËØ∑Ê±Ç ÂèÇ‰∏éËÄÖÊî∂Âà∞ËØ∑Ê±Ç‰ª•ÂêéÔºåÂà©Áî®Âú®Á¨¨‰∫å‰∏™Èò∂ÊÆµËÆ∞ÂΩïÁöÑundo‰ø°ÊÅØÊù•ÊâßË°å‰∫ãÂä°ÂõûÊªöÊìç‰Ωú ÂêëÂçèË∞ÉËÄÖÂèëÈÄÅackÊ∂àÊÅØÔºåÂçèË∞ÉËÄÖÊî∂Âà∞Ê∂àÊÅØ‰ª•ÂêéÔºåÊâßË°å‰∫ãÂä°‰∏≠Êñ≠Êìç‰Ωú ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏ÄËá¥ÊÄßÂú®java‰∏≠ÔºåÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏ªË¶ÅÁöÑËßÑËåÉÊòØJTA/XA . JTAÊòØjavaÁöÑ‰∫ãÂä°ÁÆ°ÁêÜÂô®ËßÑËåÉÔºåJTAÂÖ®Áß∞‰∏∫Java Transaction API, JTAÂÆö‰πâ‰∫Ü‰∏ÄÁªÑÁªü‰∏ÄÁöÑ‰∫ãÂä°ÁºñÁ®ãÁöÑÊé•Âè£ÔºåÂü∫‰∫éX/OpenDTPËßÑËåÉËÆæËÆ°ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁºñÁ®ãÊé•Âè£ËßÑËåÉ„ÄÇXAÊòØÂ∑•‰∏öÊ†áÂáÜÁöÑX/Open DTPËßÑËåÉ Âü∫‰∫éJTAËßÑËåÉÁöÑÁ¨¨‰∏âÊñπÂàÜÂ∏ÉÂºè‰∫ãÂä°Ê°ÜÊû∂ÊúâJotmÂíåAtomikos JOTMJOTM Ôºàjava open transaction managerÔºâÊòØObjectWebÁöÑ‰∏Ä‰∏™ÂºÄÊ∫êJTAÂÆûÁé∞ÔºåÊèê‰æõJTAÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÂäüËÉΩ ‰ΩÜÊòØJOTMÂ≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂú®‰ΩøÁî®‰∏≠‰∏çËÉΩËá™Âä®rollbackÔºåÊó†ËÆ∫‰ªÄ‰πàÊÉÖÂÜµÈÉΩcommit„ÄÇ Atomikos‰∏éJOTMÁõ∏ÊØîÔºåAtomikos Êõ¥Âä†Á®≥ÂÆöÔºåÂéüÊú¨AtomikosÊòØÂïÜ‰∏öÈ°πÁõÆÔºåÂêéÊù•ÂºÄÊ∫ê„ÄÇËÆ∫ÂùõÊØîËæÉÊ¥ªË∑ÉÔºåÊúâÈóÆÈ¢òÂèØ‰ª•ÈöèÊó∂Ëß£ÂÜ≥ ‰∫íËÅîÁΩëË°å‰∏öÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°àÁõÆÂâç‰∫íËÅîÁΩëÈ¢ÜÂüüÈáåÊúâÂá†ÁßçÊµÅË°åÁöÑÂàÜÂ∏ÉÂºèËß£ÂÜ≥ÊñπÊ°àÔºå‰ΩÜÈÉΩÊ≤°ÊúâÂÉè‰πãÂâçÊâÄËØ¥ÁöÑXA‰∫ãÂä°‰∏ÄÊ†∑ÂΩ¢ÊàêX/OpenDTPÈÇ£Ê†∑ÁöÑÂ∑•‰∏öËßÑËåÉÔºåËÄåÊòØ‰ªÖ‰ªÖÂú®ÂÖ∑‰ΩìÁöÑË°å‰∏öÈáåËé∑ÂæóËæÉÂ§öÁöÑËÆ§ÂèØÔºõ Êàë‰ª¨ÊúÄÊó©ÁöÑÊó∂ÂÄôËÆ≤ËøáCAPÂíåBASEÁêÜËÆ∫ÔºåÂØπ‰∫éCAPÊù•ËØ¥ÔºåÂØπ‰∫éÂÖ±‰∫´Êï∞ÊçÆÁöÑÁ≥ªÁªüÔºåÁî±‰∫éÁΩëÁªúÂàÜÂå∫ÈóÆÈ¢òÁöÑÂ≠òÂú®ÔºåÊàë‰ª¨Âè™ËÉΩÊª°Ë∂≥APÊàñËÄÖCPÔºõÂØπ‰∫éBASEÁêÜËÆ∫ÔºåÊª°Ë∂≥Âü∫Êú¨ÂèØÁî®„ÄÇÊâÄ‰ª•ÂÖ∂ÂÆûÊàë‰ª¨Âú®ËêΩÂú∞Êï∞ÊçÆ‰∏ÄËá¥ÊÄßËß£ÂÜ≥ÊñπÊ°àÊòØÔºåÂü∫Êú¨‰∏äÈÉΩ‰ºöÈÄâÊã©‰∏Ä‰∏™Âπ≥Ë°°ÁÇπÔºå‰πüÂ∞±ÊòØÈÖ∏Á¢±Âπ≥Ë°°ÁêÜËÆ∫ÔºåACIDÊòØÈÖ∏„ÄÅ BASEÊòØÁ¢±ÔºõACIDÊòØÂº∫‰∏ÄËá¥ÊÄß„ÄÅBASEÊòØÂº±‰∏ÄËá¥ÊÄß„ÄÇÂº∫‰∏ÄËá¥ÊÄß‰ª£Ë°®Êï∞ÊçÆÂ∫ìÊú¨Ë∫´‰∏ç‰ºöÂá∫Áé∞‰∏ç‰∏ÄËá¥ÔºåÊØè‰∏™‰∫ãÂä°ÊòØÂéüÂ≠êÁöÑÔºåÊàñËÄÖÊàêÂäüÊàñËÄÖÂ§±Ë¥•Ôºå‰∫ãÁâ©Èó¥ÊòØÈöîÁ¶ªÁöÑÔºå‰∫íÁõ∏ÂÆåÂÖ®‰∏çÂΩ±ÂìçÔºåËÄå‰∏îÊúÄÁªàÁä∂ÊÄÅÊòØÊåÅ‰πÖËêΩÁõòÁöÑÔºåÂõ†Ê≠§ÔºåÊï∞ÊçÆÂ∫ì‰ºö‰ªé‰∏Ä‰∏™ÊòéÁ°ÆÁöÑÁä∂ÊÄÅÂà∞Âè¶Â§ñ‰∏Ä‰∏™ÊòéÁ°ÆÁöÑÁä∂ÊÄÅ.; ËÄåBASE‰ΩìÁé∞ÁöÑÊòØÊúÄÁªà‰∏ÄËá¥ÊÄßÔºåÂÖÅËÆ∏Âá∫Áé∞‰∏≠Èó¥Áä∂ÊÄÅ„ÄÇ ÊâÄ‰ª•ÂØπ‰∫éÂØπ‰∫éÊúçÂä°Êù•ËØ¥ÔºåÊúâÂæàÂ§öÁöÑÊñπÊ°àÂéªÈÄâÊã©Ôºö Êèê‰æõÊü•ËØ¢ÊúçÂä°Á°ÆËÆ§Êï∞ÊçÆÁä∂ÊÄÅ„ÄÅ ÂπÇÁ≠âÊìç‰ΩúÂØπ‰∫éÈáçÂèë‰øùËØÅÊï∞ÊçÆÁöÑÂÆâÂÖ®ÊÄß„ÄÅ TCC‰∫ãÂä°Êìç‰Ωú„ÄÅ Ë°•ÂÅøÊìç‰Ωú„ÄÅ ÂÆöÊúüÊ†°ÂØπ„ÄÇ ‰∏öÂä°Êé•Âè£Êï¥ÂêàÔºåÈÅøÂÖçÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëøô‰∏™ÊñπÊ°àÂ∞±ÊòØÊää‰∏Ä‰∏™‰∏öÂä°ÊµÅÁ®ã‰∏≠ÈúÄË¶ÅÂú®‰∏Ä‰∏™‰∫ãÂä°ÈáåÊâßË°åÁöÑÂ§ö‰∏™Áõ∏ÂÖ≥‰∏öÂä°Êé•Âè£ÂåÖË£ÖÊï¥ÂêàÂà∞‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÔºåÊØîÂ¶ÇÊàë‰ª¨ÂèØ‰ª•ËÆ≤A/B/CÊï¥Âêà‰∏∫‰∏Ä‰∏™ÊúçÂä°DÊù•ÂÆûÁé∞Âçï‰∏Ä‰∫ãÂä°ÁöÑ‰∏öÂä°ÊµÅÁ®ãÊúçÂä° ÊúÄÁªà‰∏ÄËá¥ÊÄßÊñπÊ°àeBayÂú®2008Âπ¥ÂÖ¨Â∏É‰∫Ü‰∏Ä‰∏™ÂÖ≥‰∫éBASEÂáÜÂàôÊèêÂà∞‰∏Ä‰∏™ÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°à„ÄÇeBayÁöÑÊñπÊ°àÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ÊúÄÁªà‰∏ÄËá¥ÊÄßÊñπÊ°àÔºåÂÆÉ‰∏ªË¶ÅÈááÁî®Ê∂àÊÅØÈòüÂàóÊù•ËæÖÂä©ÂÆûÁé∞‰∫ãÂä°ÊéßÂà∂ÊµÅÁ®ãÔºåÊñπÊ°àÁöÑÊ†∏ÂøÉÊòØÂ∞ÜÈúÄË¶ÅÂàÜÂ∏ÉÂºèÂ§ÑÁêÜÁöÑ‰ªªÂä°ÈÄöËøáÊ∂àÊÅØÈòüÂàóÁöÑÊñπÂºèÊù•ÂºÇÊ≠•ÊâßË°åÔºåÂ¶ÇÊûú‰∫ãÂä°Â§±Ë¥•ÔºåÂàôÂèØ‰ª•ÂèëËµ∑‰∫∫Â∑•ÈáçËØïÁöÑÁ∫†Ê≠£ÊµÅÁ®ã„ÄÇ‰∫∫Â∑•ÈáçËØïË¢´Êõ¥Â§öÁöÑÂ∫îÁî®‰∫éÊîØ‰ªòÂú∫ÊôØÔºåÈÄöËøáÂØπË¥¶Á≥ªÁªüÂØπ‰∫ãÂêéÈóÆÈ¢òËøõË°åÂ§ÑÁêÜ ÊØîÂ¶Ç‰∏Ä‰∏™ÂæàÂ∏∏ËßÅÁöÑÂú∫ÊôØÔºöÊüê‰∏™Áî®Êà∑‰∫ßÁîü‰∫Ü‰∏ÄÁ¨î‰∫§ÊòìÔºåÈÇ£‰πàÈúÄË¶ÅÂú®‰∫§ÊòìË°®‰∏≠Â¢ûÂä†ËÆ∞ÂΩïÔºåÂêåÊó∂ÈúÄË¶Å‰øÆÊîπÁî®Êà∑Ë°®ÁöÑÈáëÈ¢ùÔºà‰ΩôÈ¢ùÔºâÔºåÁî±‰∫éËøô‰∏§‰∏™Ë°®Â±û‰∫é‰∏çÂêåÁöÑËøúÁ®ãÊúçÂä°ÔºåÊâÄ‰ª•Â∞±‰ºöÊ∂âÂèäÂà∞ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏éÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÁöÑÈóÆÈ¢ò ÂÖ≥‰∫éÁä∂ÊÄÅÊú∫Âú®‰ΩøÁî®ÊúÄÁªà‰∏ÄËá¥ÊÄßÁöÑÊñπÊ°àÊó∂Ôºå‰∏ÄÂÆöË¶ÅÊèêÂà∞ÁöÑ‰∏Ä‰∏™Ê¶ÇÂøµÊòØÁä∂ÊÄÅÊú∫„ÄÇ ‰ªÄ‰πàÊòØÁä∂ÊÄÅÊú∫ÔºüÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÁªÑÁªá‰ª£Á†ÅÁöÑÊñπÂºèÔºåÁî®ËøôÁßçÊñπÂºèËÉΩÂ§üÁ°Æ‰øù‰Ω†ÁöÑÂØπË±°ÈöèÊó∂ÈÉΩÁü•ÈÅìËá™Â∑±ÊâÄÂ§ÑÁöÑÁä∂ÊÄÅ‰ª•ÂèäÊâÄËÉΩÂÅöÁöÑÊìç‰Ωú„ÄÇÂÆÉ‰πüÊòØ‰∏ÄÁßçÁî®Êù•ËøõË°åÂØπË±°Ë°å‰∏∫Âª∫Ê®°ÁöÑÂ∑•ÂÖ∑ÔºåÁî®‰∫éÊèèËø∞ÂØπË±°Âú®ÂÆÉÁöÑÁîüÂëΩÂë®ÊúüÂÜÖÊâÄÁªèÂéÜÁöÑÁä∂ÊÄÅÂ∫èÂàóÔºå‰ª•ÂèäÂ¶Ç‰ΩïÂìçÂ∫îÊù•Ëá™Â§ñÁïåÁöÑÂêÑÁßç‰∫ã‰ª∂„ÄÇ Áä∂ÊÄÅÊú∫Ëøô‰∏™Ê¶ÇÂøµÂ§ßÂÆ∂ÈÉΩ‰∏çÈôåÁîüÔºåÊØîÂ¶ÇTCPÂçèËÆÆÁöÑÁä∂ÊÄÅÊú∫„ÄÇÂêåÊó∂Êàë‰ª¨Âú®ÁºñÂÜôÁõ∏ÂÖ≥‰∏öÂä°ÈÄªËæëÁöÑÊó∂ÂÄôÁªèÂ∏∏‰πü‰ºöÈúÄË¶ÅÂ§ÑÁêÜÂêÑÁßç‰∫ã‰ª∂ÂíåÁä∂ÊÄÅÁöÑÂàáÊç¢ÔºåÊØîÂ¶Çswitch„ÄÅif/else„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂÖ∂ÂÆû‰∏ÄÁõ¥Âú®Ë∑üÁä∂ÊÄÅÊú∫Êâì‰∫§ÈÅìÔºåÂè™ÊòØÂèØËÉΩÊ≤°ÊúâÊÑèËØÜÂà∞ËÄåÂ∑≤„ÄÇÂú®Â§ÑÁêÜ‰∏Ä‰∫õ‰∏öÂä°ÈÄªËæëÊØîËæÉÂ§çÊùÇÁöÑÈúÄÊ±ÇÊó∂ÔºåÂèØ‰ª•ÂÖàÁúãÁúãÊòØÂê¶ÈÄÇÂêàÁî®‰∏Ä‰∏™ÊúâÈôêÁä∂ÊÄÅÊú∫Êù•ÊèèËø∞ÔºåÂ¶ÇÊûúÂèØ‰ª•Êää‰∏öÂä°Ê®°ÂûãÊäΩË±°Êàê‰∏Ä‰∏™ÊúâÈôêÁä∂ÊÄÅÊú∫ÔºåÈÇ£‰πà‰ª£Á†ÅÂ∞±‰ºöÈÄªËæëÁâπÂà´Ê∏ÖÊô∞ÔºåÁªìÊûÑÁâπÂà´ËßÑÊï¥„ÄÇ ÊØîÂ¶ÇÊàë‰ª¨Êù•ÁÆÄÂçïÊèèËø∞‰∏Ä‰∏™ËÆ¢Âçï Êàë‰ª¨‰ª•ÊîØ‰ªò‰∏∫‰æãÔºå‰∏ÄÁ¨îËÆ¢ÂçïÂèØËÉΩ‰ºöÊúâÁ≠âÂæÖÊîØ‰ªò„ÄÅÊîØ‰ªò‰∏≠„ÄÅÂ∑≤ÊîØ‰ªòÁ≠âÁä∂ÊÄÅÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÂÖàÂéªÊääÂèØËÉΩÂá∫Áé∞ÁöÑÁä∂ÊÄÅ‰ª•ÂèäÁä∂ÊÄÅÁöÑÊµÅÁ®ãÁîªÂá∫Êù•„ÄÇ Áä∂ÊÄÅÊú∫ÁöÑ‰∏§‰∏™‰ΩúÁî® ÂÆûÁé∞ÂπÇÁ≠â ÈÄöËøáÁä∂ÊÄÅÈ©±Âä®Êï∞ÊçÆÁöÑÂèòÂåñ ‰∏öÂä°ÊµÅÁ®ã‰ª•ÂèäÈÄªËæëÊõ¥Âä†Ê∏ÖÊô∞ÔºåÁâπÂà´ÊòØÂ∫îÂØπÂ§çÊùÇÁöÑ‰∏öÂä°Âú∫ÊôØ ‰ªÄ‰πàÊòØÂπÇÁ≠âÁÆÄÂçïÊù•ËØ¥ÔºöÈáçÂ§çË∞ÉÁî®Â§öÊ¨°‰∫ßÁîüÁöÑ‰∏öÂä°ÁªìÊûú‰∏éË∞ÉÁî®‰∏ÄÊ¨°‰∫ßÁîüÁöÑ‰∏öÂä°ÁªìÊûúÁõ∏ÂêåÔºõ Âú®ÂàÜÂ∏ÉÂºèÊû∂ÊûÑ‰∏≠ÔºåÊàë‰ª¨Ë∞ÉÁî®‰∏Ä‰∏™ËøúÁ®ãÊúçÂä°ÂéªÂÆåÊàê‰∏Ä‰∏™Êìç‰ΩúÔºåÈô§‰∫ÜÊàêÂäüÂíåÂ§±Ë¥•‰ª•Â§ñÔºåËøòÊúâÊú™Áü•Áä∂ÊÄÅÔºåÈÇ£‰πàÈíàÂØπËøô‰∏™Êú™Áü•Áä∂ÊÄÅÔºåÊàë‰ª¨‰ºöÈááÂèñ‰∏Ä‰∫õÈáçËØïÁöÑË°å‰∏∫Ôºõ ÊàñËÄÖÂú®Ê∂àÊÅØ‰∏≠Èó¥‰ª∂ÁöÑ‰ΩøÁî®Âú∫ÊôØ‰∏≠ÔºåÊ∂àË¥πËÄÖÂèØËÉΩ‰ºöÈáçÂ§çÊî∂Âà∞Ê∂àÊÅØ„ÄÇÂØπ‰∫éËøô‰∏§ÁßçÊÉÖÂÜµÔºåÊ∂àË¥πÁ´ØÊàñËÄÖÊúçÂä°Á´ØÈúÄË¶ÅÈááÂèñ‰∏ÄÂÆöÁöÑÊâãÊÆµÔºå‰πüÂ∞±ÊòØËÄÉËôëÂà∞ÈáçÂèëÁöÑÊÉÖÂÜµ‰∏ã‰øùËØÅÊï∞ÊçÆÁöÑÂÆâÂÖ®ÊÄß„ÄÇ‰∏ÄËà¨Êàë‰ª¨Â∏∏Áî®ÁöÑÊâãÊÆµ Áä∂ÊÄÅÊú∫ÂÆûÁé∞ÂπÇÁ≠â Êï∞ÊçÆÂ∫ìÂîØ‰∏ÄÁ∫¶ÊùüÂÆûÁé∞ÂπÇÁ≠â ÈÄöËøátokenidÁöÑÊñπÂºèÂéªËØÜÂà´ÊØèÊ¨°ËØ∑Ê±ÇÂà§Êñ≠ÊòØÂê¶ÈáçÂ§ç Âü∫‰∫éÊ∂àÊÅØÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄßÊñπÊ°àÂÆûË∑µÂú®ÊúÄÁªà‰∏ÄËá¥ÊÄßËøô‰∏™ÊñπÊ°à‰∏äÔºå‰πüÊúâ‰∏§ÁßçÈÄâÊã©ÊñπÊ°àÔºå‰∏ÄÁßçÊòØÂü∫‰∫éÂèØÈù†Ê∂àÊÅØ‰∏≠Èó¥‰ª∂Êù•ÂÆûÁé∞ÂºÇÊ≠•ÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÅÂè¶‰∏ÄÁßçÂ∞±ÊòØÈÄöËøáMQÊù•ÂÆûÁé∞ÊúÄÂ§ßÂä™ÂäõÈÄöÁü•Âûã„ÄÇËøô‰∏§ÁßçÈÉΩÊØîËæÉÂ∏∏ËßÅÔºåÊØîÂ¶ÇÂ§ßÂÆ∂Â¶ÇÊûúÂØπÊé•ËøáÊîØ‰ªòÂÆùÊîØ‰ªòÁöÑapiÔºåÂ∞±Â∫îËØ•ËÉΩÁü•ÈÅìÔºåÂΩì‰Ω†Ë∞ÉÁî®ÊîØ‰ªòÊîØ‰ªò ÊàêÂäü‰ª•ÂêéÔºåÊîØ‰ªòÂÆù‰ºöÊèê‰æõ‰∏Ä‰∏™ÂºÇÊ≠•ÂõûË∞ÉÔºåË∞ÉÁî®ÈÖçÁΩÆÂ•ΩÁöÑÊåáÂÆöÁöÑÊé•Âè£Âú∞ÂùÄ„ÄÇÂú®Ëøô‰∏™Êé•Âè£‰∏≠Ôºå‰Ω†ÂèØ‰ª•Ëé∑ÂæóÊîØ‰ªòÂÆùÁöÑÊîØ‰ªòÁªìÊûúÂπ∂Ê†πÊçÆÁªìÊûúÂÅöÁõ∏Â∫îÁöÑÂ§ÑÁêÜ„ÄÇÊúÄÂêéÂøÖÈ°ªË¶ÅËøîÂõû‰∏Ä‰∏™ackÁªôÂà∞ÊîØ‰ªòÂÆùÁöÑÂõûË∞ÉapiÔºåÂëäËØâ‰ªñËøôËæπÂ∑≤ÁªèÂ§ÑÁêÜÊàêÂäü‰∫Ü„ÄÇÂê¶ÂàôÔºåÊîØ‰ªòÂÆùÁöÑÂºÇÊ≠•ÂõûË∞É‰ºö‰∏çÊñ≠ÈáçËØïÔºåÂΩìÁÑ∂ÊúâÈáçËØïÊ¨°Êï∞Ôºå‰ª•ÂèäÈáçËØïÁöÑÈó¥ÈöîÊó∂Èó¥„ÄÇÈÇ£Êé•‰∏ãÊù•ÔºåÊàë‰ª¨ÈÄöËøáÁ¨¨‰∏ÄÁßçÊñπÊ°àÊù•ÂÆûÁé∞Êï∞ÊçÆÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄß ÈÄöËøáÂºÇÊ≠•Ê∂àÊÅØÊâßË°åÊñπÊ°àÁöÑÊú¨Ë¥®ÊòØÔºåÊää‰∏§‰∏™‰∫ãÁâ©ËΩ¨ÂåñÊàê‰∏§‰∏™Êú¨Âú∞‰∫ãÂä°ÔºåÁÑ∂Âêé‰æùÈù†Ê∂àÊÅØÊú¨Ë∫´ÁöÑÂèØÈù†ÊÄßÔºå‰ª•ÂèäÊ∂àÊÅØÁöÑÈáçËØïÊú∫Âà∂ËææÂà∞ÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇ]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
      <tags>
        <tag>ÂàÜÂ∏ÉÂºè</tag>
        <tag>‰∫ãÂä°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring session ‰∏éJWT„ÄÅOAuth2]]></title>
    <url>%2F2019%2F02%2F17%2FSpring-session-%E4%B8%8EJWT%E3%80%81OAtuh2%2F</url>
    <content type="text"><![CDATA[spring-session-data-redissesssionÂ≠òÁöÑÂÄºÂèäÂ±ûÊÄßget spring:session:sessions:expires:381be901-f399-443d-baf7-a274a98ac019 ÂæóÂà∞maxInactiveIntervallastAccessedTimecreationTimesessionAttr:Mic 1request.getSession().setAttribute("Mic","value"); 123456789127.0.0.1:6379&gt; hgetall spring:session:sessions:e8b7c9a1-8c4a-4f03-996f-619cfba91ea11) "maxInactiveInterval"2) "\xac\xed\x00\x05sr\x00\x11java.lang.Integer\x12\xe2\xa0\xa4\xf7\x81\x878\x02\x00\x01I\x00\x05valuexr\x00\x10java.lang.Number\x86\xac\x95\x1d\x0b\x94\xe0\x8b\x02\x00\x00xp\x00\x00\x02X"3) "lastAccessedTime"4) "\xac\xed\x00\x05sr\x00\x0ejava.lang.Long;\x8b\xe4\x90\xcc\x8f#\xdf\x02\x00\x01J\x00\x05valuexr\x00\x10java.lang.Number\x86\xac\x95\x1d\x0b\x94\xe0\x8b\x02\x00\x00xp\x00\x00\x01h\xf9\xbb\xcc\xff"5) "sessionAttr:Mic"6) "\xac\xed\x00\x05t\x00\x05value"7) "creationTime"8) "\xac\xed\x00\x05sr\x00\x0ejava.lang.Long;\x8b\xe4\x90\xcc\x8f#\xdf\x02\x00\x01J\x00\x05valuexr\x00\x10java.lang.Number\x86\xac\x95\x1d\x0b\x94\xe0\x8b\x02\x00\x00xp\x00\x00\x01h\xf9\xb6\xd0\xf5" ËøáÊúüÊó∂Èó¥get spring:session:sessions:expires:e8b7c9a1-8c4a-4f03-996f-619cfba91ea1 1127.0.0.1:6379&gt; get spring:session:sessions:expires:e8b7c9a1-8c4a-4f03-996f-619cfba91ea1 JWT https://jwt.io È™åËØÅÁ≠æÂêçËßÑËåÉ header1234&#123; "alg": "HS256", "typ": "JWT"&#125; payload12345&#123; "sub": "1234567890", "name": "John Doe", "iat": 1516239022&#125; Á≠æÂêçÁÆóÊ≥ï verify signature12345HMACSHA256( base64UrlEncode(header) + "." + base64UrlEncode(payload),"your-256-bit-secret") your-256-bit-secret Á±ª‰ººÁßòÈí• 12345HMACSHA256( base64UrlEncode(header) + "." + base64UrlEncode(payload), secret) ‰ª£Á†ÅÂèÇËÄÉ https://gitee.com/Joey_z/vip-project-space/blob/master/user-service/user-provider/src/main/java/com/gupaoedu/user/utils/JwtTokenUtils.java 1234567891011121314151617181920212223242526272829303132333435363738394041public class JwtTokenUtils &#123; public static void main(String[] args) &#123; System.out.println(UUID.randomUUID(). toString().replace("-","")); &#125; //ÂÆö‰πâyour-256-bit-secret private static Key generatorKey()&#123; SignatureAlgorithm saa=SignatureAlgorithm.HS256; byte[] bin=DatatypeConverter.parseBase64Binary ("f3973b64918e4324ad85acea1b6cbec5"); Key key=new SecretKeySpec(bin,saa.getJcaName()); return key; &#125; public static String generatorToken(Map&lt;String,Object&gt; payLoad)&#123; ObjectMapper objectMapper=new ObjectMapper(); try &#123; //ÂÆö‰πâpayload return Jwts.builder().setPayload(objectMapper.writeValueAsString(payLoad)) //Jwt SignatureAlgorithm.HS256ÂÆö‰πâ‰∫Üheader .signWith(SignatureAlgorithm.HS256,generatorKey()).compact(); &#125; catch (JsonProcessingException e) &#123; e.printStackTrace(); &#125; return null; &#125; public static Claims phaseToken(String token)&#123; Jws&lt;Claims&gt; claimsJwt=Jwts.parser().setSigningKey(generatorKey()).parseClaimsJws(token); return claimsJwt.getBody(); &#125;&#125; OAuth2]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring-MVC DispatchServlet HanderInteceptorÂàÜÊûê]]></title>
    <url>%2F2019%2F02%2F17%2FSpring-MVC-DispatchServlet-HanderInteceptor%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[DispatchServlet #doDispatchÊñπÊ≥ï12345678910111213if (!mappedHandler.applyPreHandle(processedRequest, response)) &#123; return;&#125;// Actually invoke the handler.mv = ha.handle(processedRequest, response, mappedHandler.getHandler());if (asyncManager.isConcurrentHandlingStarted()) &#123; return;&#125;applyDefaultViewName(processedRequest, mv);mappedHandler.applyPostHandle(processedRequest, response, mv); HandlerExecutionChain#applyPreHandleÂÆûÈôÖ‰∏äË¥£‰ªªÈìæÊ®°ÂºèÔºåÂàÜÂà´ÊâßË°åÊØè‰∏™HandlerInterceptorÁöÑpreHandleÊñπÊ≥ï 1private HandlerInterceptor[] interceptors; 1234567891011121314boolean applyPreHandle(HttpServletRequest request, HttpServletResponse response) throws Exception &#123; HandlerInterceptor[] interceptors = getInterceptors(); if (!ObjectUtils.isEmpty(interceptors)) &#123; for (int i = 0; i &lt; interceptors.length; i++) &#123; HandlerInterceptor interceptor = interceptors[i]; if (!interceptor.preHandle(request, response, this.handler)) &#123; triggerAfterCompletion(request, response, null); return false; &#125; this.interceptorIndex = i; &#125; &#125; return true;&#125; HandlerExecutionChain#applyPostHandle123456789void applyPostHandle(HttpServletRequest request, HttpServletResponse response, ModelAndView mv) throws Exception &#123; HandlerInterceptor[] interceptors = getInterceptors(); if (!ObjectUtils.isEmpty(interceptors)) &#123; for (int i = interceptors.length - 1; i &gt;= 0; i--) &#123; HandlerInterceptor interceptor = interceptors[i]; interceptor.postHandle(request, response, this.handler, mv); &#125; &#125;&#125;]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring-MVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî 01API ÈÖçÁΩÆÔºà‰∏ÄÔºâ‰πãÂ∫îÁî®]]></title>
    <url>%2F2019%2F02%2F11%2F%E7%B2%BE%E5%B0%BD-Dubbo-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E2%80%94%E2%80%94-01API-%E9%85%8D%E7%BD%AE%EF%BC%88%E4%B8%80%EF%BC%89%E4%B9%8B%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[&gt; ÂèãÊÉÖÊèêÁ§∫Ôºå„ÄêÈÖçÁΩÆ„ÄëËøôÂùóÁöÑÂÜÖÂÆπÔºå‰ºöÁõ∏ÂØπÊØîËæÉÊûØÁá•„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÁúãÂà∞‰∏Ä‰∫õÂæàÈöæÊáÇÁöÑÂú∞ÊñπÔºåÂª∫ËÆÆÂÖàË∑≥Ëøá„ÄÇ ÂØπ‰∫é Dubbo ÔºåÈáçÁÇπÊòØË¶ÅÂéªÁêÜËß£ÔºåÂ§öÂçèËÆÆ„ÄÅRPC„ÄÅÂÆπÈîôÁ≠âÁ≠âÊ®°ÂùóÔºåËÄå‰∏çÊòØ„ÄêÈÖçÁΩÆ„Äë„ÄÇ 1. Ê¶ÇËø∞Êàë‰ª¨ÈÉΩ‚ÄúÁü•ÈÅì‚ÄùÔºåDubbo ÁöÑÈÖçÁΩÆÊòØÈùûÂ∏∏‚ÄúÁÅµÊ¥ª‚ÄùÁöÑ„ÄÇ ‰æãÂ¶ÇÔºåÁõÆÂâçÊèê‰æõ‰∫ÜÂõõÁßçÈÖçÁΩÆÊñπÂºèÔºö API ÈÖçÁΩÆ Â±ûÊÄßÈÖçÁΩÆ XML ÈÖçÁΩÆ Ê≥®Ëß£ÈÖçÁΩÆ psÔºöüôÇ ÂêéÁª≠ÁöÑÂá†ÁØáÊñáÁ´†‰πüÊòØÊåâÁÖßËøôÊ†∑ÁöÑÈ°∫Â∫èÔºåËß£Êûê Dubbo ÈÖçÁΩÆÁöÑÊ∫êÁ†Å„ÄÇ ÂÜç‰æãÂ¶ÇÔºåÂèØÁÅµÊ¥ªËÆæÁΩÆÁöÑÈÖçÁΩÆÈ°πÔºö FROM „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî schema ÈÖçÁΩÆÂèÇËÄÉÊâãÂÜå„Äã ÊâÄÊúâÈÖçÁΩÆÈ°πÂàÜ‰∏∫‰∏âÂ§ßÁ±ªÔºåÂèÇËßÅ‰∏ãË°®‰∏≠ÁöÑ‚Äù‰ΩúÁî®‚Äù‰∏ÄÂàó„ÄÇ ÊúçÂä°ÂèëÁé∞ÔºöË°®Á§∫ËØ•ÈÖçÁΩÆÈ°πÁî®‰∫éÊúçÂä°ÁöÑÊ≥®ÂÜå‰∏éÂèëÁé∞ÔºåÁõÆÁöÑÊòØËÆ©Ê∂àË¥πÊñπÊâæÂà∞Êèê‰æõÊñπ„ÄÇ ÊúçÂä°Ê≤ªÁêÜÔºöË°®Á§∫ËØ•ÈÖçÁΩÆÈ°πÁî®‰∫éÊ≤ªÁêÜÊúçÂä°Èó¥ÁöÑÂÖ≥Á≥ªÔºåÊàñ‰∏∫ÂºÄÂèëÊµãËØïÊèê‰æõ‰æøÂà©Êù°‰ª∂„ÄÇ ÊÄßËÉΩË∞É‰ºòÔºöË°®Á§∫ËØ•ÈÖçÁΩÆÈ°πÁî®‰∫éË∞É‰ºòÊÄßËÉΩÔºå‰∏çÂêåÁöÑÈÄâÈ°πÂØπÊÄßËÉΩ‰ºö‰∫ßÁîüÂΩ±Âìç„ÄÇ ÊâÄÊúâÈÖçÁΩÆÊúÄÁªàÈÉΩÂ∞ÜËΩ¨Êç¢‰∏∫ Dubbo URL Ë°®Á§∫ÔºåÂπ∂Áî±ÊúçÂä°Êèê‰æõÊñπÁîüÊàêÔºåÁªèÊ≥®ÂÜå‰∏≠ÂøÉ‰º†ÈÄíÁªôÊ∂àË¥πÊñπÔºåÂêÑÂ±ûÊÄßÂØπÂ∫î URL ÁöÑÂèÇÊï∞ÔºåÂèÇËßÅÈÖçÁΩÆÈ°π‰∏ÄËßàË°®‰∏≠ÁöÑ ‚ÄúÂØπÂ∫îURLÂèÇÊï∞‚Äù Âàó„ÄÇ psÔºöüôÇ ÂèØËÉΩËΩ¨Êç¢Êàê Dubbo URL ‰∏çÂ§™Â•ΩÁêÜËß£„ÄÇËâØÂøÉÂ¶ÇÁ¨îËÄÖÔºåÂêéÁª≠ÊúâÊñáÁ´†‰ºöË¥Ø‰∏≤ÂÆÉ„ÄÇ ÂΩìÁÑ∂ÔºåÂá°‰∫ãÈÉΩÊúâ‰∏§Èù¢ÊÄßÔºåÂú®Á§æÂå∫Èáå‰πüÂ≠òÂú®Âª∫ËÆÆÁöÑÂ£∞Èü≥Ôºå‰æãÂ¶ÇÔºö„ÄäISSUE#738ÔºöXMLÈÖçÁΩÆÈ°πÈáçÊñ∞Ê¢≥ÁêÜ„Äã Ôºö ÁõÆÂâçÊúâ‰∏Ä‰∫õÈÖçÁΩÆÈ°πÂ≠òÂú®Êö¥Èú≤ÁöÑ‰ΩçÁΩÆ‰∏çÊ≠£Á°Æ„ÄÅÊö¥Èú≤‰∏çÂÖ®Èù¢„ÄÅÊñáÊ°£ÂíåÂê´‰πâ‰∏çÂåπÈÖçÁ≠âÈóÆÈ¢òÔºåÊúüÊúõÂú®2.5.7ÁâàÊú¨Â∞ÜÂ∑≤Áü•ÈóÆÈ¢ò‰∫à‰ª•Êï¥ÁêÜ‰øÆÂ§ç Â¶ÇÊûú‰ΩøÁî®‰∏≠ÊúâÈÅáÂà∞ÁöÑÈÖçÁΩÆÈóÆÈ¢òÔºåËØ∑Âú®ËØÑËÆ∫‰∏≠ÂàóÂá∫‰ª•‰æøÊîπËøõ 2. ÈÖçÁΩÆ‰∏ÄËßàÊàë‰ª¨Êù•ÁúãÁúã dubbo-config-api ÁöÑÈ°πÁõÆÁªìÊûÑÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ‰∏ÄËÑ∏ÊáµÈÄºÔºåÂ•ΩÂ§öÂïä„ÄÇ‰∏ãÈù¢Êàë‰ª¨Êù•Êï¥ÁêÜ‰∏ãÈÖçÁΩÆ‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö FROM „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî XML ÈÖçÁΩÆ„Äã ‰ªéËøôÂº†Âõæ‰∏≠ÔºåÂèØ‰ª•ÁúãÂá∫ÂàÜÊàêÂõõ‰∏™ÈÉ®ÂàÜÔºö application-shared provider-side consumer-side sub-config ÂÆûÈôÖ‰∏äÔºå‰∏äÂõæÂíåÁõÆÂâçÁâàÊú¨ÁöÑ‰ª£Á†Å‰ºöÂ≠òÂú®‰∏ÄÁÇπÁÇπÂá∫ÂÖ•ÔºåÊàë‰ª¨Âú®ÁúãÁúãÂÆûÈôÖÁöÑÁ±ªÂÖ≥Á≥ªÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Á∫¢ÂãæÈÉ®ÂàÜÔºåapplication-shared ÔºåÂú®Êú¨ÊñáËøõË°åÂàÜ‰∫´„ÄÇ ÈªÑÊ°ÜÈÉ®ÂàÜÔºåprovider-side ÔºåÂú® „ÄäAPI ÈÖçÁΩÆÔºà‰∫åÔºâ‰πãÊúçÂä°Êèê‰æõËÄÖ„Äã ÂàÜ‰∫´„ÄÇ Á∫¢Ê°ÜÈÉ®ÂàÜÔºåconsumer-side ÔºåÂú® „ÄäAPI ÈÖçÁΩÆÔºà‰∏âÔºâ‰πãÊúçÂä°Ê∂àË¥πËÄÖ„Äã ÂàÜ‰∫´„ÄÇ ÂÖ∂‰ªñÈÉ®ÂàÜÔºåsub-config ÔºåÂú® „ÄäAPI ÈÖçÁΩÆÔºà‰∫åÔºâ‰πãÊúçÂä°Êèê‰æõËÄÖ„Äã ÂàÜ‰∫´„ÄÇ 3. ConfigÊàë‰ª¨ÂÖàÊù•Áúã‰∏ÄÊÆµ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî API ÈÖçÁΩÆ„Äã ÔºåÊèê‰æõÁöÑÊ∂àË¥πËÄÖÁöÑÂàùÂßãÂåñ‰ª£Á†ÅÔºö 123456789101112131415161718192021// ÂΩìÂâçÂ∫îÁî®ÈÖçÁΩÆApplicationConfig application = new ApplicationConfig();application.setName("yyy");// ËøûÊé•Ê≥®ÂÜå‰∏≠ÂøÉÈÖçÁΩÆRegistryConfig registry = new RegistryConfig();registry.setAddress("10.20.130.230:9090");registry.setUsername("aaa");registry.setPassword("bbb");// Ê≥®ÊÑèÔºöReferenceConfig‰∏∫ÈáçÂØπË±°ÔºåÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü‰∏éÊ≥®ÂÜå‰∏≠ÂøÉÁöÑËøûÊé•Ôºå‰ª•Âèä‰∏éÊúçÂä°Êèê‰æõÊñπÁöÑËøûÊé•// ÂºïÁî®ËøúÁ®ãÊúçÂä°ReferenceConfig&lt;XxxService&gt; reference = new ReferenceConfig&lt;XxxService&gt;(); // Ê≠§ÂÆû‰æãÂæàÈáçÔºåÂ∞ÅË£Ö‰∫Ü‰∏éÊ≥®ÂÜå‰∏≠ÂøÉÁöÑËøûÊé•‰ª•Âèä‰∏éÊèê‰æõËÄÖÁöÑËøûÊé•ÔºåËØ∑Ëá™Ë°åÁºìÂ≠òÔºåÂê¶ÂàôÂèØËÉΩÈÄ†ÊàêÂÜÖÂ≠òÂíåËøûÊé•Ê≥ÑÊºèreference.setApplication(application);reference.setRegistry(registry); // Â§ö‰∏™Ê≥®ÂÜå‰∏≠ÂøÉÂèØ‰ª•Áî®setRegistries()reference.setInterface(XxxService.class);reference.setVersion("1.0.0");// ÂíåÊú¨Âú∞bean‰∏ÄÊ†∑‰ΩøÁî®xxxServiceXxxService xxxService = reference.get(); // Ê≥®ÊÑèÔºöÊ≠§‰ª£ÁêÜÂØπË±°ÂÜÖÈÉ®Â∞ÅË£Ö‰∫ÜÊâÄÊúâÈÄöËÆØÁªÜËäÇÔºåÂØπË±°ËæÉÈáçÔºåËØ∑ÁºìÂ≠òÂ§çÁî® ÂèØ‰ª•ÁúãÂà∞ÔºåÂàõÂª∫‰∫Ü ApplicationConfig Âíå RegistryConfig ÂØπË±°ÔºåËÆæÁΩÆÂà∞ ReferenceConfig ÂØπË±°„ÄÇ Â¶ÇÊûúÂàõÂª∫ ModuleConfig Êàñ MonitorConfig ÂØπË±°Ôºå‰πüÊòØÂèØ‰ª•ËÆæÁΩÆÂà∞ ReferenceConfig ÂØπË±°‰∏≠„ÄÇ 3.1 AbstractConfigcom.alibaba.dubbo.config.AbstractConfig ÔºåÊäΩË±°ÈÖçÁΩÆÁ±ªÔºåÈô§‰∫Ü ArgumentConfig ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÊâÄÊúâÁöÑÈÖçÁΩÆÁ±ªÈÉΩÁªßÊâøËØ•Á±ª„ÄÇ AbstractConfig ‰∏ªË¶ÅÊèê‰æõÈÖçÁΩÆËß£Êûê‰∏éÊ†°È™åÁõ∏ÂÖ≥ÁöÑÂ∑•ÂÖ∑ÊñπÊ≥ï„ÄÇ‰∏ãÈù¢Êàë‰ª¨ÂºÄÂßãÁúãÁúãÂÆÉÁöÑ‰ª£Á†Å„ÄÇ id Â±ûÊÄßÔºåÈÖçÁΩÆÂØπË±°ÁöÑÁºñÂè∑ÔºåÈÄÇÁî®‰∫éÈô§‰∫Ü API ÈÖçÁΩÆ‰πãÂ§ñÁöÑ‰∏âÁßçÈÖçÁΩÆÊñπÂºèÔºåÊ†áËÆ∞‰∏Ä‰∏™ÈÖçÁΩÆÂØπË±°ÔºåÂèØÁî®‰∫éÂØπË±°‰πãÈó¥ÁöÑÂºïÁî®„ÄÇ‰æãÂ¶Ç XML ÁöÑ &lt;dubbo:service provider=&quot;${PROVIDER_ID}&quot;&gt; ÔºåÂÖ∂‰∏≠ provider ‰∏∫ &lt;dubbo:provider&gt; ÁöÑ ID Â±ûÊÄß„ÄÇ ÈÇ£‰∏∫‰ªÄ‰πàËØ¥‰∏çÈÄÇÁî® API ÈÖçÁΩÆÂë¢ÔºüÁõ¥Êé• #setXXX(config) ÂØπË±°Âç≥ÂèØ„ÄÇ ÈÖçÁΩÆÈ°πÊ†°È™åÁöÑÂ∑•ÂÖ∑ÊñπÊ≥ïÔºå‰æãÂ¶ÇÂ±ûÊÄßÂÄºÈïøÂ∫¶ÈôêÂà∂„ÄÅÊ†ºÂºèÈôêÂà∂Á≠âÁ≠âÔºåÊØîËæÉÁÆÄÂçï„ÄÇÁõ∏ÂÖ≥‰ª£Á†ÅÂ¶Ç‰∏ãÔºö ÈùôÊÄÅÂ±ûÊÄß ÈùôÊÄÅÊñπÊ≥ï #appendParameters(parameters, config, prefix) ÊñπÊ≥ïÔºåÂ∞ÜÈÖçÁΩÆÂØπË±°ÁöÑÂ±ûÊÄßÔºåÊ∑ªÂä†Âà∞ÂèÇÊï∞ÈõÜÂêà„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ã Ôºö Âú®ÁúãÂÖ∑‰Ωì‰ª£Á†Å‰πãÂâçÔºåÊàë‰ª¨ÂÖàÊù•‰∫ÜËß£ „Äå4. URL„Äç Âíå „Äå5. @Parameter„Äç „ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970 1: protected static void appendParameters(Map&lt;String, String&gt; parameters, Object config, String prefix) &#123; 2: if (config == null) &#123; 3: return; 4: &#125; 5: Method[] methods = config.getClass().getMethods(); 6: for (Method method : methods) &#123; 7: try &#123; 8: String name = method.getName(); 9: if ((name.startsWith("get") || name.startsWith("is"))10: &amp;&amp; !"getClass".equals(name)11: &amp;&amp; Modifier.isPublic(method.getModifiers())12: &amp;&amp; method.getParameterTypes().length == 013: &amp;&amp; isPrimitive(method.getReturnType())) &#123; // ÊñπÊ≥ï‰∏∫Ëé∑ÂèñÂü∫Êú¨Á±ªÂûãÔºåpublic ÁöÑ getting ÊñπÊ≥ï„ÄÇ14: Parameter parameter = method.getAnnotation(Parameter.class);15: if (method.getReturnType() == Object.class || parameter != null &amp;&amp; parameter.excluded()) &#123;16: continue;17: &#125;18: // Ëé∑ÂæóÂ±ûÊÄßÂêç19: int i = name.startsWith("get") ? 3 : 2;20: String prop = StringUtils.camelToSplitName(name.substring(i, i + 1).toLowerCase() + name.substring(i + 1), ".");21: String key;22: if (parameter != null &amp;&amp; parameter.key() != null &amp;&amp; parameter.key().length() &gt; 0) &#123;23: key = parameter.key();24: &#125; else &#123;25: key = prop;26: &#125;27: // Ëé∑ÂæóÂ±ûÊÄßÂÄº28: Object value = method.invoke(config, new Object[0]);29: String str = String.valueOf(value).trim();30: if (value != null &amp;&amp; str.length() &gt; 0) &#123;31: // ËΩ¨‰πâ32: if (parameter != null &amp;&amp; parameter.escaped()) &#123;33: str = URL.encode(str);34: &#125;35: // ÊãºÊé•ÔºåËØ¶ÁªÜËØ¥ÊòéÂèÇËßÅ `Parameter#append()` ÊñπÊ≥ïÁöÑËØ¥Êòé„ÄÇ36: if (parameter != null &amp;&amp; parameter.append()) &#123;37: String pre = parameters.get(Constants.DEFAULT_KEY + "." + key); // default. ÈáåËé∑ÂèñÔºåÈÄÇÁî®‰∫é ServiceConfig =„ÄãProviderConfig „ÄÅReferenceConfig =„ÄãConsumerConfig „ÄÇ38: if (pre != null &amp;&amp; pre.length() &gt; 0) &#123;39: str = pre + "," + str;40: &#125;41: pre = parameters.get(key); // ÈÄöËøá `parameters` Â±ûÊÄßÈÖçÁΩÆÔºå‰æãÂ¶Ç `AbstractMethodConfig.parameters` „ÄÇ42: if (pre != null &amp;&amp; pre.length() &gt; 0) &#123;43: str = pre + "," + str;44: &#125;45: &#125;46: if (prefix != null &amp;&amp; prefix.length() &gt; 0) &#123;47: key = prefix + "." + key;48: &#125;49: parameters.put(key, str);50: // System.out.println("kv:" + key + "\t" + str);51: &#125; else if (parameter != null &amp;&amp; parameter.required()) &#123;52: throw new IllegalStateException(config.getClass().getSimpleName() + "." + key + " == null");53: &#125;54: &#125; else if ("getParameters".equals(name)55: &amp;&amp; Modifier.isPublic(method.getModifiers())56: &amp;&amp; method.getParameterTypes().length == 057: &amp;&amp; method.getReturnType() == Map.class) &#123; // `#getParameters()` ÊñπÊ≥ï58: Map&lt;String, String&gt; map = (Map&lt;String, String&gt;) method.invoke(config, new Object[0]);59: if (map != null &amp;&amp; map.size() &gt; 0) &#123;60: String pre = (prefix != null &amp;&amp; prefix.length() &gt; 0 ? prefix + "." : "");61: for (Map.Entry&lt;String, String&gt; entry : map.entrySet()) &#123;62: parameters.put(pre + entry.getKey().replace('-', '.'), entry.getValue());63: &#125;64: &#125;65: &#125;66: &#125; catch (Exception e) &#123;67: throw new IllegalStateException(e.getMessage(), e);68: &#125;69: &#125;70: &#125; parameters ÔºåÂèÇÊï∞ÈõÜÂêà„ÄÇÂÆûÈôÖ‰∏äÔºåËØ•ÈõÜÂêà‰ºöÁî®‰∫é URL.parameters „ÄÇ config ÔºåÈÖçÁΩÆÂØπË±°„ÄÇ prefix ÔºåÂ±ûÊÄßÂâçÁºÄ„ÄÇÁî®‰∫éÈÖçÁΩÆÈ°πÊ∑ªÂä†Âà∞ parameters ‰∏≠Êó∂ÁöÑÂâçÁºÄ„ÄÇ Á¨¨ 5 Ë°åÔºöËé∑ÂæóÊâÄÊúâÊñπÊ≥ïÁöÑÊï∞ÁªÑÔºå‰∏∫‰∏ãÈù¢ÈÄöËøáÂèçÂ∞ÑËé∑ÂæóÈÖçÁΩÆÈ°πÁöÑÂÄºÂÅöÂáÜÂ§á„ÄÇ Á¨¨ 6 Ë°åÔºöÂæ™ÁéØÊØè‰∏™ÊñπÊ≥ï„ÄÇ Á¨¨ 9 Ëá≥ 13 Ë°åÔºöÊñπÊ≥ï‰∏∫Ëé∑Âæó Âü∫Êú¨Á±ªÂûã + 1public ÁöÑ getting ÊñπÊ≥ï„ÄÇ Á¨¨ 14 Ëá≥ 17 Ë°åÔºöËøîÂõûÂÄºÁ±ªÂûã‰∏∫ Object ÊàñÊéíÈô§( `@Parameter.exclue=true` )ÁöÑÈÖçÁΩÆÈ°πÔºåË∑≥Ëøá„ÄÇ Á¨¨ 19 Ëá≥ 26 Ë°åÔºöËé∑ÂæóÈÖçÁΩÆÈ°πÂêç„ÄÇ Á¨¨ 28 Ëá≥ 48 Ë°åÔºöËé∑ÂæóÈÖçÁΩÆÈ°πÂÄº„ÄÇ‰∏≠Èó¥Êúâ‰∏Ä‰∫õÈÄªËæëÂ§ÑÁêÜÔºåËÉñÂèãÁúã‰∏ã‰ª£Á†ÅÁöÑÊ≥®Èáä„ÄÇ Á¨¨ 49 Ë°åÔºöÊ∑ªÂä†ÈÖçÁΩÆÈ°πÂà∞ parameters „ÄÇ Á¨¨ 51 Ëá≥ 53 Ë°åÔºöÂΩì `@Parameter.required = true` Êó∂ÔºåÊ†°È™åÈÖçÁΩÆÈ°πÈùûÁ©∫„ÄÇ Á¨¨ 54 Ëá≥ 57 Ë°åÔºöÂΩìÊñπÊ≥ï‰∏∫ 1#getParameters() Êó∂Ôºå ‰æãÂ¶Ç „ÄÇ Á¨¨ 58 Ë°åÔºöÈÄöËøáÂèçÂ∞ÑÔºåËé∑Âæó #getParameters() ÁöÑËøîÂõûÂÄº‰∏∫ map „ÄÇ Á¨¨ 59 Ëá≥ 64 Ë°åÔºöÂ∞Ü map Ê∑ªÂä†Âà∞ parameters Ôºåkv Ê†ºÂºè‰∏∫ prefix:entry.key entry.value „ÄÇ Âõ†Ê≠§ÔºåÈÄöËøá #getParameters() ÂØπÂ∫îÁöÑÂ±ûÊÄßÔºåÂä®ÊÄÅËÆæÁΩÆÈÖçÁΩÆÈ°πÔºåÊãìÂ±ïÂá∫Èùû Dubbo ÂÜÖÁΩÆÂ•ΩÁöÑÈÄªËæë„ÄÇ #appendAttributes(parameters, config, prefix) ÊñπÊ≥ïÔºåÂ∞Ü @Parameter(attribute = true) ÈÖçÁΩÆÂØπË±°ÁöÑÂ±ûÊÄßÔºåÊ∑ªÂä†Âà∞ÂèÇÊï∞ÈõÜÂêà„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738 1: protected static void appendAttributes(Map&lt;Object, Object&gt; parameters, Object config, String prefix) &#123; 2: if (config == null) &#123; 3: return; 4: &#125; 5: Method[] methods = config.getClass().getMethods(); 6: for (Method method : methods) &#123; 7: try &#123; 8: String name = method.getName(); 9: if ((name.startsWith("get") || name.startsWith("is"))10: &amp;&amp; !"getClass".equals(name)11: &amp;&amp; Modifier.isPublic(method.getModifiers())12: &amp;&amp; method.getParameterTypes().length == 013: &amp;&amp; isPrimitive(method.getReturnType())) &#123; // ÊñπÊ≥ï‰∏∫Ëé∑ÂèñÂü∫Êú¨Á±ªÂûãÔºåpublic ÁöÑ getting ÊñπÊ≥ï„ÄÇ14: Parameter parameter = method.getAnnotation(Parameter.class);15: if (parameter == null || !parameter.attribute())16: continue;17: // Ëé∑ÂæóÂ±ûÊÄßÂêç18: String key;19: if (parameter != null &amp;&amp; parameter.key() != null &amp;&amp; parameter.key().length() &gt; 0) &#123;20: key = parameter.key();21: &#125; else &#123;22: int i = name.startsWith("get") ? 3 : 2;23: key = name.substring(i, i + 1).toLowerCase() + name.substring(i + 1);24: &#125;25: // Ëé∑ÂæóÂ±ûÊÄßÂÄºÔºåÂ≠òÂú®ÂàôÊ∑ªÂä†Âà∞ `parameters` ÈõÜÂêà26: Object value = method.invoke(config, new Object[0]);27: if (value != null) &#123;28: if (prefix != null &amp;&amp; prefix.length() &gt; 0) &#123;29: key = prefix + "." + key;30: &#125;31: parameters.put(key, value);32: &#125;33: &#125;34: &#125; catch (Exception e) &#123;35: throw new IllegalStateException(e.getMessage(), e);36: &#125;37: &#125;38: &#125; ‰∏çÂêå‰∫é #appendAttributes(parameters, config, prefix) ÊñπÊ≥ïÔºå‰∏ªË¶ÅÁî®‰∫é „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ‰∫ã‰ª∂ÈÄöÁü•„Äã ÔºåÊ≥®Ëß£ @Parameter(attribute = true) ÁöÑÂ±ûÊÄßÂ¶Ç‰∏ãÂõæÔºö Á¨¨ 9 Ëá≥ 13 Ë°åÔºöÊñπÊ≥ï‰∏∫Ëé∑ÂæóÂü∫Êú¨Á±ªÂûã + public ÁöÑ getting ÊñπÊ≥ï„ÄÇ Á¨¨ 14 Ëá≥ 16 Ë°åÔºöÈúÄË¶Å( `@Parameter.exclue=true` )ÁöÑÈÖçÁΩÆÈ°π„ÄÇ Á¨¨ 17 Ëá≥ 24 Ë°åÔºöËé∑ÂæóÈÖçÁΩÆÈ°πÂêç„ÄÇ Á¨¨ 26 Ëá≥ 30 Ë°åÔºöËé∑ÂæóÈÖçÁΩÆÈ°πÂÄº„ÄÇ Á¨¨ 31 Ë°åÔºöÊ∑ªÂä†ÈÖçÁΩÆÈ°πÂà∞ parameters „ÄÇ #appendProperties(config) ÊñπÊ≥ïÔºåËØªÂèñÁéØÂ¢ÉÂèòÈáèÂíå properties ÈÖçÁΩÆÂà∞ÈÖçÁΩÆÂØπË±°„ÄÇÂú® „ÄäÁ≤æËøõ Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî Â±ûÊÄßÈÖçÁΩÆ„Äã ËØ¶ÁªÜËß£Êûê„ÄÇ #appendAnnotation(annotationClass, annotation) ÊñπÊ≥ïÔºåËØªÂèñÊ≥®Ëß£ÈÖçÁΩÆÂà∞ÈÖçÁΩÆÂØπË±°„ÄÇÂú® „ÄäÁ≤æËøõ Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî Ê≥®Ëß£ÈÖçÁΩÆ„Äã ËØ¶ÁªÜËß£Êûê„ÄÇ 3.2 ApplicationConfigcom.alibaba.dubbo.config.ApplicationConfig ÔºåÂ∫îÁî®ÈÖçÁΩÆ„ÄÇ ÂÖ∑‰ΩìÂ±ûÊÄßÁöÑËß£ÈáäÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo:application„Äã ÊñáÊ°£„ÄÇ 3.3 RegistryConfigcom.alibaba.dubbo.config.RegistryConfig ÔºåÊ≥®ÂÜå‰∏≠ÂøÉÈÖçÁΩÆ„ÄÇ ÂÖ∑‰ΩìÂ±ûÊÄßÁöÑËß£ÈáäÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo:registry„Äã ÊñáÊ°£„ÄÇ 3.4 ModuleConfigcom.alibaba.dubbo.config.ModuleConfig ÔºåÊ®°Âùó‰ø°ÊÅØÈÖçÁΩÆ„ÄÇ ÂÖ∑‰ΩìÂ±ûÊÄßÁöÑËß£ÈáäÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo:module„Äã ÊñáÊ°£„ÄÇ 3.5 MonitorConfigcom.alibaba.dubbo.config.MonitorConfig ÔºåÁõëÊéß‰∏≠ÂøÉÈÖçÁΩÆ„ÄÇ ÂÖ∑‰ΩìÂ±ûÊÄßÁöÑËß£ÈáäÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo:monitor„Äã ÊñáÊ°£„ÄÇ 3.6 ArgumentConfigcom.alibaba.dubbo.config.ArgumentConfig ÔºåÊñπÊ≥ïÂèÇÊï∞ÈÖçÁΩÆ„ÄÇ ÂÖ∑‰ΩìÂ±ûÊÄßÁöÑËß£ÈáäÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo:argument„Äã ÊñáÊ°£„ÄÇ ËØ•ÈÖçÁΩÆÁ±ªËÆæÁΩÆÂà∞ MethodConfig ÂØπË±°‰∏≠ÔºåÂú® „ÄäAPI ÈÖçÁΩÆÔºà‰∫åÔºâ‰πãÊúçÂä°Êèê‰æõËÄÖ„Äã Êàë‰ª¨‰ºöÁúãÂà∞„ÄÇ Âú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂèÇÊï∞ÂõûË∞É„Äã ÁâπÊÄß‰∏≠‰ΩøÁî®„ÄÇ 4. URLcom.alibaba.dubbo.common.URL ÔºåDubbo URL „ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536public final class URL implements Serializable &#123; /** * ÂçèËÆÆÂêç */ private final String protocol; /** * Áî®Êà∑Âêç */ private final String username; /** * ÂØÜÁ†Å */ private final String password; /** * by default, host to registry * Âú∞ÂùÄ */ private final String host; /** * by default, port to registry * Á´ØÂè£ */ private final int port; /** * Ë∑ØÂæÑÔºàÊúçÂä°ÂêçÔºâ */ private final String path; /** * ÂèÇÊï∞ÈõÜÂêà */ private final Map&lt;String, String&gt; parameters; // ... ÁúÅÁï•ÂÖ∂‰ªñ‰ª£Á†Å&#125; ‰∏äÊñáÊàë‰ª¨ÊèêÂà∞ÊâÄÊúâÈÖçÁΩÆÊúÄÁªàÈÉΩÂ∞ÜËΩ¨Êç¢‰∏∫ Dubbo URL Ë°®Á§∫ÔºåÂπ∂Áî±ÊúçÂä°Êèê‰æõÊñπÁîüÊàêÔºåÁªèÊ≥®ÂÜå‰∏≠ÂøÉ‰º†ÈÄíÁªôÊ∂àË¥πÊñπÔºåÂêÑÂ±ûÊÄßÂØπÂ∫î URL ÁöÑÂèÇÊï∞ÔºåÂèÇËßÅÈÖçÁΩÆÈ°π‰∏ÄËßàË°®‰∏≠ÁöÑ ‚ÄúÂØπÂ∫îURLÂèÇÊï∞‚Äù Âàó„ÄÇÈÇ£‰πà‰∏Ä‰∏™ Service Ê≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊ†ºÂºèÂ¶Ç‰∏ãÔºö 1dubbo://192.168.3.17:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&amp;application=demo-provider&amp;default.delay=-1&amp;default.retries=0&amp;default.service.filter=demoFilter&amp;delay=-1&amp;dubbo=2.0.0&amp;generic=false&amp;interface=com.alibaba.dubbo.demo.DemoService&amp;methods=sayHello&amp;pid=19031&amp;side=provider&amp;timestamp=1519651641799 Ê†ºÂºè‰∏∫ protocol://username:password@host:port/path?key=value&amp;key=value ÔºåÈÄöËøá URL#buildString(...) ÊñπÊ≥ïÁîüÊàê„ÄÇ parameters Â±ûÊÄßÔºåÂèÇÊï∞ÈõÜÂêà„ÄÇ‰ªé‰∏äÈù¢ÁöÑ Service URL ‰æãÂ≠êÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÈáåÈù¢ÁöÑ key=value ÔºåÂÆûÈôÖ‰∏äÂ∞±ÊòØ Service ÂØπÂ∫îÁöÑÈÖçÁΩÆÈ°π„ÄÇËØ•Â±ûÊÄßÔºåÈÄöËøá AbstractConfig#appendParameters(parameters, config, prefix) ÊñπÊ≥ïÁîüÊàê„ÄÇ üôÇ Âú®ÂêéÁª≠ÁöÑÊñáÁ´†‰∏≠ÔºåÊàë‰ª¨‰ºöÂèëÁé∞ URL ‰Ωú‰∏∫‰∏Ä‰∏™ÈÄöÁî®Ê®°ÂûãÔºåË¥ØÁ©øÊï¥‰∏™ RPC ÊµÅÁ®ã„ÄÇ 5. @Parametercom.alibaba.dubbo.config.support.@Parameter ÔºåParameter ÂèÇÊï∞Ê≥®Ëß£ÔºåÁî®‰∫é Dubbo URL ÁöÑ parameters ÊãºÊé•„ÄÇ Âú®ÈÖçÁΩÆÂØπË±°ÁöÑ getting ÊñπÊ≥ï‰∏äÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ËØ•Ê≥®Ëß£ÁöÑ‰ΩøÁî®Ôºå‰æãÂ¶Ç‰∏ãÂõæÔºö @Parameter ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@Documented@Retention(RetentionPolicy.RUNTIME)@Target(&#123;ElementType.METHOD&#125;)public @interface Parameter &#123; /** * ÈîÆÔºàÂà´ÂêçÔºâ */ String key() default ""; /** * ÊòØÂê¶ÂøÖÂ°´ */ boolean required() default false; /** * ÊòØÂê¶ÂøΩÁï• */ boolean excluded() default false; /** * ÊòØÂê¶ËΩ¨‰πâ */ boolean escaped() default false; /** * ÊòØÂê¶‰∏∫Â±ûÊÄß * * ÁõÆÂâçÁî®‰∫é„Ää‰∫ã‰ª∂ÈÄöÁü•„Äãhttp://dubbo.apache.org/zh-cn/docs/user/demos/events-notify.html */ boolean attribute() default false; /** * ÊòØÂê¶ÊãºÊé•ÈªòËÆ§Â±ûÊÄßÔºåÂèÇËßÅ &#123;@link com.alibaba.dubbo.config.AbstractConfig#appendParameters(Map, Object, String)&#125; ÊñπÊ≥ï„ÄÇ * * Êàë‰ª¨Êù•ÁúãÁúã `#append() = true` ÁöÑÂ±ûÊÄßÔºåÊúâÂ¶Ç‰∏ãÂõõ‰∏™Ôºö * + &#123;@link AbstractInterfaceConfig#getFilter()&#125; * + &#123;@link AbstractInterfaceConfig#getListener()&#125; * + &#123;@link AbstractReferenceConfig#getFilter()&#125; * + &#123;@link AbstractReferenceConfig#getListener()&#125; * + &#123;@link AbstractServiceConfig#getFilter()&#125; * + &#123;@link AbstractServiceConfig#getListener()&#125; * ÈÇ£‰πàÔºå‰ª• AbstractServiceConfig ‰∏æ‰æãÂ≠ê„ÄÇ * * Êàë‰ª¨Áü•ÈÅì ProviderConfig Âíå ServiceConfig ÁªßÊâø AbstractServiceConfig Á±ªÔºåÈÇ£‰πà `filter` , `listener` ÂØπÂ∫îÁöÑÁõ∏ÂêåÁöÑÈîÆ„ÄÇ * ‰∏ãÈù¢Êàë‰ª¨‰ª• `filter` ‰∏æ‰æãÂ≠ê„ÄÇ * * Âú® ServiceConfig ‰∏≠ÔºåÈªòËÆ§‰ºö&lt;b&gt;ÁªßÊâø&lt;/b&gt; ProviderConfig ÈÖçÁΩÆÁöÑ `filter` Âíå `listener` „ÄÇ * ÊâÄ‰ª•Ëøô‰∏™Â±ûÊÄßÔºåÂ∞±ÊòØÁî®‰∫éÔºåÂÉè ServiceConfig ÁöÑËøôÁßçÊÉÖÂÜµÔºå‰ªé ProviderConfig ËØªÂèñÁà∂Â±ûÊÄß„ÄÇ * * ‰∏æ‰∏™‰æãÂ≠êÔºåÂ¶ÇÊûú `ProviderConfig.filter=aaaFilter` Ôºå`ServiceConfig.filter=bbbFilter` ÔºåÊúÄÁªàÊö¥Èú≤Âà∞ Dubbo URL Êó∂ÔºåÂèÇÊï∞‰∏∫ `service.filter=aaaFilter,bbbFilter` „ÄÇ */ boolean append() default false; ËÉñÂèãÂèØ‰ª•ÁÆÄÂçïÁúã‰∏ã‰ª£Á†Å‰∏≠ÁöÑÊ≥®ÈáäÔºåÁªìÂêàÂÖ∑‰Ωì‰ΩøÁî®ÁöÑÊñπÊ≥ïÔºåÂú®ÁªÜÁªÜÁêÜËß£„ÄÇ]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî È°πÁõÆÁªìÊûÑ‰∏ÄËßà]]></title>
    <url>%2F2019%2F02%2F11%2F%E7%B2%BE%E5%B0%BD-Dubbo-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E2%80%94%E2%80%94-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E4%B8%80%E8%A7%88%2F</url>
    <content type="text"><![CDATA[1. Ê¶ÇËø∞Êú¨Êñá‰∏ªË¶ÅÂàÜ‰∫´ Dubbo ÁöÑÈ°πÁõÆÁªìÊûÑ„ÄÇÂ∏åÊúõÈÄöËøáÊú¨ÊñáËÉΩËÆ©ËÉñÂèãÂØπ Dubbo ÁöÑÊï¥‰ΩìÈ°πÁõÆÊúâ‰∏™ÁÆÄÂçïÁöÑ‰∫ÜËß£„ÄÇ Âè¶Â§ñÔºåÁ¨îËÄÖ‰ºöÁõ∏ÂØπÂ§ßÈáèÂºïÁî® „ÄäDubbo Áî®Êà∑ÊåáÂçó„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó„Äã ÔºåÂÜôÁöÑÁúüÁöÑÊå∫Â•ΩÁöÑ„ÄÇüôÇpsÔºöÈôê‰∫éÊéíÁâàÔºåÈÉ®ÂàÜÂú∞ÊñπÂºïÁî®‰ºöÂ≠òÂú®Êú™Ê†áÊòéÁöÑÊÉÖÂÜµ„ÄÇ Âú®ÊãâÂèñ Dubbo È°πÁõÆÂêéÔºåÊàë‰ª¨‰ºöÂèëÁé∞ÊãÜÂàÜ‰∫ÜÂ•ΩÂ§ö Maven È°πÁõÆ„ÄÇÊòØ‰∏çÊòØÂÜÖÂøÉ‰∏ÄÁ¥ßÔºå‰∫ßÁîü‰∫ÜÊÅêÊÉßÊÑüÔºü‰∏çË¶ÅÊñπÔºåÊàë‰ª¨Â∞±ÊòØÁªßÁª≠ÊÄº„ÄÇ 2. ‰ª£Á†ÅÁªüËÆ°ËøôÈáåÂÖàÂàÜ‰∫´‰∏Ä‰∏™Â∞èÊäÄÂ∑ß„ÄÇÁ¨îËÄÖÂú®ÂºÄÂßãÊ∫êÁ†ÅÂ≠¶‰π†Êó∂Ôºå‰ºöÈ¶ñÂÖà‰∫ÜËß£È°πÁõÆÁöÑ‰ª£Á†ÅÈáè„ÄÇ Á¨¨‰∏ÄÁßçÊñπÂºèÔºå‰ΩøÁî® IDEA Statistic Êèí‰ª∂ÔºåÁªüËÆ°Êï¥‰Ωì‰ª£Á†ÅÈáè„ÄÇ Êàë‰ª¨ÂèØ‰ª•Á≤óÁï•ÁöÑÁúãÂà∞ÔºåÊÄªÁöÑ‰ª£Á†ÅÈáèÂú® 98210 Ë°å„ÄÇËøôÂÖ∂‰∏≠ËøòÂåÖÊã¨ÂçïÂÖÉÊµãËØïÔºåÁ§∫‰æãÁ≠âÁ≠â‰ª£Á†Å„ÄÇÊâÄ‰ª•Ôºå‰∏çÊÖå„ÄÇ Á¨¨‰∫åÁßçÊñπÂºèÔºå‰ΩøÁî® Shell ËÑöÊú¨ÂëΩ‰ª§ÈÄê‰∏™ Maven Ê®°ÂùóÁªüËÆ° „ÄÇ ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÁ¨îËÄÖ‰ΩøÁî® find . -name &quot;*.java&quot;|xargs cat|grep -v -e ^$ -e ^\s*\/\/.*$|wc -l „ÄÇËøô‰∏™ÂëΩ‰ª§Âè™ËøáÊª§‰∫ÜÈÉ®ÂàÜÊ≥®ÈáäÔºåÊâÄ‰ª•Áõ∏ÊØî IDEA Statistic ‰ºöÂÅèÂ§ö„ÄÇ ÂΩìÁÑ∂ÔºåËÄÉËôëÂà∞ÂáÜÁ°ÆÊÄßÔºåËÉñÂèãÈúÄË¶ÅÊâãÂä® cd Âà∞ÊØè‰∏™ Maven È°πÁõÆÁöÑ src/main/java ÁõÆÂΩï‰∏ãÔºå‰ª•ËææÂà∞ÊéíÈô§ÂçïÂÖÉÊµãËØïÁöÑ‰ª£Á†ÅÈáè„ÄÇ 3. È°πÁõÆ‰∏ÄËßàÂ¶ÇÊûúËÉñÂèãÁúãËøá „ÄäDubbo Ê°ÜÊû∂ËÆæËÆ°„Äã ÔºåÂ∞±‰ºöÂèëÁé∞Êúâ‰∏ãÈù¢ËøôÂº†Âõæ„ÄÇ ÈÄöËøáËøôÂõæÔºåÊàë‰ª¨ÂèØ‰ª•ÂæàÊ∏ÖÊô∞ÁöÑÁü•ÈÅìÂá†‰∏™ Maven Ê®°ÂùóÁöÑ‰æùËµñÂÖ≥Á≥ª„ÄÇ 3.1 dubbo-common dubbo-common ÂÖ¨ÂÖ±ÈÄªËæëÊ®°ÂùóÔºöÊèê‰æõÂ∑•ÂÖ∑Á±ªÂíåÈÄöÁî®Ê®°Âûã„ÄÇ Â∑•ÂÖ∑Á±ªÊØîËæÉÂ•ΩÁêÜËß£ÔºåÈÄöÁî®Ê®°ÂûãÊòØ‰ªÄ‰πàÔºü‰∏æ‰∏™‰æãÂ≠êÔºåcom.alibaba.dubbo.common.URL Ôºö FROM „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÂÖ¨ÂÖ±Â•ëÁ∫¶„Äã ÊâÄÊúâÊâ©Â±ïÁÇπÂèÇÊï∞ÈÉΩÂåÖÂê´ URL ÂèÇÊï∞ÔºåURL ‰Ωú‰∏∫‰∏ä‰∏ãÊñá‰ø°ÊÅØË¥ØÁ©øÊï¥‰∏™Êâ©Â±ïÁÇπËÆæËÆ°‰ΩìÁ≥ª„ÄÇ URL ÈááÁî®Ê†áÂáÜÊ†ºÂºèÔºöprotocol://username:password@host:port/path?key=value&amp;key=value „ÄÇ ÈÇ£‰πà URL Êúâ‰ªÄ‰πàÁî®Âë¢Ôºüüòà ËØ∑ËßÅÂêéÁª≠ÊñáÁ´†„ÄÇ 3.2 dubbo-remoting dubbo-remoting ËøúÁ®ãÈÄö‰ø°Ê®°ÂùóÔºöÊèê‰æõÈÄöÁî®ÁöÑÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´ØÁöÑÈÄöËÆØÂäüËÉΩ„ÄÇ dubbo-remoting-zookeeper ÔºåÁõ∏ÂΩì‰∫é Zookeeper Client ÔºåÂíå Zookeeper Server ÈÄö‰ø°„ÄÇ dubbo-remoting-api Ôºå ÂÆö‰πâ‰∫Ü Dubbo Client Âíå Dubbo Server ÁöÑÊé•Âè£„ÄÇ ÂÆûÁé∞ 1dubbo-remoting-api dubbo-remoting-grizzly ÔºåÂü∫‰∫é Grizzly ÂÆûÁé∞„ÄÇ dubbo-remoting-http ÔºåÂü∫‰∫é Jetty Êàñ Tomcat ÂÆûÁé∞„ÄÇ dubbo-remoting-mina ÔºåÂü∫‰∫é Mina ÂÆûÁé∞„ÄÇ dubbo-remoting-netty ÔºåÂü∫‰∫é Netty 3 ÂÆûÁé∞„ÄÇ dubbo-remoting-netty4 ÔºåÂü∫‰∫é Netty 4 ÂÆûÁé∞„ÄÇ dubbo-remoting-p2p ÔºåP2P ÊúçÂä°Âô®„ÄÇÊ≥®ÂÜå‰∏≠ÂøÉ dubbo-registry-multicast È°πÁõÆÁöÑ‰ΩøÁî®ËØ•È°πÁõÆ„ÄÇ ‰ªéÊúÄÂ∞èÂåñÁöÑËßíÂ∫¶Êù•ÁúãÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÁúãÔºö dubbo-remoting-api + dubbo-remoting-netty4 dubbo-remoting-zookeeper 3.3 dubbo-rpc dubbo-rpc ËøúÁ®ãË∞ÉÁî®Ê®°ÂùóÔºöÊäΩË±°ÂêÑÁßçÂçèËÆÆÔºå‰ª•ÂèäÂä®ÊÄÅ‰ª£ÁêÜÔºåÂè™ÂåÖÂê´‰∏ÄÂØπ‰∏ÄÁöÑË∞ÉÁî®Ôºå‰∏çÂÖ≥ÂøÉÈõÜÁæ§ÁöÑÁÆ°ÁêÜ„ÄÇ ÈõÜÁæ§Áõ∏ÂÖ≥ÁöÑÁÆ°ÁêÜÔºåÁî± dubbo-cluster Êèê‰æõÁâπÊÄß„ÄÇ Âú®ÂõûËøáÂ§¥Áúã‰∏äÈù¢ÁöÑÂõæÔºåÊàë‰ª¨‰ºöÂèëÁé∞Ôºådubbo-rpc ÊòØÊï¥‰∏™ Dubbo ÁöÑ‰∏≠ÂøÉ„ÄÇ dubbo-rpc-api ÔºåÊäΩË±°ÂêÑÁßçÂçèËÆÆ‰ª•ÂèäÂä®ÊÄÅ‰ª£ÁêÜÔºåÂÆûÁé∞‰∫Ü‰∏ÄÂØπ‰∏ÄÁöÑË∞ÉÁî®„ÄÇ ÂÖ∂‰ªñÊ®°ÂùóÔºåÂÆûÁé∞ dubbo-rpc-api ÔºåÊèê‰æõÂØπÂ∫îÁöÑÂçèËÆÆÂÆûÁé∞„ÄÇÂú® „ÄäÁî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂçèËÆÆÂèÇËÄÉÊâãÂÜå„Äã ‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞ÊØèÁßçÂçèËÆÆÁöÑ‰ªãÁªç„ÄÇ Âè¶Â§ñÔºådubbo-rpc-default ÂØπÂ∫î dubbo:// ÂçèËÆÆ„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÂçèËÆÆÊâ©Â±ï„Äã ÊñáÊ°£„ÄÇ Ëøõ‰∏ÄÊ≠•ÁöÑÊãÜËß£ÔºåËßÅ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Ê†∏ÂøÉÊµÅÁ®ã‰∏ÄËßà„Äã ÊñáÁ´†„ÄÇ 3.4 dubbo-cluster dubbo-cluster ÈõÜÁæ§Ê®°ÂùóÔºöÂ∞ÜÂ§ö‰∏™ÊúçÂä°Êèê‰æõÊñπ‰º™Ë£Ö‰∏∫‰∏Ä‰∏™Êèê‰æõÊñπÔºåÂåÖÊã¨ÔºöË¥üËΩΩÂùáË°°, ÈõÜÁæ§ÂÆπÈîôÔºåË∑ØÁî±ÔºåÂàÜÁªÑËÅöÂêàÁ≠â„ÄÇÈõÜÁæ§ÁöÑÂú∞ÂùÄÂàóË°®ÂèØ‰ª•ÊòØÈùôÊÄÅÈÖçÁΩÆÁöÑÔºå‰πüÂèØ‰ª•ÊòØÁî±Ê≥®ÂÜå‰∏≠ÂøÉ‰∏ãÂèë„ÄÇ Ê≥®ÂÜå‰∏≠ÂøÉ‰∏ãÂèëÔºåÁî± dubbo-registry Êèê‰æõÁâπÊÄß„ÄÇ ÂÆπÈîô com.alibaba.dubbo.rpc.cluster.Cluster Êé•Âè£ + com.alibaba.dubbo.rpc.cluster.support ÂåÖ„ÄÇ Cluster Â∞Ü Directory ‰∏≠ÁöÑÂ§ö‰∏™ Invoker ‰º™Ë£ÖÊàê‰∏Ä‰∏™ InvokerÔºåÂØπ‰∏äÂ±ÇÈÄèÊòéÔºå‰º™Ë£ÖËøáÁ®ãÂåÖÂê´‰∫ÜÂÆπÈîôÈÄªËæëÔºåË∞ÉÁî®Â§±Ë¥•ÂêéÔºåÈáçËØïÂè¶‰∏Ä‰∏™„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîô„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÈõÜÁæ§Êâ©Â±ï„Äã ÊñáÊ°£„ÄÇ ÁõÆÂΩï com.alibaba.dubbo.rpc.cluster.Directory Êé•Âè£ + com.alibaba.dubbo.rpc.cluster.directory ÂåÖ„ÄÇ Directory ‰ª£Ë°®‰∫ÜÂ§ö‰∏™ Invoker ÔºåÂèØ‰ª•ÊääÂÆÉÁúãÊàê List Ôºå‰ΩÜ‰∏é List ‰∏çÂêåÁöÑÊòØÔºåÂÆÉÁöÑÂÄºÂèØËÉΩÊòØÂä®ÊÄÅÂèòÂåñÁöÑÔºåÊØîÂ¶ÇÊ≥®ÂÜå‰∏≠ÂøÉÊé®ÈÄÅÂèòÊõ¥„ÄÇ Ë∑ØÁî± com.alibaba.dubbo.rpc.cluster.Router Êé•Âè£ + com.alibaba.dubbo.rpc.cluster.router ÂåÖ„ÄÇ Ë¥üË¥£‰ªéÂ§ö‰∏™ Invoker ‰∏≠ÊåâË∑ØÁî±ËßÑÂàôÈÄâÂá∫Â≠êÈõÜÔºåÊØîÂ¶ÇËØªÂÜôÂàÜÁ¶ªÔºåÂ∫îÁî®ÈöîÁ¶ªÁ≠â„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Ë∑ØÁî±ËßÑÂàô„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Ë∑ØÁî±ÊãìÂ±ï„Äã ÊñáÊ°£„ÄÇ ÈÖçÁΩÆ com.alibaba.dubbo.rpc.cluster.Configurator Êé•Âè£ + com.alibaba.dubbo.rpc.cluster.configurator ÂåÖ„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÈÖçÁΩÆËßÑÂàô„Äã ÊñáÊ°£„ÄÇ Ë¥üËΩΩÂùáË°° com.alibaba.dubbo.rpc.cluster.LoadBalance Êé•Âè£ + com.alibaba.dubbo.rpc.cluster.loadbalance ÂåÖ„ÄÇ LoadBalance Ë¥üË¥£‰ªéÂ§ö‰∏™ Invoker ‰∏≠ÈÄâÂá∫ÂÖ∑‰ΩìÁöÑ‰∏Ä‰∏™Áî®‰∫éÊú¨Ê¨°Ë∞ÉÁî®ÔºåÈÄâÁöÑËøáÁ®ãÂåÖÂê´‰∫ÜË¥üËΩΩÂùáË°°ÁÆóÊ≥ïÔºåË∞ÉÁî®Â§±Ë¥•ÂêéÔºåÈúÄË¶ÅÈáçÈÄâ„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Ë¥üËΩΩÂùáË°°„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Ë¥üËΩΩÂùáË°°ÊãìÂ±ï„Äã ÊñáÊ°£„ÄÇ ÂêàÂπ∂ÁªìÊûú com.alibaba.dubbo.rpc.cluster.Merger Êé•Âè£ + com.alibaba.dubbo.rpc.cluster.merger ÂåÖ„ÄÇ ÂêàÂπ∂ËøîÂõûÁªìÊûúÔºåÁî®‰∫éÂàÜÁªÑËÅöÂêà„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂàÜÁªÑËÅöÂêà„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÂêàÂπ∂ÁªìÊûúÊâ©Â±ï„Äã ÊñáÊ°£„ÄÇ Êï¥‰ΩìÊµÅÁ®ãÂ¶Ç‰∏ãÔºö 3.5 dubbo-registry dubbo-registry Ê≥®ÂÜå‰∏≠ÂøÉÊ®°ÂùóÔºöÂü∫‰∫éÊ≥®ÂÜå‰∏≠ÂøÉ‰∏ãÂèëÂú∞ÂùÄÁöÑÈõÜÁæ§ÊñπÂºèÔºå‰ª•ÂèäÂØπÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÁöÑÊäΩË±°„ÄÇ dubbo-registry-api ÔºåÊäΩË±°Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊ≥®ÂÜå‰∏éÂèëÁé∞Êé•Âè£„ÄÇ ÂÖ∂‰ªñÊ®°ÂùóÔºåÂÆûÁé∞ dubbo-registry-api ÔºåÊèê‰æõÂØπÂ∫îÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÂÆûÁé∞„ÄÇÂú® „ÄäÁî®Êà∑ÊåáÂçó ‚Äî‚Äî Ê≥®ÂÜå‰∏≠ÂøÉÂèÇËÄÉÊâãÂÜå„Äã ‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞ÊØèÁßçÊ≥®ÂÜå‰∏≠ÂøÉÁöÑ‰ªãÁªç„ÄÇ Âè¶Â§ñÔºådubbo-registry-default ÂØπÂ∫î Simple Ê≥®ÂÜå‰∏≠ÂøÉ„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Ê≥®ÂÜå‰∏≠ÂøÉÊâ©Â±ï„Äã ÊñáÊ°£„ÄÇ 3.6 dubbo-monitor dubbo-monitor ÁõëÊéßÊ®°ÂùóÔºöÁªüËÆ°ÊúçÂä°Ë∞ÉÁî®Ê¨°Êï∞ÔºåË∞ÉÁî®Êó∂Èó¥ÁöÑÔºåË∞ÉÁî®ÈìæË∑üË∏™ÁöÑÊúçÂä°„ÄÇ ÊãìÂ±ïÂèÇËßÅ „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÁõëÊéß‰∏≠ÂøÉÊâ©Â±ï„Äã „ÄÇ ÁõÆÂâçÁ§æÂå∫ÈáåÔºåÊúâÂØπ Dubbo ÁõëÊéß‰∏≠ÂøÉËøõË°åÈáçÊûÑÁöÑÈ°πÁõÆÔºå‰æãÂ¶Ç Ôºö https://github.com/handuyishe/dubbo-monitor https://github.com/zhongxig/dubbo-d-monitor 3.7 dubbo-config dubbo-config ÈÖçÁΩÆÊ®°ÂùóÔºöÊòØ Dubbo ÂØπÂ§ñÁöÑ APIÔºåÁî®Êà∑ÈÄöËøá Config ‰ΩøÁî®DubboÔºåÈöêËóè Dubbo ÊâÄÊúâÁªÜËäÇ„ÄÇ dubbo-config-api ÔºåÂÆûÁé∞‰∫Ü API ÈÖçÁΩÆ Âíå Â±ûÊÄßÈÖçÁΩÆ ÂäüËÉΩ„ÄÇ dubbo-config-spring ÔºåÂÆûÁé∞‰∫Ü XML ÈÖçÁΩÆ Âíå Ê≥®Ëß£ÈÖçÁΩÆ ÂäüËÉΩ„ÄÇ Êé®ËçêÈòÖËØª „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÈÖçÁΩÆËÆæËÆ°„Äã „ÄÇ 3.8 dubbo-container dubbo-container ÂÆπÂô®Ê®°ÂùóÔºöÊòØ‰∏Ä‰∏™ Standlone ÁöÑÂÆπÂô®Ôºå‰ª•ÁÆÄÂçïÁöÑ Main Âä†ËΩΩ Spring ÂêØÂä®ÔºåÂõ†‰∏∫ÊúçÂä°ÈÄöÂ∏∏‰∏çÈúÄË¶Å Tomcat/JBoss Á≠â Web ÂÆπÂô®ÁöÑÁâπÊÄßÔºåÊ≤°ÂøÖË¶ÅÁî® Web ÂÆπÂô®ÂéªÂä†ËΩΩÊúçÂä°„ÄÇ dubbo-container-api ÔºöÂÆö‰πâ‰∫Ü com.alibaba.dubbo.container.Container Êé•Âè£ÔºåÂπ∂Êèê‰æõ Âä†ËΩΩÊâÄÊúâÂÆπÂô®ÂêØÂä®ÁöÑ Main Á±ª„ÄÇ ÂÆûÁé∞ 1dubbo-container-api dubbo-container-spring ÔºåÊèê‰æõ‰∫Ü com.alibaba.dubbo.container.spring.SpringContainer „ÄÇ dubbo-container-log4j ÔºåÊèê‰æõ‰∫Ü com.alibaba.dubbo.container.log4j.Log4jContainer „ÄÇ dubbo-container-logback ÔºåÊèê‰æõ‰∫Ü com.alibaba.dubbo.container.logback.LogbackContainer „ÄÇ ÊãìÂ±ïÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÊúçÂä°ÂÆπÂô®„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÂÆπÂô®Êâ©Â±ï„Äã ÊñáÊ°£„ÄÇ 3.9 dubbo-filterdubbo-filter ËøáÊª§Âô®Ê®°ÂùóÔºöÊèê‰æõ‰∫ÜÂÜÖÁΩÆÁöÑËøáÊª§Âô®„ÄÇ 1dubbo-filter-cache ÔºåÁºìÂ≠òËøáÊª§Âô®„ÄÇ ÊãìÂ±ïÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÁªìÊûúÁºìÂ≠ò„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî ÁºìÂ≠òÊãìÂ±ï„Äã ÊñáÊ°£„ÄÇ 1dubbo-filter-validation ÔºåÂèÇÊï∞È™åËØÅËøáÊª§Âô®„ÄÇ ÊãìÂ±ïÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂèÇÊï∞È™åËØÅ„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî È™åËØÅÊâ©Â±ï„Äã ÊñáÊ°£„ÄÇ 3.10 dubbo-plugindubbo-plugin Êèí‰ª∂Ê®°ÂùóÔºöÊèê‰æõ‰∫ÜÂÜÖÁΩÆÁöÑÊèí‰ª∂„ÄÇ 1dubbo-qos ÔºåÊèê‰æõÂú®Á∫øËøêÁª¥ÂëΩ‰ª§„ÄÇ ÊãìÂ±ïÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Êñ∞ÁâàÊú¨ telnet ÂëΩ‰ª§‰ΩøÁî®ËØ¥Êòé„Äã Âíå „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Telnet ÂëΩ‰ª§Êâ©Â±ï„Äã ÊñáÊ°£„ÄÇ 3.11 hessian-litehessian-lite ÔºöDubbo ÂØπ Hessian 2 ÁöÑ Â∫èÂàóÂåñ ÈÉ®ÂàÜÁöÑÁ≤æÁÆÄ„ÄÅÊîπËøõ„ÄÅBugFix „ÄÇ Êèê‰∫§ÂéÜÂè≤Â¶Ç‰∏ãÔºö 3.12 dubbo-demodubbo-demo Âø´ÈÄüÂêØÂä®Á§∫‰æã„ÄÇ ÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Âø´ÈÄüÂêØÂä®„Äã ÊñáÊ°£„ÄÇ 3.13 dubbo-testdubbo-test ÊµãËØïÊ®°Âùó„ÄÇ 1dubbo-test-benchmark ÔºåÊÄßËÉΩÊµãËØï„ÄÇ ÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÊÄßËÉΩÊµãËØïÊä•Âëä„Äã ÊñáÊ°£„ÄÇ 1dubbo-test-compatibility ÔºåÂÖºÂÆπÊÄßÊµãËØï„ÄÇ dubbo-test-spring3 ÔºåÊµãËØïÂØπ Spring 3 ÁöÑÂÖºÂÆπÊÄß„ÄÇ dubbo-test-example Ôºå‰ΩøÁî®Á§∫‰æã„ÄÇ 3.14 Maven POM3.14.1 dubbo-dependencies-bomdubbo-dependencies-bom/pom.xml ÔºåMaven BOM(Bill Of Materials) ÔºåÁªü‰∏ÄÂÆö‰πâ‰∫Ü Dubbo ‰æùËµñÁöÑ‰∏âÊñπÂ∫ìÁöÑÁâàÊú¨Âè∑Ôºö dubbo-parent ‰ºöÂºïÂÖ•ËØ• BOM Ôºö Êõ¥Â§ö Maven BOM ÁöÑÁü•ËØÜÔºåÂèØ‰ª•Áúã‰∏ã „ÄäMaven ‰∏éSpring BOM(Bill Of Materials)ÁÆÄÂåñSpringÁâàÊú¨ÊéßÂà∂„Äã ÊñáÊ°£Ôºö ÈÄö‰øóËß£ËØ¥Ôºö‰∏∫‰∫ÜÈò≤Ê≠¢Áî® Maven ÁÆ°ÁêÜ Spring È°πÁõÆÊó∂Ôºå‰∏çÂêåÁöÑÈ°πÁõÆ‰æùËµñ‰∫Ü‰∏çÂêåÁâàÊú¨ÁöÑ Spring ÔºåÂèØ‰ª•‰ΩøÁî® Maven BOM Êù•Ëß£ÂÜ≥ËÄÖ‰∏ÄÈóÆÈ¢ò„ÄÇ 3.14.2 dubbo-bomdubbo-bom/pom.xml ÔºåMaven BOM(Bill Of Materials) ÔºåÁªü‰∏ÄÂÆö‰πâ‰∫Ü Dubbo ÁöÑÁâàÊú¨Âè∑Ôºö dubbo-demo Âíå dubbo-test ‰ºöÂºïÂÖ•ËØ• BOM „ÄÇ‰ª• dubbo-demo ‰∏æ‰æãÂ≠êÔºö 3.14.3 dubbo-parentdubbo/pom.xml ÔºåDubbo Parent Pom „ÄÇ Dubbo ÁöÑ Maven Ê®°ÂùóÔºåÈÉΩ‰ºöÂºïÂÖ•ËØ• pom Êñá‰ª∂„ÄÇ‰ª• dubbo-cluster ‰∏æ‰æãÂ≠êÔºö Êàë‰ª¨Êï¥ÁêÜ‰∏ã‰∏äÈù¢ÁöÑ pom Êñá‰ª∂Ôºö 3.14.4 dubbo-alldubbo/all/pom.xml ÔºåDubbo All Pom ÔºåÂÆö‰πâ‰∫Ü Dubbo ÁöÑÊâìÂåÖËÑöÊú¨„ÄÇ Êàë‰ª¨Âú®‰ΩøÁî® Dubbo Â∫ìÊó∂ÔºåÂºïÂÖ•ËØ• pom Êñá‰ª∂„ÄÇ]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á≤æÂ∞Ω Dubbo Èù¢ËØïÈ¢ò]]></title>
    <url>%2F2019%2F02%2F11%2F%E7%B2%BE%E5%B0%BD-Dubbo-%E9%9D%A2%E8%AF%95%E9%A2%98%2F</url>
    <content type="text"><![CDATA[‰ª•‰∏ãÈù¢ËØïÈ¢òÔºåÂü∫‰∫éÁΩëÁªúÊï¥ÁêÜÔºåÂíåËá™Â∑±ÁºñËæë„ÄÇÂÖ∑‰ΩìÂèÇËÄÉÁöÑÊñáÁ´†Ôºå‰ºöÂú®ÊñáÊú´ÁªôÂá∫ÊâÄÊúâÁöÑÈìæÊé•„ÄÇ Â¶ÇÊûúËÉñÂèãÊúâËá™Â∑±ÁöÑÁñëÈóÆÔºåÊ¨¢ËøéÂú®ÊòüÁêÉÊèêÈóÆÔºåÊàë‰ª¨‰∏ÄËµ∑Êï¥ÁêÜÂêäÂêäÁöÑ Dubbo Èù¢ËØïÈ¢òÁöÑÂ§ß‰øùÂÅ•„ÄÇ ËÄåÈ¢òÁõÆÁöÑÈöæÂ∫¶ÔºåËâøËâøÂ∞ΩÈáèÊåâÁÖß‰ªéÂÆπÊòìÂà∞Âõ∞ÈöæÁöÑÈ°∫Â∫èÔºåÈÄêÊ≠•‰∏ãÂéª„ÄÇ Dubbo ÊúâÂá†ÁßçÈÖçÁΩÆÊñπÂºèÔºüÊ≠£Â¶ÇÂú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÈÖçÁΩÆ„Äã ‰∏≠ÊâÄËßÅÔºå‰∏ÄÂÖ±ÊúâÂõõÁßçÈÖçÁΩÆÊñπÂºèÔºö XML ÈÖçÁΩÆ Ê≥®Ëß£ÈÖçÁΩÆ Â±ûÊÄßÈÖçÁΩÆ Java API ÈÖçÁΩÆ ÂÆûÈôÖ‰∏äÔºåËøòÊúâÁ¨¨‰∫îÁßçÊñπÂºèÔºåÂ§ñÈÉ®ÂåñÈÖçÁΩÆ„ÄÇÂèÇËßÅ „ÄäDubbo Êñ∞ÁºñÁ®ãÊ®°Âûã‰πãÂ§ñÈÉ®ÂåñÈÖçÁΩÆ„Äã „ÄÇ ÁõÆÂâçÔºå‰∏ªË¶Å‰ΩøÁî®ÁöÑÊòØ XML ÈÖçÁΩÆÂíåÊ≥®Ëß£ÈÖçÁΩÆ„ÄÇÂÖ∑‰Ωì‰ΩøÁî®Âì™‰∏ÄÁßçÔºåÂ∞±ÁúãÂ§ßÂÆ∂ÂêÑËá™ÁöÑÂñúÂ•Ω„ÄÇÁõÆÂâçÔºåËâøËâøÂÅèÂ•Ω XML ÈÖçÁΩÆÔºåÊõ¥Âä†Ê∏ÖÊô∞Â•ΩÁÆ°ÁêÜ„ÄÇ Dubbo Â¶Ç‰ΩïÂíå Spring Boot ËøõË°åÈõÜÊàêÔºüÂÆòÊñπÊèê‰æõÊèê‰æõ‰∫ÜÈõÜÊàêÂ∫ì dubbo-spring-boot ÔºåÂØπÂ∫î‰ªìÂ∫ì‰∏∫ https://github.com/apache/incubator-dubbo-spring-boot-project „ÄÇ Dubbo Ê°ÜÊû∂ÁöÑÂàÜÂ±ÇËÆæËÆ°Âú® „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Ê†∏ÂøÉÊµÅÁ®ã‰∏ÄËßà„Äã ‰∏ÄÊñá‰∏≠ÔºåÂØπ Dubbo Ê°ÜÊû∂ÁöÑÂàÜÂ±ÇÂ∑≤ÁªèÊúâËøá‰ªãÁªçÔºåËøôÈáåÂÜçÊù•‰∏ÄÊ¨°„ÄÇ Áõ∏ÂØπÊØîËæÉÂ§çÊùÇÔºå‰∏ÄÂÖ±ÂàÜÊàê 10 Â±ÇÔºåÂΩìÁÑ∂ÁêÜËß£ÂêéÊòØÈùûÂ∏∏Ê∏ÖÊô∞ÁöÑ„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Âõæ‰æãËØ¥Êòé ÊúÄÈ°∂‰∏ä‰πù‰∏™ÂõæÊ†áÔºå‰ª£Ë°®Êú¨Âõæ‰∏≠ÁöÑÂØπË±°‰∏éÊµÅÁ®ã„ÄÇ Âõæ‰∏≠Â∑¶Ëæπ Ê∑°ËìùËÉåÊôØ( Consumer ) ÁöÑ‰∏∫ÊúçÂä°Ê∂àË¥πÊñπ‰ΩøÁî®ÁöÑÊé•Âè£ÔºåÂè≥Ëæπ Ê∑°ÁªøËâ≤ËÉåÊôØ( Provider ) ÁöÑ‰∏∫ÊúçÂä°Êèê‰æõÊñπ‰ΩøÁî®ÁöÑÊé•Âè£Ôºå‰Ωç‰∫é‰∏≠ËΩ¥Á∫ø‰∏äÁöÑ‰∏∫ÂèåÊñπÈÉΩÁî®Âà∞ÁöÑÊé•Âè£„ÄÇ Âõæ‰∏≠‰ªé‰∏ãËá≥‰∏äÂàÜ‰∏∫ÂçÅÂ±ÇÔºåÂêÑÂ±ÇÂùá‰∏∫ÂçïÂêë‰æùËµñÔºåÂè≥ËæπÁöÑ ÈªëËâ≤ÁÆ≠Â§¥( Depend ) ‰ª£Ë°®Â±Ç‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÔºåÊØè‰∏ÄÂ±ÇÈÉΩÂèØ‰ª•Ââ•Á¶ª‰∏äÂ±ÇË¢´Â§çÁî®„ÄÇÂÖ∂‰∏≠ÔºåService Âíå Config Â±Ç‰∏∫ APIÔºåÂÖ∂ÂÆÉÂêÑÂ±ÇÂùá‰∏∫ SPI „ÄÇ Ê≥®ÊÑèÔºåDubbo Âπ∂Êú™‰ΩøÁî® JDK SPI Êú∫Âà∂ÔºåËÄåÊòØËá™Â∑±ÂÆûÁé∞‰∫Ü‰∏ÄÂ•ó Dubbo SPI Êú∫Âà∂„ÄÇ Âõæ‰∏≠ ÁªøËâ≤Â∞èÂùó( Interface ) ÁöÑ‰∏∫Êâ©Â±ïÊé•Âè£ÔºåËìùËâ≤Â∞èÂùó( Class ) ‰∏∫ÂÆûÁé∞Á±ªÔºåÂõæ‰∏≠Âè™ÊòæÁ§∫Áî®‰∫éÂÖ≥ËÅîÂêÑÂ±ÇÁöÑÂÆûÁé∞Á±ª„ÄÇ Âõæ‰∏≠ ËìùËâ≤ËôöÁ∫ø( Init ) ‰∏∫ÂàùÂßãÂåñËøáÁ®ãÔºåÂç≥ÂêØÂä®Êó∂ÁªÑË£ÖÈìæ„ÄÇÁ∫¢Ëâ≤ÂÆûÁ∫ø( Call )‰∏∫ÊñπÊ≥ïË∞ÉÁî®ËøáÁ®ãÔºåÂç≥ËøêË°åÊó∂Ë∞ÉÊó∂Èìæ„ÄÇÁ¥´Ëâ≤‰∏âËßíÁÆ≠Â§¥( Inherit )‰∏∫ÁªßÊâøÔºåÂèØ‰ª•ÊääÂ≠êÁ±ªÁúã‰ΩúÁà∂Á±ªÁöÑÂêå‰∏Ä‰∏™ËäÇÁÇπÔºåÁ∫ø‰∏äÁöÑÊñáÂ≠ó‰∏∫Ë∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇ ÂêÑÂ±ÇËØ¥Êòé ËôΩÁÑ∂ÔºåÊúâ 10 Â±ÇËøô‰πàÂ§öÔºå‰ΩÜÊòØÊÄª‰ΩìÊòØÂàÜÂ±Ç Business„ÄÅRPC„ÄÅRemoting ‰∏âÂ§ßÂ±Ç„ÄÇÂ¶Ç‰∏ãÔºö ==================== Business ==================== Service ‰∏öÂä°Â±ÇÔºö‰∏öÂä°‰ª£Á†ÅÁöÑÊé•Âè£‰∏éÂÆûÁé∞„ÄÇÊàë‰ª¨ÂÆûÈôÖ‰ΩøÁî® Dubbo ÁöÑ‰∏öÂä°Â±ÇÁ∫ß„ÄÇ Êé•Âè£Â±ÇÔºåÁªôÊúçÂä°Êèê‰æõËÄÖÂíåÊ∂àË¥πËÄÖÊù•ÂÆûÁé∞ÁöÑ„ÄÇ ==================== RPC ==================== config ÈÖçÁΩÆÂ±ÇÔºöÂØπÂ§ñÈÖçÁΩÆÊé•Âè£Ôºå‰ª• ServiceConfig, ReferenceConfig ‰∏∫‰∏≠ÂøÉÔºåÂèØ‰ª•Áõ¥Êé•ÂàùÂßãÂåñÈÖçÁΩÆÁ±ªÔºå‰πüÂèØ‰ª•ÈÄöËøá Spring Ëß£ÊûêÈÖçÁΩÆÁîüÊàêÈÖçÁΩÆÁ±ª„ÄÇ ÈÖçÁΩÆÂ±ÇÔºå‰∏ªË¶ÅÊòØÂØπ Dubbo ËøõË°åÂêÑÁßçÈÖçÁΩÆÁöÑ„ÄÇ proxy ÊúçÂä°‰ª£ÁêÜÂ±ÇÔºöÊúçÂä°Êé•Âè£ÈÄèÊòé‰ª£ÁêÜÔºåÁîüÊàêÊúçÂä°ÁöÑÂÆ¢Êà∑Á´Ø Stub ÂíåÊúçÂä°Âô®Á´Ø Skeleton, Êâ©Â±ïÊé•Âè£‰∏∫ ProxyFactory „ÄÇ ÊúçÂä°‰ª£ÁêÜÂ±ÇÔºåÊó†ËÆ∫ÊòØ consumer ËøòÊòØ providerÔºåDubbo ÈÉΩ‰ºöÁªô‰Ω†ÁîüÊàê‰ª£ÁêÜÔºå‰ª£ÁêÜ‰πãÈó¥ËøõË°åÁΩëÁªúÈÄö‰ø°„ÄÇ Â¶ÇÊûúËÉñÂèã‰∫ÜËß£ Spring Cloud ‰ΩìÁ≥ªÔºåÂèØ‰ª•Á±ªÊØîÊàê Feign ÂØπ‰∫é consumer ÔºåSpring MVC ÂØπ‰∫é provider „ÄÇ registry Ê≥®ÂÜå‰∏≠ÂøÉÂ±ÇÔºöÂ∞ÅË£ÖÊúçÂä°Âú∞ÂùÄÁöÑÊ≥®ÂÜå‰∏éÂèëÁé∞Ôºå‰ª•ÊúçÂä° URL ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ RegistryFactory, Registry, RegistryService „ÄÇ ÊúçÂä°Ê≥®ÂÜåÂ±ÇÔºåË¥üË¥£ÊúçÂä°ÁöÑÊ≥®ÂÜå‰∏éÂèëÁé∞„ÄÇ Â¶ÇÊûúËÉñÂèã‰∫ÜËß£ Spring Cloud ‰ΩìÁ≥ªÔºåÂèØ‰ª•Á±ªÊØîÊàê Eureka Client „ÄÇ cluster Ë∑ØÁî±Â±ÇÔºöÂ∞ÅË£ÖÂ§ö‰∏™Êèê‰æõËÄÖÁöÑË∑ØÁî±ÂèäË¥üËΩΩÂùáË°°ÔºåÂπ∂Ê°•Êé•Ê≥®ÂÜå‰∏≠ÂøÉÔºå‰ª• Invoker ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Cluster, Directory, Router, LoadBalance „ÄÇ ÈõÜÁæ§Â±ÇÔºåÂ∞ÅË£ÖÂ§ö‰∏™ÊúçÂä°Êèê‰æõËÄÖÁöÑË∑ØÁî±‰ª•ÂèäË¥üËΩΩÂùáË°°ÔºåÂ∞ÜÂ§ö‰∏™ÂÆû‰æãÁªÑÂêàÊàê‰∏Ä‰∏™ÊúçÂä°„ÄÇ Â¶ÇÊûúËÉñÂèã‰∫ÜËß£ Spring Cloud ‰ΩìÁ≥ªÔºåÂèØ‰ª•Á±ªÊØîÂüé Ribbon „ÄÇ monitor ÁõëÊéßÂ±ÇÔºöRPC Ë∞ÉÁî®Ê¨°Êï∞ÂíåË∞ÉÁî®Êó∂Èó¥ÁõëÊéßÔºå‰ª• Statistics ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ MonitorFactory, Monitor, MonitorService „ÄÇ ÁõëÊéßÂ±ÇÔºåÂØπ rpc Êé•Âè£ÁöÑË∞ÉÁî®Ê¨°Êï∞ÂíåË∞ÉÁî®Êó∂Èó¥ËøõË°åÁõëÊéß„ÄÇ Â¶ÇÊûúËÉñÂèã‰∫ÜËß£ SkyWalking ÈìæË∑ØËøΩË∏™Ôºå‰Ω†‰ºöÂèëÁé∞ÔºåSkyWalking Âü∫‰∫é MonitorFilter ÂÆûÁé∞Â¢ûÂº∫Ôºå‰ªéËÄåÈÄèÊòéÂåñÂüãÁÇπÁõëÊéß„ÄÇ ==================== Remoting ==================== protocol ËøúÁ®ãË∞ÉÁî®Â±ÇÔºöÂ∞ÅÂ∞Ü RPC Ë∞ÉÁî®Ôºå‰ª• Invocation, Result ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Protocol, Invoker, Exporter „ÄÇ ËøúÁ®ãË∞ÉÁî®Â±ÇÔºåÂ∞ÅË£Ö rpc Ë∞ÉÁî®„ÄÇ exchange ‰ø°ÊÅØ‰∫§Êç¢Â±ÇÔºöÂ∞ÅË£ÖËØ∑Ê±ÇÂìçÂ∫îÊ®°ÂºèÔºåÂêåÊ≠•ËΩ¨ÂºÇÊ≠•Ôºå‰ª• Request, Response ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Exchanger, ExchangeChannel, ExchangeClient, ExchangeServer „ÄÇ ‰ø°ÊÅØ‰∫§Êç¢Â±ÇÔºåÂ∞ÅË£ÖËØ∑Ê±ÇÂìçÂ∫îÊ®°ÂºèÔºåÂêåÊ≠•ËΩ¨ÂºÇÊ≠•„ÄÇ transport ÁΩëÁªú‰º†ËæìÂ±ÇÔºöÊäΩË±° mina Âíå netty ‰∏∫Áªü‰∏ÄÊé•Âè£Ôºå‰ª• Message ‰∏∫‰∏≠ÂøÉÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Channel, Transporter, Client, Server, Codec „ÄÇ ÁΩëÁªú‰º†ËæìÂ±ÇÔºåÊäΩË±° mina Âíå netty ‰∏∫Áªü‰∏ÄÊé•Âè£„ÄÇ serialize Êï∞ÊçÆÂ∫èÂàóÂåñÂ±ÇÔºöÂèØÂ§çÁî®ÁöÑ‰∏Ä‰∫õÂ∑•ÂÖ∑ÔºåÊâ©Â±ïÊé•Âè£‰∏∫ Serialization, ObjectInput, ObjectOutput, ThreadPool „ÄÇ Êï∞ÊçÆÂ∫èÂàóÂåñÂ±Ç„ÄÇ Dubbo Ë∞ÉÁî®ÊµÅÁ®ã Provider Á¨¨ 0 Ê≠•Ôºåstart ÂêØÂä®ÊúçÂä°„ÄÇ Á¨¨ 1 Ê≠•Ôºåregister Ê≥®ÂÜåÊúçÂä°Âà∞Ê≥®ÂÜå‰∏≠ÂøÉ„ÄÇ Consumer Á¨¨ 2 Ê≠•Ôºåsubscribe ÂêëÊ≥®ÂÜå‰∏≠ÂøÉËÆ¢ÈòÖÊúçÂä°„ÄÇ Ê≥®ÊÑèÔºåÂè™ËÆ¢ÈòÖ‰ΩøÁî®Âà∞ÁöÑÊúçÂä°„ÄÇ ÂÜçÊ≥®ÊÑèÔºåÈ¶ñÊ¨°‰ºöÊãâÂèñËÆ¢ÈòÖÁöÑÊúçÂä°ÂàóË°®ÔºåÁºìÂ≠òÂú®Êú¨Âú∞„ÄÇ „ÄêÂºÇÊ≠•„ÄëÁ¨¨ 3 Ê≠•Ôºånotify ÂΩìÊúçÂä°ÂèëÁîüÂèòÂåñÊó∂ÔºåËé∑ÂèñÊúÄÊñ∞ÁöÑÊúçÂä°ÂàóË°®ÔºåÊõ¥Êñ∞Êú¨Âú∞ÁºìÂ≠ò„ÄÇ invoke Ë∞ÉÁî® Consumer Áõ¥Êé•ÂèëËµ∑ÂØπ Provider ÁöÑË∞ÉÁî®ÔºåÊó†ÈúÄÁªèËøáÊ≥®ÂÜå‰∏≠ÂøÉ„ÄÇËÄåÂØπÂ§ö‰∏™ Provider ÁöÑË¥üËΩΩÂùáË°°ÔºåConsumer ÈÄöËøá cluster ÁªÑ‰ª∂ÂÆûÁé∞„ÄÇ count ÁõëÊéß „ÄêÂºÇÊ≠•„ÄëConsumer Âíå Provider ÈÉΩÂºÇÊ≠•ÈÄöÁü•ÁõëÊéß‰∏≠ÂøÉ„ÄÇ ËøôÈáåËâøËâøÂú®ÂºïÁî®‰∏ÄÂº†Âú®ÁΩë‰∏äÁúãÂà∞ÁöÑÂõæÔºåÊõ¥Á´ã‰ΩìÁöÑÂ±ïÁ§∫ Dubbo ÁöÑË∞ÉÁî®ÊµÅÁ®ãÔºö Ê≥®ÊÑèÔºåÂõæ‰∏≠ÁöÑ„Äê‰ª£ÁêÜ„ÄëÊåáÁöÑÊòØ proxy ‰ª£ÁêÜÊúçÂä°Â±ÇÔºåÂíå Consumer Êàñ Provider Âú®Âêå‰∏ÄËøõÂüé‰∏≠„ÄÇ Ê≥®ÊÑèÔºåÂõæ‰∏≠ÁöÑ„ÄêË¥üËΩΩÂùáË°°„ÄëÊåáÁöÑÊòØ cluster Ë∑ØÁî±Â±ÇÔºåÂíå Consumer Êàñ Provider Âú®Âêå‰∏ÄËøõÁ®ã‰∏≠„ÄÇ Dubbo Ë∞ÉÁî®ÊòØÂêåÊ≠•ÁöÑÂêóÔºüÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî®ÊòØÂêåÊ≠•ÁöÑÊñπÂºè„ÄÇ ÂèØ‰ª•ÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂºÇÊ≠•Ë∞ÉÁî®„Äã ÊñáÊ°£ÔºåÈÖçÁΩÆÂºÇÊ≠•Ë∞ÉÁî®ÁöÑÊñπÂºè„ÄÇÂΩìÁÑ∂Ôºå‰ΩøÁî®‰∏äÔºåÊÑüËßâËõÆ‰∏ç‰ºòÈõÖÁöÑ„ÄÇÊâÄ‰ª•ÔºåÂú® Dubbo 2.7 ÁâàÊú¨ÂêéÔºåÂèàÊèê‰æõ‰∫ÜÊñ∞ÁöÑ‰∏§ÁßçÊñπÂºèÔºåÂÖ∑‰ΩìÂÖàÂèÇËßÅ „ÄäDubbo‰∏ã‰∏ÄÁ´ôÔºöApacheÈ°∂Á∫ßÈ°πÁõÆ„Äã ÊñáÁ´†„ÄÇ‰º∞ËÆ°ÔºåÂêéÁª≠Êâç‰ºöÊõ¥Êñ∞ÂÆòÊñπÊñáÊ°£„ÄÇ Ë∞àË∞àÂØπ Dubbo ÁöÑÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂ÔºüDubbo ÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂Ê∂âÂèäÁöÑÂÜÖÂÆπÊØîËæÉÂ§öÔºåÊ†∏ÂøÉÂú®‰∫é Provider ÁöÑ ÂºÇÂ∏∏ËøáÊª§Âô® ExceptionFilter ÂØπË∞ÉÁî®ÁªìÊûúÁöÑÂêÑÁßçÊÉÖÂÜµÁöÑÂ§ÑÁêÜ„ÄÇÊâÄ‰ª•Âª∫ËÆÆËÉñÂèãÁúãÂ¶Ç‰∏ã‰∏âÁØáÊñáÁ´†Ôºö Â¢ôË£ÇÊé®Ëçê „ÄäDubbo(Âõõ) ÂºÇÂ∏∏Â§ÑÁêÜ„Äã „ÄäÊµÖË∞à Dubbo ÁöÑ ExceptionFilter ÂºÇÂ∏∏Â§ÑÁêÜ„Äã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ËøáÊª§Âô®Ôºà‰∏ÉÔºâ‰πã ExceptionFilter„Äã Dubbo Â¶Ç‰ΩïÂÅöÂèÇÊï∞Ê†°È™åÔºüÂú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂèÇÊï∞È™åËØÅ„Äã ‰∏≠Ôºå‰ªãÁªçÂ¶Ç‰∏ãÔºö ÂèÇÊï∞È™åËØÅÂäüËÉΩÊòØÂü∫‰∫é JSR303 ÂÆûÁé∞ÁöÑÔºåÁî®Êà∑Âè™ÈúÄÊ†áËØÜ JSR303 Ê†áÂáÜÁöÑÈ™åËØÅ annotationÔºåÂπ∂ÈÄöËøáÂ£∞Êòé filter Êù•ÂÆûÁé∞È™åËØÅ„ÄÇ ÂèÇÊï∞Ê†°È™åÂäüËÉΩÔºåÈÄöËøáÂèÇÊï∞Ê†°È™åËøáÊª§Âô® ValidationFilter Êù•ÂÆûÁé∞„ÄÇ ValidationFilter Âú® Dubbo Provider Âíå Consumer ÈÉΩÂèØÁîüÊïà„ÄÇ Â¶ÇÊûúÊàë‰ª¨Â∞ÜÊ†°È™åÊ≥®Ëß£ÂÜôÂú® Service Êé•Âè£ÁöÑÊñπÊ≥ï‰∏äÔºåÈÇ£‰πà Consumer Âú®Êú¨Âú∞Â∞±‰ºöÊ†°È™å„ÄÇÂ¶ÇÊûúÊ†°È™å‰∏çÈÄöËøáÔºåÁõ¥Êé•ÊäõÂá∫Ê†°È™åÂ§±Ë¥•ÁöÑÂºÇÂ∏∏Ôºå‰∏ç‰ºöÂèëËµ∑ Dubbo Ë∞ÉÁî®„ÄÇ Â¶ÇÊûúÊàë‰ª¨Â∞ÜÊ†°È™åÊ≥®Ëß£ÂÜôÂú® Service ÂÆûÁé∞ÁöÑÊñπÊ≥ï‰∏äÔºåÈÇ£‰πà Consumer Âú®Êú¨Âú∞‰∏ç‰ºöÊ†°È™åÔºåËÄåÊòØÁî± Provider Ê†°È™å„ÄÇ Dubbo ÂèØ‰ª•ÂØπË∞ÉÁî®ÁªìÊûúËøõË°åÁºìÂ≠òÂêó?Dubbo ÈÄöËøá CacheFilter ËøáÊª§Âô®ÔºåÊèê‰æõÁªìÊûúÁºìÂ≠òÁöÑÂäüËÉΩÔºå‰∏îÊó¢ÂèØ‰ª•ÈÄÇÁî®‰∫é Consumer ‰πüÂèØ‰ª•ÈÄÇÁî®‰∫é Provider „ÄÇ ÈÄöËøáÁªìÊûúÁºìÂ≠òÔºåÁî®‰∫éÂä†ÈÄüÁÉ≠Èó®Êï∞ÊçÆÁöÑËÆøÈóÆÈÄüÂ∫¶ÔºåDubbo Êèê‰æõÂ£∞ÊòéÂºèÁºìÂ≠òÔºå‰ª•ÂáèÂ∞ëÁî®Êà∑Âä†ÁºìÂ≠òÁöÑÂ∑•‰ΩúÈáè„ÄÇ Dubbo ÁõÆÂâçÊèê‰æõ‰∏âÁßçÂÆûÁé∞Ôºö lru ÔºöÂü∫‰∫éÊúÄËøëÊúÄÂ∞ë‰ΩøÁî®ÂéüÂàôÂà†Èô§Â§ö‰ΩôÁºìÂ≠òÔºå‰øùÊåÅÊúÄÁÉ≠ÁöÑÊï∞ÊçÆË¢´ÁºìÂ≠ò„ÄÇ threadlocal ÔºöÂΩìÂâçÁ∫øÁ®ãÁºìÂ≠òÔºåÊØîÂ¶Ç‰∏Ä‰∏™È°µÈù¢Ê∏≤ÊüìÔºåÁî®Âà∞ÂæàÂ§ö portalÔºåÊØè‰∏™ portal ÈÉΩË¶ÅÂéªÊü•Áî®Êà∑‰ø°ÊÅØÔºåÈÄöËøáÁ∫øÁ®ãÁºìÂ≠òÔºåÂèØ‰ª•ÂáèÂ∞ëËøôÁßçÂ§ö‰ΩôËÆøÈóÆ„ÄÇ jcache Ôºö‰∏é JSR107 ÈõÜÊàêÔºåÂèØ‰ª•Ê°•Êé•ÂêÑÁßçÁºìÂ≠òÂÆûÁé∞„ÄÇ ËØ¶ÁªÜÁöÑÊ∫êÁ†ÅËß£ÊûêÔºåÂèØËßÅ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ËøáÊª§Âô®ÔºàÂçÅÔºâ‰πã CacheFilter„Äã „ÄÇ Ê≥®ÂÜå‰∏≠ÂøÉÊåÇ‰∫ÜËøòÂèØ‰ª•ÈÄö‰ø°ÂêóÔºüÂèØ‰ª•„ÄÇÂØπ‰∫éÊ≠£Âú®ËøêË°åÁöÑ Consumer Ë∞ÉÁî® Provider ÊòØ‰∏çÈúÄË¶ÅÁªèËøáÊ≥®ÂÜå‰∏≠ÂøÉÔºåÊâÄ‰ª•‰∏çÂèóÂΩ±Âìç„ÄÇÂπ∂‰∏îÔºåConsumer ËøõÁ®ã‰∏≠ÔºåÂÜÖÂ≠òÂ∑≤ÁªèÁºìÂ≠ò‰∫Ü Provider ÂàóË°®„ÄÇ ÈÇ£‰πàÔºåÊ≠§Êó∂ Provider Â¶ÇÊûú‰∏ãÁ∫øÂë¢ÔºüÂ¶ÇÊûú Provider ÊòØÊ≠£Â∏∏ÂÖ≥Èó≠ÔºåÂÆÉ‰ºö‰∏ªÂä®‰∏îÁõ¥Êé•ÂØπÂíåÂÖ∂Â§Ñ‰∫éËøûÊé•‰∏≠ÁöÑ Consumer ‰ª¨ÔºåÂèëÈÄÅ‰∏ÄÊù°‚ÄúÊàëË¶ÅÂÖ≥Èó≠‚Äù‰∫ÜÁöÑÊ∂àÊÅØ„ÄÇÈÇ£‰πàÔºåConsumer ‰ª¨Â∞±‰∏ç‰ºöË∞ÉÁî®ËØ• Provider ÔºåËÄåË∞ÉÁî®ÂÖ∂ÂÆÉÁöÑ Provider „ÄÇ Âè¶Â§ñÔºåÂõ†‰∏∫ Consumer ‰πü‰ºöÊåÅ‰πÖÂåñ Provider ÂàóË°®Âà∞Êú¨Âú∞Êñá‰ª∂„ÄÇÊâÄ‰ª•ÔºåÊ≠§Â§ÑÂ¶ÇÊûú Consumer ÈáçÂêØÔºå‰æùÁÑ∂ËÉΩÂ§üÈÄöËøáÊú¨Âú∞ÁºìÂ≠òÁöÑÊñá‰ª∂ÔºåËé∑ÂæóÂà∞ Provider ÂàóË°®„ÄÇ ÂÜçÂè¶Â§ñÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊ≥®ÂÜå‰∏≠ÂøÉÊòØ‰∏Ä‰∏™ÈõÜÁæ§ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ËäÇÁÇπÊåÇ‰∫ÜÔºåDubbo Consumer Âíå Provider Â∞ÜËá™Âä®ÂàáÊç¢Âà∞ÈõÜÁæ§ÁöÑÂè¶Â§ñ‰∏Ä‰∏™ËäÇÁÇπ‰∏ä„ÄÇ Dubbo Âú® Zookeeper Â≠òÂÇ®‰∫ÜÂì™‰∫õ‰ø°ÊÅØÔºü‰∏ãÈù¢ÔºåÊàë‰ª¨ÂÖàÊù•Áúã‰∏ã „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî zookeeper Ê≥®ÂÜå‰∏≠ÂøÉ„Äã ÊñáÊ°£ÔºåÂÜÖÂÆπÂ¶Ç‰∏ãÔºö ÊµÅÁ®ãËØ¥ÊòéÔºö ÊúçÂä°Êèê‰æõËÄÖÂêØÂä®Êó∂: Âêë /dubbo/com.foo.BarService/providers ÁõÆÂΩï‰∏ãÂÜôÂÖ•Ëá™Â∑±ÁöÑ URL Âú∞ÂùÄ ÊúçÂä°Ê∂àË¥πËÄÖÂêØÂä®Êó∂: ËÆ¢ÈòÖ /dubbo/com.foo.BarService/providers ÁõÆÂΩï‰∏ãÁöÑÊèê‰æõËÄÖ URL Âú∞ÂùÄ„ÄÇÂπ∂Âêë /dubbo/com.foo.BarService/consumers ÁõÆÂΩï‰∏ãÂÜôÂÖ•Ëá™Â∑±ÁöÑ URL Âú∞ÂùÄ ÁõëÊéß‰∏≠ÂøÉÂêØÂä®Êó∂: ËÆ¢ÈòÖ /dubbo/com.foo.BarService ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊèê‰æõËÄÖÂíåÊ∂àË¥πËÄÖ URL Âú∞ÂùÄ„ÄÇ Âú®Âõæ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ Zookeeper ÁöÑËäÇÁÇπÂ±ÇÁ∫ßÔºåËá™‰∏äËÄå‰∏ãÊòØÔºö Root Â±ÇÔºöÊ†πÁõÆÂΩïÔºåÂèØÈÄöËøá &lt;dubbo:registry group=&quot;dubbo&quot; /&gt; ÁöÑ &quot;group&quot; ËÆæÁΩÆ Zookeeper ÁöÑÊ†πËäÇÁÇπÔºåÁº∫ÁúÅ‰ΩøÁî® &quot;dubbo&quot; „ÄÇ Service Â±ÇÔºöÊúçÂä°Êé•Âè£ÂÖ®Âêç„ÄÇ Type Â±ÇÔºöÂàÜÁ±ª„ÄÇÁõÆÂâçÈô§‰∫ÜÊàë‰ª¨Âú®Âõæ‰∏≠ÁúãÂà∞ÁöÑ &quot;providers&quot;( ÊúçÂä°Êèê‰æõËÄÖÂàóË°® ) &quot;consumers&quot;( ÊúçÂä°Ê∂àË¥πËÄÖÂàóË°® ) Â§ñÔºåËøòÊúâ &quot;routes&quot;( Ë∑ØÁî±ËßÑÂàôÂàóË°® ) Âíå &quot;configurations&quot;( ÈÖçÁΩÆËßÑÂàôÂàóË°® )„ÄÇ URL Â±ÇÔºöURL ÔºåÊ†πÊçÆ‰∏çÂêå Type ÁõÆÂΩïÔºå‰∏ãÈù¢ÂèØ‰ª•ÊòØÊúçÂä°Êèê‰æõËÄÖ URL „ÄÅÊúçÂä°Ê∂àË¥πËÄÖ URL „ÄÅË∑ØÁî±ËßÑÂàô URL „ÄÅÈÖçÁΩÆËßÑÂàô URL „ÄÇ ÂÆûÈôÖ‰∏ä URL ‰∏äÂ∏¶Êúâ &quot;category&quot; ÂèÇÊï∞ÔºåÂ∑≤ÁªèËÉΩÂà§Êñ≠ÊØè‰∏™ URL ÁöÑÂàÜÁ±ªÔºå‰ΩÜÊòØ Zookeeper ÊòØÂü∫‰∫éËäÇÁÇπÁõÆÂΩïËÆ¢ÈòÖÁöÑÔºåÊâÄ‰ª•Â¢ûÂä†‰∫Ü TypeÂ±Ç„ÄÇ ÂÆûÈôÖ‰∏äÔºåÊúçÂä°Ê∂àË¥πËÄÖÂêØÂä®ÂêéÔºå‰∏ç‰ªÖ‰ªÖËÆ¢ÈòÖ‰∫Ü &quot;providers&quot; ÂàÜÁ±ªÔºå‰πüËÆ¢ÈòÖ‰∫Ü &quot;routes&quot; &quot;configurations&quot; ÂàÜÁ±ª„ÄÇ Dubbo Provider Â¶Ç‰ΩïÂÆûÁé∞‰ºòÈõÖÂÅúÊú∫ÔºüÂú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ‰ºòÈõÖÂÅúÊú∫„Äã ‰∏≠ÔºåÂ∑≤ÁªèÂØπËøôÂùóËøõË°å‰∫ÜËØ¶ÁªÜÁöÑËØ¥Êòé„ÄÇ ‰ºòÈõÖÂÅúÊú∫ Dubbo ÊòØÈÄöËøá JDK ÁöÑ ShutdownHook Êù•ÂÆåÊàê‰ºòÈõÖÂÅúÊú∫ÁöÑÔºåÊâÄ‰ª•Â¶ÇÊûúÁî®Êà∑‰ΩøÁî® kill -9 PID Á≠âÂº∫Âà∂ÂÖ≥Èó≠Êåá‰ª§ÔºåÊòØ‰∏ç‰ºöÊâßË°å‰ºòÈõÖÂÅúÊú∫ÁöÑÔºåÂè™ÊúâÈÄöËøá kill PID Êó∂ÔºåÊâç‰ºöÊâßË°å„ÄÇ Âõ†‰∏∫Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåDubbo ÁöÑÂ£∞ÊòéÂë®ÊúüÊòØ‰∫§Áªô Spring ËøõË°åÁÆ°ÁêÜÔºåÊâÄ‰ª•Âú®ÊúÄÊñ∞ÁöÑ Dubbo ÁâàÊú¨‰∏≠ÔºåÂ¢ûÂä†‰∫ÜÂØπ Spring ÂÖ≥Èó≠‰∫ã‰ª∂ÁöÑÁõëÂê¨Ôºå‰ªéËÄåÂÖ≥Èó≠ Dubbo ÊúçÂä°„ÄÇÂØπÂ∫îÂèØËßÅ https://github.com/apache/incubator-dubbo/issues/2865 „ÄÇ ÊúçÂä°Êèê‰æõÊñπÁöÑ‰ºòÈõÖÂÅúÊú∫ËøáÁ®ã È¶ñÂÖàÔºå‰ªéÊ≥®ÂÜå‰∏≠ÂøÉ‰∏≠ÂèñÊ∂àÊ≥®ÂÜåËá™Â∑±Ôºå‰ªéËÄå‰ΩøÊ∂àË¥πËÄÖ‰∏çË¶ÅÂÜçÊãâÂèñÂà∞ÂÆÉ„ÄÇ ÁÑ∂ÂêéÔºåsleep 10 Áßí( ÂèØÈÖç )ÔºåÁ≠âÂà∞ÊúçÂä°Ê∂àË¥πÔºåÊé•Êî∂Âà∞Ê≥®ÂÜå‰∏≠ÂøÉÈÄöÁü•Âà∞ËØ•ÊúçÂä°Êèê‰æõËÄÖÂ∑≤Áªè‰∏ãÁ∫øÔºåÂä†Â§ß‰∫ÜÂú®‰∏çÈáçËØïÊÉÖÂÜµ‰∏ã‰ºòÈõÖÂÅúÊú∫ÁöÑÊàêÂäüÁéá„ÄÇüòà Ê≠§Â§ÑÊòØ‰∏™Ê¶ÇÁéáÂ≠¶ÔºåÂòªÂòª„ÄÇ ‰πãÂêéÔºåÂπøÊí≠ READONLY ‰∫ã‰ª∂ÁªôÊâÄÊúâ Consumer ‰ª¨ÔºåÂëäËØâÂÆÉ‰ª¨‰∏çË¶ÅÂú®Ë∞ÉÁî®Êàë‰∫ÜÔºÅÔºÅÔºÅ„ÄêÂæàÊúâË∂£ÁöÑ‰∏Ä‰∏™Ê≠•È™§„ÄëÂπ∂‰∏îÔºåÂ¶ÇÊûúÊ≠§Â§ÑÊ≥®ÂÜå‰∏≠ÂøÉÊåÇÊéâÁöÑÊÉÖÂÜµÔºå‰æùÁÑ∂ËÉΩËææÂà∞ÂëäËØâ Consumer ÔºåÊàëË¶Å‰∏ãÁ∫ø‰∫ÜÁöÑÂäüËÉΩ„ÄÇ ÂÜç‰πãÂêéÔºåsleep 10 ÊØ´ÁßíÔºå‰øùËØÅ Consumer ‰ª¨ÔºåÂ∞ΩÂèØËÉΩÊé•Êî∂Âà∞ËØ•Ê∂àÊÅØ„ÄÇ ÂÜçÂÜç‰πãÂêéÔºåÂÖàÊ†áËÆ∞‰∏∫‰∏çÊé•Êî∂Êñ∞ËØ∑Ê±ÇÔºåÊñ∞ËØ∑Ê±ÇËøáÊù•Êó∂Áõ¥Êé•Êä•ÈîôÔºåËÆ©ÂÆ¢Êà∑Á´ØÈáçËØïÂÖ∂ÂÆÉÊú∫Âô®„ÄÇ ÂÜçÂÜçÂÜç‰πãÂêéÔºåÂÖ≥Èó≠ÂøÉË∑≥Á∫øÁ®ã„ÄÇ ÊúÄÂêéÔºåÊ£ÄÊµãÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊòØÂê¶Ê≠£Âú®ËøêË°åÔºåÂ¶ÇÊûúÊúâÔºåÁ≠âÂæÖÊâÄÊúâÁ∫øÁ®ãÊâßË°åÂÆåÊàêÔºåÈô§ÈùûË∂ÖÊó∂ÔºåÂàôÂº∫Âà∂ÂÖ≥Èó≠„ÄÇ ÊúÄÊúÄÂêéÔºåÂÖ≥Èó≠ÊúçÂä°Âô®„ÄÇ Êï¥‰∏™ËøáÁ®ãÊØîËæÉÂ§çÊùÇÔºåÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÂèØ‰ª•ËØ¶ÁªÜÊù•ÁúãÁúã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî ‰ºòÈõÖÂÅúÊú∫„Äã „ÄÇ ÊúçÂä°Ê∂àË¥πÊñπÁöÑ‰ºòÈõÖÂÅúÊú∫ËøáÁ®ã ÂÅúÊ≠¢Êó∂Ôºå‰∏çÂÜçÂèëËµ∑Êñ∞ÁöÑË∞ÉÁî®ËØ∑Ê±ÇÔºåÊâÄÊúâÊñ∞ÁöÑË∞ÉÁî®Âú®ÂÆ¢Êà∑Á´ØÂç≥Êä•Èîô„ÄÇ ÁÑ∂ÂêéÔºåÊ£ÄÊµãÊúâÊ≤°ÊúâËØ∑Ê±ÇÁöÑÂìçÂ∫îËøòÊ≤°ÊúâËøîÂõûÔºåÁ≠âÂæÖÂìçÂ∫îËøîÂõûÔºåÈô§ÈùûË∂ÖÊó∂ÔºåÂàôÂº∫Âà∂ÂÖ≥Èó≠„ÄÇ Dubbo Provider ÂºÇÊ≠•ÂÖ≥Èó≠Êó∂ÔºåÂ¶Ç‰Ωï‰ªéÊ≥®ÂÜå‰∏≠ÂøÉ‰∏ãÁ∫øÔºü‚ë† Zookeeper Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊÉÖÂÜµ‰∏ã ÊúçÂä°Êèê‰æõËÄÖÔºåÊ≥®ÂÜåÂà∞ Zookeeper ‰∏äÊó∂ÔºåÂàõÂª∫ÁöÑÊòØ EPHEMERAL ‰∏¥Êó∂ËäÇÁÇπ„ÄÇÊâÄ‰ª•Âú®ÊúçÂä°Êèê‰æõËÄÖÂºÇÂ∏∏ÂÖ≥Èó≠Êó∂ÔºåÁ≠âÂæÖ Zookeeper ‰ºöËØùË∂ÖÊó∂ÔºåÈÇ£‰πàËØ•‰∏¥Êó∂ËäÇÁÇπÂ∞±‰ºöËá™Âä®Âà†Èô§„ÄÇ ‚ë° Redis Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊÉÖÂÜµ‰∏ã ‰ΩøÁî® Redis ‰Ωú‰∏∫Ê≥®ÂÜå‰∏≠ÂøÉÔºåÊòØÊúâÁÇπÂ∞è‰ºóÁöÑÈÄâÊã©ÔºåÊàë‰ª¨Â∞±‰∏çÂú®Êú¨ÊñáËØ¶ÁªÜËØ¥‰∫Ü„ÄÇÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÂèØ‰ª•ÁúãÁúã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Ê≥®ÂÜå‰∏≠ÂøÉÔºà‰∏âÔºâ‰πã Redis„Äã ‰∏ÄÊñá„ÄÇÊÄªÁöÑÊù•ËØ¥ÔºåÂÆûÁé∞‰∏äÔºåËøòÊòØËõÆÊúâË∂£ÁöÑ„ÄÇÂõ†‰∏∫ÔºåÈúÄË¶ÅÈÄöÁü•Âà∞Ê∂àË¥πËÄÖÔºåÊúçÂä°ÂàóË°®ÂèëÁîüÂèòÂåñÔºåÊâÄ‰ª•Â∞±Êó†Ê≥ï‰ΩøÁî® Redis Key Ëá™Âä®ËøáÊúü„ÄÇÊâÄ‰ª•‚Ä¶ ËøòÊòØÁúãÊñáÁ´†Âêß„ÄÇÂìàÂìàÂìàÂìà„ÄÇ Dubbo Consumer Âè™ËÉΩË∞ÉÁî®‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñÁöÑ Provider ‰πàÔºü‰∏çÊòØÔºåConsumer ÂèØ‰ª•Âº∫Âà∂Áõ¥Ëøû Provider „ÄÇ Âú®ÂºÄÂèëÂèäÊµãËØïÁéØÂ¢É‰∏ãÔºåÁªèÂ∏∏ÈúÄË¶ÅÁªïËøáÊ≥®ÂÜå‰∏≠ÂøÉÔºåÂè™ÊµãËØïÊåáÂÆöÊúçÂä°Êèê‰æõËÄÖÔºåËøôÊó∂ÂÄôÂèØËÉΩÈúÄË¶ÅÁÇπÂØπÁÇπÁõ¥ËøûÔºåÁÇπÂØπÁÇπÁõ¥ËøûÊñπÂºèÔºåÂ∞Ü‰ª•ÊúçÂä°Êé•Âè£‰∏∫Âçï‰ΩçÔºåÂøΩÁï•Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÊèê‰æõËÄÖÂàóË°®ÔºåA Êé•Âè£ÈÖçÁΩÆÁÇπÂØπÁÇπÔºå‰∏çÂΩ±Âìç B Êé•Âè£‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñÂàóË°®„ÄÇ Áõ∏ÂÖ≥ÊñáÊ°£ÔºåÂèØËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Áõ¥ËøûÊèê‰æõËÄÖ„Äã „ÄÇ Âè¶Â§ñÔºåÁõ¥Ëøû Dubbo Provider Êó∂ÔºåÂ¶ÇÊûúË¶Å Debug Ë∞ÉËØï Dubbo Provider ÔºåÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆÔºåÁ¶ÅÁî®ËØ• Provider Ê≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ„ÄÇÂê¶ÂàôÔºå‰ºöË¢´ÂÖ∂ÂÆÉ Consumer Ë∞ÉÁî®Âà∞„ÄÇÂÖ∑‰ΩìÁöÑÈÖçÁΩÆÊñπÂºèÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Âè™ËÆ¢ÈòÖ„Äã „ÄÇ Dubbo ÊîØÊåÅÂì™‰∫õÈÄö‰ø°ÂçèËÆÆÔºü ÂØπÂ∫î„Äêprotocol ËøúÁ®ãË∞ÉÁî®Â±Ç„Äë„ÄÇ Dubbo ÁõÆÂâçÊîØÊåÅÂ¶Ç‰∏ã 9 ÁßçÈÄö‰ø°ÂçèËÆÆÔºö „ÄêÈáçË¶Å„Äëdubbo:// ÔºåÈªòËÆ§ÂçèËÆÆ„ÄÇÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî dubbo://„Äã „ÄÇ „ÄêÈáçË¶Å„Äërest:// ÔºåË¥°ÁåÆËá™ Dubbox ÔºåÁõÆÂâçÊúÄÂêàÈÄÇÁöÑ HTTP Restful API ÂçèËÆÆ„ÄÇÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî rest://„Äã „ÄÇ rmi:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî rmi://„Äã „ÄÇ webservice:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî webservice://„Äã „ÄÇ hessian:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî hessian://„Äã „ÄÇ thrift:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî thrift://„Äã „ÄÇ memcached:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî memcached://„Äã „ÄÇ redis:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî redis://„Äã „ÄÇ http:// ÔºåÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî http://„Äã „ÄÇÊ≥®ÊÑèÔºåËøô‰∏™ÂíåÊàë‰ª¨ÁêÜËß£ÁöÑ HTTP ÂçèËÆÆÊúâÂ∑ÆÂºÇÔºåËÄåÊòØ Spring ÁöÑ HttpInvoker ÂÆûÁé∞„ÄÇ ÂÆûÈôÖ‰∏äÔºåÁ§æÂå∫ÈáåËøòÊúâÂÖ∂‰ªñÈÄö‰ø°ÂçèËÆÆÊ≠£Â§Ñ‰∫éÂ≠µÂåñÔºö jsonrpc:// ÔºåÂØπÂ∫î Github ‰ªìÂ∫ì‰∏∫ https://github.com/apache/incubator-dubbo-rpc-jsonrpc ÔºåÊù•Ëá™ÂçÉÁ±≥ÁΩëÁöÑË¥°ÁåÆ„ÄÇ üòà ÊØè‰∏ÄÁßçÈÄö‰ø°ÂçèËÆÆÁöÑÂÆûÁé∞ÔºåÂú® „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê„Äã ‰∏≠ÔºåÈÉΩÊúâËØ¶ÁªÜËß£Êûê„ÄÇ Âè¶Â§ñÔºåÂú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÊÄßËÉΩÊµãËØïÊä•Âëä„Äã ‰∏≠ÔºåÂÆòÊñπÊèê‰æõ‰∫Ü‰∏äËø∞ÂçèËÆÆÁöÑÊÄßËÉΩÊµãËØïÂØπÊØî„ÄÇ ‰ªÄ‰πàÊòØÊú¨Âú∞Êö¥Èú≤ÂíåËøúÁ®ãÊö¥Èú≤Ôºå‰ªñ‰ª¨ÁöÑÂå∫Âà´ÔºüËøúÁ®ãÊö¥Èú≤ÔºåÊØîËæÉÂ•ΩÁêÜËß£„ÄÇÂú® „ÄåDubbo ÊîØÊåÅÂì™‰∫õÈÄö‰ø°ÂçèËÆÆÔºü„Äç ÈóÆÈ¢òÊ±áÊÄªÔºåÊàë‰ª¨ÁúãÂà∞ÁöÑÔºåÈÉΩÊòØËøúÁ®ãÊö¥Èú≤„ÄÇÊØèÊ¨° Consumer Ë∞ÉÁî® Provider ÈÉΩÊòØË∑®ËøõÁ®ãÔºåÈúÄË¶ÅËøõË°åÁΩëÁªúÈÄö‰ø°„ÄÇ Êú¨Âú∞Êö¥Èú≤ÔºåÂú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Êú¨Âú∞Ë∞ÉÁî®„Äã ‰∏ÄÊñá‰∏≠ÔºåÂÆö‰πâÂ¶Ç‰∏ãÔºö Êú¨Âú∞Ë∞ÉÁî®‰ΩøÁî®‰∫Ü injvm:// ÂçèËÆÆÔºåÊòØ‰∏Ä‰∏™‰º™ÂçèËÆÆÔºåÂÆÉ‰∏çÂºÄÂêØÁ´ØÂè£Ôºå‰∏çÂèëËµ∑ËøúÁ®ãË∞ÉÁî®ÔºåÂè™Âú® JVM ÂÜÖÁõ¥Êé•ÂÖ≥ËÅîÔºå‰ΩÜÊâßË°å Dubbo ÁöÑ Filter Èìæ„ÄÇ ÊÄé‰πàÁêÜËß£Âë¢ÔºüÊú¨Âú∞ÁöÑ Dubbo Service Proxy ÂØπË±°ÔºåÊØèÊ¨°Ë∞ÉÁî®Êó∂Ôºå‰ºöËµ∞ Dubbo Filter Èìæ„ÄÇ ‰∏æ‰∏™‰æãÂ≠êÔºåSpring Boot Controller Ë∞ÉÁî® Service ÈÄªËæëÔºåÂ∞±ÂèòÊàê‰∫ÜË∞ÉÁî® Dubbo Service Proxy ÂØπË±°„ÄÇËøôÊ†∑ÔºåÂ¶ÇÊûúÊú™Êù•Êúâ‰∏ÄÂ§©ÔºåÊú¨Âú∞ Dubbo Service ËøÅÁßªÊàêËøúÁ®ãÁöÑ Dubbo Service ÔºåÂè™ÈúÄË¶ÅËøõË°åÈÖçÁΩÆÁöÑ‰øÆÊîπÔºåËÄåÂØπ Controller ÊòØÈÄèÊòéÁöÑ„ÄÇ Dubbo ‰ΩøÁî®‰ªÄ‰πàÈÄö‰ø°Ê°ÜÊû∂Ôºü ÂØπÂ∫î„Äêtransport ÁΩëÁªú‰º†ËæìÂ±Ç„Äë„ÄÇ Âú®ÈÄö‰ø°Ê°ÜÊû∂ÁöÑÈÄâÊã©‰∏äÔºåÂº∫Â§ßÁöÑÊäÄÊúØÁ§æÂå∫ÊúâÈùûÂ∏∏Â§öÁöÑÈÄâÊã©ÔºåÂ¶Ç‰∏ãÂàóË°®Ôºö Netty3 Netty4 Mina Grizzly ÈÇ£‰πà Dubbo ÊòØÂ¶Ç‰ΩïÂÅöÊäÄÊúØÈÄâÂûãÂíåÂÆûÁé∞ÁöÑÂë¢ÔºüDubbo Âú®ÈÄö‰ø°Â±ÇÊãÜÂàÜÊàê‰∫Ü API Â±Ç„ÄÅÂÆûÁé∞Â±Ç„ÄÇÈ°πÁõÆÁªìÊûÑÂ¶Ç‰∏ãÔºö API Â±ÇÔºö dubbo-remoting-api ÂÆûÁé∞Â±ÇÔºö dubbo-remoting-netty3 dubbo-remoting-netty4 dubbo-remoting-mina dubbo-remoting-grizzly ÂÜçÈÖçÂêà‰∏ä Dubbo SPI ÁöÑÊú∫Âà∂Ôºå‰ΩøÁî®ËÄÖÂèØ‰ª•Ëá™ÂÆö‰πâ‰ΩøÁî®Âì™‰∏ÄÁßçÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇÁæéÊªãÊªã„ÄÇ Âú® Dubbo ÁöÑÊúÄÊñ∞ÁâàÊú¨ÔºåÈªòËÆ§‰ΩøÁî® Netty4 ÁöÑÁâàÊú¨„ÄÇüòà ËøôÂ∞±ÊòØÁªìËÆ∫„ÄÇÂòªÂòª„ÄÇ Dubbo ÊîØÊåÅÂì™‰∫õÂ∫èÂàóÂåñÊñπÂºèÔºü ÂØπÂ∫î„Äêserialize Êï∞ÊçÆÂ∫èÂàóÂåñÂ±Ç„Äë„ÄÇ Dubbo ÁõÆÂâçÊîØ‰ªòÂ¶Ç‰∏ã 7 ÁßçÂ∫èÂàóÂåñÊñπÂºèÔºö „ÄêÈáçË¶Å„ÄëHessian2 ÔºöÂü∫‰∫é Hessian ÂÆûÁé∞ÁöÑÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ 1dubbo:// ÂçèËÆÆÁöÑÈªòËÆ§Â∫èÂàóÂåñÊñπÊ°à„ÄÇ Hessian Èô§‰∫ÜÊòØ Web ÊúçÂä°Ôºå‰πüÊèê‰æõ‰∫ÜÂÖ∂Â∫èÂàóÂåñÂÆûÁé∞ÔºåÂõ†Ê≠§ Dubbo Âü∫‰∫éÂÆÉÂÆûÁé∞‰∫ÜÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ Âè¶Â§ñÔºåDubbo Áª¥Êä§‰∫ÜËá™Â∑±ÁöÑ hessian-lite ÔºåÂØπ Hessian 2 ÁöÑ Â∫èÂàóÂåñ ÈÉ®ÂàÜÁöÑÁ≤æÁÆÄ„ÄÅÊîπËøõ„ÄÅBugFix „ÄÇ Dubbo ÔºöDubbo Ëá™Â∑±ÂÆûÁé∞ÁöÑÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ ÂÖ∑‰ΩìÂèØÂèÇËßÅ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Â∫èÂàóÂåñÔºà‰∫åÔºâ‰πã Dubbo ÂÆûÁé∞„Äã „ÄÇ Kryo ÔºöÂü∫‰∫é Kryo ÂÆûÁé∞ÁöÑÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ ÂÖ∑‰ΩìÂèØÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Kryo Â∫èÂàóÂåñ„Äã FST ÔºöÂü∫‰∫é FST ÂÆûÁé∞ÁöÑÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ ÂÖ∑‰ΩìÂèØÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî FST Â∫èÂàóÂåñ„Äã JSON ÔºöÂü∫‰∫é Fastjson ÂÆûÁé∞ÁöÑÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ NativeJava ÔºöÂü∫‰∫é Java ÂéüÁîüÁöÑÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ CompactedJava ÔºöÂú® NativeJava ÁöÑÂü∫Á°Ä‰∏äÔºåÂÆûÁé∞‰∫ÜÂØπ ClassDescriptor ÁöÑÂ§ÑÁêÜ„ÄÇ ÂèØËÉΩËÉñÂèã‰ºö‰∏ÄËÑ∏ÊáµÈÄºÔºåÊúâËøô‰πàÂ§öÔºüÂÖ∂ÂÆûËøòÂ•ΩÔºå‰∏äËø∞Âü∫Êú¨ÊòØÂ∏ÇÈù¢‰∏ä‰∏ªÊµÅÁöÑÈõÜ‰∏≠Â∫èÂàóÂåñÂ∑•ÂÖ∑ÔºåDubbo Âü∫‰∫éÂÆÉ‰ª¨‰πã‰∏äÊèê‰æõÂ∫èÂàóÂåñÊãìÂ±ï„ÄÇ ÁÑ∂ÂêéÔºåËÉñÂèãÂèØËÉΩ‰ºöËØ¥ÔºåProtobuf ‰πüÊòØÈùûÂ∏∏‰ºòÁßÄÁöÑÂ∫èÂàóÂåñÊñπÊ°àÔºå‰∏∫‰ªÄ‰πà Dubbo Ê≤°ÊúâÂü∫‰∫éÂÆÉÁöÑÂ∫èÂàóÂåñÊãìÂ±ïÔºü‰ªé Dubbo ÂêéÁª≠ÁöÑÂºÄÂèëËÆ°Âàí‰∏äÔºåÂ∫îËØ•‰ºöÂ¢ûÂä†ËØ•Â∫èÂàóÂåñÁöÑÊîØÊåÅ„ÄÇÂè¶Â§ñÔºåÂæÆÂçöÁöÑ Motan ÊúâÂÆûÁé∞ÂØπ Protobuf Â∫èÂàóÂåñÁöÑÊîØÊåÅÔºåÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÂèØ‰ª•ÁúãÁúã „ÄäÊ∑±ÂÖ•ÁêÜËß£RPC‰πãÂ∫èÂàóÂåñÁØá ‚Äî‚Äî ÊÄªÁªìÁØá„Äã ÁöÑ „ÄåProtostuffÂÆûÁé∞„Äç Â∞èËäÇ„ÄÇ Dubbo ÊúâÂì™‰∫õË¥üËΩΩÂùáË°°Á≠ñÁï•Ôºü ÂØπÂ∫î„Äêcluster Ë∑ØÁî±Â±Ç„ÄëÁöÑ LoadBalance ÁªÑ‰ª∂„ÄÇ Âú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Ë¥üËΩΩÂùáË°°„Äã ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ Dubbo ÂÜÖÁΩÆ 4 ÁßçË¥üËΩΩÂùáË°°Á≠ñÁï•„ÄÇÂÖ∂‰∏≠ÔºåÈªòËÆ§‰ΩøÁî® random ÈöèÊú∫Ë∞ÉÁî®Á≠ñÁï•„ÄÇ Random LoadBalance ÈöèÊú∫ÔºåÊåâÊùÉÈáçËÆæÁΩÆÈöèÊú∫Ê¶ÇÁéá„ÄÇ Âú®‰∏Ä‰∏™Êà™Èù¢‰∏äÁ¢∞ÊíûÁöÑÊ¶ÇÁéáÈ´òÔºå‰ΩÜË∞ÉÁî®ÈáèË∂äÂ§ßÂàÜÂ∏ÉË∂äÂùáÂåÄÔºåËÄå‰∏îÊåâÊ¶ÇÁéá‰ΩøÁî®ÊùÉÈáçÂêé‰πüÊØîËæÉÂùáÂåÄÔºåÊúâÂà©‰∫éÂä®ÊÄÅË∞ÉÊï¥Êèê‰æõËÄÖÊùÉÈáç„ÄÇ RoundRobin LoadBalance ËΩÆËØ¢ÔºåÊåâÂÖ¨Á∫¶ÂêéÁöÑÊùÉÈáçËÆæÁΩÆËΩÆËØ¢ÊØîÁéá„ÄÇ Â≠òÂú®ÊÖ¢ÁöÑÊèê‰æõËÄÖÁ¥ØÁßØËØ∑Ê±ÇÁöÑÈóÆÈ¢òÔºåÊØîÂ¶ÇÔºöÁ¨¨‰∫åÂè∞Êú∫Âô®ÂæàÊÖ¢Ôºå‰ΩÜÊ≤°ÊåÇÔºåÂΩìËØ∑Ê±ÇË∞ÉÂà∞Á¨¨‰∫åÂè∞Êó∂Â∞±Âç°Âú®ÈÇ£Ôºå‰πÖËÄå‰πÖ‰πãÔºåÊâÄÊúâËØ∑Ê±ÇÈÉΩÂç°Âú®Ë∞ÉÂà∞Á¨¨‰∫åÂè∞‰∏ä„ÄÇ ‰∏æ‰∏™Ê†óÂ≠ê„ÄÇ Ë∑üËøêÁª¥ÂêåÂ≠¶Áî≥ËØ∑Êú∫Âô®ÔºåÊúâÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ËøêÊ∞îÂ•ΩÔºåÊ≠£Â•ΩÂÖ¨Âè∏ËµÑÊ∫êÊØîËæÉÂÖÖË∂≥ÔºåÂàöÂàöÊúâ‰∏ÄÊâπÁÉ≠Ê∞îËÖæËÖæ„ÄÅÂàöÂàöÂÅöÂ•ΩÁöÑ‰∏ÄÊâπËôöÊãüÊú∫Êñ∞È≤úÂá∫ÁÇâÔºåÈÖçÁΩÆÈÉΩÊØîËæÉÈ´ò„ÄÇ8Ê†∏+16gÔºåÊú∫Âô®Ôºå2 Âè∞„ÄÇËøá‰∫Ü‰∏ÄÊÆµÊó∂Èó¥ÔºåÊàëÊÑüËßâ 2 Âè∞Êú∫Âô®ÊúâÁÇπ‰∏çÂ§™Â§üÔºåÊàëÂéªÊâæËøêÁª¥ÂêåÂ≠¶ÔºåÂì•ÂÑø‰ª¨Ôºå‰Ω†ËÉΩ‰∏çËÉΩÂÜçÁªôÊàë 1 Âè∞Êú∫Âô®Ôºå4Ê†∏+8GÁöÑÊú∫Âô®„ÄÇÊàëËøòÊòØÂæóË¶Å„ÄÇ Ëøô‰∏™Êó∂ÂÄôÔºåÂèØ‰ª•Áªô‰∏§Âè∞ 8Ê†∏16g ÁöÑÊú∫Âô®ËÆæÁΩÆÊùÉÈáç 4ÔºåÁªôÂâ©‰Ωô 1 Âè∞ 4Ê†∏8G ÁöÑÊú∫Âô®ËÆæÁΩÆÊùÉÈáç 2„ÄÇ LeastActive LoadBalance ÊúÄÂ∞ëÊ¥ªË∑ÉË∞ÉÁî®Êï∞ÔºåÁõ∏ÂêåÊ¥ªË∑ÉÊï∞ÁöÑÈöèÊú∫ÔºåÊ¥ªË∑ÉÊï∞ÊåáË∞ÉÁî®ÂâçÂêéËÆ°Êï∞Â∑Æ„ÄÇ ‰ΩøÊÖ¢ÁöÑÊèê‰æõËÄÖÊî∂Âà∞Êõ¥Â∞ëËØ∑Ê±ÇÔºåÂõ†‰∏∫Ë∂äÊÖ¢ÁöÑÊèê‰æõËÄÖÁöÑË∞ÉÁî®ÂâçÂêéËÆ°Êï∞Â∑Æ‰ºöË∂äÂ§ß„ÄÇ Ëøô‰∏™Â∞±ÊòØËá™Âä®ÊÑüÁü•‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊüê‰∏™Êú∫Âô®ÊÄßËÉΩË∂äÂ∑ÆÔºåÈÇ£‰πàÊé•Êî∂ÁöÑËØ∑Ê±ÇË∂äÂ∞ëÔºåË∂ä‰∏çÊ¥ªË∑ÉÔºåÊ≠§Êó∂Â∞±‰ºöÁªô‰∏çÊ¥ªË∑ÉÁöÑÊÄßËÉΩÂ∑ÆÁöÑÊú∫Âô®Êõ¥Â∞ëÁöÑËØ∑Ê±Ç„ÄÇ ConsistentHash LoadBalance ‰∏ÄËá¥ÊÄß HashÔºåÁõ∏ÂêåÂèÇÊï∞ÁöÑËØ∑Ê±ÇÊÄªÊòØÂèëÂà∞Âêå‰∏ÄÊèê‰æõËÄÖ„ÄÇ ÂΩìÊüê‰∏ÄÂè∞Êèê‰æõËÄÖÊåÇÊó∂ÔºåÂéüÊú¨ÂèëÂæÄËØ•Êèê‰æõËÄÖÁöÑËØ∑Ê±ÇÔºåÂü∫‰∫éËôöÊãüËäÇÁÇπÔºåÂπ≥ÊëäÂà∞ÂÖ∂ÂÆÉÊèê‰æõËÄÖÔºå‰∏ç‰ºöÂºïËµ∑ÂâßÁÉàÂèòÂä®„ÄÇ Dubbo ÊúâÂì™‰∫õÈõÜÁæ§ÂÆπÈîôÁ≠ñÁï•Ôºü ÂØπÂ∫î„Äêcluster Ë∑ØÁî±Â±Ç„ÄëÁöÑ Cluster ÁªÑ‰ª∂„ÄÇ Âú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîô„Äã ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ Dubbo ÂÜÖÁΩÆ 6 ÁßçË¥üËΩΩÂùáË°°Á≠ñÁï•„ÄÇÂÖ∂‰∏≠ÔºåÈªòËÆ§‰ΩøÁî® failover Â§±Ë¥•Ëá™Âä®ÈáçËØïÂÖ∂‰ªñÊúçÂä°ÁöÑÁ≠ñÁï•„ÄÇ Failover Cluster Â§±Ë¥•Ëá™Âä®ÂàáÊç¢ÔºåÂΩìÂá∫Áé∞Â§±Ë¥•ÔºåÈáçËØïÂÖ∂ÂÆÉÊúçÂä°Âô®„ÄÇÈÄöÂ∏∏Áî®‰∫éËØªÊìç‰ΩúÔºå‰ΩÜÈáçËØï‰ºöÂ∏¶Êù•Êõ¥ÈïøÂª∂Ëøü„ÄÇÂèØÈÄöËøá retries=&quot;2&quot; Êù•ËÆæÁΩÆÈáçËØïÊ¨°Êï∞(‰∏çÂê´Á¨¨‰∏ÄÊ¨°)„ÄÇ Failfast Cluster Âø´ÈÄüÂ§±Ë¥•ÔºåÂè™ÂèëËµ∑‰∏ÄÊ¨°Ë∞ÉÁî®ÔºåÂ§±Ë¥•Á´ãÂç≥Êä•Èîô„ÄÇÈÄöÂ∏∏Áî®‰∫éÈùûÂπÇÁ≠âÊÄßÁöÑÂÜôÊìç‰ΩúÔºåÊØîÂ¶ÇÊñ∞Â¢ûËÆ∞ÂΩï„ÄÇ Failsafe Cluster Â§±Ë¥•ÂÆâÂÖ®ÔºåÂá∫Áé∞ÂºÇÂ∏∏Êó∂ÔºåÁõ¥Êé•ÂøΩÁï•„ÄÇÈÄöÂ∏∏Áî®‰∫éÂÜôÂÖ•ÂÆ°ËÆ°Êó•ÂøóÁ≠âÊìç‰Ωú„ÄÇ Failback Cluster Â§±Ë¥•Ëá™Âä®ÊÅ¢Â§çÔºåÂêéÂè∞ËÆ∞ÂΩïÂ§±Ë¥•ËØ∑Ê±ÇÔºåÂÆöÊó∂ÈáçÂèë„ÄÇÈÄöÂ∏∏Áî®‰∫éÊ∂àÊÅØÈÄöÁü•Êìç‰Ωú„ÄÇ Forking Cluster Âπ∂Ë°åË∞ÉÁî®Â§ö‰∏™ÊúçÂä°Âô®ÔºåÂè™Ë¶Å‰∏Ä‰∏™ÊàêÂäüÂç≥ËøîÂõû„ÄÇÈÄöÂ∏∏Áî®‰∫éÂÆûÊó∂ÊÄßË¶ÅÊ±ÇËæÉÈ´òÁöÑËØªÊìç‰ΩúÔºå‰ΩÜÈúÄË¶ÅÊµ™Ë¥πÊõ¥Â§öÊúçÂä°ËµÑÊ∫ê„ÄÇÂèØÈÄöËøá forks=&quot;2&quot; Êù•ËÆæÁΩÆÊúÄÂ§ßÂπ∂Ë°åÊï∞„ÄÇ Broadcast Cluster ÂπøÊí≠Ë∞ÉÁî®ÊâÄÊúâÊèê‰æõËÄÖÔºåÈÄê‰∏™Ë∞ÉÁî®Ôºå‰ªªÊÑè‰∏ÄÂè∞Êä•ÈîôÂàôÊä•Èîô„ÄÇÈÄöÂ∏∏Áî®‰∫éÈÄöÁü•ÊâÄÊúâÊèê‰æõËÄÖÊõ¥Êñ∞ÁºìÂ≠òÊàñÊó•ÂøóÁ≠âÊú¨Âú∞ËµÑÊ∫ê‰ø°ÊÅØ„ÄÇ Dubbo ÊúâÂì™‰∫õÂä®ÊÄÅ‰ª£ÁêÜÁ≠ñÁï•Ôºü ÂØπÂ∫î„Äêproxy ÊúçÂä°‰ª£ÁêÜÂ±Ç„Äë„ÄÇ ÂèØËÉΩÊúâËÉñÂèãÂØπÂä®ÊÄÅ‰ª£ÁêÜ‰∏çÊòØÂæà‰∫ÜËß£„ÄÇÂõ†‰∏∫ÔºåConsumer ‰ªÖ‰ªÖÂºïÁî®ÊúçÂä° ***-api.jar ÂåÖÔºåÈÇ£‰πàÂèØ‰ª•Ëé∑ÂæóÂà∞ÈúÄË¶ÅÊúçÂä°ÁöÑ XXXService Êé•Âè£„ÄÇÈÇ£‰πàÔºåÈÄöËøáÂä®ÊÄÅÂàõÂª∫ÂØπÂ∫îË∞ÉÁî® Dubbo ÊúçÂä°ÁöÑÂÆûÁé∞Á±ª„ÄÇÁÆÄÂåñ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112// ProxyFactory.java/** * create proxy. * * ÂàõÂª∫ Proxy ÔºåÂú®ÂºïÁî®ÊúçÂä°Ë∞ÉÁî®„ÄÇ * * @param invoker Invoker ÂØπË±° * @return proxy */@Adaptive(&#123;Constants.PROXY_KEY&#125;)&lt;T&gt; T getProxy(Invoker&lt;T&gt; invoker) throws RpcException; ÊñπÊ≥ïÂèÇÊï∞ invoker ÔºåÂÆûÁé∞‰∫ÜË∞ÉÁî® Dubbo ÊúçÂä°ÁöÑÈÄªËæë„ÄÇ ËøîÂõûÁöÑ &lt;T&gt; ÁªìÊûúÔºåÂ∞±ÊòØ XXXService ÁöÑÂÆûÁé∞Á±ªÔºåËÄåËøô‰∏™ÂÆûÁé∞Á±ªÔºåÂ∞±ÊòØÈÄöËøáÂä®ÊÄÅ‰ª£ÁêÜÁöÑÂ∑•ÂÖ∑Á±ªËøõË°åÁîüÊàê„ÄÇ ÈÄöËøáÂä®ÊÄÅ‰ª£ÁêÜÁöÑÊñπÂºèÔºåÂÆûÁé∞‰∫ÜÂØπ‰∫éÊàë‰ª¨ÂºÄÂèë‰ΩøÁî® Dubbo Êó∂ÔºåÈÄèÊòéÁöÑÊïàÊûú„ÄÇÂΩìÁÑ∂ÔºåÂõ†‰∏∫ÂÆûÈôÖÂú∫ÊôØ‰∏ãÔºåÊàë‰ª¨ÊòØÁªìÂêà Spring Âú∫ÊôØÂú®‰ΩøÁî®ÔºåÊâÄ‰ª•‰∏ç‰ºöÁõ¥Êé•‰ΩøÁî®ËØ• API „ÄÇ ÁõÆÂâçÂÆûÁé∞Âä®ÊÄÅ‰ª£ÁêÜÁöÑÂ∑•ÂÖ∑Á±ªËøòÊòØËõÆÂ§öÁöÑÔºåÂ¶Ç‰∏ãÔºö Javassist JDK ÂéüÁîüËá™Â∏¶ CGLIB ASM ÂÖ∂‰∏≠ÔºåDubbo Âä®ÊÄÅ‰ª£ÁêÜ‰ΩøÁî®‰∫Ü Javassist Âíå JDK ‰∏§ÁßçÊñπÂºè„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî® Javassist „ÄÇ ÂèØÈÄöËøá SPI Êú∫Âà∂ÔºåÂàáÊç¢‰ΩøÁî® JDK ÁöÑÊñπÂºè„ÄÇ ‰∏∫‰ªÄ‰πàÈªòËÆ§‰ΩøÁî® JavassistÔºü Âú® Dubbo ÂºÄÂèëËÄÖ„ÄêÊ¢ÅÈ£û„ÄëÁöÑÂçöÂÆ¢ „ÄäÂä®ÊÄÅ‰ª£ÁêÜÊñπÊ°àÊÄßËÉΩÂØπÊØî„Äã ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ËøôÂá†ÁßçÊñπÂºèÁöÑÊÄßËÉΩÂ∑ÆÂºÇÔºåËÄå Javassit ÊéíÂú®Á¨¨‰∏Ä„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂõ†‰∏∫ÊÄßËÉΩÁöÑÂéüÂõ†„ÄÇ Êúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÔºåJavassit Êèê‰æõÂ≠óËäÇÁ†Å bytecode ÁîüÊàêÊñπÂºèÂíåÂä®ÊÄÅ‰ª£ÁêÜÊé•Âè£‰∏§ÁßçÊñπÂºè„ÄÇÂêéËÄÖÁöÑÊÄßËÉΩÊØî JDK Ëá™Â∏¶ÁöÑËøòÊÖ¢ÔºåÊâÄ‰ª• Dubbo ‰ΩøÁî®ÁöÑÊòØÂâçËÄÖÂ≠óËäÇÁ†Å bytecode ÁîüÊàêÊñπÂºè„ÄÇ ÈÇ£‰πàÊòØ‰∏çÊòØ JDK ‰ª£ÁêÜÂ∞±Ê≤°ÊÑè‰πâÔºü ÂÆûÈôÖ‰∏äÔºåJDK ‰ª£ÁêÜÂú® JDK 1.8 ÁâàÊú¨‰∏ãÔºåÊÄßËÉΩÂ∑≤ÁªèÊúâÂæàÂ§ßÁöÑÊèêÂçáÔºåÂπ∂‰∏îÊó†ÈúÄÂºïÂÖ•‰∏âÊñπÂ∑•ÂÖ∑ÁöÑ‰æùËµñÔºå‰πüÊòØÈùûÂ∏∏Ê£íÁöÑÈÄâÊã©„ÄÇÊâÄ‰ª•ÔºåSpring Âíå Motan Âú®Âä®ÊÄÅ‰ª£ÁêÜÁîüÊàê‰∏äÔºå‰ºòÂÖàÈÄâÊã© JDK ‰ª£ÁêÜ„ÄÇ Ê≥®ÊÑèÔºåSpring ÂêåÊó∂‰πüÈÄâÊã©‰∫Ü CGLIB ‰Ωú‰∏∫ÁîüÊàêÂä®ÊÄÅ‰ª£ÁêÜÁöÑÂ∑•ÂÖ∑‰πã‰∏Ä„ÄÇ Êõ¥Â§öÁöÑÂÜÖÂÆπÔºåÈùûÂ∏∏Êé®ËçêÈòÖËØªÂæêÂ¶àÁöÑ „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πãÂä®ÊÄÅ‰ª£ÁêÜÁØá„Äã „ÄÇÂæàÊ£íÔºÅ Dubbo SPI ÁöÑËÆæËÆ°ÊÄùÊÉ≥ÊòØ‰ªÄ‰πàÔºüÈ¶ñÂÖàÁöÑÈ¶ñÂÖàÔºåÊàë‰ª¨ÂæóÊù•ÁêÜËß£ Java SPI ÊòØ‰ªÄ‰πàÔºüÂõ†‰∏∫ÂæêÂ¶àÂú®ËøôÂùóÂ∑≤ÁªèÂÜô‰∫ÜÈùûÂ∏∏ÈùûÂ∏∏ÈùûÂ∏∏‰∏çÈîôÁöÑÊñáÁ´†ÔºåÊàë‰ª¨Áõ¥Êé•ËÆ§ÁúüÔºå‰∏ÄÂÆöË¶ÅËÆ§ÁúüÁúã „ÄäJAVA ÊãæÈÅó ‚Äî‚Äî ÂÖ≥‰∫é SPI Êú∫Âà∂„Äã „ÄÇ ÈÇ£‰πàÊó¢ÁÑ∂ Java SPI Êú∫Âà∂Â∑≤ÁªèËøô‰πàÁâõÈÄºÔºå‰∏∫‰ªÄ‰πà Dubbo ËøòË¶ÅËá™Â∑±ÂÆûÁé∞ Dubbo SPI Êú∫Âà∂Âë¢ÔºüËâØÂøÉÁöÑ Dubbo Âú® „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Êâ©Â±ïÁÇπÂä†ËΩΩ„Äã ‰∏≠ÔºåÁªôÂá∫‰∫ÜÁ≠îÊ°àÔºö 1„ÄÅJDK Ê†áÂáÜÁöÑ SPI ‰ºö‰∏ÄÊ¨°ÊÄßÂÆû‰æãÂåñÊâ©Â±ïÁÇπÊâÄÊúâÂÆûÁé∞ÔºåÂ¶ÇÊûúÊúâÊâ©Â±ïÂÆûÁé∞ÂàùÂßãÂåñÂæàËÄóÊó∂Ôºå‰ΩÜÂ¶ÇÊûúÊ≤°Áî®‰∏ä‰πüÂä†ËΩΩÔºå‰ºöÂæàÊµ™Ë¥πËµÑÊ∫ê„ÄÇ 2„ÄÅÂ¶ÇÊûúÊâ©Â±ïÁÇπÂä†ËΩΩÂ§±Ë¥•ÔºåËøûÊâ©Â±ïÁÇπÁöÑÂêçÁß∞ÈÉΩÊãø‰∏çÂà∞‰∫Ü„ÄÇÊØîÂ¶ÇÔºöJDK Ê†áÂáÜÁöÑ ScriptEngineÔºåÈÄöËøá getName() Ëé∑ÂèñËÑöÊú¨Á±ªÂûãÁöÑÂêçÁß∞Ôºå‰ΩÜÂ¶ÇÊûú RubyScriptEngine Âõ†‰∏∫ÊâÄ‰æùËµñÁöÑ jruby.jar ‰∏çÂ≠òÂú®ÔºåÂØºËá¥ RubyScriptEngine Á±ªÂä†ËΩΩÂ§±Ë¥•ÔºåËøô‰∏™Â§±Ë¥•ÂéüÂõ†Ë¢´ÂêÉÊéâ‰∫ÜÔºåÂíå ruby ÂØπÂ∫î‰∏çËµ∑Êù•ÔºåÂΩìÁî®Êà∑ÊâßË°å ruby ËÑöÊú¨Êó∂Ôºå‰ºöÊä•‰∏çÊîØÊåÅ rubyÔºåËÄå‰∏çÊòØÁúüÊ≠£Â§±Ë¥•ÁöÑÂéüÂõ†„ÄÇ 3„ÄÅÂ¢ûÂä†‰∫ÜÂØπÊâ©Â±ïÁÇπ IoC Âíå AOP ÁöÑÊîØÊåÅÔºå‰∏Ä‰∏™Êâ©Â±ïÁÇπÂèØ‰ª•Áõ¥Êé• setter Ê≥®ÂÖ•ÂÖ∂ÂÆÉÊâ©Â±ïÁÇπ„ÄÇ ‰ªÄ‰πàÊÑèÊÄùÂë¢Ôºü Á¨¨‰∏ÄÁÇπÈóÆÈ¢òÔºåDubbo ÊúâÂæàÂ§öÁöÑÊãìÂ±ïÁÇπÔºå‰æãÂ¶Ç Protocol„ÄÅFilter Á≠âÁ≠â„ÄÇÂπ∂‰∏îÊØè‰∏™ÊãìÂ±ïÁÇπÊúâÂ§öÁßçÁöÑÂÆûÁé∞Ôºå‰æãÂ¶Ç Protocol Êúâ DubboProtocol„ÄÅInjvmProtocol„ÄÅRestProtocol Á≠âÁ≠â„ÄÇÈÇ£‰πà‰ΩøÁî® JDK SPI Êú∫Âà∂Ôºå‰ºöÂàùÂßãÂåñÊó†Áî®ÁöÑÊãìÂ±ïÁÇπÂèäÂÖ∂ÂÆûÁé∞ÔºåÈÄ†Êàê‰∏çÂøÖË¶ÅÁöÑËÄóÊó∂‰∏éËµÑÊ∫êÊµ™Ë¥π„ÄÇ Á¨¨‰∫åÁÇπÈóÆÈ¢òÔºåÂõ†‰∏∫Ê≤°Áî®Ëøá ScriptEngine ÔºåÊâÄ‰ª•Áúã‰∏çÊáÇÔºåÂìàÂìàÂìàÂìà„ÄÇ Á¨¨‰∏âÁÇπÈóÆÈ¢òÔºå‰∏•Ê†ºÊù•ËØ¥ÔºåËøô‰∏çÁÆóÈóÆÈ¢òÔºåËÄåÊòØÂ¢ûÂä†‰∫ÜÂäüËÉΩÁâπÊÄßÔºåÊõ¥Â§öÁöÑÊèêÁé∞ÊòØÔºåDubbo SPI Êèê‰æõÁ±ª‰ºº Spring IoC Âíå AOP ÁöÑÂäüËÉΩ„ÄÇ Â¶ÇÊûúÂ¶ÇÊûúÂ¶ÇÊûúÊÉ≥Ë¶ÅÊ∑±ÂÖ•ÁêÜËß£ Dubbo SPI ‰ΩìÁ≥ªÔºåËÉñÂèãÂèØ‰ª•ÈòÖËØª „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ÊãìÂ±ïÊú∫Âà∂ SPI„Äã „ÄÇËâøËØùËØ¥ÁöÑÂ•ΩÔºåËØªÊáÇ Dubbo SPI ÁöÑÊ∫êÁ†ÅÔºå‰Ω†Â∞±ËØªÊáÇ‰∫Ü‰∏ÄÂçä Dubbo ÁöÑÊ∫êÁ†Å„ÄÇ Â¶ÇÊûúËØ¥ÔºåËÉñÂèãÊÉ≥Ë¶ÅËá™ÂÆö‰πâ‰∏Ä‰∏™ Dubbo SPI Êüê‰∏™ÊãìÂ±ïÁÇπÁöÑÂÆûÁé∞ÔºåÂèØ‰ª•ÈòÖËØª „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Êâ©Â±ïÁÇπÂä†ËΩΩ„Äã „ÄÇÂΩìÁÑ∂ÔºåÂ¶ÇÊûú‰Ω†ÊòØÈ¶ñÊ¨°ÂÜôÔºåÂèØËÉΩ‰ºöÊúâ‰∏Ä‰∏¢‰∏¢Â§çÊùÇ„ÄÇÂÆûÈôÖÂú∫ÊôØ‰∏ãÔºåÊàë‰ª¨ÂÜôÁöÑÊúÄÂ§öÁöÑÊòØ Filter Ë∞ÉÁî®Êã¶Êà™Êâ©Â±ï „ÄÇÊâÄ‰ª•ÔºåÊí∏Ëµ∑Ë¢ñÂ≠êÔºåÊù•‰∏ÄÂèëÔºÅ ÂΩìÁÑ∂ÔºåËôΩÁÑ∂ Dubbo ÂÆûÁé∞‰∫Ü Dubbo SPI ÔºåËøôÂπ∂ÊÑèÂë≥ÁùÄ Java SPI ‰∏çÂ•ΩÁî®„ÄÇÂÆûÈôÖ‰∏äÔºåJava SPI Ë¢´Â§ßÈáè‰∏≠Èó¥‰ª∂ÊâÄÈááÁî®Ôºå‰æãÂ¶Ç Tomcat„ÄÅSkyWalking„ÄÅJDBC Á≠âÁ≠â„ÄÇ ÂÜçÂºïÁî≥‰∏ãÔºåÊúâ‰∫õÂàÅÈíªÁöÑÈù¢ËØïÂÆòÔºåÂèØËÉΩ‰ºöËÆ©‰Ω†ÂÖàËÆ≤ËÆ≤ Spring IoC ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºåDubbo SPI ÊòØÊÄé‰πàÊèê‰æõ IoC ÂäüËÉΩÁöÑÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•ÁúãÁúãÂ¶Ç‰∏ã‰∏§ÁØáÊñáÁ´†Êù•ÂáÜÂ§áÔºö Spring IoC Ôºå„ÄäÈù¢ËØïÈóÆÁÉÇÁöÑ Spring IoC ËøáÁ®ã„Äã „ÄÇ Dubbo SPI IoC Ôºå„ÄäDubbo SPI Êú∫Âà∂Âíå IoC„Äã ÁöÑ „ÄåIOC Ê≥®ÂÖ•„Äç„ÄÇ ÂÜçÂÜçÂºïÁî≥‰∏ãÔºåÊúâ‰∫õÂàÅÈíªÁöÑÈù¢ËØïÂÆòÔºåÂèØËÉΩ‰ºöËÆ©‰Ω†ÂÖàËÆ≤ËÆ≤ Spring AOP ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºåDubbo SPI ÊòØÊÄé‰πàÊèê‰æõ AOP ÂäüËÉΩÁöÑÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•ÁúãÁúãÂ¶Ç‰∏ã‰∏§ÁØáÊñáÁ´†Êù•ÂáÜÂ§áÔºö Spring AOP Ôºå„ÄäÈù¢ËØïÈóÆÁÉÇÁöÑ Spring AOP ÂéüÁêÜ„Äã „ÄÇ Dubbo SPI AOP ÔºåËØ¶ÁªÜËßÅ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ÊãìÂ±ïÊú∫Âà∂ SPI„Äã ÊñáÁ´†„ÄÇÊ†∏ÂøÉÊ∫êÁ†ÅÊòØÔºö 123456789101112131415161718192021222324252627282930313233private static final ConcurrentMap&lt;Class&lt;?&gt;, Object&gt; EXTENSION_INSTANCES = new ConcurrentHashMap&lt;Class&lt;?&gt;, Object&gt;(); 1: 7: @SuppressWarnings("unchecked") 8: private T createExtension(String name) &#123; 9: // Ëé∑ÂæóÊãìÂ±ïÂêçÂØπÂ∫îÁöÑÊãìÂ±ïÂÆûÁé∞Á±ª 10: Class&lt;?&gt; clazz = getExtensionClasses().get(name); 11: if (clazz == null) &#123; 12: throw findException(name); // ÊäõÂá∫ÂºÇÂ∏∏ 13: &#125; 14: try &#123; 15: // ‰ªéÁºìÂ≠ò‰∏≠ÔºåËé∑ÂæóÊãìÂ±ïÂØπË±°„ÄÇ 16: T instance = (T) EXTENSION_INSTANCES.get(clazz); 17: if (instance == null) &#123; 18: // ÂΩìÁºìÂ≠ò‰∏çÂ≠òÂú®Êó∂ÔºåÂàõÂª∫ÊãìÂ±ïÂØπË±°ÔºåÂπ∂Ê∑ªÂä†Âà∞ÁºìÂ≠ò‰∏≠„ÄÇ 19: EXTENSION_INSTANCES.putIfAbsent(clazz, clazz.newInstance()); 20: instance = (T) EXTENSION_INSTANCES.get(clazz); 21: &#125; 22: // Ê≥®ÂÖ•‰æùËµñÁöÑÂ±ûÊÄß 23: injectExtension(instance); 24: // ÂàõÂª∫ Wrapper ÊãìÂ±ïÂØπË±° 25: Set&lt;Class&lt;?&gt;&gt; wrapperClasses = cachedWrapperClasses; 26: if (wrapperClasses != null &amp;&amp; !wrapperClasses.isEmpty()) &#123; 27: for (Class&lt;?&gt; wrapperClass : wrapperClasses) &#123; 28: instance = injectExtension((T) wrapperClass.getConstructor(type).newInstance(instance)); 29: &#125; 30: &#125; 31: return instance; 32: &#125; catch (Throwable t) &#123; 33: throw new IllegalStateException("Extension instance(name: " + name + ", class: " + 34: type + ") could not be instantiated: " + t.getMessage(), t); 35: &#125; 36: &#125; Á¨¨ 24 Ëá≥ 30 Ë°åÔºöÂàõÂª∫ Wrapper ÊãìÂ±ïÂØπË±°ÔºåÂ∞Ü instance ÂåÖË£ÖÂú®ÂÖ∂‰∏≠„ÄÇÂú® „ÄäDubbo ÂºÄÂèëÊåáÂçó ‚Äî‚Äî Êâ©Â±ïÁÇπÂä†ËΩΩ„Äã ÊñáÁ´†‰∏≠ÔºåÂ¶ÇÊ≠§‰ªãÁªç Wrapper Á±ªÔºö Wrapper Á±ªÂêåÊ†∑ÂÆûÁé∞‰∫ÜÊâ©Â±ïÁÇπÊé•Âè£Ôºå‰ΩÜÊòØ Wrapper ‰∏çÊòØÊâ©Â±ïÁÇπÁöÑÁúüÊ≠£ÂÆûÁé∞„ÄÇÂÆÉÁöÑÁî®ÈÄî‰∏ªË¶ÅÊòØÁî®‰∫é‰ªé ExtensionLoader ËøîÂõûÊâ©Â±ïÁÇπÊó∂ÔºåÂåÖË£ÖÂú®ÁúüÊ≠£ÁöÑÊâ©Â±ïÁÇπÂÆûÁé∞Â§ñ„ÄÇÂç≥‰ªé ExtensionLoader ‰∏≠ËøîÂõûÁöÑÂÆûÈôÖ‰∏äÊòØ Wrapper Á±ªÁöÑÂÆû‰æãÔºåWrapper ÊåÅÊúâ‰∫ÜÂÆûÈôÖÁöÑÊâ©Â±ïÁÇπÂÆûÁé∞Á±ª„ÄÇ Êâ©Â±ïÁÇπÁöÑ Wrapper Á±ªÂèØ‰ª•ÊúâÂ§ö‰∏™Ôºå‰πüÂèØ‰ª•Ê†πÊçÆÈúÄË¶ÅÊñ∞Â¢û„ÄÇ ÈÄöËøá Wrapper Á±ªÂèØ‰ª•ÊääÊâÄÊúâÊâ©Â±ïÁÇπÂÖ¨ÂÖ±ÈÄªËæëÁßªËá≥ Wrapper ‰∏≠„ÄÇÊñ∞Âä†ÁöÑ Wrapper Âú®ÊâÄÊúâÁöÑÊâ©Â±ïÁÇπ‰∏äÊ∑ªÂä†‰∫ÜÈÄªËæëÔºåÊúâ‰∫õÁ±ª‰ºº AOPÔºåÂç≥ Wrapper ‰ª£ÁêÜ‰∫ÜÊâ©Â±ïÁÇπ„ÄÇ ‰æãÂ¶ÇÔºöListenerExporterWrapper„ÄÅProtocolFilterWrapper „ÄÇ Dubbo ÊúçÂä°Â¶Ç‰ΩïÁõëÊéßÂíåÁÆ°ÁêÜÔºü‰∏ÄÊó¶‰ΩøÁî® Dubbo ÂÅö‰∫ÜÊúçÂä°ÂåñÂêéÔºåÂøÖÈ°ªÂøÖÈ°ªÂøÖÈ°ªË¶ÅÂÅöÁöÑÊúçÂä°Ê≤ªÁêÜÔºå‰πüÂ∞±ÊòØËØ¥ÔºåË¶ÅÂÅöÊúçÂä°ÁöÑÁÆ°ÁêÜ‰∏éÁõëÊéß„ÄÇÂΩìÁÑ∂ÔºåËøòÊúâÊúçÂä°ÁöÑÈôçÁ∫ßÂíåÈôêÊµÅ„ÄÇËøôÂùóÔºåÊîæÂú®‰∏ãÈù¢ÁöÑÈù¢ËØïÈ¢òÔºåÂú®ËØ¶ÁªÜËß£Êûê„ÄÇ Dubbo ÁÆ°ÁêÜÂπ≥Âè∞ + ÁõëÊéßÂπ≥Âè∞ dubbo-monitor ÁõëÊéßÂπ≥Âè∞ÔºåÂü∫‰∫é Dubbo ÁöÑ„Äêmonitor ÁõëÊéßÂ±Ç„ÄëÔºåÂÆûÁé∞Áõ∏Â∫îÁöÑÁõëÊéßÊï∞ÊçÆÁöÑÊî∂ÈõÜÂà∞ÁõëÊéßÂπ≥Âè∞„ÄÇ dubbo-admin ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÂü∫‰∫éÊ≥®ÂÜå‰∏≠ÂøÉÔºåÂèØ‰ª•Ëé∑ÂèñÂà∞ÊúçÂä°Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ„ÄÇ ÂÖ≥‰∫éËøôÂùóÁöÑÈÄâÊã©ÔºåËÉñÂèãÁõ¥Êé•ÁúãÁúã „ÄäDubboÁõëÊéßÂíåÁÆ°ÁêÜÔºàdubbokeeperÔºâ„Äã „ÄÇ Âè¶Â§ñÔºåÁõÆÂâç Dubbo Ê≠£Âú®ÈáçÂÅö dubbo-admin ÁÆ°ÁêÜÂπ≥Âè∞ÔºåÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÂèØ‰ª•Ë∑üËøõ https://github.com/apache/incubator-dubbo-ops „ÄÇ ÈìæË∑ØËøΩË∏™ ÂÖ≥ÈìæË∑ØËøΩË∏™ÁöÑÊ¶ÇÂøµÔºåÂ∞±‰∏çÈáçÂ§ç‰ªãÁªç‰∫ÜÔºåüòà Â¶ÇÊûú‰∏çÊáÇÔºåËØ∑Ëá™Ë°å Google ‰∏ã„ÄÇ ÁõÆÂâçËÉΩÂ§üÂÆûÁé∞ÈìæË∑ØËøΩË∏™ÁöÑÁªÑ‰ª∂ËøòÊòØÊØîËæÉÂ§öÁöÑÔºåÂ¶Ç‰∏ãÔºö Apache SkyWalking „ÄêÊé®Ëçê„Äë Zipkin Cat PinPoint ÂÖ∑‰ΩìÈõÜÊàêÁöÑÊñπÂºèÔºåDubbo ÂÆòÊñπÊé®Ëçê‰∫Ü‰∏§ÁØáÂçöÊñáÔºö „Ää‰ΩøÁî® Apache SkyWalking (Incubator) ÂÅöÂàÜÂ∏ÉÂºèË∑üË∏™„Äã „ÄäÂú® Dubbo ‰∏≠‰ΩøÁî® Zipkin„Äã Dubbo ÊúçÂä°Â¶Ç‰ΩïÂÅöÈôçÁ∫ßÔºüÊØîÂ¶ÇËØ¥ÊúçÂä° A Ë∞ÉÁî®ÊúçÂä° BÔºåÁªìÊûúÊúçÂä° B ÊåÇÊéâ‰∫Ü„ÄÇÊúçÂä° A ÂÜçÈáçËØïÂá†Ê¨°Ë∞ÉÁî®ÊúçÂä° BÔºåËøòÊòØ‰∏çË°åÔºåÈÇ£‰πàÁõ¥Êé•ÈôçÁ∫ßÔºåËµ∞‰∏Ä‰∏™Â§áÁî®ÁöÑÈÄªËæëÔºåÁªôÁî®Êà∑ËøîÂõûÂìçÂ∫î„ÄÇ Âú® Dubbo ‰∏≠ÔºåÂÆûÁé∞ÊúçÂä°ÈôçÁ∫ßÁöÑÂäüËÉΩÔºå‰∏ÄÂÖ±Êúâ‰∏§Â§ßÁßçÊñπÂºè„ÄÇ ‚ë† Dubbo ÂéüÁîüËá™Â∏¶ÁöÑÊúçÂä°ÈôçÁ∫ßÂäüËÉΩ ÂÖ∑‰ΩìÂèØ‰ª•ÁúãÁúã „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÊúçÂä°ÈôçÁ∫ß„Äã „ÄÇ ÂΩìÁÑ∂ÔºåËøô‰∏™ÂäüËÉΩÔºåÂπ∂‰∏çËÉΩÂÆûÁé∞Áé∞‰ª£ÂæÆÊúçÂä°ÁöÑÁÜîÊñ≠Âô®ÁöÑÂäüËÉΩ„ÄÇÊâÄ‰ª•‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºå‰∏çÂ§™Êé®ËçêËøôÁßçÊñπÂºèÔºåËÄåÊòØÈááÁî®Á¨¨‰∫åÁßçÊñπÂºè„ÄÇ ‚ë° ÂºïÂÖ•ÊîØÊåÅÊúçÂä°ÈôçÁ∫ßÁöÑÁªÑ‰ª∂ ÁõÆÂâçÂºÄÊ∫êÁ§æÂå∫Â∏∏Áî®ÁöÑÊúâ‰∏§ÁßçÁªÑ‰ª∂ÊîØÊåÅÊúçÂä°ÈôçÁ∫ßÁöÑÂäüËÉΩÔºåÂàÜÂà´ÊòØÔºö Alibaba Sentinel Netflix Hystrix Âõ†‰∏∫ÁõÆÂâç Hystrix Â∑≤ÁªèÂÅúÊ≠¢Áª¥Êä§ÔºåÂπ∂‰∏îÂíå Dubbo ÁöÑÈõÜÊàêÂ∫¶‰∏çÊòØÁâπÂà´È´òÔºåÈúÄË¶ÅÂÅö‰∫åÊ¨°ÂºÄÂèëÔºåÊâÄ‰ª•Êé®Ëçê‰ΩøÁî® Sentinel „ÄÇÂÖ∑‰ΩìÁöÑ‰ªãÁªçÔºåËÉñÂèãÂèØ‰ª•ÁúãÁúã „ÄäSentinel ‰ªãÁªç„Äã „ÄÇ ÂÖ≥‰∫é Dubbo Â¶Ç‰ΩïÈõÜÊàê Sentinel ÔºåËÉñÂèãÂèØ‰ª•ÈòÖËØª „ÄäSentinel ‰∏∫ Dubbo ÊúçÂä°‰øùÈ©æÊä§Ëà™„Äã ‰∏ÄÊñá„ÄÇ ÂÖ≥‰∫é Sentinel Âíå Hystrix ÂØπÊØîÔºåËÉñÂèãÂèØ‰ª•ÈòÖËØª „ÄäSentinel ‰∏é Hystrix ÁöÑÂØπÊØî„Äã ‰∏ÄÊñá„ÄÇ Dubbo Â¶Ç‰ΩïÂÅöÈôêÊµÅÔºüÂú®ÂÅöÊúçÂä°Á®≥ÂÆöÊÄßÊó∂ÔºåÊúâ‰∏ÄÂè•ÈùûÂ∏∏ÁªèÂÖ∏ÁöÑËØùÔºö ÊÄÄÁñëÁ¨¨‰∏âÊñπ Èò≤Â§á‰ΩøÁî®Êñπ ÂÅöÂ•ΩËá™Â∑± ÈÇ£‰πàÔºå‰∏äÈù¢ÁúãÂà∞ÁöÑÊúçÂä°ÈôçÁ∫ßÔºåÂ∞±Â±û‰∫éÊÄÄÁñëÁ¨¨‰∏âÊñπ„ÄÇËÄåÊú¨Â∞èËäÇÁöÑÈôêÊµÅÁõÆÁöÑÔºåÂ∞±ÊòØÈò≤Â§á‰ΩøÁî®Êñπ„ÄÇ Ê≠§Â§ÑÔºåËâøËâøË¶ÅÂÜçÊé®Ëçê‰∏ÄÁØáÊñáÁ´†Ôºö„Ää‰Ω†Â∫îËØ•Â¶Ç‰ΩïÊ≠£Á°ÆÂÅ•Â£ÆÂêéÁ´ØÊúçÂä°Ôºü„Äã „ÄÇ ÁõÆÂâçÔºåÂú® Dubbo ‰∏≠ÔºåÂÆûÁé∞ÊúçÂä°ÈôçÁ∫ßÁöÑÂäüËÉΩÔºå‰∏ÄÂÖ±Êúâ‰∏§Â§ßÁßçÊñπÂºè„ÄÇ ‚ë† Dubbo ÂéüÁîüËá™Â∏¶ÁöÑÈôêÊµÅÂäüËÉΩ ÈÄöËøá TpsLimitFilter ÂÆûÁé∞Ôºå‰ªÖÈÄÇÁî®‰∫éÊúçÂä°Êèê‰æõËÄÖ„ÄÇÂÖ∑‰ΩìÁöÑ‰ΩøÁî®ÊñπÂºèÔºåÊ∫êÁ†ÅÂÆûÁé∞ÔºåÁúãÁúã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ËøáÊª§Âô®Ôºà‰πùÔºâ‰πã TpsLimitFilter„Äã „ÄÇ üòà ÂèÇÁÖß TpsLimitFilter ÁöÑÊÄùË∑ØÔºåÂèØ‰ª•ÂÆûÁé∞Ëá™ÂÆö‰πâÈôêÊµÅÁöÑ Filter ÔºåÂπ∂‰∏î‰ΩøÁî® Guava RateLimiter Â∑•ÂÖ∑Á±ªÔºåËææÂà∞ ‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÈôêÊµÅÁöÑÂäüËÉΩ„ÄÇ ‚ë° ÂºïÂÖ•ÊîØÊåÅÈôêÊµÅÁöÑÁªÑ‰ª∂ ÂÖ≥‰∫éËøô‰∏™ÂäüËÉΩÔºåËøòÊòØÊé®ËçêÈõÜÊàê Sentinel ÁªÑ‰ª∂„ÄÇ Dubbo ÁöÑÂ§±Ë¥•ÈáçËØïÊòØ‰ªÄ‰πàÔºüÊâÄË∞ìÂ§±Ë¥•ÈáçËØïÔºåÂ∞±ÊòØ consumer Ë∞ÉÁî® provider Ë¶ÅÊòØÂ§±Ë¥•‰∫ÜÔºåÊØîÂ¶ÇÊäõÂºÇÂ∏∏‰∫ÜÔºåÊ≠§Êó∂Â∫îËØ•ÊòØÂèØ‰ª•ÈáçËØïÁöÑÔºåÊàñËÄÖË∞ÉÁî®Ë∂ÖÊó∂‰∫Ü‰πüÂèØ‰ª•ÈáçËØï„ÄÇ ÂÆûÈôÖÂú∫ÊôØ‰∏ãÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÁ¶ÅÁî®ÊéâÈáçËØï„ÄÇÂõ†‰∏∫ÔºåÂõ†‰∏∫Ë∂ÖÊó∂ÂêéÈáçËØï‰ºöÊúâÈóÆÈ¢òÔºåË∂ÖÊó∂‰Ω†‰∏çÁü•ÈÅìÊòØÊàêÂäüËøòÊòØÂ§±Ë¥•„ÄÇ‰æãÂ¶ÇÔºåÂèØËÉΩ‰ºöÂØºËá¥‰∏§Ê¨°Êâ£Ê¨æÁöÑÈóÆÈ¢ò„ÄÇ ÊâÄ‰ª•ÔºåÊàë‰ª¨‰∏ÄËà¨‰ΩøÁî® failfast ÈõÜÁæ§ÂÆπÈîôÁ≠ñÁï•ÔºåËÄå‰∏çÊòØ failover Á≠ñÁï•„ÄÇÈÖçÁΩÆÂ¶Ç‰∏ãÔºö 1&lt;dubbo:service cluster="failfast" timeout="2000" /&gt; Âè¶Â§ñÔºå‰∏ÄÂÆö‰∏ÄÂÆö‰∏ÄÂÆöË¶ÅÈÖçÁΩÆÈÄÇÂêàËá™Â∑±‰∏öÂä°ÁöÑË∂ÖÊó∂Êó∂Èó¥„ÄÇ ÂΩìÁÑ∂ÔºåÂèØ‰ª•Â∞ÜÊìç‰ΩúÂàÜÊàêËØªÂíåÂÜô‰∏§ÁßçÔºåÂâçËÄÖÊîØÊåÅÈáçËØïÔºåÂêéËÄÖ‰∏çÊîØÊåÅÈáçËØï„ÄÇÂõ†‰∏∫ÔºåËØªÊìç‰ΩúÂ§©ÁÑ∂ÂÖ∑ÊúâÂπÇÁ≠âÊÄß„ÄÇ Dubbo ÊîØÊåÅÂì™‰∫õÊ≥®ÂÜå‰∏≠ÂøÉÔºüDubbo ÊîØÊåÅÂ§öÁßç‰∏ªÊµÅÊ≥®ÂÜå‰∏≠ÂøÉÔºåÂ¶Ç‰∏ãÔºö „ÄêÈªòËÆ§„ÄëZookeeper ÔºåÂèÇËßÅ „ÄäÁî®Êà∑ÊåáÂçó ‚Äî‚Äî Zookeeper Ê≥®ÂÜå‰∏≠ÂøÉ„Äã „ÄÇ Redis ÔºåÂèÇËßÅ „ÄäÁî®Êà∑ÊåáÂçó ‚Äî‚Äî Redis Ê≥®ÂÜå‰∏≠ÂøÉ„Äã „ÄÇ Multicast Ê≥®ÂÜå‰∏≠ÂøÉÔºåÂèÇËßÅ „ÄäÁî®Êà∑ÊåáÂçó ‚Äî‚Äî Multicast Ê≥®ÂÜå‰∏≠ÂøÉ„Äã „ÄÇ Simple Ê≥®ÂÜå‰∏≠ÂøÉÔºåÂèÇËßÅ „ÄäÁî®Êà∑ÊåáÂçó ‚Äî‚Äî Simple Ê≥®ÂÜå‰∏≠ÂøÉ„Äã „ÄÇ ÁõÆÂâç Alibaba Ê≠£Âú®ÂºÄÊ∫êÊñ∞ÁöÑÊ≥®ÂÜå‰∏≠ÂøÉ Nacos Ôºå‰πüÊòØÊú™Êù•ÁöÑÈÄâÊã©‰πã‰∏Ä„ÄÇ ÂΩìÁÑ∂ÔºåNetflix Eureka ‰πüÊòØÊ≥®ÂÜå‰∏≠ÂøÉÁöÑ‰∏Ä‰∏™ÈÄâÊã©Ôºå‰∏çËøá Dubbo ÊöÇÊú™ÈõÜÊàêÂÆûÁé∞„ÄÇ Âè¶Â§ñÔºåÊ≠§Â§Ñ‰ºöÂºïÁî≥‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑÈóÆÈ¢òÔºåËßÅ „Ää‰∏∫‰ªÄ‰πà‰∏çÂ∫îËØ•‰ΩøÁî® ZooKeeper ÂÅöÊúçÂä°ÂèëÁé∞„Äã ÊñáÁ´†„ÄÇ ## Dubbo Êé•Âè£Â¶Ç‰ΩïÂÆûÁé∞ÂπÇÁ≠âÊÄßÔºü ÊâÄË∞ìÂπÇÁ≠âÔºåÁÆÄÂçïÂú∞ËØ¥ÔºåÂ∞±ÊòØÂØπÊé•Âè£ÁöÑÂ§öÊ¨°Ë∞ÉÁî®ÊâÄ‰∫ßÁîüÁöÑÁªìÊûúÂíåË∞ÉÁî®‰∏ÄÊ¨°ÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÊâ©Â±ï‰∏Ä‰∏ãÔºåËøôÈáåÁöÑÊé•Âè£ÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ÂØπÂ§ñÂèëÂ∏ÉÁöÑ HTTP Êé•Âè£ÊàñËÄÖ Thrift Êé•Âè£Ôºå‰πüÂèØ‰ª•ÊòØÊé•Êî∂Ê∂àÊÅØÁöÑÂÜÖÈÉ®Êé•Âè£ÔºåÁîöËá≥ÊòØ‰∏Ä‰∏™ÂÜÖÈÉ®ÊñπÊ≥ïÊàñÊìç‰Ωú„ÄÇ ÈÇ£‰πàÊàë‰ª¨‰∏∫‰ªÄ‰πàÈúÄË¶ÅÊé•Âè£ÂÖ∑ÊúâÂπÇÁ≠âÊÄßÂë¢ÔºüËÆæÊÉ≥‰∏Ä‰∏ã‰ª•‰∏ãÊÉÖÂΩ¢Ôºö Âú® App ‰∏≠‰∏ãËÆ¢ÂçïÁöÑÊó∂ÂÄôÔºåÁÇπÂáªÁ°ÆËÆ§‰πãÂêéÔºåÊ≤°ÂèçÂ∫îÔºåÂ∞±ÂèàÁÇπÂáª‰∫ÜÂá†Ê¨°„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúÊó†Ê≥ï‰øùËØÅËØ•Êé•Âè£ÁöÑÂπÇÁ≠âÊÄßÔºåÈÇ£‰πàÂ∞Ü‰ºöÂá∫Áé∞ÈáçÂ§ç‰∏ãÂçïÈóÆÈ¢ò„ÄÇ Âú®Êé•Êî∂Ê∂àÊÅØÁöÑÊó∂ÂÄôÔºåÊ∂àÊÅØÊé®ÈÄÅÈáçÂ§ç„ÄÇÂ¶ÇÊûúÂ§ÑÁêÜÊ∂àÊÅØÁöÑÊé•Âè£Êó†Ê≥ï‰øùËØÅÂπÇÁ≠âÔºåÈÇ£‰πàÈáçÂ§çÊ∂àË¥πÊ∂àÊÅØ‰∫ßÁîüÁöÑÂΩ±ÂìçÂèØËÉΩ‰ºöÈùûÂ∏∏Â§ß„ÄÇ ÊâÄ‰ª•Ôºå‰ªéËøôÊÆµÊèèËø∞‰∏≠ÔºåÂπÇÁ≠âÊÄß‰∏ç‰ªÖ‰ªÖÊòØ Dubbo Êé•Âè£ÁöÑÈóÆÈ¢òÔºåÂåÖÊã¨ HTTP Êé•Âè£„ÄÅThrift Êé•Âè£ÈÉΩÂ≠òÂú®ËøôÊ†∑ÁöÑÈóÆÈ¢òÔºåÁîöËá≥ËØ¥ MQ Ê∂àÊÅØ„ÄÅÂÆöÊó∂‰ªªÂä°ÔºåÈÉΩ‰ºöÁ¢∞Âà∞ËøôÊ†∑ÁöÑÂú∫ÊôØ„ÄÇÈÇ£‰πàÂ∫îËØ•ÊÄé‰πàÂäûÂë¢Ôºü Ëøô‰∏™‰∏çÊòØÊäÄÊúØÈóÆÈ¢òÔºåËøô‰∏™Ê≤°ÊúâÈÄöÁî®ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåËøô‰∏™Â∫îËØ•ÁªìÂêà‰∏öÂä°Êù•‰øùËØÅÂπÇÁ≠âÊÄß„ÄÇ ÊâÄË∞ìÂπÇÁ≠âÊÄßÔºåÂ∞±ÊòØËØ¥‰∏Ä‰∏™Êé•Âè£ÔºåÂ§öÊ¨°ÂèëËµ∑Âêå‰∏Ä‰∏™ËØ∑Ê±ÇÔºå‰Ω†Ëøô‰∏™Êé•Âè£Âæó‰øùËØÅÁªìÊûúÊòØÂáÜÁ°ÆÁöÑÔºåÊØîÂ¶Ç‰∏çËÉΩÂ§öÊâ£Ê¨æ„ÄÅ‰∏çËÉΩÂ§öÊèíÂÖ•‰∏ÄÊù°Êï∞ÊçÆ„ÄÅ‰∏çËÉΩÂ∞ÜÁªüËÆ°ÂÄºÂ§öÂä†‰∫Ü 1„ÄÇËøôÂ∞±ÊòØÂπÇÁ≠âÊÄß„ÄÇ ÂÖ∂ÂÆû‰øùËØÅÂπÇÁ≠âÊÄß‰∏ªË¶ÅÊòØ‰∏âÁÇπÔºö ÂØπ‰∫éÊØè‰∏™ËØ∑Ê±ÇÂøÖÈ°ªÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÊ†áËØÜÔºå‰∏æ‰∏™Ê†óÂ≠êÔºöËÆ¢ÂçïÊîØ‰ªòËØ∑Ê±ÇÔºåËÇØÂÆöÂæóÂåÖÂê´ËÆ¢Âçï idÔºå‰∏Ä‰∏™ËÆ¢Âçï id ÊúÄÂ§öÊîØ‰ªò‰∏ÄÊ¨°ÔºåÂØπÂêß„ÄÇ ÊØèÊ¨°Â§ÑÁêÜÂÆåËØ∑Ê±Ç‰πãÂêéÔºåÂøÖÈ°ªÊúâ‰∏Ä‰∏™ËÆ∞ÂΩïÊ†áËØÜËøô‰∏™ËØ∑Ê±ÇÂ§ÑÁêÜËøá‰∫Ü„ÄÇÂ∏∏ËßÅÁöÑÊñπÊ°àÊòØÂú® mysql ‰∏≠ËÆ∞ÂΩï‰∏™Áä∂ÊÄÅÂï•ÁöÑÔºåÊØîÂ¶ÇÊîØ‰ªò‰πãÂâçËÆ∞ÂΩï‰∏ÄÊù°Ëøô‰∏™ËÆ¢ÂçïÁöÑÊîØ‰ªòÊµÅÊ∞¥„ÄÇ ÊØèÊ¨°Êé•Êî∂ËØ∑Ê±ÇÈúÄË¶ÅËøõË°åÂà§Êñ≠ÔºåÂà§Êñ≠‰πãÂâçÊòØÂê¶Â§ÑÁêÜËøá„ÄÇÊØîÂ¶ÇËØ¥ÔºåÂ¶ÇÊûúÊúâ‰∏Ä‰∏™ËÆ¢ÂçïÂ∑≤ÁªèÊîØ‰ªò‰∫ÜÔºåÂ∞±Â∑≤ÁªèÊúâ‰∫Ü‰∏ÄÊù°ÊîØ‰ªòÊµÅÊ∞¥ÔºåÈÇ£‰πàÂ¶ÇÊûúÈáçÂ§çÂèëÈÄÅËøô‰∏™ËØ∑Ê±ÇÔºåÂàôÊ≠§Êó∂ÂÖàÊèíÂÖ•ÊîØ‰ªòÊµÅÊ∞¥ÔºåorderId Â∑≤ÁªèÂ≠òÂú®‰∫ÜÔºåÂîØ‰∏ÄÈîÆÁ∫¶ÊùüÁîüÊïàÔºåÊä•ÈîôÊèíÂÖ•‰∏çËøõÂéªÁöÑ„ÄÇÁÑ∂Âêé‰Ω†Â∞±‰∏çÁî®ÂÜçÊâ£Ê¨æ‰∫Ü„ÄÇ ÂÆûÈôÖËøê‰ΩúËøáÁ®ã‰∏≠Ôºå‰Ω†Ë¶ÅÁªìÂêàËá™Â∑±ÁöÑ‰∏öÂä°Êù•ÔºåÊØîÂ¶ÇËØ¥Âà©Áî® redisÔºåÁî® orderId ‰Ωú‰∏∫ÂîØ‰∏ÄÈîÆ„ÄÇÂè™ÊúâÊàêÂäüÊèíÂÖ•Ëøô‰∏™ÊîØ‰ªòÊµÅÊ∞¥ÔºåÊâçÂèØ‰ª•ÊâßË°åÂÆûÈôÖÁöÑÊîØ‰ªòÊâ£Ê¨æ„ÄÇ Ë¶ÅÊ±ÇÊòØÊîØ‰ªò‰∏Ä‰∏™ËÆ¢ÂçïÔºåÂøÖÈ°ªÊèíÂÖ•‰∏ÄÊù°ÊîØ‰ªòÊµÅÊ∞¥Ôºåorder_id Âª∫‰∏Ä‰∏™ÂîØ‰∏ÄÈîÆ unique key„ÄÇ‰Ω†Âú®ÊîØ‰ªò‰∏Ä‰∏™ËÆ¢Âçï‰πãÂâçÔºåÂÖàÊèíÂÖ•‰∏ÄÊù°ÊîØ‰ªòÊµÅÊ∞¥Ôºåorder_id Â∞±Â∑≤ÁªèËøõÂéª‰∫Ü„ÄÇ‰Ω†Â∞±ÂèØ‰ª•ÂÜô‰∏Ä‰∏™Ê†áËØÜÂà∞ redis ÈáåÈù¢ÂéªÔºåset order_id payedÔºå‰∏ã‰∏ÄÊ¨°ÈáçÂ§çËØ∑Ê±ÇËøáÊù•‰∫ÜÔºåÂÖàÊü• redis ÁöÑ order_id ÂØπÂ∫îÁöÑ valueÔºåÂ¶ÇÊûúÊòØ payed Â∞±ËØ¥ÊòéÂ∑≤ÁªèÊîØ‰ªòËøá‰∫ÜÔºå‰Ω†Â∞±Âà´ÈáçÂ§çÊîØ‰ªò‰∫Ü„ÄÇ Dubbo Â¶Ç‰ΩïÂçáÁ∫ßÊé•Âè£ÔºüÂèÇËÄÉ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Â§öÁâàÊú¨„Äã „ÄÇ ÂΩì‰∏Ä‰∏™Êé•Âè£ÂÆûÁé∞ÔºåÂá∫Áé∞‰∏çÂÖºÂÆπÂçáÁ∫ßÊó∂ÔºåÂèØ‰ª•Áî®ÁâàÊú¨Âè∑ËøáÊ∏°ÔºåÁâàÊú¨Âè∑‰∏çÂêåÁöÑÊúçÂä°Áõ∏‰∫íÈó¥‰∏çÂºïÁî®„ÄÇ ÂèØ‰ª•ÊåâÁÖß‰ª•‰∏ãÁöÑÊ≠•È™§ËøõË°åÁâàÊú¨ËøÅÁßªÔºö Âú®‰ΩéÂéãÂäõÊó∂Èó¥ÊÆµÔºåÂÖàÂçáÁ∫ß‰∏ÄÂçäÊèê‰æõËÄÖ‰∏∫Êñ∞ÁâàÊú¨„ÄÇ ÂÜçÂ∞ÜÊâÄÊúâÊ∂àË¥πËÄÖÂçáÁ∫ß‰∏∫Êñ∞ÁâàÊú¨„ÄÇ ÁÑ∂ÂêéÂ∞ÜÂâ©‰∏ãÁöÑ‰∏ÄÂçäÊèê‰æõËÄÖÂçáÁ∫ß‰∏∫Êñ∞ÁâàÊú¨„ÄÇ Âà©Áî®Â§öÁâàÊú¨ÁöÑÁâπÊÄßÔºåÊàë‰ª¨‰πüËÉΩÂÆûÁé∞ÁÅ∞Â∫¶ÁöÑÂäüËÉΩ„ÄÇÂØπ‰∫éÁ¨¨ 2 Ê≠•Ôºå‰∏çË¶ÅÂçáÁ∫ßÊâÄÊúâÊ∂àË¥πËÄÖ‰∏∫Êñ∞ÁâàÊú¨ÔºåËÄåÊòØ‰∏ÄÂçä„ÄÇ Dubbo Âú®ÂÆâÂÖ®Êú∫Âà∂ÊñπÈù¢ÊòØÂ¶Ç‰ΩïËß£ÂÜ≥ÁöÑÔºüÈÄöËøá‰ª§ÁâåÈ™åËØÅÂú®Ê≥®ÂÜå‰∏≠ÂøÉÊéßÂà∂ÊùÉÈôêÔºå‰ª•ÂÜ≥ÂÆöË¶Å‰∏çË¶Å‰∏ãÂèë‰ª§ÁâåÁªôÊ∂àË¥πËÄÖÔºåÂèØ‰ª•Èò≤Ê≠¢Ê∂àË¥πËÄÖÁªïËøáÊ≥®ÂÜå‰∏≠ÂøÉËÆøÈóÆÊèê‰æõËÄÖ„ÄÇ Âè¶Â§ñÈÄöËøáÊ≥®ÂÜå‰∏≠ÂøÉÂèØÁÅµÊ¥ªÊîπÂèòÊéàÊùÉÊñπÂºèÔºåËÄå‰∏çÈúÄ‰øÆÊîπÊàñÂçáÁ∫ßÊèê‰æõËÄÖ„ÄÇ Áõ∏ÂÖ≥ÊñáÊ°£ÔºåÂèØ‰ª•ÂèÇËßÅ „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ‰ª§ÁâåÈ™åËØÅ„Äã „ÄÇ Ê∫êÁ†ÅËß£ÊûêÔºåÂèØ‰ª•ÂèÇËßÅ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ËøáÊª§Âô®ÔºàÂÖ´Ôºâ‰πã TokenFilter„Äã „ÄÇ Dubbo ÈúÄË¶Å Web ÂÆπÂô®ÂêóÔºüËøô‰∏™ÈóÆÈ¢òÔºå‰ªîÁªÜÂõûÁ≠îÔºåÈúÄË¶ÅÊÄùËÄÉ Web ÂÆπÂô®ÁöÑÂÆö‰πâ„ÄÇÁÑ∂ËÄåÂÆûÈôÖ‰∏äÔºåÁúüÊ≠£ÊÉ≥ÈóÆÁöÑÊòØÔºåDubbo ÊúçÂä°ÂêØÂä®ÊòØÂê¶ÈúÄË¶ÅÂêØÂä®Á±ª‰ºº Tomcat„ÄÅJetty Á≠âÊúçÂä°Âô®„ÄÇ Ëøô‰∏™Á≠îÊ°àÂèØ‰ª•ÊòØÔºå‰πüÂèØ‰ª•ÊòØ‰∏çÊòØ„ÄÇ‰∏∫‰ªÄ‰πàÂë¢ÔºüÊ†πÊçÆÂçèËÆÆÁöÑ‰∏çÂêåÔºåProvider ‰ºöÂêØÂä®‰∏çÂêåÁöÑÊúçÂä°Âô®„ÄÇ Âú®‰ΩøÁî® dubbo:// ÂçèËÆÆÊó∂ÔºåÁ≠îÊ°àÊòØÂê¶ÔºåÂõ†‰∏∫ Provider ÂêØÂä® Netty„ÄÅMina Á≠â NIO Server „ÄÇ Âú®‰ΩøÁî® rest:// ÂçèËÆÆÊó∂ÔºåÁ≠îÊ°àÊòØÊòØÔºåProvider ÂêØÂä® Tomcat„ÄÅJetty Á≠â HTTP ÊúçÂä°Âô®ÔºåÊàñËÄÖ‰πüÂèØ‰ª•‰ΩøÁî® Netty Â∞ÅË£ÖÁöÑ HTTP ÊúçÂä°Âô®„ÄÇ Âú®‰ΩøÁî® hessian:// ÂçèËÆÆÊó∂ÔºåÁ≠îÊ°àÊòØÊòØÔºåProvider ÂêØÂä® Jetty„ÄÅTomcat Á≠â HTTP ÊúçÂä°Âô®„ÄÇ ‰∏∫‰ªÄ‰πàË¶ÅÂ∞ÜÁ≥ªÁªüËøõË°åÊãÜÂàÜÔºüËøô‰∏™ÈóÆÈ¢òÔºå‰∏çÊòØ‰ªÖ‰ªÖÈÄÇÁî®‰∫é Dubbo ÁöÑÂú∫ÊôØÔºåËÄåÊòØ SOA„ÄÅÂæÆÊúçÂä°„ÄÇ ÁΩë‰∏äÊü•Êü•ÔºåÁ≠îÊ°àÊûÅÂ∫¶Èõ∂Êï£ÂíåÂ§çÊùÇÔºåÂæàÁêêÁ¢éÔºåÂéüÂõ†‰∏ÄÂ§ßÂù®„ÄÇ‰ΩÜÊòØÊàëËøôÈáåÁªôÂ§ßÂÆ∂Áõ¥ËßÇÁöÑÊÑüÂèóÔºö Ë¶ÅÊòØ‰∏çÊãÜÂàÜÔºå‰∏Ä‰∏™Â§ßÁ≥ªÁªüÂá†ÂçÅ‰∏áË°å‰ª£Á†ÅÔºå20 ‰∏™‰∫∫Áª¥Êä§‰∏Ä‰ªΩ‰ª£Á†ÅÔºåÁÆÄÁõ¥ÊòØÊÇ≤ÂâßÂïä„ÄÇ‰ª£Á†ÅÁªèÂ∏∏ÊîπÁùÄÊîπÁùÄÂ∞±ÂÜ≤Á™Å‰∫ÜÔºåÂêÑÁßç‰ª£Á†ÅÂÜ≤Á™ÅÂíåÂêàÂπ∂Ë¶ÅÂ§ÑÁêÜÔºåÈùûÂ∏∏ËÄóË¥πÊó∂Èó¥ÔºõÁªèÂ∏∏ÊàëÊîπÂä®‰∫ÜÊàëÁöÑ‰ª£Á†ÅÔºå‰Ω†Ë∞ÉÁî®‰∫ÜÊàëÁöÑÔºåÂØºËá¥‰Ω†ÁöÑ‰ª£Á†Å‰πüÂæóÈáçÊñ∞ÊµãËØïÔºåÈ∫ªÁÉ¶ÁöÑË¶ÅÊ≠ªÔºõÁÑ∂ÂêéÊØèÊ¨°ÂèëÂ∏ÉÈÉΩÊòØÂá†ÂçÅ‰∏áË°å‰ª£Á†ÅÁöÑÁ≥ªÁªü‰∏ÄËµ∑ÂèëÂ∏ÉÔºåÂ§ßÂÆ∂Âæó‰∏ÄËµ∑ÊèêÂøÉÂêäËÉÜÂáÜÂ§á‰∏äÁ∫øÔºåÂá†ÂçÅ‰∏áË°å‰ª£Á†ÅÁöÑ‰∏äÁ∫øÔºåÂèØËÉΩÊØèÊ¨°‰∏äÁ∫øÈÉΩË¶ÅÂÅöÂæàÂ§öÁöÑÊ£ÄÊü•ÔºåÂæàÂ§öÂºÇÂ∏∏ÈóÆÈ¢òÁöÑÂ§ÑÁêÜÔºåÁÆÄÁõ¥ÊòØÂèàÈ∫ªÁÉ¶ÂèàÁóõËã¶ÔºõËÄå‰∏îÂ¶ÇÊûúÊàëÁé∞Âú®ÊâìÁÆóÊääÊäÄÊúØÂçáÁ∫ßÂà∞ÊúÄÊñ∞ÁöÑ spring ÁâàÊú¨ÔºåËøò‰∏çË°åÔºåÂõ†‰∏∫ËøôÂèØËÉΩÂØºËá¥‰Ω†ÁöÑ‰ª£Á†ÅÊä•ÈîôÔºåÊàë‰∏çÊï¢ÈöèÊÑè‰π±ÊîπÊäÄÊúØ„ÄÇ ÂÅáËÆæ‰∏Ä‰∏™Á≥ªÁªüÊòØ 20 ‰∏áË°å‰ª£Á†ÅÔºåÂÖ∂‰∏≠ Â∞èA Âú®ÈáåÈù¢Êîπ‰∫Ü 1000 Ë°å‰ª£Á†ÅÔºå‰ΩÜÊòØÊ≠§Êó∂ÂèëÂ∏ÉÁöÑÊó∂ÂÄôÊòØËøô‰∏™ 20 ‰∏áË°å‰ª£Á†ÅÁöÑÂ§ßÁ≥ªÁªü‰∏ÄÂùóÂÑøÂèëÂ∏É„ÄÇÂ∞±ÊÑèÂë≥ÁùÄ 20 ‰∏á‰∏ä‰ª£Á†ÅÂú®Á∫ø‰∏äÂ∞±ÂèØËÉΩÂá∫Áé∞ÂêÑÁßçÂèòÂåñÔºå20 ‰∏™‰∫∫ÔºåÊØè‰∏™‰∫∫ÈÉΩË¶ÅÁ¥ßÂº†Âú∞Á≠âÂú®ÁîµËÑëÈù¢ÂâçÔºå‰∏äÁ∫ø‰πãÂêéÔºåÊ£ÄÊü•Êó•ÂøóÔºåÁúãËá™Â∑±Ë¥üË¥£ÁöÑÈÇ£‰∏ÄÂùóÂÑøÊúâÊ≤°Êúâ‰ªÄ‰πàÈóÆÈ¢ò„ÄÇ Â∞èA Â∞±Ê£ÄÊü•‰∫ÜËá™Â∑±Ë¥üË¥£ÁöÑ 1 ‰∏áË°å‰ª£Á†ÅÂØπÂ∫îÁöÑÂäüËÉΩÔºåÁ°Æ‰øùokÂ∞±Èó™‰∫∫‰∫ÜÔºõÁªìÊûú‰∏çÂ∑ßÁöÑÊòØÔºåÂ∞èA ‰∏äÁ∫øÁöÑÊó∂ÂÄô‰∏çÂ∞èÂøÉ‰øÆÊîπ‰∫ÜÁ∫ø‰∏äÊú∫Âô®ÁöÑÊüê‰∏™ÈÖçÁΩÆÔºåÂØºËá¥Âè¶Â§ñ Â∞èB Âíå Â∞èC Ë¥üË¥£ÁöÑ 2 ‰∏áË°å‰ª£Á†ÅÂØπÂ∫îÁöÑ‰∏Ä‰∫õÂäüËÉΩÔºåÂá∫Èîô‰∫Ü„ÄÇ Âá†ÂçÅ‰∏™‰∫∫Ë¥üË¥£Áª¥Êä§‰∏Ä‰∏™Âá†ÂçÅ‰∏áË°å‰ª£Á†ÅÁöÑÂçïÂùóÂ∫îÁî®ÔºåÊØèÊ¨°‰∏äÁ∫øÔºåÂáÜÂ§áÂá†‰∏™Á§ºÊãúÔºå‰∏äÁ∫ø -&gt; ÈÉ®ÁΩ≤ -&gt; Ê£ÄÊü•Ëá™Â∑±Ë¥üË¥£ÁöÑÂäüËÉΩ„ÄÇ ÊãÜÂàÜ‰∫Ü‰ª•ÂêéÔºåÊï¥‰∏™‰∏ñÁïåÊ∏ÖÁàΩ‰∫ÜÔºåÂá†ÂçÅ‰∏áË°å‰ª£Á†ÅÁöÑÁ≥ªÁªüÔºåÊãÜÂàÜÊàê 20 ‰∏™ÊúçÂä°ÔºåÂπ≥ÂùáÊØè‰∏™ÊúçÂä°Â∞± 1~2 ‰∏áË°å‰ª£Á†ÅÔºåÊØè‰∏™ÊúçÂä°ÈÉ®ÁΩ≤Âà∞ÂçïÁã¨ÁöÑÊú∫Âô®‰∏ä„ÄÇ20 ‰∏™Â∑•Á®ãÔºå20 ‰∏™ git ‰ª£Á†Å‰ªìÂ∫ìÈáåÔºå20 ‰∏™Á†ÅÂÜúÔºåÊØè‰∏™‰∫∫Áª¥Êä§Ëá™Â∑±ÁöÑÈÇ£‰∏™ÊúçÂä°Â∞±ÂèØ‰ª•‰∫ÜÔºåÊòØËá™Â∑±Áã¨Á´ãÁöÑ‰ª£Á†ÅÔºåË∑üÂà´‰∫∫Ê≤°ÂÖ≥Á≥ª„ÄÇÂÜç‰πüÊ≤°Êúâ‰ª£Á†ÅÂÜ≤Á™Å‰∫ÜÔºåÁàΩ„ÄÇÊØèÊ¨°Â∞±ÊµãËØïÊàëËá™Â∑±ÁöÑ‰ª£Á†ÅÂ∞±ÂèØ‰ª•‰∫ÜÔºåÁàΩ„ÄÇÊØèÊ¨°Â∞±ÂèëÂ∏ÉÊàëËá™Â∑±ÁöÑ‰∏Ä‰∏™Â∞èÊúçÂä°Â∞±ÂèØ‰ª•‰∫ÜÔºåÁàΩ„ÄÇÊäÄÊúØ‰∏äÊÉ≥ÊÄé‰πàÂçáÁ∫ßÂ∞±ÊÄé‰πàÂçáÁ∫ßÔºå‰øùÊåÅÊé•Âè£‰∏çÂèòÂ∞±ÂèØ‰ª•‰∫ÜÔºåÁàΩ„ÄÇ ÊâÄ‰ª•ÁÆÄÂçïÊù•ËØ¥Ôºå‰∏ÄÂè•ËØùÊÄªÁªìÔºåÂ¶ÇÊûúÊòØÈÇ£Áßç‰ª£Á†ÅÈáèÂ§öËææÂá†ÂçÅ‰∏áË°åÁöÑ‰∏≠Â§ßÂûãÈ°πÁõÆÔºåÂõ¢ÈòüÈáåÊúâÂá†ÂçÅ‰∏™‰∫∫ÔºåÈÇ£‰πàÂ¶ÇÊûú‰∏çÊãÜÂàÜÁ≥ªÁªüÔºåÂºÄÂèëÊïàÁéáÊûÅÂÖ∂‰Ωé‰∏ãÔºåÈóÆÈ¢òÂæàÂ§ö„ÄÇ‰ΩÜÊòØÊãÜÂàÜÁ≥ªÁªü‰πãÂêéÔºåÊØè‰∏™‰∫∫Â∞±Ë¥üË¥£Ëá™Â∑±ÁöÑ‰∏ÄÂ∞èÈÉ®ÂàÜÂ∞±Â•Ω‰∫ÜÔºåÂèØ‰ª•Èöè‰æøÁé©ÂÑøÈöè‰æøÂºÑ„ÄÇÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊãÜÂàÜ‰πãÂêéÔºåÂèØ‰ª•Â§ßÂπÖÂ∫¶ÊèêÂçáÂ§çÊùÇÁ≥ªÁªüÂ§ßÂûãÂõ¢ÈòüÁöÑÂºÄÂèëÊïàÁéá„ÄÇ ‰ΩÜÊòØÂêåÊó∂Ôºå‰πüË¶ÅÊèêÈÜíÁöÑ‰∏ÄÁÇπÊòØÔºåÁ≥ªÁªüÊãÜÂàÜÊàêÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰πãÂêéÔºåÂ§ßÈáèÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªüÈù¢‰∏¥ÁöÑÈóÆÈ¢ò‰πüÊòØÊé•Ë∏µËÄåÊù•ÔºåÊâÄ‰ª•ÂêéÈù¢ÁöÑÈóÆÈ¢òÈÉΩÊòØÂú®Âõ¥ÁªïÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂ∏¶Êù•ÁöÑÂ§çÊùÇÊäÄÊúØÊåëÊàòÂú®ËØ¥„ÄÇ ËâøËâøÊõæÁªèÁª¥Êä§Ëøá‰∏Ä‰∏™Âá†ÂçÅ‰∏áË°åÁöÑÂçï‰ΩìÈ°πÁõÆÔºåÂπ∂‰∏îÂü∫Êú¨ÊòØ‰∏ÄÂ§©ÂèëÂ∏É 2-3 Ê¨°ÔºåÊúüÈó¥ÁöÑÁóõËã¶ÔºåÁÆÄÁõ¥‰∫Ü„ÄÇ Dubbo Â¶Ç‰ΩïÈõÜÊàêÈÖçÁΩÆ‰∏≠ÂøÉÔºüÂØπ‰∫é‰ΩøÁî®‰∫Ü Dubbo ÁöÑÁ≥ªÁªüÔºåÈÖçÁΩÆÂàÜÊàê‰∏§Á±ªÔºö ‚ë† Dubbo Ëá™Ë∫´ÈÖçÁΩÆ„ÄÇ ‰æãÂ¶ÇÔºöDubbo ËØ∑Ê±ÇË∂ÖÊó∂ÔºåDubbo ÈáçËØïÊ¨°Êï∞Á≠âÁ≠â„ÄÇ ‚ë° Èùû Dubbo Ëá™Ë∫´ÈÖçÁΩÆ Âü∫Âª∫ÈÖçÁΩÆÔºå‰æãÂ¶ÇÔºöÊï∞ÊçÆÂ∫ì„ÄÅRedis Á≠âÈÖçÁΩÆ„ÄÇ ‰∏öÂä°ÈÖçÁΩÆÔºå‰æãÂ¶ÇÔºöËÆ¢ÂçïË∂ÖÊó∂Êó∂Èó¥Ôºå‰∏ãÂçïÈ¢ëÁéáÁ≠âÁ≠âÈÖçÁΩÆ„ÄÇ ÂØπ‰∫é ‚ë† ÔºåÂ¶ÇÊûúÊàë‰ª¨Âú® Provider ÈÖçÁΩÆ Dubbo ËØ∑Ê±ÇË∂ÖÊó∂Êó∂Èó¥ÔºåÂΩì Consumer Êú™ÈÖçÁΩÆËØ∑Ê±ÇË∂ÖÊó∂Êó∂Èó¥Ôºå‰ºöÁªßÊâøËØ•ÈÖçÁΩÆÔºå‰ΩøÁî®ËØ•ËØ∑Ê±ÇË∂ÖÊó∂Êó∂Èó¥„ÄÇ ÂÆûÁé∞ÂéüÁêÜÔºö Provider ÂêØÂä®Êó∂Ôºå‰ºöÊ≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ‰∏≠ÔºåÂåÖÊã¨Êàë‰ª¨Âú® `` ‰∏≠ÁöÑÈÖçÁΩÆ„ÄÇ Consumer ÂêØÂä®Êó∂Ôºå‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñÂà∞ Provider ÂàóË°®ÂêéÔºå‰ºöÂêàÂπ∂ÂÆÉ‰ª¨Âú® &lt;dubbo:service /&gt; ÁöÑÈÖçÁΩÆÊù•‰ΩøÁî®„ÄÇÂΩìÁÑ∂ÔºåÂ¶ÇÊûú Consumer Ëá™Â∑±ÈÖçÁΩÆ‰∫ÜËØ•ÈÖçÁΩÆÈ°πÔºåÂàô‰ΩøÁî®Ëá™Ë∫´ÁöÑ„ÄÇ‰æãÂ¶ÇËØ¥ÔºåProvider ÈÖçÁΩÆ‰∫ÜËØ∑Ê±ÇË∂ÖÊó∂Êó∂Èó¥ÊòØ 10s ÔºåËÄå Consumer ÈÖçÁΩÆ‰∫ÜËØ∑Ê±ÇË∂ÖÊó∂Ë∂ÖÊó∂ÊòØ 5s ÔºåÈÇ£‰πàÊúÄÁªà Consumer ËØ∑Ê±ÇË∂ÖÊó∂ÁöÑÊó∂Èó¥ÊòØ 5s „ÄÇ ÁªùÂ§ßÊï∞ÈÖçÁΩÆÂèØ‰ª•Ë¢´ÁªßÊâøÔºåÂêàÂπ∂ÁöÑÊ†∏ÂøÉÈÄªËæëÔºåËßÅ ClusterUtils#mergeUrl(URL remoteUrl, Map localMap)ÊñπÊ≥ï„ÄÇ ÂÆûÁé∞‰ª£Á†ÅÔºåËßÅ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîôÔºàÂÖ≠Ôºâ‰πã Configurator ÂÆûÁé∞„Äã „ÄÇ ÂØπ‰∫é ‚ë° ÔºåÂ∏ÇÈù¢‰∏äÊúâÈùûÂ∏∏Â§öÁöÑÈÖçÁΩÆ‰∏≠ÂøÉÂèØ‰æõÈÄâÊã©Ôºö Apollo Nacos Disconf Ëøô‰∏™ÈóÆÈ¢ò‰∏çÂ§ß„ÄÇÂØπ‰∫éÈÖçÁΩÆ‰∏≠ÂøÉÁöÑÈÄâÊã©ÔºåÊàë‰ª¨ËÄÉËôëÁöÑ‰∏çÊòØÂÆÉÂíå Dubbo ÁöÑÈõÜÊàêÔºåËÄåÊòØÂÆÉÂíå Spring ÁöÑÈõÜÊàê„ÄÇÂõ†‰∏∫ÔºåÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈÉΩÊòØ‰ΩøÁî® Spring ‰Ωú‰∏∫Ê°ÜÊû∂ÁöÑÊï¥ÂêàÂü∫Á°Ä„ÄÇÁõÆÂâçÔºåApollo Âíå Nacos ÂØπ Spring ÁöÑÊîØÊåÅÊòØÊØîËæÉ‰∏çÈîôÁöÑ„ÄÇ Dubbo Â¶Ç‰ΩïÂÆûÁé∞ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÔºüÈ¶ñÂÖàÔºåÂÖ≥‰∫éÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÂäüËÉΩÔºå‰∏çÊòØ Dubbo ‰Ωú‰∏∫ÊúçÂä°Ê≤ªÁêÜÊ°ÜÊû∂ÈúÄË¶ÅÂéªÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª• Dubbo Êú¨Ë∫´Âπ∂Ê≤°ÊúâÂÆûÁé∞„ÄÇÊâÄ‰ª•Âú® „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÂàÜÂ∏ÉÂºè‰∫ãÂä°„Äã ‰πüÊèêÂà∞ÔºåÁõÆÂâçÂπ∂Êú™ÂÆûÁé∞„ÄÇ ËØ¥Ëµ∑ÂàÜÂ∏ÉÂºèÔºåÁêÜËÆ∫ÁöÑÊñáÁ´†ÂæàÂ§öÔºåËêΩÂú∞ÁöÑÂÆûË∑µÂæàÂ∞ë„ÄÇÁ¨îËÄÖÁøªÈòÖ‰∫ÜÂêÑÁßçÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁªÑ‰ª∂ÁöÑÈÄâÂûãÔºåÂ§ß‰ΩìÂ¶Ç‰∏ãÔºö TCC Ê®°ÂûãÔºöTCC-Transaction„ÄÅHmily XA Ê®°ÂûãÔºöSharding Sphere„ÄÅMyCAT 2PC Ê®°ÂûãÔºöraincat„ÄÅlcn MQ Ê®°ÂûãÔºöRocketMQ BED Ê®°ÂûãÔºöSharding Sphere Saga Ê®°ÂûãÔºöServiceComb Saga ÈÇ£ÊÄé‰πàÈÄâÊã©Âë¢ÔºüÁõÆÂâçÁ§æÂå∫ÂØπ‰∫éÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÈÄâÊã©ÔºåÊöÇÊó∂Ê≤°ÊúâÂÆöËÆ∫ÔºåËá≥Â∞ëÁ¨îËÄÖÊ≤°ÊúâÁúãÂà∞„ÄÇÁ¨îËÄÖÁöÑÊÉ≥Ê≥ïÂ¶Ç‰∏ãÔºö ‰ªéË¶ÜÁõñÂú∫ÊôØÊù•ËØ¥ÔºåTCC Êó†ÁñëÊòØÊúÄ‰ºòÁßÄÁöÑÔºå‰ΩÜÊòØÂ§ßÂÆ∂ËßâÂæóÁõ∏ÂØπÂ§çÊùÇ„ÄÇÂÆûÈôÖ‰∏äÔºåÂ§çÊùÇÂú∫ÊôØ‰∏ãÔºå‰ΩøÁî® TCC Êù•ÂÆûÁé∞ÔºåÂèçÂÄí‰ºöÂÆπÊòìÂæàÂ§ö„ÄÇÂè¶Â§ñÔºåTCC Ê®°ÂûãÔºå‰∏ÄÁõ¥Ê≤°ÊúâÂ§ßÂéÇÂºÄÊ∫êÔºå‰πüÊòØ‰∏ÄÂ§ßÁóõÁÇπ„ÄÇ ‰ªé‰ΩøÁî®Âª∫ËÆÆÊù•ËØ¥ÔºåMQ ÂèØËÉΩÊòØÁõ∏ÂØπÂêàÈÄÇÁöÑ( ‰∏çËØ¥ XA ÁöÑÂéüÂõ†ËøòÊòØÊÄßËÉΩÈóÆÈ¢ò )ÔºåÂπ∂‰∏îÂü∫Êú¨ËΩÆËØ¢‰∫Ü‰∏ÄÂúàÊúãÂèãÔºåÂèëÁé∞Â§ßÂ§öÈÉΩÊòØ‰ΩøÁî® MQ ÂÆûÁé∞ÊúÄÁªà‰∏ÄËá¥ÊÄßÂ±ÖÂ§ö„ÄÇ 2PC Ê®°ÂûãÁöÑÂÆûÁé∞ÔºåÁ¨îËÄÖËßâÂæóÈùûÂ∏∏Êñ∞Â•áÔºåÂ•à‰ΩïÈöîÁ¶ªÊÄßÊòØ‰∏Ä‰∏™Á°¨‰º§„ÄÇ Saga Ê®°ÂûãÔºåÂèØ‰ª•ËÆ§‰∏∫ÊòØ TCC Ê®°ÂûãÁöÑÁÆÄÂåñÁâàÔºåÊâÄ‰ª•Âú®ÁêÜËß£ÂíåÁºñÂÜôÁöÑÈöæÂ∫¶‰∏äÔºåÁÆÄÂçïÈùûÂ∏∏Â§ö„ÄÇ ÊâÄ‰ª•ÁªìËÆ∫ÊòØ‰ªÄ‰πàÂë¢Ôºü TCC Ê®°ÂûãÔºöTCC-Transaction„ÄÅHmily „ÄÇ Â∑≤ÁªèÊèê‰æõ‰∫ÜÂíå Dubbo ÈõÜÊàêÁöÑÊñπÊ°àÔºåËÉñÂèãÂèØ‰ª•Ëá™Â∑±ÂéªËØïËØï„ÄÇ XA Ê®°ÂûãÔºöSharding Sphere„ÄÅMyCAT „ÄÇ Êó†ÈúÄÂíå Dubbo ËøõË°åÈõÜÊàê„ÄÇ 2PC Ê®°ÂûãÔºöraincat„ÄÅlcn „ÄÇ Â∑≤ÁªèÊèê‰æõ‰∫ÜÂíå Dubbo ÈõÜÊàêÁöÑÊñπÊ°àÔºåËÉñÂèãÂèØ‰ª•Ëá™Â∑±ÂéªËØïËØï„ÄÇ MQ Ê®°ÂûãÔºöRocketMQ „ÄÇ Êó†ÈúÄÂíå Dubbo ËøõË°åÈõÜÊàê„ÄÇ BED Ê®°ÂûãÔºöSharding Sphere „ÄÇ Êó†ÈúÄÂíå Dubbo ËøõË°åÈõÜÊàê„ÄÇ Saga Ê®°ÂûãÔºöServiceComb Saga „ÄÇ Â•ΩÂÉèÂ∑≤ÁªèÊèê‰æõ‰∫ÜÂíå Dubbo ÈõÜÊàêÁöÑÊñπÊ°àÔºåÂèÇËßÅ „ÄäSaga-dubbo-demo„Äã ÊñáÊ°£„ÄÇ üòà ÊöÇÊó∂Ê≤°ÂéªÊ∑±ÂÖ•Á†îÁ©∂„ÄÇ Âè¶Â§ñÔºåËÉñÂèãÂú®ÁêÜËß£ÂàÜÂ∏ÉÂºè‰∫ãÂä°Êó∂Ôºå‰∏ÄÂÆöË¶ÅËÆ∞‰ΩèÔºåÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈúÄË¶ÅÁî±Â§ö‰∏™Êú¨Âú∞‰∫ãÂä°ÁªÑÊàê„ÄÇÊó†ËÆ∫ÊòØ‰∏äËø∞ÁöÑÈÇ£Áßç‰∫ãÂä°ÁªÑ‰ª∂Ê®°ÂûãÔºåÂÆÉ‰ª¨ÈÉΩÊòØÊâÆÊºî‰∏Ä‰∏™ÂçèË∞ÉËÄÖÔºå‰ΩøÂ§ö‰∏™Êú¨Âú∞‰∫ãÂä°ËææÂà∞ÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇËÄåÂçèË∞ÉÁöÑËøáÁ®ã‰∏≠ÔºåÂ∞±ÈùûÂ∏∏‰æùËµñÊØè‰∏™ÊñπÊ≥ïÊìç‰ΩúÂèØ‰ª•Ë¢´ÈáçÂ§çÊâßË°å‰∏ç‰ºö‰∫ßÁîüÂâØ‰ΩúÁî®ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÔºö ÂπÇÁ≠âÊÄßÔºÅÂõ†‰∏∫ÂèØËÉΩ‰ºöË¢´ÈáçÂ§çË∞ÉÁî®„ÄÇÂ¶ÇÊûúË∞ÉÁî®‰∏§Ê¨°ÈÄÄÊ¨æÔºåÁªìÊûúÈÄÄ‰∫Ü‰∏§Ê¨°Èí±ÔºåÈÇ£Â∞±È∫ªÁÉ¶Â§ß‰∫Ü„ÄÇ Êú¨Âú∞‰∫ãÂä°ÔºÅÂõ†‰∏∫ÊâßË°åËøáÁ®ã‰∏≠ÂèØËÉΩ‰ºöÂá∫ÈîôÔºåÈúÄË¶ÅÂõûÊªö„ÄÇ Dubbo Â¶Ç‰ΩïÈõÜÊàêÁΩëÂÖ≥ÊúçÂä°ÔºüDubbo Â¶Ç‰ΩïÈõÜÊàêÂà∞ÁΩëÂÖ≥ÊúçÂä°ÔºåÈúÄË¶ÅÊÄùËÄÉ‰∏§‰∏™ÈóÆÈ¢òÔºö ÁΩëÂÖ≥Â¶Ç‰ΩïË∞ÉÁî® Dubbo ÊúçÂä°„ÄÇ ÁΩëÂÖ≥Â¶Ç‰ΩïÂèëÁé∞ Dubbo ÊúçÂä°„ÄÇ Êàë‰ª¨ÂÖàÊù•ÁúãÁúãÔºåÂ∏ÇÈù¢‰∏äÊúâÂì™‰∫õÁΩëÂÖ≥ÊúçÂä°Ôºö Zuul Spring Cloud Gateway Kong Â¶Ç‰∏ä‰∏â‰∏™Ëß£ÂÜ≥ÊñπÊ°àÔºåÈÉΩÊòØÂü∫‰∫é HTTP Ë∞ÉÁî®ÂêéÁ´ØÁöÑÊúçÂä°„ÄÇÈÇ£‰πàÔºåËøôÊ†∑ÁöÑÊÉÖÂÜµ‰∏ãÔºåDubbo Âè™ËÉΩÈÄöËøáÊö¥Èú≤ rest:// ÂçèËÆÆÁöÑÊúçÂä°ÔºåÊâçËÉΩË¢´ÂÆÉ‰ª¨Ë∞ÉÁî®„ÄÇ ÈÇ£‰πà Dubbo ÁöÑ rest:// ÂçèËÆÆÁöÑÊúçÂä°ÔºåÊÄé‰πàËÉΩÂ§üË¢´Â¶Ç‰∏ä‰∏â‰∏™Ëß£ÂÜ≥ÊñπÊ°àÊ≥®ÂÜåÂèëÁé∞Âë¢Ôºü Âõ†‰∏∫ Dubbo ÂèØÁî®ÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÊúâ Zookeeper ÔºåÂ¶ÇÊûúË¶ÅË¢´ Zuul Êàñ Spring Cloud Gateway Ê≥®ÂÜåÂèëÁé∞ÔºåÂèØ‰ª•‰ΩøÁî® spring-cloud-starter-zookeeper-discovery Â∫ì„ÄÇÂÖ∑‰ΩìÂèØÂèÇËßÅ „ÄäService Discovery with Zookeeper„Äã ÊñáÁ´†„ÄÇ Dubbo ‰∏é Kong ÁöÑÈõÜÊàêÔºåÁõ∏ÂØπÊØîËæÉÈ∫ªÁÉ¶ÔºåÈúÄË¶ÅÈÄöËøá Kong ÁöÑ API Ê∑ªÂä†Áõ∏Â∫îÁöÑË∑ØÁî±ËßÑÂàô„ÄÇÂÖ∑‰ΩìÂèØÂèÇËßÅ „ÄäÈÄâÊã© Kong ‰Ωú‰∏∫‰Ω†ÁöÑ API ÁΩëÂÖ≥„Äã ÊñáÁ´†„ÄÇ ÂèØËÉΩ‰ºöÊúâËÉñÂèãÈóÆÔºåÊúâÊ≤°ÊîØÊåÅ dubbo:// ÂçèËÆÆÁöÑÁΩëÂÖ≥ÊúçÂä°Âë¢ÔºüÁõÆÂâçÊúâÊñ∞ÁöÑÁΩëÂÖ≥ÂºÄÊ∫ê Soul ÔºåÂü∫‰∫é Dubbo Ê≥õÂåñË∞ÉÁî®ÁöÑÁâπÊÄßÔºåÂÆûÁé∞ÂØπ dubbo:// ÂçèËÆÆÁöÑ Dubbo ÊúçÂä°ÁöÑË∞ÉÁî®„ÄÇ ÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÂèØ‰ª•ÂéªÁ†îÁ©∂‰∏ã„ÄÇ ÂÖ≥‰∫é Dubbo Ê≥õÂåñË∞ÉÁî®ÁöÑÁâπÊÄßÔºåËÉñÂèãÂèØ‰ª•ÁúãÁúã „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ‰ΩøÁî®Ê≥õÂåñË∞ÉÁî®„Äã „ÄÇ ÂÆûÈôÖÂú∫ÊôØ‰∏ãÔºåÊàë‰ª¨ÁúüÁöÑÈúÄË¶Å Dubbo ÈõÜÊàêÂà∞ÁΩëÂÖ≥ÂêóÔºüÂÖ∑ËâøËâø‰∫ÜËß£Âà∞ÔºåÂæàÂ§öÂÖ¨Âè∏ÔºåÂπ∂Êú™‰ΩøÁî®ÁΩëÂÖ≥ÔºåËÄåÊòØ‰ΩøÁî® Spring Boot Êê≠Âª∫‰∏Ä‰∏™ Web È°πÁõÆÔºåÂºïÂÖ• *-api.jar ÂåÖÔºåÁÑ∂ÂêéËøõË°åË∞ÉÁî®Ôºå‰ªéËÄåÂØπÂ§ñÊö¥Èú≤ HTTP API „ÄÇ Â¶Ç‰ΩïËøõË°åÁ≥ªÁªüÊãÜÂàÜÔºüËøô‰∏™ÈóÆÈ¢òÔºå‰∏çÊòØ‰ªÖ‰ªÖÈÄÇÁî®‰∫é Dubbo ÁöÑÂú∫ÊôØÔºåËÄåÊòØ SOA„ÄÅÂæÆÊúçÂä°„ÄÇÊé•‰∏äÈù¢ „Äå‰∏∫‰ªÄ‰πàË¶ÅÂ∞ÜÁ≥ªÁªüËøõË°åÊãÜÂàÜÔºü„Äç „ÄÇ Ëøô‰∏™ÈóÆÈ¢òËØ¥Â§ßÂèØ‰ª•ÂæàÂ§ßÔºåÂèØ‰ª•ÊâØÂà∞È¢ÜÂüüÈ©±Âä®Ê®°ÂûãËÆæËÆ°‰∏äÂéªÔºåËØ¥Â∞è‰∫Ü‰πüÂæàÂ∞èÔºåÊàë‰∏çÂ§™ÊÉ≥ÁªôÂ§ßÂÆ∂Â§™Ëøá‰∫éÂ≠¶ÊúØÁöÑËØ¥Ê≥ïÔºåÂõ†‰∏∫‰Ω†‰πü‰∏çÂèØËÉΩËÉåËøô‰∏™Á≠îÊ°àÔºåËøáÂéª‰∫ÜÁõ¥Êé•ËØ¥Âêß„ÄÇËøòÊòØËØ¥ÁöÑÁÆÄÂçï‰∏ÄÁÇπÔºåÂ§ßÂÆ∂Ëá™Â∑±Âà∞Êó∂ÂÄôÁü•ÈÅìÊÄé‰πàÂõûÁ≠îÂ∞±Ë°å‰∫Ü„ÄÇ Á≥ªÁªüÊãÜÂàÜ‰∏∫ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÔºåÊãÜÊàêÂ§ö‰∏™ÊúçÂä°ÔºåÊãÜÊàêÂæÆÊúçÂä°ÁöÑÊû∂ÊûÑÔºåÊòØÈúÄË¶ÅÊãÜÂæàÂ§öËΩÆÁöÑ„ÄÇÂπ∂‰∏çÊòØËØ¥‰∏äÊù•‰∏Ä‰∏™Êû∂ÊûÑÂ∏à‰∏ÄÊ¨°Â∞±ÁªôÊãÜÂ•Ω‰∫ÜÔºåËÄå‰ª•ÂêéÈÉΩ‰∏çÁî®ÊãÜ„ÄÇ Á¨¨‰∏ÄËΩÆÔºõÂõ¢ÈòüÁªßÁª≠Êâ©Â§ßÔºåÊãÜÂ•ΩÁöÑÊüê‰∏™ÊúçÂä°ÔºåÂàöÂºÄÂßãÊòØ 1 ‰∏™‰∫∫Áª¥Êä§ 1 ‰∏áË°å‰ª£Á†ÅÔºåÂêéÊù•‰∏öÂä°Á≥ªÁªüË∂äÊù•Ë∂äÂ§çÊùÇÔºåËøô‰∏™ÊúçÂä°ÊòØ 10 ‰∏áË°å‰ª£Á†ÅÔºå5 ‰∏™‰∫∫ÔºõÁ¨¨‰∫åËΩÆÔºå1‰∏™ÊúçÂä° -&gt; 5‰∏™ÊúçÂä°ÔºåÊØè‰∏™ÊúçÂä° 2 ‰∏áË°å‰ª£Á†ÅÔºåÊØè‰∫∫Ë¥üË¥£‰∏Ä‰∏™ÊúçÂä°„ÄÇ Â¶ÇÊûúÊòØÂ§ö‰∫∫Áª¥Êä§‰∏Ä‰∏™ÊúçÂä°ÔºåÊúÄÁêÜÊÉ≥ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂá†ÂçÅ‰∏™‰∫∫Ôºå1 ‰∏™‰∫∫Ë¥üË¥£ 1 ‰∏™Êàñ 2~3 ‰∏™ÊúçÂä°ÔºõÊüê‰∏™ÊúçÂä°Â∑•‰ΩúÈáèÂèòÂ§ß‰∫ÜÔºå‰ª£Á†ÅÈáèË∂äÊù•Ë∂äÂ§öÔºåÊüê‰∏™ÂêåÂ≠¶ÔºåË¥üË¥£‰∏Ä‰∏™ÊúçÂä°Ôºå‰ª£Á†ÅÈáèÂèòÊàê‰∫Ü 10 ‰∏áË°å‰∫ÜÔºå‰ªñËá™Â∑±‰∏çÂ†™ÈáçË¥üÔºå‰ªñÁé∞Âú®‰∏Ä‰∏™‰∫∫ÊãÜÂºÄÔºå5 ‰∏™ÊúçÂä°Ôºå1 ‰∏™‰∫∫È°∂ÁùÄÔºåË¥üË¥£ 5 ‰∏™‰∫∫ÔºåÊé•ÁùÄÊãõ‰∫∫Ôºå2 ‰∏™‰∫∫ÔºåÁªôÈÇ£‰∏™ÂêåÂ≠¶Â∏¶ÁùÄÔºå3 ‰∏™‰∫∫Ë¥üË¥£ 5 ‰∏™ÊúçÂä°ÔºåÂÖ∂‰∏≠ 2 ‰∏™‰∫∫ÊØè‰∏™‰∫∫Ë¥üË¥£ 2 ‰∏™ÊúçÂä°Ôºå1 ‰∏™‰∫∫Ë¥üË¥£ 1 ‰∏™ÊúçÂä°„ÄÇ ‰∏™‰∫∫Âª∫ËÆÆÔºå‰∏Ä‰∏™ÊúçÂä°ÁöÑ‰ª£Á†Å‰∏çË¶ÅÂ§™Â§öÔºå1‰∏áË°åÂ∑¶Âè≥Ôºå‰∏§‰∏â‰∏áÊíëÊ≠ª‰∫ÜÂêß„ÄÇ Â§ßÈÉ®ÂàÜÁöÑÁ≥ªÁªüÔºåÊòØË¶ÅËøõË°åÂ§öËΩÆÊãÜÂàÜÁöÑÔºåÁ¨¨‰∏ÄÊ¨°ÊãÜÂàÜÔºåÂèØËÉΩÂ∞±ÊòØÂ∞Ü‰ª•ÂâçÁöÑÂ§ö‰∏™Ê®°ÂùóËØ•ÊãÜÂàÜÂºÄÊù•‰∫ÜÔºåÊØîÂ¶ÇËØ¥Â∞ÜÁîµÂïÜÁ≥ªÁªüÊãÜÂàÜÊàêËÆ¢ÂçïÁ≥ªÁªü„ÄÅÂïÜÂìÅÁ≥ªÁªü„ÄÅÈááË¥≠Á≥ªÁªü„ÄÅ‰ªìÂÇ®Á≥ªÁªü„ÄÅÁî®Êà∑Á≥ªÁªüÔºåÁ≠âÁ≠âÂêß„ÄÇ ‰ΩÜÊòØÂêéÈù¢ÂèØËÉΩÊØè‰∏™Á≥ªÁªüÂèàÂèòÂæóË∂äÊù•Ë∂äÂ§çÊùÇ‰∫ÜÔºåÊØîÂ¶ÇËØ¥ÈááË¥≠Á≥ªÁªüÈáåÈù¢ÂèàÂàÜÊàê‰∫Ü‰æõÂ∫îÂïÜÁÆ°ÁêÜÁ≥ªÁªü„ÄÅÈááË¥≠ÂçïÁÆ°ÁêÜÁ≥ªÁªüÔºåËÆ¢ÂçïÁ≥ªÁªüÂèàÊãÜÂàÜÊàê‰∫ÜË¥≠Áâ©ËΩ¶Á≥ªÁªü„ÄÅ‰ª∑Ê†ºÁ≥ªÁªü„ÄÅËÆ¢ÂçïÁÆ°ÁêÜÁ≥ªÁªü„ÄÇ ÊâØÊ∑±‰∫ÜÂÆûÂú®ÂæàÊ∑±ÔºåÊâÄ‰ª•ËøôÈáåÂÖàÁªôÂ§ßÂÆ∂‰∏æ‰∏™‰æãÂ≠êÔºå‰Ω†Ëá™Â∑±ÊÑüÂèó‰∏Ä‰∏ãÔºåÊ†∏ÂøÉÊÑèÊÄùÂ∞±ÊòØÊ†πÊçÆÊÉÖÂÜµÔºåÂÖàÊãÜÂàÜ‰∏ÄËΩÆÔºåÂêéÈù¢Â¶ÇÊûúÁ≥ªÁªüÊõ¥Â§çÊùÇ‰∫ÜÔºåÂèØ‰ª•ÁªßÁª≠ÂàÜÊãÜ„ÄÇ‰Ω†Ê†πÊçÆËá™Â∑±Ë¥üË¥£Á≥ªÁªüÁöÑ‰æãÂ≠êÔºåÊù•ËÄÉËôë‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü„ÄÇ ÊãÜÂàÜÂêé‰∏çÁî® Dubbo ÂèØ‰ª•ÂêóÔºüÂΩìÁÑ∂ÊòØÂèØ‰ª•ÔºåÊñπÂºèËøòÊúâÂæàÂ§öÔºö Á¨¨‰∏ÄÁßçÔºå‰ΩøÁî® Spring Cloud ÊäÄÊúØ‰ΩìÁ≥ªÔºåËøô‰∏™‰πüÊòØÁõÆÂâçÂèØËÉΩÊúÄ‰∏ªÊµÅÁöÑ‰πã‰∏Ä„ÄÇ Á¨¨‰∫åÁßçÔºåDubbo Êç¢Êàê gRPC ÊàñËÄÖ Thrift „ÄÇÂΩìÁÑ∂ÔºåÊ≠§Êó∂Ë¶ÅËá™Â∑±ÂÆûÁé∞Ê≥®ÂÜåÂèëÁé∞„ÄÅË¥üËΩΩÂùáË°°„ÄÅÈõÜÁæ§ÂÆπÈîôÁ≠âÁ≠âÂäüËÉΩ„ÄÇ Á¨¨‰∏âÁßçÔºåDubbo Êç¢ÊàêÂêåÁ≠âÂÆö‰ΩçÁöÑÊúçÂä°ÂåñÊ°ÜÊû∂Ôºå‰æãÂ¶ÇÂæÆÂçöÁöÑ Motan „ÄÅËöÇËöÅÈáëÊúçÁöÑ SofaRPC „ÄÇ Á¨¨ÂõõÁßçÔºåSpring MVC + Nginx „ÄÇ Á¨¨‰∫îÁßçÔºåÊØè‰∏™ÊúçÂä°ÊãÜÊàê‰∏Ä‰∏™ Maven È°πÁõÆÔºåÊâìÊàê Jar ÂåÖÔºåÁªôÂÖ∂ÂÆÉÊúçÂä°‰ΩøÁî®„ÄÇüòà ÂΩìÁÑ∂ÔºåËøô‰∏™‰∏çÊòØ‰∏Ä‰∏™ÊØîËæÉÁâπÂà´ÁöÑÊñπÊ°à„ÄÇ ÂΩìÁÑ∂ÂèØ‰ª•‰∫ÜÔºåÂ§ß‰∏ç‰∫ÜÊúÄÊ¨°ÔºåÂ∞±ÊòØÂêÑ‰∏™Á≥ªÁªü‰πãÈó¥ÔºåÁõ¥Êé•Âü∫‰∫é spring mvcÔºåÂ∞±Á∫Ø http Êé•Âè£‰∫íÁõ∏ÈÄö‰ø°ÂëóÔºåËøòËÉΩÂíãÊ†∑„ÄÇ‰ΩÜÊòØËøô‰∏™ËÇØÂÆöÊòØÊúâÈóÆÈ¢òÁöÑÔºåÂõ†‰∏∫ http Êé•Âè£ÈÄö‰ø°Áª¥Êä§Ëµ∑Êù•ÊàêÊú¨ÂæàÈ´òÔºå‰Ω†Ë¶ÅËÄÉËôëË∂ÖÊó∂ÈáçËØï„ÄÅË¥üËΩΩÂùáË°°Á≠âÁ≠âÂêÑÁßç‰π±‰∏ÉÂÖ´Á≥üÁöÑÈóÆÈ¢òÔºåÊØîÂ¶ÇËØ¥‰Ω†ÁöÑËÆ¢ÂçïÁ≥ªÁªüË∞ÉÁî®ÂïÜÂìÅÁ≥ªÁªüÔºåÂïÜÂìÅÁ≥ªÁªüÈÉ®ÁΩ≤‰∫Ü 5 Âè∞Êú∫Âô®Ôºå‰Ω†ÊÄé‰πàÊääËØ∑Ê±ÇÂùáÂåÄÂú∞Áî©ÁªôÈÇ£ 5 Âè∞Êú∫Âô®ÔºüËøô‰∏çÂ∞±ÊòØË¥üËΩΩÂùáË°°Ôºü‰Ω†Ë¶ÅÊòØÈÉΩËá™Â∑±ÊêûÈÇ£ÊòØÂèØ‰ª•ÁöÑÔºå‰ΩÜÊòØÁ°ÆÂÆûÂæàÁóõËã¶„ÄÇ ÊâÄ‰ª• dubbo ËØ¥ÁôΩ‰∫ÜÔºåÊòØ‰∏ÄÁßç rpc Ê°ÜÊû∂ÔºåÂ∞±ÊòØËØ¥Êú¨Âú∞Â∞±ÊòØËøõË°åÊé•Âè£Ë∞ÉÁî®Ôºå‰ΩÜÊòØ dubbo ‰ºö‰ª£ÁêÜËøô‰∏™Ë∞ÉÁî®ËØ∑Ê±ÇÔºåË∑üËøúÁ®ãÊú∫Âô®ÁΩëÁªúÈÄö‰ø°ÔºåÁªô‰Ω†Â§ÑÁêÜÊéâË¥üËΩΩÂùáË°°‰∫Ü„ÄÅÊúçÂä°ÂÆû‰æã‰∏ä‰∏ãÁ∫øËá™Âä®ÊÑüÁü•‰∫Ü„ÄÅË∂ÖÊó∂ÈáçËØï‰∫ÜÔºåÁ≠âÁ≠â‰π±‰∏ÉÂÖ´Á≥üÁöÑÈóÆÈ¢ò„ÄÇÈÇ£‰Ω†Â∞±‰∏çÁî®Ëá™Â∑±ÂÅö‰∫ÜÔºåÁî® dubbo Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ Spring Cloud ‰∏é Dubbo ÊÄé‰πàÈÄâÊã©ÔºüÈ¶ñÂÖàÔºåÊàë‰ª¨Êù•ÁúãÁúãËøô‰∏§‰∏™ÊäÄÊúØÊ†àÂú®ÂõΩÂÜÖÁöÑÊµÅË°åÁ®ãÂ∫¶ÔºåÊçÆËâøËâø‰∫ÜËß£Âà∞Ôºö ÂØπ‰∫éÂõΩÂ§ñÔºåSpring Cloud Âü∫Êú¨Â∑≤ÁªèÁªü‰∏ÄÂõΩÂ§ñÁöÑÂæÆÊúçÂä°‰ΩìÁ≥ª„ÄÇ ÂØπ‰∫éÂõΩÂÜÖÔºåËÄÅÁöÑÁ≥ªÁªü‰ΩøÁî® Dubbo ËæÉÂ§öÔºåÊñ∞ÁöÑÁ≥ªÁªü‰ΩøÁî® Spring Cloud ËæÉÂ§ö„ÄÇ ËøôÊ†∑ËØ¥Ëµ∑Êù•Ôºå‰ªø‰Ωõ Spring Cloud Âíå Dubbo ÊòØÂÜ≤Á™ÅÁöÑÂÖ≥Á≥ªÔºüÔºÅ ÂÆûÈôÖ‰∏äÔºåÂπ∂‰∏çÁÑ∂„ÄÇÊàë‰ª¨Áé∞Âú®ÊâÄ‰ΩøÁî®ÁöÑ Spring Cloud ÊäÄÊúØ‰ΩìÁ≥ªÔºåÂÆûÈôÖ‰∏äÊòØ Spring Cloud Netflix ‰∏∫‰∏ªÔºå‰æãÂ¶ÇËØ¥Ôºö Netflix Eureka Ê≥®ÂÜå‰∏≠ÂøÉ Netflix Hystrix ÁÜîÊñ≠ÁªÑ‰ª∂ Netflix Ribbon Ë¥üËΩΩÂùáË°° Netflix Zuul ÁΩëÂÖ≥ÊúçÂä° ‰ΩÜÊòØÔºåÂºÄÊ∫êÁöÑ‰∏ñÁïåÔºåÊÄªÊòØËøô‰πàÊúâË∂£„ÄÇÁõÆÂâç Alibaba Âü∫‰∫é Spring Cloud ÁöÑÊé•Âè£ÔºåÂØπÁöÑÊòØÊé•Âè£ÔºåÂÆûÁé∞‰∫Ü‰∏ÄÂ•ó Spring Cloud Alibaba ÊäÄÊúØ‰ΩìÁ≥ªÔºåÂπ∂‰∏îÂ∑≤ÁªèËé∑Âæó Spring Cloud ÁöÑËÆ§ÂèØÔºåÂ§Ñ‰∫éÂ≠µÂåñÁä∂ÊÄÅ„ÄÇÁªÑ‰ª∂Â¶Ç‰∏ãÔºö Nacos Ê≥®ÂÜå‰∏≠ÂøÉÔºåÂØπÊ†á Eureka „ÄÇ Nacos ÈÖçÁΩÆ‰∏≠ÂøÉÔºåÈõÜÊàêÂà∞ Spring Cloud Config „ÄÇ Sentinel ÊúçÂä°‰øùÈöúÔºåÂØπÊ†á Hystrix „ÄÇ Dubbo ÊúçÂä°Ë∞ÉÁî®( ÂåÖÊã¨Ë¥üËΩΩÂùáË°° )ÔºåÂØπÊ†á Ribbon + Feign „ÄÇ Áº∫Â§± ÁΩëÂÖ≥ÊúçÂä°„ÄÇ RocketMQ ÈòüÂàóÊúçÂä°ÔºåÈõÜÊàêÂà∞ Spring Cloud Stream „ÄÇ Êõ¥Â§öÁöÑËÆ®ËÆ∫ÔºåËÉñÂèãÂèØ‰ª•Â∞æÈöèÁü•‰πé‰∏äÁöÑ „ÄäËØ∑ÈóÆÂì™‰ΩçÂ§ßÁ•ûÊØîËæÉËøá spring cloud Âíå dubbo ÔºåÂêÑËá™ÁöÑ‰ºòÁº∫ÁÇπÊòØ‰ªÄ‰πà?„Äã „ÄÇ ËâøËâøÁöÑ‰∏™‰∫∫ÊÄÅÂ∫¶‰∏äÔºåËøòÊòØÈùûÂ∏∏ÁúãÂ•Ω Spring Cloud Alibaba ÊäÄÊúØ‰ΩìÁ≥ªÁöÑ„ÄÇ‰∏∫‰ªÄ‰πàÂë¢ÔºüÂõ†‰∏∫ Alibaba ËÉåÂêéÊúâÈòøÈáå‰∫ëÁöÑÂ≠òÂú®ÔºåÊèê‰æõÂºÄÊ∫êÈ°πÁõÆÂíåÂïÜ‰∏öÊúçÂä°ÁöÑÁªü‰∏Ä„ÄÇüòà Ëøô‰∏™ÔºåÊòØ Netflix ÊâÄÊó†Ê≥ïÊØîÊãüÁöÑ„ÄÇ‰æãÂ¶ÇËØ¥Ôºö ÂºÄÊ∫êÈ°πÁõÆ ÈòøÈáå‰∫ëÊúçÂä° Tengine LBS Dubbo EDAS RocketMQ ONS ËøôÈáåÂú®ÊäõÂá∫‰∏Ä‰∏™ËØùÈ¢ò„ÄÇÁõÆÂâç‰º†ËØ¥ Dubbo Âú®ÂõΩÂ§ñÁöÑÊé•ÂèóÂ∫¶ÊØîËæÉ‰ΩéÔºåÈÇ£‰πàÂú® Spring Cloud Alibaba ÊàêÂäüÂ≠µÂåñÂÆåÂêéÔºåÊòØÂê¶ËÉΩÂ§üÊùÄÂÖ•ÂõΩÂ§ñÁöÑÂ∏ÇÂú∫Âë¢ÔºüËÆ©Êàë‰ª¨Êã≠ÁõÆ‰ª•ÂæÖ„ÄÇ Âú®ËÅä‰∏Ä‰∏¢‰∏¢ÊúâÊÑèÊÄùÁöÑ‰∫ãÊÉÖ„ÄÇ ‰∫ãÂÆû‰∏äÔºåNetflix Â∑≤ÁªèÂü∫Êú¨‰∏çÂÜçÁª¥Êä§ Eureka„ÄÅHystrix ÔºåÊõ¥ÊúâË∂£ÁöÑÊòØÔºåÂõ†‰∏∫ÁΩëÂÖ≥ÁöÑ‰∫ãÊÉÖÔºåZuul Âíå Spring Cloud Âõ¢ÈòüÊúâÁÇπÈóπÊé∞‰∫ÜÔºåÂõ†ËÄåÂêéÊù•Êúâ‰∫Ü Spring Cloud Gateway „ÄÇÂõ†ËÄåÔºåZuul2 ÂêéÁª≠Âú® Spring Cloud ‰ΩìÁ≥ª‰∏≠ÁöÑÊÉÖÂÜµÔºå‰ºöÈùûÂ∏∏ÊúâË∂£~ Âè¶Â§ñÔºåSpring Cloud Ë≤å‰ºº‰πüÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ LoadBalance Ë¥üËΩΩÂùáË°°ÁªÑ‰ª∂Âìü„ÄÇ Â¶Ç‰ΩïËá™Â∑±ËÆæËÆ°‰∏Ä‰∏™Á±ª‰ºº Dubbo ÁöÑ RPC Ê°ÜÊû∂ÔºüÈù¢ËØïÂÆòÂøÉÁêÜÂàÜÊûê ËØ¥ÂÆûËØùÔºåÂ∞±ËøôÈóÆÈ¢òÔºåÂÖ∂ÂÆûÂ∞±Ë∑üÈóÆ‰Ω†Â¶Ç‰ΩïËá™Â∑±ËÆæËÆ°‰∏Ä‰∏™ MQ ‰∏ÄÊ†∑ÁöÑÈÅìÁêÜÔºåÂ∞±ËÄÉ‰∏§‰∏™Ôºö ‰Ω†ÊúâÊ≤°ÊúâÂØπÊüê‰∏™ rpc Ê°ÜÊû∂ÂéüÁêÜÊúâÈùûÂ∏∏Ê∑±ÂÖ•ÁöÑÁêÜËß£„ÄÇ ‰Ω†ËÉΩ‰∏çËÉΩ‰ªéÊï¥‰Ωì‰∏äÊù•ÊÄùËÄÉ‰∏Ä‰∏ãÔºåÂ¶Ç‰ΩïËÆæËÆ°‰∏Ä‰∏™ rpc Ê°ÜÊû∂ÔºåËÄÉËÄÉ‰Ω†ÁöÑÁ≥ªÁªüËÆæËÆ°ËÉΩÂäõ„ÄÇ Èù¢ËØïÈ¢òÂâñÊûê ÂÖ∂ÂÆûÈóÆÂà∞‰Ω†ËøôÈóÆÈ¢òÔºå‰Ω†Ëµ∑Á†Å‰∏çËÉΩËÆ§ÊÄÇÔºåÂõ†‰∏∫ÊòØÁü•ËØÜÁöÑÊâ´Áõ≤ÔºåÈÇ£Êàë‰∏çÂèØËÉΩÁªô‰Ω†Ê∑±ÂÖ•ËÆ≤Ëß£‰ªÄ‰πà kafka Ê∫êÁ†ÅÂâñÊûêÔºådubbo Ê∫êÁ†ÅÂâñÊûêÔºå‰ΩïÂÜµÊàëÂ∞±ÁÆóËÆ≤‰∫ÜÔºå‰Ω†Ë¶ÅÁúüÁöÑÊ∂àÂåñÁêÜËß£ÂíåÂê∏Êî∂ÔºåËµ∑Á†Å‰∏™ÊääÊúà‰ª•Âêé‰∫Ü„ÄÇ ÊâÄ‰ª•ÊàëÁªôÂ§ßÂÆ∂‰∏Ä‰∏™Âª∫ËÆÆÔºåÈÅáÂà∞ËøôÁ±ªÈóÆÈ¢òÔºåËµ∑Á†Å‰ªé‰Ω†‰∫ÜËß£ÁöÑÁ±ª‰ººÊ°ÜÊû∂ÁöÑÂéüÁêÜÂÖ•ÊâãÔºåËá™Â∑±ËØ¥ËØ¥ÂèÇÁÖß dubbo ÁöÑÂéüÁêÜÔºå‰Ω†Êù•ËÆæËÆ°‰∏Ä‰∏ãÔºå‰∏æ‰∏™‰æãÂ≠êÔºådubbo ‰∏çÊòØÊúâÈÇ£‰πàÂ§öÂàÜÂ±Ç‰πàÔºüËÄå‰∏îÊØè‰∏™ÂàÜÂ±ÇÊòØÂπ≤Âï•ÁöÑÔºå‰Ω†Â§ßÊ¶ÇÊòØ‰∏çÊòØÁü•ÈÅìÔºüÈÇ£Â∞±ÊåâÁÖßËøô‰∏™ÊÄùË∑ØÂ§ßËá¥ËØ¥‰∏Ä‰∏ãÂêßÔºåËµ∑Á†Å‰Ω†‰∏çËÉΩÊáµÈÄºÔºåË¶ÅÊØîÈÇ£‰∫õ‰∏äÊù•Â∞±ÊáµÔºåÂï•‰πüËØ¥‰∏çÂá∫Êù•ÁöÑ‰∫∫Ë¶ÅÂ•Ω‰∏Ä‰∫õ„ÄÇ ‰∏æ‰∏™Ê†óÂ≠êÔºåÊàëÁªôÂ§ßÂÆ∂ËØ¥‰∏™ÊúÄÁÆÄÂçïÁöÑÂõûÁ≠îÊÄùË∑ØÔºö ‰∏äÊù•‰Ω†ÁöÑÊúçÂä°Â∞±ÂæóÂéªÊ≥®ÂÜå‰∏≠ÂøÉÊ≥®ÂÜåÂêßÔºå‰Ω†ÊòØ‰∏çÊòØÂæóÊúâ‰∏™Ê≥®ÂÜå‰∏≠ÂøÉÔºå‰øùÁïôÂêÑ‰∏™ÊúçÂä°ÁöÑ‰ø°ÂøÉÔºåÂèØ‰ª•Áî® zookeeper Êù•ÂÅöÔºåÂØπÂêß„ÄÇ ÁÑ∂Âêé‰Ω†ÁöÑÊ∂àË¥πËÄÖÈúÄË¶ÅÂéªÊ≥®ÂÜå‰∏≠ÂøÉÊãøÂØπÂ∫îÁöÑÊúçÂä°‰ø°ÊÅØÂêßÔºåÂØπÂêßÔºåËÄå‰∏îÊØè‰∏™ÊúçÂä°ÂèØËÉΩ‰ºöÂ≠òÂú®‰∫éÂ§öÂè∞Êú∫Âô®‰∏ä„ÄÇ Êé•ÁùÄ‰Ω†Â∞±ËØ•ÂèëËµ∑‰∏ÄÊ¨°ËØ∑Ê±Ç‰∫ÜÔºåÂíãÂèëËµ∑ÔºüÂΩìÁÑ∂ÊòØÂü∫‰∫éÂä®ÊÄÅ‰ª£ÁêÜ‰∫ÜÔºå‰Ω†Èù¢ÂêëÊé•Âè£Ëé∑ÂèñÂà∞‰∏Ä‰∏™Âä®ÊÄÅ‰ª£ÁêÜÔºåËøô‰∏™Âä®ÊÄÅ‰ª£ÁêÜÂ∞±ÊòØÊé•Âè£Âú®Êú¨Âú∞ÁöÑ‰∏Ä‰∏™‰ª£ÁêÜÔºåÁÑ∂ÂêéËøô‰∏™‰ª£ÁêÜ‰ºöÊâæÂà∞ÊúçÂä°ÂØπÂ∫îÁöÑÊú∫Âô®Âú∞ÂùÄ„ÄÇ ÁÑ∂ÂêéÊâæÂì™‰∏™Êú∫Âô®ÂèëÈÄÅËØ∑Ê±ÇÔºüÈÇ£ËÇØÂÆöÂæóÊúâ‰∏™Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ï‰∫ÜÔºåÊØîÂ¶ÇÊúÄÁÆÄÂçïÁöÑÂèØ‰ª•ÈöèÊú∫ËΩÆËØ¢ÊòØ‰∏çÊòØ„ÄÇ Êé•ÁùÄÊâæÂà∞‰∏ÄÂè∞Êú∫Âô®ÔºåÂ∞±ÂèØ‰ª•Ë∑üÂÆÉÂèëÈÄÅËØ∑Ê±Ç‰∫ÜÔºåÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÂíãÂèëÈÄÅÔºü‰Ω†ÂèØ‰ª•ËØ¥Áî® netty ‰∫ÜÔºånio ÊñπÂºèÔºõÁ¨¨‰∫å‰∏™ÈóÆÈ¢òÂèëÈÄÅÂï•Ê†ºÂºèÊï∞ÊçÆÔºü‰Ω†ÂèØ‰ª•ËØ¥Áî® hessian Â∫èÂàóÂåñÂçèËÆÆ‰∫ÜÔºåÊàñËÄÖÊòØÂà´ÁöÑÔºåÂØπÂêß„ÄÇÁÑ∂ÂêéËØ∑Ê±ÇËøáÂéª‰∫Ü„ÄÇ ÊúçÂä°Âô®ÈÇ£Ëæπ‰∏ÄÊ†∑ÁöÑÔºåÈúÄË¶ÅÈíàÂØπ‰Ω†Ëá™Â∑±ÁöÑÊúçÂä°ÁîüÊàê‰∏Ä‰∏™Âä®ÊÄÅ‰ª£ÁêÜÔºåÁõëÂê¨Êüê‰∏™ÁΩëÁªúÁ´ØÂè£‰∫ÜÔºåÁÑ∂Âêé‰ª£ÁêÜ‰Ω†Êú¨Âú∞ÁöÑÊúçÂä°‰ª£Á†Å„ÄÇÊé•Êî∂Âà∞ËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÂ∞±Ë∞ÉÁî®ÂØπÂ∫îÁöÑÊúçÂä°‰ª£Á†ÅÔºåÂØπÂêß„ÄÇ ËøôÂ∞±ÊòØ‰∏Ä‰∏™ÊúÄÊúÄÂü∫Êú¨ÁöÑ rpc Ê°ÜÊû∂ÁöÑÊÄùË∑ØÔºåÂÖà‰∏çËØ¥‰Ω†ÊúâÂ§öÁâõÈÄºÁöÑÊäÄÊúØÂäüÂ∫ïÔºåÂì™ÊÄïËøô‰∏™ÊúÄÁÆÄÂçïÁöÑÊÄùË∑Ø‰Ω†ÂÖàÁªôÂá∫Êù•Ë°å‰∏çË°åÔºü Â¶ÇÊûú‰∏äËø∞ÊèèËø∞ÔºåËÉñÂèãÁúãÁöÑÊØîËæÉÈó∑ÈÄºÔºåÂèØ‰ª•ÈòÖËØª‰∏ãÂæêÂ¶àÂÜôÁöÑ „ÄäÁÆÄÂçï‰∫ÜËß£ RPC ÂÆûÁé∞ÂéüÁêÜ„Äã ÔºåËá™Â∑±Âä®ÊâãÊí∏‰∏Ä‰∏™ÊúÄÊúÄÊúÄÂü∫Á°ÄÁöÑ RPC ÈÄö‰ø°ÁöÑËøáÁ®ã„ÄÇ Âõ†‰∏∫ Dubbo ÂÆûÁé∞‰∫ÜÂ§ßÈáèÁöÑÊäΩË±°ÔºåÂπ∂‰∏îÊèê‰æõ‰∫ÜÂ§öÁßç‰ª£Á†ÅÂÆûÁé∞Ôºå‰ª•ÂèäÂ§ßÈáèÁöÑ RPC ÁâπÊÄßÔºåÊâÄ‰ª•‰ª£Á†ÅÈáè‰ºöÁõ∏ÂØπËæÉÂ§ö„ÄÇ Â¶ÇÊûúËÉñÂèãÊòØËá™Â∑±ÂÆûÁé∞‰∏Ä‰∏™ÊúÄÂ∞èÂåñÁöÑ PRC Ê°ÜÊû∂ÔºåÂèØËÉΩ‰ª£Á†ÅÈáè‰ºöÊØîÊÉ≥Ë±°‰∏≠ÁöÑÂ∞ëÂæàÂ§öÔºåÂèØËÉΩÂá†ÂçÉË°å‰ª£Á†ÅÂ∞±Â§ü‰∫Ü„ÄÇÂº∫ÁÉàÊé®ËçêÔºåËÉñÂèãËá™Â∑±Êí∏Ëµ∑Ë¢ñÂ≠êÔºåÂä®Ëµ∑ÊâãÊù•„ÄÇ‰ªéÊ≠§‰πãÂêéÔºå‰Ω†‰ºöÂØπ RPC Ê°ÜÊû∂ÔºåÊúâÊõ¥Ê∑±ÂÖ•ÁöÑÁêÜËß£„ÄÇ ÂÖ∂‰ªñÈóÆÈ¢òÂΩìÁÑ∂ÔºåDubbo ËøòÊúâÂæàÂ§öÈùûÂ∏∏ÁªÜËäÇÔºåÁîöËá≥ÁâµÊâØÂà∞Ê∫êÁ†ÅÁöÑÈóÆÈ¢òÔºåËâøËâøÂπ∂Êú™ÂÖ®ÈÉ®ÂàóÂàó‰∏æ„ÄÇÂ¶Ç‰∏ãÁöÑÈóÆÈ¢òÔºåÈúÄË¶ÅËÉñÂèãËá™Â∑±ÂéªËÄêÂøÉÁúãÊ∫êÁ†ÅÔºåÊÄùËÄÉÁ≠îÊ°à„ÄÇ Dubbo ÊúçÂä°ÂèëÂ∏ÉËøáÁ®ã‰∏≠ÔºåÂÅö‰∫ÜÂì™‰∫õ‰∫ãÔºü „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ÊúçÂä°Êö¥Èú≤Ôºà‰∏ÄÔºâ‰πãÊú¨Âú∞Êö¥Èú≤ÔºàInjvmÔºâ„Äã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ÊúçÂä°Êö¥Èú≤Ôºà‰∫åÔºâ‰πãËøúÁ®ãÊö¥Èú≤ÔºàDubboÔºâ„Äã Dubbo ÊúçÂä°ÂºïÁî®ËøáÁ®ã‰∏≠ÔºåÂÅö‰∫ÜÂì™‰∫õ‰∫ãÔºü „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ÊúçÂä°ÂºïÁî®Ôºà‰∏ÄÔºâ‰πãÊú¨Âú∞ÂºïÁî®ÔºàInjvmÔºâ„Äã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ÊúçÂä°ÂºïÁî®Ôºà‰∫åÔºâ‰πãËøúÁ®ãÂºïÁî®ÔºàDubboÔºâ„Äã Dubbo ÁÆ°ÁêÜÂπ≥Âè∞ËÉΩÂ§üÂä®ÊÄÅÊîπÂèòÊé•Âè£ÁöÑ‰∏Ä‰∫õÈÖçÁΩÆÔºåÂÖ∂ÂéüÁêÜÊòØÊÄéÊ†∑ÁöÑ? Ë∑ØÁî±ËßÑÂàô „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîôÔºà‰∏ÉÔºâ‰πã Router ÂÆûÁé∞„Äã „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî Ë∑ØÁî±ËßÑÂàô„Äã ÈÖçÁΩÆËßÑÂàô „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîôÔºàÂÖ≠Ôºâ‰πã Configurator ÂÆûÁé∞„Äã „ÄäDubbo Áî®Êà∑ÊåáÂçó ‚Äî‚Äî ÈÖçÁΩÆËßÑÂàô„Äã Âú® Dubbo ‰∏≠Ôºå‰ªÄ‰πàÊó∂ÂÄôÊõ¥Êñ∞Êú¨Âú∞ÁöÑ Zookeeper ‰ø°ÊÅØÁºìÂ≠òÊñá‰ª∂ÔºüËÆ¢ÈòÖZookeeper ‰ø°ÊÅØÁöÑÊï¥‰ΩìËøáÁ®ãÊòØÊÄé‰πàÊ†∑ÁöÑ? „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Ê≥®ÂÜå‰∏≠ÂøÉÔºà‰∏ÄÔºâ‰πãÊäΩË±° API„Äã „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî Ê≥®ÂÜå‰∏≠ÂøÉÔºà‰∫åÔºâ‰πã Zookeeper„Äã ÊúÄÂ∞èÊ¥ªË∑ÉÊï∞ÁÆóÊ≥ï‰∏≠ÊòØÂ¶Ç‰ΩïÁªüËÆ°Ëøô‰∏™Ê¥ªË∑ÉÊï∞ÁöÑÔºü „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî ËøáÊª§Âô®ÔºàÂõõÔºâ‰πã ActiveLimitFilter &amp;&amp; ExecuteLimitFilter„Äã Ôºå‰∏ªË¶Å „Äå2. 2. RpcStatus„Äç Âíå „Äå3. ActiveLimitFilter„Äç ÈÉ®ÂàÜ„ÄÇ „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîôÔºàÂõõÔºâ‰πã LoadBalance ÂÆûÁé∞„Äã Ôºå‰∏ªË¶Å „Äå6. LeastActiveLoadBalance„Äç ÈÉ®ÂàÜ„ÄÇ ÁÆÄÂçïË∞àË∞à‰Ω†ÂØπ‰∏ÄËá¥ÊÄßÂìàÂ∏åÁÆóÊ≥ïÁöÑËÆ§ËØÜÔºü „ÄäÁ≤æÂ∞Ω Dubbo Ê∫êÁ†ÅËß£Êûê ‚Äî‚Äî ÈõÜÁæ§ÂÆπÈîôÔºàÂõõÔºâ‰πã LoadBalance ÂÆûÁé∞„Äã Ôºå‰∏ªË¶Å „Äå7. ConsistentHashSelector„Äç ÈÉ®ÂàÜ„ÄÇ ÂÖ≥‰∫é‰∏ÄËá¥ÊÄßÂìàÂ∏åÁÆóÊ≥ïÂú®ÁºìÂ≠ò‰∏≠ÁöÑ‰ΩøÁî®ÔºåÊàë‰ª¨‰ºöÂçïÁã¨Âú®ÁºìÂ≠òÁõ∏ÂÖ≥ÁöÑÈù¢ËØïÈ¢ò‰∏≠ÂàÜ‰∫´„ÄÇ 666. ÂΩ©ËõãÂú®ÁúãÂà∞Ê≠§Â§ÑÔºåËÉñÂèãÊúâÊ≤°ÂèëÁé∞ÔºåÂú®ÂÆûÈôÖÈù¢ËØïÁöÑ Dubbo ÈóÆÈ¢ò‰∏≠ÔºåDubbo ÂÆòÊñπÊñáÊ°£Â∑≤ÁªèÁªô‰∫ÜÊàë‰ª¨ÂæàÂ§öÁ≠îÊ°à„ÄÇËøôËØ¥Êòé‰ªÄ‰πàÂë¢Ôºü‰∏ÄÂÆö‰∏ÄÂÆö‰∏ÄÂÆöË¶ÅËÆ§ÁúüÁ†îËØªÂÆòÊñπÊèê‰æõÁöÑÁü•ËØÜÔºåÊØïÁ´üÔºåËøôÊòØÊúÄÁ≥ªÁªüÔºå‰∏îÁ¨¨‰∏ÄÊâãÁöÑËµÑÊñô„ÄÇ Â¶ÇÊûúËÉñÂèãÊÉ≥ÂØπ RPC Êúâ‰∏Ä‰∏™Êï¥‰ΩìÁöÑÁêÜËß£ÔºåÊé®ËçêÁúãÁúãÂæêÂ¶àÁöÑËøôÂ•óÊñáÁ´†„ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC Á≥ªÂàó„ÄãÔºö „ÄäÁÆÄÂçï‰∫ÜËß£ RPC ÂÆûÁé∞ÂéüÁêÜ„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πãÂ∫èÂàóÂåñÁØá ‚Äì Kryo„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πãÂ∫èÂàóÂåñÁØá ‚Äì ÊÄªÁªìÁØá„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πãÂä®ÊÄÅ‰ª£ÁêÜÁØá„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πã‰º†ËæìÁØá„Äã „ÄäMotan ‰∏≠‰ΩøÁî®ÂºÇÊ≠• RPC Êé•Âè£„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πãÂçèËÆÆÁØá„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£RPC‰πãÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞ÁØá„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£ RPC ‰πãÈõÜÁæ§ÁØá„Äã „Ää„ÄêÂçÉÁ±≥ÁΩë„Äë‰ªéË∑®ËØ≠Ë®ÄË∞ÉÁî®Âà∞ dubbo2.js„Äã „ÄäÂ§©Ê±†‰∏≠Èó¥‰ª∂Â§ßËµõ Dubbo Mesh ‰ºòÂåñÊÄªÁªìÔºàQPS ‰ªé 1000 Âà∞ 6850Ôºâ„Äã ÂèÇËÄÉ‰∏éÊé®ËçêÂ¶Ç‰∏ãÊñáÁ´†Ôºö „ÄäDubbo Áî®Êà∑ÊåáÂçó„Äã ÂøÖÈÄâ„ÄÇ „ÄäDubbo ÂºÄÂèëÊåáÂçó„Äã ËøõÈò∂„ÄÇ „ÄäDubbo ËøêÁª¥ÁÆ°ÁêÜ„Äã ÂèØÈÄâ„ÄÇ „ÄäÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∫íÊñ•ÊÄß‰∏éÂπÇÁ≠âÊÄßÈóÆÈ¢òÁöÑÂàÜÊûê‰∏éËß£ÂÜ≥„Äã ÈªëÈ©¨Á®ãÂ∫èÂëò „Ää„Äê‰∏äÊµ∑Ê†°Âå∫„ÄëÊï¥ÁêÜÁöÑ Dubbo Èù¢ËØïÈ¢ò„Äã ÁæéÂõ¢ „ÄäËØ¥‰∏Ä‰∏ã Dubbo ÁöÑÂ∑•‰ΩúÂéüÁêÜÔºüÊ≥®ÂÜå‰∏≠ÂøÉÊåÇ‰∫ÜÂèØ‰ª•ÁªßÁª≠ÈÄö‰ø°ÂêóÔºü„Äã lijiaccy „ÄäJava Èù¢ËØï‰πã Dubbo„Äã Java Áü•Èü≥ Dubbo Èù¢ËØïÈ¢ò „ÄäDubbo ÊîØÊåÅÂì™‰∫õÂ∫èÂàóÂåñÂçèËÆÆÔºüËØ¥‰∏Ä‰∏ã Hessian ÁöÑÊï∞ÊçÆÁªìÊûÑÔºüPB Áü•ÈÅìÂêóÔºü‰∏∫‰ªÄ‰πà PB ÁöÑÊïàÁéáÊòØÊúÄÈ´òÁöÑÔºü„Äã „ÄäDubbo ÁöÑ SPI ÊÄùÊÉ≥ÊòØ‰ªÄ‰πàÔºü„Äã „ÄäÂ¶Ç‰ΩïÂü∫‰∫é Dubbo ËøõË°åÊúçÂä°Ê≤ªÁêÜ„ÄÅÊúçÂä°ÈôçÁ∫ß„ÄÅÂ§±Ë¥•ÈáçËØï‰ª•ÂèäË∂ÖÊó∂ÈáçËØïÔºü„Äã „ÄäÂàÜÂ∏ÉÂºèÊúçÂä°Êé•Âè£ÁöÑÂπÇÁ≠âÊÄßÂ¶Ç‰ΩïËÆæËÆ°ÔºàÊØîÂ¶Ç‰∏çËÉΩÈáçÂ§çÊâ£Ê¨æÔºâÔºü„Äã „Ää‰∏∫‰ªÄ‰πàË¶ÅËøõË°åÁ≥ªÁªüÊãÜÂàÜÔºüÂ¶Ç‰ΩïËøõË°åÁ≥ªÁªüÊãÜÂàÜÔºüÊãÜÂàÜÂêé‰∏çÁî® Dubbo ÂèØ‰ª•ÂêóÔºü„Äã „ÄäÂ¶Ç‰ΩïËá™Â∑±ËÆæËÆ°‰∏Ä‰∏™Á±ª‰ºº Dubbo ÁöÑ rpc Ê°ÜÊû∂Ôºü„Äã]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á≤æÂ∞Ω Dubbo Â≠¶‰π†ÊåáÂçó]]></title>
    <url>%2F2019%2F02%2F11%2F%E7%B2%BE%E5%B0%BD-Dubbo-%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[ËßÜÈ¢ë Â∞öÁ°ÖË∞∑ „ÄäÂ∞öÁ°ÖË∞∑ Java ËßÜÈ¢ëÊïôÁ®ã_Dubbo„Äã ‰∏ÄÂÖ±Êúâ 30P „ÄÇ Âä®ÂäõËäÇÁÇπ „ÄäJava ËßÜÈ¢ëÊïôÁ®ã‰πã Dubbo ËßÜÈ¢ëÊïôÁ®ã„Äã ‰π¶Á±çÊöÇÊó†‰π¶Á±ç TODO ËäãËâøÔºåÁ≠âÂæÖË∂ÖÂì•ÁöÑ‰π¶Âá∫Áâà ÊñáÁ´†ÈùûÂ∏∏ÈáçË¶ÅÔºå‰∏ÄÂÆö‰∏ÄÂÆö‰∏ÄÂÆöËÆ§ÁúüÁúãÂÆòÊñπÊñáÊ°£ „ÄäDubbo Áî®Êà∑ÊåáÂçó„Äã ÂøÖÈÄâ„ÄÇ „ÄäDubbo ÂºÄÂèëÊåáÂçó„Äã ËøõÈò∂„ÄÇ „ÄäDubbo ËøêÁª¥ÁÆ°ÁêÜ„Äã ÂèØÈÄâ„ÄÇ Âú®Êï¥ÁêÜ‰∏Ä‰∫õÔºådubbo ÂÆûÊàòÁöÑÊñáÁ´† ‰ΩøÁî® SkyWalking ‰Ωú‰∏∫ Dubbo ÁöÑÈìæË∑ØËøΩË∏™ÔºåÊòØÈùûÂ∏∏Êé®ËçêÁöÑÔºåÂÖ∑‰ΩìÂèØ‰ª•ÂèÇËÄÉÔºö Âº†Èë´ „Ää‰ΩøÁî® Apache Skywalking (Incubator) ÂÅöÂàÜÂ∏ÉÂºèË∑üË∏™„Äã Â¶ÇÊûú‰Ω†ÊÉ≥ÂèÇ‰∏éÂà∞ Dubbo ÁöÑÂºÄÂèë‰πã‰∏≠ÔºåÂ¶Ç‰∏ã‰∏§ÁØáÊñáÁ´†Áªô‰∫ÜÊàë‰ª¨Âæà‰∏çÈîôÁöÑÊåáÂºïÔºö ÂæêÂ¶à „Ää‰ª• Dubbo ‰∏∫‰æãÔºåËÅäËÅäÂ¶Ç‰ΩïÂêëÂºÄÊ∫êÈ°πÁõÆÂÅöË¥°ÁåÆ„Äã jerrick „ÄäÂ¶Ç‰ΩïÂèÇ‰∏éË¥°ÁåÆ Dubbo Á§æÂå∫„Äã Â¶ÇÊûú‰Ω†ÂØπ Dubbo ÊòØÊÄé‰πàÂÅö‰∏ÄÊ¨°ÁâàÊú¨ÁöÑÂèëÂ∏É Release ÔºåÂèØ‰ª•ÂèÇËßÅÔºö Jun Liu „ÄäÂ¶Ç‰ΩïÂáÜÂ§á Apache Release„Äã]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄêÊ≠ªÁ£ï Spring„Äë‚Äî‚Äî IoC ‰πã Spring Áªü‰∏ÄËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•]]></title>
    <url>%2F2019%2F02%2F11%2F%E3%80%90%E6%AD%BB%E7%A3%95-Spring%E3%80%91%E2%80%94%E2%80%94-IoC-%E4%B9%8B-Spring-%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E7%AD%96%E7%95%A5%2F</url>
    <content type="text"><![CDATA[Êú¨Êñá‰∏ªË¶ÅÂü∫‰∫é Spring 5.0.6.RELEASE ÊëòË¶Å: ÂéüÂàõÂá∫Â§Ñ http://cmsblogs.com/?p=2656 „ÄåÂ∞èÊòéÂì•„ÄçÔºåË∞¢Ë∞¢ÔºÅ ‰Ωú‰∏∫„ÄåÂ∞èÊòéÂì•„ÄçÁöÑÂø†ÂÆûËØªËÄÖÔºå„ÄåËÄÅËâøËâø„ÄçÁï•‰Ωú‰øÆÊîπÔºåËÆ∞ÂΩïÂú®ÁêÜËß£ËøáÁ®ã‰∏≠ÔºåÂèÇËÄÉÁöÑËµÑÊñô„ÄÇ Âú®Â≠¶ Java SE ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â≠¶‰π†‰∫Ü‰∏Ä‰∏™Ê†áÂáÜÁ±ª java.net.URLÔºåËØ•Á±ªÂú® Java SE ‰∏≠ÁöÑÂÆö‰Ωç‰∏∫Áªü‰∏ÄËµÑÊ∫êÂÆö‰ΩçÂô®ÔºàUniform Resource LocatorÔºâÔºå‰ΩÜÊòØÊàë‰ª¨Áü•ÈÅìÂÆÉÁöÑÂÆûÁé∞Âü∫Êú¨Âè™Èôê‰∫éÁΩëÁªúÂΩ¢ÂºèÂèëÂ∏ÉÁöÑËµÑÊ∫êÁöÑÊü•ÊâæÂíåÂÆö‰Ωç„ÄÇÁÑ∂ËÄåÔºåÂÆûÈôÖ‰∏äËµÑÊ∫êÁöÑÂÆö‰πâÊØîËæÉÂπøÊ≥õÔºåÈô§‰∫ÜÁΩëÁªúÂΩ¢ÂºèÁöÑËµÑÊ∫êÔºåËøòÊúâ‰ª•‰∫åËøõÂà∂ÂΩ¢ÂºèÂ≠òÂú®ÁöÑ„ÄÅ‰ª•Êñá‰ª∂ÂΩ¢ÂºèÂ≠òÂú®ÁöÑ„ÄÅ‰ª•Â≠óËäÇÊµÅÂΩ¢ÂºèÂ≠òÂú®ÁöÑÁ≠âÁ≠â„ÄÇËÄå‰∏îÂÆÉÂèØ‰ª•Â≠òÂú®‰∫é‰ªª‰ΩïÂú∫ÊâÄÔºåÊØîÂ¶ÇÁΩëÁªú„ÄÅÊñá‰ª∂Á≥ªÁªü„ÄÅÂ∫îÁî®Á®ãÂ∫è‰∏≠„ÄÇÊâÄ‰ª• java.net.URL ÁöÑÂ±ÄÈôêÊÄßËø´‰Ωø Spring ÂøÖÈ°ªÂÆûÁé∞Ëá™Â∑±ÁöÑËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•ÔºåËØ•ËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•ÈúÄË¶ÅÊª°Ë∂≥Â¶Ç‰∏ãË¶ÅÊ±ÇÔºö ËÅåËÉΩÂàíÂàÜÊ∏ÖÊ•ö„ÄÇËµÑÊ∫êÁöÑÂÆö‰πâÂíåËµÑÊ∫êÁöÑÂä†ËΩΩÂ∫îËØ•Ë¶ÅÊúâ‰∏Ä‰∏™Ê∏ÖÊô∞ÁöÑÁïåÈôêÔºõ Áªü‰∏ÄÁöÑÊäΩË±°„ÄÇÁªü‰∏ÄÁöÑËµÑÊ∫êÂÆö‰πâÂíåËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•„ÄÇËµÑÊ∫êÂä†ËΩΩÂêéË¶ÅËøîÂõûÁªü‰∏ÄÁöÑÊäΩË±°ÁªôÂÆ¢Êà∑Á´ØÔºåÂÆ¢Êà∑Á´ØË¶ÅÂØπËµÑÊ∫êËøõË°åÊÄéÊ†∑ÁöÑÂ§ÑÁêÜÔºåÂ∫îËØ•Áî±ÊäΩË±°ËµÑÊ∫êÊé•Âè£Êù•ÁïåÂÆö„ÄÇ 1. Áªü‰∏ÄËµÑÊ∫êÔºöResourceorg.springframework.core.io.Resource ‰∏∫ Spring Ê°ÜÊû∂ÊâÄÊúâËµÑÊ∫êÁöÑÊäΩË±°ÂíåËÆøÈóÆÊé•Âè£ÔºåÂÆÉÁªßÊâø org.springframework.core.io.InputStreamSourceÊé•Âè£„ÄÇ‰Ωú‰∏∫ÊâÄÊúâËµÑÊ∫êÁöÑÁªü‰∏ÄÊäΩË±°ÔºåResource ÂÆö‰πâ‰∫Ü‰∏Ä‰∫õÈÄöÁî®ÁöÑÊñπÊ≥ïÔºåÁî±Â≠êÁ±ª AbstractResource Êèê‰æõÁªü‰∏ÄÁöÑÈªòËÆ§ÂÆûÁé∞„ÄÇÂÆö‰πâÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677public interface Resource extends InputStreamSource &#123; /** * ËµÑÊ∫êÊòØÂê¶Â≠òÂú® */ boolean exists(); /** * ËµÑÊ∫êÊòØÂê¶ÂèØËØª */ default boolean isReadable() &#123; return true; &#125; /** * ËµÑÊ∫êÊâÄ‰ª£Ë°®ÁöÑÂè•ÊüÑÊòØÂê¶Ë¢´‰∏Ä‰∏™ stream ÊâìÂºÄ‰∫Ü */ default boolean isOpen() &#123; return false; &#125; /** * ÊòØÂê¶‰∏∫ File */ default boolean isFile() &#123; return false; &#125; /** * ËøîÂõûËµÑÊ∫êÁöÑ URL ÁöÑÂè•ÊüÑ */ URL getURL() throws IOException; /** * ËøîÂõûËµÑÊ∫êÁöÑ URI ÁöÑÂè•ÊüÑ */ URI getURI() throws IOException; /** * ËøîÂõûËµÑÊ∫êÁöÑ File ÁöÑÂè•ÊüÑ */ File getFile() throws IOException; /** * ËøîÂõû ReadableByteChannel */ default ReadableByteChannel readableChannel() throws IOException &#123; return java.nio.channels.Channels.newChannel(getInputStream()); &#125; /** * ËµÑÊ∫êÂÜÖÂÆπÁöÑÈïøÂ∫¶ */ long contentLength() throws IOException; /** * ËµÑÊ∫êÊúÄÂêéÁöÑ‰øÆÊîπÊó∂Èó¥ */ long lastModified() throws IOException; /** * Ê†πÊçÆËµÑÊ∫êÁöÑÁõ∏ÂØπË∑ØÂæÑÂàõÂª∫Êñ∞ËµÑÊ∫ê */ Resource createRelative(String relativePath) throws IOException; /** * ËµÑÊ∫êÁöÑÊñá‰ª∂Âêç */ @Nullable String getFilename(); /** * ËµÑÊ∫êÁöÑÊèèËø∞ */ String getDescription();&#125; 1.1 Â≠êÁ±ªÁªìÊûÑÁ±ªÁªìÊûÑÂõæÂ¶Ç‰∏ãÔºö ‰ªé‰∏äÂõæÂèØ‰ª•ÁúãÂà∞ÔºåResource Ê†πÊçÆËµÑÊ∫êÁöÑ‰∏çÂêåÁ±ªÂûãÊèê‰æõ‰∏çÂêåÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÔºåÂ¶Ç‰∏ãÔºö FileSystemResource ÔºöÂØπ java.io.File Á±ªÂûãËµÑÊ∫êÁöÑÂ∞ÅË£ÖÔºåÂè™Ë¶ÅÊòØË∑ü File Êâì‰∫§ÈÅìÁöÑÔºåÂü∫Êú¨‰∏ä‰∏é FileSystemResource ‰πüÂèØ‰ª•Êâì‰∫§ÈÅì„ÄÇÊîØÊåÅÊñá‰ª∂Âíå URL ÁöÑÂΩ¢ÂºèÔºåÂÆûÁé∞ WritableResource Êé•Âè£Ôºå‰∏î‰ªé Spring Framework 5.0 ÂºÄÂßãÔºåFileSystemResource ‰ΩøÁî® NIO2 APIËøõË°åËØª/ÂÜô‰∫§‰∫í„ÄÇ ByteArrayResource ÔºöÂØπÂ≠óËäÇÊï∞ÁªÑÊèê‰æõÁöÑÊï∞ÊçÆÁöÑÂ∞ÅË£Ö„ÄÇÂ¶ÇÊûúÈÄöËøá InputStream ÂΩ¢ÂºèËÆøÈóÆËØ•Á±ªÂûãÁöÑËµÑÊ∫êÔºåËØ•ÂÆûÁé∞‰ºöÊ†πÊçÆÂ≠óËäÇÊï∞ÁªÑÁöÑÊï∞ÊçÆÊûÑÈÄ†‰∏Ä‰∏™Áõ∏Â∫îÁöÑ ByteArrayInputStream„ÄÇ UrlResource ÔºöÂØπ java.net.URLÁ±ªÂûãËµÑÊ∫êÁöÑÂ∞ÅË£Ö„ÄÇÂÜÖÈÉ®ÂßîÊ¥æ URL ËøõË°åÂÖ∑‰ΩìÁöÑËµÑÊ∫êÊìç‰Ωú„ÄÇ ClassPathResource Ôºöclass path Á±ªÂûãËµÑÊ∫êÁöÑÂÆûÁé∞„ÄÇ‰ΩøÁî®ÁªôÂÆöÁöÑ ClassLoader ÊàñËÄÖÁªôÂÆöÁöÑ Class Êù•Âä†ËΩΩËµÑÊ∫ê„ÄÇ InputStreamResource ÔºöÂ∞ÜÁªôÂÆöÁöÑ InputStream ‰Ωú‰∏∫‰∏ÄÁßçËµÑÊ∫êÁöÑ Resource ÁöÑÂÆûÁé∞Á±ª„ÄÇ 1.2 AbstractResourceorg.springframework.core.io.AbstractResource Ôºå‰∏∫ Resource Êé•Âè£ÁöÑÈªòËÆ§ÊäΩË±°ÂÆûÁé∞„ÄÇÂÆÉÂÆûÁé∞‰∫Ü Resource Êé•Âè£ÁöÑÂ§ßÈÉ®ÂàÜÁöÑÂÖ¨ÂÖ±ÂÆûÁé∞Ôºå‰Ωú‰∏∫ Resource Êé•Âè£‰∏≠ÁöÑÈáç‰∏≠‰πãÈáçÔºåÂÖ∂ÂÆö‰πâÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164public abstract class AbstractResource implements Resource &#123; /** * Âà§Êñ≠Êñá‰ª∂ÊòØÂê¶Â≠òÂú®ÔºåËã•Âà§Êñ≠ËøáÁ®ã‰∫ßÁîüÂºÇÂ∏∏ÔºàÂõ†‰∏∫‰ºöË∞ÉÁî®SecurityManagerÊù•Âà§Êñ≠ÔºâÔºåÂ∞±ÂÖ≥Èó≠ÂØπÂ∫îÁöÑÊµÅ */ @Override public boolean exists() &#123; try &#123; // Âü∫‰∫é File ËøõË°åÂà§Êñ≠ return getFile().exists(); &#125; catch (IOException ex) &#123; // Fall back to stream existence: can we open the stream? // Âü∫‰∫é InputStream ËøõË°åÂà§Êñ≠ try &#123; InputStream is = getInputStream(); is.close(); return true; &#125; catch (Throwable isEx) &#123; return false; &#125; &#125; &#125; /** * Áõ¥Êé•ËøîÂõûtrueÔºåË°®Á§∫ÂèØËØª */ @Override public boolean isReadable() &#123; return true; &#125; /** * Áõ¥Êé•ËøîÂõû falseÔºåË°®Á§∫Êú™Ë¢´ÊâìÂºÄ */ @Override public boolean isOpen() &#123; return false; &#125; /** * Áõ¥Êé•ËøîÂõûfalseÔºåË°®Á§∫‰∏ç‰∏∫ File */ @Override public boolean isFile() &#123; return false; &#125; /** * ÊäõÂá∫ FileNotFoundException ÂºÇÂ∏∏Ôºå‰∫§ÁªôÂ≠êÁ±ªÂÆûÁé∞ */ @Override public URL getURL() throws IOException &#123; throw new FileNotFoundException(getDescription() + " cannot be resolved to URL"); &#125; /** * Âü∫‰∫é getURL() ËøîÂõûÁöÑ URL ÊûÑÂª∫ URI */ @Override public URI getURI() throws IOException &#123; URL url = getURL(); try &#123; return ResourceUtils.toURI(url); &#125; catch (URISyntaxException ex) &#123; throw new NestedIOException("Invalid URI [" + url + "]", ex); &#125; &#125; /** * ÊäõÂá∫ FileNotFoundException ÂºÇÂ∏∏Ôºå‰∫§ÁªôÂ≠êÁ±ªÂÆûÁé∞ */ @Override public File getFile() throws IOException &#123; throw new FileNotFoundException(getDescription() + " cannot be resolved to absolute file path"); &#125; /** * Ê†πÊçÆ getInputStream() ÁöÑËøîÂõûÁªìÊûúÊûÑÂª∫ ReadableByteChannel */ @Override public ReadableByteChannel readableChannel() throws IOException &#123; return Channels.newChannel(getInputStream()); &#125; /** * Ëé∑ÂèñËµÑÊ∫êÁöÑÈïøÂ∫¶ * * Ëøô‰∏™ËµÑÊ∫êÂÜÖÂÆπÈïøÂ∫¶ÂÆûÈôÖÂ∞±ÊòØËµÑÊ∫êÁöÑÂ≠óËäÇÈïøÂ∫¶ÔºåÈÄöËøáÂÖ®ÈÉ®ËØªÂèñ‰∏ÄÈÅçÊù•Âà§Êñ≠ */ @Override public long contentLength() throws IOException &#123; InputStream is = getInputStream(); try &#123; long size = 0; byte[] buf = new byte[255]; // ÊØèÊ¨°ÊúÄÂ§öËØªÂèñ 255 Â≠óËäÇ int read; while ((read = is.read(buf)) != -1) &#123; size += read; &#125; return size; &#125; finally &#123; try &#123; is.close(); &#125; catch (IOException ex) &#123; &#125; &#125; &#125; /** * ËøîÂõûËµÑÊ∫êÊúÄÂêéÁöÑ‰øÆÊîπÊó∂Èó¥ */ @Override public long lastModified() throws IOException &#123; long lastModified = getFileForLastModifiedCheck().lastModified(); if (lastModified == 0L) &#123; throw new FileNotFoundException(getDescription() + " cannot be resolved in the file system for resolving its last-modified timestamp"); &#125; return lastModified; &#125; protected File getFileForLastModifiedCheck() throws IOException &#123; return getFile(); &#125; /** * ÊäõÂá∫ FileNotFoundException ÂºÇÂ∏∏Ôºå‰∫§ÁªôÂ≠êÁ±ªÂÆûÁé∞ */ @Override public Resource createRelative(String relativePath) throws IOException &#123; throw new FileNotFoundException("Cannot create a relative resource for " + getDescription()); &#125; /** * Ëé∑ÂèñËµÑÊ∫êÂêçÁß∞ÔºåÈªòËÆ§ËøîÂõû null Ôºå‰∫§ÁªôÂ≠êÁ±ªÂÆûÁé∞ */ @Override @Nullable public String getFilename() &#123; return null; &#125; /** * ËøîÂõûËµÑÊ∫êÁöÑÊèèËø∞ */ @Override public String toString() &#123; return getDescription(); &#125; @Override public boolean equals(Object obj) &#123; return (obj == this || (obj instanceof Resource &amp;&amp; ((Resource) obj).getDescription().equals(getDescription()))); &#125; @Override public int hashCode() &#123; return getDescription().hashCode(); &#125;&#125; Â¶ÇÊûúÊàë‰ª¨ÊÉ≥Ë¶ÅÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑ Resource ÔºåËÆ∞‰Ωè‰∏çË¶ÅÂÆûÁé∞ Resource Êé•Âè£ÔºåËÄåÂ∫îËØ•ÁªßÊâø AbstractResource ÊäΩË±°Á±ªÔºåÁÑ∂ÂêéÊ†πÊçÆÂΩìÂâçÁöÑÂÖ∑‰ΩìËµÑÊ∫êÁâπÊÄßË¶ÜÁõñÁõ∏Â∫îÁöÑÊñπÊ≥ïÂç≥ÂèØ„ÄÇ 1.3 ÂÖ∂‰ªñÂ≠êÁ±ª Êù•Ëá™ËâøËâø Resource ÁöÑÂ≠êÁ±ªÔºå‰æãÂ¶Ç FileSystemResource„ÄÅByteArrayResource Á≠âÁ≠âÁöÑ‰ª£Á†ÅÈùûÂ∏∏ÁÆÄÂçï„ÄÇÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåËá™Â∑±ÂéªÁ†îÁ©∂„ÄÇ 2. Áªü‰∏ÄËµÑÊ∫êÂÆö‰ΩçÔºöResourceLoader‰∏ÄÂºÄÂßãÂ∞±ËØ¥‰∫Ü Spring Â∞ÜËµÑÊ∫êÁöÑÂÆö‰πâÂíåËµÑÊ∫êÁöÑÂä†ËΩΩÂå∫ÂàÜÂºÄ‰∫ÜÔºåResource ÂÆö‰πâ‰∫ÜÁªü‰∏ÄÁöÑËµÑÊ∫êÔºåÈÇ£ËµÑÊ∫êÁöÑÂä†ËΩΩÂàôÁî± ResourceLoader Êù•Áªü‰∏ÄÂÆö‰πâ„ÄÇ org.springframework.core.io.ResourceLoader ‰∏∫ Spring ËµÑÊ∫êÂä†ËΩΩÁöÑÁªü‰∏ÄÊäΩË±°ÔºåÂÖ∑‰ΩìÁöÑËµÑÊ∫êÂä†ËΩΩÂàôÁî±Áõ∏Â∫îÁöÑÂÆûÁé∞Á±ªÊù•ÂÆåÊàêÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Â∞Ü ResourceLoader Áß∞‰Ωú‰∏∫Áªü‰∏ÄËµÑÊ∫êÂÆö‰ΩçÂô®„ÄÇÂÖ∂ÂÆö‰πâÂ¶Ç‰∏ãÔºö FROM „ÄäSpring Ê∫êÁ†ÅÊ∑±Â∫¶Ëß£Êûê„ÄãP16 È°µ ResourceLoaderÔºåÂÆö‰πâËµÑÊ∫êÂä†ËΩΩÂô®Ôºå‰∏ªË¶ÅÂ∫îÁî®‰∫éÊ†πÊçÆÁªôÂÆöÁöÑËµÑÊ∫êÊñá‰ª∂Âú∞ÂùÄÔºåËøîÂõûÂØπÂ∫îÁöÑ Resource „ÄÇ 123456789public interface ResourceLoader &#123; String CLASSPATH_URL_PREFIX = ResourceUtils.CLASSPATH_URL_PREFIX; // CLASSPATH URL ÂâçÁºÄ„ÄÇÈªòËÆ§‰∏∫Ôºö"classpath:" Resource getResource(String location); ClassLoader getClassLoader();&#125; 1#getResource(String location) ÊñπÊ≥ïÔºåÊ†πÊçÆÊâÄÊèê‰æõËµÑÊ∫êÁöÑË∑ØÂæÑ location ËøîÂõû Resource ÂÆû‰æãÔºå‰ΩÜÊòØÂÆÉ‰∏çÁ°Æ‰øùËØ• Resource ‰∏ÄÂÆöÂ≠òÂú®ÔºåÈúÄË¶ÅË∞ÉÁî® 1Resource#exist() ÊñπÊ≥ïÊù•Âà§Êñ≠„ÄÇ ËØ•ÊñπÊ≥ïÊîØÊåÅ‰ª•‰∏ãÊ®°ÂºèÁöÑËµÑÊ∫êÂä†ËΩΩÔºö URL‰ΩçÁΩÆËµÑÊ∫êÔºåÂ¶Ç &quot;file:C:/test.dat&quot; „ÄÇ ClassPath‰ΩçÁΩÆËµÑÊ∫êÔºåÂ¶Ç &quot;classpath:test.dat „ÄÇ Áõ∏ÂØπË∑ØÂæÑËµÑÊ∫êÔºåÂ¶Ç &quot;WEB-INF/test.dat&quot; ÔºåÊ≠§Êó∂ËøîÂõûÁöÑResource ÂÆû‰æãÔºåÊ†πÊçÆÂÆûÁé∞‰∏çÂêåËÄå‰∏çÂêå„ÄÇ ËØ•ÊñπÊ≥ïÁöÑ‰∏ªË¶ÅÂÆûÁé∞ÊòØÂú®ÂÖ∂Â≠êÁ±ª DefaultResourceLoader ‰∏≠ÂÆûÁé∞ÔºåÂÖ∑‰ΩìËøáÁ®ãÊàë‰ª¨Âú®ÂàÜÊûê DefaultResourceLoader Êó∂ÂÅöËØ¶ÁªÜËØ¥Êòé„ÄÇ #getClassLoader() ÊñπÊ≥ïÔºåËøîÂõû ClassLoader ÂÆû‰æãÔºåÂØπ‰∫éÊÉ≥Ë¶ÅËé∑Âèñ ResourceLoader ‰ΩøÁî®ÁöÑ ClassLoader Áî®Êà∑Êù•ËØ¥ÔºåÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®ËØ•ÊñπÊ≥ïÊù•Ëé∑Âèñ„ÄÇÂú®ÂàÜÊûê Resource Êó∂ÔºåÊèêÂà∞‰∫Ü‰∏Ä‰∏™Á±ª ClassPathResource ÔºåËøô‰∏™Á±ªÊòØÂèØ‰ª•Ê†πÊçÆÊåáÂÆöÁöÑ ClassLoader Êù•Âä†ËΩΩËµÑÊ∫êÁöÑ„ÄÇ 2.1 Â≠êÁ±ªÁªìÊûÑ‰Ωú‰∏∫ Spring Áªü‰∏ÄÁöÑËµÑÊ∫êÂä†ËΩΩÂô®ÔºåÂÆÉÊèê‰æõ‰∫ÜÁªü‰∏ÄÁöÑÊäΩË±°ÔºåÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÂàôÁî±Áõ∏Â∫îÁöÑÂ≠êÁ±ªÊù•Ë¥üË¥£ÂÆûÁé∞ÔºåÂÖ∂Á±ªÁöÑÁ±ªÁªìÊûÑÂõæÂ¶Ç‰∏ãÔºö 2.1 DefaultResourceLoader‰∏é DefaultResource Áõ∏‰ººÔºåorg.springframework.core.io.DefaultResourceLoader ÊòØ ResourceLoader ÁöÑÈªòËÆ§ÂÆûÁé∞„ÄÇ 2.1.1 ÊûÑÈÄ†ÂáΩÊï∞ÂÆÉÊé•Êî∂ ClassLoader ‰Ωú‰∏∫ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÂèÇÊï∞ÔºåÊàñËÄÖ‰ΩøÁî®‰∏çÂ∏¶ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞„ÄÇ Âú®‰ΩøÁî®‰∏çÂ∏¶ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞Êó∂Ôºå‰ΩøÁî®ÁöÑ ClassLoader ‰∏∫ÈªòËÆ§ÁöÑ ClassLoaderÔºà‰∏ÄËà¨ Thread.currentThread()#getContextClassLoader() Ôºâ„ÄÇ Âú®‰ΩøÁî®Â∏¶ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞Êó∂ÔºåÂèØ‰ª•ÈÄöËøá ClassUtils#getDefaultClassLoader()Ëé∑Âèñ„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920@Nullableprivate ClassLoader classLoader;public DefaultResourceLoader() &#123; // Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ this.classLoader = ClassUtils.getDefaultClassLoader();&#125;public DefaultResourceLoader(@Nullable ClassLoader classLoader) &#123; // Â∏¶ ClassLoader ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ this.classLoader = classLoader;&#125;public void setClassLoader(@Nullable ClassLoader classLoader) &#123; this.classLoader = classLoader;&#125;@Override@Nullablepublic ClassLoader getClassLoader() &#123; return (this.classLoader != null ? this.classLoader : ClassUtils.getDefaultClassLoader());&#125; Âè¶Â§ñÔºå‰πüÂèØ‰ª•Ë∞ÉÁî® #setClassLoader() ÊñπÊ≥ïËøõË°åÂêéÁª≠ËÆæÁΩÆ„ÄÇ 2.1.2 getResource ÊñπÊ≥ïResourceLoader ‰∏≠ÊúÄÊ†∏ÂøÉÁöÑÊñπÊ≥ï‰∏∫ #getResource(String location) ÔºåÂÆÉÊ†πÊçÆÊèê‰æõÁöÑ location ËøîÂõûÁõ∏Â∫îÁöÑ Resource „ÄÇËÄå DefaultResourceLoader ÂØπËØ•ÊñπÊ≥ïÊèê‰æõ‰∫ÜÊ†∏ÂøÉÂÆûÁé∞ÔºàÂõ†‰∏∫ÔºåÂÆÉÁöÑ‰∏§‰∏™Â≠êÁ±ªÈÉΩÊ≤°ÊúâÊèê‰æõË¶ÜÁõñËØ•ÊñπÊ≥ïÔºåÊâÄ‰ª•ÂèØ‰ª•Êñ≠ÂÆö ResourceLoader ÁöÑËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•Â∞±Â∞ÅË£ÖÂú® DefaultResourceLoader ‰∏≠)Ôºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132// DefaultResourceLoader.java@Overridepublic Resource getResource(String location) &#123; Assert.notNull(location, "Location must not be null"); // È¶ñÂÖàÔºåÈÄöËøá ProtocolResolver Êù•Âä†ËΩΩËµÑÊ∫ê for (ProtocolResolver protocolResolver : this.protocolResolvers) &#123; Resource resource = protocolResolver.resolve(location, this); if (resource != null) &#123; return resource; &#125; &#125; // ÂÖ∂Ê¨°Ôºå‰ª• / ÂºÄÂ§¥ÔºåËøîÂõû ClassPathContextResource Á±ªÂûãÁöÑËµÑÊ∫ê if (location.startsWith("/")) &#123; return getResourceByPath(location); // ÂÜçÊ¨°Ôºå‰ª• classpath: ÂºÄÂ§¥ÔºåËøîÂõû ClassPathResource Á±ªÂûãÁöÑËµÑÊ∫ê &#125; else if (location.startsWith(CLASSPATH_URL_PREFIX)) &#123; return new ClassPathResource(location.substring(CLASSPATH_URL_PREFIX.length()), getClassLoader()); // ÁÑ∂ÂêéÔºåÊ†πÊçÆÊòØÂê¶‰∏∫Êñá‰ª∂ URL ÔºåÊòØÂàôËøîÂõû FileUrlResource Á±ªÂûãÁöÑËµÑÊ∫êÔºåÂê¶ÂàôËøîÂõû UrlResource Á±ªÂûãÁöÑËµÑÊ∫ê &#125; else &#123; try &#123; // Try to parse the location as a URL... URL url = new URL(location); return (ResourceUtils.isFileURL(url) ? new FileUrlResource(url) : new UrlResource(url)); &#125; catch (MalformedURLException ex) &#123; // ÊúÄÂêéÔºåËøîÂõû ClassPathContextResource Á±ªÂûãÁöÑËµÑÊ∫ê // No URL -&gt; resolve as resource path. return getResourceByPath(location); &#125; &#125;&#125; È¶ñÂÖàÔºåÈÄöËøá ProtocolResolver Êù•Âä†ËΩΩËµÑÊ∫êÔºåÊàêÂäüËøîÂõû Resource „ÄÇ ÂÖ∂Ê¨°ÔºåËã• location ‰ª• &quot;/&quot; ÂºÄÂ§¥ÔºåÂàôË∞ÉÁî® #getResourceByPath() ÊñπÊ≥ïÔºåÊûÑÈÄ† ClassPathContextResource Á±ªÂûãËµÑÊ∫êÂπ∂ËøîÂõû„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123protected Resource getResourceByPath(String path) &#123; return new ClassPathContextResource(path, getClassLoader());&#125; ÂÜçÊ¨°ÔºåËã• location ‰ª• &quot;classpath:&quot; ÂºÄÂ§¥ÔºåÂàôÊûÑÈÄ† ClassPathResource Á±ªÂûãËµÑÊ∫êÂπ∂ËøîÂõû„ÄÇÂú®ÊûÑÈÄ†ËØ•ËµÑÊ∫êÊó∂ÔºåÈÄöËøá #getClassLoader() Ëé∑ÂèñÂΩìÂâçÁöÑ ClassLoader„ÄÇ ÁÑ∂ÂêéÔºåÊûÑÈÄ† URL ÔºåÂ∞ùËØïÈÄöËøáÂÆÉËøõË°åËµÑÊ∫êÂÆö‰ΩçÔºåËã•Ê≤°ÊúâÊäõÂá∫ MalformedURLException ÂºÇÂ∏∏ÔºåÂàôÂà§Êñ≠ÊòØÂê¶‰∏∫ FileURL , Â¶ÇÊûúÊòØÂàôÊûÑÈÄ† FileUrlResource Á±ªÂûãÁöÑËµÑÊ∫êÔºåÂê¶ÂàôÊûÑÈÄ† UrlResource Á±ªÂûãÁöÑËµÑÊ∫ê„ÄÇ ÊúÄÂêéÔºåËã•Âú®Âä†ËΩΩËøáÁ®ã‰∏≠ÊäõÂá∫ MalformedURLException ÂºÇÂ∏∏ÔºåÂàôÂßîÊ¥æ #getResourceByPath() ÊñπÊ≥ïÔºåÂÆûÁé∞ËµÑÊ∫êÂÆö‰ΩçÂä†ËΩΩ„ÄÇüòà ÂÆûÈôÖ‰∏äÔºåÂíå„ÄêÂÖ∂Ê¨°„ÄëÁõ∏ÂêåËêΩ„ÄÇ 2.1.3 ProtocolResolverorg.springframework.core.io.ProtocolResolver ÔºåÁî®Êà∑Ëá™ÂÆö‰πâÂçèËÆÆËµÑÊ∫êËß£ÂÜ≥Á≠ñÁï•Ôºå‰Ωú‰∏∫ DefaultResourceLoader ÁöÑ SPIÔºöÂÆÉÂÖÅËÆ∏Áî®Êà∑Ëá™ÂÆö‰πâËµÑÊ∫êÂä†ËΩΩÂçèËÆÆÔºåËÄå‰∏çÈúÄË¶ÅÁªßÊâø ResourceLoader ÁöÑÂ≠êÁ±ª„ÄÇÂú®‰ªãÁªç Resource Êó∂ÔºåÊèêÂà∞Â¶ÇÊûúË¶ÅÂÆûÁé∞Ëá™ÂÆö‰πâ ResourceÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÁªßÊâø DefaultResource Âç≥ÂèØÔºå‰ΩÜÊòØÊúâ‰∫Ü ProtocolResolver ÂêéÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÁõ¥Êé•ÁªßÊâø DefaultResourceLoaderÔºåÊîπ‰∏∫ÂÆûÁé∞ ProtocolResolver Êé•Âè£‰πüÂèØ‰ª•ÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑ ResourceLoader„ÄÇ ProtocolResolver Êé•Âè£Ôºå‰ªÖÊúâ‰∏Ä‰∏™ÊñπÊ≥ï Resource resolve(String location, ResourceLoader resourceLoader) „ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213/** * ‰ΩøÁî®ÊåáÂÆöÁöÑ ResourceLoader ÔºåËß£ÊûêÊåáÂÆöÁöÑ location „ÄÇ * Ëã•ÊàêÂäüÔºåÂàôËøîÂõûÂØπÂ∫îÁöÑ Resource „ÄÇ * * Resolve the given location against the given resource loader * if this implementation's protocol matches. * @param location the user-specified resource location ËµÑÊ∫êË∑ØÂæÑ * @param resourceLoader the associated resource loader ÊåáÂÆöÁöÑÂä†ËΩΩÂô® ResourceLoader * @return a corresponding &#123;@code Resource&#125; handle if the given location * matches this resolver's protocol, or &#123;@code null&#125; otherwise ËøîÂõû‰∏∫Áõ∏Â∫îÁöÑ Resource */@NullableResource resolve(String location, ResourceLoader resourceLoader); Âú® Spring ‰∏≠‰Ω†‰ºöÂèëÁé∞ËØ•Êé•Âè£Âπ∂Ê≤°ÊúâÂÆûÁé∞Á±ªÔºåÂÆÉÈúÄË¶ÅÁî®Êà∑Ëá™ÂÆö‰πâÔºåËá™ÂÆö‰πâÁöÑ Resolver Â¶Ç‰ΩïÂä†ÂÖ• Spring ‰ΩìÁ≥ªÂë¢ÔºüË∞ÉÁî® DefaultResourceLoader#addProtocolResolver(ProtocolResolver) ÊñπÊ≥ïÂç≥ÂèØ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789/** * ProtocolResolver ÈõÜÂêà */private final Set&lt;ProtocolResolver&gt; protocolResolvers = new LinkedHashSet&lt;&gt;(4);public void addProtocolResolver(ProtocolResolver resolver) &#123; Assert.notNull(resolver, "ProtocolResolver must not be null"); this.protocolResolvers.add(resolver);&#125; 2.1.4 Á§∫‰æã‰∏ãÈù¢Á§∫‰æãÊòØÊºîÁ§∫ DefaultResourceLoader Âä†ËΩΩËµÑÊ∫êÁöÑÂÖ∑‰ΩìÁ≠ñÁï•Ôºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºàËØ•Á§∫‰æãÂèÇËÄÉ„ÄäSpring Êè≠Áßò„Äã P89ÔºâÔºö 12345678910111213ResourceLoader resourceLoader = new DefaultResourceLoader();Resource fileResource1 = resourceLoader.getResource("D:/Users/chenming673/Documents/spark.txt");System.out.println("fileResource1 is FileSystemResource:" + (fileResource1 instanceof FileSystemResource));Resource fileResource2 = resourceLoader.getResource("/Users/chenming673/Documents/spark.txt");System.out.println("fileResource2 is ClassPathResource:" + (fileResource2 instanceof ClassPathResource));Resource urlResource1 = resourceLoader.getResource("file:/Users/chenming673/Documents/spark.txt");System.out.println("urlResource1 is UrlResource:" + (urlResource1 instanceof UrlResource));Resource urlResource2 = resourceLoader.getResource("http://www.baidu.com");System.out.println("urlResource1 is urlResource:" + (urlResource2 instanceof UrlResource)); ËøêË°åÁªìÊûúÔºö 1234fileResource1 is FileSystemResource:falsefileResource2 is ClassPathResource:trueurlResource1 is UrlResource:trueurlResource1 is urlResource:true ÂÖ∂ÂÆûÂØπ‰∫é fileResource1 ÔºåÊàë‰ª¨Êõ¥Âä†Â∏åÊúõÊòØ FileSystemResource ËµÑÊ∫êÁ±ªÂûã„ÄÇ‰ΩÜÊòØÔºå‰∫ã‰∏éÊÑøËøùÔºåÂÆÉÊòØ ClassPathResource Á±ªÂûã„ÄÇ‰∏∫‰ªÄ‰πàÂë¢ÔºüÂú® DefaultResourceLoader#getResource() ÊñπÊ≥ïÁöÑËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•‰∏≠ÔºåÊàë‰ª¨Áü•ÈÅì &quot;D:/Users/chenming673/Documents/spark.txt&quot; Âú∞ÂùÄÔºåÂÖ∂ÂÆûÂú®ËØ•ÊñπÊ≥ï‰∏≠Ê≤°ÊúâÁõ∏Â∫îÁöÑËµÑÊ∫êÁ±ªÂûãÔºåÈÇ£‰πàÂÆÉÂ∞±‰ºöÂú®ÊäõÂá∫ MalformedURLException ÂºÇÂ∏∏Êó∂ÔºåÈÄöËøá DefaultResourceLoader#getResourceByPath(...) ÊñπÊ≥ïÔºåÊûÑÈÄ†‰∏Ä‰∏™ ClassPathResource Á±ªÂûãÁöÑËµÑÊ∫ê„ÄÇ ËÄå urlResource1 Âíå urlResource2 ÔºåÊåáÂÆöÊúâÂçèËÆÆÂâçÁºÄÁöÑËµÑÊ∫êË∑ØÂæÑÔºåÂàôÈÄöËøá URL Â∞±ÂèØ‰ª•ÂÆö‰πâÔºåÊâÄ‰ª•ËøîÂõûÁöÑÈÉΩÊòØ UrlResource Á±ªÂûã„ÄÇ 2.2 FileSystemResourceLoader‰ªé‰∏äÈù¢ÁöÑÁ§∫‰æãÔºåÊàë‰ª¨ÁúãÂà∞ÔºåÂÖ∂ÂÆû DefaultResourceLoader ÂØπ#getResourceByPath(String) ÊñπÊ≥ïÂ§ÑÁêÜÂÖ∂ÂÆû‰∏çÊòØÂæàÊÅ∞ÂΩìÔºåËøô‰∏™Êó∂ÂÄôÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® org.springframework.core.io.FileSystemResourceLoader „ÄÇÂÆÉÁªßÊâø DefaultResourceLoader Ôºå‰∏îË¶ÜÂÜô‰∫Ü #getResourceByPath(String) ÊñπÊ≥ïÔºå‰Ωø‰πã‰ªéÊñá‰ª∂Á≥ªÁªüÂä†ËΩΩËµÑÊ∫êÂπ∂‰ª• FileSystemResource Á±ªÂûãËøîÂõûÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÂæóÂà∞ÊÉ≥Ë¶ÅÁöÑËµÑÊ∫êÁ±ªÂûã„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789@Overrideprotected Resource getResourceByPath(String path) &#123; // Êà™ÂèñÈ¶ñ / if (path.startsWith("/")) &#123; path = path.substring(1); &#125; // ÂàõÂª∫ FileSystemContextResource Á±ªÂûãÁöÑËµÑÊ∫ê return new FileSystemContextResource(path);&#125; 2.2.1 FileSystemContextResourceFileSystemContextResource Ôºå‰∏∫ FileSystemResourceLoader ÁöÑÂÜÖÈÉ®Á±ªÔºåÂÆÉÁªßÊâø FileSystemResource Á±ªÔºåÂÆûÁé∞ ContextResource Êé•Âè£„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415/** * FileSystemResource that explicitly expresses a context-relative path * through implementing the ContextResource interface. */private static class FileSystemContextResource extends FileSystemResource implements ContextResource &#123; public FileSystemContextResource(String path) &#123; super(path); &#125; @Override public String getPathWithinContext() &#123; return getPath(); &#125;&#125; Âú®ÊûÑÈÄ†Âô®‰∏≠Ôºå‰πüÊòØË∞ÉÁî® FileSystemResource ÁöÑÊûÑÈÄ†ÂáΩÊï∞Êù•ÊûÑÈÄ† FileSystemResource ÁöÑ„ÄÇ ‰∏∫‰ªÄ‰πàË¶ÅÊúâ FileSystemContextResource Á±ªÁöÑÂéüÂõ†ÊòØÔºåÂÆûÁé∞ ContextResource Êé•Âè£ÔºåÂπ∂ÂÆûÁé∞ÂØπÂ∫îÁöÑ #getPathWithinContext() Êé•Âè£ÊñπÊ≥ï„ÄÇ 2.2.2 Á§∫‰æãüòà Âú®ÂõûËøáÂ§¥Áúã „Äå2.1.4 Á§∫‰æã„Äç ÔºåÂ¶ÇÊûúÂ∞Ü DefaultResourceLoader Êîπ‰∏∫ FileSystemContextResource ÔºåÂàô fileResource1Âàô‰∏∫ FileSystemResource Á±ªÂûãÁöÑËµÑÊ∫ê„ÄÇ 2.3 ClassRelativeResourceLoaderorg.springframework.core.io.ClassRelativeResourceLoader ÔºåÊòØ DefaultResourceLoader ÁöÑÂè¶‰∏Ä‰∏™Â≠êÁ±ªÁöÑÂÆûÁé∞„ÄÇÂíå FileSystemResourceLoader Á±ª‰ººÔºåÂú®ÂÆûÁé∞‰ª£Á†ÅÁöÑÁªìÊûÑ‰∏äÁ±ª‰ººÔºå‰πüÊòØË¶ÜÂÜô #getResourceByPath(String path) ÊñπÊ≥ïÔºåÂπ∂ËøîÂõûÂÖ∂ÂØπÂ∫îÁöÑ ClassRelativeContextResource ÁöÑËµÑÊ∫êÁ±ªÂûã„ÄÇ ÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÂèØ‰ª•ÁúãÁúã „ÄäSpring5ÔºöÂ∞±Ëøô‰∏ÄÊ¨°ÔºåÊêûÂÆöËµÑÊ∫êÂä†ËΩΩÂô®‰πãClassRelativeResourceLoader„Äã ÊñáÁ´†„ÄÇ ClassRelativeResourceLoader Êâ©Â±ïÁöÑÂäüËÉΩÊòØÔºåÂèØ‰ª•Ê†πÊçÆÁªôÂÆöÁöÑclass ÊâÄÂú®ÂåÖÊàñËÄÖÊâÄÂú®ÂåÖÁöÑÂ≠êÂåÖ‰∏ãÂä†ËΩΩËµÑÊ∫ê„ÄÇ 2.4 ResourcePatternResolverResourceLoader ÁöÑ Resource getResource(String location) ÊñπÊ≥ïÔºåÊØèÊ¨°Âè™ËÉΩÊ†πÊçÆ location ËøîÂõû‰∏Ä‰∏™ Resource „ÄÇÂΩìÈúÄË¶ÅÂä†ËΩΩÂ§ö‰∏™ËµÑÊ∫êÊó∂ÔºåÊàë‰ª¨Èô§‰∫ÜÂ§öÊ¨°Ë∞ÉÁî® #getResource(String location) ÊñπÊ≥ïÂ§ñÔºåÂà´Êó†‰ªñÊ≥ï„ÄÇorg.springframework.core.io.support.ResourcePatternResolver ÊòØ ResourceLoader ÁöÑÊâ©Â±ïÔºåÂÆÉÊîØÊåÅÊ†πÊçÆÊåáÂÆöÁöÑËµÑÊ∫êË∑ØÂæÑÂåπÈÖçÊ®°ÂºèÊØèÊ¨°ËøîÂõûÂ§ö‰∏™ Resource ÂÆû‰æãÔºåÂÖ∂ÂÆö‰πâÂ¶Ç‰∏ãÔºö 1234567public interface ResourcePatternResolver extends ResourceLoader &#123; String CLASSPATH_ALL_URL_PREFIX = "classpath*:"; Resource[] getResources(String locationPattern) throws IOException;&#125; ResourcePatternResolver Âú® ResourceLoader ÁöÑÂü∫Á°Ä‰∏äÂ¢ûÂä†‰∫Ü #getResources(String locationPattern) ÊñπÊ≥ïÔºå‰ª•ÊîØÊåÅÊ†πÊçÆË∑ØÂæÑÂåπÈÖçÊ®°ÂºèËøîÂõûÂ§ö‰∏™ Resource ÂÆû‰æã„ÄÇ ÂêåÊó∂Ôºå‰πüÊñ∞Â¢û‰∫Ü‰∏ÄÁßçÊñ∞ÁöÑÂçèËÆÆÂâçÁºÄ &quot;classpath*:&quot;ÔºåËØ•ÂçèËÆÆÂâçÁºÄÁî±ÂÖ∂Â≠êÁ±ªË¥üË¥£ÂÆûÁé∞„ÄÇ 2.5 PathMatchingResourcePatternResolverorg.springframework.core.io.support.PathMatchingResourcePatternResolver Ôºå‰∏∫ ResourcePatternResolver ÊúÄÂ∏∏Áî®ÁöÑÂ≠êÁ±ªÔºåÂÆÉÈô§‰∫ÜÊîØÊåÅ ResourceLoader Âíå ResourcePatternResolver Êñ∞Â¢ûÁöÑ &quot;classpath*:&quot; ÂâçÁºÄÂ§ñÔºåËøòÊîØÊåÅ Ant È£éÊ†ºÁöÑË∑ØÂæÑÂåπÈÖçÊ®°ÂºèÔºàÁ±ª‰ºº‰∫é &quot;**/*.xml&quot;Ôºâ„ÄÇ 2.5.1 ÊûÑÈÄ†ÂáΩÊï∞PathMatchingResourcePatternResolver Êèê‰æõ‰∫Ü‰∏â‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021/** * ÂÜÖÁΩÆÁöÑ ResourceLoader ËµÑÊ∫êÂÆö‰ΩçÂô® */private final ResourceLoader resourceLoader;/** * Ant Ë∑ØÂæÑÂåπÈÖçÂô® */private PathMatcher pathMatcher = new AntPathMatcher();public PathMatchingResourcePatternResolver() &#123; this.resourceLoader = new DefaultResourceLoader();&#125;public PathMatchingResourcePatternResolver(ResourceLoader resourceLoader) &#123; Assert.notNull(resourceLoader, "ResourceLoader must not be null"); this.resourceLoader = resourceLoader;&#125;public PathMatchingResourcePatternResolver(@Nullable ClassLoader classLoader) &#123; this.resourceLoader = new DefaultResourceLoader(classLoader);&#125; PathMatchingResourcePatternResolver Âú®ÂÆû‰æãÂåñÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÊåáÂÆö‰∏Ä‰∏™ ResourceLoaderÔºåÂ¶ÇÊûú‰∏çÊåáÂÆöÁöÑËØùÔºåÂÆÉ‰ºöÂú®ÂÜÖÈÉ®ÊûÑÈÄ†‰∏Ä‰∏™ DefaultResourceLoader „ÄÇ pathMatcher Â±ûÊÄßÔºåÈªòËÆ§‰∏∫ AntPathMatcher ÂØπË±°ÔºåÁî®‰∫éÊîØÊåÅ Ant Á±ªÂûãÁöÑË∑ØÂæÑÂåπÈÖç„ÄÇ 2.5.2 getResource12345678@Overridepublic Resource getResource(String location) &#123; return getResourceLoader().getResource(location);&#125;public ResourceLoader getResourceLoader() &#123; return this.resourceLoader;&#125; ËØ•ÊñπÊ≥ïÔºåÁõ¥Êé•ÂßîÊâòÁªôÁõ∏Â∫îÁöÑ ResourceLoader Êù•ÂÆûÁé∞„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®ÂÆû‰æãÂåñÁöÑ PathMatchingResourcePatternResolver ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÊú™ÊåáÂÆö ResourceLoader ÂèÇÊï∞ÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÇ£‰πàÂú®Âä†ËΩΩËµÑÊ∫êÊó∂ÔºåÂÖ∂ÂÆûÂ∞±ÊòØ DefaultResourceLoader ÁöÑËøáÁ®ã„ÄÇ ÂÖ∂ÂÆûÂú®‰∏ãÈù¢‰ªãÁªçÁöÑ Resource[] getResources(String locationPattern) ÊñπÊ≥ï‰πüÁõ∏ÂêåÔºåÂè™‰∏çËøáËøîÂõûÁöÑËµÑÊ∫êÊòØÂ§ö‰∏™ËÄåÂ∑≤„ÄÇ 2.5.3 getResources1234567891011121314151617181920212223242526272829303132@Overridepublic Resource[] getResources(String locationPattern) throws IOException &#123; Assert.notNull(locationPattern, "Location pattern must not be null"); // ‰ª• "classpath*:" ÂºÄÂ§¥ if (locationPattern.startsWith(CLASSPATH_ALL_URL_PREFIX)) &#123; // Ë∑ØÂæÑÂåÖÂê´ÈÄöÈÖçÁ¨¶ // a class path resource (multiple resources for same name possible) if (getPathMatcher().isPattern(locationPattern.substring(CLASSPATH_ALL_URL_PREFIX.length()))) &#123; // a class path resource pattern return findPathMatchingResources(locationPattern); // Ë∑ØÂæÑ‰∏çÂåÖÂê´ÈÄöÈÖçÁ¨¶ &#125; else &#123; // all class path resources with the given name return findAllClassPathResources(locationPattern.substring(CLASSPATH_ALL_URL_PREFIX.length())); &#125; // ‰∏ç‰ª• "classpath*:" ÂºÄÂ§¥ &#125; else &#123; // Generally only look for a pattern after a prefix here, // ÈÄöÂ∏∏Âè™Âú®ËøôÈáåÁöÑÂâçÁºÄÂêéÈù¢Êü•ÊâæÊ®°Âºè // and on Tomcat only after the "*/" separator for its "war:" protocol. ËÄåÂú® Tomcat ‰∏äÂè™ÊúâÂú® ‚Äú*/ ‚ÄùÂàÜÈöîÁ¨¶‰πãÂêéÊâç‰∏∫ÂÖ∂ ‚Äúwar:‚Äù ÂçèËÆÆ int prefixEnd = (locationPattern.startsWith("war:") ? locationPattern.indexOf("*/") + 1 : locationPattern.indexOf(':') + 1); // Ë∑ØÂæÑÂåÖÂê´ÈÄöÈÖçÁ¨¶ if (getPathMatcher().isPattern(locationPattern.substring(prefixEnd))) &#123; // a file pattern return findPathMatchingResources(locationPattern); // Ë∑ØÂæÑ‰∏çÂåÖÂê´ÈÄöÈÖçÁ¨¶ &#125; else &#123; // a single resource with the given name return new Resource[] &#123;getResourceLoader().getResource(locationPattern)&#125;; &#125; &#125;&#125; Â§ÑÁêÜÈÄªËæëÂ¶Ç‰∏ãÂõæÔºö Èùû &quot;classpath*:&quot; ÂºÄÂ§¥Ôºå‰∏îË∑ØÂæÑ‰∏çÂåÖÂê´ÈÄöÈÖçÁ¨¶ÔºåÁõ¥Êé•ÂßîÊâòÁªôÁõ∏Â∫îÁöÑ ResourceLoader Êù•ÂÆûÁé∞„ÄÇ ÂÖ∂‰ªñÊÉÖÂÜµÔºåË∞ÉÁî® #findAllClassPathResources(...)„ÄÅÊàñ #findPathMatchingResources(...) ÊñπÊ≥ïÔºåËøîÂõûÂ§ö‰∏™ Resource „ÄÇ‰∏ãÈù¢ÔºåÊàë‰ª¨Êù•ËØ¶ÁªÜÂàÜÊûê„ÄÇ 2.5.4 findAllClassPathResourcesÂΩì locationPattern ‰ª• &quot;classpath*:&quot; ÂºÄÂ§¥‰ΩÜÊòØ‰∏çÂåÖÂê´ÈÄöÈÖçÁ¨¶ÔºåÂàôË∞ÉÁî® #findAllClassPathResources(...) ÊñπÊ≥ïÂä†ËΩΩËµÑÊ∫ê„ÄÇËØ•ÊñπÊ≥ïËøîÂõû classes Ë∑ØÂæÑ‰∏ãÂíåÊâÄÊúâ jar ÂåÖ‰∏≠ÁöÑÊâÄÊúâÁõ∏ÂåπÈÖçÁöÑËµÑÊ∫ê„ÄÇ 1234567891011121314protected Resource[] findAllClassPathResources(String location) throws IOException &#123; String path = location; // ÂéªÈô§È¶ñ‰∏™ / if (path.startsWith("/")) &#123; path = path.substring(1); &#125; // ÁúüÊ≠£ÊâßË°åÂä†ËΩΩÊâÄÊúâ classpath ËµÑÊ∫ê Set&lt;Resource&gt; result = doFindAllClassPathResources(path); if (logger.isTraceEnabled()) &#123; logger.trace("Resolved classpath location [" + location + "] to resources " + result); &#125; // ËΩ¨Êç¢Êàê Resource Êï∞ÁªÑËøîÂõû return result.toArray(new Resource[0]);&#125; ÁúüÊ≠£ÊâßË°åÂä†ËΩΩÁöÑÊòØÂú® #doFindAllClassPathResources(...) ÊñπÊ≥ïÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819protected Set&lt;Resource&gt; doFindAllClassPathResources(String path) throws IOException &#123; Set&lt;Resource&gt; result = new LinkedHashSet&lt;&gt;(16); ClassLoader cl = getClassLoader(); // &lt;1&gt; Ê†πÊçÆ ClassLoader Âä†ËΩΩË∑ØÂæÑ‰∏ãÁöÑÊâÄÊúâËµÑÊ∫ê Enumeration&lt;URL&gt; resourceUrls = (cl != null ? cl.getResources(path) : ClassLoader.getSystemResources(path)); // &lt;2&gt; while (resourceUrls.hasMoreElements()) &#123; URL url = resourceUrls.nextElement(); // Â∞Ü URL ËΩ¨Êç¢Êàê UrlResource result.add(convertClassLoaderURL(url)); &#125; // &lt;3&gt; Âä†ËΩΩË∑ØÂæÑ‰∏ãÂæóÊâÄÊúâ jar ÂåÖ if ("".equals(path)) &#123; // The above result is likely to be incomplete, i.e. only containing file system references. // We need to have pointers to each of the jar files on the classpath as well... addAllClassLoaderJarRoots(cl, result); &#125; return result;&#125; &lt;1&gt; Â§ÑÔºåÊ†πÊçÆ ClassLoader Âä†ËΩΩË∑ØÂæÑ‰∏ãÁöÑÊâÄÊúâËµÑÊ∫ê„ÄÇÂú®Âä†ËΩΩËµÑÊ∫êËøáÁ®ãÊó∂ÔºåÂ¶ÇÊûúÂú®ÊûÑÈÄ† PathMatchingResourcePatternResolver ÂÆû‰æãÁöÑÊó∂ÂÄôÂ¶ÇÊûú‰º†ÂÖ•‰∫Ü ClassLoaderÔºåÂàôË∞ÉÁî®ËØ• ClassLoader ÁöÑ #getResources() ÊñπÊ≥ïÔºåÂê¶ÂàôË∞ÉÁî® ClassLoader#getSystemResources(path)ÊñπÊ≥ï„ÄÇÂè¶Â§ñÔºåClassLoader#getResources() ÊñπÊ≥ïÔºå‰ª£Á†ÅÂ¶Ç‰∏ã: 12345678910111213// java.lang.ClassLoader.javapublic Enumeration&lt;URL&gt; getResources(String name) throws IOException &#123; @SuppressWarnings("unchecked") Enumeration&lt;URL&gt;[] tmp = (Enumeration&lt;URL&gt;[]) new Enumeration&lt;?&gt;[2]; if (parent != null) &#123; tmp[0] = parent.getResources(name); &#125; else &#123; tmp[0] = getBootstrapResources(name); &#125; tmp[1] = findResources(name); return new CompoundEnumeration&lt;&gt;(tmp);&#125; ÁúãÂà∞ËøôÈáåÊòØ‰∏çÊòØÂ∞±Â∑≤Áªè‰∏ÄÁõÆ‰∫ÜÁÑ∂‰∫ÜÔºüÂ¶ÇÊûúÂΩìÂâçÁà∂Á±ªÂä†ËΩΩÂô®‰∏ç‰∏∫ null ÔºåÂàôÈÄöËøáÁà∂Á±ªÂêë‰∏äËø≠‰ª£Ëé∑ÂèñËµÑÊ∫êÔºåÂê¶ÂàôË∞ÉÁî® #getBootstrapResources() „ÄÇËøôÈáåÊòØ‰∏çÊòØÁâπÂà´ÁÜüÊÇâÔºå(^‚ñΩ^)„ÄÇ &lt;2&gt; Â§ÑÔºåÈÅçÂéÜ URL ÈõÜÂêàÔºåË∞ÉÁî® #convertClassLoaderURL(URL url) ÊñπÊ≥ïÔºåÂ∞Ü URL ËΩ¨Êç¢Êàê UrlResource ÂØπË±°„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123protected Resource convertClassLoaderURL(URL url) &#123; return new UrlResource(url);&#125; &lt;3&gt; Â§ÑÔºåËã• path ‰∏∫Á©∫Ôºà‚Äú‚ÄùÔºâÊó∂ÔºåÂàôË∞ÉÁî® #addAllClassLoaderJarRoots(...)ÊñπÊ≥ï„ÄÇËØ•ÊñπÊ≥ï‰∏ªË¶ÅÊòØÂä†ËΩΩË∑ØÂæÑ‰∏ãÂæóÊâÄÊúâ jar ÂåÖÔºåÊñπÊ≥ïËæÉÈïø‰πüÊ≤°Êúâ‰ªÄ‰πàÂÆûÈôÖÊÑè‰πâÂ∞±‰∏çË¥¥Âá∫Êù•‰∫Ü„ÄÇÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåËá™Â∑±ÂèØ‰ª•ÂéªÁúãÁúã„ÄÇüòà ÂΩìÁÑ∂ÔºåÂèØËÉΩ‰ª£Á†Å‰πüÊØîËæÉÈïøÂìà„ÄÇ ÈÄöËøá‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÊàë‰ª¨Áü•ÈÅì #findAllClassPathResources(...) ÊñπÊ≥ïÔºåÂÖ∂ÂÆûÂ∞±ÊòØÂà©Áî® ClassLoader Êù•Âä†ËΩΩÊåáÂÆöË∑ØÂæÑ‰∏ãÁöÑËµÑÊ∫êÔºå‰∏çËÆ∫ÂÆÉÊòØÂú® class Ë∑ØÂæÑ‰∏ãËøòÊòØÂú® jar ÂåÖ‰∏≠„ÄÇÂ¶ÇÊûúÊàë‰ª¨‰º†ÂÖ•ÁöÑË∑ØÂæÑ‰∏∫Á©∫ÊàñËÄÖ /ÔºåÂàô‰ºöË∞ÉÁî® #addAllClassLoaderJarRoots(...) ÊñπÊ≥ïÔºåÂä†ËΩΩÊâÄÊúâÁöÑ jar ÂåÖ„ÄÇ 2.5.5 findPathMatchingResourcesÂΩì locationPattern ‰∏≠ÂåÖÂê´‰∫ÜÈÄöÈÖçÁ¨¶ÔºåÂàôË∞ÉÁî®ËØ•ÊñπÊ≥ïËøõË°åËµÑÊ∫êÂä†ËΩΩ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536protected Resource[] findPathMatchingResources(String locationPattern) throws IOException &#123; // Á°ÆÂÆöÊ†πË∑ØÂæÑ„ÄÅÂ≠êË∑ØÂæÑ String rootDirPath = determineRootDir(locationPattern); String subPattern = locationPattern.substring(rootDirPath.length()); // Ëé∑ÂèñÊ†πÊçÆË∑ØÂæÑ‰∏ãÁöÑËµÑÊ∫ê Resource[] rootDirResources = getResources(rootDirPath); // ÈÅçÂéÜÔºåËø≠‰ª£ Set&lt;Resource&gt; result = new LinkedHashSet&lt;&gt;(16); for (Resource rootDirResource : rootDirResources) &#123; rootDirResource = resolveRootDirResource(rootDirResource); URL rootDirUrl = rootDirResource.getURL(); // bundle ËµÑÊ∫êÁ±ªÂûã if (equinoxResolveMethod != null &amp;&amp; rootDirUrl.getProtocol().startsWith("bundle")) &#123; URL resolvedUrl = (URL) ReflectionUtils.invokeMethod(equinoxResolveMethod, null, rootDirUrl); if (resolvedUrl != null) &#123; rootDirUrl = resolvedUrl; &#125; rootDirResource = new UrlResource(rootDirUrl); &#125; // vfs ËµÑÊ∫êÁ±ªÂûã if (rootDirUrl.getProtocol().startsWith(ResourceUtils.URL_PROTOCOL_VFS)) &#123; result.addAll(VfsResourceMatchingDelegate.findMatchingResources(rootDirUrl, subPattern, getPathMatcher())); // jar ËµÑÊ∫êÁ±ªÂûã &#125; else if (ResourceUtils.isJarURL(rootDirUrl) || isJarResource(rootDirResource)) &#123; result.addAll(doFindPathMatchingJarResources(rootDirResource, rootDirUrl, subPattern)); // ÂÖ∂ÂÆÉËµÑÊ∫êÁ±ªÂûã &#125; else &#123; result.addAll(doFindPathMatchingFileResources(rootDirResource, subPattern)); &#125; &#125; if (logger.isTraceEnabled()) &#123; logger.trace("Resolved location pattern [" + locationPattern + "] to resources " + result); &#125; // ËΩ¨Êç¢Êàê Resource Êï∞ÁªÑËøîÂõû return result.toArray(new Resource[0]);&#125; ÊñπÊ≥ïÊúâÁÇπÂÑøÈïøÔºå‰ΩÜÊòØÊÄùË∑ØËøòÊòØÂæàÊ∏ÖÊô∞ÁöÑÔºå‰∏ªË¶ÅÂàÜ‰∏§Ê≠•Ôºö Á°ÆÂÆöÁõÆÂΩïÔºåËé∑ÂèñËØ•ÁõÆÂΩï‰∏ãÂæóÊâÄÊúâËµÑÊ∫ê„ÄÇ Âú®ÊâÄËé∑ÂæóÁöÑÊâÄÊúâËµÑÊ∫êÂêéÔºåËøõË°åËø≠‰ª£ÂåπÈÖçËé∑ÂèñÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑËµÑÊ∫ê„ÄÇ Âú®Ëøô‰∏™ÊñπÊ≥ïÈáåÈù¢ÔºåÊàë‰ª¨Ë¶ÅÂÖ≥Ê≥®‰∏§‰∏™ÊñπÊ≥ïÔºå‰∏Ä‰∏™ÊòØ #determineRootDir(String location) ÊñπÊ≥ïÔºå‰∏Ä‰∏™ÊòØ #doFindPathMatchingXXXResources(...) Á≠âÊñπÊ≥ï„ÄÇ 2.5.5.1 determineRootDirdetermineRootDir(String location) ÊñπÊ≥ïÔºå‰∏ªË¶ÅÊòØÁî®‰∫éÁ°ÆÂÆöÊ†πË∑ØÂæÑ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829/** * Determine the root directory for the given location. * &lt;p&gt;Used for determining the starting point for file matching, * resolving the root directory location to a &#123;@code java.io.File&#125; * and passing it into &#123;@code retrieveMatchingFiles&#125;, with the * remainder of the location as pattern. * &lt;p&gt;Will return "/WEB-INF/" for the pattern "/WEB-INF/*.xml", * for example. * @param location the location to check * @return the part of the location that denotes the root directory * @see #retrieveMatchingFiles */protected String determineRootDir(String location) &#123; // ÊâæÂà∞ÂÜíÂè∑ÁöÑÂêé‰∏Ä‰Ωç int prefixEnd = location.indexOf(':') + 1; // Ê†πÁõÆÂΩïÁªìÊùü‰ΩçÁΩÆ int rootDirEnd = location.length(); // Âú®‰ªéÂÜíÂè∑ÂºÄÂßãÂà∞ÊúÄÂêéÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÔºåÂæ™ÁéØÂà§Êñ≠ÊòØÂê¶ÂåÖÂê´ÈÄöÈÖçÁ¨¶ÔºåÂ¶ÇÊûúÂåÖÂê´ÔºåÂàôÊà™Êñ≠ÊúÄÂêé‰∏Ä‰∏™Áî±‚Äù/‚ÄùÂàÜÂâ≤ÁöÑÈÉ®ÂàÜ„ÄÇ // ‰æãÂ¶ÇÔºöÂú®Êàë‰ª¨Ë∑ØÂæÑ‰∏≠ÔºåÂ∞±ÊòØÊúÄÂêéÁöÑap?-context.xmlËøô‰∏ÄÊÆµ„ÄÇÂÜçÂæ™ÁéØÂà§Êñ≠Ââ©‰∏ãÁöÑÈÉ®ÂàÜÔºåÁõ¥Âà∞Ââ©‰∏ãÁöÑË∑ØÂæÑ‰∏≠ÈÉΩ‰∏çÂåÖÂê´ÈÄöÈÖçÁ¨¶„ÄÇ while (rootDirEnd &gt; prefixEnd &amp;&amp; getPathMatcher().isPattern(location.substring(prefixEnd, rootDirEnd))) &#123; rootDirEnd = location.lastIndexOf('/', rootDirEnd - 2) + 1; &#125; // Â¶ÇÊûúÊü•ÊâæÂÆåÊàêÂêéÔºårootDirEnd = 0 ‰∫ÜÔºåÂàôÂ∞Ü‰πãÂâçËµãÂÄºÁöÑ prefixEnd ÁöÑÂÄºËµãÁªô rootDirEnd Ôºå‰πüÂ∞±ÊòØÂÜíÂè∑ÁöÑÂêé‰∏Ä‰Ωç if (rootDirEnd == 0) &#123; rootDirEnd = prefixEnd; &#125; // Êà™ÂèñÊ†πÁõÆÂΩï return location.substring(0, rootDirEnd);&#125; ÊñπÊ≥ïÊØîËæÉÁªïÔºåÊïàÊûúÂ¶Ç‰∏ãÁ§∫‰æãÔºö ÂéüË∑ØÂæÑ Á°ÆÂÆöÊ†πË∑ØÂæÑ classpath*:test/cc*/spring-*.xml classpath*:test/ classpath*:test/aa/spring-*.xml classpath*:test/aa/ 2.5.5.2 doFindPathMatchingXXXResources Êù•Ëá™ËâøËâø #doFindPathMatchingXXXResources(...) ÊñπÊ≥ïÔºåÊòØ‰∏™Ê≥õÊåáÔºå‰∏ÄÂÖ±ÂØπÂ∫î‰∏â‰∏™ÊñπÊ≥ïÔºö #doFindPathMatchingJarResources(rootDirResource, rootDirUrl, subPatter) ÊñπÊ≥ï #doFindPathMatchingFileResources(rootDirResource, subPattern) ÊñπÊ≥ï VfsResourceMatchingDelegate#findMatchingResources(rootDirUrl, subPattern, pathMatcher) ÊñπÊ≥ï Âõ†‰∏∫Êú¨ÊñáÈáçÂú®ÂàÜÊûê Spring Áªü‰∏ÄËµÑÊ∫êÂä†ËΩΩÁ≠ñÁï•ÁöÑÊï¥‰ΩìÊµÅÁ®ã„ÄÇÁõ∏ÂØπÊù•ËØ¥Ôºå‰∏äÈù¢Âá†‰∏™ÊñπÊ≥ïÁöÑ‰ª£Á†ÅÈáè‰ºöÊØîËæÉÂ§ö„ÄÇÊâÄ‰ª•Êú¨Êñá‰∏çÂÜçËøΩÊ∫ØÔºåÊÑüÂÖ¥Ë∂£ÁöÑËÉñÂèãÔºåÊé®ËçêÈòÖËØªÂ¶Ç‰∏ãÊñáÁ´†Ôºö „ÄäSpringÊ∫êÁ†ÅÊÉÖÊìçÈô∂ÂÜ∂-PathMatchingResourcePatternResolverË∑ØÂæÑËµÑÊ∫êÂåπÈÖçÊ∫∂Ëß£Âô®„Äã Ôºå‰∏ªË¶ÅÈíàÂØπ #doFindPathMatchingJarResources(rootDirResource, rootDirUrl, subPatter) ÊñπÊ≥ï„ÄÇ „ÄäÊ∑±ÂÖ• Spring IoC Ê∫êÁ†Å‰πã ResourceLoader„Äã Ôºå‰∏ªË¶ÅÈíàÂØπ #doFindPathMatchingFileResources(rootDirResource, subPattern) ÊñπÊ≥ï„ÄÇ „ÄäSpring Ê∫êÁ†ÅÂ≠¶‰π† ‚Äî‚Äî Âê´ÊúâÈÄöÈÖçÁ¨¶Ë∑ØÂæÑËß£ÊûêÔºà‰∏äÔºâ„Äã üòà Ë≤å‰ººÊ≤°Êúâ‰∏ã 3. Â∞èÁªìËá≥Ê≠§ Spring Êï¥‰∏™ËµÑÊ∫êËÆ∞ËΩΩËøáÁ®ãÂ∑≤ÁªèÂàÜÊûêÂÆåÊØï„ÄÇ‰∏ãÈù¢ÁÆÄË¶ÅÊÄªÁªì‰∏ãÔºö Spring Êèê‰æõ‰∫Ü Resource Âíå ResourceLoader Êù•Áªü‰∏ÄÊäΩË±°Êï¥‰∏™ËµÑÊ∫êÂèäÂÖ∂ÂÆö‰Ωç„ÄÇ‰ΩøÂæóËµÑÊ∫ê‰∏éËµÑÊ∫êÁöÑÂÆö‰ΩçÊúâ‰∫Ü‰∏Ä‰∏™Êõ¥Âä†Ê∏ÖÊô∞ÁöÑÁïåÈôêÔºåÂπ∂‰∏îÊèê‰æõ‰∫ÜÂêàÈÄÇÁöÑ Default Á±ªÔºå‰ΩøÂæóËá™ÂÆö‰πâÂÆûÁé∞Êõ¥Âä†Êñπ‰æøÂíåÊ∏ÖÊô∞„ÄÇ DefaultResource ‰∏∫ Resource ÁöÑÈªòËÆ§ÂÆûÁé∞ÔºåÂÆÉÂØπ Resource Êé•Âè£ÂÅö‰∫Ü‰∏Ä‰∏™Áªü‰∏ÄÁöÑÂÆûÁé∞ÔºåÂ≠êÁ±ªÁªßÊâøËØ•Á±ªÂêéÂè™ÈúÄË¶ÅË¶ÜÁõñÁõ∏Â∫îÁöÑÊñπÊ≥ïÂç≥ÂèØÔºåÂêåÊó∂ÂØπ‰∫éËá™ÂÆö‰πâÁöÑ Resource Êàë‰ª¨‰πüÊòØÁªßÊâøËØ•Á±ª„ÄÇ DefaultResourceLoader ÂêåÊ†∑‰πüÊòØ ResourceLoader ÁöÑÈªòËÆ§ÂÆûÁé∞ÔºåÂú®Ëá™ÂÆö ResourceLoader ÁöÑÊó∂ÂÄôÊàë‰ª¨Èô§‰∫ÜÂèØ‰ª•ÁªßÊâøËØ•Á±ªÂ§ñËøòÂèØ‰ª•ÂÆûÁé∞ ProtocolResolver Êé•Âè£Êù•ÂÆûÁé∞Ëá™ÂÆöËµÑÊ∫êÂä†ËΩΩÂçèËÆÆ„ÄÇ DefaultResourceLoader ÊØèÊ¨°Âè™ËÉΩËøîÂõûÂçï‰∏ÄÁöÑËµÑÊ∫êÔºåÊâÄ‰ª• Spring ÈíàÂØπËøô‰∏™Êèê‰æõ‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™Êé•Âè£ ResourcePatternResolver ÔºåËØ•Êé•Âè£Êèê‰æõ‰∫ÜÊ†πÊçÆÊåáÂÆöÁöÑ locationPattern ËøîÂõûÂ§ö‰∏™ËµÑÊ∫êÁöÑÁ≠ñÁï•„ÄÇÂÖ∂Â≠êÁ±ª PathMatchingResourcePatternResolver ÊòØ‰∏Ä‰∏™ÈõÜÂ§ßÊàêËÄÖÁöÑ ResourceLoader ÔºåÂõ†‰∏∫ÂÆÉÂç≥ÂÆûÁé∞‰∫Ü Resource getResource(String location) ÊñπÊ≥ïÔºå‰πüÂÆûÁé∞‰∫Ü Resource[] getResources(String locationPattern)ÊñπÊ≥ï„ÄÇ Âè¶Â§ñÔºåÂ¶ÇÊûúËÉñÂèãËÆ§ÁúüÁöÑÁúã‰∫ÜÊú¨ÊñáÁöÑÂåÖÁªìÊûÑÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÔºåResource Âíå ResourceLoader Ê†∏ÂøÉÊòØÂú®Ôºåspring-core È°πÁõÆ‰∏≠„ÄÇ Â¶ÇÊûúÊÉ≥Ë¶ÅË∞ÉËØïÊú¨Â∞èËäÇÁöÑÁõ∏ÂÖ≥ÂÜÖÂÆπÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® Resource Âíå ResourceLoader Áõ∏ÂÖ≥ÁöÑ API ÔºåËøõË°åÊìç‰ΩúË∞ÉËØï„ÄÇ]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxJava]]></title>
    <url>%2F2019%2F02%2F09%2FRxJava%2F</url>
    <content type="text"><![CDATA[RxJavaÊòØ‰ªÄ‰πàa library for composing asynchronous and event-based programs using observable sequences for the Java VMÔºà‰∏Ä‰∏™ÂØπ‰∫éÊûÑÊàê‰ΩøÁî®ÁöÑJavaËôöÊãüÊú∫ËßÇÂØüÂ∫èÂàóÂºÇÊ≠•ÂíåÂü∫‰∫é‰∫ã‰ª∂ÁöÑÁ®ãÂ∫èÂ∫ìÔºâ„ÄÇgithubÔºöhttps://github.com/ReactiveX/RxJava ËßÇÂØüËÄÖÊ®°ÂºèRxJavaÁöÑ‰∏ñÁïåÈáåÔºåÊàë‰ª¨ÊúâÂõõÁßçËßíËâ≤ÔºöObservable(Ë¢´ËßÇÂØüËÄÖ)„ÄÅObserver(ËßÇÂØüËÄÖ)Subscriber(ËÆ¢ÈòÖËÄÖ)„ÄÅSubjectObservableÂíåSubjectÊòØ‰∏§‰∏™‚ÄúÁîü‰∫ß‚ÄùÂÆû‰ΩìÔºåObserverÂíåSubscriberÊòØ‰∏§‰∏™‚ÄúÊ∂àË¥π‚ÄùÂÆû‰Ωì„ÄÇObservable Âíå Observer ÈÄöËøá subscribe() ÊñπÊ≥ïÂÆûÁé∞ËÆ¢ÈòÖÂÖ≥Á≥ªÔºå‰ªéËÄå Observable ÂèØ‰ª•Âú®ÈúÄË¶ÅÁöÑÊó∂ÂÄôÂèëÂá∫‰∫ã‰ª∂Êù•ÈÄöÁü• Observer„ÄÇ ÂõûË∞ÉÊñπÊ≥ïSubscribeÊñπÊ≥ïÁî®‰∫éÂ∞ÜËßÇÂØüËÄÖËøûÊé•Âà∞ObservableÔºå‰Ω†ÁöÑËßÇÂØüËÄÖÈúÄË¶ÅÂÆûÁé∞‰ª•‰∏ãÊñπÊ≥ïÔºö onNext(T item)ObservableË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÂèëÂ∞ÑÊï∞ÊçÆÔºåÊñπÊ≥ïÁöÑÂèÇÊï∞Â∞±ÊòØObservableÂèëÂ∞ÑÁöÑÊï∞ÊçÆÔºåËøô‰∏™ÊñπÊ≥ïÂèØËÉΩ‰ºöË¢´Ë∞ÉÁî®Â§öÊ¨°ÔºåÂèñÂÜ≥‰∫é‰Ω†ÁöÑÂÆûÁé∞„ÄÇ onError(Exception ex)ÂΩìObservableÈÅáÂà∞ÈîôËØØÊàñËÄÖÊó†Ê≥ïËøîÂõûÊúüÊúõÁöÑÊï∞ÊçÆÊó∂‰ºöË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåËøô‰∏™Ë∞ÉÁî®‰ºöÁªàÊ≠¢ObservableÔºåÂêéÁª≠‰∏ç‰ºöÂÜçË∞ÉÁî®onNextÂíåonCompletedÔºåonErrorÊñπÊ≥ïÁöÑÂèÇÊï∞ÊòØÊäõÂá∫ÁöÑÂºÇÂ∏∏„ÄÇ onCompleteÊ≠£Â∏∏ÁªàÊ≠¢ÔºåÂ¶ÇÊûúÊ≤°ÊúâÈÅáÂà∞ÈîôËØØÔºåObservableÂú®ÊúÄÂêé‰∏ÄÊ¨°Ë∞ÉÁî®onNext‰πãÂêéË∞ÉÁî®Ê≠§ÊñπÊ≥ï„ÄÇ Ê∑ªÂä†‰æùËµñ12compile 'io.reactivex:rxandroid:1.1.0'compile 'io.reactivex:rxjava:1.1.0' ÂàõÂª∫Êìç‰Ωúcreate123456789101112131415161718192021222324Observable.create(new Observable.OnSubscribe&lt;String&gt;() &#123; @Override public void call(Subscriber&lt;? super String&gt; subscriber) &#123; subscriber.onNext("Hello"); subscriber.onNext("RxJava"); subscriber.onCompleted(); &#125; &#125;) .subscribe(new Observer&lt;String&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(String s) &#123; Log.i("wxl", "onNext=" + s); &#125; &#125;); Èô§‰∫Ü Observer Êé•Âè£‰πãÂ§ñÔºåRxJava ËøòÂÜÖÁΩÆ‰∫Ü‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü Observer ÁöÑÊäΩË±°Á±ªÔºöSubscriber„ÄÇ Subscriber ÂØπ Observer Êé•Âè£ËøõË°å‰∫Ü‰∏Ä‰∫õÊâ©Â±ïÔºå‰ΩÜ‰ªñ‰ª¨ÁöÑÂü∫Êú¨‰ΩøÁî®ÊñπÂºèÊòØÂÆåÂÖ®‰∏ÄÊ†∑ÁöÑÔºö 12345678910111213141516.subscribe(new Subscriber() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(Object o) &#123; Log.i("wxl", "onNext=" + o); &#125; &#125;); fromÊé•ÂèóÊï∞ÁªÑÔºåËøîÂõû‰∏Ä‰∏™ÊåâÂèÇÊï∞ÂàóË°®È°∫Â∫èÂèëÂ∞ÑËøô‰∫õÊï∞ÊçÆÁöÑObservable„ÄÇ 123456789101112131415161718String[] froms=&#123;"Hello","RxJava"&#125;;Observable.from(froms).subscribe(new Observer&lt;String&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(String s) &#123; Log.i("wxl", "onNext=" + s); &#125;&#125;); justjustÂáΩÊï∞ÔºåÂÆÉÊé•Âèó‰∏ÄËá≥‰πù‰∏™ÂèÇÊï∞ÔºåËøîÂõû‰∏Ä‰∏™ÊåâÂèÇÊï∞ÂàóË°®È°∫Â∫èÂèëÂ∞ÑËøô‰∫õÊï∞ÊçÆÁöÑObservable„ÄÇ 1234567891011121314151617Observable.just("Hello","RxJava") .subscribe(new Observer&lt;String&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(String s) &#123; Log.i("wxl", "onNext=" + s); &#125; &#125;); ‰ª•‰∏äÊâìÂç∞ÁªìÊûúÈÉΩÊòØÔºö 123com.wuxiaolong.apksample I/wxl: onNext=Hellocom.wuxiaolong.apksample I/wxl: onNext=RxJavacom.wuxiaolong.apksample I/wxl: onCompleted ÂèòÊç¢Êìç‰ΩúMapÊìç‰ΩúÁ¨¶ÂØπÂéüÂßãObservableÂèëÂ∞ÑÁöÑÊØè‰∏ÄÈ°πÊï∞ÊçÆÂ∫îÁî®‰∏Ä‰∏™‰Ω†ÈÄâÊã©ÁöÑÂáΩÊï∞ÔºåÁÑ∂ÂêéËøîÂõû‰∏Ä‰∏™ÂèëÂ∞ÑËøô‰∫õÁªìÊûú„ÄÇÂ¶Ç‰∏ãÔºåÂ∞ÜÂéüÂßãObservableÊï∞ÊçÆËΩ¨ÂåñÊàêÂ§ßÂÜôÔºåÂÜçÂèëÂ∞ÑÔºö 1234567891011121314151617181920212223Observable.just("Hello", "RxJava") .map(new Func1&lt;String, String&gt;() &#123; @Override public String call(String s) &#123; return s.toUpperCase(); &#125; &#125;) .subscribe(new Observer&lt;String&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(String s) &#123; Log.i("wxl", "onNext=" + s); &#125; &#125;); ÊâìÂç∞ÁªìÊûúÔºö 123com.wuxiaolong.apksample I/wxl: onNext=HELLOcom.wuxiaolong.apksample I/wxl: onNext=RXJAVAcom.wuxiaolong.apksample I/wxl: onCompleted flatMapflatMap()Êé•Êî∂‰∏Ä‰∏™ObservableÁöÑËæìÂá∫‰Ωú‰∏∫ËæìÂÖ•ÔºåÁÑ∂Âêé‰Ωú‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑObservableÂÜçÂèëÂ∞Ñ„ÄÇÁêÜËß£flatMapÁöÑÂÖ≥ÈîÆÁÇπÂú®‰∫éÔºåflatMapËæìÂá∫ÁöÑÊñ∞ÁöÑObservableÊ≠£ÊòØÊàë‰ª¨Âú®SubscriberÊÉ≥Ë¶ÅÊé•Êî∂ÁöÑÔºåÊØîÂ¶ÇËøôÈáåËæìÂá∫Âçï‰∏™ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ 1234567891011121314151617181920212223242526List&lt;String&gt; list = new ArrayList&lt;&gt;(); list.add("Hello"); list.add("RxJava");Observable.from(list) .flatMap(new Func1&lt;String, Observable&lt;String&gt;&gt;() &#123; @Override public Observable&lt;String&gt; call(String s) &#123; return Observable.just(s.toUpperCase()); &#125; &#125;) .subscribe(new Observer&lt;String&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(String s) &#123; Log.i("wxl", "onNext=" + s); &#125; &#125;); ÊâìÂç∞ÁªìÊûúÔºö 123com.wuxiaolong.apksample I/wxl: onNext=HELLOcom.wuxiaolong.apksample I/wxl: onNext=RXJAVAcom.wuxiaolong.apksample I/wxl: onCompleted Scan‰∏Ä‰∏™Á¥ØÂä†Âô®ÂáΩÊï∞ÔºåÊìç‰ΩúÁ¨¶ÂØπÂéüÂßãObservableÂèëÂ∞ÑÁöÑÁ¨¨‰∏ÄÈ°πÊï∞ÊçÆÂ∫îÁî®‰∏Ä‰∏™ÂáΩÊï∞ÔºåÁÑ∂ÂêéÂ∞ÜÈÇ£‰∏™ÂáΩÊï∞ÁöÑÁªìÊûú‰Ωú‰∏∫Ëá™Â∑±ÁöÑÁ¨¨‰∏ÄÈ°πÊï∞ÊçÆÂèëÂ∞Ñ„ÄÇ 1234567891011121314151617181920Observable.just(1, 2, 3, 4, 5) .scan(new Func2&lt;Integer, Integer, Integer&gt;() &#123; @Override public Integer call(Integer integer, Integer integer2) &#123; return integer + integer2; &#125; &#125;) .subscribe(new Observer&lt;Integer&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(Integer integer) &#123; Log.i("wxl", "onNext=" + integer); &#125; &#125;); Á¨¨‰∏ÄÊ¨°ÂèëÂ∞ÑÂæóÂà∞1Ôºå‰Ωú‰∏∫ÁªìÊûú‰∏é2Áõ∏Âä†ÔºõÂèëÂ∞ÑÂæóÂà∞3Ôºå‰Ωú‰∏∫ÁªìÊûú‰∏é3Áõ∏Âä†Ôºå‰ª•Ê≠§Á±ªÊé®ÔºåÊâìÂç∞ÁªìÊûúÔºö 123456I/wxl: onNext=1I/wxl: onNext=3I/wxl: onNext=6I/wxl: onNext=10I/wxl: onNext=15I/wxl: onCompleted GroupByÊåâÁÖßÊåáÂÆöÁöÑËßÑÂàôÊù•ÂàÜÁªÑÂÖÉÁ¥†„ÄÇ ËøáÊª§Êìç‰ΩúFilterËßÇÊµãÂ∫èÂàó‰∏≠Âè™ÊúâÈÄöËøáÁöÑÊï∞ÊçÆÊâç‰ºöË¢´ÂèëÂ∞Ñ„ÄÇ 1234567891011121314151617181920Observable.just(4, 2, 1, 7, 5) .filter(new Func1&lt;Integer, Boolean&gt;() &#123; @Override public Boolean call(Integer integer) &#123; return integer &gt; 3; &#125; &#125;) .subscribe(new Observer&lt;Integer&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(Integer integer) &#123; Log.i("wxl", "onNext=" + integer); &#125; &#125;); ËøáÊª§Â∞è‰∫é3ÁöÑÔºåÊâìÂç∞ÁªìÊûúÔºö 1234I/wxl: onNext=4I/wxl: onNext=7I/wxl: onNext=5I/wxl: onCompleted take()„ÄÅtakeLast()1.take(3) Âè™ÂèëÂ∞ÑÂâçN‰∏™ÂÖÉÁ¥† 1.takeLast(3) Âè™ÂèëÂ∞ÑÊúÄÂêéN‰∏™ÂÖÉÁ¥† First„ÄÅlastÂè™ÂèëÂ∞ÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÊàñËÄÖÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥† Skip„ÄÅSkipLast1.skip(2) Êù•ÂàõÂª∫‰∏Ä‰∏™‰∏çÂèëÂ∞ÑÂâç‰∏§‰∏™ÂÖÉÁ¥†ËÄåÊòØÂèëÂ∞ÑÂÆÉÂêéÈù¢ÁöÑÈÇ£‰∫õÊï∞ÊçÆÁöÑÂ∫èÂàó distinct‰ªÖÂ§ÑÁêÜ‰∏ÄÊ¨°ÔºåÂèØ‰ª•Â§ÑÁêÜÂéªÈô§ÈáçÂ§çÁöÑÊï∞ÊçÆ ElementAt‰ªÖ‰ªé‰∏Ä‰∏™Â∫èÂàó‰∏≠ÂèëÂ∞ÑÁ¨¨n‰∏™ÂÖÉÁ¥†ÁÑ∂ÂêéÂ∞±ÂÆåÊàê‰∫ÜÔºåËøôÈáåÊòØ‰ªé0ÂºÄÂßãËÆ°ÁöÑ„ÄÇ 123Observable.just(1, 2, 3, 4, 5, 6) .elementAt(3) .subscribe(‚Ä¶‚Ä¶); ÊâìÂç∞ÁªìÊûúÔºö4 SampleÂÆöÊúüÂèëÂ∞ÑObservableÊúÄËøëÂèëÂ∞ÑÁöÑÊï∞ÊçÆÈ°π 1.sample(1000, TimeUnit.MILLISECONDS) ÂêàÂπ∂Êìç‰ΩúMergeÂêàÂπ∂Â§ö‰∏™ObservablesÁöÑÂèëÂ∞ÑÁâ©ÔºåÂ§öËæìÂÖ•ÔºåÂçïËæìÂá∫ 12345678910111213141516Observable&lt;Integer&gt; observable1 = Observable.just(1, 3, 5);Observable&lt;Integer&gt; observable2 = Observable.just(2, 4, 6);Observable.merge(observable1,observable2) .subscribe(new Observer&lt;Integer&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(Integer integer) &#123; Log.i("wxl", "onNext=" + integer); &#125; &#125;); ÊâìÂç∞ÁªìÊûúÔºö 1234567I/wxl: onNext=1I/wxl: onNext=3I/wxl: onNext=5I/wxl: onNext=2I/wxl: onNext=4I/wxl: onNext=6I/wxl: onCompleted zipÂêàÂπ∂‰∏§‰∏™ÊàñËÄÖÂ§ö‰∏™ObservablesÂèëÂ∞ÑÂá∫ÁöÑÊï∞ÊçÆÈ°πÔºåÊ†πÊçÆÊåáÂÆöÁöÑÂáΩÊï∞Func2ÂèòÊç¢ÂÆÉ‰ª¨ÔºåÂπ∂ÂèëÂ∞Ñ‰∏Ä‰∏™Êñ∞ÂÄº„ÄÇ 123456789101112131415161718192021Observable&lt;Integer&gt; observable1 = Observable.just(1, 3, 5);Observable&lt;Integer&gt; observable2 = Observable.just(2, 4, 6, 9);Observable.zip(observable1, observable2, new Func2&lt;Integer, Integer, Integer&gt; @Override public Integer call(Integer integer, Integer integer2) &#123; return integer + integer2; &#125;&#125;) .subscribe(new Observer&lt;Integer&gt;() &#123; @Override public void onCompleted() &#123; Log.i("wxl", "onCompleted"); &#125; @Override public void onError(Throwable e) &#123; &#125; @Override public void onNext(Integer integer) &#123; Log.i("wxl", "onNext=" + integer); &#125; &#125;); ÊâìÂç∞ÁªìÊûúÔºö 1234I/wxl: onNext=3I/wxl: onNext=7I/wxl: onNext=11I/wxl: onCompleted joinstartWith1.startWith(1) Âú®Êï∞ÊçÆÂ∫èÂàóÁöÑÂºÄÂ§¥ÊèíÂÖ•‰∏ÄÊù°ÊåáÂÆöÁöÑÈ°π1 SchedulersË∞ÉÂ∫¶Âô®ÔºåËß£ÂÜ≥Android‰∏ªÁ∫øÁ®ãÈóÆÈ¢òÔºåÊúâ5ÁßçÔºö Schedulers.io()Ëøô‰∏™Ë∞ÉÂ∫¶Âô®Êó∂Áî®‰∫éI/OÊìç‰ΩúÔºàËØªÂÜôÊñá‰ª∂„ÄÅËØªÂÜôÊï∞ÊçÆÂ∫ì„ÄÅÁΩëÁªú‰ø°ÊÅØ‰∫§‰∫íÁ≠âÔºâ Schedulers.computation()Ëøô‰∏™ÊòØËÆ°ÁÆóÂ∑•‰ΩúÈªòËÆ§ÁöÑË∞ÉÂ∫¶Âô®ÔºåÂÆÉ‰∏éI/OÊìç‰ΩúÊó†ÂÖ≥„ÄÇÂÆÉ‰πüÊòØËÆ∏Â§öRxJavaÊñπÊ≥ïÁöÑÈªòËÆ§Ë∞ÉÂ∫¶Âô®Ôºöbuffer()Ôºådebounce()Ôºådelay()Ôºåinterval()Ôºåsample()Ôºåskip() Schedulers.immediate()Ëøô‰∏™Ë∞ÉÂ∫¶Âô®ÂÖÅËÆ∏‰Ω†Á´ãÂç≥Âú®ÂΩìÂâçÁ∫øÁ®ãÊâßË°å‰Ω†ÊåáÂÆöÁöÑÂ∑•‰Ωú„ÄÇÂÆÉÊòØtimeout()ÔºåtimeInterval()Ôºå‰ª•Âèätimestamp()ÊñπÊ≥ïÈªòËÆ§ÁöÑË∞ÉÂ∫¶Âô®„ÄÇ Schedulers.newThread()ÂÆÉ‰∏∫ÊåáÂÆö‰ªªÂä°ÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑÁ∫øÁ®ã„ÄÇ Schedulers.trampoline()ÂΩìÊàë‰ª¨ÊÉ≥Âú®ÂΩìÂâçÁ∫øÁ®ãÊâßË°å‰∏Ä‰∏™‰ªªÂä°Êó∂ÔºåÂπ∂‰∏çÊòØÁ´ãÂç≥ÔºåÊàë‰ª¨ÂèØ‰ª•Áî®.trampoline()Â∞ÜÂÆÉÂÖ•Èòü„ÄÇËøô‰∏™Ë∞ÉÂ∫¶Âô®Â∞Ü‰ºöÂ§ÑÁêÜÂÆÉÁöÑÈòüÂàóÂπ∂‰∏îÊåâÂ∫èËøêË°åÈòüÂàó‰∏≠ÊØè‰∏Ä‰∏™‰ªªÂä°„ÄÇÂÆÉÊòØrepeat()Âíåretry()ÊñπÊ≥ïÈªòËÆ§ÁöÑË∞ÉÂ∫¶Âô®„ÄÇ SubscribeOn„ÄÅObserveOnsubscribeOn()Ôºö‰∫ã‰ª∂‰∫ßÁîüÁöÑÁ∫øÁ®ãobserveOn()Ôºö‰∫ã‰ª∂Ê∂àË¥πÁöÑÁ∫øÁ®ãÔºåAndroidSchedulers.mainThread()ÔºåÂÆÉÊåáÂÆöÁöÑÊìç‰ΩúÂ∞ÜÂú® Android ‰∏ªÁ∫øÁ®ãËøêË°å„ÄÇ 1.subscribeOn(Schedulers.io()) // ÊåáÂÆö subscribe() ÂèëÁîüÂú® IO Á∫øÁ®ã]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>RxJava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TomcatÊÄßËÉΩ‰ºòÂåñ]]></title>
    <url>%2F2019%2F01%2F28%2FTomcat%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[ÈÖçÁΩÆ‰ºòÂåñÂáèÂ∞ëÈÖçÁΩÆ‰ºòÂåñ Âú∫ÊôØ‰∏ÄÔºöÂÅáËÆæÂΩìÂâç REST Â∫îÁî®ÔºàÂæÆÊúçÂä°Ôºâ ÂàÜÊûêÔºöÂÆÉ‰∏çÈúÄË¶ÅÈùôÊÄÅËµÑÊ∫êÔºåTomcat ÂÆπÂô®ÈùôÊÄÅÂíåÂä®ÊÄÅ ÈùôÊÄÅÂ§ÑÁêÜÔºöDefaultServlet ‰ºòÂåñÊñπÊ°àÔºöÈÄöËøáÁßªÈô§conf/web.xml ‰∏≠ org.apache.catalina.servlets.DefaultServlet„ÄÇ Âä®ÊÄÅÔºöJspServlet ‰ºòÂåñÊñπÊ°àÔºöÈÄöËøáÁßªÈô§conf/web.xml ‰∏≠ org.apache.jasper.servlet.JspServlet„ÄÇ DispatcherServletÔºöSpring Web MVC Â∫îÁî® Servlet JspServletÔºöÁºñËØëÂπ∂‰∏îÊâßË°å Jsp È°µÈù¢ DefaultServletÔºöTomcat Â§ÑÁêÜÈùôÊÄÅËµÑÊ∫êÁöÑ Servlet ÁßªÈô§ welcome-file-list 12345&lt;welcome-file-list&gt; &lt;welcome-file&gt;index.html&lt;/welcome-file&gt; &lt;welcome-file&gt;index.htm&lt;/welcome-file&gt; &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;&lt;/welcome-file-list&gt; Â¶ÇÊûúÁ®ãÂ∫èÊòØREST JSON Content-Type ÊàñËÄÖ MIME TypeÔºö application/json ÁßªÈô§ Session ËÆæÁΩÆ ÂØπ‰∫éÂæÆÊúçÂä°/REST Â∫îÁî®Ôºå‰∏çÈúÄË¶Å SessionÔºåÂõ†‰∏∫‰∏çÈúÄË¶ÅÁä∂ÊÄÅ„ÄÇ Spring Security OAuth 2.0„ÄÅJWT Session ÈÄöËøá jsessionId ËøõË°åÁî®Êà∑Ë∑üË∏™ÔºåHTTP Êó†Áä∂ÊÄÅÔºåÈúÄË¶Å‰∏Ä‰∏™ID ‰∏éÂΩìÂâçÁî®Êà∑‰ºöËØùËÅîÁ≥ª„ÄÇSpring Session HttpSession jessionId ‰Ωú‰∏∫ RedisÔºåÂÆûÁé∞Â§ö‰∏™Êú∫Âô®ÁôªÂΩïÔºåÁî®Êà∑‰ºöËØù‰∏ç‰∏¢Â§±„ÄÇ Â≠òÂÇ®ÊñπÊ≥ïÔºöCookie„ÄÅURL ÈáçÂÜô„ÄÅ SSL ÁßªÈô§ Valve Valve Á±ª‰ºº‰∫é Filter ÁßªÈô§ AccessLogValveÔºåÂèØ‰ª•ÈÄöËøá Nginx ÁöÑ Access Log Êõø‰ª£ÔºåValve ÂÆûÁé∞ÈÉΩÈúÄË¶ÅÊ∂àËÄó Java Â∫îÁî®ÁöÑËÆ°ÁÆóÊó∂Èó¥„ÄÇ Âú∫ÊôØ‰∫åÔºöÈúÄË¶Å JSP ÁöÑÊÉÖÂÜµ ÂàÜÊûêÔºö‰∫ÜËß£ JspServlet Â§ÑÁêÜÂéüÁêÜ Servlet Âë®ÊúüÔºö ÂÆû‰æãÂåñÔºöServlet Âíå Filter ÂÆûÁé∞Á±ªÂøÖÈ°ªÂåÖÂê´ÈªòËÆ§ÊûÑÈÄ†Âô®„ÄÇÂèçÂ∞ÑÁöÑÊñπÂºèËøõË°åÂÆû‰æãÂåñ„ÄÇ ÂàùÂßãÂåñÔºöServlet ÂÆπÂô®Ë∞ÉÁî® Servlet Êàñ Filter init() ÊñπÊ≥ï ÈîÄÊØÅÔºöServlet ÂÆπÂô®ÂÖ≥Èó≠Êó∂ÔºåServlet ÊàñËÄÖ Filter destroy() ÊñπÊ≥ïË¢´Ë∞ÉÁî® ‚Äã Servlet ÊàñËÄÖ Filter Âú®‰∏Ä‰∏™ÂÆπÂô®‰∏≠ÔºåÊòØ‰∏ÄËà¨ÊÉÖÂÜµÂú®‰∏Ä‰∏™ Web App ‰∏≠ÊòØ‰∏Ä‰∏™Âçï‰æãÔºå‰∏çÊéíÈô§Â∫îÁî®ÂÆö‰πâÂ§ö‰∏™„ÄÇ JspServlet Áõ∏ÂÖ≥ÁöÑ‰ºòÂåñ ServletConfig ÂèÇÊï∞: ÈúÄË¶ÅÁºñËØë compiler modificationTestInterval ‰∏çÈúÄË¶ÅÁºñËØë development ËÆæÁΩÆ false development = false ÔºåÈÇ£‰πàÔºåËøô‰∫õ JSP Ë¶ÅÂ¶Ç‰ΩïÁºñËØë„ÄÇ‰ºòÂåñÊñπÊ≥ïÔºö Ant Task ÊâßË°å JSP ÁºñËØë Maven Êèí‰ª∂Ôºöorg.codehaus.mojo:jspc-maven-plugin 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.sling&lt;/groupId&gt; &lt;artifactId&gt;jspc-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.1.0&lt;/version&gt;&lt;/dependency&gt; JSP -&gt; ÁøªËØë.jsp ÊàñËÄÖ.jspx Êñá‰ª∂Êàê .java -&gt; ÁºñËØë .class ÊÄªÁªìÔºåconf/web.xml ‰Ωú‰∏∫ Servlet Â∫îÁî®ÁöÑÈªòËÆ§web.xml,ÂÆûÈôÖ‰∏äÔºåÂ∫îÁî®Á®ãÂ∫èÂ≠òÂú®‰∏§‰ªΩweb.xmlÔºåÂÖ∂‰∏≠ÂåÖÊã¨Tomcat conf/web.xml Âíå Â∫îÁî®ÁöÑweb.xmlÔºåÊúÄÁªàÂ∞Ü‰∏§ËÄÖÂêàÂπ∂„ÄÇ JspServlet Â¶ÇÊûú development ÂèÇÊï∞‰∏∫ trueÔºåÂÆÉ‰ºöËá™ÂÆöÊ£ÄÊü•Êñá‰ª∂ÊòØÂê¶‰øÆÊîπÔºåÂ¶ÇÊûú‰øÆÊîπÈáçÊñ∞ÁøªËØëÔºåÂÜçÁºñËØëÔºàÂä†ËΩΩÂíåÊâßË°åÔºâ„ÄÇË®ÄÂ§ñ‰πãÊÑèÔºåJspServlet ÂºÄÂèëÊ®°ÂºèÂèØËÉΩ‰ºöÂØºËá¥ÂÜÖÂ≠òÊ∫¢Âá∫„ÄÇÂç∏ËΩΩ Class‰∏çÂèäÊó∂‰ºöÂØºËá¥ Perm Âå∫Âüü‰∏çÂ§ü„ÄÇ ParentClassLoader -&gt; 1.class 2.class 3.class ChildClassLoader -&gt; 4.class , 5.class ChildClassLoader load 1 - 5 .class 1.class ÈúÄË¶ÅÂç∏ËΩΩÔºåÈúÄË¶ÅÂ∞Ü ParentClassLoader ËÆæÁΩÆ‰∏∫ nullÔºåÂΩì ClassLoader Ë¢´ GC ÂêéÔºå1-3 class ÂÖ®ÈÉ®‰ºöË¢´Âç∏ËΩΩ„ÄÇ 1.class ÂÆÉÊòØÊñá‰ª∂ÔºåÊñá‰ª∂Ë¢´ JVM Âä†ËΩΩÔºå‰∫åËøõÂà∂-&gt; Verify -&gt; Ëß£Êûê ÈÖçÁΩÆË∞ÉÊï¥ÂÖ≥Èó≠Ëá™Âä®ÈáçËΩΩcontext.xml 12&lt;Context docBase="E:/Downloads/tomcat/target/tomcat-1.0-SNAPSHOT" reloadable="false" &gt;&lt;/Context&gt; ‰øÆÊîπËøûÊé•Á∫øÁ®ãÊ±†Êï∞ÈáèÈÄöËøá server.xml1234567&lt;Executor name="tomcatThreadPool" namePrefix="catalina-exec-" maxThreads="99" minSpareThreads="9"/&gt;&lt;Connector executor="tomcatThreadPool" port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" /&gt; ÈÄöËøáÁ®ãÂ∫èÊù•ÁêÜËß£Ôºå&lt;Executor&gt; ÂÆûÈôÖÁöÑTomcat Êé•Âè£Ôºö org.apache.catalina.Executor Êâ©Â±ïÔºö J.U.C Ê†áÂáÜÊé•Âè£ java.util.concurrent.Executor ÂÆûÁé∞Ôºöorg.apache.catalina.core.StandardThreadExecutor Á∫øÁ®ãÊï∞Èáè 1234567891011121314151617181920212223 /** * max number of threads */ protected int maxThreads = 200; /** * min number of threads */ protected int minSpareThreads = 25;public void setMinSpareThreads(int minSpareThreads) &#123; this.minSpareThreads = minSpareThreads; if (executor != null) &#123; executor.setCorePoolSize(minSpareThreads); &#125; &#125; public void setMaxThreads(int maxThreads) &#123; this.maxThreads = maxThreads; if (executor != null) &#123; executor.setMaximumPoolSize(maxThreads); &#125; &#125; Á∫øÁ®ãÊ±†Ôºöorg.apache.tomcat.util.threads.ThreadPoolExecutor(java.util.concurrent.ThreadPoolExecutor) ÊÄªÁªìÔºöTomcat IO ËøûÊé•Âô®‰ΩøÁî®ÁöÑÁ∫øÁ®ãÊ±†ÂÆûÈôÖÊ†áÂáÜÁöÑ Java Á∫øÁ®ãÊ±†ÁöÑÊâ©Â±ïÔºåÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÈáèÂíåÊúÄÂ∞èÁ∫øÁ®ãÊï∞ÈáèÂÆûÈôÖ‰∏äÂàÜÂà´ÊòØ MaximumPoolSize Âíå CorePoolSize„ÄÇ ÈÄöËøá JMX jconsoleÂëΩ‰ª§ÔºåÊàñËÄÖjvisualvm ÔºåËøõÂÖ•JMXÔºåÈÄâÊã©ËøõÁ®ã Ë∞ÉÊï¥tomatÁ∫øÁ®ãÊ±†Â§ßÂ∞è 123## Á∫øÁ®ãÊ±†Â§ßÂ∞èserver.tomcat.maxThreads=99server.tomcat.minSpareThreads=9 JMXÊü•ÁúãÁ∫øÁ®ã jmeter.shÂêØÂä®ÔºåÂÆö‰πâ100‰∏™Á∫øÁ®ãÔºåÂèëËµ∑apiËØ∑Ê±Ç jconsole ÊàñËÄÖ jvisualvm Êü•ÁúãÁ∫øÁ®ãÊï∞ÂèòÂåñ ËßÇÂØüStandardThreadExecutorÊòØÂê¶Â≠òÂú®Ë∞ÉÊï¥Á∫øÁ®ãÊ±†Êï∞ÈáèÁöÑ API ËØÑ‰º∞‰∏Ä‰∫õÂèÇËÄÉÔºö Ê≠£Á°ÆÁéá LoadÔºàCPU -&gt; JVM GCÔºâ TPS / QPS (Ë∂äÂ§ßË∂äÂ•Ω) CPU ÂØÜÈõÜÂûãÔºàÂä†ÂØÜ/Ëß£ÂØÜ„ÄÅÁÆóÊ≥ïÔºâ I/O ÂØÜÈõÜÂûãÔºåÁΩëÁªú„ÄÅÊñá‰ª∂ËØªÂÜôÁ≠â ÈóÆÈ¢òÔºöÂà∞Â∫ïËÆæÁΩÆÂ§öÂ∞ëÁöÑÁ∫øÁ®ãÊï∞ÈáèÊâçÊòØÊúÄ‰ºòÔºü È¶ñÂÖàÔºåËØÑ‰º∞Êï¥‰ΩìÁöÑÊÉÖÂÜµÈáèÔºåÂÅáËÆæ 100W QPSÔºåÊúâÊú∫Âô®Êï∞Èáè 100 Âè∞ÔºåÊØèÂè∞ÊîØÊíë 1w QPS„ÄÇ Á¨¨‰∫åÔºåËøõË°åÂéãÂäõÊµãËØïÔºåÈúÄË¶Å‰∏Ä‰∫õÊµãËØïÊ†∑Êú¨ÔºåJMeter Êù•ÂÆûÁé∞ÔºåÂÅáËÆæ‰∏ÄÊ¨°ËØ∑Ê±ÇÈúÄË¶ÅRT 10msÔºå1ÁßíÂèØ‰ª•ÂêåÊó∂ÂÆåÊàê 100‰∏™ËØ∑Ê±Ç„ÄÇ10000 / 100 = 100 Á∫øÁ®ã„ÄÇ JMeterÁöÑÁ∫øÁ®ãÊï∞„ÄÇ Á°Æ‰øùÔºåLoad ‰∏çË¶ÅÂ§™È´ò„ÄÇÂáèÂ∞ë Full GCÔºåGC ÂèñÂÜ≥‰∫é JVM Â†ÜÁöÑÂ§ßÂ∞è„ÄÇ ÊâßË°å‰∏ÄÊ¨°Êìç‰ΩúÈúÄË¶Å 5 MB ÂÜÖÂ≠òÔºå 50 GB„ÄÇ 20 GB ÂÜÖÂ≠òÔºåÂøÖÁÑ∂ÊâßË°å GC„ÄÇË¶Å‰∏çË∞É‰ºòÁ®ãÂ∫èÔºåÊúÄÂ•ΩÂØπË±°Â≠òÂÇ®Â§ñÂåñÔºåÊØîÂ¶Ç RedisÔºåÂêåÊó∂ÂèàÈúÄË¶ÅËØÑ‰º∞ Redis ÁΩëÁªúÂºÄÈîÄ„ÄÇÂèàË¶ÅËØÑ‰º∞ÁΩëÂç°ÁöÑÊé•ÂèóËÉΩÂäõ„ÄÇ Á¨¨‰∏âÔºåÂ∏∏ËßÑÊÄßÂéãÊµãÔºåÁî±‰∫é‰∏öÂä°ÂèòÊõ¥Ôºå‰ºöÂØºËá¥Â∫ïÂ±ÇÊÄßËÉΩÂèòÂåñ„ÄÇ JVM ‰ºòÂåñË∞ÉÊï¥ GC ÁÆóÊ≥ïÂ¶ÇÊûú Java ÁâàÊú¨Â∞è‰∫é 9ÔºåÈªòËÆ§PS MarkSweepÔºåÂèØÈÄâËÆæÁΩÆ CMS„ÄÅG1„ÄÇ Â¶ÇÊûú Java 9 ÁöÑËØùÔºåÈªòËÆ§ G1 ÈªòËÆ§ÁÆóÊ≥ï1java -jar -server -XX:-PrintGCDetails -Xloggc:./1g/gc.log -XX:+HeapDumpOnOutOfMemoryError -Xms1g -Xmx1g -XX:MaxGCPauseMillis=250 -Djava.awt.headless=true stress-test-demo-0.0.1-SNAPSHOT.jar G1 ÁÆóÊ≥ï1java -jar -server -XX:-PrintGCDetails -Xloggc:./1g/g1-gc.log -XX:+HeapDumpOnOutOfMemoryError -Xms1g -Xmx1g -XX:+UseG1GC -XX:+UseNUMA -XX:MaxGCPauseMillis=250 -Djava.awt.headless=true stress-test-demo-0.0.1-SNAPSHOT.jar -server ‰∏ªË¶ÅÊèêÈ´òÂêûÂêêÈáèÔºåÂú®ÊúâÈôêÁöÑËµÑÊ∫êÔºåÂÆûÁé∞ÊúÄÂ§ßÂåñÂà©Áî®„ÄÇ-client ‰∏ªË¶ÅÊèêÈ´òÂìçÂ∫îÊó∂Èó¥Ôºå‰∏ªË¶ÅÊòØÊèêÈ´òÁî®Êà∑‰ΩìÈ™å„ÄÇ Spring Boot ÈÖçÁΩÆË∞ÉÊï¥Maven ‰æùËµñ 1234&lt;dependency&gt; &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;&lt;/dependency&gt; application.properties 1234567891011# &lt;Executor name=&quot;tomcatThreadPool&quot; namePrefix=&quot;catalina-exec-&quot;# maxThreads=&quot;9&quot; minSpareThreads=&quot;9&quot;/&gt;## Á∫øÁ®ãÊ±†Â§ßÂ∞èserver.tomcat.maxThreads = 99server.tomcat.minSpareThreads = 9## ÂèñÊ∂à Tomcat AccessLogValveserver.tomcat.accesslog.enabled = false## ÂèñÊ∂à JspServletserver.jspServlet.registered=false tomcat.getServer().await()ÂíåObject.wait()Êúâ‰ªÄ‰πàÂå∫Âà´ Tomcat tomcat.getServer().await() Âà©Áî® Thread.sleep(long) ÂÆûÁé∞Ôºö 123456789101112131415if( port==-1 ) &#123; try &#123; awaitThread = Thread.currentThread(); while(!stopAwait) &#123; try &#123; Thread.sleep( 10000 ); &#125; catch( InterruptedException ex ) &#123; // continue and check the flag &#125; &#125; &#125; finally &#123; awaitThread = null; &#125; return; &#125; Object#wait() ÊñπÊ≥ï‰πüÊòØ Native ÊñπÊ≥ï„ÄÇ]]></content>
      <categories>
        <category>tomcat</category>
      </categories>
      <tags>
        <tag>tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂµåÂÖ•Âºè Tomcat]]></title>
    <url>%2F2019%2F01%2F26%2F%E5%B5%8C%E5%85%A5%E5%BC%8FTomcat%2F</url>
    <content type="text"><![CDATA[Tomcat Êû∂ÊûÑ Web ÊäÄÊúØÊ†àServlet ÊäÄÊúØÊ†àWeb FluxÔºàNettyÔºâBIO NIO Web Ëá™Âä®Ë£ÖÈÖçAPI ËßíÂ∫¶ÂàÜÊûêServlet 3.0 + API ÂÆûÁé∞ ServletContainerInitializer ÂÆπÂô®ËßíÂ∫¶ÂàÜÊûê‰º†ÁªüÁöÑ Web Â∫îÁî®ÔºåÂ∞Ü webapp ÈÉ®ÁΩ≤Âà∞ Servlet ÂÆπÂô®‰∏≠„ÄÇ ÂµåÂÖ•Âºè Web Â∫îÁî®ÔºåÁÅµÊ¥ªÈÉ®ÁΩ≤Ôºå‰ªªÊÑèÊåáÂÆö‰ΩçÁΩÆÔºàÊàñËÄÖÈÄöËøáÂ§çÊùÇÁöÑÊù°‰ª∂Âà§Êñ≠Ôºâ Tomcat 7 ÊòØ Servlet 3.0 ÁöÑÂÆûÁé∞ÔºåServletContainerInitializer Tomcat 8 ÊòØ Servlet 3.1 ÁöÑÂÆûÁé∞ÔºåNIO HttpServletRequest„ÄÅHttpServletResponse NIO Âπ∂Èùû‰∏ÄÂÆöËÉΩÂ§üÊèêÈ´òÊÄßËÉΩÔºåÊØîÂ¶ÇËØ∑Ê±ÇÊï∞ÊçÆÈáèËæÉÂ§ßÔºåNIO ÊÄßËÉΩÊØî BIO ËøòË¶ÅÂ∑Æ NIO Â§öÂ∑•ÔºåËØª„ÄÅÂÜôÔºåÂêåÊ≠•ÁöÑ jar ÂêØÂä®java -jar ÊàñËÄÖ jar ËØªÂèñ .jar META-INF/MANIFEST.MF ÔºåÂÖ∂‰∏≠Â±ûÊÄß Main-Class Â∞±ÊòØÂºïÂØºÁ±ªÊâÄÂú®„ÄÇ ÂèÇËÄÉ JDK API Ôºö java.util.jar.Manifest Tomcat Maven Êèí‰ª∂Tomcat 7 Maven Êèí‰ª∂123&lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;&lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;&lt;version&gt;2.1&lt;/version&gt; 12Manifest-Version: 1.0Main-Class: org.apache.tomcat.maven.runner.Tomcat7RunnerCli ÂæóÂá∫ Tomcat 7 ÂèØÊâßË°å jar ÂºïÂØºÁ±ªÊòØorg.apache.tomcat.maven.runner.Tomcat7RunnerCli Tomcat 7 API ÁºñÁ®ã‰ª£Á†ÅÂèÇËÄÉÔºö https://github.com/Frankenjoy123/embeded-tomcat Á°ÆÂÆö Classpath ÁõÆÂΩïclasses ÁªùÂØπË∑ØÂæÑÔºöE:\Downloads\tomcat\target\classes 12String classesPath = System.getProperty("user.dir") + File.separator + "target" + File.separator + "classes"; ÂàõÂª∫ Tomcat ÂÆû‰æãorg.apache.catalina.startup.Tomcat Maven ÂùêÊ†áÔºöorg.apache.tomcat.embed:tomcat-embed-core:7.0.37 ËÆæÁΩÆ HostÂØπË±°1234// ËÆæÁΩÆ HostHost host = tomcat.getHost();host.setName("localhost");host.setAppBase("webapps"); ËÆæÁΩÆ ClasspathClasspath ËØªÂèñËµÑÊ∫êÔºöÈÖçÁΩÆ„ÄÅÁ±ªÊñá‰ª∂ conf/web.xml ‰Ωú‰∏∫ÈÖçÁΩÆÊñá‰ª∂ÔºåÂπ∂‰∏îÊîæÁΩÆ Classpath ÁõÆÂΩï‰∏ãÔºàÁªùÂØπË∑ØÂæÑÔºâ ËÆæÁΩÆ DemoServlet 123 // Ê∑ªÂä† DemoServlet Âà∞ Tomcat ÂÆπÂô®Wrapper wrapper = tomcat.addServlet(contextPath, "DemoServlet", new DemoServlet());wrapper.addMapping("/demo"); Spring Boot ÂµåÂÖ•Âºè Tomcat ÁºñÁ®ãÂÆûÁé∞ EmbeddedServletContainerCustomer123456789101112131415161718192021222324252627282930@Configurationpublic class TomcatConfiguration implements EmbeddedServletContainerCustomizer &#123; @Override public void customize(ConfigurableEmbeddedServletContainer container) &#123; System.err.println(container.getClass()); if (container instanceof TomcatEmbeddedServletContainerFactory) &#123; TomcatEmbeddedServletContainerFactory factory = (TomcatEmbeddedServletContainerFactory) container; // Áõ∏ÂΩì‰∫é new TomcatContextCustomizer()&#123;&#125; factory.addContextCustomizers((context) -&gt; &#123; // Lambda if (context instanceof StandardContext) &#123; StandardContext standardContext = (StandardContext) context; // standardContext.setDefaultWebXml(); // ËÆæÁΩÆ standardContext.setReloadable(true); &#125; &#125;); // Áõ∏ÂΩì‰∫é new TomcatConnectorCustomizer() &#123;&#125; factory.addConnectorCustomizers(connector -&gt; &#123; connector.setPort(12345); &#125;); &#125; &#125;&#125; Ëá™ÂÆö‰πâ ContextÂÆûÁé∞TomcatContextCustomizer 1234567// Áõ∏ÂΩì‰∫é new TomcatContextCustomizer()&#123;&#125;factory.addContextCustomizers((context) -&gt; &#123; // Lambda if (context instanceof StandardContext) &#123; StandardContext standardContext = (StandardContext) context; // standardContext.setDefaultWebXml(); // ËÆæÁΩÆ &#125;&#125;); Ëá™ÂÆö‰πâ ConnectorÂÆûÁé∞ TomcatConnectorCustomizer 1234// Áõ∏ÂΩì‰∫é new TomcatConnectorCustomizer() &#123;&#125;factory.addConnectorCustomizers(connector -&gt; &#123; connector.setPort(12345);&#125;); ÈóÆÁ≠î ÂÜÖÂµåtomcatÊòØ‰∏çÊòØÊØîÂçïÁã¨ÁöÑtomcat‰∏çÊòØÂú®ÊüêÊñπÈù¢ÂÖ∑Êúâ‰∏Ä‰∫õ‰ºòÂäøÔºü ÂµåÂÖ•Âºè Tomcat ÊàñËÄÖÂµåÂÖ•Âºè Web ÂÆπÂô®ÂèØ‰ª•‰∏ç‰æùËµñÊñá‰ª∂ÁõÆÂΩïÔºåÊØîÂ¶ÇÂú® Docker Âú∫ÊôØ‰ΩøÁî®Êñπ‰æø„ÄÇ ÂÜÖÁΩÆÁöÑtomcat Âíå Â§ñÈÉ®ÁöÑtomcat ÊÄßËÉΩÊúâÂ§öÂ§ßÂ∑ÆÂà´?Áîü‰∫ßÁ∫ø‰∏äÂª∫ËÆÆÁî®Âì™‰∏™? ÂµåÂÖ•Âºè Tomcat Âíå ‰º†Áªü Tomcat ÊÄßËÉΩÂèØ‰ª•ËØ¥‰∏ÄÊ†∑ÔºåÁé∞Âú®ÈùûÂ∏∏Â§öÁöÑÁîü‰∫ßÁéØÂ¢É Spring Boot ÂµåÂÖ•Âºè - ÂµåÂÖ•Âºè Tomcat Spring‰∏≠preÂÆû‰æãÂåñÂíåpreÂàùÂßãÂåñÂå∫Âà´(ÂàöÂàöÊúâÊèêÂà∞) Âú® Spring Êó©Ëµ∑ÁâàÊú¨‰∏≠ÔºåÂÖàÊúâÂàùÂßãÂåñÁîüÂëΩÂë®Êúü - org.springframework.beans.factory.config.BeanPostProcessor ÂêéÊù• Spring 1.2 ÔºåÊèê‰æõÊñ∞ÁöÑÊâ©Â±ïÊé•Âè£ÔºàBeanPostProcessorÔºâÔºö org.springframework.beans.factory.config.InstantiationAwareBeanPostProcessor ‚Äã Tomcat API ‰∏ªË¶ÅÊòØËÆ≤tomcatËøêË°åÂéüÁêÜÂêóÔºüÁîü‰∫ßÁéØÂ¢ÉÁî®Âì™ÁßçÊØîËæÉÂ§öÔºü ‰º†Áªü Tomcat Âíå ÂµåÂÖ•Âºè Tomcat ÈÉΩÊúâÂú®Áîü‰∫ßÁéØÂ¢É‰ΩøÁî®„ÄÇ ‚Äã Tomcat ÁÉ≠ÈÉ®ÁΩ≤ÂéüÁêÜËÉΩÁªôËÆ≤‰∏ãÂêóÔºü org.apache.catalina.Lifecycle ‚Äã ÁõëÊéßËµÑÊ∫êÂèòÂåñÔºåClass ÂèòÂåñ„ÄÅÈÖçÁΩÆÂèòÂåñ‰∫Ü„ÄÇ Tomcat ÂÜ≥ÂÆöÈáçÂêØ Context ‚Äã org.apache.catalina.Context ‚Äã Tomcat Ëá™Âä®Âä†ËΩΩ 1public void setReloadable(boolean reloadable)]]></content>
      <categories>
        <category>tomcat</category>
      </categories>
      <tags>
        <tag>tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á≠ñÁï•Ê®°Âºè‰∏éSpringÁªìÂêà‰ΩøÁî®]]></title>
    <url>%2F2019%2F01%2F17%2F%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E4%B8%8ESpring%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[IOCÊòØSpringÁöÑÊ†∏ÂøÉ‰πã‰∏ÄÔºåÂà©Áî®Spring‰ΩøÁî®ËÆæËÆ°Ê®°Âºè‰∏≠ÁöÑÁ≠ñÁï•Ê®°ÂºèÔºåÂèØ‰ª•ÊääÂÖ∑‰ΩìÁ≠ñÁï•ÁöÑÂàõÂª∫‰∫§ÁªôSpringÂÆπÂô®Êù•ÁÆ°ÁêÜ„ÄÇ Á≠ñÁï•Ê®°ÂºèÊé•Âè£ÁöÑÂÆö‰πâ ÈúÄÊ±ÇÔºöËÆæËÆ°‰∏Ä‰∏™ÁªüËÆ°Êä•Ë°®Êé•Âè£ÔºåÊöÇÂÆöÊúâ‰∏§ÁßçÁªüËÆ°ÊñπÂºèÔºöÁªüËÆ°ËÆ¢ÂçïÊÄªÊï∞,ÁªüËÆ°Êñ∞Â¢ûÁî®Êà∑Êï∞„ÄÇ È¶ñÂÖàÂÆö‰πâÁªüËÆ°Êé•Âè£„ÄÇ 12345678/**- Á≠ñÁï•Ê®°ÂºèÁöÑ‰ΩøÁî®:ÈÄâÊã©ÁªüËÆ°ÁÆóÊ≥ï,ÂàÜÁ¶ªÂÆûÁé∞- ÁªüËÆ°Á≠ñÁï•Êé•Âè£:ÂÆö‰πâÁªü‰∏ÄÁöÑË∞ÉÁî®ÊñπÊ≥ï*/public interface StatStrategy &#123; void getStatData();&#125; ÂÖ∑‰ΩìÁöÑÁªüËÆ°ÁÆóÊ≥ïÔºö 1234567@Componentpublic class OrderStrategyImpl implements StatStrategy &#123; @Override public void getStatData() &#123; System.out.println("ÁªüËÆ°ËÆ¢ÂçïÊÄªÊï∞"); &#125;&#125; 1234567@Componentpublic class UserStrategyImpl implements StatStrategy &#123; @Override public void getStatData() &#123; System.out.println("ÁªüËÆ°Êñ∞Â¢ûÁî®Êà∑Êï∞"); &#125;&#125; Âà©Áî®@Component Ê≥®Ëß£Â∞ÜÁÆóÊ≥ïÁöÑÂÆûÁé∞‰∫§Áî±SpringÂÆπÂô®ÁÆ°ÁêÜ„ÄÇ 123456789101112131415161718192021222324/** * ÁªüËÆ°Á≠ñÁï•ÁöÑ‰∏ä‰∏ãÊñá */public class StatContext &#123; //Ë£ÖËΩΩÁ≠ñÁï•ÂØπË±°ÁöÑÈõÜÂêà,ÂÖ∂‰∏≠key:StatisticsÁ±ªÂûã‰∏∫Ëá™ÂÆö‰πâÁöÑÊûö‰∏æÁ±ªÂûã private Map&lt;Statistics, StatStrategy&gt; statStrategy = new HashMap&lt;&gt;(); //Êèê‰æõÁªôÂÆ¢Êà∑Á´Ø‰ΩøÁî®ÁöÑÊñπÊ≥ï public void loadDetailData(Integer strategyId) &#123; for (Map.Entry&lt;Statistics,StatStrategy&gt; entry : statStrategy.entrySet()) &#123; if (entry.getKey().getId()==strategyId.intValue()) &#123; statStrategy.get(entry.getKey()).getStatData(); &#125; &#125; &#125; public Map&lt;Statistics, StatStrategy&gt; getStatStrategy() &#123; return statStrategy; &#125; public void setStatStrategy(Map&lt;Statistics, StatStrategy&gt; statStrategy) &#123; this.statStrategy = statStrategy; &#125;&#125; Ëá™ÂÆö‰πâÁöÑÊûö‰∏æÁ±ªÂûãStatistics Ôºö 123456789101112131415161718192021public enum Statistics &#123; ËÆ¢Âçï_ÊÄªÊï∞ÁªüËÆ°(101, "„ÄêËÆ¢Âçï„ÄëÊÄªÊï∞ÁªüËÆ°"), Áî®Êà∑_Êñ∞Â¢ûÁî®Êà∑Êï∞ÁªüËÆ°(201, "„ÄêÁî®Êà∑„ÄëÊñ∞Â¢ûÁî®Êà∑Êï∞ÁªüËÆ°"); private int id; private String name; public int getId() &#123; return id; &#125; public String getName() &#123; return name; &#125; Statistics(int id, String name) &#123; this.id = id; this.name = name; &#125;&#125; Á≠ñÁï•Ê®°ÂºèÁªìÂêàSpringÊù•‰ΩøÁî®Êé•‰∏ãÊù•ÔºåÂ∞±ÊòØÊää‰∫§Áî±SpringÁÆ°ÁêÜÁöÑÂÖ∑‰ΩìÁÆóÊ≥ïÊ≥®ÂÖ•Âà∞StatContext ‰∏≠ÔºåÁî®xmlÊñá‰ª∂ÁöÑÂΩ¢ÂºèÊù•ÂÆûÁé∞ÔºåBeanÁöÑÂÆö‰πâÂÜôÂú®applicationContext.xml‰∏≠Ôºö Á≠ñÁï•ÊîæÂà∞map‰∏≠ 1234567891011121314151617&lt;bean id="statContext" class="StatContext"&gt; &lt;property name="statStrategy"&gt; &lt;map&gt; &lt;entry key-ref="statOrder" value-ref="orderStrategyImpl "&gt;&lt;/entry&gt; &lt;entry key-ref="statUser" value-ref="userStrategyImpl "&gt;&lt;/entry&gt; &lt;/map&gt; &lt;/property&gt;&lt;/bean&gt;&lt;!--Êûö‰∏æÁ±ªÂûãË¶ÅÊÉ≥Ê≥®ÂÖ•Âà∞Á±ª‰∏≠Ôºå‰∏ÄÂÆöË¶ÅÂÖà‰ΩøÁî®org.springframework.beans.factory.config.FieldRetrievingFactoryBeanÁ±ªÂ∞ÜÊûö‰∏æÁ±ªÂûãËøõË°åËΩ¨Êç¢--&gt;&lt;bean id="statOrder" class="org.springframework.beans.factory.config.FieldRetrievingFactoryBean"&gt; &lt;property name="staticField" value="Statistics.ËÆ¢Âçï_ÊÄªÊï∞ÁªüËÆ°" /&gt;&lt;/bean&gt;&lt;bean id="statUser" class="org.springframework.beans.factory.config.FieldRetrievingFactoryBean"&gt; &lt;property name="staticField" value="Statistics.Áî®Êà∑_Êñ∞Â¢ûÁî®Êà∑Êï∞ÁªüËÆ°" /&gt;&lt;/bean&gt; Á≠ñÁï•Ê®°ÂºèÁöÑÁõ∏ÂÖ≥ÂÆö‰πâÂ∑≤ÁªèÂÜôÂ•ΩÔºåÊé•‰∏ãÊù•‰ΩøÁî®Â∞±ÂæàÁÆÄÂçï‰∫ÜÔºåÊåâÁÖßMVCÁöÑÊû∂ÊûÑÔºåÊàë‰ª¨ÊòØÂú®ServiceÂ±ÇÊù•Ë∞ÉÁî®Áõ∏ÂÖ≥ÁöÑÁ≠ñÁï•ÁÆóÊ≥ïÔºåÈ¶ñÂÖàÂÆö‰πâServiceÊé•Âè£„ÄÇ 123public interface StatService &#123; void loadDetailData(Integer strategyId);&#125; Êé•Âè£ÂÆûÁé∞„ÄÇ 1234567891011@Servicepublic class StatServiceImpl implements StatService &#123; @Autowired private StatContext statContext; @Override public void loadDetailData(Integer strategyId) &#123; //Á≠ñÁï•Ê®°ÂºèÁªìÂêàSpring‰ΩøÁî®,‰Ωø‰ª£Á†ÅÁªìÊûÑÊõ¥Ê∏ÖÊô∞,ÈÅøÂÖçÂ§öÈáçif-elseÂà§Êñ≠ statContext.loadDetailData(strategyId); &#125;&#125; Á≠ñÁï•Ê®°ÂºèÁªìÂêàSpring‰ΩøÁî®Â∞±ÊòØËøô‰πàÁÆÄÂçïÔºåÂÖ∑‰ΩìÁªÜËäÇÂÜçÁªìÂêàÈ°πÁõÆÁöÑ‰ΩøÁî®Êù•‰øÆÊîπÔºåÂÆåÊØï„ÄÇ]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TomcatÊû∂ÊûÑËß£ÊûêÂèäÈÉ®ÁΩ≤ÊñπÂºè]]></title>
    <url>%2F2019%2F01%2F17%2Ftomcat%E6%9E%B6%E6%9E%84%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÁõÆÂΩïÁªìÊûÑconf ÁõÆÂΩïcatalina.policy : Tomcat ÂÆâÂÖ®Á≠ñÁï•Êñá‰ª∂ÔºåÊéßÂà∂ JVM Áõ∏ÂÖ≥ÊùÉÈôêÔºåÂÖ∑‰ΩìÂèØ‰ª•ÂèÇËÄÉjava.security.Permission catalina.properties : Tomcat Catalina Ë°å‰∏∫ÊéßÂà∂ÈÖçÁΩÆÊñá‰ª∂ÔºåÊØîÂ¶Ç Common ClassLoader logging.properties : Tomcat Êó•ÂøóÈÖçÁΩÆÊñá‰ª∂ÔºåJDK Logging server.xml : Tomcat Server ÈÖçÁΩÆÊñá‰ª∂ GlobalNamingResources : ÂÖ®Â±Ä JNDI ËµÑÊ∫ê context.xml : ÂÖ®Â±Ä Context ÈÖçÁΩÆÊñá‰ª∂ tomcat-users.xml : Tomcat ËßíËâ≤ÈÖçÁΩÆÊñá‰ª∂ÔºåÔºàRealm Êñá‰ª∂ÂÆûÁé∞ÊñπÂºèÔºâ„ÄÅ web.xml : Servlet Ê†áÂáÜÁöÑ web.xml ÈÉ®ÁΩ≤Êñá‰ª∂ÔºåTomcat ÈªòËÆ§ÂÆûÁé∞ÈÉ®ÂàÜÈÖçÁΩÆÂÖ•ÂÜÖÔºö org.apache.catalina.servlets.DefaultServlet org.apache.jasper.servlet.JspServlet lib ÁõÆÂΩïTomcat Â≠òÊîæÂÖ¨Áî®Á±ªÂ∫ì ecj-*.jar : Eclipse Java ÁºñËØëÂô® jasper.jar : JSP ÁºñËØëÂô® logs ÁõÆÂΩïlocalhost.${date}.log : ÂΩì Tomcat Â∫îÁî®Ëµ∑‰∏çÊù•ÁöÑÊó∂ÂÄôÔºåÂ§öÁúãËØ•Êñá‰ª∂ÔºåÊØîÂ¶ÇÔºöÁ±ªÂÜ≤Á™Å NoClassDefFoundError ClassNotFoundException catalina.${date}.log : ÊéßÂà∂Âè∞ËæìÂá∫ÔºåSystem.out Â§ñÁΩÆ webapps ÁõÆÂΩïÁÆÄÂåñ web Â∫îÁî®ÈÉ®ÁΩ≤ÁöÑÊñπÂºè ÈÉ®ÁΩ≤ Web Â∫îÁî®ÊñπÊ≥ï‰∏ÄÔºöÊîæÁΩÆÂú® webappsÁõÆÂΩïdemo ‰ª£Á†Å Ôºö https://github.com/Frankenjoy123/tomcat-deploy-example mvn clean package cp target xx.war tomcat/webapps/helloworld unzip xx.war bin/startup.sh ËÆøÈóÆ http://localhost:8080/helloworld/hello?message=abc Âç≥ÂèØÊàêÂäü ÊñπÊ≥ï‰∫åÔºö ‰øÆÊîπ confi/server.xml Âú®HostËäÇÁÇπ‰∏ãÈÖçÁΩÆContextÂÖÉÁ¥† docBaseÈÖçÁΩÆ‰∏∫È°πÁõÆÁöÑËß£ÂéãÂêéÁöÑÁõÆÊ†áÂú∞ÂùÄ 12345&lt;Host name="localhost" appBase="webapps" unpackWARs="true" autoDeploy="true"&gt; &lt;Context path="" docBase="/Users/zhouxiaowu/install/tomcat/demo-tomcat-8080/webapps/helloworld" debug="0" reloadable="true" crossContext="true"/&gt;&lt;/Host&gt; ËÆøÈóÆ http://localhost:8080/hello?message=abc Âç≥ÂèØÊàêÂäü EngineËäÇÁÇπÁöÑÂêçÁß∞‰πüÂèØ‰ª•‰øÆÊîπÔºåÂú®confÁõÆÂΩï‰∏ãÔºåÁîü‰∫ßÂíåCatatlina‰∏ÄÊ†∑ÁöÑÊñá‰ª∂ÁõÆÂΩïÂêçgupao Ê∑ªÂä†Context ÂÖÉÁ¥†Ôºö 12&lt;Context docBase="$&#123;webAppAbsolutePath&#125;" path="/" reloadable="true" /&gt;&lt;Context docBase="$&#123;webAppAbsolutePath&#125;" path="/tomcat" reloadable="true" /&gt; ÁÜüÊÇâÈÖçÁΩÆÂÖÉÁ¥†ÂèØ‰ª•ÂèÇËÄÉorg.apache.catalina.core.StandardContext setter ÊñπÊ≥ï Container Context ËØ•ÊñπÂºè‰∏çÊîØÊåÅÂä®ÊÄÅÈÉ®ÁΩ≤ÔºåÂª∫ËÆÆËÄÉËôëÂú®Áîü‰∫ßÁéØÂ¢É‰ΩøÁî®„ÄÇ ÊñπÊ≥ï‰∏âÔºöÁã¨Á´ã conf/Catalina/localhost ÈÖçÁΩÆÊñá‰ª∂ /Users/zhouxiaowu/install/tomcat/demo-tomcat-8080/conf/Catalina/localhostÊñ∞Âª∫ROOT.xml 123&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;Context crossContext="true" docBase="/Users/zhouxiaowu/IdeaProject-tongdun/Example/target/Example-1.0-SNAPSHOT" path="/" reloadable="true"&gt;&lt;/Context&gt; ‰∏ªÁõÆÂΩïÊñá‰ª∂ÂêçÂøÖÈ°ªÊòØROOT.XML(rootÂ§ßÂÜô)ÔºåËÄåËôöÊãüÁõÆÂΩïÁöÑÊñá‰ª∂ÂêçÁß∞ÂíåËôöÊãüÁõÆÂΩïÁöÑÂêçÁß∞‰∏ÄËá¥Âπ∂‰∏î‰∏∫Â∞èÂÜô conf/Catalina/localhostÊñ∞Âª∫helloworld.xml conf/Catalina/localhost‰∏ãÂª∫Á´ã‰∏Ä‰∏™xmlÊñá‰ª∂ÔºåÁî®‰∫é‰∏ªÁõÆÂΩïÊàñËÄÖËôöÊãüÁõÆÂΩïÔºåËÄå‰∏çÈúÄË¶ÅÂéª‰øÆÊîπserver.xmlÂ∞±ÂèØ‰ª•ËææÂà∞ÈÖçÁΩÆ‰∏ªÁõÆÂΩïÂíåËôöÊãüÁõÆÂΩïÁöÑÁõÆÁöÑ 123&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;Context crossContext="true" docBase="/Users/zhouxiaowu/IdeaProject-tongdun/Example/target/Example-1.0-SNAPSHOT" path="helloworld" reloadable="true"&gt;&lt;/Context&gt; Ê≥®ÊÑèÔºöËØ•ÊñπÂºèÂèØ‰ª•ÂÆûÁé∞ÁÉ≠ÈÉ®ÁΩ≤ÔºåÂõ†Ê≠§Âª∫ËÆÆÂú®ÂºÄÂèëÁéØÂ¢É‰ΩøÁî®„ÄÇ ÊñπÊ≥ïÂõõÔºö Â§öÂÆû‰æãtomcatÈÉ®ÁΩ≤ ÈÖçÁΩÆCATALINA_BASE ÁéØÂ¢ÉÂèòÈáè 1export CATALINA_BASE=$APP_DEPLOY_HOME/tomcat confÁõÆÂΩïÈÖçÁΩÆÔºåÂèÇËÄÉ https://github.com/Frankenjoy123/tomcat-deploy-example Á∫ø‰∏äÁ§∫‰æã1/home/admin/asdemo/deploy/tomcat/conf/Catalina/localhost/ROOT.xml 12345678&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;Context path="" docBase="/home/admin/asdemo/deploy/target/asdemo.war" workDir="/home/admin/asdemo/deploy" debug="0" reloadable="true"&gt;&lt;/Context&gt; I/O ËøûÊé•Âô®ÂèÇËÄÉÊñá‰ª∂Ôºöhttps://tomcat.apache.org/tomcat-7.0-doc/config/http.html ÂÆûÁé∞Á±ªÔºöorg.apache.catalina.connector.Connector Ê≥®ÊÑèÂÆûÁé∞Ôºö 12345678910111213141516171819202122232425262728public void setProtocol(String protocol) &#123; if (AprLifecycleListener.isAprAvailable()) &#123; if ("HTTP/1.1".equals(protocol)) &#123; setProtocolHandlerClassName ("org.apache.coyote.http11.Http11AprProtocol"); &#125; else if ("AJP/1.3".equals(protocol)) &#123; setProtocolHandlerClassName ("org.apache.coyote.ajp.AjpAprProtocol"); &#125; else if (protocol != null) &#123; setProtocolHandlerClassName(protocol); &#125; else &#123; setProtocolHandlerClassName ("org.apache.coyote.http11.Http11AprProtocol"); &#125; &#125; else &#123; if ("HTTP/1.1".equals(protocol)) &#123; setProtocolHandlerClassName ("org.apache.coyote.http11.Http11Protocol"); &#125; else if ("AJP/1.3".equals(protocol)) &#123; setProtocolHandlerClassName ("org.apache.coyote.ajp.AjpProtocol"); &#125; else if (protocol != null) &#123; setProtocolHandlerClassName(protocol); &#125; &#125;&#125; ÈóÆÁ≠î‰∫íÂä®ÈóÆÈ¢ò‰∏ÄÔºöÂ¶ÇÊûúÈÖçÁΩÆpathÁöÑËØù ÊòØ‰ª•Êñá‰ª∂Âêç‰∏∫‰∏ª ËøòÊòØ ‰ª•ÈÖçÁΩÆÁöÑ‰∏∫‰∏ªÁã¨Á´ã context XML ÈÖçÁΩÆÊñá‰ª∂Êó∂ÔºåËÆæÁΩÆ path Â±ûÊÄßÊòØÊó†ÊïàÁöÑ„ÄÇ ÈóÆÈ¢ò‰∫åÔºöÊ†πÁã¨Á´ã context XML ÈÖçÁΩÆÊñá‰ª∂Ë∑ØÂæÑ${TOMCAT_HOME}/conf/${Engine.name}/${HOST.name}/ROOT.xml ÈóÆÈ¢ò‰∏âÔºöÂ¶ÇÊûúÂÆûÁé∞ÁÉ≠ÈÉ®ÁΩ≤Ë∞ÉÊï¥ &lt;context&gt; ÂÖÉÁ¥†‰∏≠ÁöÑÂ±ûÊÄßreloadable=&quot;true&quot; ÈóÆÈ¢òÂõõÔºöËøûÊé•Âô®ÈáåÈù¢ÁöÑÁ∫øÁ®ãÊ±† ÊòØÁî®ÁöÑÂì™‰∏™Á∫øÁ®ãÊ±†Ê≥®ÊÑèconf/server.xml Êñá‰ª∂‰∏≠ÁöÑ‰∏ÄÊÆµÊ≥®ÈáäÔºö 1234&lt;Connector executor="tomcatThreadPool" port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" /&gt; org.apache.catalina.Executor: 123456789101112131415161718public interface Executor extends java.util.concurrent.Executor, Lifecycle &#123; public String getName(); /** * Executes the given command at some time in the future. The command * may execute in a new thread, in a pooled thread, or in the calling * thread, at the discretion of the &lt;tt&gt;Executor&lt;/tt&gt; implementation. * If no threads are available, it will be added to the work queue. * If the work queue is full, the system will wait for the specified * time until it throws a RejectedExecutionException * * @param command the runnable task * @throws java.util.concurrent.RejectedExecutionException if this task * cannot be accepted for execution - the queue is full * @throws NullPointerException if command or unit is null */ void execute(Runnable command, long timeout, TimeUnit unit);&#125; Ê†áÂáÜÂÆûÁé∞Ôºöorg.apache.catalina.core.StandardThreadExecutor Â∞ÜËøûÊé•Â§ÑÁêÜ‰∫§‰ªòÁªô Java Ê†áÂáÜÁ∫øÁ®ãÊ±†Ôºö org.apache.tomcat.util.threads.ThreadPoolExecutor„ÄÇ ÈóÆÈ¢ò‰∫îÔºöJNDI ËÉΩ‰∏çËÉΩÁ®çÂæÆËØ¥‰∏ã ‰πãÂâçÂè™ÊòØÂú®Êï∞ÊçÆÊ∫êÁöÑÊó∂ÂÄôÁî®ËøáÔºå‰ΩÜÊòØ‰∏çÊòØÂ§™ÁêÜËß£1234567&lt;Context ...&gt; ... &lt;Resource name="mail/Session" auth="Container" type="javax.mail.Session" mail.smtp.host="localhost"/&gt; ...&lt;/Context&gt; 123456789101112Context initCtx = new InitialContext();Context envCtx = (Context) initCtx.lookup("java:comp/env");Session session = (Session) envCtx.lookup("mail/Session");Message message = new MimeMessage(session);message.setFrom(new InternetAddress(request.getParameter("from")));InternetAddress to[] = new InternetAddress[1];to[0] = new InternetAddress(request.getParameter("to"));message.setRecipients(Message.RecipientType.TO, to);message.setSubject(request.getParameter("subject"));message.setContent(request.getParameter("content"), "text/plain");Transport.send(message);]]></content>
      <categories>
        <category>tomcat</category>
      </categories>
      <tags>
        <tag>tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Expires„ÄÅLast-Modified„ÄÅEtagÁºìÂ≠òÊéßÂà∂]]></title>
    <url>%2F2019%2F01%2F08%2FExpires%E3%80%81Last-Modified%E3%80%81Etag%E7%BC%93%E5%AD%98%E6%8E%A7%E5%88%B6%2F</url>
    <content type="text"><![CDATA[ÂΩìËØ∑Ê±Ç‰∏Ä‰∏™È°µÈù¢Êó∂ÔºåÂ¶ÇÊûúÊµèËßàÂô®‰ΩøÁî®Êú¨Âú∞ÁºìÂ≠òÔºåÂõ†Ê≠§Êàë‰ª¨ÁªèÂ∏∏‰ºöÁúãÂà∞‰∏Ä‰∏™HTTPËØ∑Ê±Ç‰∏∫304Áä∂ÊÄÅ„ÄÇÊàñËÄÖÊòæÁ§∫200Áä∂ÊÄÅÔºåÂú®chrome‰∏ãÊ†áÊ≥®ÊòØfrom cacheÔºåÂú®ÁÅ´Áãê‰∏ã‰ºöÊ†áÊ≥®BFCacheÔºõ Êàë‰ª¨Â∏åÊúõÂú®ÊúçÂä°Âô®Á´ØÊõ¥Êñ∞‰∫ÜÈùôÊÄÅÊñá‰ª∂ÔºàÂ¶Çcss„ÄÅjs„ÄÅÂõæÁâáÔºâÔºåËÉΩÂ§üÂú®ÂÆ¢Êà∑Á´ØÂæóÂà∞ÂèäÊó∂ÁöÑÊõ¥Êñ∞Ôºå‰ΩÜÂèà‰∏çÊÉ≥ËÆ©ÊµèËßàÂô®ÊØèÊ¨°ËØ∑Ê±ÇÈÉΩ‰ªéÊúçÂä°Âô®Á´ØËé∑ÂèñÈùôÊÄÅËµÑÊ∫ê„ÄÇÈÇ£‰πàÂ∞±ÈúÄË¶Å‰∫ÜËß£‰∏Ä‰∫õ‰∏ãÈù¢ÁöÑÁü•ËØÜÔºö Last-Modified / If-Modified-SinceÂΩìÊµèËßàÂô®Á¨¨‰∏ÄÊ¨°ËØ∑Ê±Ç‰∏Ä‰∏™urlÊó∂ÔºåÊúçÂä°Âô®Á´ØÁöÑËøîÂõûÁä∂ÊÄÅÁ†Å‰∏∫200ÔºåÂêåÊó∂HTTPÂìçÂ∫îÂ§¥‰ºöÊúâ‰∏Ä‰∏™Last-ModifiedÊ†áËÆ∞ÁùÄÊñá‰ª∂Âú®ÊúçÂä°Âô®Á´ØÊúÄÂêéË¢´‰øÆÊîπÁöÑÊó∂Èó¥„ÄÇ ÊµèËßàÂô®Á¨¨‰∫åÊ¨°ËØ∑Ê±Ç‰∏äÊ¨°ËØ∑Ê±ÇËøáÁöÑurlÊó∂ÔºåÊµèËßàÂô®‰ºöÂú®HTTPËØ∑Ê±ÇÂ§¥Ê∑ªÂä†‰∏Ä‰∏™If-Modified-SinceÁöÑÊ†áËÆ∞ÔºåÁî®Êù•ËØ¢ÈóÆÊúçÂä°Âô®ËØ•Êó∂Èó¥‰πãÂêéÊñá‰ª∂ÊòØÂê¶Ë¢´‰øÆÊîπËøá„ÄÇ Â¶ÇÊûúÊúçÂä°Âô®Á´ØÁöÑËµÑÊ∫êÊ≤°ÊúâÂèòÂåñÔºåÂàôËá™Âä®ËøîÂõû304Áä∂ÊÄÅÔºå‰ΩøÁî®ÊµèËßàÂô®ÁºìÂ≠òÔºå‰ªéËÄå‰øùËØÅ‰∫ÜÊµèËßàÂô®‰∏ç‰ºöÈáçÂ§ç‰ªéÊúçÂä°Âô®Á´ØËé∑ÂèñËµÑÊ∫êÔºå‰πü‰øùËØÅ‰∫ÜÊúçÂä°Âô®ÊúâÂèòÂåñÊòØÔºåÂÆ¢Êà∑Á´ØËÉΩÂ§üÂèäÊó∂ÂæóÂà∞ÊúÄÊñ∞ÁöÑËµÑÊ∫ê„ÄÇ Etag / If-None-MatchÂΩìÊµèËßàÂô®Á¨¨‰∏ÄÊ¨°ËØ∑Ê±Ç‰∏Ä‰∏™urlÊó∂ÔºåÊúçÂä°Âô®Á´ØÁöÑËøîÂõûÁä∂ÊÄÅÁ†Å‰∏∫200ÔºåÂêåÊó∂HTTPÂìçÂ∫îÂ§¥‰ºöÊúâ‰∏Ä‰∏™EtagÔºåÂ≠òÊîæÁùÄÊúçÂä°Âô®Á´ØÁîüÊàêÁöÑ‰∏Ä‰∏™Â∫èÂàóÂÄº„ÄÇ ÊµèËßàÂô®Á¨¨‰∫åÊ¨°ËØ∑Ê±Ç‰∏äÊ¨°ËØ∑Ê±ÇËøáÁöÑurlÊó∂ÔºåÊµèËßàÂô®‰ºöÂú®HTTPËØ∑Ê±ÇÂ§¥Ê∑ªÂä†‰∏Ä‰∏™If-None-MatchÁöÑÊ†áËÆ∞ÔºåÁî®Êù•ËØ¢ÈóÆÊúçÂä°Âô®ËØ•Êñá‰ª∂ÊúâÊ≤°ÊúâË¢´‰øÆÊîπ„ÄÇ Etag ‰∏ªË¶Å‰∏∫‰∫ÜËß£ÂÜ≥ Last-Modified Êó†Ê≥ïËß£ÂÜ≥ÁöÑ‰∏Ä‰∫õÈóÆÈ¢ò: 1„ÄÅ‰∏Ä‰∫õÊñá‰ª∂‰πüËÆ∏‰ºöÂë®ÊúüÊÄßÁöÑÊõ¥ÊîπÔºå‰ΩÜÊòØ‰ªñÁöÑÂÜÖÂÆπÂπ∂‰∏çÊîπÂèò(‰ªÖ‰ªÖÊîπÂèòÁöÑ‰øÆÊîπÊó∂Èó¥)ÔºåËøô‰∏™Êó∂ÂÄôÊàë‰ª¨Âπ∂‰∏çÂ∏åÊúõÂÆ¢Êà∑Á´ØËÆ§‰∏∫Ëøô‰∏™Êñá‰ª∂Ë¢´‰øÆÊîπ‰∫ÜÔºåËÄåÈáçÊñ∞GET; 2„ÄÅÊüê‰∫õÊñá‰ª∂‰øÆÊîπÈùûÂ∏∏È¢ëÁπÅÔºåÊØîÂ¶ÇÂú®Áßí‰ª•‰∏ãÁöÑÊó∂Èó¥ÂÜÖËøõË°å‰øÆÊîπÔºå(ÊØîÊñπËØ¥1sÂÜÖ‰øÆÊîπ‰∫ÜNÊ¨°)ÔºåIf-Modified-SinceËÉΩÊ£ÄÊü•Âà∞ÁöÑÁ≤íÂ∫¶ÊòØsÁ∫ßÁöÑÔºåËøôÁßç‰øÆÊîπÊó†Ê≥ïÂà§Êñ≠(ÊàñËÄÖËØ¥UNIXËÆ∞ÂΩïMTIMEÂè™ËÉΩÁ≤æÁ°ÆÂà∞Áßí) 3„ÄÅÊüê‰∫õÊúçÂä°Âô®‰∏çËÉΩÁ≤æÁ°ÆÁöÑÂæóÂà∞Êñá‰ª∂ÁöÑÊúÄÂêé‰øÆÊîπÊó∂Èó¥Ôºõ Expires1&lt;meta http-equiv="expires" content="Fri, 22 Aug 2014 00:52:49 GMT" /&gt; HTTP 1.0ÔºåËÆæÁΩÆÁºìÂ≠òÁöÑÊà™Ê≠¢Êó∂Èó¥ÔºåÂú®Ê≠§‰πãÂâçÔºåÊµèËßàÂô®ÂØπÁºìÂ≠òÁöÑÊï∞ÊçÆ‰∏çÈáçÊñ∞ÂèëËØ∑Ê±Ç„ÄÇÂÆÉ‰∏éLast-Modified/EtagÁªìÂêà‰ΩøÁî®ÔºåÁî®Êù•ÊéßÂà∂ËØ∑Ê±ÇÊñá‰ª∂ÁöÑÊúâÊïàÊó∂Èó¥ÔºåÂΩìËØ∑Ê±ÇÊï∞ÊçÆÂú®ÊúâÊïàÊúüÂÜÖÔºåÊµèËßàÂô®‰ªéÁºìÂ≠òËé∑ÂæóÊï∞ÊçÆ„ÄÇLast-Modifed/EtagËÉΩÂ§üËäÇÁúÅ‰∏ÄÁÇπÂÆΩÂ∏¶Ôºå‰ΩÜÊòØËøò‰ºöÂèë‰∏Ä‰∏™HTTPËØ∑Ê±Ç„ÄÇ Catch-Control12&lt;!--Cache-Control: max-age=Áßí --&gt;&lt;meta http-equiv="Cache-Control" content="max-age=120"/&gt; HTTP 1.1ÔºåËÆæÁΩÆËµÑÊ∫êÂú®Êú¨Âú∞ÁºìÂ≠òÂ§öÈïøÊó∂Èó¥„ÄÇ Â¶ÇÊûúCache-Control‰∏éexpiresÂêåÊó∂Â≠òÂú®ÔºåCache-ControlÁîüÊïà„ÄÇexpires ÁöÑ‰∏Ä‰∏™Áº∫ÁÇπÂ∞±ÊòØÔºåËøîÂõûÁöÑÂà∞ÊúüÊó∂Èó¥ÊòØÊúçÂä°Âô®Á´ØÁöÑÊó∂Èó¥ÔºåËøôÊ†∑Â≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÁöÑÊó∂Èó¥‰∏éÊúçÂä°Âô®ÁöÑÊó∂Èó¥Áõ∏Â∑ÆÂæàÂ§ßÔºåÈÇ£‰πàËØØÂ∑ÆÂ∞±ÂæàÂ§ßÔºåÊâÄ‰ª•Âú®HTTP 1.1ÁâàÂºÄÂßãÔºå‰ΩøÁî®Cache-Control: max-age=ÁßíÊõø‰ª£„ÄÇ Áî®Êà∑Êìç‰Ωú‰∏éÁºìÂ≠ò Á¶ÅÊ≠¢ÁºìÂ≠ò12345&lt;!--Á¶ÅÊ≠¢ÊµèËßàÂô®Êú¨Âú∞ÁºìÂ≠ò --&gt;&lt;meta http-equiv="Cache-Control" content="no-cache"/&gt;&lt;!-- ÊàñËÄÖ --&gt;&lt;meta http-equiv="Cache-Control" content="max-age=0"/&gt; ËøòÊúâPOSTËØ∑Ê±Ç‰∏ç‰ΩøÁî®ÁºìÂ≠òÔºåHTTPÂìçÂ∫îÂ§¥‰∏çÂåÖÂê´Last-Modified/EtagÔºå‰πü‰∏çÂåÖÂê´Cache-Control/Expires‰∏ç‰ºö‰ΩøÁî®ÁºìÂ≠ò„ÄÇ Èô§ÈùûÊúâÁâπÊÆäÈúÄÊ±ÇÔºåÊúÄÂ•ΩËøòÊòØ‰∏çË¶ÅÁ¶ÅÁî®ÁºìÂ≠òÔºåÊØïÁ´üÊòØÁî®ÁºìÂ≠òËÉΩËäÇÁúÅÂÆΩÂ∏¶ÔºåËäÇÁúÅÊúçÂä°Âô®ËµÑÊ∫êÔºåËäÇÁúÅmoney‚Ä¶ ÊµèËßàÂô®Á¨¨‰∏ÄÊ¨°ËØ∑Ê±ÇËøáÁ®ã ÊµèËßàÂô®Á¨¨‰∫åÊ¨°ËØ∑Ê±ÇËøáÁ®ã Êàë‰ª¨Â∏åÊúõÊúçÂä°Âô®Á´ØÊõ¥Êñ∞‰∫ÜÊñá‰ª∂ÔºåÂÆ¢Êà∑Á´ØÂèØ‰ª•ÂèäÊó∂ÁöÑÊõ¥Êñ∞Êñá‰ª∂ÔºåÊ†πÂÖ∑‰∏äÈù¢ÊµÅÁ®ãÔºåÊàë‰ª¨ÈúÄË¶ÅÈíàÂØπÈùôÊÄÅÊñá‰ª∂ÁöÑÂìçÂ∫îÂ§¥Ê∑ªÂä†expiresÔºåËÆæÁΩÆ‰∏∫Ê∞∏‰πÖËøáÊúüÔºåÊµèËßàÂô®ÊØèÊ¨°ËØ∑Ê±ÇÈùôÊÄÅÊñá‰ª∂ÔºåÂ∞±‰ºöËØ¢ÈóÆÊúçÂä°Âô®Êñá‰ª∂ÊúâÊ≤°ÊúâÂÅöËøáÊõ¥ÊîπÔºåÂ¶ÇÊûúÊõ¥Êîπ‰∫ÜÂ∞±‰ªéÊúçÂä°Âô®Á´ØËé∑ÂèñËµÑÊ∫êÔºåÂê¶ÂàôÁõ¥Êé•‰ΩøÁî®ÁºìÂ≠ò„ÄÇ apacheÁöÑÈÖçÁΩÆÔºö;) 1234567891011121314#ÂºÄÂêØmod_expiresÊ®°ÂùóLoadModule expires_module modules/mod_expires.soExpiresActive OnExpiresDefault "access plus 0 seconds" #ÈªòËÆ§ÁºìÂ≠ò0s&lt;Directory "Ê†πÁõÆÂΩï"&gt; #Options FollowSymLinks #AllowOverride all Order deny,allow Allow from all #ExpiresByType application/* "access plus 0 seconds" #ExpiresByType image/* "access plus 0 seconds" #ExpiresByType text/css "access plus 0 seconds"&lt;/Directory&gt; ;) ËøôÊ†∑ÁöÑÂÅöÊ≥ïÊúâ‰∏™ÂºäÁ´ØÔºåÂ∞±ÊòØÊØèÊ¨°ËØ∑Ê±ÇÈÉΩ‰ºöËØ¢ÈóÆÊúçÂä°Âô®Á´ØËµÑÊ∫êÊòØÂê¶ËøáÊúüÔºåÂΩìÁÑ∂ËøòÊúâÊõ¥Â•ΩÁöÑÂäûÊ≥ï„ÄÇ ÂèÇËÄÉÈìæÊé•Expires„ÄÅLast-Modified„ÄÅEtagÁºìÂ≠òÊéßÂà∂ ÊµèËßàÂô®ÁºìÂ≠ò‰πãExpires Etag Last-Modified max-ageËØ¶Ëß£]]></content>
      <categories>
        <category>ÂâçÁ´Ø</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Â∫èÂàóÂåñ‰πãserialVersionUID]]></title>
    <url>%2F2018%2F12%2F25%2F%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BserialVersionUID%2F</url>
    <content type="text"><![CDATA[serialVersionUIDserialVersionUIDÊòØÁî®Êù•È™åËØÅÁâàÊú¨‰∏ÄËá¥ÊÄßÁöÑ„ÄÇÊâÄ‰ª•Âú®ÂÅöÂÖºÂÆπÊÄßÂçáÁ∫ßÁöÑÊó∂ÂÄôÔºå‰∏çË¶ÅÊîπÂèòÁ±ª‰∏≠serialVersionUIDÁöÑÂÄº„ÄÇ Âº∫Ë∞É‰∏Ä‰∏ãÔºöserialVersionUID Êó¢ÁÑ∂ÊòØÈ™åËØÅÁâàÊú¨‰∏ÄËá¥ÊÄßÁöÑÔºåÂú®ÂÅöÁâàÊú¨ÂçáÁ∫ßÁöÑÊó∂ÂÄôÔºàÈùûÂÖºÂÆπÊÄßÂçáÁ∫ßÔºâÔºåËÆ∞ÂæóË¶Å‰øÆÊîπËøô‰∏™Â≠óÊÆµÁöÑÂÄºÂì¶ÔºåËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÂ∫èÂàóÂåñÊ∑∑‰π±„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Á±ªÂÆûÁé∞‰∫ÜSerializableÊé•Âè£Ôºå‰∏ÄÂÆöË¶ÅËÆ∞ÂæóÂÆö‰πâserialVersionUIDÔºåÂê¶Âàô‰ºöÂèëÁîüÂºÇÂ∏∏„ÄÇÂèØ‰ª•Âú®IDE‰∏≠ÈÄöËøáËÆæÁΩÆÔºåËÆ©‰ªñÂ∏ÆÂøôÊèêÁ§∫ÔºåÂπ∂‰∏îÂèØ‰ª•‰∏ÄÈîÆÂø´ÈÄüÁîüÊàê‰∏Ä‰∏™ serialVersionUID„ÄÇ ‰πãÊâÄ‰ª•‰ºöÂèëÁîüÂºÇÂ∏∏ÔºåÊòØÂõ†‰∏∫ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠ÂÅö‰∫ÜÊ†°È™åÔºåÂπ∂‰∏îÂ¶ÇÊûúÊ≤°ÊúâÊòéÁ°ÆÂÆö‰πâÁöÑËØùÔºå‰ºöÊ†πÊçÆÁ±ªÂêçÂèäÂ±ûÊÄßÁ≠âËá™Âä®ÁîüÊàê‰∏Ä‰∏™„ÄÇ ExternalizableJava‰∏≠ËøòÊèê‰æõ‰∫ÜExternalizableÊé•Âè£Ôºå‰πüÂèØ‰ª•ÂÆûÁé∞ÂÆÉÊù•Êèê‰æõÂ∫èÂàóÂåñËÉΩÂäõ„ÄÇ ExternalizableÁªßÊâøËá™SerializableÔºåËØ•Êé•Âè£‰∏≠ÂÆö‰πâ‰∫Ü‰∏§‰∏™ÊäΩË±°ÊñπÊ≥ïÔºö writeExternal()‰∏éreadExternal()„ÄÇ ÂΩì‰ΩøÁî®ExternalizableÊé•Âè£Êù•ËøõË°åÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÈúÄË¶ÅÂºÄÂèë‰∫∫ÂëòÈáçÂÜô writeExternal()‰∏éreadExternal()ÊñπÊ≥ï„ÄÇÂê¶ÂàôÊâÄÊúâÂèòÈáèÁöÑÂÄºÈÉΩ‰ºöÂèòÊàêÈªòËÆ§ÂÄº„ÄÇ transienttransient ÂÖ≥ÈîÆÂ≠óÁöÑ‰ΩúÁî®ÊòØÊéßÂà∂ÂèòÈáèÁöÑÂ∫èÂàóÂåñÔºåÂú®ÂèòÈáèÂ£∞ÊòéÂâçÂä†‰∏äËØ•ÂÖ≥ÈîÆÂ≠óÔºåÂèØ‰ª•ÈòªÊ≠¢ËØ•ÂèòÈáèË¢´Â∫èÂàóÂåñÂà∞Êñá‰ª∂‰∏≠ÔºåÂú®Ë¢´ÂèçÂ∫èÂàóÂåñÂêéÔºå transient ÂèòÈáèÁöÑÂÄºË¢´ËÆæ‰∏∫ÂàùÂßãÂÄºÔºåÂ¶Ç int ÂûãÁöÑÊòØ 0ÔºåÂØπË±°ÂûãÁöÑÊòØ null„ÄÇ ÂèÇËÄÉ‰∏∫‰ªÄ‰πàÈòøÈáåÂ∑¥Â∑¥Ë¶ÅÊ±ÇÁ®ãÂ∫èÂëòË∞®ÊÖé‰øÆÊîπserialVersionUID JavaÂØπË±°ÁöÑÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñ ‰Ω†ÁúüÁöÑ‰ª•‰∏∫‰Ω†‰∫ÜËß£JavaÁöÑÂ∫èÂàóÂåñ‰∫ÜÂêóÔºü]]></content>
      <tags>
        <tag>java</tag>
        <tag>Â∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQLÊÄßËÉΩ‰ºòÂåñÂ∏∏Áî®ÊñπÊ≥ï]]></title>
    <url>%2F2018%2F12%2F17%2FMySQL%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÈóÆÈ¢òÂÆö‰Ωç1234show process_list;-- Êü•ÁúãÊâßË°åËÆ°Âàíshow sql -&gt; explain; Êü•ÁúãÈîÅÁä∂ÊÄÅ1234-- Ë°®Á∫ßÈîÅÁöÑ‰∫âÁî®Áä∂ÊÄÅÂèòÈáèshow status like 'table%';-- Ë°åÁ∫ßÈîÅ‰∫âÁî®Áä∂ÊÄÅÂèòÈáèshow status like 'innodb_row_lock%'; ÈîÅË°® readÈîÅÔºåÂç≥ÂÖ±‰∫´ÈîÅ 1234lock table user use read;-- Ëß£ÈîÅunlock tables; writeÈîÅÔºåÊéí‰ªñÈîÅ 1234lock table user use write;-- Ëß£ÈîÅunlock tables; Innodb ÊîØÊåÅË°®ÈîÅÂíåË°åÈîÅ * Myisam Âè™ÊîØÊåÅË°®ÈîÅ Ë°åÈîÅÁº∫ÁÇπ: Ë°åÁ∫ßÈîÅÂÆπÊòìÈÄ†ÊàêÊ≠ªÈîÅ Ë°®ÈîÅÁº∫ÁÇπÔºö ÈîÅÁöÑÁ≤íÂ∫¶Â§™Â§ßÔºåÂπ∂ÂèëÂ∫¶‰∏çÈ´ò Profiling12345set profiling=1;select nick_name ,count(*) from user group by nick_name;show profiles;-- Êü•ÁúãÊâßË°åËÆ°ÂàíÁöÑÂêÑ‰∏™ÁéØËäÇËÄóÊó∂show profile cpu,block io for query 75; join_buffer_sizeÂ≠òÂú®2Âº†Ë°®‰ª•‰∏äÁöÑÊó∂ÂÄôÔºåÂ≠òÂú®‰∏Ä‰∏™join_bufferÂå∫ 1show variables like 'join_%'; sort_bufferÊ†πÊçÆsort_buffer sizeÂ§ßÂ∞èÔºåbufferÂèØ‰ª•ÈÄâÊã©ÊîæselectÁöÑÂÖ®ÈÉ®Â≠óÊÆµÔºåÁ©∫Èó¥Êç¢Êó∂Èó¥ÔºåÊü•ËØ¢Êõ¥Âø´„ÄÇÂè¶Â§ñ‰∏ÄÁßçÔºåÂè™Â≠òorder byÁöÑÂ≠óÊÆµÂíåÊåáÈíà„ÄÇ 1show variables like '%sort%'; ÂèÇËÄÉÁæéÂõ¢Á¥¢Âºï‰ºòÂåñ https://blog.csdn.net/zhanghongzheng3213/article/details/51722506 MySQLÂÆòÊñπexplainÊñáÊ°£https://dev.mysql.com/doc/refman/5.5/en/explain-output.html gupao-ÊÄßËÉΩ‰ºòÂåñMysqlÁØá.pdf]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ë∑®ÂüüËµÑÊ∫êÂÖ±‰∫´CORSËØ¶Ëß£]]></title>
    <url>%2F2018%2F11%2F30%2F%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%ABCORS%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[CORSÊòØ‰∏Ä‰∏™W3CÊ†áÂáÜÔºåÂÖ®Áß∞ÊòØ‚ÄùË∑®ÂüüËµÑÊ∫êÂÖ±‰∫´‚ÄùÔºàCross-origin resource sharingÔºâ„ÄÇ ÂÆÉÂÖÅËÆ∏ÊµèËßàÂô®ÂêëË∑®Ê∫êÊúçÂä°Âô®ÔºåÂèëÂá∫XMLHttpRequestËØ∑Ê±ÇÔºå‰ªéËÄåÂÖãÊúç‰∫ÜAJAXÂè™ËÉΩÂêåÊ∫ê‰ΩøÁî®ÁöÑÈôêÂà∂„ÄÇ Êú¨ÊñáËØ¶ÁªÜ‰ªãÁªçCORSÁöÑÂÜÖÈÉ®Êú∫Âà∂„ÄÇ ‰∏Ä„ÄÅÁÆÄ‰ªãCORSÈúÄË¶ÅÊµèËßàÂô®ÂíåÊúçÂä°Âô®ÂêåÊó∂ÊîØÊåÅ„ÄÇÁõÆÂâçÔºåÊâÄÊúâÊµèËßàÂô®ÈÉΩÊîØÊåÅËØ•ÂäüËÉΩÔºåIEÊµèËßàÂô®‰∏çËÉΩ‰Ωé‰∫éIE10„ÄÇ Êï¥‰∏™CORSÈÄö‰ø°ËøáÁ®ãÔºåÈÉΩÊòØÊµèËßàÂô®Ëá™Âä®ÂÆåÊàêÔºå‰∏çÈúÄË¶ÅÁî®Êà∑ÂèÇ‰∏é„ÄÇÂØπ‰∫éÂºÄÂèëËÄÖÊù•ËØ¥ÔºåCORSÈÄö‰ø°‰∏éÂêåÊ∫êÁöÑAJAXÈÄö‰ø°Ê≤°ÊúâÂ∑ÆÂà´Ôºå‰ª£Á†ÅÂÆåÂÖ®‰∏ÄÊ†∑„ÄÇÊµèËßàÂô®‰∏ÄÊó¶ÂèëÁé∞AJAXËØ∑Ê±ÇË∑®Ê∫êÔºåÂ∞±‰ºöËá™Âä®Ê∑ªÂä†‰∏Ä‰∫õÈôÑÂä†ÁöÑÂ§¥‰ø°ÊÅØÔºåÊúâÊó∂Ëøò‰ºöÂ§öÂá∫‰∏ÄÊ¨°ÈôÑÂä†ÁöÑËØ∑Ê±ÇÔºå‰ΩÜÁî®Êà∑‰∏ç‰ºöÊúâÊÑüËßâ„ÄÇ Âõ†Ê≠§ÔºåÂÆûÁé∞CORSÈÄö‰ø°ÁöÑÂÖ≥ÈîÆÊòØÊúçÂä°Âô®„ÄÇÂè™Ë¶ÅÊúçÂä°Âô®ÂÆûÁé∞‰∫ÜCORSÊé•Âè£ÔºåÂ∞±ÂèØ‰ª•Ë∑®Ê∫êÈÄö‰ø°„ÄÇ ‰∫å„ÄÅ‰∏§ÁßçËØ∑Ê±ÇÊµèËßàÂô®Â∞ÜCORSËØ∑Ê±ÇÂàÜÊàê‰∏§Á±ªÔºöÁÆÄÂçïËØ∑Ê±ÇÔºàsimple requestÔºâÂíåÈùûÁÆÄÂçïËØ∑Ê±ÇÔºànot-so-simple requestÔºâ„ÄÇ Âè™Ë¶ÅÂêåÊó∂Êª°Ë∂≥‰ª•‰∏ã‰∏§Â§ßÊù°‰ª∂ÔºåÂ∞±Â±û‰∫éÁÆÄÂçïËØ∑Ê±Ç„ÄÇ Ôºà1) ËØ∑Ê±ÇÊñπÊ≥ïÊòØ‰ª•‰∏ã‰∏âÁßçÊñπÊ≥ï‰πã‰∏ÄÔºö HEAD GET POST Ôºà2ÔºâHTTPÁöÑÂ§¥‰ø°ÊÅØ‰∏çË∂ÖÂá∫‰ª•‰∏ãÂá†ÁßçÂ≠óÊÆµÔºö Accept Accept-Language Content-Language Last-Event-ID Content-TypeÔºöÂè™Èôê‰∫é‰∏â‰∏™ÂÄºapplication/x-www-form-urlencoded„ÄÅmultipart/form-data„ÄÅtext/plain Âá°ÊòØ‰∏çÂêåÊó∂Êª°Ë∂≥‰∏äÈù¢‰∏§‰∏™Êù°‰ª∂ÔºåÂ∞±Â±û‰∫éÈùûÁÆÄÂçïËØ∑Ê±Ç„ÄÇ ÊµèËßàÂô®ÂØπËøô‰∏§ÁßçËØ∑Ê±ÇÁöÑÂ§ÑÁêÜÔºåÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇ ‰∏â„ÄÅÁÆÄÂçïËØ∑Ê±Ç3.1 Âü∫Êú¨ÊµÅÁ®ãÂØπ‰∫éÁÆÄÂçïËØ∑Ê±ÇÔºåÊµèËßàÂô®Áõ¥Êé•ÂèëÂá∫CORSËØ∑Ê±Ç„ÄÇÂÖ∑‰ΩìÊù•ËØ¥ÔºåÂ∞±ÊòØÂú®Â§¥‰ø°ÊÅØ‰πã‰∏≠ÔºåÂ¢ûÂä†‰∏Ä‰∏™OriginÂ≠óÊÆµ„ÄÇ ‰∏ãÈù¢ÊòØ‰∏Ä‰∏™‰æãÂ≠êÔºåÊµèËßàÂô®ÂèëÁé∞ËøôÊ¨°Ë∑®Ê∫êAJAXËØ∑Ê±ÇÊòØÁÆÄÂçïËØ∑Ê±ÇÔºåÂ∞±Ëá™Âä®Âú®Â§¥‰ø°ÊÅØ‰πã‰∏≠ÔºåÊ∑ªÂä†‰∏Ä‰∏™OriginÂ≠óÊÆµ„ÄÇ 1234567&gt; GET /cors HTTP/1.1&gt; Origin: http://api.bob.com&gt; Host: api.alice.com&gt; Accept-Language: en-US&gt; Connection: keep-alive&gt; User-Agent: Mozilla/5.0...&gt; ‰∏äÈù¢ÁöÑÂ§¥‰ø°ÊÅØ‰∏≠ÔºåOriginÂ≠óÊÆµÁî®Êù•ËØ¥ÊòéÔºåÊú¨Ê¨°ËØ∑Ê±ÇÊù•Ëá™Âì™‰∏™Ê∫êÔºàÂçèËÆÆ + ÂüüÂêç + Á´ØÂè£Ôºâ„ÄÇÊúçÂä°Âô®Ê†πÊçÆËøô‰∏™ÂÄºÔºåÂÜ≥ÂÆöÊòØÂê¶ÂêåÊÑèËøôÊ¨°ËØ∑Ê±Ç„ÄÇ Â¶ÇÊûúOriginÊåáÂÆöÁöÑÊ∫êÔºå‰∏çÂú®ËÆ∏ÂèØËåÉÂõ¥ÂÜÖÔºåÊúçÂä°Âô®‰ºöËøîÂõû‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑHTTPÂõûÂ∫î„ÄÇÊµèËßàÂô®ÂèëÁé∞ÔºåËøô‰∏™ÂõûÂ∫îÁöÑÂ§¥‰ø°ÊÅØÊ≤°ÊúâÂåÖÂê´Access-Control-Allow-OriginÂ≠óÊÆµÔºàËØ¶ËßÅ‰∏ãÊñáÔºâÔºåÂ∞±Áü•ÈÅìÂá∫Èîô‰∫ÜÔºå‰ªéËÄåÊäõÂá∫‰∏Ä‰∏™ÈîôËØØÔºåË¢´XMLHttpRequestÁöÑonerrorÂõûË∞ÉÂáΩÊï∞ÊçïËé∑„ÄÇÊ≥®ÊÑèÔºåËøôÁßçÈîôËØØÊó†Ê≥ïÈÄöËøáÁä∂ÊÄÅÁ†ÅËØÜÂà´ÔºåÂõ†‰∏∫HTTPÂõûÂ∫îÁöÑÁä∂ÊÄÅÁ†ÅÊúâÂèØËÉΩÊòØ200„ÄÇ Â¶ÇÊûúOriginÊåáÂÆöÁöÑÂüüÂêçÂú®ËÆ∏ÂèØËåÉÂõ¥ÂÜÖÔºåÊúçÂä°Âô®ËøîÂõûÁöÑÂìçÂ∫îÔºå‰ºöÂ§öÂá∫Âá†‰∏™Â§¥‰ø°ÊÅØÂ≠óÊÆµ„ÄÇ 12345&gt; Access-Control-Allow-Origin: http://api.bob.com&gt; Access-Control-Allow-Credentials: true&gt; Access-Control-Expose-Headers: FooBar&gt; Content-Type: text/html; charset=utf-8&gt; ‰∏äÈù¢ÁöÑÂ§¥‰ø°ÊÅØ‰πã‰∏≠ÔºåÊúâ‰∏â‰∏™‰∏éCORSËØ∑Ê±ÇÁõ∏ÂÖ≥ÁöÑÂ≠óÊÆµÔºåÈÉΩ‰ª•Access-Control-ÂºÄÂ§¥„ÄÇ Ôºà1ÔºâAccess-Control-Allow-Origin ËØ•Â≠óÊÆµÊòØÂøÖÈ°ªÁöÑ„ÄÇÂÆÉÁöÑÂÄºË¶Å‰πàÊòØËØ∑Ê±ÇÊó∂OriginÂ≠óÊÆµÁöÑÂÄºÔºåË¶Å‰πàÊòØ‰∏Ä‰∏™*ÔºåË°®Á§∫Êé•Âèó‰ªªÊÑèÂüüÂêçÁöÑËØ∑Ê±Ç„ÄÇ Ôºà2ÔºâAccess-Control-Allow-Credentials ËØ•Â≠óÊÆµÂèØÈÄâ„ÄÇÂÆÉÁöÑÂÄºÊòØ‰∏Ä‰∏™Â∏ÉÂ∞îÂÄºÔºåË°®Á§∫ÊòØÂê¶ÂÖÅËÆ∏ÂèëÈÄÅCookie„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåCookie‰∏çÂåÖÊã¨Âú®CORSËØ∑Ê±Ç‰πã‰∏≠„ÄÇËÆæ‰∏∫trueÔºåÂç≥Ë°®Á§∫ÊúçÂä°Âô®ÊòéÁ°ÆËÆ∏ÂèØÔºåCookieÂèØ‰ª•ÂåÖÂê´Âú®ËØ∑Ê±Ç‰∏≠Ôºå‰∏ÄËµ∑ÂèëÁªôÊúçÂä°Âô®„ÄÇËøô‰∏™ÂÄº‰πüÂè™ËÉΩËÆæ‰∏∫trueÔºåÂ¶ÇÊûúÊúçÂä°Âô®‰∏çË¶ÅÊµèËßàÂô®ÂèëÈÄÅCookieÔºåÂà†Èô§ËØ•Â≠óÊÆµÂç≥ÂèØ„ÄÇ Ôºà3ÔºâAccess-Control-Expose-Headers ËØ•Â≠óÊÆµÂèØÈÄâ„ÄÇCORSËØ∑Ê±ÇÊó∂ÔºåXMLHttpRequestÂØπË±°ÁöÑgetResponseHeader()ÊñπÊ≥ïÂè™ËÉΩÊãøÂà∞6‰∏™Âü∫Êú¨Â≠óÊÆµÔºöCache-Control„ÄÅContent-Language„ÄÅContent-Type„ÄÅExpires„ÄÅLast-Modified„ÄÅPragma„ÄÇÂ¶ÇÊûúÊÉ≥ÊãøÂà∞ÂÖ∂‰ªñÂ≠óÊÆµÔºåÂ∞±ÂøÖÈ°ªÂú®Access-Control-Expose-HeadersÈáåÈù¢ÊåáÂÆö„ÄÇ‰∏äÈù¢ÁöÑ‰æãÂ≠êÊåáÂÆöÔºågetResponseHeader(&#39;FooBar&#39;)ÂèØ‰ª•ËøîÂõûFooBarÂ≠óÊÆµÁöÑÂÄº„ÄÇ 3.2 withCredentials Â±ûÊÄß‰∏äÈù¢ËØ¥Âà∞ÔºåCORSËØ∑Ê±ÇÈªòËÆ§‰∏çÂèëÈÄÅCookieÂíåHTTPËÆ§ËØÅ‰ø°ÊÅØ„ÄÇÂ¶ÇÊûúË¶ÅÊääCookieÂèëÂà∞ÊúçÂä°Âô®Ôºå‰∏ÄÊñπÈù¢Ë¶ÅÊúçÂä°Âô®ÂêåÊÑèÔºåÊåáÂÆöAccess-Control-Allow-CredentialsÂ≠óÊÆµ„ÄÇ 12&gt; Access-Control-Allow-Credentials: true&gt; Âè¶‰∏ÄÊñπÈù¢ÔºåÂºÄÂèëËÄÖÂøÖÈ°ªÂú®AJAXËØ∑Ê±Ç‰∏≠ÊâìÂºÄwithCredentialsÂ±ûÊÄß„ÄÇ 123&gt; var xhr = new XMLHttpRequest();&gt; xhr.withCredentials = true;&gt; Âê¶ÂàôÔºåÂç≥‰ΩøÊúçÂä°Âô®ÂêåÊÑèÂèëÈÄÅCookieÔºåÊµèËßàÂô®‰πü‰∏ç‰ºöÂèëÈÄÅ„ÄÇÊàñËÄÖÔºåÊúçÂä°Âô®Ë¶ÅÊ±ÇËÆæÁΩÆCookieÔºåÊµèËßàÂô®‰πü‰∏ç‰ºöÂ§ÑÁêÜ„ÄÇ ‰ΩÜÊòØÔºåÂ¶ÇÊûúÁúÅÁï•withCredentialsËÆæÁΩÆÔºåÊúâÁöÑÊµèËßàÂô®ËøòÊòØ‰ºö‰∏ÄËµ∑ÂèëÈÄÅCookie„ÄÇËøôÊó∂ÔºåÂèØ‰ª•ÊòæÂºèÂÖ≥Èó≠withCredentials„ÄÇ 12&gt; xhr.withCredentials = false;&gt; ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûúË¶ÅÂèëÈÄÅCookieÔºåAccess-Control-Allow-OriginÂ∞±‰∏çËÉΩËÆæ‰∏∫ÊòüÂè∑ÔºåÂøÖÈ°ªÊåáÂÆöÊòéÁ°ÆÁöÑ„ÄÅ‰∏éËØ∑Ê±ÇÁΩëÈ°µ‰∏ÄËá¥ÁöÑÂüüÂêç„ÄÇÂêåÊó∂ÔºåCookie‰æùÁÑ∂ÈÅµÂæ™ÂêåÊ∫êÊîøÁ≠ñÔºåÂè™ÊúâÁî®ÊúçÂä°Âô®ÂüüÂêçËÆæÁΩÆÁöÑCookieÊâç‰ºö‰∏ä‰º†ÔºåÂÖ∂‰ªñÂüüÂêçÁöÑCookieÂπ∂‰∏ç‰ºö‰∏ä‰º†Ôºå‰∏îÔºàË∑®Ê∫êÔºâÂéüÁΩëÈ°µ‰ª£Á†Å‰∏≠ÁöÑdocument.cookie‰πüÊó†Ê≥ïËØªÂèñÊúçÂä°Âô®ÂüüÂêç‰∏ãÁöÑCookie„ÄÇ Âõõ„ÄÅÈùûÁÆÄÂçïËØ∑Ê±Ç4.1 È¢ÑÊ£ÄËØ∑Ê±ÇÈùûÁÆÄÂçïËØ∑Ê±ÇÊòØÈÇ£ÁßçÂØπÊúçÂä°Âô®ÊúâÁâπÊÆäË¶ÅÊ±ÇÁöÑËØ∑Ê±ÇÔºåÊØîÂ¶ÇËØ∑Ê±ÇÊñπÊ≥ïÊòØPUTÊàñDELETEÔºåÊàñËÄÖContent-TypeÂ≠óÊÆµÁöÑÁ±ªÂûãÊòØapplication/json„ÄÇ ÈùûÁÆÄÂçïËØ∑Ê±ÇÁöÑCORSËØ∑Ê±ÇÔºå‰ºöÂú®Ê≠£ÂºèÈÄö‰ø°‰πãÂâçÔºåÂ¢ûÂä†‰∏ÄÊ¨°HTTPÊü•ËØ¢ËØ∑Ê±ÇÔºåÁß∞‰∏∫‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÔºàpreflightÔºâ„ÄÇ ÊµèËßàÂô®ÂÖàËØ¢ÈóÆÊúçÂä°Âô®ÔºåÂΩìÂâçÁΩëÈ°µÊâÄÂú®ÁöÑÂüüÂêçÊòØÂê¶Âú®ÊúçÂä°Âô®ÁöÑËÆ∏ÂèØÂêçÂçï‰πã‰∏≠Ôºå‰ª•ÂèäÂèØ‰ª•‰ΩøÁî®Âì™‰∫õHTTPÂä®ËØçÂíåÂ§¥‰ø°ÊÅØÂ≠óÊÆµ„ÄÇÂè™ÊúâÂæóÂà∞ËÇØÂÆöÁ≠îÂ§çÔºåÊµèËßàÂô®Êâç‰ºöÂèëÂá∫Ê≠£ÂºèÁöÑXMLHttpRequestËØ∑Ê±ÇÔºåÂê¶ÂàôÂ∞±Êä•Èîô„ÄÇ ‰∏ãÈù¢ÊòØ‰∏ÄÊÆµÊµèËßàÂô®ÁöÑJavaScriptËÑöÊú¨„ÄÇ 123456&gt; var url = 'http://api.alice.com/cors';&gt; var xhr = new XMLHttpRequest();&gt; xhr.open('PUT', url, true);&gt; xhr.setRequestHeader('X-Custom-Header', 'value');&gt; xhr.send();&gt; ‰∏äÈù¢‰ª£Á†Å‰∏≠ÔºåHTTPËØ∑Ê±ÇÁöÑÊñπÊ≥ïÊòØPUTÔºåÂπ∂‰∏îÂèëÈÄÅ‰∏Ä‰∏™Ëá™ÂÆö‰πâÂ§¥‰ø°ÊÅØX-Custom-Header„ÄÇ ÊµèËßàÂô®ÂèëÁé∞ÔºåËøôÊòØ‰∏Ä‰∏™ÈùûÁÆÄÂçïËØ∑Ê±ÇÔºåÂ∞±Ëá™Âä®ÂèëÂá∫‰∏Ä‰∏™‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÔºåË¶ÅÊ±ÇÊúçÂä°Âô®Á°ÆËÆ§ÂèØ‰ª•ËøôÊ†∑ËØ∑Ê±Ç„ÄÇ‰∏ãÈù¢ÊòØËøô‰∏™‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÁöÑHTTPÂ§¥‰ø°ÊÅØ„ÄÇ 123456789&gt; OPTIONS /cors HTTP/1.1&gt; Origin: http://api.bob.com&gt; Access-Control-Request-Method: PUT&gt; Access-Control-Request-Headers: X-Custom-Header&gt; Host: api.alice.com&gt; Accept-Language: en-US&gt; Connection: keep-alive&gt; User-Agent: Mozilla/5.0...&gt; ‚ÄúÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÁî®ÁöÑËØ∑Ê±ÇÊñπÊ≥ïÊòØOPTIONSÔºåË°®Á§∫Ëøô‰∏™ËØ∑Ê±ÇÊòØÁî®Êù•ËØ¢ÈóÆÁöÑ„ÄÇÂ§¥‰ø°ÊÅØÈáåÈù¢ÔºåÂÖ≥ÈîÆÂ≠óÊÆµÊòØOriginÔºåË°®Á§∫ËØ∑Ê±ÇÊù•Ëá™Âì™‰∏™Ê∫ê„ÄÇ Èô§‰∫ÜOriginÂ≠óÊÆµÔºå‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÁöÑÂ§¥‰ø°ÊÅØÂåÖÊã¨‰∏§‰∏™ÁâπÊÆäÂ≠óÊÆµ„ÄÇ Ôºà1ÔºâAccess-Control-Request-Method ËØ•Â≠óÊÆµÊòØÂøÖÈ°ªÁöÑÔºåÁî®Êù•ÂàóÂá∫ÊµèËßàÂô®ÁöÑCORSËØ∑Ê±Ç‰ºöÁî®Âà∞Âì™‰∫õHTTPÊñπÊ≥ïÔºå‰∏ä‰æãÊòØPUT„ÄÇ Ôºà2ÔºâAccess-Control-Request-Headers ËØ•Â≠óÊÆµÊòØ‰∏Ä‰∏™ÈÄóÂè∑ÂàÜÈöîÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊåáÂÆöÊµèËßàÂô®CORSËØ∑Ê±Ç‰ºöÈ¢ùÂ§ñÂèëÈÄÅÁöÑÂ§¥‰ø°ÊÅØÂ≠óÊÆµÔºå‰∏ä‰æãÊòØX-Custom-Header„ÄÇ 4.2 È¢ÑÊ£ÄËØ∑Ê±ÇÁöÑÂõûÂ∫îÊúçÂä°Âô®Êî∂Âà∞‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±Ç‰ª•ÂêéÔºåÊ£ÄÊü•‰∫ÜOrigin„ÄÅAccess-Control-Request-MethodÂíåAccess-Control-Request-HeadersÂ≠óÊÆµ‰ª•ÂêéÔºåÁ°ÆËÆ§ÂÖÅËÆ∏Ë∑®Ê∫êËØ∑Ê±ÇÔºåÂ∞±ÂèØ‰ª•ÂÅöÂá∫ÂõûÂ∫î„ÄÇ 12345678910111213&gt; HTTP/1.1 200 OK&gt; Date: Mon, 01 Dec 2008 01:15:39 GMT&gt; Server: Apache/2.0.61 (Unix)&gt; Access-Control-Allow-Origin: http://api.bob.com&gt; Access-Control-Allow-Methods: GET, POST, PUT&gt; Access-Control-Allow-Headers: X-Custom-Header&gt; Content-Type: text/html; charset=utf-8&gt; Content-Encoding: gzip&gt; Content-Length: 0&gt; Keep-Alive: timeout=2, max=100&gt; Connection: Keep-Alive&gt; Content-Type: text/plain&gt; ‰∏äÈù¢ÁöÑHTTPÂõûÂ∫î‰∏≠ÔºåÂÖ≥ÈîÆÁöÑÊòØAccess-Control-Allow-OriginÂ≠óÊÆµÔºåË°®Á§∫http://api.bob.comÂèØ‰ª•ËØ∑Ê±ÇÊï∞ÊçÆ„ÄÇËØ•Â≠óÊÆµ‰πüÂèØ‰ª•ËÆæ‰∏∫ÊòüÂè∑ÔºåË°®Á§∫ÂêåÊÑè‰ªªÊÑèË∑®Ê∫êËØ∑Ê±Ç„ÄÇ 12&gt; Access-Control-Allow-Origin: *&gt; Â¶ÇÊûúÊµèËßàÂô®Âê¶ÂÆö‰∫Ü‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÔºå‰ºöËøîÂõû‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑHTTPÂõûÂ∫îÔºå‰ΩÜÊòØÊ≤°Êúâ‰ªª‰ΩïCORSÁõ∏ÂÖ≥ÁöÑÂ§¥‰ø°ÊÅØÂ≠óÊÆµ„ÄÇËøôÊó∂ÔºåÊµèËßàÂô®Â∞±‰ºöËÆ§ÂÆöÔºåÊúçÂä°Âô®‰∏çÂêåÊÑèÈ¢ÑÊ£ÄËØ∑Ê±ÇÔºåÂõ†Ê≠§Ëß¶Âèë‰∏Ä‰∏™ÈîôËØØÔºåË¢´XMLHttpRequestÂØπË±°ÁöÑonerrorÂõûË∞ÉÂáΩÊï∞ÊçïËé∑„ÄÇÊéßÂà∂Âè∞‰ºöÊâìÂç∞Âá∫Â¶Ç‰∏ãÁöÑÊä•Èîô‰ø°ÊÅØ„ÄÇ 123&gt; XMLHttpRequest cannot load http://api.alice.com.&gt; Origin http://api.bob.com is not allowed by Access-Control-Allow-Origin.&gt; ÊúçÂä°Âô®ÂõûÂ∫îÁöÑÂÖ∂‰ªñCORSÁõ∏ÂÖ≥Â≠óÊÆµÂ¶Ç‰∏ã„ÄÇ 12345&gt; Access-Control-Allow-Methods: GET, POST, PUT&gt; Access-Control-Allow-Headers: X-Custom-Header&gt; Access-Control-Allow-Credentials: true&gt; Access-Control-Max-Age: 1728000&gt; Ôºà1ÔºâAccess-Control-Allow-Methods ËØ•Â≠óÊÆµÂøÖÈúÄÔºåÂÆÉÁöÑÂÄºÊòØÈÄóÂè∑ÂàÜÈöîÁöÑ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåË°®ÊòéÊúçÂä°Âô®ÊîØÊåÅÁöÑÊâÄÊúâË∑®ÂüüËØ∑Ê±ÇÁöÑÊñπÊ≥ï„ÄÇÊ≥®ÊÑèÔºåËøîÂõûÁöÑÊòØÊâÄÊúâÊîØÊåÅÁöÑÊñπÊ≥ïÔºåËÄå‰∏çÂçïÊòØÊµèËßàÂô®ËØ∑Ê±ÇÁöÑÈÇ£‰∏™ÊñπÊ≥ï„ÄÇËøôÊòØ‰∏∫‰∫ÜÈÅøÂÖçÂ§öÊ¨°‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±Ç„ÄÇ Ôºà2ÔºâAccess-Control-Allow-Headers Â¶ÇÊûúÊµèËßàÂô®ËØ∑Ê±ÇÂåÖÊã¨Access-Control-Request-HeadersÂ≠óÊÆµÔºåÂàôAccess-Control-Allow-HeadersÂ≠óÊÆµÊòØÂøÖÈúÄÁöÑ„ÄÇÂÆÉ‰πüÊòØ‰∏Ä‰∏™ÈÄóÂè∑ÂàÜÈöîÁöÑÂ≠óÁ¨¶‰∏≤ÔºåË°®ÊòéÊúçÂä°Âô®ÊîØÊåÅÁöÑÊâÄÊúâÂ§¥‰ø°ÊÅØÂ≠óÊÆµÔºå‰∏çÈôê‰∫éÊµèËßàÂô®Âú®‚ÄùÈ¢ÑÊ£Ä‚Äù‰∏≠ËØ∑Ê±ÇÁöÑÂ≠óÊÆµ„ÄÇ Ôºà3ÔºâAccess-Control-Allow-Credentials ËØ•Â≠óÊÆµ‰∏éÁÆÄÂçïËØ∑Ê±ÇÊó∂ÁöÑÂê´‰πâÁõ∏Âêå„ÄÇ Ôºà4ÔºâAccess-Control-Max-Age ËØ•Â≠óÊÆµÂèØÈÄâÔºåÁî®Êù•ÊåáÂÆöÊú¨Ê¨°È¢ÑÊ£ÄËØ∑Ê±ÇÁöÑÊúâÊïàÊúüÔºåÂçï‰Ωç‰∏∫Áßí„ÄÇ‰∏äÈù¢ÁªìÊûú‰∏≠ÔºåÊúâÊïàÊúüÊòØ20Â§©Ôºà1728000ÁßíÔºâÔºåÂç≥ÂÖÅËÆ∏ÁºìÂ≠òËØ•Êù°ÂõûÂ∫î1728000ÁßíÔºàÂç≥20Â§©ÔºâÔºåÂú®Ê≠§ÊúüÈó¥Ôºå‰∏çÁî®ÂèëÂá∫Âè¶‰∏ÄÊù°È¢ÑÊ£ÄËØ∑Ê±Ç„ÄÇ 4.3 ÊµèËßàÂô®ÁöÑÊ≠£Â∏∏ËØ∑Ê±ÇÂíåÂõûÂ∫î‰∏ÄÊó¶ÊúçÂä°Âô®ÈÄöËøá‰∫Ü‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±ÇÔºå‰ª•ÂêéÊØèÊ¨°ÊµèËßàÂô®Ê≠£Â∏∏ÁöÑCORSËØ∑Ê±ÇÔºåÂ∞±ÈÉΩË∑üÁÆÄÂçïËØ∑Ê±Ç‰∏ÄÊ†∑Ôºå‰ºöÊúâ‰∏Ä‰∏™OriginÂ§¥‰ø°ÊÅØÂ≠óÊÆµ„ÄÇÊúçÂä°Âô®ÁöÑÂõûÂ∫îÔºå‰πüÈÉΩ‰ºöÊúâ‰∏Ä‰∏™Access-Control-Allow-OriginÂ§¥‰ø°ÊÅØÂ≠óÊÆµ„ÄÇ ‰∏ãÈù¢ÊòØ‚ÄùÈ¢ÑÊ£Ä‚ÄùËØ∑Ê±Ç‰πãÂêéÔºåÊµèËßàÂô®ÁöÑÊ≠£Â∏∏CORSËØ∑Ê±Ç„ÄÇ 12345678&gt; PUT /cors HTTP/1.1&gt; Origin: http://api.bob.com&gt; Host: api.alice.com&gt; X-Custom-Header: value&gt; Accept-Language: en-US&gt; Connection: keep-alive&gt; User-Agent: Mozilla/5.0...&gt; ‰∏äÈù¢Â§¥‰ø°ÊÅØÁöÑOriginÂ≠óÊÆµÊòØÊµèËßàÂô®Ëá™Âä®Ê∑ªÂä†ÁöÑ„ÄÇ ‰∏ãÈù¢ÊòØÊúçÂä°Âô®Ê≠£Â∏∏ÁöÑÂõûÂ∫î„ÄÇ 123&gt; Access-Control-Allow-Origin: http://api.bob.com&gt; Content-Type: text/html; charset=utf-8&gt; ‰∏äÈù¢Â§¥‰ø°ÊÅØ‰∏≠ÔºåAccess-Control-Allow-OriginÂ≠óÊÆµÊòØÊØèÊ¨°ÂõûÂ∫îÈÉΩÂøÖÂÆöÂåÖÂê´ÁöÑ„ÄÇ ‰∫î„ÄÅ‰∏éJSONPÁöÑÊØîËæÉCORS‰∏éJSONPÁöÑ‰ΩøÁî®ÁõÆÁöÑÁõ∏ÂêåÔºå‰ΩÜÊòØÊØîJSONPÊõ¥Âº∫Â§ß„ÄÇ JSONPÂè™ÊîØÊåÅGETËØ∑Ê±ÇÔºåCORSÊîØÊåÅÊâÄÊúâÁ±ªÂûãÁöÑHTTPËØ∑Ê±Ç„ÄÇJSONPÁöÑ‰ºòÂäøÂú®‰∫éÊîØÊåÅËÄÅÂºèÊµèËßàÂô®Ôºå‰ª•ÂèäÂèØ‰ª•Âêë‰∏çÊîØÊåÅCORSÁöÑÁΩëÁ´ôËØ∑Ê±ÇÊï∞ÊçÆ„ÄÇ]]></content>
      <categories>
        <category>ÂâçÁ´Ø</category>
      </categories>
      <tags>
        <tag>ÂâçÁ´ØË∑®Âüü</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot AbstractMessageConverterMethodProcessor]]></title>
    <url>%2F2018%2F11%2F16%2FSpring-Boot-AbstractMessageConverterMethodProcessor%2F</url>
    <content type="text"><![CDATA[writeWithMessageConvertersorg.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor#writeWithMessageConverters(T, org.springframework.core.MethodParameter, org.springframework.http.server.ServletServerHttpRequest, org.springframework.http.server.ServletServerHttpResponse) getAcceptableMediaTypesËé∑ÂèñÁöÑÊòØ ËØ∑Ê±ÇÂ§¥Accept‰∏≠ÁöÑMediaType getProducibleMediaTypesËé∑ÂèñÁöÑÊòØcontroller‰∏≠@ProducerÊ≥®Ëß£ÁöÑMediaTypeÔºåÂ¶ÇÊûú‰∏§ËÄÖ‰∏ç‰∏ÄËá¥ÔºåÊä•415ÈîôËØØ 12List&lt;MediaType&gt; requestedMediaTypes = getAcceptableMediaTypes(request);List&lt;MediaType&gt; producibleMediaTypes = getProducibleMediaTypes(request, valueType, declaredType); 123456RequestResponseBodyMethodProcessor extends AbstractMessageConverterMethodProcessorAbstractMessageConverterMethodProcessor extends AbstractMessageConverterMethodArgumentResolver implements HandlerMethodReturnValueHandlerAbstractMessageConverterMethodArgumentResolver implements HandlerMethodArgumentResolver]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[MySQLÊü•ÁúãÂíå‰øÆÊîπÂ≠óÁ¨¶ÈõÜÁöÑÊñπÊ≥ï]]></title>
    <url>%2F2018%2F11%2F15%2FMySQL%E6%9F%A5%E7%9C%8B%E5%92%8C%E4%BF%AE%E6%94%B9%E5%AD%97%E7%AC%A6%E9%9B%86%E7%9A%84%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[‰∏Ä„ÄÅÊü•ÁúãÂ≠óÁ¨¶ÈõÜ1.Êü•ÁúãMYSQLÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®ÂíåÊï∞ÊçÆÂ∫ìÂ≠óÁ¨¶ÈõÜ12ÊñπÊ≥ï‰∏ÄÔºöshow variables like '%character%';ÊñπÊ≥ï‰∫åÔºöshow variables like 'collation%'; 123456789mysql&gt; show variables like 'collation%';+----------------------+-----------------+| Variable_name | Value |+----------------------+-----------------+| collation_connection | utf8_general_ci || collation_database | utf8_general_ci || collation_server | utf8_general_ci |+----------------------+-----------------+rows in set (0.00 sec) 123456789mysql&gt; show variables like 'collation%';+----------------------+-----------------+| Variable_name | Value |+----------------------+-----------------+| collation_connection | utf8_general_ci || collation_database | utf8_general_ci || collation_server | utf8_general_ci |+----------------------+-----------------+3 rows in set (0.00 sec) 2.Êü•ÁúãMYSQLÊâÄÊîØÊåÅÁöÑÂ≠óÁ¨¶ÈõÜ1show charset; 123456789101112131415161718192021222324252627282930313233343536373839404142434445mysql&gt; show charset;+----------+-----------------------------+---------------------+--------+| Charset | Description | Default collation | Maxlen |+----------+-----------------------------+---------------------+--------+| big5 | Big5 Traditional Chinese | big5_chinese_ci | 2 || dec8 | DEC West European | dec8_swedish_ci | 1 || cp850 | DOS West European | cp850_general_ci | 1 || hp8 | HP West European | hp8_english_ci | 1 || koi8r | KOI8-R Relcom Russian | koi8r_general_ci | 1 || latin1 | cp1252 West European | latin1_swedish_ci | 1 || latin2 | ISO 8859-2 Central European | latin2_general_ci | 1 || swe7 | 7bit Swedish | swe7_swedish_ci | 1 || ascii | US ASCII | ascii_general_ci | 1 || ujis | EUC-JP Japanese | ujis_japanese_ci | 3 || sjis | Shift-JIS Japanese | sjis_japanese_ci | 2 || hebrew | ISO 8859-8 Hebrew | hebrew_general_ci | 1 || tis620 | TIS620 Thai | tis620_thai_ci | 1 || euckr | EUC-KR Korean | euckr_korean_ci | 2 || koi8u | KOI8-U Ukrainian | koi8u_general_ci | 1 || gb2312 | GB2312 Simplified Chinese | gb2312_chinese_ci | 2 || greek | ISO 8859-7 Greek | greek_general_ci | 1 || cp1250 | Windows Central European | cp1250_general_ci | 1 || gbk | GBK Simplified Chinese | gbk_chinese_ci | 2 || latin5 | ISO 8859-9 Turkish | latin5_turkish_ci | 1 || armscii8 | ARMSCII-8 Armenian | armscii8_general_ci | 1 || utf8 | UTF-8 Unicode | utf8_general_ci | 3 || ucs2 | UCS-2 Unicode | ucs2_general_ci | 2 || cp866 | DOS Russian | cp866_general_ci | 1 || keybcs2 | DOS Kamenicky Czech-Slovak | keybcs2_general_ci | 1 || macce | Mac Central European | macce_general_ci | 1 || macroman | Mac West European | macroman_general_ci | 1 || cp852 | DOS Central European | cp852_general_ci | 1 || latin7 | ISO 8859-13 Baltic | latin7_general_ci | 1 || utf8mb4 | UTF-8 Unicode | utf8mb4_general_ci | 4 || cp1251 | Windows Cyrillic | cp1251_general_ci | 1 || utf16 | UTF-16 Unicode | utf16_general_ci | 4 || cp1256 | Windows Arabic | cp1256_general_ci | 1 || cp1257 | Windows Baltic | cp1257_general_ci | 1 || utf32 | UTF-32 Unicode | utf32_general_ci | 4 || binary | Binary pseudo charset | binary | 1 || geostd8 | GEOSTD8 Georgian | geostd8_general_ci | 1 || cp932 | SJIS for Windows Japanese | cp932_japanese_ci | 2 || eucjpms | UJIS for Windows Japanese | eucjpms_japanese_ci | 3 |+----------+-----------------------------+---------------------+--------+39 rows in set (0.00 sec) 3.Êü•ÁúãÂ∫ìÁöÑÂ≠óÁ¨¶ÈõÜËØ≠Ê≥ïÔºöshow database status from Â∫ìÂêç like Ë°®Âêç; 12345mysql&gt; show create database shiyan\G*************************** 1. row *************************** Database: shiyanCreate Database: CREATE DATABASE `shiyan` /*!40100 DEFAULT CHARACTER SET gbk */1 row in set (0.00 sec) 4.Êü•ÁúãË°®ÁöÑÂ≠óÁ¨¶ÈõÜËØ≠Ê≥ïÔºöshow table status from Â∫ìÂêç like Ë°®Âêç; 1mysql&gt; show table status from class_7 like 'test_info'; 1234567mysql&gt; show table status from class_7 like 'test_info';+-----------+--------+---------+------------+------+----------------+-------------------------+-------------+------------+-----------------+----------+-| Name | Engine | Version | Row_format | Rows | Avg_row_length | Data_leate_time | Update_time | Check_time | Collation | Checksum |+-----------+--------+---------+------------+------+----------------+-------------------------+-------------+------------+-----------------+----------+-| test_info | InnoDB | 10 | Compact | 10 | 1638 | 17-12-05 19:01:55 | NULL | NULL | utf8_general_ci | NULL |+-----------+--------+---------+------------+------+----------------+-------------------------+-------------+------------+-----------------+----------+-1 row in set (0.00 sec) 5.Êü•ÁúãË°®‰∏≠ÊâÄÊúâÂàóÁöÑÂ≠óÁ¨¶ÈõÜËØ≠Ê≥ïÔºöshow full columns from Ë°®Âêç; 1mysql&gt; show full columns from test_info; 1234567891011mysql&gt; show full columns from test_info;+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+| Field | Type | Collation | Null | Key | Default | Extra | Privileges | Comment |+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+| id | int(3) | NULL | NO | PRI | NULL | | select,insert,update,references | || name | char(12) | utf8_general_ci | YES | | NULL | | select,insert,update,references | || dorm | char(10) | utf8_general_ci | YES | | NULL | | select,insert,update,references | || addr | char(12) | utf8_general_ci | YES | | Êú™Áü• | | select,insert,update,references | || score | int(3) | NULL | YES | | NULL | | select,insert,update,references | |+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+5 rows in set (0.00 sec) ‰∫å„ÄÅËÆæÁΩÆÂ≠óÁ¨¶ÈõÜËÆæÁΩÆÂ≠óÁ¨¶ÈõÜ‰∏ÄËà¨Êúâ‰∏§ÁßçÊñπÊ≥ïÔºå‰∏ÄÁßçÊòØÂú®ÂàõÂª∫Ë°®ÁöÑÊó∂ÂÄôËÆæÁΩÆÂ≠óÁ¨¶ÈõÜÔºåÂè¶‰∏ÄÁßçÊòØË°®Âª∫Êàê‰πãÂêé‰øÆÊîπÂ≠óÁ¨¶ÈõÜ„ÄÇ 1.ÂàõÂª∫Êó∂ÊåáÂÆöÂ≠óÁ¨¶ÈõÜÂàõÂª∫Â∫ìÁöÑÊó∂ÂÄôÊåáÂÆöÂ≠óÁ¨¶ÈõÜÔºö ËØ≠Ê≥ïÔºöcreate database Â∫ìÂêç default character set=Â≠óÁ¨¶ÈõÜÔºõ 1create database db2 default character set=utf8 ÂàõÂª∫Ë°®ÁöÑÊó∂ÂÄôÊåáÂÆöÂ≠óÁ¨¶ÈõÜÔºö ËØ≠Ê≥ïÔºöcreate table Ë°®ÂêçÔºàÂ±ûÊÄßÔºâdefault character set = Â≠óÁ¨¶ÈõÜÔºõ 12mysql&gt; create table test1(id int(6),name char(10)) default character set = 'gbk';Query OK, 0 rows affected (0.39 sec) 2.‰øÆÊîπÂ≠óÁ¨¶ÈõÜ‰øÆÊîπÂÖ®Â±ÄÂ≠óÁ¨¶ÈõÜ123456789101112131415161718/*Âª∫Á´ãËøûÊé•‰ΩøÁî®ÁöÑÁºñÁ†Å*/set character_set_connection=utf8;/*Êï∞ÊçÆÂ∫ìÁöÑÁºñÁ†Å*/set character_set_database=utf8;/*ÁªìÊûúÈõÜÁöÑÁºñÁ†Å*/set character_set_results=utf8;/*Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®ÁöÑÁºñÁ†Å*/set character_set_server=utf8;set character_set_system=utf8;set collation_connection=utf8;set collation_database=utf8;set collation_server=utf8;‰øÆÊîπÂÖ®Â±ÄÂ≠óÁ¨¶ÈõÜ ‰øÆÊîπÂ∫ìÁöÑÂ≠óÁ¨¶ÈõÜËØ≠Ê≥ïÔºöalter database Â∫ìÂêç default character set Â≠óÁ¨¶ÈõÜ; 1alter database shiyan default character set gbk; ‰øÆÊîπË°®ÁöÑÂ≠óÁ¨¶ÈõÜËØ≠Ê≥ïÔºöalter table Ë°®Âêç convert to character set Â≠óÁ¨¶ÈõÜ; 1alter table test1 convert to character set utf8; ‰øÆÊîπÂ≠óÊÆµÁöÑÂ≠óÁ¨¶ÈõÜËØ≠Ê≥ïÔºöalter table Ë°®Âêç modify Â≠óÊÆµÂêç Â≠óÊÆµÂ±ûÊÄß character set gbkÔºõ 1alter table test1 modify name char(10) character set gbk; 123456789101112131415161718192021mysql&gt; show full columns from test1;+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+| Field | Type | Collation | Null | Key | Default | Extra | Privileges | Comment |+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+| id | int(6) | NULL | YES | | NULL | | select,insert,update,references | || name | char(10) | utf8_general_ci | YES | | NULL | | select,insert,update,references | |+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+2 rows in set (0.01 sec)mysql&gt; alter table test1 modify name char(10) character set gbk;Query OK, 0 rows affected (0.58 sec)Records: 0 Duplicates: 0 Warnings: 0mysql&gt; show full columns from test1;+-------+----------+----------------+------+-----+---------+-------+---------------------------------+---------+| Field | Type | Collation | Null | Key | Default | Extra | Privileges | Comment |+-------+----------+----------------+------+-----+---------+-------+---------------------------------+---------+| id | int(6) | NULL | YES | | NULL | | select,insert,update,references | || name | char(10) | gbk_chinese_ci | YES | | NULL | | select,insert,update,references | |+-------+----------+----------------+------+-----+---------+-------+---------------------------------+---------+2 rows in set (0.01 sec) character setÂç≥Â≠óÁ¨¶ÈõÜ Êàë‰ª¨Â∏∏ÁúãÂà∞ÁöÑUTF-8„ÄÅGB2312„ÄÅGB18030ÈÉΩÊòØÁõ∏‰∫íÁã¨Á´ãÁöÑcharacter set„ÄÇÂç≥ÂØπUnicodeÁöÑ‰∏ÄÂ•óÁºñÁ†Å„ÄÇ collationÂç≥ÊØîÂØπÊñπÊ≥ï Áî®‰∫éÊåáÂÆöÊï∞ÊçÆÈõÜÂ¶Ç‰ΩïÊéíÂ∫èÔºå‰ª•ÂèäÂ≠óÁ¨¶‰∏≤ÁöÑÊØîÂØπËßÑÂàô„ÄÇ collationÂêçÂ≠óÁöÑËßÑÂàôÂèØ‰ª•ÂΩíÁ∫≥‰∏∫Ëøô‰∏§Á±ªÔºö _bin ‰æãÂ¶ÇÔºö utf8_danish_ci ciÊòØcase insensitiveÁöÑÁº©ÂÜôÔºåcsÊòØcase sensitiveÁöÑÁº©ÂÜô„ÄÇÂç≥ÔºåÊåáÂÆöÂ§ßÂ∞èÂÜôÊòØÂê¶ÊïèÊÑü„ÄÇ utf8_binÊòØÂ∞ÜÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÊØè‰∏Ä‰∏™Â≠óÁ¨¶Áî®‰∫åËøõÂà∂Êï∞ÊçÆÂ≠òÂÇ®ÔºåÂå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇ Â•áÊÄ™ÁöÑÊòØutf8Â≠óÁ¨¶ÈõÜÂØπÂ∫îÁöÑcollationÂ±ÖÁÑ∂Ê≤°Êúâ‰∏Ä‰∏™ÊòØcsÁöÑ„ÄÇ]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÊµÖË∞àspringMVC‰∏≠ÁöÑËÆæËÆ°Ê®°Âºè‚Äî‚ÄîÁªÑÂêàÊ®°Âºè]]></title>
    <url>%2F2018%2F11%2F09%2F%E6%B5%85%E8%B0%88springMVC%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ÂÆö‰πâÊÉØ‰æãÊàë‰ª¨ÂÖàÊù•Áúã‰∏ÄÁúãÁªÑÂêàÊ®°ÂºèÁöÑÂÆö‰πâÔºöÁªÑÂêàÊ®°ÂºèÔºåÂ∞ÜÂØπË±°ÁªÑÂêàÊàêÊ†ëÂΩ¢ÁªìÊûÑ‰ª•Ë°®Á§∫‚ÄúÈÉ®ÂàÜ-Êï¥‰Ωì‚ÄùÁöÑÂ±ÇÊ¨°ÁªìÊûÑÔºåÁªÑÂêàÊ®°Âºè‰ΩøÂæóÁî®Êà∑ÂØπÂçï‰∏™ÂØπË±°ÂíåÁªÑÂêàÂØπË±°ÁöÑ‰ΩøÁî®ÂÖ∑Êúâ‰∏ÄËá¥ÊÄß„ÄÇÈÄö‰øóÁöÑÊù•ËØ¥ÔºåÂ∞±ÊòØËÆ≤‰∏ÄÁ≥ªÂàóÁöÑÂØπË±°ÁªÑÂêàÂú®‰∏Ä‰∏™Êï¥‰ΩìÁöÑÂØπË±°‰∏≠ÔºåÁî®Êà∑Âú®ÂØπËøô‰∏™ÁªÑÂêàÂØπË±°Êìç‰Ωú‰ΩøÁî®Êó∂Â∞±ËÉΩË∑üÊìç‰Ωú‰∏Ä‰∏™ÂØπË±°‰∏ÄÊ†∑„ÄÇ WebMvcConfigurerComposite1. component -&gt; WebMvcConfigurerÊäΩË±°Êé•Âè£12345678public interface WebMvcConfigurer &#123;... default void addInterceptors(InterceptorRegistry registry) &#123; &#125;...&#125; 2. leaf ÂÖ∑‰ΩìÂÆûÁé∞ -&gt; Ëá™ÂÆö‰πâÂÆûÁé∞1234567891011121314151617@Beanpublic WebMvcConfigurer webMvcConfigurer()&#123; WebMvcConfigurer configurer = new WebMvcConfigurer() &#123; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new HandlerInterceptor() &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println("handlerÊâßË°åÂâç"); return true; &#125; &#125;); &#125; &#125;; return configurer;&#125; 3. compositeÂÆπÂô® -&gt; WebMvcConfigurerComposite@EnableWebMvc ‚Äã @Import(DelegatingWebMvcConfiguration.class) ‚Äã WebMvcConfigurerComposite Êú¨Ë∫´‰πüÂÆûÁé∞component WebMvcConfigurerÊé•Âè£ÔºåÂπ∂Â≠òÂú®List&lt;WebMvcConfigurer&gt; delegatesÔºåÂØπÊâÄÊúâÁöÑleafËøõË°åÁªü‰∏ÄÈÖçÁΩÆ 1234567891011121314151617181920class WebMvcConfigurerComposite implements WebMvcConfigurer &#123; private final List&lt;WebMvcConfigurer&gt; delegates = new ArrayList&lt;&gt;(); public void addWebMvcConfigurers(List&lt;WebMvcConfigurer&gt; configurers) &#123; if (!CollectionUtils.isEmpty(configurers)) &#123; this.delegates.addAll(configurers); &#125; &#125; @Override public void configurePathMatch(PathMatchConfigurer configurer) &#123; for (WebMvcConfigurer delegate : this.delegates) &#123; delegate.configurePathMatch(configurer); &#125; &#125; ...&#125;]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Â¶Ç‰Ωï‰øùËØÅÂæÆÊúçÂä°Êé•Âè£ÁöÑÂπÇÁ≠âÊÄß]]></title>
    <url>%2F2018%2F10%2F16%2F%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%B9%82%E7%AD%89%E6%80%A7%2F</url>
    <content type="text"><![CDATA[Âú®ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏ãÔºåÊàë‰ª¨Âú®ÂÆåÊàê‰∏Ä‰∏™ËÆ¢ÂçïÊµÅÁ®ãÊó∂ÁªèÂ∏∏ÈÅáÂà∞‰∏ãÈù¢ÁöÑÂú∫ÊôØÔºö ‰∏Ä‰∏™ËÆ¢ÂçïÂàõÂª∫Êé•Âè£ÔºåÁ¨¨‰∏ÄÊ¨°Ë∞ÉÁî®Ë∂ÖÊó∂‰∫ÜÔºåÁÑ∂ÂêéË∞ÉÁî®ÊñπÈáçËØï‰∫Ü‰∏ÄÊ¨° Âú®ËÆ¢ÂçïÂàõÂª∫Êó∂ÔºåÊàë‰ª¨ÈúÄË¶ÅÂéªÊâ£ÂáèÂ∫ìÂ≠òÔºåËøôÊó∂Êé•Âè£ÂèëÁîü‰∫ÜË∂ÖÊó∂ÔºåË∞ÉÁî®ÊñπÈáçËØï‰∫Ü‰∏ÄÊ¨° ÂΩìËøôÁ¨îËÆ¢ÂçïÂºÄÂßãÊîØ‰ªòÔºåÂú®ÊîØ‰ªòËØ∑Ê±ÇÂèëÂá∫‰πãÂêéÔºåÂú®ÊúçÂä°Á´ØÂèëÁîü‰∫ÜÊâ£Èí±Êìç‰ΩúÔºåÊé•Âè£ÂìçÂ∫îË∂ÖÊó∂‰∫ÜÔºåË∞ÉÁî®ÊñπÈáçËØï‰∫Ü‰∏ÄÊ¨° ‰∏Ä‰∏™ËÆ¢ÂçïÁä∂ÊÄÅÊõ¥Êñ∞Êé•Âè£ÔºåË∞ÉÁî®ÊñπËøûÁª≠ÂèëÈÄÅ‰∫Ü‰∏§‰∏™Ê∂àÊÅØÔºå‰∏Ä‰∏™ÊòØÂ∑≤ÂàõÂª∫Ôºå‰∏Ä‰∏™ÊòØÂ∑≤‰ªòÊ¨æ„ÄÇ‰ΩÜÊòØ‰Ω†ÂÖàÊé•Êî∂Âà∞Â∑≤‰ªòÊ¨æÔºåÁÑ∂ÂêéÂèàÊé•Êî∂Âà∞‰∫ÜÂ∑≤ÂàõÂª∫ Âú®ÊîØ‰ªòÂÆåÊàêËÆ¢Âçï‰πãÂêéÔºåÈúÄË¶ÅÂèëÈÄÅ‰∏ÄÊù°Áü≠‰ø°ÔºåÂΩì‰∏ÄÂè∞Êú∫Âô®Êé•Êî∂Âà∞Áü≠‰ø°ÂèëÈÄÅÁöÑÊ∂àÊÅØ‰πãÂêéÔºåÂ§ÑÁêÜËæÉÊÖ¢„ÄÇÊ∂àÊÅØ‰∏≠Èó¥‰ª∂ÂèàÊääÊ∂àÊÅØÊäïÈÄíÁªôÂè¶Â§ñ‰∏ÄÂè∞Êú∫Âô®Â§ÑÁêÜ ‰ª•‰∏äÈóÆÈ¢òÔºåÂ∞±ÊòØÂú®Âçï‰ΩìÊû∂ÊûÑËΩ¨ÊàêÂæÆÊúçÂä°Êû∂ÊûÑ‰πãÂêéÔºåÂ∏¶Êù•ÁöÑÈóÆÈ¢ò„ÄÇÂΩìÁÑ∂‰∏çÊòØËØ¥Âçï‰ΩìÊû∂ÊûÑ‰∏ãÊ≤°ÊúâËøô‰∫õÈóÆÈ¢òÔºåÂú®Âçï‰ΩìÊû∂ÊûÑ‰∏ãÂêåÊ†∑Ë¶ÅÈÅøÂÖçÈáçÂ§çËØ∑Ê±Ç„ÄÇ‰ΩÜÊòØÂá∫Áé∞ÁöÑÈóÆÈ¢òË¶ÅÊØîËøôÂ∞ëÂæóÂ§ö„ÄÇ ‰∏∫‰∫ÜËß£ÂÜ≥‰ª•‰∏äÈóÆÈ¢òÔºåÂ∞±ÈúÄË¶Å‰øùËØÅÊé•Âè£ÁöÑÂπÇÁ≠âÊÄßÔºåÊé•Âè£ÁöÑÂπÇÁ≠âÊÄßÂÆûÈôÖ‰∏äÂ∞±ÊòØÊé•Âè£ÂèØÈáçÂ§çË∞ÉÁî®ÔºåÂú®Ë∞ÉÁî®ÊñπÂ§öÊ¨°Ë∞ÉÁî®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊé•Âè£ÊúÄÁªàÂæóÂà∞ÁöÑÁªìÊûúÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÊúâ‰∫õÊé•Âè£ÂèØ‰ª•Â§©ÁÑ∂ÁöÑÂÆûÁé∞ÂπÇÁ≠âÊÄßÔºåÊØîÂ¶ÇÊü•ËØ¢Êé•Âè£ÔºåÂØπ‰∫éÊü•ËØ¢Êù•ËØ¥Ôºå‰Ω†Êü•ËØ¢‰∏ÄÊ¨°Âíå‰∏§Ê¨°ÔºåÂØπ‰∫éÁ≥ªÁªüÊù•ËØ¥ÔºåÊ≤°Êúâ‰ªª‰ΩïÂΩ±ÂìçÔºåÊü•Âá∫ÁöÑÁªìÊûú‰πüÊòØ‰∏ÄÊ†∑„ÄÇ Èô§‰∫ÜÊü•ËØ¢ÂäüËÉΩÂÖ∑ÊúâÂ§©ÁÑ∂ÁöÑÂπÇÁ≠âÊÄß‰πãÂ§ñÔºåÂ¢ûÂä†„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§ÈÉΩË¶Å‰øùËØÅÂπÇÁ≠âÊÄß„ÄÇÈÇ£‰πàÂ¶Ç‰ΩïÊù•‰øùËØÅÂπÇÁ≠âÊÄßÂë¢Ôºü ÂÖ®Â±ÄÂîØ‰∏ÄIDÂ¶ÇÊûú‰ΩøÁî®ÂÖ®Â±ÄÂîØ‰∏ÄIDÔºåÂ∞±ÊòØÊ†πÊçÆ‰∏öÂä°ÁöÑÊìç‰ΩúÂíåÂÜÖÂÆπÁîüÊàê‰∏Ä‰∏™ÂÖ®Â±ÄIDÔºåÂú®ÊâßË°åÊìç‰ΩúÂâçÂÖàÊ†πÊçÆËøô‰∏™ÂÖ®Â±ÄÂîØ‰∏ÄIDÊòØÂê¶Â≠òÂú®ÔºåÊù•Âà§Êñ≠Ëøô‰∏™Êìç‰ΩúÊòØÂê¶Â∑≤ÁªèÊâßË°å„ÄÇÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÊääÂÖ®Â±ÄIDÔºåÂ≠òÂÇ®Âà∞Â≠òÂÇ®Á≥ªÁªü‰∏≠ÔºåÊØîÂ¶ÇÊï∞ÊçÆÂ∫ì„ÄÅredisÁ≠â„ÄÇÂ¶ÇÊûúÂ≠òÂú®ÂàôË°®Á§∫ËØ•ÊñπÊ≥ïÂ∑≤ÁªèÊâßË°å„ÄÇ ‰ªéÂ∑•Á®ãÁöÑËßíÂ∫¶Êù•ËØ¥Ôºå‰ΩøÁî®ÂÖ®Â±ÄIDÂÅöÂπÇÁ≠âÂèØ‰ª•‰Ωú‰∏∫‰∏Ä‰∏™‰∏öÂä°ÁöÑÂü∫Á°ÄÁöÑÂæÆÊúçÂä°Â≠òÂú®ÔºåÂú®ÂæàÂ§öÁöÑÂæÆÊúçÂä°‰∏≠ÈÉΩ‰ºöÁî®Âà∞ËøôÊ†∑ÁöÑÊúçÂä°ÔºåÂú®ÊØè‰∏™ÂæÆÊúçÂä°‰∏≠ÈÉΩÂÆåÊàêËøôÊ†∑ÁöÑÂäüËÉΩÔºå‰ºöÂ≠òÂú®Â∑•‰ΩúÈáèÈáçÂ§ç„ÄÇÂè¶Â§ñÊâìÈÄ†‰∏Ä‰∏™È´òÂèØÈù†ÁöÑÂπÇÁ≠âÊúçÂä°ËøòÈúÄË¶ÅËÄÉËôëÂæàÂ§öÈóÆÈ¢òÔºåÊØîÂ¶Ç‰∏ÄÂè∞Êú∫Âô®ËôΩÁÑ∂ÊääÂÖ®Â±ÄIDÂÖàÂÜôÂÖ•‰∫ÜÂ≠òÂÇ®Ôºå‰ΩÜÊòØÂú®ÂÜôÂÖ•‰πãÂêéÊåÇ‰∫ÜÔºåËøôÂ∞±ÈúÄË¶ÅÂºïÂÖ•ÂÖ®Â±ÄIDÁöÑË∂ÖÊó∂Êú∫Âà∂„ÄÇ ‰ΩøÁî®ÂÖ®Â±ÄÂîØ‰∏ÄIDÊòØ‰∏Ä‰∏™ÈÄöÁî®ÊñπÊ°àÔºåÂèØ‰ª•ÊîØÊåÅÊèíÂÖ•„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§‰∏öÂä°Êìç‰Ωú„ÄÇ‰ΩÜÊòØËøô‰∏™ÊñπÊ°àÁúãËµ∑Êù•ÂæàÁæé‰ΩÜÊòØÂÆûÁé∞Ëµ∑Êù•ÊØîËæÉÈ∫ªÁÉ¶Ôºå‰∏ãÈù¢ÁöÑÊñπÊ°àÈÄÇÁî®‰∫éÁâπÂÆöÁöÑÂú∫ÊôØÔºå‰ΩÜÊòØÂÆûÁé∞Ëµ∑Êù•ÊØîËæÉÁÆÄÂçï„ÄÇ ÂéªÈáçË°®ËøôÁßçÊñπÊ≥ïÈÄÇÁî®‰∫éÂú®‰∏öÂä°‰∏≠ÊúâÂîØ‰∏ÄÊ†áÁöÑÊèíÂÖ•Âú∫ÊôØ‰∏≠ÔºåÊØîÂ¶ÇÂú®‰ª•‰∏äÁöÑÊîØ‰ªòÂú∫ÊôØ‰∏≠ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ËÆ¢ÂçïÂè™‰ºöÊîØ‰ªò‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ËÆ¢ÂçïIDÂèØ‰ª•‰Ωú‰∏∫ÂîØ‰∏ÄÊ†áËØÜ„ÄÇËøôÊó∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âª∫‰∏ÄÂº†ÂéªÈáçË°®ÔºåÂπ∂‰∏îÊääÂîØ‰∏ÄÊ†áËØÜ‰Ωú‰∏∫ÂîØ‰∏ÄÁ¥¢ÂºïÔºåÂú®Êàë‰ª¨ÂÆûÁé∞Êó∂ÔºåÊääÂàõÂª∫ÊîØ‰ªòÂçïÊçÆÂíåÂÜôÂÖ•ÂéªÂéªÈáçË°®ÔºåÊîæÂú®‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÔºåÂ¶ÇÊûúÈáçÂ§çÂàõÂª∫ÔºåÊï∞ÊçÆÂ∫ì‰ºöÊäõÂá∫ÂîØ‰∏ÄÁ∫¶ÊùüÂºÇÂ∏∏ÔºåÊìç‰ΩúÂ∞±‰ºöÂõûÊªö„ÄÇ ÊèíÂÖ•ÊàñÊõ¥Êñ∞ËøôÁßçÊñπÊ≥ïÊèíÂÖ•Âπ∂‰∏îÊúâÂîØ‰∏ÄÁ¥¢ÂºïÁöÑÊÉÖÂÜµÔºåÊØîÂ¶ÇÊàë‰ª¨Ë¶ÅÂÖ≥ËÅîÂïÜÂìÅÂìÅÁ±ªÔºåÂÖ∂‰∏≠ÂïÜÂìÅÁöÑIDÂíåÂìÅÁ±ªÁöÑIDÂèØ‰ª•ÊûÑÊàêÂîØ‰∏ÄÁ¥¢ÂºïÔºåÂπ∂‰∏îÂú®Êï∞ÊçÆË°®‰∏≠‰πüÂ¢ûÂä†‰∫ÜÂîØ‰∏ÄÁ¥¢Âºï„ÄÇËøôÊó∂Â∞±ÂèØ‰ª•‰ΩøÁî®InsertOrUpdateÊìç‰Ωú„ÄÇÂú®mysqlÊï∞ÊçÆÂ∫ì‰∏≠Â¶Ç‰∏ãÔºö 1234insert into goods_category (goods_id,category_id,create_time,update_time) values(#&#123;goodsId&#125;,#&#123;categoryId&#125;,now(),now()) on DUPLICATE KEY UPDATE update_time=now() Â§öÁâàÊú¨ÊéßÂà∂ËøôÁßçÊñπÊ≥ïÈÄÇÂêàÂú®Êõ¥Êñ∞ÁöÑÂú∫ÊôØ‰∏≠ÔºåÊØîÂ¶ÇÊàë‰ª¨Ë¶ÅÊõ¥Êñ∞ÂïÜÂìÅÁöÑÂêçÂ≠óÔºåËøôÊó∂Êàë‰ª¨Â∞±ÂèØ‰ª•Âú®Êõ¥Êñ∞ÁöÑÊé•Âè£‰∏≠Â¢ûÂä†‰∏Ä‰∏™ÁâàÊú¨Âè∑ÔºåÊù•ÂÅöÂπÇÁ≠â 1boolean updateGoodsName(int id,String newName,int version); Âú®ÂÆûÁé∞Êó∂ÂèØ‰ª•Â¶Ç‰∏ã 1update goods set name=#&#123;newName&#125;,version=#&#123;version&#125; where id=#&#123;id&#125; and version&lt;$&#123;version&#125; Áä∂ÊÄÅÊú∫ÊéßÂà∂ËøôÁßçÊñπÊ≥ïÈÄÇÂêàÂú®ÊúâÁä∂ÊÄÅÊú∫ÊµÅËΩ¨ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊØîÂ¶ÇÂ∞±‰ºöËÆ¢ÂçïÁöÑÂàõÂª∫Âíå‰ªòÊ¨æÔºåËÆ¢ÂçïÁöÑ‰ªòÊ¨æËÇØÂÆöÊòØÂú®‰πãÂâçÔºåËøôÊó∂Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂú®ËÆæËÆ°Áä∂ÊÄÅÂ≠óÊÆµÊó∂Ôºå‰ΩøÁî®intÁ±ªÂûãÔºåÂπ∂‰∏îÈÄöËøáÂÄºÁ±ªÂûãÁöÑÂ§ßÂ∞èÊù•ÂÅöÂπÇÁ≠âÔºåÊØîÂ¶ÇËÆ¢ÂçïÁöÑÂàõÂª∫‰∏∫0Ôºå‰ªòÊ¨æÊàêÂäü‰∏∫100„ÄÇ‰ªòÊ¨æÂ§±Ë¥•‰∏∫99 Âú®ÂÅöÁä∂ÊÄÅÊú∫Êõ¥Êñ∞Êó∂ÔºåÊàë‰ª¨Â∞±ËøôÂèØ‰ª•ËøôÊ†∑ÊéßÂà∂ 1update order set status=#&#123;status&#125; where id=#&#123;id&#125; and status&lt;#&#123;status&#125;]]></content>
      <categories>
        <category>ÂæÆÊúçÂä°</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[2PCÂà∞3PCÂà∞PaxosÂà∞RaftÂà∞ISR]]></title>
    <url>%2F2018%2F10%2F15%2F2PC%E5%88%B03PC%E5%88%B0Paxos%E5%88%B0Raft%E5%88%B0ISR%2F</url>
    <content type="text"><![CDATA[ÂàÜÂ∏ÉÂºèÁêÜËÆ∫Á≥ªÂàó ‰ªéACIDÂà∞CAPÂà∞BASE 2PCÂà∞3PCÂà∞PaxosÂà∞RaftÂà∞ISR Â§çÂà∂„ÄÅÂàÜÁâáÂíåË∑ØÁî± ÂâØÊú¨Êõ¥Êñ∞Á≠ñÁï• Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÂèäÊâãÊÆµ RWNÂèäQuorum‰∏éÂº∫‰∏ÄËá¥ÊÄß Â∫èÊú¨Êñá‰∏ªË¶ÅËÆ≤Ëø∞2PCÂèä3PCÔºå‰ª•ÂèäPaxos‰ª•ÂèäRaftÂçèËÆÆ„ÄÇ ‰∏§Á±ª‰∏ÄËá¥ÊÄß(Êìç‰ΩúÂéüÂ≠êÊÄß‰∏éÂâØÊú¨‰∏ÄËá¥ÊÄß) 2PCÂçèËÆÆÁî®‰∫é‰øùËØÅÂ±û‰∫éÂ§ö‰∏™Êï∞ÊçÆÂàÜÁâá‰∏äÁöÑÊìç‰ΩúÁöÑÂéüÂ≠êÊÄß„ÄÇËøô‰∫õÊï∞ÊçÆÂàÜÁâáÂèØËÉΩÂàÜÂ∏ÉÂú®‰∏çÂêåÁöÑÊúçÂä°Âô®‰∏äÔºå2PCÂçèËÆÆ‰øùËØÅÂ§öÂè∞ÊúçÂä°Âô®‰∏äÁöÑÊìç‰ΩúË¶Å‰πàÂÖ®ÈÉ®ÊàêÂäüÔºåË¶Å‰πàÂÖ®ÈÉ®Â§±Ë¥•„ÄÇ PaxosÂçèËÆÆÁî®‰∫é‰øùËØÅÂêå‰∏Ä‰∏™Êï∞ÊçÆÂàÜÁâáÁöÑÂ§ö‰∏™ÂâØÊú¨‰πãÈó¥ÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÇÂΩìËøô‰∫õÂâØÊú¨ÂàÜÂ∏ÉÂà∞‰∏çÂêåÁöÑÊï∞ÊçÆ‰∏≠ÂøÉÊó∂ÔºåËøô‰∏™ÈúÄÊ±ÇÂ∞§ÂÖ∂Âº∫ÁÉà„ÄÇ ‰∏Ä„ÄÅ2PCÔºàÈòªÂ°û„ÄÅÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÈóÆÈ¢ò„ÄÅÂçïÁÇπÈóÆÈ¢òÔºâ1Two-Phase CommitÔºå‰∏§Èò∂ÊÆµÊèê‰∫§ 1„ÄÅÈò∂ÊÆµ‰∏ÄÔºöÊèê‰∫§‰∫ãÂä°ËØ∑Ê±ÇÔºàÊäïÁ•®Èò∂ÊÆµÔºâÔºà1Ôºâ‰∫ãÂä°ËØ¢ÈóÆ 1ÂçèË∞ÉËÄÖÂêëÊâÄÊúâÁöÑÂèÇ‰∏éËÄÖÂèëÈÄÅ‰∫ãÂä°ÂÜÖÂÆπÔºåËØ¢ÈóÆÊòØÂê¶ÂèØ‰ª•ÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÂπ∂ÂºÄÂßãÁ≠âÂæÖÂêÑÂèÇ‰∏éËÄÖÁöÑÂìçÂ∫î Ôºà2ÔºâÊâßË°å‰∫ãÂä° 1ÂêÑÂèÇ‰∏éËÄÖËäÇÁÇπÊâßË°å‰∫ãÂä°Êìç‰ΩúÔºåÂπ∂Â∞ÜUndoÂíåRedo‰ø°ÊÅØËÆ°ÂÖ•‰∫ãÂä°Êó•Âøó‰∏≠ Ôºà3ÔºâÂêÑÂèÇ‰∏éËÄÖÂêëÂçèË∞ÉËÄÖÂèçÈ¶à‰∫ãÂä°ËØ¢ÈóÆÁöÑÂìçÂ∫î 1Â¶ÇÊûúÂèÇ‰∏éËÄÖÊàêÂäüÊâßË°å‰∫Ü‰∫ãÂä°Êìç‰ΩúÔºåÈÇ£‰πàÂ∞±ÂèçÈ¶àÁªôÂçèË∞ÉËÄÖYesÂìçÂ∫îÔºåË°®Á§∫‰∫ãÂä°ÂèØ‰ª•ÊâßË°åÔºõÂ¶ÇÊûúÂèÇ‰∏éËÄÖÊ≤°ÊúâÊàêÂäüÊâßË°å‰∫ãÂä°ÔºåÈÇ£‰πàÂ∞±ÂèçÈ¶àÁªôÂçèË∞ÉËÄÖNoÂìçÂ∫îÔºåË°®Á§∫‰∫ãÂä°‰∏çÂèØ‰ª•ÊâßË°å„ÄÇ 2„ÄÅÈò∂ÊÆµ‰∫åÔºöÊâßË°å‰∫ãÂä°Êèê‰∫§ÔºàÊâßË°åÈò∂ÊÆµÔºâÔºà1ÔºâÊâßË°å‰∫ãÂä°Êèê‰∫§ 1Â¶ÇÊûúÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑÂèçÈ¶àÈÉΩÊòØYesÂìçÂ∫îÔºåÈÇ£‰πà A„ÄÅÂèëÈÄÅÊèê‰∫§ËØ∑Ê±Ç 1ÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖËäÇÁÇπÂèëÂá∫CommitËØ∑Ê±Ç B„ÄÅ‰∫ãÂä°Êèê‰∫§ 1ÂèÇ‰∏éËÄÖÊé•Êî∂Âà∞CommitËØ∑Ê±ÇÂêéÔºå‰ºöÊ≠£ÂºèÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÂπ∂Âú®ÂÆåÊàêÊèê‰∫§‰πãÂêéÈáäÊîæÂú®Êï¥‰∏™‰∫ãÂä°ÊâßË°åÊúüÈó¥Âç†Áî®ÁöÑ‰∫ãÂä°ËµÑÊ∫ê C„ÄÅÂèçÈ¶à‰∫ãÂä°Êèê‰∫§ÁªìÊûú 1ÂèÇ‰∏éËÄÖÂú®ÂÆåÊàê‰∫ãÂä°Êèê‰∫§‰πãÂêéÔºåÂêëÂçèË∞ÉËÄÖÂèëÈÄÅACK‰ø°ÊÅØ D„ÄÅÂÆåÊàê‰∫ãÂä° 1ÂçèË∞ÉËÄÖÊé•Êî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖÂèçÈ¶àÁöÑACKÊ∂àÊÅØÂêéÔºåÂÆåÊàê‰∫ãÂä° Ôºà2Ôºâ‰∏≠Êñ≠‰∫ãÂä° 1‰ªª‰Ωï‰∏Ä‰∏™ÂèÇ‰∏éËÄÖÂèçÈ¶à‰∫ÜNoÂìçÂ∫îÔºåÊàñËÄÖÂú®Á≠âÂæÖË∂ÖÊó∂‰πãÂêéÔºåÂçèË∞ÉËÄÖÂ∞öÊó†Ê≥ïÊé•Êî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑÂèçÈ¶àÂìçÂ∫îÔºåÈÇ£‰πàÂ∞±‰ºö‰∏≠Êñ≠‰∫ãÂä°„ÄÇ A„ÄÅÂèëÈÄÅÂõûÊªöËØ∑Ê±Ç 1ÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖËäÇÁÇπÂèëÂá∫RollbackËØ∑Ê±Ç B„ÄÅ‰∫ãÂä°ÂõûÊªö 1ÂèÇ‰∏éËÄÖÊé•Êî∂Âà∞rollbackËØ∑Ê±ÇÂêéÔºå‰ºöÂà©Áî®ÂÖ∂Âú®Èò∂ÊÆµ‰∏Ä‰∏≠ËÆ∞ÂΩïÁöÑUndo‰ø°ÊÅØÊù•ÊâßË°å‰∫ãÂä°ÂõûÊªöÊìç‰ΩúÔºåÂπ∂Âú®ÂÆåÊàêÂõûÊªö‰πãÂêéÈáäÊîæÊï¥‰∏™‰∫ãÂä°ÊâßË°åÊúüÈó¥Âç†Áî®ÁöÑËµÑÊ∫ê C„ÄÅÂèçÈ¶à‰∫ãÂä°ÂõûÊªöÁªìÊûú 1ÂèÇ‰∏éËÄÖÂú®ÂÆåÊàê‰∫ãÂä°ÂõûÊªö‰πãÂêéÔºåÂêëÂçèË∞ÉËÄÖÂèëÈÄÅACK‰ø°ÊÅØ D„ÄÅ‰∏≠Êñ≠‰∫ãÂä° 1ÂçèË∞ÉËÄÖÊé•Êî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖÂèçÈ¶àÁöÑACK‰ø°ÊÅØÂêéÔºåÂÆåÊàê‰∫ãÂä°‰∏≠Êñ≠ ‰ºòÁº∫ÁÇπ‰ºòÁÇπÔºöÂéüÁêÜÁÆÄÂçï„ÄÅÂÆûÁé∞Êñπ‰æøÁº∫ÁÇπÔºöÂêåÊ≠•ÈòªÂ°û„ÄÅÂçïÁÇπÈóÆÈ¢ò„ÄÅÊï∞ÊçÆ‰∏ç‰∏ÄËá¥„ÄÅÂ§™Ëøá‰øùÂÆà Ôºà1ÔºâÂêåÊ≠•ÈòªÂ°ûÂêåÊ≠•ÈòªÂ°û‰ºöÊûÅÂ§ßÂú∞ÈôêÂà∂ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑÊÄßËÉΩ„ÄÇÂú®‰∫åÈò∂ÊÆµÊèê‰∫§ÁöÑÊâßË°åËøáÁ®ã‰∏≠ÔºåÊâÄÊúâÂèÇ‰∏éËØ•‰∫ãÂä°Êìç‰ΩúÁöÑÈÄªËæëÈÉΩÂ§Ñ‰∫éÈòªÂ°ûÁä∂ÊÄÅÔºåÂêÑ‰∏™ÂèÇ‰∏éËÄÖÂú®Á≠âÂæÖÂÖ∂‰ªñÂèÇ‰∏éËÄÖÂìçÂ∫îÁöÑËøáÁ®ã‰∏≠ÔºåÂ∞ÜÊó†Ê≥ïËøõË°åÂÖ∂‰ªñ‰ªª‰ΩïÊìç‰Ωú„ÄÇ Ôºà2ÔºâÂçïÁÇπÈóÆÈ¢ò‰∏ÄÊó¶ÂçèË∞ÉËÄÖÂá∫Áé∞ÈóÆÈ¢òÔºåÈÇ£‰πàÊï¥‰∏™‰∫åÈò∂ÊÆµÊèê‰∫§ÊµÅÁ®ãÂ∞ÜÊó†Ê≥ïËøêËΩ¨ÔºåÊõ¥‰∏∫‰∏•ÈáçÁöÑÊòØÔºåÂ¶ÇÊûúÊòØÂú®Èò∂ÊÆµ‰∫å‰∏≠Âá∫Áé∞ÈóÆÈ¢òÔºåÈÇ£‰πàÂÖ∂‰ªñÂèÇ‰∏éËÄÖÂ∞Ü‰ºö‰∏ÄÁõ¥Â§Ñ‰∫éÈîÅÂÆö‰∫ãÂä°ËµÑÊ∫êÁöÑÁä∂ÊÄÅ‰∏≠ÔºåÊó†Ê≥ïÁªßÁª≠ÂÆåÊàê‰∫ãÂä°Êìç‰Ωú„ÄÇ Ôºà3ÔºâÊï∞ÊçÆ‰∏ç‰∏ÄËá¥Âú®Èò∂ÊÆµ‰∫åÔºåÂΩìÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖÂèëÈÄÅcommitËØ∑Ê±Ç‰πãÂêéÔºåÂèëÁîü‰∫ÜÂ±ÄÈÉ®ÁΩëÁªúÂºÇÂ∏∏ÊàñÂçèË∞ÉËÄÖÂú®Â∞öÊú™ÂèëÂÆåcommitËØ∑Ê±Ç‰πãÂâçËá™Ë∫´ÂèëÁîü‰∫ÜÂ¥©Ê∫ÉÔºåÂØºËá¥ÊúÄÁªàÂè™ÊúâÈÉ®ÂàÜÂèÇ‰∏éËÄÖÊé•Êî∂Âà∞‰∫ÜcommitËØ∑Ê±ÇÔºå‰∫éÊòØËøôÈÉ®ÂàÜÂèÇ‰∏éËÄÖÊâßË°å‰∫ãÂä°Êèê‰∫§ÔºåËÄåÊ≤°Êî∂Âà∞commitËØ∑Ê±ÇÁöÑÂèÇ‰∏éËÄÖÂàôÊó†Ê≥ïËøõË°å‰∫ãÂä°Êèê‰∫§Ôºå‰∫éÊòØÊï¥‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂá∫Áé∞‰∫ÜÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÊÄßÁé∞Ë±°„ÄÇ Ôºà4ÔºâÂ§™Ëøá‰øùÂÆàÂ¶ÇÊûúÂèÇ‰∏éËÄÖÂú®‰∏éÂçèË∞ÉËÄÖÈÄö‰ø°ÊúüÈó¥Âá∫Áé∞ÊïÖÈöúÔºåÂçèË∞ÉËÄÖÂè™ËÉΩÈù†Ë∂ÖÊó∂Êú∫Âà∂Êù•Âà§Êñ≠ÊòØÂê¶ÈúÄË¶Å‰∏≠Êñ≠‰∫ãÂä°ÔºåËøô‰∏™Á≠ñÁï•ÊØîËæÉ‰øùÂÆàÔºåÈúÄË¶ÅÊõ¥‰∏∫ÂÆåÂñÑÁöÑÂÆπÈîôÊú∫Âà∂Ôºå‰ªªÊÑè‰∏Ä‰∏™ËäÇÁÇπÁöÑÂ§±Ë¥•ÈÉΩ‰ºöÂØºËá¥Êï¥‰∏™‰∫ãÂä°ÁöÑÂ§±Ë¥•„ÄÇ ‰∫å„ÄÅ3PCÔºàËß£ÂÜ≥2PCÁöÑÈòªÂ°ûÔºå‰ΩÜËøòÊòØÂèØËÉΩÈÄ†ÊàêÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºâThree-Phase CommitÔºå‰∏âÈò∂ÊÆµÊèê‰∫§ÔºåÂàÜ‰∏∫CanCommit„ÄÅPreCommit„ÄÅdo Commit‰∏â‰∏™Èò∂ÊÆµ„ÄÇ ‰∏∫‰∫ÜÈÅøÂÖçÂú®ÈÄöÁü•ÊâÄÊúâÂèÇ‰∏éËÄÖÊèê‰∫§‰∫ãÂä°Êó∂ÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÂèÇ‰∏éËÄÖcrash‰∏ç‰∏ÄËá¥Êó∂ÔºåÂ∞±Âá∫Áé∞‰∫Ü‰∏âÈò∂ÊÆµÊèê‰∫§ÁöÑÊñπÂºè„ÄÇ‰∏âÈò∂ÊÆµÊèê‰∫§Âú®‰∏§Èò∂ÊÆµÊèê‰∫§ÁöÑÂü∫Á°Ä‰∏äÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™preCommitÁöÑËøáÁ®ãÔºåÂΩìÊâÄÊúâÂèÇ‰∏éËÄÖÊî∂Âà∞preCommitÂêéÔºåÂπ∂‰∏çÊâßË°åÂä®‰ΩúÔºåÁõ¥Âà∞Êî∂Âà∞commitÊàñË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥ÂêéÊâçÂÆåÊàêÊìç‰Ωú„ÄÇ 1„ÄÅÈò∂ÊÆµ‰∏ÄCanCommit Ôºà1Ôºâ‰∫ãÂä°ËØ¢ÈóÆÂçèË∞ÉËÄÖÂêëÂêÑÂèÇ‰∏éËÄÖÂèëÈÄÅCanCommitÁöÑËØ∑Ê±ÇÔºåËØ¢ÈóÆÊòØÂê¶ÂèØ‰ª•ÊâßË°å‰∫ãÂä°Êèê‰∫§Êìç‰ΩúÔºåÂπ∂ÂºÄÂßãÁ≠âÂæÖÂêÑÂèÇ‰∏éËÄÖÁöÑÂìçÂ∫î Ôºà2ÔºâÂèÇ‰∏éËÄÖÂêëÂçèË∞ÉËÄÖÂèçÈ¶àËØ¢ÈóÆÁöÑÂìçÂ∫îÂèÇ‰∏éËÄÖÊî∂Âà∞CanCommitËØ∑Ê±ÇÂêéÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúËá™Ë∫´ËÆ§‰∏∫ÂèØ‰ª•È°∫Âà©ÊâßË°å‰∫ãÂä°ÔºåÈÇ£‰πà‰ºöÂèçÈ¶àYesÂìçÂ∫îÔºåÂπ∂ËøõÂÖ•È¢ÑÂ§áÁä∂ÊÄÅÔºåÂê¶ÂàôÂèçÈ¶àNo„ÄÇ 2„ÄÅÈò∂ÊÆµ‰∫åPreCommitÔºà1ÔºâÊâßË°å‰∫ãÂä°È¢ÑÊèê‰∫§1Â¶ÇÊûúÂçèË∞ÉËÄÖÊé•Êî∂Âà∞ÂêÑÂèÇ‰∏éËÄÖÂèçÈ¶àÈÉΩÊòØYesÔºåÈÇ£‰πàÊâßË°å‰∫ãÂä°È¢ÑÊèê‰∫§ A„ÄÅÂèëÈÄÅÈ¢ÑÊèê‰∫§ËØ∑Ê±ÇÂçèË∞ÉËÄÖÂêëÂêÑÂèÇ‰∏éËÄÖÂèëÈÄÅpreCommitËØ∑Ê±ÇÔºåÂπ∂ËøõÂÖ•preparedÈò∂ÊÆµ B„ÄÅ‰∫ãÂä°È¢ÑÊèê‰∫§ÂèÇ‰∏éËÄÖÊé•Êî∂Âà∞preCommitËØ∑Ê±ÇÂêéÔºå‰ºöÊâßË°å‰∫ãÂä°Êìç‰ΩúÔºåÂπ∂Â∞ÜUndoÂíåRedo‰ø°ÊÅØËÆ∞ÂΩïÂà∞‰∫ãÂä°Êó•ËÆ∞‰∏≠ C„ÄÅÂêÑÂèÇ‰∏éËÄÖÂêëÂçèË∞ÉËÄÖÂèçÈ¶à‰∫ãÂä°ÊâßË°åÁöÑÂìçÂ∫îÂ¶ÇÊûúÂêÑÂèÇ‰∏éËÄÖÈÉΩÊàêÂäüÊâßË°å‰∫Ü‰∫ãÂä°Êìç‰ΩúÔºåÈÇ£‰πàÂèçÈ¶àÁªôÂçèË∞ÉËÄÖAckÂìçÂ∫îÔºåÂêåÊó∂Á≠âÂæÖÊúÄÁªàÊåá‰ª§ÔºåÊèê‰∫§commitÊàñËÄÖÁªàÊ≠¢abort Ôºà2Ôºâ‰∏≠Êñ≠‰∫ãÂä°Â¶ÇÊûú‰ªª‰Ωï‰∏Ä‰∏™ÂèÇ‰∏éËÄÖÂêëÂçèË∞ÉËÄÖÂèçÈ¶à‰∫ÜNoÂìçÂ∫îÔºåÊàñËÄÖÂú®Á≠âÂæÖË∂ÖÊó∂ÂêéÔºåÂçèË∞ÉËÄÖÊó†Ê≥ïÊé•Êî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑÂèçÈ¶àÔºåÈÇ£‰πàÂ∞±‰ºö‰∏≠Êñ≠‰∫ãÂä°„ÄÇ A„ÄÅÂèëÈÄÅ‰∏≠Êñ≠ËØ∑Ê±Ç 1ÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖÂèëÈÄÅabortËØ∑Ê±Ç B„ÄÅ‰∏≠Êñ≠‰∫ãÂä° 1Êó†ËÆ∫ÊòØÊî∂Âà∞Êù•Ëá™ÂçèË∞ÉËÄÖÁöÑabortËØ∑Ê±ÇÔºåËøòÊòØÁ≠âÂæÖË∂ÖÊó∂ÔºåÂèÇ‰∏éËÄÖÈÉΩ‰∏≠Êñ≠‰∫ãÂä° 3„ÄÅÈò∂ÊÆµ‰∏âdoCommitÔºà1ÔºâÊâßË°åÊèê‰∫§ A„ÄÅÂèëÈÄÅÊèê‰∫§ËØ∑Ê±ÇÂÅáËÆæÂçèË∞ÉËÄÖÊ≠£Â∏∏Â∑•‰ΩúÔºåÊé•Êî∂Âà∞‰∫ÜÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑackÂìçÂ∫îÔºåÈÇ£‰πàÂÆÉÂ∞Ü‰ªéÈ¢ÑÊèê‰∫§Èò∂ÊÆµËøõÂÖ•Êèê‰∫§Áä∂ÊÄÅÔºåÂπ∂ÂêëÊâÄÊúâÂèÇ‰∏éËÄÖÂèëÈÄÅdoCommitËØ∑Ê±Ç B„ÄÅ‰∫ãÂä°Êèê‰∫§ÂèÇ‰∏éËÄÖÊî∂Âà∞doCommitËØ∑Ê±ÇÂêéÔºåÊ≠£ÂºèÊèê‰∫§‰∫ãÂä°ÔºåÂπ∂Âú®ÂÆåÊàê‰∫ãÂä°Êèê‰∫§ÂêéÈáäÊîæÂç†Áî®ÁöÑËµÑÊ∫ê C„ÄÅÂèçÈ¶à‰∫ãÂä°Êèê‰∫§ÁªìÊûúÂèÇ‰∏éËÄÖÂÆåÊàê‰∫ãÂä°Êèê‰∫§ÂêéÔºåÂêëÂçèË∞ÉËÄÖÂèëÈÄÅACK‰ø°ÊÅØ D„ÄÅÂÆåÊàê‰∫ãÂä°ÂçèË∞ÉËÄÖÊé•Êî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖack‰ø°ÊÅØÔºåÂÆåÊàê‰∫ãÂä° Ôºà2Ôºâ‰∏≠Êñ≠‰∫ãÂä°ÂÅáËÆæÂçèË∞ÉËÄÖÊ≠£Â∏∏Â∑•‰ΩúÔºåÂπ∂‰∏îÊúâ‰ªª‰∏ÄÂèÇ‰∏éËÄÖÂèçÈ¶àNoÔºåÊàñËÄÖÂú®Á≠âÂæÖË∂ÖÊó∂ÂêéÊó†Ê≥ïÊé•Êî∂ÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑÂèçÈ¶àÔºåÈÉΩ‰ºö‰∏≠Êñ≠‰∫ãÂä° A„ÄÅÂèëÈÄÅ‰∏≠Êñ≠ËØ∑Ê±ÇÂçèË∞ÉËÄÖÂêëÊâÄÊúâÂèÇ‰∏éËÄÖËäÇÁÇπÂèëÈÄÅabortËØ∑Ê±Ç B„ÄÅ‰∫ãÂä°ÂõûÊªöÂèÇ‰∏éËÄÖÊé•Êî∂Âà∞abortËØ∑Ê±ÇÂêéÔºåÂà©Áî®undoÊó•ÂøóÊâßË°å‰∫ãÂä°ÂõûÊªöÔºåÂπ∂Âú®ÂÆåÊàê‰∫ãÂä°ÂõûÊªöÂêéÈáäÊîæÂç†Áî®ÁöÑËµÑÊ∫ê C„ÄÅÂèçÈ¶à‰∫ãÂä°ÂõûÊªöÁªìÊûúÂèÇ‰∏éËÄÖÂú®ÂÆåÊàê‰∫ãÂä°ÂõûÊªö‰πãÂêéÔºåÂêëÂçèË∞ÉËÄÖÂèëÈÄÅack‰ø°ÊÅØ D„ÄÅ‰∏≠Êñ≠‰∫ãÂä°ÂçèË∞ÉËÄÖÊé•Êî∂Âà∞ÊâÄÊúâÂèÇ‰∏éËÄÖÂèçÈ¶àÁöÑack‰ø°ÊÅØÂêéÔºå‰∏≠Êñ≠‰∫ãÂä°„ÄÇ Èò∂ÊÆµ‰∏âÂèØËÉΩÂá∫Áé∞ÁöÑÈóÆÈ¢òÔºöÂçèË∞ÉËÄÖÂá∫Áé∞ÈóÆÈ¢ò„ÄÅÂçèË∞ÉËÄÖ‰∏éÂèÇ‰∏éËÄÖ‰πãÈó¥ÁΩëÁªúÂá∫Áé∞ÊïÖÈöú„ÄÇ‰∏çËÆ∫Âá∫Áé∞Âì™ÁßçÊÉÖÂÜµÔºåÊúÄÁªàÈÉΩ‰ºöÂØºËá¥ÂèÇ‰∏éËÄÖÊó†Ê≥ïÂèäÊó∂Êé•Êî∂Âà∞Êù•Ëá™ÂçèË∞ÉËÄÖÁöÑdoCommitÊàñÊòØabortËØ∑Ê±ÇÔºåÈíàÂØπËøôÁßçÊÉÖÂÜµÔºåÂèÇ‰∏éËÄÖÈÉΩ‰ºöÂú®Á≠âÂæÖË∂ÖÊó∂ÂêéÔºåÁªßÁª≠ËøõË°å‰∫ãÂä°Êèê‰∫§ÔºàtimeoutÂêé‰∏≠Êñ≠‰∫ãÂä°Ôºâ„ÄÇ ‰ºòÁÇπÔºöÈôç‰ΩéÂèÇ‰∏éËÄÖÈòªÂ°ûËåÉÂõ¥ÔºåÂπ∂ËÉΩÂ§üÂú®Âá∫Áé∞ÂçïÁÇπÊïÖÈöúÂêéÁªßÁª≠ËææÊàê‰∏ÄËá¥Áº∫ÁÇπÔºöÂºïÂÖ•preCommitÈò∂ÊÆµÔºåÂú®Ëøô‰∏™Èò∂ÊÆµÂ¶ÇÊûúÂá∫Áé∞ÁΩëÁªúÂàÜÂå∫ÔºåÂçèË∞ÉËÄÖÊó†Ê≥ï‰∏éÂèÇ‰∏éËÄÖÊ≠£Â∏∏ÈÄö‰ø°ÔºåÂèÇ‰∏éËÄÖ‰æùÁÑ∂‰ºöËøõË°å‰∫ãÂä°Êèê‰∫§ÔºåÈÄ†ÊàêÊï∞ÊçÆ‰∏ç‰∏ÄËá¥„ÄÇ ‰∏â„ÄÅPaxosÔºàËß£ÂÜ≥ÂçïÁÇπÈóÆÈ¢òÔºâÂü∫‰∫éÊ∂àÊÅØ‰º†ÈÄí‰∏îÂÖ∑ÊúâÈ´òÂ∫¶ÂÆπÈîôÊÄßÁöÑ‰∏ÄËá¥ÊÄßÁÆóÊ≥ï„ÄÇPaxosÁÆóÊ≥ïË¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÂ∞±ÊòØÂ¶Ç‰ΩïÂú®ÂèØËÉΩÂèëÁîüÂá†Ëµ∑ÂÆïÊú∫ÊàñÁΩëÁªúÂºÇÂ∏∏ÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÔºåÂø´ÈÄü‰∏îÊ≠£Á°ÆÂú∞Âú®ÈõÜÁæ§ÂÜÖÈÉ®ÂØπÊüê‰∏™Êï∞ÊçÆÁöÑÂÄºËææÊàê‰∏ÄËá¥ÔºåÂπ∂‰∏î‰øùËØÅ‰∏çËÆ∫ÂèëÁîü‰ª•‰∏ä‰ªª‰ΩïÂºÇÂ∏∏ÔºåÈÉΩ‰∏ç‰ºöÁ†¥ÂùèÊï¥‰∏™Á≥ªÁªüÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ ÊãúÂç†Â∫≠ÈóÆÈ¢òÔºöÊ∂àÊÅØ‰∏çÂÆåÊï¥ÊàñËÄÖË¢´ÁØ°Êîπ„ÄÇPaxosÂú®Áª¥ÊåÅÈ¢ÜÂØºËÄÖÈÄâ‰∏æÊàñËÄÖÂèòÈáè‰øÆÊîπ‰∏ÄËá¥ÊÄß‰∏äÔºåÈááÂèñ‰∏ÄÁßçÁ±ª‰ººËÆÆ‰ºöÊäïÁ•®ÁöÑËøáÂçäÂêåÊÑèÊú∫Âà∂ÔºåÊØîÂ¶ÇËÆæÂÆö‰∏Ä‰∏™È¢ÜÂØºËÄÖÔºåÈúÄË¶ÅÂ∞ÜÊ≠§ÁúãÂÅö‰∏Ä‰∏™ËÆÆÊ°àÔºåÂæÅÊ±ÇËøáÂçäÂêåÊÑèÔºåÊØè‰∏™ËäÇÁÇπÈÄöËøá‰∏Ä‰∏™ËÆÆÊ°à‰ºöÊúâÁºñÂè∑ËÆ∞ÂΩïÔºåÂÜçÊ¨°Êî∂Âà∞Ê≠§È¢ÜÂØºËÄÖÁöÑ‰∏çÂêå‰∫∫ÈÄâÔºåÂèëÁé∞Â∑≤ÁªèÊúâÁºñÂè∑ËÆ∞ÂΩï‰æøÈ©≥ÂõûÔºåÊúÄÂêé‰ª•Â§öÊï∞ÈÄöËøáÁöÑÁªìÊûú‰∏∫ÂáÜ„ÄÇ Êàë‰ª¨‰∏æ‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÔºåÊù•ÈòêËø∞‰∏Ä‰∏ãPaxosÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÔºöÂÅáËÆæÊàë‰ª¨Êúâ5Âè∞ËÆ°ÁÆóÊú∫A„ÄÅB„ÄÅC„ÄÅD„ÄÅEÔºåÊØèÂè∞ËÆ°ÁÆóÊú∫‰øùÂ≠òÁùÄÂÖ¨Âè∏CEOÁöÑ‰ø°ÊÅØÔºåÁé∞Âú®CEO‰ªªÊúüÂà∞‰∫ÜÔºåÈúÄË¶ÅËøõË°åÊñ∞‰∏ÄÁïåÈÄâ‰∏æ‰∫Ü„ÄÇ AËÆ°ÁÆóÊú∫ÂèëËµ∑‰∏Ä‰∏™ÈÄâ‰∏æËÆÆÊ°àÔºåÊèêËÆÆCEO‰∏∫‚ÄúÂº†‰∏â‚ÄùÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÖ∂‰ªñÂÄôÈÄâ‰∫∫ËÆÆÊ°àÔºå‰πüÊ≤°ÊúâÁΩëÁªúÈóÆÈ¢òÔºåÂè™Ë¶ÅÂÖ∂‰∏≠ÂçäÊï∞‰ª•‰∏äËÆ°ÁÆóÊú∫Êî∂Âà∞Âπ∂ÈÄöËøáËÆÆÊ°àÔºåÈÇ£‰πàÊúÄÁªà‚ÄúÂº†‰∏â‚ÄùÂΩìÈÄâCEO„ÄÇÁî±‰∫éÊòØÂàÜÂ∏ÉÂºèÁéØÂ¢ÉÔºåÂπ∂ÂèëËØ∑Ê±Ç„ÄÅÊú∫Âô®ÊïÖÈöú„ÄÅÁΩëÁªúÊïÖÈöúÁ≠âÈóÆÈ¢òÊòØÂ∏∏ÊÄÅÔºåÂ¶ÇÊûúAÂíåEÂêåÊó∂Êèê‰∫§ÈÄâ‰∏æËÆÆÊ°àÔºåAÊèêÂêç‚ÄúÂº†‰∏â‚ÄùÔºåEÊèêÂêç‚ÄúÊùéÂõõ‚ÄùÔºåÈÇ£‰πàËÇØÂÆö‰ºöÊ∂âÂèäÂ§öËÆ°ÁÆóÊú∫ÁöÑ‰∏ÄËá¥ÊÄßÈóÆÈ¢ò‰∫ÜÔºöÂÅáËÆæA„ÄÅB„ÄÅCÂÖàÊî∂Âà∞AÁöÑËÆÆÊ°àÔºåD„ÄÅEÂÖàÊî∂Âà∞EÁöÑËÆÆÊ°àÔºåÈÇ£‰πàAÁªßÁª≠Êèê‰∫§ÁªôDÊó∂ÔºåDÂëäËØâÂÆÉÂ∑≤ÁªèÂÖàÊî∂Âà∞EÁöÑËÆÆÊ°à‰∫ÜÔºåÂõ†Ê≠§È©≥Âõû‰∫ÜAÁöÑËØ∑Ê±Ç„ÄÇÂêåÊ†∑EÁªßÁª≠Êèê‰∫§ÁªôA„ÄÅB„ÄÅCÊó∂‰πüÁ¢∞Âà∞Áõ∏ÂêåÁöÑÈóÆÈ¢ò„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‚ÄúÂú®ÊØèÂè∞ËÆ°ÁÆóÊú∫ÂêåÊó∂Êé•ÂèóËÆÆÊ°àÊèê‰∫§Êó∂ËÆæÁΩÆ‰∏Ä‰∏™ÁºñÂè∑ÔºåÁºñÂè∑ÂÖàÁöÑÈÄöËøáÔºåÁºñÂè∑ÂêéÁöÑÈ©≥Âõû‚ÄùÁöÑÊñπÂºèÊù•ÂÆûÁé∞„ÄÇËÆÆÊ°àÊèê‰∫§‰∏äÂéªÂêéÔºåÂèëÁé∞A„ÄÅB„ÄÅCÊäïÁ•®‚ÄúÂº†‰∏â‚Äù‰∏∫CEOÔºåD„ÄÅEÊäïÁ•®‚ÄúÊùéÂõõ‚Äù‰∏∫CEOÔºåÂ∞ëÊï∞Êúç‰ªéÂ§öÊï∞ÔºåÂõ†Ê≠§ÊúÄÂêéÁªìÊûú‰∏∫‚ÄúÂº†‰∏â‚ÄùÂΩìÈÄâCEO„ÄÇ Â¶ÇÊûúÊòØCËÆ°ÁÆóÊú∫ÂèëÁîü‰∫ÜÁΩëÁªúÈóÆÈ¢òÊàñËÄÖÊïÖÈöúÔºåÂèåÊñπÊäïÁ•®Áõ∏ÂêåÔºåÈÇ£‰πàÈÄâ‰∏æÊó†Ê≥ïÂÆåÊàê„ÄÇ Â¶ÇÊûúCËÆ°ÁÆóÊú∫ÂèëÁîü‰∫ÜÁΩëÁªúÈóÆÈ¢òÊàñËÄÖÊïÖÈöúÔºåA„ÄÅB„ÄÅDÊäïÁ•®‚ÄúÂº†‰∏â‚ÄùÔºåEÊäïÁ•®‚ÄúÊùéÂõõ‚ÄùÔºåÈÇ£‰πàÁªìÊûú‰∏∫‚ÄúÂº†‰∏â‚ÄùÂΩìÈÄâÔºåËÄåCÂØπ‰∫éËøô‰∫õÊÉÖÂÜµ‰∏ÄÊó†ÊâÄÁü•Ôºå‰ΩÜÊòØÂΩìCËÆ°ÁÆóÊú∫ÊÅ¢Â§çÊ≠£Â∏∏Êó∂Ôºå‰ªñ‰ºöÂèëËµ∑‰∏Ä‰∏™‚ÄúËØ¢ÈóÆË∞ÅÊòØCEO‚ÄùÁöÑËÆÆÊ°àËé∑ÂèñÊúÄÊñ∞‰ø°ÊÅØ„ÄÇÁÆÄË®Ä‰πãÔºåPaxosÂØπÊØè‰∏™ËäÇÁÇπÁöÑÂπ∂Âèë‰øÆÊîπÈááÂèñÁºñÂè∑ËÆ∞ÂΩïÁöÑÊñπÂºè‰øùÊåÅ‰∏ÄËá¥ÊÄßÔºåÂØπÂ§ö‰∏™ËäÇÁÇπÁöÑÂπ∂Âèë‰øÆÊîπÈááÂèñÂ∞ëÊï∞Êúç‰ªéÂ§öÊï∞ÁöÑÊñπÂºè‰øùÊåÅ‰∏ÄËá¥ÊÄß„ÄÇPaxosÊúâÁÇπÁ±ª‰ººÂàÜÂ∏ÉÂºè‰∫åÈò∂ÊÆµÊèê‰∫§ÊñπÂºèÔºå‰ΩÜÊòØÂèà‰∏çÂêåÔºå‰∫åÈò∂ÊÆµÊèê‰∫§‰∏çËÉΩÊòØÂ§öÊï∞ËäÇÁÇπÂêåÊÑèÔºåÂøÖÈ°ªÊòØÂÖ®ÈÉ®ÂêåÊÑè„ÄÇ‰∏∫‰∫ÜÈÅµÂÆàËøáÂçäËäÇÁÇπÂêåÊÑèÁöÑÁ∫¶ÊùüÔºåPaxosÁÆóÊ≥ïÂæÄÂæÄË¶ÅÊ±ÇËäÇÁÇπÊÄªÊï∞‰∏∫Â•áÊï∞„ÄÇ Paxos ÁÆóÊ≥ïËß£ÂÜ≥ÁöÑÈóÆÈ¢òÊòØÂú®‰∏Ä‰∏™ÂèØËÉΩÂèëÁîü‰∏äËø∞ÂºÇÂ∏∏ÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠Â¶Ç‰ΩïÂ∞±Êüê‰∏™ÂÄºËææÊàê‰∏ÄËá¥Ôºå‰øùËØÅ‰∏çËÆ∫ÂèëÁîü‰ª•‰∏ä‰ªª‰ΩïÂºÇÂ∏∏ÔºåÈÉΩ‰∏ç‰ºöÁ†¥ÂùèÂÜ≥ËÆÆÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂú∫ÊôØÊòØÔºåÂú®‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÁ≥ªÁªü‰∏≠ÔºåÂ¶ÇÊûúÂêÑËäÇÁÇπÁöÑÂàùÂßãÁä∂ÊÄÅ‰∏ÄËá¥ÔºåÊØè‰∏™ËäÇÁÇπÈÉΩÊâßË°åÁõ∏ÂêåÁöÑÊìç‰ΩúÂ∫èÂàóÔºåÈÇ£‰πà‰ªñ‰ª¨ÊúÄÂêéËÉΩÂæóÂà∞‰∏Ä‰∏™‰∏ÄËá¥ÁöÑÁä∂ÊÄÅ„ÄÇ‰∏∫‰øùËØÅÊØè‰∏™ËäÇÁÇπÊâßË°åÁõ∏ÂêåÁöÑÂëΩ‰ª§Â∫èÂàóÔºåÈúÄË¶ÅÂú®ÊØè‰∏ÄÊù°Êåá‰ª§‰∏äÊâßË°å‰∏Ä‰∏™„Äå‰∏ÄËá¥ÊÄßÁÆóÊ≥ï„Äç‰ª•‰øùËØÅÊØè‰∏™ËäÇÁÇπÁúãÂà∞ÁöÑÊåá‰ª§‰∏ÄËá¥„ÄÇ‰∏Ä‰∏™ÈÄöÁî®ÁöÑ‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÂèØ‰ª•Â∫îÁî®Âú®ËÆ∏Â§öÂú∫ÊôØ‰∏≠ÔºåÊòØÂàÜÂ∏ÉÂºèËÆ°ÁÆó‰∏≠ÁöÑÈáçË¶ÅÈóÆÈ¢ò„ÄÇ‰ªé20‰∏ñÁ∫™80Âπ¥‰ª£Ëµ∑ÂØπ‰∫é‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÁöÑÁ†îÁ©∂Â∞±Ê≤°ÊúâÂÅúÊ≠¢Ëøá„ÄÇ ÁÆÄÂçïËØ¥Êù•ÔºåPaxosÁöÑÁõÆÁöÑÊòØËÆ©Êï¥‰∏™ÈõÜÁæ§ÁöÑÁªìÁÇπÂØπÊüê‰∏™ÂÄºÁöÑÂèòÊõ¥ËææÊàê‰∏ÄËá¥„ÄÇPaxosÁÆóÊ≥ïÂü∫Êú¨‰∏äÊù•ËØ¥ÊòØ‰∏™Ê∞ë‰∏ªÈÄâ‰∏æÁöÑÁÆóÊ≥ï‚Äî‚ÄîÂ§ßÂ§öÊï∞ÁöÑÂÜ≥ÂÆö‰ºöÊàê‰∏™Êï¥‰∏™ÈõÜÁæ§ÁöÑÁªü‰∏ÄÂÜ≥ÂÆö„ÄÇ‰ªª‰Ωï‰∏Ä‰∏™ÁÇπÈÉΩÂèØ‰ª•ÊèêÂá∫Ë¶Å‰øÆÊîπÊüê‰∏™Êï∞ÊçÆÁöÑÊèêÊ°àÔºåÊòØÂê¶ÈÄöËøáËøô‰∏™ÊèêÊ°àÂèñÂÜ≥‰∫éËøô‰∏™ÈõÜÁæ§‰∏≠ÊòØÂê¶ÊúâË∂ÖËøáÂçäÊï∞ÁöÑÁªìÁÇπÂêåÊÑèÔºàÊâÄ‰ª•PaxosÁÆóÊ≥ïÈúÄË¶ÅÈõÜÁæ§‰∏≠ÁöÑÁªìÁÇπÊòØÂçïÊï∞Ôºâ„ÄÇ Ëøô‰∏™ÁÆóÊ≥ïÊúâ‰∏§‰∏™Èò∂ÊÆµÔºàÂÅáËÆæËøô‰∏™Êúâ‰∏â‰∏™ÁªìÁÇπÔºöAÔºåBÔºåCÔºâÔºö Á¨¨‰∏ÄÈò∂ÊÆµÔºöPrepareÈò∂ÊÆµAÊääÁî≥ËØ∑‰øÆÊîπÁöÑËØ∑Ê±ÇPrepare RequestÂèëÁªôÊâÄÊúâÁöÑÁªìÁÇπAÔºåBÔºåC„ÄÇÊ≥®ÊÑèÔºåPaxosÁÆóÊ≥ï‰ºöÊúâ‰∏Ä‰∏™Sequence NumberÔºà‰Ω†ÂèØ‰ª•ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™ÊèêÊ°àÂè∑ÔºåËøô‰∏™Êï∞‰∏çÊñ≠ÈÄíÂ¢ûÔºåËÄå‰∏îÊòØÂîØ‰∏ÄÁöÑÔºå‰πüÂ∞±ÊòØËØ¥AÂíåB‰∏çÂèØËÉΩÊúâÁõ∏ÂêåÁöÑÊèêÊ°àÂè∑ÔºâÔºåËøô‰∏™ÊèêÊ°àÂè∑‰ºöÂíå‰øÆÊîπËØ∑Ê±Ç‰∏ÄÂêåÂèëÂá∫Ôºå‰ªª‰ΩïÁªìÁÇπÂú®‚ÄúPrepareÈò∂ÊÆµ‚ÄùÊó∂ÈÉΩ‰ºöÊãíÁªùÂÖ∂ÂÄºÂ∞è‰∫éÂΩìÂâçÊèêÊ°àÂè∑ÁöÑËØ∑Ê±Ç„ÄÇÊâÄ‰ª•ÔºåÁªìÁÇπAÂú®ÂêëÊâÄÊúâÁªìÁÇπÁî≥ËØ∑‰øÆÊîπËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂ∏¶‰∏Ä‰∏™ÊèêÊ°àÂè∑ÔºåË∂äÊñ∞ÁöÑÊèêÊ°àÔºåËøô‰∏™ÊèêÊ°àÂè∑Â∞±Ë∂äÊòØÊòØÊúÄÂ§ßÁöÑ„ÄÇ Â¶ÇÊûúÊé•Êî∂ÁªìÁÇπÊî∂Âà∞ÁöÑÊèêÊ°àÂè∑nÂ§ß‰∫éÂÖ∂ÂÆÉÁªìÁÇπÂèëËøáÊù•ÁöÑÊèêÊ°àÂè∑ÔºåËøô‰∏™ÁªìÁÇπ‰ºöÂõûÂ∫îYesÔºàÊú¨ÁªìÁÇπ‰∏äÊúÄÊñ∞ÁöÑË¢´ÊâπÂáÜÊèêÊ°àÂè∑ÔºâÔºåÂπ∂‰øùËØÅ‰∏çÊé•Êî∂ÂÖ∂ÂÆÉ&lt;nÁöÑÊèêÊ°à„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÁªìÁÇπ‰∏äÂú®PrepareÈò∂ÊÆµÈáåÊÄªÊòØ‰ºöÂØπÊúÄÊñ∞ÁöÑÊèêÊ°àÂÅöÊâøËØ∫„ÄÇ ‰ºòÂåñÔºöÂú®‰∏äËø∞ prepare ËøáÁ®ã‰∏≠ÔºåÂ¶ÇÊûú‰ªª‰Ωï‰∏Ä‰∏™ÁªìÁÇπÂèëÁé∞Â≠òÂú®‰∏Ä‰∏™Êõ¥È´òÁºñÂè∑ÁöÑÊèêÊ°àÔºåÂàôÈúÄË¶ÅÈÄöÁü• ÊèêÊ°à‰∫∫ÔºåÊèêÈÜíÂÖ∂‰∏≠Êñ≠ËøôÊ¨°ÊèêÊ°à„ÄÇ Á¨¨‰∫åÈò∂ÊÆµÔºöAcceptÈò∂ÊÆµÂ¶ÇÊûúÊèêÊ°àËÄÖAÊî∂Âà∞‰∫ÜË∂ÖËøáÂçäÊï∞ÁöÑÁªìÁÇπËøîÂõûÁöÑYesÔºåÁÑ∂Âêé‰ªñÂ∞±‰ºöÂêëÊâÄÊúâÁöÑÁªìÁÇπÂèëÂ∏ÉAccept RequestÔºàÂêåÊ†∑ÔºåÈúÄË¶ÅÂ∏¶‰∏äÊèêÊ°àÂè∑nÔºâÔºåÂ¶ÇÊûúÊ≤°ÊúâË∂ÖËøáÂçäÊï∞ÁöÑËØùÔºåÈÇ£Â∞±ËøîÂõûÂ§±Ë¥•„ÄÇ ÂΩìÁªìÁÇπ‰ª¨Êî∂Âà∞‰∫ÜAccept RequestÂêéÔºåÂ¶ÇÊûúÂØπ‰∫éÊé•Êî∂ÁöÑÁªìÁÇπÊù•ËØ¥ÔºånÊòØÊúÄÂ§ßÁöÑ‰∫ÜÔºåÈÇ£‰πàÔºåÂÆÉÂ∞±‰ºöÈÄöËøárequestÔºà‰øÆÊîπËøô‰∏™ÂÄºÔºâÔºåÂ¶ÇÊûúÂèëÁé∞Ëá™Â∑±Êúâ‰∏Ä‰∏™Êõ¥Â§ßÁöÑÊèêÊ°àÂè∑ÔºåÈÇ£‰πàÔºåÁªìÁÇπÂ∞±‰ºöÊãíÁªùrequestÔºàÊãíÁªù‰øÆÊîπÔºâ„ÄÇ Êàë‰ª¨ÂèØ‰ª•Áúã‰ª•ÔºåËøô‰ºº‰πéÂ∞±ÊòØ‰∏Ä‰∏™‚Äú‰∏§ÊÆµÊèê‰∫§‚ÄùÁöÑ‰ºòÂåñ„ÄÇÂÖ∂ÂÆûÔºå2PC/3PCÈÉΩÊòØÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÁöÑÊÆãÊ¨°ÁâàÊú¨ÔºåGoogle ChubbyÁöÑ‰ΩúËÄÖMike BurrowsËØ¥ËøáËøô‰∏™‰∏ñÁïå‰∏äÂè™Êúâ‰∏ÄÁßç‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÔºåÈÇ£Â∞±ÊòØPaxosÔºåÂÖ∂ÂÆÉÁöÑÁÆóÊ≥ïÈÉΩÊòØÊÆãÊ¨°ÂìÅ„ÄÇ Êàë‰ª¨ËøòÂèØ‰ª•ÁúãÂà∞ÔºöÂØπ‰∫éÂêå‰∏Ä‰∏™ÂÄºÁöÑÂú®‰∏çÂêåÁªìÁÇπÁöÑ‰øÆÊîπÊèêÊ°àÂ∞±ÁÆóÊòØÂú®Êé•Êî∂ÊñπË¢´‰π±Â∫èÊî∂Âà∞‰πüÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑ„ÄÇ Âõõ„ÄÅRaftÂçèËÆÆ(Ëß£ÂÜ≥paxosÁöÑÂÆûÁé∞ÈöæÂ∫¶)Paxos Áõ∏ÊØî Raft ÊØîËæÉÂ§çÊùÇÂíåÈöæ‰ª•ÁêÜËß£„ÄÇËßíËâ≤ÊâÆÊºîÂíåÊµÅÁ®ãÊØî Raft ÈÉΩË¶ÅÂï∞Âó¶„ÄÇÊØîÂ¶Ç Agreement Ëøô‰∏™ÊµÅÁ®ãÔºåÂú® Paxos ÈáåËæπÔºöClient ÂèëËµ∑ËØ∑Ê±Ç‰∏æËçê Proposer Êàê‰∏∫ LeaderÔºåProposer ÁÑ∂ÂêéÂêëÂÖ®Â±Ä Acceptors ÂØªÊ±ÇÁ°ÆËÆ§ÔºåAcceptors ÂÖ®ÈÉ®ÂêåÊÑè Proposer ÂêéÔºåProposer ÁöÑ Leader Âú∞‰ΩçÂæóÂ∑≤ÊâøËÆ§ÔºåAcceptors ËøòÂæóÂÜçÂêëLearners ËøõË°åÂÖ®Â±ÄÂπøÊí≠Êù•ÂêåÊ≠•„ÄÇËÄåÂú® Raft ÈáåËæπÔºåÂè™Êúâ Follower/Candidate/Leader ‰∏âÁßçËßíËâ≤ÔºåËßíËâ≤Êú¨Ë∫´‰ª£Ë°®Áä∂ÊÄÅÔºåËßíËâ≤‰πãÈó¥ËøõË°åÁä∂ÊÄÅËΩ¨ÁßªÊòØ‰∏Ä‰ª∂ÈùûÂ∏∏Ëá™Áî±Ê∞ë‰∏ªÁöÑ‰∫ãÊÉÖ„ÄÇRaftËôΩÁÑ∂ÊúâËßíËâ≤‰πãÂàÜ‰ΩÜÊòØÊòØÂÖ®Ê∞ëÂèÇ‰∏éËøõË°åÈÄâ‰∏æÁöÑÊ®°ÂºèÔºõ‰ΩÜÊòØÂú®PaxosÈáåËæπÔºåÊÑüËßâÊõ¥ÂÉèËÆÆÂëòÂèÇÊîøÊ®°Âºè„ÄÇ ‰∏â‰∏™ËßíËâ≤follower„ÄÅcandidate„ÄÅleader„ÄÇÊúÄÂºÄÂßãÂ§ßÂÆ∂ÈÉΩÊòØfollowerÔºåÂΩìfollowerÁõëÂê¨‰∏çÂà∞leaderÔºåÂ∞±ÂèØ‰ª•Ëá™Â∑±Êàê‰∏∫candidateÔºåÂèëËµ∑ÊäïÁ•® leaderÈÄâ‰∏æÔºötimeoutÈôêÂà∂ÈÄâ‰∏æÁöÑtimeoutfollowerÊàê‰∏∫candidateÁöÑË∂ÖÊó∂Êó∂Èó¥ÔºåÊØè‰∏™followerÈÉΩÂú®150ms and 300ms‰πãÈó¥ÈöèÊú∫Ôºå‰πãÂêéÁúãË∞ÅÂÖàtimeoutÔºåË∞ÅÂ∞±ÂÖàÊàê‰∏∫candidateÔºåÁÑ∂ÂêéÂÆÉ‰ºöÂÖàÊäïËá™Â∑±‰∏ÄÁ•®ÔºåÂÜçÂêëÂÖ∂‰ªñËäÇÁÇπÂèëËµ∑ÊäïÁ•®ÈÇÄËØ∑„ÄÇÂ¶ÇÊûúÂÖ∂‰ªñËäÇÁÇπÂú®ËøôËΩÆÈÄâ‰∏æËøòÊ≤°ÊúâÊäïËøáÁ•®ÔºåÈÇ£‰πàÂ∞±ÁªôcandidateÊäïÁ•®ÔºåÁÑ∂ÂêéÈáçÁΩÆËá™Â∑±ÁöÑÈÄâ‰∏ætimeout„ÄÇÂ¶ÇÊûúÂæóÂà∞Â§ßÂ§öÊï∞ÁöÑÊäïÁ•®Â∞±Êàê‰∏∫leaderÔºå‰πãÂêéÂÆöÊúüÂºÄÂßãÂêëfollowerÂèëÈÄÅÂøÉË∑≥„ÄÇ Â¶ÇÊûú‰∏§‰∏™followerÂêåÊó∂Êàê‰∏∫candidateÁöÑËØùÔºåÂ¶ÇÊûúÊúÄÂêéÂæóÂà∞ÁöÑÁ•®Êï∞Áõ∏ÂêåÔºåÂàôÁ≠âÂæÖÂÖ∂‰ªñfollowerÁöÑÈÄâÊã©timeout‰πãÂêéÊàê‰∏∫candidateÔºåÁªßÁª≠ÂºÄÂßãÊñ∞‰∏ÄËΩÆÁöÑÈÄâ‰∏æ„ÄÇ logÂ§çÂà∂leaderÊääÂèòÂä®ÁöÑlogÂÄüÂä©ÂøÉË∑≥ÂêåÊ≠•ÁªôfollowerÔºåËøáÂçäÂõûÂ§ç‰πãÂêéÊâçÊàêÂäüÊèê‰∫§Ôºå‰πãÂêéÂÜç‰∏ã‰∏ÄÊ¨°ÂøÉË∑≥‰πãÂêéÔºåfollower‰πücommitÂèòÂä®ÔºåÂú®Ëá™Â∑±ÁöÑnode‰∏äÁîüÊïà„ÄÇ ÂàÜË£Ç‰πãÂêéÔºåÂè¶‰∏Ä‰∏™ÂàÜÂå∫ÁöÑfollowerÊé•Âèó‰∏çÂà∞leaderÁöÑtimeoutÔºåÁÑ∂Âêé‰ºöÊúâ‰∏Ä‰∏™ÂÖàtimeoutÔºåÊàê‰∏∫candidateÔºåÊúÄÂêéÊàê‰∏∫leader„ÄÇ‰∫éÊòØ‰∏§‰∏™ÂàÜÂå∫Â∞±Êúâ‰∫Ü‰∏§‰∏™leader„ÄÇ ÂΩìÂÆ¢Êà∑Á´ØÊúâÂèòÂä®Êó∂ÔºåÂÖ∂‰∏≠ÁöÑleaderÁî±‰∫éÊó†Ê≥ïÊî∂Âà∞ËøáÂçäÁöÑÊèê‰∫§ÔºåÂàô‰øùÊåÅÊú™Êèê‰∫§Áä∂ÊÄÅ„ÄÇÊúâÁöÑleaderÁöÑ‰øÆÊîπÔºåÂèØ‰ª•ÂæóÂà∞ËøáÂçäÁöÑÊèê‰∫§ÔºåÂàôÂèØ‰ª•‰øÆÊîπÁîüÊïà„ÄÇ ÂΩìÂàÜË£ÇÊÅ¢Â§ç‰πãÂêéÔºåleaderÂºÄÂßãÂØπÊØîÈÄâ‰∏æÁöÑtermÔºåÂèëÁé∞ÊúâÊõ¥È´òÁöÑtermÂ≠òÂú®Êó∂Ôºå‰ªñ‰ª¨‰ºöÊí§ÈîÄÊú™Êèê‰∫§ÁöÑ‰øÆÊîπÔºåÁÑ∂Âêé‰ª•ÊúÄÊñ∞ÁöÑ‰∏∫ÂáÜ„ÄÇ ‰∫î„ÄÅISRÁöÑÊú∫Âà∂(Ëß£ÂÜ≥fÂÆπÈîôÁöÑ2f+1ÊàêÊú¨ÈóÆÈ¢ò)KafkaÂπ∂Ê≤°Êúâ‰ΩøÁî®ZabÊàñPaxosÂçèËÆÆÁöÑÂ§öÊï∞ÊäïÁ•®Êú∫Âà∂Êù•‰øùËØÅ‰∏ªÂ§áÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåËÄåÊòØÊèêÂá∫‰∫ÜISRÁöÑÊú∫Âà∂ÔºàIn-Sync ReplicasÔºâÁöÑÊú∫Âà∂Êù•‰øùËØÅÊï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÇ ISRËÆ§‰∏∫ÂØπ‰∫é2f+1‰∏™ÂâØÊú¨Êù•ËØ¥ÔºåÂ§öÊï∞ÊäïÁ•®Êú∫Âà∂Ë¶ÅÊ±ÇÊúÄÂ§öÂè™ËÉΩÂÖÅËÆ∏f‰∏™ÂâØÊú¨ÂèëÁîüÊïÖÈöúÔºåÂ¶ÇÊûúË¶ÅÊîØÊåÅ2‰∏™ÂâØÊú¨ÁöÑÂÆπÈîôÔºåÂàôÈúÄË¶ÅËá≥Â∞ëÁª¥ÊåÅ5‰∏™ÂâØÊú¨ÔºåÂØπ‰∫éÊ∂àÊÅØÁ≥ªÁªüÁöÑÂú∫ÊôØÊù•ËØ¥ÔºåÊïàÁéáÂ§™‰Ωé„ÄÇ ISRÁöÑËøêË°åÊú∫Âà∂Â¶Ç‰∏ãÔºöÂ∞ÜÊâÄÊúâÊ¨°Á∫ßÂâØÊú¨Êï∞ÊçÆÂàÜÂà∞‰∏§‰∏™ÈõÜÂêàÔºåÂÖ∂‰∏≠‰∏Ä‰∏™Ë¢´Áß∞‰∏∫ISRÈõÜÂêàÔºåËøô‰∏™ÈõÜÂêàÂ§á‰ªΩÊï∞ÊçÆÁöÑÁâπÁÇπÊòØÂç≥Êó∂Âíå‰∏ªÂâØÊú¨Êï∞ÊçÆ‰øùÊåÅ‰∏ÄËá¥ÔºåËÄåÂè¶Â§ñ‰∏Ä‰∏™ÈõÜÂêàÁöÑÂ§á‰ªΩÊï∞ÊçÆÂÖÅËÆ∏ÂÖ∂Ê∂àÊÅØÈòüÂàóËêΩÂêé‰∫é‰∏ªÂâØÊú¨ÁöÑÊï∞ÊçÆ„ÄÇÂú®ÂÅö‰∏ªÂ§áÂàáÊç¢Êó∂ÔºåÂè™ÂÖÅËÆ∏‰ªéISRÈõÜÂêà‰∏≠ÈÄâÊã©‰∏ªÂâØÊú¨ÔºåÂè™ÊúâISRÈõÜÂêàÂÜÖÊâÄÊúâÂ§á‰ªΩÈÉΩÂÜôÊàêÂäüÊâçËÉΩËÆ§‰∏∫ËøôÊ¨°ÂÜôÂÖ•Êìç‰ΩúÊàêÂäü„ÄÇÂú®ÂÖ∑‰ΩìÂÆûÁé∞Êó∂ÔºåkafkaÂà©Áî®zookeeperÊù•‰øùÊåÅÊØè‰∏™ISRÈõÜÂêàÁöÑ‰ø°ÊÅØÔºåÂΩìISRÈõÜÂêàÂÜÖÊàêÂëòÂèòÂåñÊó∂ÔºåÁõ∏ÂÖ≥ÊûÑ‰ª∂‰πü‰æø‰∫éÈÄöÁü•„ÄÇÈÄöËøáËøôÁßçÊñπÂºèÔºåÂ¶ÇÊûúËÆæÂÆöISRÈõÜÂêàÂ§ßÂ∞è‰∏∫f+1ÔºåÈÇ£‰πàÂèØ‰ª•ÊúÄÂ§öÂÖÅËÆ∏f‰∏™ÂâØÊú¨ÊïÖÈöúÔºåËÄåÂØπ‰∫éÂ§öÊï∞ÊäïÁ•®Êú∫Âà∂Êù•ËØ¥ÔºåÂàôÈúÄË¶Å2f+1‰∏™ÂâØÊú¨ÊâçËÉΩËææÂà∞Áõ∏ÂêåÁöÑÂÆπÈîôÊÄß„ÄÇ ÂèÇËÄÉ ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑRaftÁÆóÊ≥ï Ëã±ÊñáÂä®ÁîªÊºîÁ§∫Raft(Êé®Ëçê) paxos-by-example ‰∏∫Âï•CoreOSÊ≤°Áî®PaxosÔºåÈáçÊñ∞Êêû‰∫ÜRaftÔºü]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏ãÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÂºè-GTS]]></title>
    <url>%2F2018%2F10%2F10%2F%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%8B%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F-GTS%2F</url>
    <content type="text"><![CDATA[1 ÂæÆÊúçÂä°ÁöÑÂèëÂ±ïÂæÆÊúçÂä°ÂÄ°ÂØºÂ∞ÜÂ§çÊùÇÁöÑÂçï‰ΩìÂ∫îÁî®ÊãÜÂàÜ‰∏∫Ëã•Âπ≤‰∏™ÂäüËÉΩÁÆÄÂçï„ÄÅÊùæËÄ¶ÂêàÁöÑÊúçÂä°ÔºåËøôÊ†∑ÂèØ‰ª•Èôç‰ΩéÂºÄÂèëÈöæÂ∫¶„ÄÅÂ¢ûÂº∫Êâ©Â±ïÊÄß„ÄÅ‰æø‰∫éÊïèÊç∑ÂºÄÂèë„ÄÇÂΩìÂâçË¢´Ë∂äÊù•Ë∂äÂ§öÁöÑÂºÄÂèëËÄÖÊé®Â¥áÔºåÂæàÂ§ö‰∫íËÅîÁΩëË°å‰∏öÂ∑®Â§¥„ÄÅÂºÄÊ∫êÁ§æÂå∫Á≠âÈÉΩÂºÄÂßã‰∫ÜÂæÆÊúçÂä°ÁöÑËÆ®ËÆ∫ÂíåÂÆûË∑µ„ÄÇHailoÊúâ160‰∏™‰∏çÂêåÊúçÂä°ÊûÑÊàêÔºåNetFlixÊúâÂ§ßÁ∫¶600‰∏™ÊúçÂä°„ÄÇÂõΩÂÜÖÊñπÈù¢ÔºåÈòøÈáåÂ∑¥Â∑¥„ÄÅËÖæËÆØ„ÄÅ360„ÄÅ‰∫¨‰∏ú„ÄÅ58ÂêåÂüéÁ≠âÂæàÂ§ö‰∫íËÅîÁΩëÂÖ¨Âè∏ÈÉΩËøõË°å‰∫ÜÂæÆÊúçÂä°ÂåñÂÆûË∑µ„ÄÇÂΩìÂâçÂæÆÊúçÂä°ÁöÑÂºÄÂèëÊ°ÜÊû∂‰πüÈùûÂ∏∏Â§öÔºåÊØîËæÉËëóÂêçÁöÑÊúâDubbo„ÄÅSpringCloud„ÄÅthrift „ÄÅgrpcÁ≠â„ÄÇ 2 ÂæÆÊúçÂä°ËêΩÂú∞Â≠òÂú®ÁöÑÈóÆÈ¢òËôΩÁÑ∂ÂæÆÊúçÂä°Áé∞Âú®Â¶ÇÁÅ´Â¶ÇËçºÔºå‰ΩÜÂØπÂÖ∂ÂÆûË∑µÂÖ∂ÂÆû‰ªçÂ§Ñ‰∫éÊé¢Á¥¢Èò∂ÊÆµ„ÄÇÂæàÂ§ö‰∏≠Â∞èÂûã‰∫íËÅîÁΩëÂÖ¨Âè∏ÔºåÈâ¥‰∫éÁªèÈ™å„ÄÅÊäÄÊúØÂÆûÂäõÁ≠âÈóÆÈ¢òÔºåÂæÆÊúçÂä°ËêΩÂú∞ÊØîËæÉÂõ∞Èöæ„ÄÇÂ¶ÇËëóÂêçÊû∂ÊûÑÂ∏àChris RichardsonÊâÄË®ÄÔºåÁõÆÂâçÂ≠òÂú®ÁöÑ‰∏ªË¶ÅÂõ∞ÈöæÊúâÂ¶Ç‰∏ãÂá†ÊñπÈù¢Ôºö 1ÔºâÂçï‰ΩìÂ∫îÁî®ÊãÜÂàÜ‰∏∫ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂêéÔºåËøõÁ®ãÈó¥ÁöÑÈÄöËÆØÊú∫Âà∂ÂíåÊïÖÈöúÂ§ÑÁêÜÊé™ÊñΩÂèòÁöÑÊõ¥Âä†Â§çÊùÇ„ÄÇ 2ÔºâÁ≥ªÁªüÂæÆÊúçÂä°ÂåñÂêéÔºå‰∏Ä‰∏™Áúã‰ººÁÆÄÂçïÁöÑÂäüËÉΩÔºåÂÜÖÈÉ®ÂèØËÉΩÈúÄË¶ÅË∞ÉÁî®Â§ö‰∏™ÊúçÂä°Âπ∂Êìç‰ΩúÂ§ö‰∏™Êï∞ÊçÆÂ∫ìÂÆûÁé∞ÔºåÊúçÂä°Ë∞ÉÁî®ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢òÂèòÁöÑÈùûÂ∏∏Á™ÅÂá∫„ÄÇ 3ÔºâÂæÆÊúçÂä°Êï∞Èáè‰ºóÂ§öÔºåÂÖ∂ÊµãËØï„ÄÅÈÉ®ÁΩ≤„ÄÅÁõëÊéßÁ≠âÈÉΩÂèòÁöÑÊõ¥Âä†Âõ∞Èöæ„ÄÇ ÈöèÁùÄRPCÊ°ÜÊû∂ÁöÑÊàêÁÜüÔºåÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÂ∑≤ÁªèÈÄêÊ∏êÂæóÂà∞Ëß£ÂÜ≥„ÄÇ‰æãÂ¶ÇdubboÂèØ‰ª•ÊîØÊåÅÂ§öÁßçÈÄöËÆØÂçèËÆÆÔºåspringcloudÂèØ‰ª•ÈùûÂ∏∏Â•ΩÁöÑÊîØÊåÅrestfulË∞ÉÁî®„ÄÇÂØπ‰∫éÁ¨¨‰∏â‰∏™ÈóÆÈ¢òÔºåÈöèÁùÄdocker„ÄÅdevopsÊäÄÊúØÁöÑÂèëÂ±ï‰ª•ÂèäÂêÑÂÖ¨Êúâ‰∫ëpaasÂπ≥Âè∞Ëá™Âä®ÂåñËøêÁª¥Â∑•ÂÖ∑ÁöÑÊé®Âá∫ÔºåÂæÆÊúçÂä°ÁöÑÊµãËØï„ÄÅÈÉ®ÁΩ≤‰∏éËøêÁª¥‰ºöÂèòÂæóË∂äÊù•Ë∂äÂÆπÊòì„ÄÇ ËÄåÂØπ‰∫éÁ¨¨‰∫å‰∏™ÈóÆÈ¢òÔºåÁé∞Âú®ËøòÊ≤°ÊúâÈÄöÁî®ÊñπÊ°àÂæàÂ•ΩÁöÑËß£ÂÜ≥ÂæÆÊúçÂä°‰∫ßÁîüÁöÑ‰∫ãÂä°ÈóÆÈ¢ò„ÄÇÂàÜÂ∏ÉÂºè‰∫ãÂä°Â∑≤ÁªèÊàê‰∏∫ÂæÆÊúçÂä°ËêΩÂú∞ÊúÄÂ§ßÁöÑÈòªÁ¢çÔºå‰πüÊòØÊúÄÂÖ∑ÊåëÊàòÊÄßÁöÑ‰∏Ä‰∏™ÊäÄÊúØÈöæÈ¢ò„ÄÇ ‰∏∫Ê≠§ÔºåÊú¨ÊñáÂ∞ÜÊ∑±ÂÖ•ÂíåÂ§ßÂÆ∂Êé¢ËÆ®ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏ãÔºåÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÂêÑÁßçËß£ÂÜ≥ÊñπÊ°àÔºåÂπ∂ÈáçÁÇπ‰∏∫Â§ßÂÆ∂Ëß£ËØªÈòøÈáåÂ∑¥Â∑¥ÊèêÂá∫ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°à‚Äî-GTS„ÄÇËØ•ÊñπÊ°à‰∏≠ÊèêÂà∞ÁöÑGTSÊòØÂÖ®Êñ∞‰∏Ä‰ª£Ëß£ÂÜ≥ÂæÆÊúçÂä°ÈóÆÈ¢òÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∫íËÅîÁΩë‰∏≠Èó¥‰ª∂„ÄÇ 3 SOAÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°à3.1 Âü∫‰∫éXAÂçèËÆÆÁöÑ‰∏§Èò∂ÊÆµÊèê‰∫§ÊñπÊ°à‰∫§Êòì‰∏≠Èó¥‰ª∂‰∏éÊï∞ÊçÆÂ∫ìÈÄöËøá XA Êé•Âè£ËßÑËåÉÔºå‰ΩøÁî®‰∏§Èò∂ÊÆµÊèê‰∫§Êù•ÂÆåÊàê‰∏Ä‰∏™ÂÖ®Â±Ä‰∫ãÂä°Ôºå XA ËßÑËåÉÁöÑÂü∫Á°ÄÊòØ‰∏§Èò∂ÊÆµÊèê‰∫§ÂçèËÆÆ„ÄÇÁ¨¨‰∏ÄÈò∂ÊÆµÊòØË°®ÂÜ≥Èò∂ÊÆµÔºåÊâÄÊúâÂèÇ‰∏éËÄÖÈÉΩÂ∞ÜÊú¨‰∫ãÂä°ËÉΩÂê¶ÊàêÂäüÁöÑ‰ø°ÊÅØÂèçÈ¶àÂèëÁªôÂçèË∞ÉËÄÖÔºõÁ¨¨‰∫åÈò∂ÊÆµÊòØÊâßË°åÈò∂ÊÆµÔºåÂçèË∞ÉËÄÖÊ†πÊçÆÊâÄÊúâÂèÇ‰∏éËÄÖÁöÑÂèçÈ¶àÔºåÈÄöÁü•ÊâÄÊúâÂèÇ‰∏éËÄÖÔºåÊ≠•Ë∞É‰∏ÄËá¥Âú∞Âú®ÊâÄÊúâÂàÜÊîØ‰∏äÊèê‰∫§ÊàñËÄÖÂõûÊªö„ÄÇ ‰∏§Èò∂ÊÆµÊèê‰∫§ÊñπÊ°àÂ∫îÁî®ÈùûÂ∏∏ÂπøÊ≥õÔºåÂá†‰πéÊâÄÊúâÂïÜ‰∏öOLTPÊï∞ÊçÆÂ∫ìÈÉΩÊîØÊåÅXAÂçèËÆÆ„ÄÇ‰ΩÜÊòØ‰∏§Èò∂ÊÆµÊèê‰∫§ÊñπÊ°àÈîÅÂÆöËµÑÊ∫êÊó∂Èó¥ÈïøÔºåÂØπÊÄßËÉΩÂΩ±ÂìçÂæàÂ§ßÔºåÂü∫Êú¨‰∏çÈÄÇÂêàËß£ÂÜ≥ÂæÆÊúçÂä°‰∫ãÂä°ÈóÆÈ¢ò„ÄÇ 3.2 TCCÊñπÊ°àTCCÊñπÊ°àÂú®ÁîµÂïÜ„ÄÅÈáëËûçÈ¢ÜÂüüËêΩÂú∞ËæÉÂ§ö„ÄÇTCCÊñπÊ°àÂÖ∂ÂÆûÊòØ‰∏§Èò∂ÊÆµÊèê‰∫§ÁöÑ‰∏ÄÁßçÊîπËøõ„ÄÇÂÖ∂Â∞ÜÊï¥‰∏™‰∏öÂä°ÈÄªËæëÁöÑÊØè‰∏™ÂàÜÊîØÊòæÂºèÁöÑÂàÜÊàê‰∫ÜTry„ÄÅConfirm„ÄÅCancel‰∏â‰∏™Êìç‰Ωú„ÄÇTryÈÉ®ÂàÜÂÆåÊàê‰∏öÂä°ÁöÑÂáÜÂ§áÂ∑•‰ΩúÔºåconfirmÈÉ®ÂàÜÂÆåÊàê‰∏öÂä°ÁöÑÊèê‰∫§ÔºåcancelÈÉ®ÂàÜÂÆåÊàê‰∫ãÂä°ÁöÑÂõûÊªö„ÄÇÂü∫Êú¨ÂéüÁêÜÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ ‰∫ãÂä°ÂºÄÂßãÊó∂Ôºå‰∏öÂä°Â∫îÁî®‰ºöÂêë‰∫ãÂä°ÂçèË∞ÉÂô®Ê≥®ÂÜåÂêØÂä®‰∫ãÂä°„ÄÇ‰πãÂêé‰∏öÂä°Â∫îÁî®‰ºöË∞ÉÁî®ÊâÄÊúâÊúçÂä°ÁöÑtryÊé•Âè£ÔºåÂÆåÊàê‰∏ÄÈò∂ÊÆµÂáÜÂ§á„ÄÇ‰πãÂêé‰∫ãÂä°ÂçèË∞ÉÂô®‰ºöÊ†πÊçÆtryÊé•Âè£ËøîÂõûÊÉÖÂÜµÔºåÂÜ≥ÂÆöË∞ÉÁî®confirmÊé•Âè£ÊàñËÄÖcancelÊé•Âè£„ÄÇÂ¶ÇÊûúÊé•Âè£Ë∞ÉÁî®Â§±Ë¥•Ôºå‰ºöËøõË°åÈáçËØï„ÄÇ TCCÊñπÊ°àËÆ©Â∫îÁî®Ëá™Â∑±ÂÆö‰πâÊï∞ÊçÆÂ∫ìÊìç‰ΩúÁöÑÁ≤íÂ∫¶Ôºå‰ΩøÂæóÈôç‰ΩéÈîÅÂÜ≤Á™Å„ÄÅÊèêÈ´òÂêûÂêêÈáèÊàê‰∏∫ÂèØËÉΩ„ÄÇ ÂΩìÁÑ∂TCCÊñπÊ°à‰πüÊúâ‰∏çË∂≥‰πãÂ§ÑÔºåÈõÜ‰∏≠Ë°®Áé∞Âú®‰ª•‰∏ã‰∏§‰∏™ÊñπÈù¢Ôºö ÂØπÂ∫îÁî®ÁöÑ‰æµÂÖ•ÊÄßÂº∫„ÄÇ‰∏öÂä°ÈÄªËæëÁöÑÊØè‰∏™ÂàÜÊîØÈÉΩÈúÄË¶ÅÂÆûÁé∞try„ÄÅconfirm„ÄÅcancel‰∏â‰∏™Êìç‰ΩúÔºåÂ∫îÁî®‰æµÂÖ•ÊÄßËæÉÂº∫ÔºåÊîπÈÄ†ÊàêÊú¨È´ò„ÄÇ ÂÆûÁé∞ÈöæÂ∫¶ËæÉÂ§ß„ÄÇÈúÄË¶ÅÊåâÁÖßÁΩëÁªúÁä∂ÊÄÅ„ÄÅÁ≥ªÁªüÊïÖÈöúÁ≠â‰∏çÂêåÁöÑÂ§±Ë¥•ÂéüÂõ†ÂÆûÁé∞‰∏çÂêåÁöÑÂõûÊªöÁ≠ñÁï•„ÄÇ‰∏∫‰∫ÜÊª°Ë∂≥‰∏ÄËá¥ÊÄßÁöÑË¶ÅÊ±ÇÔºåconfirmÂíåcancelÊé•Âè£ÂøÖÈ°ªÂÆûÁé∞ÂπÇÁ≠â„ÄÇ ‰∏äËø∞ÂéüÂõ†ÂØºËá¥TCCÊñπÊ°àÂ§ßÂ§öË¢´Á†îÂèëÂÆûÂäõËæÉÂº∫„ÄÅÊúâËø´ÂàáÈúÄÊ±ÇÁöÑÂ§ßÂÖ¨Âè∏ÊâÄÈááÁî®„ÄÇÂæÆÊúçÂä°ÂÄ°ÂØºÊúçÂä°ÁöÑËΩªÈáèÂåñ„ÄÅÊòìÈÉ®ÁΩ≤ÔºåËÄåTCCÊñπÊ°à‰∏≠ÂæàÂ§ö‰∫ãÂä°ÁöÑÂ§ÑÁêÜÈÄªËæëÈúÄË¶ÅÂ∫îÁî®Ëá™Â∑±ÁºñÁ†ÅÂÆûÁé∞ÔºåÂ§çÊùÇ‰∏îÂºÄÂèëÈáèÂ§ß„ÄÇ 3.3 Âü∫‰∫éÊ∂àÊÅØÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄßÊñπÊ°àÊ∂àÊÅØ‰∏ÄËá¥ÊÄßÊñπÊ°àÊòØÈÄöËøáÊ∂àÊÅØ‰∏≠Èó¥‰ª∂‰øùËØÅ‰∏ä„ÄÅ‰∏ãÊ∏∏Â∫îÁî®Êï∞ÊçÆÊìç‰ΩúÁöÑ‰∏ÄËá¥ÊÄß„ÄÇÂü∫Êú¨ÊÄùË∑ØÊòØÂ∞ÜÊú¨Âú∞Êìç‰ΩúÂíåÂèëÈÄÅÊ∂àÊÅØÊîæÂú®‰∏Ä‰∏™‰∫ãÂä°‰∏≠Ôºå‰øùËØÅÊú¨Âú∞Êìç‰ΩúÂíåÊ∂àÊÅØÂèëÈÄÅË¶Å‰πà‰∏§ËÄÖÈÉΩÊàêÂäüÊàñËÄÖÈÉΩÂ§±Ë¥•„ÄÇ‰∏ãÊ∏∏Â∫îÁî®ÂêëÊ∂àÊÅØÁ≥ªÁªüËÆ¢ÈòÖËØ•Ê∂àÊÅØÔºåÊî∂Âà∞Ê∂àÊÅØÂêéÊâßË°åÁõ∏Â∫îÊìç‰Ωú„ÄÇ Ê∂àÊÅØÊñπÊ°à‰ªéÊú¨Ë¥®‰∏äËÆ≤ÊòØÂ∞ÜÂàÜÂ∏ÉÂºè‰∫ãÂä°ËΩ¨Êç¢‰∏∫‰∏§‰∏™Êú¨Âú∞‰∫ãÂä°ÔºåÁÑ∂Âêé‰æùÈù†‰∏ãÊ∏∏‰∏öÂä°ÁöÑÈáçËØïÊú∫Âà∂ËææÂà∞ÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇÂü∫‰∫éÊ∂àÊÅØÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄßÊñπÊ°àÂØπÂ∫îÁî®‰æµÂÖ•ÊÄß‰πüÂæàÈ´òÔºåÂ∫îÁî®ÈúÄË¶ÅËøõË°åÂ§ßÈáè‰∏öÂä°ÊîπÈÄ†ÔºåÊàêÊú¨ËæÉÈ´ò„ÄÇ 4 GTS‚ÄìÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°àGTSÊòØ‰∏ÄÊ¨æÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏≠Èó¥‰ª∂ÔºåÁî±ÈòøÈáåÂ∑¥Â∑¥‰∏≠Èó¥‰ª∂ÈÉ®Èó®Á†îÂèëÔºåÂèØ‰ª•‰∏∫ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Êèê‰æõ‰∏ÄÁ´ôÂºèËß£ÂÜ≥ÊñπÊ°à„ÄÇ Êõ¥Â§öGTSËµÑÊñôËØ∑ËÆøÈóÆÂàõÂßã‰∫∫ÂæÆÂçö„ÄÇ 4.1 GTSÁöÑÊ†∏ÂøÉ‰ºòÂäø ÊÄßËÉΩË∂ÖÂº∫ GTSÈÄöËøáÂ§ßÈáèÂàõÊñ∞ÔºåËß£ÂÜ≥‰∫Ü‰∫ãÂä°ACIDÁâπÊÄß‰∏éÈ´òÊÄßËÉΩ„ÄÅÈ´òÂèØÁî®„ÄÅ‰Ωé‰æµÂÖ•‰∏çÂèØÂÖºÂæóÁöÑÈóÆÈ¢ò„ÄÇÂçï‰∫ãÂä°ÂàÜÊîØÁöÑÂπ≥ÂùáÂìçÂ∫îÊó∂Èó¥Âú®2msÂ∑¶Âè≥Ôºå3Âè∞ÊúçÂä°Âô®ÁªÑÊàêÁöÑÈõÜÁæ§ÂèØ‰ª•ÊîØÊíë3‰∏áTPS‰ª•‰∏äÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ËØ∑Ê±Ç„ÄÇ Â∫îÁî®‰æµÂÖ•ÊÄßÊûÅ‰Ωé GTSÂØπ‰∏öÂä°‰Ωé‰æµÂÖ•Ôºå‰∏öÂä°‰ª£Á†ÅÊúÄÂ∞ëÂè™ÈúÄË¶ÅÊ∑ªÂä†‰∏ÄË°åÊ≥®Ëß£Ôºà@TxcTransactionÔºâÂ£∞Êòé‰∫ãÂä°Âç≥ÂèØ„ÄÇ‰∏öÂä°‰∏é‰∫ãÂä°ÂàÜÁ¶ªÔºåÂ∞ÜÂæÆÊúçÂä°‰ªé‰∫ãÂä°‰∏≠Ëß£ÊîæÂá∫Êù•ÔºåÂæÆÊúçÂä°ÂÖ≥Ê≥®‰∫é‰∏öÂä°Êú¨Ë∫´Ôºå‰∏çÂÜçÈúÄË¶ÅËÄÉËôëÂèçÂêëÊé•Âè£„ÄÅÂπÇÁ≠â„ÄÅÂõûÊªöÁ≠ñÁï•Á≠âÂ§çÊùÇÈóÆÈ¢òÔºåÊûÅÂ§ßÈôç‰Ωé‰∫ÜÂæÆÊúçÂä°ÂºÄÂèëÁöÑÈöæÂ∫¶‰∏éÂ∑•‰ΩúÈáè„ÄÇ ÂÆåÊï¥Ëß£ÂÜ≥ÊñπÊ°à GTSÊîØÊåÅÂ§öÁßç‰∏ªÊµÅÁöÑÊúçÂä°Ê°ÜÊû∂ÔºåÂåÖÊã¨EDASÔºåDubboÔºåSpring CloudÁ≠â„ÄÇÊúâ‰∫õÊÉÖÂÜµ‰∏ãÔºåÂ∫îÁî®ÈúÄË¶ÅË∞ÉÁî®Á¨¨‰∏âÊñπÁ≥ªÁªüÁöÑÊé•Âè£ÔºåËÄåÁ¨¨‰∏âÊñπÁ≥ªÁªüÊ≤°ÊúâÊé•ÂÖ•GTS„ÄÇÊ≠§Êó∂ÈúÄË¶ÅÁî®Âà∞GTSÁöÑMTÊ®°Âºè„ÄÇGTSÁöÑMTÊ®°ÂºèÂèØ‰ª•Á≠â‰ª∑‰∫éTCCÊ®°ÂºèÔºåÁî®Êà∑ÂèØ‰ª•Ê†πÊçÆËá™Ë∫´‰∏öÂä°ÈúÄÊ±ÇËá™ÂÆö‰πâÊØè‰∏™‰∫ãÂä°Èò∂ÊÆµÁöÑÂÖ∑‰ΩìË°å‰∏∫„ÄÇMTÊ®°ÂºèÊèê‰æõ‰∫ÜÊõ¥Â§öÁöÑÁÅµÊ¥ªÊÄßÔºåÂèØËÉΩÊÄßÔºå‰ª•ËææÂà∞ÁâπÊÆäÂú∫ÊôØ‰∏ãÁöÑËá™ÂÆö‰πâ‰ºòÂåñÂèäÁâπÊÆäÂäüËÉΩÁöÑÂÆûÁé∞„ÄÇ ÂÆπÈîôËÉΩÂäõÂº∫ GTSËß£ÂÜ≥‰∫ÜXA‰∫ãÂä°ÂçèË∞ÉÂô®ÂçïÁÇπÈóÆÈ¢òÔºåÂÆûÁé∞ÁúüÊ≠£ÁöÑÈ´òÂèØÁî®ÔºåÂèØ‰ª•‰øùËØÅÂêÑÁßçÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ãÁöÑ‰∏•Ê†ºÊï∞ÊçÆ‰∏ÄËá¥„ÄÇ 4.2 GTSÁöÑÂ∫îÁî®Âú∫ÊôØGTSÂèØÂ∫îÁî®Âú®Ê∂âÂèäÊúçÂä°Ë∞ÉÁî®ÁöÑÂ§ö‰∏™È¢ÜÂüüÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫éÈáëËûçÊîØ‰ªò„ÄÅÁîµ‰ø°„ÄÅÁîµÂ≠êÂïÜÂä°„ÄÅÂø´ÈÄíÁâ©ÊµÅ„ÄÅÂπøÂëäËê•ÈîÄ„ÄÅÁ§æ‰∫§„ÄÅÂç≥Êó∂ÈÄö‰ø°„ÄÅÊâãÊ∏∏„ÄÅËßÜÈ¢ë„ÄÅÁâ©ËÅîÁΩë„ÄÅËΩ¶ËÅîÁΩëÁ≠âÔºåËØ¶ÁªÜ‰ªãÁªçÂèØ‰ª•ÈòÖËØª „ÄäGTS‚ÄìÈòøÈáåÂ∑¥Â∑¥ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÂÖ®Êñ∞Ëß£ÂÜ≥ÊñπÊ°à„Äã‰∏ÄÊñá„ÄÇ 4.3 GTS‰∏éÂæÆÊúçÂä°ÁöÑÈõÜÊàêGTSÂåÖÊã¨ÂÆ¢Êà∑Á´ØÔºàGTS ClientÔºâ„ÄÅËµÑÊ∫êÁÆ°ÁêÜÂô®ÔºàGTS RMÔºâÂíå‰∫ãÂä°ÂçèË∞ÉÂô®ÔºàGTS ServerÔºâ‰∏â‰∏™ÈÉ®ÂàÜ„ÄÇGTS Client‰∏ªË¶ÅÁî®Êù•ÁïåÂÆö‰∫ãÂä°ËæπÁïåÔºåÂÆåÊàê‰∫ãÂä°ÁöÑÂèëËµ∑‰∏éÁªìÊùü„ÄÇGTS RMÂÆåÊàê‰∫ãÂä°ÂàÜÊîØÁöÑÂàõÂª∫„ÄÅÊèê‰∫§„ÄÅÂõûÊªöÁ≠âÊìç‰Ωú„ÄÇGTS Server‰∏ªË¶ÅË¥üË¥£ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÊï¥‰ΩìÊé®ËøõÔºå‰∫ãÂä°ÁîüÂëΩÂë®ÊúüÁöÑÁÆ°ÁêÜ„ÄÇGTSÂíåÂæÆÊúçÂä°ÈõÜÊàêÁöÑÁªìÊûÑÂõæÂ¶Ç‰∏ãÊâÄÁ§∫ÔºåGTS ClientÈúÄË¶ÅÂíå‰∏öÂä°Â∫îÁî®ÈõÜÊàêÈÉ®ÁΩ≤ÔºåRM‰∏éÂæÆÊúçÂä°ÈõÜÊàêÈÉ®ÁΩ≤„ÄÇ 4.4 GTSÁöÑËæìÂá∫ÂΩ¢ÂºèGTSÁõÆÂâçÊúâ‰∏âÁßçËæìÂá∫ÂΩ¢ÂºèÔºöÂÖ¨Êúâ‰∫ëËæìÂá∫„ÄÅÂÖ¨ÁΩëËæìÂá∫„ÄÅ‰∏ìÊúâ‰∫ëËæìÂá∫„ÄÇ 4.4.1 ÂÖ¨Êúâ‰∫ëËæìÂá∫ËøôÁßçËæìÂá∫ÂΩ¢ÂºèÈù¢ÂêëÈòøÈáå‰∫ëÁî®Êà∑„ÄÇÂ¶ÇÊûúÁî®Êà∑ÁöÑ‰∏öÂä°Á≥ªÁªüÂ∑≤ÁªèÈÉ®ÁΩ≤Âà∞ÈòøÈáå‰∫ë‰∏äÔºåÂèØ‰ª•Áî≥ËØ∑ÂºÄÈÄöÂÖ¨Êúâ‰∫ëGTS„ÄÇÂºÄÈÄöÂêé‰∏öÂä°Â∫îÁî®Âç≥ÂèØÈÄöËøáGTS‰øùËØÅÊúçÂä°Ë∞ÉÁî®ÁöÑ‰∏ÄËá¥ÊÄß„ÄÇËøôÁßç‰ΩøÁî®Âú∫ÊôØ‰∏ãÔºå‰∏öÂä°Á≥ªÁªüÂíåGTSÈó¥ÁöÑÁΩëÁªúÁéØÂ¢ÉÊØîËæÉÁêÜÊÉ≥ÔºåËææÂà∞ÂæàÂ•ΩÊÄßËÉΩ„ÄÇ 4.4.2 ÂÖ¨ÁΩëËæìÂá∫ËøôÁßçËæìÂá∫ÂΩ¢ÂºèÈù¢Âêë‰∫éÈùûÈòøÈáå‰∫ëÁöÑÁî®Êà∑Ôºå‰ΩøÁî®Êõ¥Âä†Êñπ‰æø„ÄÅÁÅµÊ¥ªÔºå‰∏öÂä°Á≥ªÁªüÂè™Ë¶ÅËÉΩËøûÊé•‰∫íËÅîÁΩëÂç≥ÂèØ‰∫´ÂèóGTSÊèê‰æõÁöÑ‰∫ëÊúçÂä°Ôºà‰∏éÂÖ¨Êúâ‰∫ëËæìÂá∫ÁöÑÂ∑ÆÂà´Âú®‰∫éÂÆ¢Êà∑Á´ØÈÉ®ÁΩ≤‰∫éÁî®Êà∑Êú¨Âú∞ÔºåËÄå‰∏çÂú®‰∫ë‰∏äÔºâ„ÄÇ Âú®Ê≠£Â∏∏ÁΩëÁªúÁéØÂ¢É‰∏ãÔºå‰ª•ÂåÖÂê´‰∏§‰∏™Êú¨Âú∞‰∫ãÂä°ÁöÑÂÖ®Â±Ä‰∫ãÂä°‰∏∫‰æãÔºå‰∫ãÂä°ÂÆåÊàêÊó∂Èó¥Âú®20msÂ∑¶Âè≥Ôºå50‰∏™Âπ∂ÂèëÂ∞±ÂèØ‰ª•ËΩªÊùæÂÆûÁé∞1000TPS‰ª•‰∏äÂàÜÂ∏ÉÂºè‰∫ãÂä°ÔºåÂØπÁªùÂ§ßÂ§öÊï∞‰∏öÂä°Êù•ËØ¥ÊÄßËÉΩÊòØË∂≥Â§üÁöÑ„ÄÇÂú®ÂÖ¨ÁΩëÁéØÂ¢ÉÔºåÁΩëÁªúÈó™Êñ≠ÂæàÈöæÂÆåÂÖ®ÈÅøÂÖçÔºåËøôÁßçÊÉÖÂÜµ‰∏ãGTS‰ªçËÉΩ‰øùËØÅÊúçÂä°Ë∞ÉÁî®ÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÇ ÂÖ∑‰Ωì‰ΩøÁî®Ê†∑‰æã‰ΩøÁî®ÂèÇËßÅ4.7ËäÇGTSÁöÑÂ∑•Á®ãÊ†∑‰æã„ÄÇ 4.4.3 ‰∏ìÊúâ‰∫ëËæìÂá∫ËøôÁßçÂΩ¢Âºè‰∏ªË¶ÅÈù¢Âêë‰∫éÂ∑≤Âª∫ËÆæ‰∫ÜËá™Â∑±‰∏ìÊúâ‰∫ëÂπ≥Âè∞ÁöÑÂ§ßÁî®Êà∑ÔºåGTSÂèØ‰ª•Áõ¥Êé•ÈÉ®ÁΩ≤Âà∞Áî®Êà∑ÁöÑ‰∏ìÊúâ‰∫ë‰∏äÔºå‰∏∫‰∏ìÊúâ‰∫ëÊèê‰æõÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊúçÂä°„ÄÇÁõÆÂâçÂ∑≤ÁªèÊúâ10Â§ö‰∏™ÁâπÂ§ßÂûã‰ºÅ‰∏öÁöÑ‰∏ìÊúâ‰∫ë‰ΩøÁî®GTSËß£ÂÜ≥ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈöæÈ¢òÔºåÊÄßËÉΩ‰∏éÁ®≥ÂÆöÊÄßÁªèËøá‰∫ÜÁî®Êà∑ÁöÑ‰∏•Ê†ºÊ£ÄÊµã„ÄÇ 4.5 GTSÁöÑ‰ΩøÁî®ÊñπÂºèGTSÂØπÂ∫îÁî®ÁöÑ‰æµÂÖ•ÊÄßÈùûÂ∏∏‰ΩéÔºå‰ΩøÁî®‰πüÂæàÁÆÄÂçï„ÄÇ‰∏ãÈù¢‰ª•ËÆ¢ÂçïÂ≠òÂÇ®Â∫îÁî®‰∏∫‰æãËØ¥Êòé„ÄÇËÆ¢Âçï‰∏öÂä°Â∫îÁî®ÈÄöËøáË∞ÉÁî®ËÆ¢ÂçïÊúçÂä°ÂíåÂ∫ìÂ≠òÊúçÂä°ÂÆåÊàêËÆ¢Âçï‰∏öÂä°ÔºåÊúçÂä°ÂºÄÂèëÊ°ÜÊû∂‰∏∫Dubbo„ÄÇ 4.5.1 ËÆ¢Âçï‰∏öÂä°Â∫îÁî®Âú®‰∏öÂä°ÂáΩÊï∞Â§ñÂõ¥‰ΩøÁî®@TxcTransactionÊ≥®Ëß£Âç≥ÂèØÂºÄÂêØÂàÜÂ∏ÉÂºè‰∫ãÂä°„ÄÇDubboÂ∫îÁî®ÈÄöËøáÈöêËóèÂèÇÊï∞Â∞ÜGTSÁöÑ‰∫ãÂä°xid‰º†Êí≠Âà∞ÊúçÂä°Á´Ø„ÄÇ 1234567891011121314151617 @TxcTransaction(timeout = 1000 * 10)public void Bussiness(OrderService orderService, StockService stockService, String userId) &#123; //Ëé∑Âèñ‰∫ãÂä°‰∏ä‰∏ãÊñá String xid = TxcContext.getCurrentXid(); //ÈÄöËøáRpcContextÂ∞Üxid‰º†Âà∞‰∏Ä‰∏™ÊúçÂä°Á´Ø RpcContext.getContext().setAttachment("xid", xid); //ÊâßË°åËá™Â∑±ÁöÑ‰∏öÂä°ÈÄªËæë int productId = new Random().nextInt(100); int productNum = new Random().nextInt(100); OrderDO orderDO = new OrderDO(userId, productId, productNum, new Timestamp(new Date().getTime())); orderService.createOrder(orderDO); //ÈÄöËøáRpcContextÂ∞Üxid‰º†Âà∞Âè¶‰∏Ä‰∏™ÊúçÂä°Á´Ø RpcContext.getContext().setAttachment("xid",xid); stockService.updateStock(orderDO);&#125; 4.5.2 ÊúçÂä°Êèê‰æõËÄÖÊõ¥Êñ∞Â∫ìÂ≠òÊñπÊ≥ï 1234567891011121314151617public int updateStock(OrderDO orderDO) &#123;//Ëé∑ÂèñÂÖ®Â±Ä‰∫ãÂä°IDÔºåÂπ∂ÁªëÂÆöÂà∞‰∏ä‰∏ãÊñáString xid = RpcContext.getContext().getAttachment("xid");TxcContext.bind(xid,null);//ÊâßË°åËá™Â∑±ÁöÑ‰∏öÂä°ÈÄªËæëint ret = jdbcTemplate.update("update stock set amount = amount - ? where product_id = ?",new Object[]&#123;orderDO.getNumber(), orderDO.getProductId()&#125;);TxcContext.unbind();return ret;&#125; 4.6 GTSÁöÑÂ∫îÁî®ÊÉÖÂÜµGTSÁõÆÂâçÂ∑≤ÁªèÂú®Ê∑òÂÆù„ÄÅÂ§©Áå´„ÄÅÈòøÈáåÂΩ±‰∏ö„ÄÅÊ∑òÁ•®Á•®„ÄÅÈòøÈáåÂ¶àÂ¶à„ÄÅ1688Á≠âÈòøÈáåÂêÑ‰∏öÂä°Á≥ªÁªüÂπøÊ≥õ‰ΩøÁî®ÔºåÁªèÂèó‰∫Ü16Âπ¥Âíå17Âπ¥‰∏§Âπ¥ÂèåÂçÅ‰∏ÄÊµ∑ÈáèËØ∑Ê±ÇÁöÑËÄÉÈ™å„ÄÇÊüêÁ∫ø‰∏ä‰∏öÂä°Á≥ªÁªüÊúÄÈ´òÊµÅÈáèÂ∑≤ËææÂçÅ‰∏áTPSÔºàÊØèÁßíÈíü10‰∏áÁ¨î‰∫ãÂä°Ôºâ„ÄÇ GTSÂú®ÂÖ¨Êúâ‰∫ëÂíå‰∏ìÊúâ‰∫ëËæìÂá∫ÂêéÔºåÂ∑≤ÁªèÊúâ‰∫Ü100Â§ö‰∏™Á∫ø‰∏äÁî®Êà∑ÔºåÂæàÂ§öÁî®Êà∑ÈÄöËøáGTSËß£ÂÜ≥SpringCloud„ÄÅDubbo„ÄÅEdasÁ≠âÊúçÂä°Ê°ÜÊû∂ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò„ÄÇ‰∏öÂä°È¢ÜÂüüÊ∂âÂèäÁîµÂäõ„ÄÅÁâ©ÊµÅ„ÄÅETC„ÄÅÁÉüËçâ„ÄÅÈáëËûç„ÄÅÈõ∂ÂîÆ„ÄÅÁîµÂïÜ„ÄÅÂÖ±‰∫´Âá∫Ë°åÁ≠âÂçÅÂá†‰∏™Ë°å‰∏öÔºåÂæóÂà∞Áî®Êà∑ÁöÑ‰∏ÄËá¥ËÆ§ÂèØ„ÄÇ ‰∏äÂõæÊòØGTS‰∏éSpringCloudÈõÜÊàêÔºåÂ∫îÁî®‰∫éÊüêÂÖ±‰∫´Âá∫Ë°åÁ≥ªÁªü„ÄÇ‰∏öÂä°ÂÖ±‰∫´Âá∫Ë°åÂú∫ÊôØ‰∏ãÔºåÈÄöËøáGTSÊîØÊíëÁâ©ËÅîÁΩëÁ≥ªÁªü„ÄÅËÆ¢ÂçïÁ≥ªÁªü„ÄÅÊîØ‰ªòÁ≥ªÁªü„ÄÅËøêÁª¥Á≥ªÁªü„ÄÅÂàÜÊûêÁ≥ªÁªüÁ≠âÁ≥ªÂêÑÁªüÂ∫îÁî®ÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºå‰øùËØÅÊµ∑ÈáèËÆ¢ÂçïÂíåÊï∞ÂçÉ‰∏áÊµÅÊ∞¥ÁöÑ‰∫§Êòì„ÄÇ 4.7 GTSÁöÑÂ∑•Á®ãÊ†∑‰æãGTSÁöÑÂÖ¨Êúâ‰∫ëÊ†∑‰æãÂèØÂèÇËÄÉÈòøÈáå‰∫ëÁΩëÁ´ô„ÄÇÂú®ÂÖ¨ÁΩëÁéØÂ¢É‰∏ãÊèê‰æõsample-txc-simpleÂíåsample-txc-dubbo‰∏§‰∏™Ê†∑‰æãÂ∑•Á®ã„ÄÇ 4.7.1 sample-txc-simpleÊ†∑‰æã4.7.1.1 Ê†∑‰æã‰∏öÂä°ÈÄªËæëËØ•Ê†∑‰æãÊòØGTSÁöÑÂÖ•Èó®sampleÔºåÊ°à‰æãÁöÑ‰∏öÂä°ÈÄªËæëÊòØ‰ªéAË¥¶Êà∑ËΩ¨Ë¥¶ÁªôBË¥¶Êà∑ÔºåÂÖ∂‰∏≠AÂíåBÂàÜÂà´‰Ωç‰∫é‰∏§‰∏™MySQLÊï∞ÊçÆÂ∫ì‰∏≠Ôºå‰ΩøÁî®GTS‰∫ãÂä°‰øùËØÅAÂíåBË¥¶Êà∑Èí±ÁöÑÊÄªÊï∞ÂßãÁªà‰∏çÂèò„ÄÇ 4.7.1.2 Ê†∑‰æãÊê≠Âª∫ÊñπÊ≥ï1) ÂáÜÂ§áÊï∞ÊçÆÂ∫ìÁéØÂ¢É ÂÆâË£ÖMySQLÔºåÂàõÂª∫‰∏§‰∏™Êï∞ÊçÆÂ∫ìdb1Âíådb2„ÄÇÂú®db1Âíådb2‰∏≠ÂàÜÂà´ÂàõÂª∫txc_undo_logË°®ÔºàSQLËÑöÊú¨ËßÅ4.7.3Ôºâ„ÄÇÂú®db1Â∫ì‰∏≠ÂàõÂª∫user_money_aË°®ÔºåÂú®db2Â∫ì‰∏≠ÂàõÂª∫user_money_bË°®„ÄÇ 2) ‰∏ãËΩΩÊ†∑‰æã Â∞Üsample-txc-simpleÊñá‰ª∂‰∏ãËΩΩÂà∞Êú¨Âú∞ÔºåÊ†∑‰æã‰∏≠Â∑≤ÁªèÂåÖÂê´‰∫ÜGTSÁöÑSDK„ÄÇ 3) ‰øÆÊîπÈÖçÁΩÆ ÊâìÂºÄsample-txc-simple/src/main/resourcesÁõÆÂΩï‰∏ãÁöÑtxc-client-context.xmlÔºåÂ∞ÜÊï∞ÊçÆÊ∫êÁöÑurl„ÄÅusername„ÄÅpassword‰øÆÊîπ‰∏∫ÂÆûÈôÖÂÄº„ÄÇ 4) ËøêË°åÊ†∑‰æã Âú®sample-txc-simpleÁõÆÂΩï‰∏ãÊâßË°åbuild.shÁºñËØëÊú¨Â∑•Á®ã„ÄÇÁºñËØëÂÆåÊàêÂêéÊâßË°årun.sh„ÄÇ 4.7.2 sample-txc-dubbo Ê†∑‰æã4.7.2.1 Ê†∑‰æã‰∏öÂä°ÈÄªËæëÊú¨Ê°à‰æãÊ®°Êãü‰∫ÜÁî®Êà∑‰∏ãËÆ¢Âçï„ÄÅÂáèÂ∫ìÂ≠òÁöÑ‰∏öÂä°ÈÄªËæë„ÄÇÂÆ¢Êà∑Á´ØÔºàClientÔºâÈÄöËøáË∞ÉÁî®ËÆ¢ÂçïÊúçÂä°ÔºàOrderServiceÔºâÂàõÂª∫ËÆ¢ÂçïÔºå‰πãÂêéÈÄöËøáË∞ÉÁî®Â∫ìÂ≠òÊúçÂä°ÔºàStockServiceÔºâÊâ£Â∫ìÂ≠ò„ÄÇÂÖ∂‰∏≠ËÆ¢ÂçïÊúçÂä°ËØªÂÜôËÆ¢ÂçïÊï∞ÊçÆÂ∫ìÔºåÂ∫ìÂ≠òÊúçÂä°ËØªÂÜôÂ∫ìÂ≠òÊï∞ÊçÆÂ∫ì„ÄÇÁî± GTS ‰øùËØÅË∑®ÊúçÂä°‰∫ãÂä°ÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ 4.7.2.2 Ê†∑‰æãÊê≠Âª∫ÊñπÊ≥ï1) ÂáÜÂ§áÊï∞ÊçÆÂ∫ìÁéØÂ¢É ÂÆâË£ÖMySQLÔºåÂàõÂª∫‰∏§‰∏™Êï∞ÊçÆÂ∫ìdb1Âíådb2„ÄÇÂú®db1Âíådb2‰∏≠ÂàÜÂà´ÂàõÂª∫txc_undo_logË°®„ÄÇÂú®db1Â∫ì‰∏≠ÂàõÂª∫ordersË°®ÔºåÂú®db2Â∫ì‰∏≠ÂàõÂª∫stockË°®„ÄÇ 2) ‰∏ãËΩΩÊ†∑‰æã Â∞ÜÊ†∑‰æãÊñá‰ª∂sample-txc-dubbo‰∏ãËΩΩÂà∞Êú¨Âú∞Êú∫Âô®ÔºåÊ†∑‰æã‰∏≠Â∑≤ÁªèÂåÖÂê´‰∫ÜGTSÁöÑSDK„ÄÇ 3) ‰øÆÊîπÈÖçÁΩÆ ÊâìÂºÄsample-txc-dubbo/src/main/resourcesÁõÆÂΩïÔºåÂ∞Üdubbo-order-service.xml„ÄÅdubbo-stock-service.xml‰∏§‰∏™Êñá‰ª∂‰∏≠Êï∞ÊçÆÊ∫êÁöÑurl„ÄÅusername„ÄÅpassword‰øÆÊîπ‰∏∫ÂÆûÈôÖÂÄº„ÄÇ 4) ËøêË°åÊ†∑‰æã a. ÁºñËØëÁ®ãÂ∫è Âú®Â∑•Á®ãÊ†πÁõÆÂΩïÊâßË°å build.sh ÂëΩ‰ª§ÔºåÁºñËØëÂ∑•Á®ã„ÄÇÁºñËØëÂêé‰ºöÂú® sample-txc-dubbo/client/bin ÁõÆÂΩï‰∏ãÁîüÊàê order_run.sh„ÄÅstock_run.sh„ÄÅclient_run.sh ‰∏â‰∏™ËøêË°åËÑöÊú¨ÂØπÂ∫îËÆ¢ÂçïÊúçÂä°„ÄÅÂ∫ìÂ≠òÊúçÂä°‰ª•ÂèäÂÆ¢Êà∑Á´Ø„ÄÇ b. ËøêË°åÁ®ãÂ∫è Âú®Ê†πÁõÆÂΩïÊâßË°årun.shÔºåËØ•ËÑöÊú¨‰ºö‰æùÊ¨°ÂêØÂä®order_run.sh(ËÆ¢ÂçïÊúçÂä°)„ÄÅstock_run.sh(Â∫ìÂ≠òÊúçÂä°)Âíåclient_run.sh(ÂÆ¢Êà∑Á´ØÁ®ãÂ∫è)„ÄÇ 4.7.2.3 ÂÖ∂‰ªñËØ¥ÊòéÊ†∑‰æã‰ΩøÁî®MulticastÊ≥®ÂÜå‰∏≠ÂøÉÁöÑÂ£∞ÊòéÊñπÂºè„ÄÇÂ¶ÇÊûúÊú¨Êú∫‰ΩøÁî®Êó†Á∫øÁΩëÁªúÔºådubboÊúçÂä°Âú®ÁªëÂÆöÂú∞ÂùÄÊó∂ÊúâÂèØËÉΩËé∑Âèñipv6Âú∞ÂùÄÔºåÂèØ‰ª•ÈÄöËøájvmÂêØÂä®ÂèÇÊï∞Á¶ÅÁî®„ÄÇÊñπÊ≥ïÊòØÈÖçÁΩÆjvmÂêØÂä®ÂèÇÊï∞ -Djava.net.preferIPv4Stack=true„ÄÇ 4.7.3 SQL4.7.3.1 Âª∫Ë°® txc_undo_logCREATE TABLE txc_undo_log ( id bigint(20) NOT NULL AUTO_INCREMENT COMMENT ‚Äò‰∏ªÈîÆ‚Äô, gmt_create datetime NOT NULL COMMENT ‚ÄòÂàõÂª∫Êó∂Èó¥‚Äô, gmt_modified datetime NOT NULL COMMENT ‚Äò‰øÆÊîπÊó∂Èó¥‚Äô, xid varchar(100) NOT NULL COMMENT ‚ÄòÂÖ®Â±Ä‰∫ãÂä°ID‚Äô, branch_id bigint(20) NOT NULL COMMENT ‚ÄòÂàÜÊîØ‰∫ãÂä°ID‚Äô, rollback_info longblob NOT NULL COMMENT ‚ÄòLOG‚Äô, status int(11) NOT NULL COMMENT ‚ÄòÁä∂ÊÄÅ‚Äô, server varchar(32) NOT NULL COMMENT ‚ÄòÂàÜÊîØÊâÄÂú®DB IP‚Äô, PRIMARY KEY (id), KEY unionkey (xid,branch_id) ) ENGINE=InnoDB AUTO_INCREMENT=211225994 DEFAULT CHARSET=utf8 COMMENT=‚Äô‰∫ãÂä°Êó•ÂøóË°®‚Äô; 4.7.3.2 Âª∫Ë°® user_money_aCREATE TABLE user_money_a ( id int(11) NOT NULL AUTO_INCREMENT, money int(11) DEFAULT NULL, PRIMARY KEY (id) ) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8; 4.7.3.3 Âª∫Ë°® user_money_bCREATE TABLE user_money_b ( id int(11) NOT NULL AUTO_INCREMENT, money int(11) DEFAULT NULL, PRIMARY KEY (id) ) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8; 4.7.3.4 Âª∫Ë°® ordersCREATE TABLE orders ( id bigint(20) NOT NULL AUTO_INCREMENT, user_id varchar(255) NOT NULL, product_id int(11) NOT NULL, number int(11) NOT NULL, gmt_create timestamp NOT NULL, PRIMARY KEY (id) ) ENGINE=MyISAM AUTO_INCREMENT=351 DEFAULT CHARSET=utf8 4.7.3.5 Âª∫Ë°® stockCREATE TABLE stock ( product_id int(11) NOT NULL, price float NOT NULL, amount int(11) NOT NULL, PRIMARY KEY (product_id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 https://www.cnblogs.com/jiangyu666/p/8522547.html]]></content>
      <categories>
        <category>ÂæÆÊúçÂä°</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring AutowireCapableBeanFactory Êï¥Âêà quartz]]></title>
    <url>%2F2018%2F09%2F27%2FSpring-AutowireCapableBeanFactory-%E6%95%B4%E5%90%88-quartz%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØÊúÄËøëÂÅöspring‰∏équartzÊï¥Âêà„ÄÇ‰∏öÂä°ÂÆûÁé∞Êó∂ÔºåÈúÄË¶ÅÂú®jobÈáåÂºïÂÖ•springÁöÑbeanÔºå‰ΩÜÊòØjobÁöÑÂàùÂßãÂåñÊó∂quartzÂú®ÊâßË°åÊó∂newÂá∫Êù•ÁöÑ„ÄÇ‰∏çÂèóspringÁöÑÁÆ°ÁêÜÔºåÊó†Ê≥ïÊ≥®ÂÖ•Áõ∏ÂÖ≥ÁöÑ‰æùËµñbean„ÄÇÂ§öÊñπÊü•ÈòÖËµÑÊñôÂêéÔºåÂèëÁé∞AutowireCapableBeanFactoryÂèØ‰ª•ÂÆûÁé∞Á±ª‰ººÂäüËÉΩ„ÄÇ‰∏ãÈù¢Â∞±ÈÄöËøáËµ∞ËØª‰ª£Á†ÅÁöÑÊñπÂºèÊù•Â≠¶‰π†‰∏ãËøô‰∏™Á±ªÁöÑÁî®Ê≥ï„ÄÇ ËøõÂÖ•Ê≠£È¢òÈ¶ñÂÖàÊù•Áúã‰∏ãAutowireCapableBeanFactoryÁöÑÂÆö‰πâÔºö 1234567891011121314151617181920public interface AutowireCapableBeanFactory extends BeanFactory &#123; &lt;T&gt; T createBean(Class&lt;T&gt; beanClass) throws BeansException; void autowireBean(Object existingBean) throws BeansException; Object configureBean(Object existingBean, String beanName) throws BeansException; Object createBean(Class&lt;?&gt; beanClass, int autowireMode, boolean dependencyCheck) throws BeansException; Object autowire(Class&lt;?&gt; beanClass, int autowireMode, boolean dependencyCheck) throws BeansException; void autowireBeanProperties(Object existingBean, int autowireMode, boolean dependencyCheck) throws BeansException; void applyBeanPropertyValues(Object existingBean, String beanName) throws BeansException; Object initializeBean(Object existingBean, String beanName) throws BeansException; Object applyBeanPostProcessorsBeforeInitialization(Object existingBean, String beanName) throws BeansException; Object applyBeanPostProcessorsAfterInitialization(Object existingBean, String beanName) throws BeansException; void destroyBean(Object existingBean); &lt;T&gt; NamedBeanHolder&lt;T&gt; resolveNamedBean(Class&lt;T&gt; requiredType) throws BeansException; Object resolveDependency(DependencyDescriptor descriptor, String requestingBeanName) throws BeansException; Object resolveDependency(DependencyDescriptor descriptor, String requestingBeanName, Set&lt;String&gt; autowiredBeanNames, TypeConverter typeConverter) throws BeansException;&#125; ËØ•Á±ªÁöÑÊ≥®Èáä‰∏≠ÊúâËøô‰πà‰∏ÄÂè•ËØùIntegration code for other frameworks can leverage this interface to wire and populate existing bean instances that Spring does not control the lifecycle ofÔºåÊÑèÊÄùÊòØËØ¥ËØ•Á±ªÂèØ‰ª•Â°´ÂÖÖÈÇ£‰∫õ‰∏çÂèóspringÂÆπÂô®ÊéßÂà∂ÁöÑbean„ÄÇ springÂíåquartzÂú®ÈõÜÊàêÁöÑÊó∂ÂÄôÁî®‰∫ÜautowireBeanÊñπÊ≥ï„ÄÇ‰∏ãÈù¢Ëµ∞ËØªËøô‰∏™ÊñπÊ≥ïÁöÑ‰ª£Á†ÅÊù•ÁúãÂ§ÑÁêÜÈÄªËæë„ÄÇ autowireBeanÁöÑÂÆûÁé∞Âú®Á±ªAbstractAutowireCapableBeanFactory‰∏≠„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ã 123456789public void autowireBean(Object existingBean) &#123; // Use non-singleton bean definition, to avoid registering bean as dependent bean. RootBeanDefinition bd = new RootBeanDefinition(ClassUtils.getUserClass(existingBean)); bd.setScope(BeanDefinition.SCOPE_PROTOTYPE); bd.allowCaching = ClassUtils.isCacheSafe(bd.getBeanClass(), getBeanClassLoader()); BeanWrapper bw = new BeanWrapperImpl(existingBean); initBeanWrapper(bw); populateBean(bd.getBeanClass().getName(), bd, bw); &#125; ËØ•ÊñπÊ≥ïÁöÑÈÄªËæë‰∏ªË¶ÅÂú®populateBean‰∏≠„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØspringÈáåÂæàÈáçË¶ÅÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÁî®‰∫éË£ÖÈÖçbean„ÄÇËøôÈáåÈÄªËæëÂæàÂ§çÊùÇÔºå‰∏ªË¶ÅÊòØÈÄöËøáÂèçÂ∞ÑËé∑ÂèñÊàë‰ª¨newÂá∫Êù•ÁöÑÂØπË±°ÁöÑÂ±ûÊÄßÂèäÊ≥®Ëß£„ÄÇËã•Ê≥®Ëß£ÊòØAutowired,Value,InjectÊó∂ÔºåËøõË°åbeanÁöÑÁªÑË£Ö„ÄÇÊ≠§ÊñπÊ≥ïÊâßË°åÂÆåÊàê‰πãÂêé„ÄÇÊàë‰ª¨newÂá∫Êù•ÁöÑÂØπË±°ÈáåÈÄöËøáÊ≥®Ëß£Ê≥®ÂÖ•ÁöÑbeanÂ∞±ÂèØ‰ª•‰ΩøÁî®‰∫Ü„ÄÇ ÂÖ≥ÈîÆ‰ª£Á†ÅÂ±ïÁ§∫Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041protected void populateBean(String beanName, RootBeanDefinition mbd, BeanWrapper bw) &#123; ...... if (hasInstAwareBpps || needsDepCheck) &#123; PropertyDescriptor[] filteredPds = filterPropertyDescriptorsForDependencyCheck(bw, mbd.allowCaching); if (hasInstAwareBpps) &#123; for (BeanPostProcessor bp : getBeanPostProcessors()) &#123; if (bp instanceof InstantiationAwareBeanPostProcessor) &#123; InstantiationAwareBeanPostProcessor ibp = (InstantiationAwareBeanPostProcessor) bp; //‰æùËµñÁöÑbeanÊ≥®ÂÖ•Âú®ËøôÈáåÂÆûÁé∞ pvs = ibp.postProcessPropertyValues(pvs, filteredPds, bw.getWrappedInstance(), beanName); //end if (pvs == null) &#123; return; &#125; &#125; &#125; &#125; if (needsDepCheck) &#123; checkDependencies(beanName, mbd, filteredPds, pvs); &#125; &#125; applyPropertyValues(beanName, mbd, bw, pvs); &#125;public PropertyValues postProcessPropertyValues( PropertyValues pvs, PropertyDescriptor[] pds, Object bean, String beanName) throws BeanCreationException &#123; //Ëé∑ÂèñÊ≥®ÂÖ•ÁöÑÂ±ûÊÄß InjectionMetadata metadata = findAutowiringMetadata(beanName, bean.getClass(), pvs); try &#123; //Ê≥®ÂÖ• metadata.inject(bean, beanName, pvs); &#125; catch (BeanCreationException ex) &#123; throw ex; &#125; catch (Throwable ex) &#123; throw new BeanCreationException(beanName, "Injection of autowired dependencies failed", ex); &#125; return pvs; &#125; ‰æãÂ≠êquartz ÁöÑjobÈáåÊ≥®ÂÖ•beanÔºö job Â∑•ÂéÇÔºö 123456789101112131415public class JobFactory extends AdaptableJobFactory &#123; @Autowired private AutowireCapableBeanFactory capableBeanFactory; @Override protected Object createJobInstance(TriggerFiredBundle bundle) throws Exception &#123; //Ë∞ÉÁî®Áà∂Á±ªÁöÑÊñπÊ≥ï Object jobInstance = super.createJobInstance(bundle); //ËøõË°åÊ≥®ÂÖ• capableBeanFactory.autowireBean(jobInstance); return jobInstance; &#125;&#125; jobÁöÑÂÖ∑‰ΩìÂ§ÑÁêÜÈÄªËæë 12345678public final class InternalJob implements Job &#123; private static final Logger logger = LoggerFactory.getLogger(InternalJob .class); @Autowired private CuratorFramework client; @Autowired private JobAlarmEventService jobAlarmEventService; jobÁöÑspringÈÖçÁΩÆÔºö 123456&lt;bean id="jobFactory" class="com.test.scheduler.JobFactory"&gt;&lt;/bean&gt; &lt;bean id="schedulerFactoryBean" class="org.springframework.scheduling.quartz.SchedulerFactoryBean"&gt; &lt;property name="jobFactory" ref="jobFactory"&gt;&lt;/property&gt; &lt;property name="schedulerName" value="scheduler"&gt;&lt;/property&gt; &lt;property name="configLocation" value="classpath:META-INF/spring/quartz.properties"&gt;&lt;/property&gt; &lt;/bean&gt;]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[vmware ÁΩëÁªúËÆæÁΩÆ]]></title>
    <url>%2F2018%2F09%2F25%2Fvmware-%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[NATËÆæÁΩÆ Âà†Èô§ÂéüÊúâÁöÑNAT Êñ∞Âª∫‰∏Ä‰∏™Êñ∞ÁöÑNATÈìæÊé•ÔºåÁîüÊàêMACÁΩëÂç°Âú∞ÂùÄ Ê£ÄÊü•LANÁΩëÊÆµ Ê°•Êé•ËÆæÁΩÆ Âà†Èô§ÂéüÊúâÁöÑÊ°•Êé• Êñ∞Âª∫‰∏Ä‰∏™Êñ∞ÁöÑÊ°•Êé•ÔºåÁîüÊàêMACÁΩëÂç°Âú∞ÂùÄ Ôºå Ë∑ØÁî±adminÁªëÂÆöÈùôÊÄÅIP Ê£ÄÊü•LANÁΩëÊÆµ ip addr Êü•ÁúãIPÂíåÁΩëÂç° Ë∑ØÁî±ËÆæÁΩÆ DHCPÊúçÂä°Âô® -&gt; ÈùôÊÄÅÂú∞ÂùÄ‰øùÁïô Ôºå ÁîüÊïàÊâÄÊúâ IP‰∏éMACÁªëÂÆö -&gt; ÈùôÊÄÅARPÁªëÂÆöËÆæÁΩÆ ÔºåÁîüÊïàÊâÄÊúâ ÂÖ≥Èó≠ËôöÊãüÊú∫ÔºåÈáçÂêØË∑ØÁî±Âô®]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[MysqlÂ§öË°®ËøûÊé•Âà†Èô§]]></title>
    <url>%2F2018%2F09%2F21%2FMysql%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E5%88%A0%E9%99%A4%2F</url>
    <content type="text"><![CDATA[ËÅîË°®Âà†Èô§Ôºö1„ÄÅ‰ªéÊï∞ÊçÆË°®t1 ‰∏≠ÊääÈÇ£‰∫õidÂÄºÂú®Êï∞ÊçÆË°®t2 ÈáåÊúâÂåπÈÖçÁöÑËÆ∞ÂΩïÂÖ®Âà†Èô§Êéâ 12345DELETE t1 FROM t1,t2 WHERE t1.id=t2.idÊàñDELETE FROM t1 USING t1,t2 WHERE t1.id=t2.id 2„ÄÅ‰ªéÊï∞ÊçÆË°®t1ÈáåÂú®Êï∞ÊçÆË°®t2ÈáåÊ≤°ÊúâÂåπÈÖçÁöÑËÆ∞ÂΩïÊü•ÊâæÂá∫Êù•Âπ∂Âà†Èô§Êéâ 12345DELETE t1 FROM t1 LEFT JOIN T2 ON t1.id=t2.id WHERE t2.id IS NULLÊàñDELETE FROM t1,USING t1 LEFT JOIN T2 ON t1.id=t2.id WHERE t2.id IS NULL 3„ÄÅ‰ªé‰∏§‰∏™Ë°®‰∏≠ÊâæÂá∫Áõ∏ÂêåËÆ∞ÂΩïÁöÑÊï∞ÊçÆÂπ∂Êää‰∏§‰∏™Ë°®‰∏≠ÁöÑÊï∞ÊçÆÈÉΩÂà†Èô§Êéâ 1DELETE t1,t2 from t1 LEFT JOIN t2 ON t1.id=t2.id WHERE t1.id=25 Ê≥®ÊÑèÊ≠§Â§ÑÁöÑdelete t1,t2 from ‰∏≠ÁöÑt1,t2‰∏çËÉΩÊòØÂà´Âêç Â¶ÇÔºö1delete t1,t2 from table_name as t1 left join table2_name as t2 on t1.id=t2.id where table_name.id=25 Ë¶ÅÊ±ÇÔºöMYSQL ÁâàÊú¨‰∏çÂ∞è‰∫é5.0]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[RedisÂéüÁêÜËØ¶Ëß£]]></title>
    <url>%2F2018%2F09%2F15%2FRedis%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[expire https://redis.io/commands/expire Ê∂àÊûÅÊñπÂºèÔºåËÆøÈóÆKeyÔºåÂ∑≤ËøáÊúüÂà†Èô§ ÁßØÊûÅÊñπÂºèÔºå1Áßí10Ê¨°„ÄÇ1. ÈÄâÂèñ20‰∏™ÈöèÊú∫ÁöÑkey 2.Âà†Èô§ËøáÊúükey 3.Ë∂ÖËøá20%ËøáÊúüÔºåÊâßË°å1Ê≠•È™§„ÄÇ How Redis expires keysRedis keys are expired in two ways: a passive way, and an active way. A key is passively expired simply when some client tries to access it, and the key is found to be timed out. Of course this is not enough as there are expired keys that will never be accessed again. These keys should be expired anyway, so periodically Redis tests a few keys at random among keys with an expire set. All the keys that are already expired are deleted from the keyspace. Specifically this is what Redis does 10 times per second: Test 20 random keys from the set of keys with an associated expire. Delete all the keys found expired. If more than 25% of keys were expired, start again from step 1. This is a trivial probabilistic algorithm, basically the assumption is that our sample is representative of the whole key space, and we continue to expire until the percentage of keys that are likely to be expired is under 25% This means that at any given moment the maximum amount of keys already expired that are using memory is at max equal to max amount of write operations per second divided by 4. Êï∞ÊçÆÊåÅ‰πÖÂåñrdb ÔºàÈªòËÆ§Ôºâ Êù°‰ª∂Êª°Ë∂≥‰∏Ä‰∏™ÊâßË°åÔºåÊØèÊù°ËßÑÂàô‰πãÈó¥ÊòØ‚ÄúÊàñ‚ÄùÁöÑÂÖ≥Á≥ª In the example below the behaviour will be to save: after 900 sec (15 min) if at least 1 key changed after 300 sec (5 min) if at least 10 keys changed after 60 sec if at least 10000 keys changed 123save 900 1save 300 10save 60 10000 aof ÈªòËÆ§ÁöÑrdbËÉΩÂ§üÊª°Ë∂≥ÊåÅ‰πÖÂåñÁöÑÈúÄÊ±ÇÔºå‰ΩÜÊòØÂ≠òÂú®Áº∫Èô∑Â∞±ÊòØ‰∏§Ê¨°Âø´ÁÖß‰πãÈó¥ÔºåÂèØËÉΩ‰ºö‰∏¢Â§±Êï∞ÊçÆ„ÄÇ By default Redis asynchronously dumps the dataset on disk. This mode isgood enough in many applications, but an issue with the Redis process ora power outage may result into a few minutes of writes lost (depending onthe configured save points). 12appendonly yesappendfilename "appendonly.aof" luaËÑöÊú¨‰øùËØÅÂéüÂ≠êÊÄß redis-cli ‚Äìeval example.lua ÊØîËæÉÊö¥Âäõ ÈôêÊµÅdemo 10ÁßíÂÜÖÈôêÊµÅ10Ê¨°demo script load ÂØºÂÖ•ËÑöÊú¨ÔºåÁîüÊàêsha evalsha ‚Äú{sha}‚Äù luaÊâßË°åÊ≠ªÁéØÂ¢ÉËÑöÊú¨Ôºå‰ºöÊúâÈòªÂ°ûÈóÆÈ¢ò redis-cli ‚Äìeval example.lua ÂçïÁ∫øÁ®ãÂ¶Ç‰Ωï‰øùËØÅÈ´òÊÄßËÉΩÂêåÊ≠•ÈòªÂ°ûÂêåÊ≠•ÈùûÈòªÂ°ûÂºÇÊ≠•ÈòªÂ°û(redisÂÆûÁé∞ÔºåÂ§öË∑ØÂ§çÁî®)ÂºÇÊ≠•‰∏ç‰∏ÄÂÆöÊòØÂ§öÁ∫øÁ®ã ÂºÇÊ≠•ÈùûÈòªÂ°ûÂàÜÂ∏ÉÂºèÈÖçÁΩÆ12# Êó†Á£ÅÁõòÂ§çÂà∂repl-diskless-sync ÂëΩ‰ª§12345678#Êü•ÁúãÈõÜÁæ§‰ø°ÊÅØinfo replication#ÂëäËØâmasterËäÇÁÇπ slaveÁöÑÁ´ØÂè£replconf listening-port 6379#ÊäìÂèñmasterÁöÑÂêåÊ≠•‰ø°ÊÅØsync ‰∏ª‰ªéÂ§çÂà∂ÂÖ®ÈáèÂ§çÂà∂ Â¢ûÈáèÂ§çÂà∂ ÈìæÊé•Âà∞ÈõÜÁæ§ 12redis-cli -c -p 7000‰ºöÊúâredirect to slotÊèêÁ§∫ ËøûÊé•Âà∞ÊüêÂè∞Êú∫Âô® 12redis-cli -p 7001ÊèêÁ§∫MOVED error cluster slots Êü•ÁúãÈõÜÁæ§‰ø°ÊÅØ ÊßΩ‰ø°ÊÅØ 13‰∏ª6‰ªé cluster nodes Êü•ÁúãËäÇÁÇπ‰ø°ÊÅØ Âì®ÂÖµÊ®°Âºè 1ËøûÊé•Âì®ÂÖµËäÇÁÇπÔºåÁÑ∂ÂêéÊü•ËØ¢masterÁöÑËäÇÁÇπ ÂÆ¢Êà∑Á´Øjedis sentinel cluster cluster jedis.watch Ê†áÂøóÈáäÊîæÈîÅ‰∏ç‰ºöÂ§±Ë¥• redission single sentinel 12redissionClinet.getBucket("") Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤ÂÖ∂‰ªñÁ±ªÂûãÁõ∏Âêå cluster ÂàÜÂ∏ÉÂºèÈîÅ setNX redission lock unlock Ê∫êÁ†ÅËß£ËØª]]></content>
      <categories>
        <category>ÁºìÂ≠ò</category>
        <category>redis</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[springboot staterËá™ÂÆö‰πâÂºÄÂèë]]></title>
    <url>%2F2018%2F09%2F14%2Fspringboot-stater%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%80%E5%8F%91%2F</url>
    <content type="text"><![CDATA[‰∏Ä springboot-starterÁîüÊàê1. pomÂºïÂÖ•12345678910111213141516171819202122232425262728293031323334353637383940&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.joey.segmentment&lt;/groupId&gt; &lt;artifactId&gt;lessson-20-starter&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;name&gt;lessson-20-starter&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.5.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--Áî®‰∫éÁîüÊàêÁºñËæëÊèêÁ§∫--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 2. autoconfigure123456789101112@Configuration@ConditionalOnProperty(prefix = "person",name = "enable", havingValue = "true",matchIfMissing = true)public class PersonAutoConfigure &#123; @Bean @ConfigurationProperties(prefix = "person") public Person person()&#123; return new Person(); &#125;&#125; 1234567public class Person &#123; private Long id; private String name; private Integer age;... getter setter&#125; @Configuration,Ë¢´ËØ•Ê≥®Ëß£Ê≥®ÈáäÁöÑÁ±ª‰ºöÊèê‰æõ‰∏Ä‰∏™ÊàñÂàôÂ§ö‰∏™@bean‰øÆÈ•∞ÁöÑÊñπÊ≥ïÂπ∂‰∏î‰ºöË¢´springÂÆπÂô®Â§ÑÁêÜÊù•ÁîüÊàêbean definitions„ÄÇ @beanÊ≥®Ëß£ÊòØÂøÖÈ°ª‰øÆÈ•∞ÂáΩÊï∞ÁöÑÔºåËØ•ÂáΩÊï∞ÂèØ‰ª•Êèê‰æõ‰∏Ä‰∏™bean„ÄÇËÄå‰∏îËØ•ÂáΩÊï∞ÁöÑÂáΩÊï∞ÂêçÂøÖÈ°ªÂíåbeanÁöÑÂêçÁß∞‰∏ÄËá¥ÔºåÈô§‰∫ÜÈ¶ñÂ≠óÊØç‰∏çÈúÄË¶ÅÂ§ßÂÜô„ÄÇ @ConditionalOnClassÊ≥®Ëß£ÊòØÊù°‰ª∂Âà§Êñ≠ÁöÑÊ≥®Ëß£ÔºåË°®Á§∫ÂØπÂ∫îÁöÑÁ±ªÂú®classpathÁõÆÂΩï‰∏ãÂ≠òÂú®Êó∂ÔºåÊâç‰ºöÂéªËß£ÊûêÂØπÂ∫îÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ ConditionalOnPropertyÊ≥®Ëß£ÊòØÊù°‰ª∂Âà§Êñ≠ÁöÑÊ≥®Ëß£ÔºåË°®Á§∫Â¶ÇÊûúÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÂìçÂ∫îÈÖçÁΩÆÈ°πÊï∞ÂÄº‰∏∫true,Êâç‰ºöÂØπËØ•beanËøõË°åÂàùÂßãÂåñ„ÄÇ Êõ¥Â§öÊ≥®Ëß£ÂèÇËÄÉ https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-developing-auto-configuration.html 3. META-INF/spring.factoriesÂú®Êñá‰ª∂‰∏≠Ê∑ªÂä† 12org.springframework.boot.autoconfigure.EnableAutoConfiguration=\ com.joey.segmentment.starter.autoconfigure.PersonAutoConfigure 4. mvn clean install‰∫å projectÂºïÂÖ•starterjarÂåÖ1. ÂºïÂÖ•jarÂåÖ12345&lt;dependency&gt; &lt;groupId&gt;com.joey.segmentment&lt;/groupId&gt; &lt;artifactId&gt;lessson-20-starter&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; 2. application.propertiesÂ°´ÂÜôÈÖçÁΩÆ12345person.enable=trueperson.id=1person.name=joeyperson.age=18 3. ‰ª£Á†Å‰ΩøÁî®123456789101112@RestControllerpublic class TestController &#123; @Autowired private Person person; @GetMapping(value = "/person") public Person get()&#123; return person; &#125;&#125; ÊñáÁåÆÂèÇËÄÉ https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-developing-auto-configuration.html]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[kafkaÂéüÁêÜËØ¶Ëß£]]></title>
    <url>%2F2018%2F09%2F06%2Fkafka%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[kafkaÊèê‰æõÁöÑÂü∫Êú¨ËÑöÊú¨ÂêØÂä®broker server1bin/kafka-server-start.sh config/server.properties ÂàõÂª∫topic1bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 2 --partitions 3 -- topic testReplicaTopic ÂΩìbrokerËäÇÁÇπÊú¨Ë∫´Âè™Êúâ1‰∏™ÔºåÂ∞ë‰∫éÂâØÊú¨Êï∞2Êó∂ÔºåÊä•Èîô 12[2018-09-06 23:13:38,288] ERROR org.apache.kafka.common.errors.InvalidReplicationFactorException: Replication factor: 2 larger than available brokers: 1. (kafka.admin.TopicCommand$) Êü•ÁúãÊüê‰∏™topicÁöÑ‰ø°ÊÅØ1bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic xiaowu-topic Áîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØ1bin/kafka-console-producer.sh --broker-list localhost:9092 --topic xiaowu-topic Ê∂àË¥πËÄÖÊ∂àË¥πÊ∂àÊÅØ1bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic xiaowu-topic --from-beginning Êü•ÁúãÊ∂àÊÅØÊó•ÂøóÊñá‰ª∂1bin/kafka-run-class.sh kafka.tools.DumpLogSegments --files /Users/zhouxiaowu/install/kafka/kafka-data/xiaowu-topic-0/00000000000000000000.log --print-data-log Êü•ÁúãÁ¥¢ÂºïÊñá‰ª∂ÂÜÖÂÆπ1bin/kafka-run-class.sh kafka.tools.DumpLogSegments --files /Users/zhouxiaowu/install/kafka/kafka-data/xiaowu-topic-0/00000000000000000000.index --print-data-log zookeeperÁä∂ÊÄÅÊü•ÁúãÊüê‰∏™topicÁöÑÊüê‰∏™ÂàÜÂå∫ÁöÑÁä∂ÊÄÅ12[zk: localhost:2181(CONNECTED) 16] get /brokers/topics/xiaowu-topic/partitions/0/state&#123;"controller_epoch":4,"leader":0,"version":1,"leader_epoch":0,"isr":[0]&#125;]]></content>
      <categories>
        <category>Ê∂àÊÅØ‰∏≠Èó¥‰ª∂</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot WebÁØá]]></title>
    <url>%2F2018%2F08%2F13%2FSpring-Boot-Web%E7%AF%87%2F</url>
    <content type="text"><![CDATA[Ê†áÂáÜ‰ºòÂåñÊäÄÊúØ ËµÑÊ∫êÂèòÂåñ ÂìçÂ∫îÂ§¥ÔºöLast-Modified ËØ∑Ê±ÇÂ§¥ÔºöIf-Modified-Since ËµÑÊ∫êÁºìÂ≠ò ÂìçÂ∫îÂ§¥ÔºöETag ËØ∑Ê±ÇÂ§¥ÔºöIf-None-Match Spring Boot ActuatorÂºïÁî®ÂåÖ 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; /beans Êü•ÁúãbeanÁöÑÊÉÖÂÜµ ManagementServerPropertiesÁ±ªÊü•ÁúãÈÖçÁΩÆÂÜÖÂÆπ Â¶ÇÔºö management.security.enabled = falseÂÖ≥Èó≠ÂÆâÂÖ®Ê£ÄÊü• localhost:8080/autoconfig Êü•ÁúãÂåπÈÖçÊñπÂºèÔºånegtiveÂåπÈÖç‰∏çÊàêÂäü Spring Framwork Transaction @EnableTransactionManagementÊ≥®Ëß£ÂêØÁî®‰∫ãÂä°ÁÆ°ÁêÜ proxyTargetClass = trueÈÄâÊã©‰ΩøÁî®cglibÂä®ÊÄÅ‰ª£ÁêÜÔºåËøôÊ†∑serviceÁ±ªÂèØ‰ª•‰∏çÁî®ÂÆûÁé∞Êé•Âè£„ÄÇ 1@EnableTransactionManagement(proxyTargetClass = true)]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[MySQL‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÊµãËØï]]></title>
    <url>%2F2018%2F08%2F10%2FMySQL%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%B5%8B%E8%AF%95%2F</url>
    <content type="text"><![CDATA[‰∏Ä„ÄÅ‰∫ãÂä°ÁöÑÂü∫Êú¨Ë¶ÅÁ¥†ÔºàACIDÔºâ 1„ÄÅÂéüÂ≠êÊÄßÔºàAtomicityÔºâÔºö‰∫ãÂä°ÂºÄÂßãÂêéÊâÄÊúâÊìç‰ΩúÔºåË¶Å‰πàÂÖ®ÈÉ®ÂÅöÂÆåÔºåË¶Å‰πàÂÖ®ÈÉ®‰∏çÂÅöÔºå‰∏çÂèØËÉΩÂÅúÊªûÂú®‰∏≠Èó¥ÁéØËäÇ„ÄÇ‰∫ãÂä°ÊâßË°åËøáÁ®ã‰∏≠Âá∫ÈîôÔºå‰ºöÂõûÊªöÂà∞‰∫ãÂä°ÂºÄÂßãÂâçÁöÑÁä∂ÊÄÅÔºåÊâÄÊúâÁöÑÊìç‰ΩúÂ∞±ÂÉèÊ≤°ÊúâÂèëÁîü‰∏ÄÊ†∑„ÄÇ‰πüÂ∞±ÊòØËØ¥‰∫ãÂä°ÊòØ‰∏Ä‰∏™‰∏çÂèØÂàÜÂâ≤ÁöÑÊï¥‰ΩìÔºåÂ∞±ÂÉèÂåñÂ≠¶‰∏≠Â≠¶ËøáÁöÑÂéüÂ≠êÔºåÊòØÁâ©Ë¥®ÊûÑÊàêÁöÑÂü∫Êú¨Âçï‰Ωç„ÄÇ 2„ÄÅ‰∏ÄËá¥ÊÄßÔºàConsistencyÔºâÔºö‰∫ãÂä°ÂºÄÂßãÂâçÂíåÁªìÊùüÂêéÔºåÊï∞ÊçÆÂ∫ìÁöÑÂÆåÊï¥ÊÄßÁ∫¶ÊùüÊ≤°ÊúâË¢´Á†¥Âùè „ÄÇÊØîÂ¶ÇAÂêëBËΩ¨Ë¥¶Ôºå‰∏çÂèØËÉΩAÊâ£‰∫ÜÈí±ÔºåBÂç¥Ê≤°Êî∂Âà∞„ÄÇ 3„ÄÅÈöîÁ¶ªÊÄßÔºàIsolationÔºâÔºöÂêå‰∏ÄÊó∂Èó¥ÔºåÂè™ÂÖÅËÆ∏‰∏Ä‰∏™‰∫ãÂä°ËØ∑Ê±ÇÂêå‰∏ÄÊï∞ÊçÆÔºå‰∏çÂêåÁöÑ‰∫ãÂä°‰πãÈó¥ÂΩºÊ≠§Ê≤°Êúâ‰ªª‰ΩïÂπ≤Êâ∞„ÄÇÊØîÂ¶ÇAÊ≠£Âú®‰ªé‰∏ÄÂº†Èì∂Ë°åÂç°‰∏≠ÂèñÈí±ÔºåÂú®AÂèñÈí±ÁöÑËøáÁ®ãÁªìÊùüÂâçÔºåB‰∏çËÉΩÂêëËøôÂº†Âç°ËΩ¨Ë¥¶„ÄÇ 4„ÄÅÊåÅ‰πÖÊÄßÔºàDurabilityÔºâÔºö‰∫ãÂä°ÂÆåÊàêÂêéÔºå‰∫ãÂä°ÂØπÊï∞ÊçÆÂ∫ìÁöÑÊâÄÊúâÊõ¥Êñ∞Â∞ÜË¢´‰øùÂ≠òÂà∞Êï∞ÊçÆÂ∫ìÔºå‰∏çËÉΩÂõûÊªö„ÄÇ ‰∫å„ÄÅ‰∫ãÂä°ÁöÑÂπ∂ÂèëÈóÆÈ¢ò1„ÄÅËÑèËØªÔºö‰∫ãÂä°AËØªÂèñ‰∫Ü‰∫ãÂä°BÊõ¥Êñ∞ÁöÑÊï∞ÊçÆÔºåÁÑ∂ÂêéBÂõûÊªöÊìç‰ΩúÔºåÈÇ£‰πàAËØªÂèñÂà∞ÁöÑÊï∞ÊçÆÊòØËÑèÊï∞ÊçÆ 2„ÄÅ‰∏çÂèØÈáçÂ§çËØªÔºö‰∫ãÂä° A Â§öÊ¨°ËØªÂèñÂêå‰∏ÄÊï∞ÊçÆÔºå‰∫ãÂä° B Âú®‰∫ãÂä°AÂ§öÊ¨°ËØªÂèñÁöÑËøáÁ®ã‰∏≠ÔºåÂØπÊï∞ÊçÆ‰Ωú‰∫ÜÊõ¥Êñ∞Âπ∂Êèê‰∫§ÔºåÂØºËá¥‰∫ãÂä°AÂ§öÊ¨°ËØªÂèñÂêå‰∏ÄÊï∞ÊçÆÊó∂ÔºåÁªìÊûú ‰∏ç‰∏ÄËá¥„ÄÇ 3„ÄÅÂπªËØªÔºöÁ≥ªÁªüÁÆ°ÁêÜÂëòAÂ∞ÜÊï∞ÊçÆÂ∫ì‰∏≠ÊâÄÊúâÂ≠¶ÁîüÁöÑÊàêÁª©‰ªéÂÖ∑‰ΩìÂàÜÊï∞Êîπ‰∏∫ABCDEÁ≠âÁ∫ßÔºå‰ΩÜÊòØÁ≥ªÁªüÁÆ°ÁêÜÂëòBÂ∞±Âú®Ëøô‰∏™Êó∂ÂÄôÊèíÂÖ•‰∫Ü‰∏ÄÊù°ÂÖ∑‰ΩìÂàÜÊï∞ÁöÑËÆ∞ÂΩïÔºåÂΩìÁ≥ªÁªüÁÆ°ÁêÜÂëòAÊîπÁªìÊùüÂêéÂèëÁé∞ËøòÊúâ‰∏ÄÊù°ËÆ∞ÂΩïÊ≤°ÊúâÊîπËøáÊù•ÔºåÂ∞±Â•ΩÂÉèÂèëÁîü‰∫ÜÂπªËßâ‰∏ÄÊ†∑ÔºåËøôÂ∞±Âè´ÂπªËØª„ÄÇ Â∞èÁªìÔºö‰∏çÂèØÈáçÂ§çËØªÁöÑÂíåÂπªËØªÂæàÂÆπÊòìÊ∑∑Ê∑ÜÔºå‰∏çÂèØÈáçÂ§çËØª‰æßÈáç‰∫é‰øÆÊîπÔºåÂπªËØª‰æßÈáç‰∫éÊñ∞Â¢ûÊàñÂà†Èô§„ÄÇËß£ÂÜ≥‰∏çÂèØÈáçÂ§çËØªÁöÑÈóÆÈ¢òÂè™ÈúÄÈîÅ‰ΩèÊª°Ë∂≥Êù°‰ª∂ÁöÑË°åÔºåËß£ÂÜ≥ÂπªËØªÈúÄË¶ÅÈîÅË°® ‰∏â„ÄÅMySQL‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ ‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ ËÑèËØª ‰∏çÂèØÈáçÂ§çËØª ÂπªËØª ËØªÊú™Êèê‰∫§Ôºàread-uncommittedÔºâ ÊòØ ÊòØ ÊòØ ‰∏çÂèØÈáçÂ§çËØªÔºàread-committedÔºâ Âê¶ ÊòØ ÊòØ ÂèØÈáçÂ§çËØªÔºàrepeatable-readÔºâ Âê¶ Âê¶ ÊòØ ‰∏≤Ë°åÂåñÔºàserializableÔºâ Âê¶ Âê¶ Âê¶ clientA1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586set session transaction isolation level read COMMITTED ;SELECT @@tx_isolation;CREATE TABLE person_test( id INT UNSIGNED AUTO_INCREMENT COMMENT 'id' PRIMARY KEY , age INT DEFAULT 0 COMMENT 'ÁªÑÁªáÁºñÂè∑ÔºàÈÉ®Èó®ÁºñÂè∑Ôºâ', name VARCHAR(20) DEFAULT '' COMMENT 'ÁªÑÁªáÂêçÁß∞', gmt_create timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ÂàõÂª∫Êó∂Èó¥', gmt_modify timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '‰øÆÊîπÊó∂Èó¥')ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT 'person test';BEGIN ;INSERT INTO person_test(age, name) VALUE (18,'xiaoming');SELECT * FROM person_test;COMMIT ;BEGIN ;INSERT INTO person_test(age,name) VALUE (18,'jim');SELECT * FROM person_test;ROLLBACK ;SELECT * FROM person_test WHERE id=10;-- ÈöîÁ¶ªÁ∫ßÂà´Ôºàread COMMITTEDÔºâ set session transaction isolation level read COMMITTED ;SELECT @@tx_isolation;BEGIN ;SELECT * FROM person_test;SELECT * FROM person_test;COMMIT ;-- ÈöîÁ¶ªÁ∫ßÂà´ÔºàREPEATABLE READÔºâset session transaction isolation level REPEATABLE READ ;SELECT @@tx_isolation;BEGIN ;SELECT * FROM person_test;SELECT * FROM person_test;COMMIT ;SELECT * FROM person_test;BEGIN ;SELECT * FROM person_test WHERE age=18;-- ËøôÈáåÊµãËØïÂπ∂Ê≤°ÊúâÂá∫Áé∞ÂπªËØªÊÉÖÂÜµSELECT * FROM person_test WHERE age=18;COMMIT ;-- ÈöîÁ¶ªÁ∫ßÂà´ÔºàSERIALIZABLEÔºâset session transaction isolation level SERIALIZABLE ;SELECT @@tx_isolation;BEGIN ;SELECT * FROM person_test;SELECT * FROM person_test;-- ËøôÈáåÊèíÂÖ•‰ºödead lock-- INSERT INTO person_test (age, name) VALUE (18,'he');COMMIT ;SELECT * FROM person_test; clientB12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485set session transaction isolation level read COMMITTED ;SELECT @@tx_isolation;CREATE TABLE person_test( id INT UNSIGNED AUTO_INCREMENT COMMENT 'id' PRIMARY KEY , age INT DEFAULT 0 COMMENT 'ÁªÑÁªáÁºñÂè∑ÔºàÈÉ®Èó®ÁºñÂè∑Ôºâ', name VARCHAR(20) DEFAULT '' COMMENT 'ÁªÑÁªáÂêçÁß∞', gmt_create timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ÂàõÂª∫Êó∂Èó¥', gmt_modify timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '‰øÆÊîπÊó∂Èó¥')ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT 'person test';BEGIN ;INSERT INTO person_test(age, name) VALUE (18,'lily');SELECT * FROM person_test;COMMIT ;BEGIN ;INSERT INTO person_test(age,name) VALUE (18,'jim');SELECT * FROM person_test;ROLLBACK ;BEGIN ;UPDATE person_test SET name= 'zhangsan' WHERE id=10;SELECT * FROM person_test;ROLLBACK ;-- ÈöîÁ¶ªÁ∫ßÂà´Ôºàread COMMITTEDÔºâ set session transaction isolation level read COMMITTED ;SELECT @@tx_isolation;BEGIN ;UPDATE person_test SET name = 'zhangsan' WHERE id=10;SELECT * FROM person_test;DELETE FROM person_test WHERE id=2;SELECT * FROM person_test;COMMIT ;-- ÈöîÁ¶ªÁ∫ßÂà´ÔºàREPEATABLE READÔºâset session transaction isolation level REPEATABLE READ ;SELECT @@tx_isolation;BEGIN ;SELECT * FROM person_test;UPDATE person_test SET name = 'zhangsanfeng' WHERE id=10;SELECT * FROM person_test;COMMIT ;BEGIN ;SELECT * FROM person_test WHERE age=18;INSERT INTO person_test (age,name) VALUE (18,'qiang');SELECT * FROM person_test WHERE age=18;COMMIT ;-- ÈöîÁ¶ªÁ∫ßÂà´ÔºàSERIALIZABLEÔºâset session transaction isolation level SERIALIZABLE ;SELECT @@tx_isolation;BEGIN ;SELECT * FROM person_test;-- SERIALIZABLEÊÉÖÂÜµÔºå‰∏çËÉΩÂ¢ûÂä†ÔºåÁ≠âÂæÖAÂÆ¢Êà∑Á´ØcommitÂêé ‰ºöÂ∏ÆÂä©ËøôËæπcommitINSERT INTO person_test (age,name) VALUE (18,'fen');INSERT INTO person_test (age , name) VALUE (18,'fang');SELECT * FROM person_test;COMMIT ;]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring cloud Ë¥üËΩΩÂùáË°°]]></title>
    <url>%2F2018%2F08%2F05%2FSpring-cloud-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%2F</url>
    <content type="text"><![CDATA[123&gt; JSR 305 meta-annotations&gt; Ê≥®Ëß£ÂÅöÁºñËØëÁ∫¶Êùü&gt; ‰∏ªË¶ÅÂÜÖÂÆπRestTemplate ÂéüÁêÜ‰∏éÊâ©Â±ïSpring Ê†∏ÂøÉ HTTP Ê∂àÊÅØËΩ¨Êç¢Âô® HttpMessageConverter REST Ëá™ÊèèËø∞Ê∂àÊÅØÔºöÂ™í‰ΩìÁ±ªÂûãÔºàMediaTypeÔºâÔºå text/html;text/xml;application/json HTTP ÂçèËÆÆÁâπÁÇπÔºöÁ∫ØÊñáÊú¨ÂçèËÆÆÔºåËá™ÊàëÊèèËø∞ REST ÊúçÂä°Á´Ø REST ÂÆ¢Êà∑Á´Ø ÂèçÂ∫èÂàóÂåñÔºöÊñáÊú¨ÔºàÈÄöËÆØÔºâ -&gt; ÂØπË±°ÔºàÁ®ãÂ∫è‰ΩøÁî®Ôºâ Â∫èÂàóÂåñÔºöÂØπË±° -&gt; ÊñáÊú¨ HttpMessageConverter ÂàÜÊûêÂà§Êñ≠ÊòØÂê¶ÂèØËØªÂèØÂÜô1234567public interface HttpMessageConverter&lt;T&gt; &#123; boolean canRead(Class&lt;?&gt; clazz, @Nullable MediaType mediaType); boolean canWrite(Class&lt;?&gt; clazz, @Nullable MediaType mediaType);&#125; clazz = Person.class ÂΩìÂâçÊîØÊåÅÁöÑÂ™í‰ΩìÁ±ªÂûã123public interface HttpMessageConverter&lt;T&gt; &#123; List&lt;MediaType&gt; getSupportedMediaTypes();&#125; MappingJackson2HttpMessageConverter ÂèçÂ∫èÂàóÂåñ1234public interface HttpMessageConverter&lt;T&gt; &#123; T read(Class&lt;? extends T&gt; clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException;&#125; ÁâπÂà´ÊèêÈÜíÔºöSpring Web MVC ‰æùËµñ ServletÔºåSpring Âú®Êó©ÊúüËÆæËÆ°Êó∂ÔºåÂÆÉÂ∞±ËÄÉËôëÂà∞‰∫ÜÂéª Servlet Âåñ„ÄÇ HttpInputMessage Á±ª‰ºº‰∫é HttpServletRequest 12345678public interface HttpInputMessage extends HttpMessage &#123; InputStream getBody() throws IOException; // Êù•Ëá™‰∫é HttpMessage HttpHeaders getHeaders();&#125; Á±ªÊØî HttpServletRequest 123456789public interface HttpServletRequest &#123; // Êù•Ëá™‰∫é ServletRequest public ServletInputStream getInputStream() throws IOException; public Enumeration&lt;String&gt; getHeaders(String name); public Enumeration&lt;String&gt; getHeaderNames();&#125; RestTemplateÂà©Áî® HttpMessageConverter ÂØπ‰∏ÄÂÆöÂ™í‰ΩìÁ±ªÂûãÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ JSON XML TEXT ÂÆÉ‰∏ç‰æùËµñ‰∫é Servlet APIÔºåÂÆÉËá™ÂÆö‰πâÂÆûÁé∞ ÂØπ‰∫éÊúçÂä°Á´ØËÄåË®ÄÔºåÂ∞Ü Servlet API ÈÄÇÈÖçÊàê HttpInputMessage ‰ª•Âèä HttpOutputMessage RestTemplate ÂØπÂ∫îÂ§ö‰∏™ HttpMessageConverterÔºåÈÇ£‰πàÂ¶Ç‰ΩïÂÜ≥Á≠ñÊ≠£Á°ÆÂ™í‰ΩìÁ±ªÂûã„ÄÇ RestTemplate Âú® HttpMessageConverter ËÆæËÆ°123456789101112131415161718192021222324252627282930313233343536373839404142public class RestTemplate extends InterceptingHttpAccessor implements RestOperations &#123; ... // List ÂΩ¢Âºè private final List&lt;HttpMessageConverter&lt;?&gt;&gt; messageConverters = new ArrayList&lt;&gt;(); ... public RestTemplate() &#123; this.messageConverters.add(new ByteArrayHttpMessageConverter()); this.messageConverters.add(new StringHttpMessageConverter()); this.messageConverters.add(new ResourceHttpMessageConverter(false)); this.messageConverters.add(new SourceHttpMessageConverter&lt;&gt;()); this.messageConverters.add(new AllEncompassingFormHttpMessageConverter()); if (romePresent) &#123; this.messageConverters.add(new AtomFeedHttpMessageConverter()); this.messageConverters.add(new RssChannelHttpMessageConverter()); &#125; if (jackson2XmlPresent) &#123; this.messageConverters.add(new MappingJackson2XmlHttpMessageConverter()); &#125; else if (jaxb2Present) &#123; this.messageConverters.add(new Jaxb2RootElementHttpMessageConverter()); &#125; if (jackson2Present) &#123; this.messageConverters.add(new MappingJackson2HttpMessageConverter()); &#125; else if (gsonPresent) &#123; this.messageConverters.add(new GsonHttpMessageConverter()); &#125; else if (jsonbPresent) &#123; this.messageConverters.add(new JsonbHttpMessageConverter()); &#125; if (jackson2SmilePresent) &#123; this.messageConverters.add(new MappingJackson2SmileHttpMessageConverter()); &#125; if (jackson2CborPresent) &#123; this.messageConverters.add(new MappingJackson2CborHttpMessageConverter()); &#125; &#125;&#125; Ê∑ªÂä†ÂÜÖÂª∫ HttpMessageConvertor ÂÆûÁé∞ ÊúâÊù°‰ª∂Âú∞Ê∑ªÂä†Á¨¨‰∏âÊñπÂ∫ìHttpMessageConvertor Êï¥ÂêàÂÆûÁé∞ ÈóÆÈ¢òÂú∫ÊôØ‰∏ÄÔºö http://localhost:8080/person -&gt; XML ËÄå‰∏çÊòØ Jackson Postman „ÄÅcurl Âú∫ÊôØÊúÄ‰∏∫ÊòéÊòæ Ê≤°Êúâ‰º†ÈÄíËØ∑Ê±ÇÂ§¥ÔºåÊó†‰ªéÈÄâÊã©Â™í‰ΩìÁ±ªÂûã ÂÅáËÆæ Person Êó¢ËÉΩË¢´ XML ËØªÂèñÔºåÊúâËÉΩË¢´ JSON ËØªÂèñ Content-Type: text/html; charset=utf-8 RestTemplate Êâ©Â±ïÊâ©Â±ï HTTP ÂÆ¢Êà∑Á´Ø ClientHttpRequestFactory Spring ÂÆûÁé∞ SimpleClientHttpRequestFactory HttpClient HttpComponentsClientHttpRequestFactory OkHttp OkHttp3ClientHttpRequestFactory OkHttpClientHttpRequestFactory ÂæÆÊúçÂä°Ë¶Å‰ΩøÁî®ËΩªÈáèÁ∫ßÁöÑÂçèËÆÆÔºåÊØîÂ¶Ç REST Spring Cloud RestTemplate Ê†∏ÂøÉÁöÑË∞ÉÁî®Âô® RestTemplate Êï¥Âêà ZookeeperNetflix Ribbon@LoadBalanced Âà©Áî®Ê≥®Ëß£Êù•ËøáÊª§ÔºåÊ≥®ÂÖ•ÊñπÂíåÂ£∞ÊòéÊñπÂêåÊó∂‰ΩøÁî® Ë¥üËΩΩÂùáË°°ÂÆ¢Êà∑Á´ØServiceInstanceChooser LoadBalancerClient Ë¥üËΩΩÂùáË°°‰∏ä‰∏ãÊñáLoadBalancerContext Ë¥üËΩΩÂùáË°°ËßÑÂàôILoadBalancer @Qualifier ‚ÄúÁà∂‚ÄùÊ≥®Ëß£Ôºå@Qualifier , @LoadBalanced]]></content>
      <categories>
        <category>SpringCloud</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring cloudÊúçÂä°ÂèëÁé∞]]></title>
    <url>%2F2018%2F08%2F05%2FSpring-cloud%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[ÁÆÄÂçïÂØπÊØî Eureka ÊØîËæÉÁÇπ Eureka Zookeeper Consul ËøêÁª¥ÁÜüÊÇâÂ∫¶ Áõ∏ÂØπÈôåÁîü ÁÜüÊÇâ Êõ¥ÈôåÁîü ‰∏ÄËá¥ÊÄßÔºàCAPÔºâ APÔºàÊúÄÁªà‰∏ÄËá¥ÊÄßÔºâ CPÔºà‰∏ÄËá¥ÊÄßÂº∫Ôºâ APÔºàÊúÄÁªà‰∏ÄËá¥ÊÄßÔºâ ‰∏ÄËá¥ÊÄßÂçèËÆÆ HTTP ÂÆöÊó∂ËΩÆËÆ≠ ZAB RAFT ÈÄöËÆØÊñπÂºè HTTP REST Ëá™ÂÆö‰πâÂçèËÆÆ HTTP REST Êõ¥Êñ∞Êú∫Âà∂ Peer 2 PeerÔºàÊúçÂä°Âô®‰πãÈó¥Ôºâ + SchedulerÔºàÊúçÂä°Âô®ÂíåÂÆ¢Êà∑Á´ØÔºâ ZK Watch Agent ÁõëÂê¨ÁöÑÊñπÂºè ÈÄÇÁî®ËßÑÊ®° 20 K ~ 30 K ÂÆû‰æãÔºàËäÇÁÇπÔºâ 10K ~ 20K ÂÆû‰æãÔºàËäÇÁÇπÔºâ &lt; 3K ÂÆû‰æãÔºàËäÇÁÇπÔºâ ÊÄßËÉΩÈóÆÈ¢ò ÁÆÄÂçïÁöÑÊõ¥Êñ∞Êú∫Âà∂„ÄÅÂ§çÊùÇËÆæËÆ°„ÄÅËßÑÊ®°ËæÉÂ§ßÊó∂ GC È¢ëÁπÅ Êâ©ÂÆπÈ∫ªÁÉ¶„ÄÅËßÑÊ®°ËæÉÂ§ßÊó∂ GC È¢ëÁπÅ 3K ËäÇÁÇπ‰ª•‰∏äÔºåÊõ¥Êñ∞ÂàóË°®ÁºìÊÖ¢ ‰∏∫‰ªÄ‰πàÊé®Ëçê‰ΩøÁî® ZK ‰Ωú‰∏∫ Spring Cloud ÁöÑÂü∫Á°ÄËÆæÊñΩ‰∏ÄËá¥ÊÄßÊ®°ÂûãÁª¥Êä§Áõ∏ÂØπÁÜüÊÇâÈÖçÁΩÆ‰∏≠ÂøÉÂíåÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂçï‰∏ÄÂåñ‰º†ÁªüÁöÑÈóÆÈ¢òSpring Cloud ÈªòËÆ§ÈÖçÁΩÆ Eureka ÂÅöÊ≥®ÂÜå‰∏≠ÂøÉ Git/JDBC ÂÅöÈÖçÁΩÆ‰∏≠ÂøÉ ‰∏ªË¶ÅÂÜÖÂÆπSpring Cloud Discovery ÂÆ¢Êà∑Á´ØSpring Cloud Discovery ZK ÊúçÂä°Âô®Spring Cloud Â¢ûÂä† ZK ‰æùËµñ ÈîôËØØÈÖçÁΩÆÔºàÈ´ò ZK Client ÁâàÊú¨ 3.5Ôºå‰ΩéÊúçÂä°Âô®ÁâàÊú¨ 3.4Ôºâ 123456789101112&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zookeeper-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; Ê≠£Á°ÆÈÖçÁΩÆ 123456789101112131415161718192021&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zookeeper-all&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.12&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt; Ê≥®ÂÜåÂèëÁé∞ ÈÖçÁΩÆÁÆ°ÁêÜ ÂêØÂä® ZKÔºà3.4.11ÔºâÁºñÂÜôÂºïÂØºÁ±ª12345678@SpringBootApplication@EnableDiscoveryClient // Â∞ΩÂèØËÉΩ‰ΩøÁî® @EnableDiscoveryClientpublic class ZkDSClientApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(ZkDSClientApplication.class, args); &#125;&#125; ÂÆû‰æã‰∏ÄÔºöÁ´ØÂè£ 56517 ZK ID : fff20552-b4a0-43d8-a9ce-c82096f2005e ÂÆû‰æã‰∫åÔºöÁ´ØÂè£ 56577 ZK ID : 9f4e2c91-4765-4f39-9d4b-2036e8e6c4d4 ZK ËäÇÁÇπË∑ØÂæÑÔºà/services/spring-cloud-service-discovery-clientÔºâ ZK ÊúçÂä°ÂèëÁé∞ËäÇÁÇπËßÑÂàôÔºà/services/{spring.application.name}/{serviceId_UUID}/) Ê≥®ÂÜåÂ¢ûÂä† service Id ËÆ°ÁÆó Ëé∑ÂèñÂ∫îËØ•ÂéªÈáç Eureka 2.0 ‰∏çÂºÄÊ∫êÔºåEureka 1.x ËøòÂèØ‰ª•Áî®ÁöÑ ‰ª£Á†Ådemohttps://github.com/Frankenjoy123/microservices-joey-project ÊâæÂà∞spring-cloud-service-discoveryÂÖ•Âè£ÂêØÂä®]]></content>
      <categories>
        <category>SpringCloud</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring cloud ÈÖçÁΩÆÁÆ°ÁêÜ]]></title>
    <url>%2F2018%2F08%2F01%2FSpring-cloud-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[Spring cloudÈÖçÁΩÆÁÆ°ÁêÜÂÆ¢Êà∑Á´ØÁ¨¨‰∏âÊñπÈÖçÁΩÆcommonsÂåÖcommons-configuration Configuration : Êèê‰æõÂ§ßÂ§öÊï∞Â∏∏ËßÅÁ±ªÂûãÁöÑ Value ËΩ¨Êç¢ PropertiesConfiguration: Â∞Ü Properties ‰Ωú‰∏∫ Configuration ÈÖçÁΩÆ MapConfiguration EnvironmentConfiguration Ôºö OS ÁéØÂ¢ÉÂèòÈáè SystemConfiguration : Java Á≥ªÁªüÂ±ûÊÄß CompositeConfiguration ApplicationContext ‰∏é EnvironmentÂÖ≥Á≥ª1ConfigurableEnvironment extends Environment ApplicationContext ‰∏éEnvironment ‰∏Ä‰∏ÄÂØπÂ∫îÔºå‰ΩÜÊòØ‰ºömerge ParentÁöÑEnvironment„ÄÇ ConfigurableEnvironment ‚Äî&gt; MutablePropertySourcesÔºå‰∏Ä‰∏™EnvironmentÂØπÂ∫î‰∏Ä‰∏™PropertySources MutablePropertySources -&gt; List PropertySource : ÂåÖÂê´Â§ö‰∏™ 123Environment -&gt; ConfigurableEnvironment: Áà∂Â≠êÂ±ÇÊ¨°ConfigurableEnvironment -&gt; MutablePropertySources: Ëé∑ÂèñÂèØÂèòÂ§ö‰∏™ÈÖçÁΩÆÊ∫êMutablePropertySources -&gt; List PropertySource : ÂåÖÂê´Â§ö‰∏™ PropertySource PropertySource : ÈÖçÁΩÆÊ∫ê MapPropertySource PropertiesPropertySource CompositePropertySource : ÁªÑÂêà SystemEnvironmentPropertySource ÁéØÂ¢ÉÂèòÈáè Spring Cloud ÂÆ¢Êà∑Á´ØÈÖçÁΩÆÂÆö‰ΩçÊâ©Â±ï : PropertySourceLocator org.springframework.core.envÂåÖ PropertySource SystemEnvironmentPropertySource 12http://localhost:9095/config/devhttp://localhost:9095/config/default ÊúçÂä°Á´ØÂü∫‰∫é Git ÂÆûÁé∞ ÁâàÊú¨ÂåñÈÖçÁΩÆ /Â∫îÁî®Âêç/profile/${label} /Â∫îÁî®Âêç/profile/ = /Â∫îÁî®Âêç/profile/master /Â∫îÁî®Âêç/ = /Â∫îÁî®Âêç.properties ${label} : ÂàÜÊîØ Spring Cloud Config ÂÆûÁé∞‰∏ÄÂ•óÂÆåÊï¥ÁöÑÈÖçÁΩÆÁÆ°ÁêÜ API ËÆæËÆ° Git ÂÆûÁé∞Áº∫Èô∑Ôºö Â§çÊùÇÁöÑÁâàÊú¨Êõ¥Êñ∞Êú∫Âà∂Ôºà Git ‰ªìÂ∫ìÔºâ ÁâàÊú¨ ÂàÜÊîØ Êèê‰∫§ ÈÖçÁΩÆ ÊÜãË∂≥ÁöÑÂÜÖÂÆπÊõ¥Êñ∞ÔºàÂÆûÊó∂ÊÄß‰∏çÈ´òÔºâ ÂÆ¢Êà∑Á´ØÁ¨¨‰∏ÄÊ¨°ÂêØÂä®ÊãâÂèñ ÈúÄË¶ÅÊï¥Âêà BUS ÂÅöÊõ¥Êñ∞ÈÄöÁü• ËÆæËÆ°ÂéüÁêÜÂàÜÊûê@EnableConfigServer123456@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Import(&#123;ConfigServerConfiguration.class&#125;)public @interface EnableConfigServer &#123;&#125; org.springframework.cloud.config.server.config.ConfigServerAutoConfiguration 1234567JdbcRepositoryConfiguration.class,VaultRepositoryConfiguration.class,SvnRepositoryConfiguration.class,NativeRepositoryConfiguration.class,GitRepositoryConfiguration.class, gitÁöÑÂÆûÁé∞DefaultRepositoryConfiguration.class‰ªé‰ª£Á†Å‰∏≠ÁúãÔºåÊâçÊòØÊúÄÁúüÂÆûÁöÑ„ÄÇ 12345678@Configuration@ConditionalOnBean(ConfigServerConfiguration.Marker.class)@EnableConfigurationProperties(ConfigServerProperties.class)@Import(&#123; EnvironmentRepositoryConfiguration.class, CompositeConfiguration.class, ResourceRepositoryConfiguration.class, ConfigServerEncryptionConfiguration.class, ConfigServerMvcConfiguration.class &#125;)public class ConfigServerAutoConfiguration &#123;&#125; ÂΩìÂ∫îÁî®ÈÖçÁΩÆÁ±ªÊ†áÊ≥®‰∫Ü @EnableConfigSever ÂØºÂÖ• ConfigServerConfiguration Ê≥®ÂÜå Marker Bean ‰Ωú‰∏∫ ConfigServerAutoConfiguration Êù°‰ª∂‰πã‰∏Ä jdbcÂÆûÁé∞ Ê†∏ÂøÉÊé•Âè£ EnvironmentRepository 1Environment findOne(String application, String profile, String label) 12jdbc.query(this.sql, new Object[] &#123; app, env, label &#125; JdbcTemplate Bean Êù•Ê∫ê JdbcTemplateAutoConfiguration SQL Êù•Ê∫ê JdbcEnvironmentProperties spring.cloud.config.server.jdbc.sql ‰∏çÈÖçÁΩÆÔºåÈªòËÆ§ÔºöDEFAULT_SQL 1SELECT KEY, VALUE from PROPERTIES where APPLICATION=? and PROFILE=? and LABEL=? KEY VALUE APPLICATION PROFILE LABEL name mercyblitz config default master name xiaomage config test master Êú¨Ë¥®ËØ¥ÊòéÔºö JDBC ËøûÊé•ÊäÄÊúØ DB Â≠òÂÇ®‰ªãË¥® EnvironmentRepository Ê†∏ÂøÉÊé•Âè£ ConfigServerAutoConfiguration EnvironmentRepositoryConfiguration ÈªòËÆ§ÊòØ Git ‰Ωú‰∏∫ÈÖçÁΩÆ‰ªìÂ∫ìÁöÑÂéüÂõ† ÊâæÂà∞‰∫Ü‰∏∫‰ªÄ‰πàÈªòËÆ§ÊòØ Git ‰Ωú‰∏∫ÈÖçÁΩÆ‰ªìÂ∫ìÁöÑÂéüÂõ†Ôºö 123@Configuration@ConditionalOnMissingBean(value = EnvironmentRepository.class, search = SearchStrategy.CURRENT)class DefaultRepositoryConfiguration git ÊòØÈªòËÆ§ÂÆûÁé∞ÔºåÊù°‰ª∂ÊòØÂú®EnvironmentRepositoryÁöÑbeanÊ≤°ÊúâÂä†ËΩΩ„ÄÇ ÊâÄ‰ª•Ëá™Â∑±ÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑÈÖçÁΩÆÔºåÂè™ÈúÄË¶ÅÂä†ËΩΩ‰∏Ä‰∏™EnvironmentRepositoryÁöÑbeanÂç≥ÂèØ„ÄÇ HTTP ËØ∑Ê±ÇÊ®°Âºè/${application}/$${profile}/$${label} @Controller ÊàñËÄÖ @RestController @RequestMapping(‚Äú/{application}/{profile}/{label}‚Äù) /config/test/master config : application test : profile master : label ÂÆ¢Êà∑Á´ØÂÆûÁé∞Spring Cloud Config ClientÈÄöËøáspring.cloud.config.uriÊêúÁ¥¢ÔºåÊâæÂà∞spring-configuration-metadata.json ÊâæÂà∞classConfigClientPropertiesÔºåÂèëÁé∞private String[] uri = { &quot;http://localhost:8888&quot; }ÔºåÂèëÁé∞urlÈªòËÆ§Á´ØÂè£8888„ÄÇ ‰ª£Á†Ådemohttps://github.com/Frankenjoy123/microservices-joey-project ÂêØÂä®spring-cloud-config-server‰∏≠ÁöÑmainÂÖ•Âè£ÔºåËÆøÈóÆÂ¶Ç‰∏ãÂú∞ÂùÄÔºö http://localhost:9095/config/dev Jconsole@RefreshScopeactuator/loggersactuator/envEnvironmentRepository Êé•Âè£Properties ÂÆûÁé∞HashTable hashmap]]></content>
      <categories>
        <category>SpringCloud</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[SpringÂ∫îÁî®‰∏ä‰∏ãÊñáÂèä‰∫ã‰ª∂ÁõëÂê¨Ê∫êÁ†ÅÂàÜÊûê]]></title>
    <url>%2F2018%2F08%2F01%2FSpring%E5%BA%94%E7%94%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E5%8F%8A%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[##ÂÖ≥Èó≠spring-cloud bootstrapÂ∫îÁî®‰∏ä‰∏ãÊñá Â∫îÁî®ÂêØÂä®ÂèÇÊï∞Ê∑ªÂä† 1--spring.cloud.bootstrap.enabled=false http://localhost:9091/actuator/beans 123456&#123;"contexts": &#123;"Joey": &#123;&#125;,"first-boot-app": &#123;&#125;&#125;&#125; 12BootstrapApplicationListeneronApplicationEvent ÁéØÂ¢ÉÂèòÈáèhttp://localhost:9091/actuator/env 123456789101112131415161718192021222324252627282930313233&#123;"activeProfiles": [],"propertySources": [&#123;"name": "server.ports","properties": &#123;&#125;&#125;,&#123;"name": "commandLineArgs","properties": &#123;&#125;&#125;,&#123;"name": "servletContextInitParams","properties": &#123;&#125;&#125;,&#123;"name": "systemProperties","properties": &#123;&#125;&#125;,&#123;"name": "systemEnvironment","properties": &#123;&#125;&#125;,&#123;"name": "springCloudClientHostInfo","properties": &#123;&#125;&#125;,&#123;"name": "applicationConfig: [classpath:/application.properties]","properties": &#123;&#125;&#125;]&#125; ÈÄèËøáÁé∞Ë±°ÊâæÊ∫êÁ†Å commandLineArgs -&gt; findInPath -&gt; scope : project and library CommandLinePropertySource.COMMAND_LINE_PROPERTY_SOURCE_NAME find usage spring bootÁöÑÂºïÁî®-&gt; org.springframework.boot.SpringApplication#configurePropertySources ËøôÊ†∑Â∞±ÂèØ‰ª•ÁªßÁª≠ÂàÜÊûêÊ∫êÁ†Å sources.addFirst(new SimpleCommandLinePropertySource(args)) 12345678910111213141516171819202122protected void configurePropertySources(ConfigurableEnvironment environment, String[] args) &#123; MutablePropertySources sources = environment.getPropertySources(); if (this.defaultProperties != null &amp;&amp; !this.defaultProperties.isEmpty()) &#123; sources.addLast( new MapPropertySource("defaultProperties", this.defaultProperties)); &#125; if (this.addCommandLineProperties &amp;&amp; args.length &gt; 0) &#123; String name = CommandLinePropertySource.COMMAND_LINE_PROPERTY_SOURCE_NAME; if (sources.contains(name)) &#123; PropertySource&lt;?&gt; source = sources.get(name); CompositePropertySource composite = new CompositePropertySource(name); composite.addPropertySource(new SimpleCommandLinePropertySource( "springApplicationCommandLineArgs", args)); composite.addPropertySource(source); sources.replace(name, composite); &#125; else &#123; sources.addFirst(new SimpleCommandLinePropertySource(args)); &#125; &#125;&#125; ‰ªéËøôÊÆµ‰ª£Á†ÅÔºåÂèØ‰ª•ÁúãÂá∫ÔºådefaultProperties‰ºòÂÖàÁ∫ßÊúÄ‰ΩéÔºåÊîæÂú®ÊúÄÂêé„ÄÇcommandLine‰ºòÂÖàÁ∫ßÂæàÈ´òÔºåÊîæÂú®ÊúÄÂâçÈù¢ÔºåaddFirst„ÄÇ ‰ª£Á†Ådemohttps://github.com/Frankenjoy123/microservices-joey-project ÊâæÂà∞spring-cloud-native-applicationÈ°πÁõÆÂÖ•Âè£ÂêØÂä®]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spring-framework 5.0.2Ê∫êÁ†ÅÂØºÂÖ•ideaÊ≠•È™§ÂèädemoÂºÄÂèë]]></title>
    <url>%2F2018%2F07%2F21%2FSpring-framework-5-0-2%E6%BA%90%E7%A0%81%E5%AF%BC%E5%85%A5idea%E6%AD%A5%E9%AA%A4%E5%8F%8Ademo%E5%BC%80%E5%8F%91%2F</url>
    <content type="text"><![CDATA[1.Ê∫êÁ†ÅÁöÑ‰∏ãËΩΩSpringÁöÑÊ∫êÁ†ÅÂèØ‰ª•‰ªéGitHub‰∏ä‰∏ãËΩΩÔºöhttps://github.com/spring-projects/spring-framework ÈÄâÊã©tag5.0.2Ôºå‰∏ãËΩΩzipÊñá‰ª∂ 2. Ê∫êÁ†ÅÁºñËØëÂèØ‰ª•ÂèÇËÄÉimport-into-idea.mdÊñáÊ°£ ÊâßË°å./gradlew :spring-oxm:compileTestJava ÂÖàÂØπ Spring-oxm Ê®°ÂùóËøõË°åÈ¢ÑÁºñËØë„ÄÇ Âú®IDEA‰∏≠ File -&gt; New -&gt; Project from Existing Sources -&gt; Navigate to directoryÈÄâÊã©build.graleÊñá‰ª∂ÊâìÂºÄ Âú®spring-aspects‰∏≠Âè≥ÈîÆÊ®°Âùóload/upload modulesÔºåuploadspring-aspectsÁöÑ‰∏â‰∏™Â≠êÁõÆÂΩï Spring-frameworkË∑≥ËøáÂçïÊµãÔºåÂèØ‰ª•ÊâßË°å./gradlew build -x test 3.demoÊê≠Âª∫1.demoÈÖçÁΩÆmaven quick startÂø´ÈÄüÊê≠Âª∫ËøôÈáåÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑDemoÔºåËØ•Demo‰æùËµñ‰∫éSpringÁöÑÊ∫êÁ†ÅÔºåËøôÊ†∑ÔºåÂ∞±ÂèØ‰ª•‰ªéÂ§ñÈÉ®ÔºåËøêË°åDemoÔºåË∑üË∏™Âà∞SpringÁöÑÂÜÖÈÉ®Ê∫êÁ†Å‰∫Ü„ÄÇ‰∏∫‰∏çÂ§±‰∏ÄËà¨ÊÄßÔºåËøôÈáåÁöÑDemoÈááÁî®MVNËøõË°åÊûÑÂª∫ÔºåÂè™‰∏çËøáÔºåÁõ∏ÂÖ≥ÁöÑSpringÁöÑÊ∫êÁ†Å‰æùËµñÈúÄË¶ÅÂú®IDEA‰∏≠ËÆæÁΩÆÊàêÊú¨Âú∞Ê∫êÁ†Å ‚ë†‰ΩøÁî®IDEA Âú®SpringÁöÑÊ∫êÁ†ÅÁöÑProjectÁõÆÂΩï‰∏ãÔºåÂàõÂª∫‰∏Ä‰∏™DemoÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®MVNÁöÑÈ™®Êû∂ ËÆæÁΩÆ‰æùËµñA„ÄÅËÆæÁΩÆ‰∏Ä‰∏ãpom.xml ‰∏≠ÁöÑ junit ‰æùËµñÁâàÊú¨Ôºå‰øÆÊîπ‰∏∫ 4.12 Âê¶ÂàôSpringÁöÑÂçïÂÖÉÊµãËØïÔºåÁºñËØë‰∏çÈÄöËøá B„ÄÅÂú®IDEAËÆæÁΩÆSpringÁöÑÈ°πÁõÆ‰æùËµñÔºàËÆæÁΩÆSpring-core„ÄÅSpring-beans„ÄÅSpring-context„ÄÅSpring-expressionËøôÂá†‰∏™moduleÂ∞±ÂèØ‰ª•‰∫ÜÔºâÔºö C„ÄÅpom.xml‰∏≠ÈúÄË¶ÅÂºïÂÖ•commons-loggingÁöÑ‰æùËµñ,Âê¶ÂàôÁºñËØëÊä•Êâæ‰∏çÂà∞LogginFactoryÁöÑÈîôËØØ.ÈÖçÁΩÆÈùôÊÄÅËµÑÊ∫êË∑ØÂæÑ(Âê¶ÂàôËØªÂèñxmlÁöÑÊó∂ÂÄô,Êâæ‰∏çÂà∞Ë∑ØÂæÑ) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.joey.demo&lt;/groupId&gt; &lt;artifactId&gt;demo-start&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;name&gt;demo-start&lt;/name&gt; &lt;!-- FIXME change it to the project's website --&gt; &lt;url&gt;http://www.example.com&lt;/url&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;commons-logging&lt;/groupId&gt; &lt;artifactId&gt;commons-logging&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;pluginManagement&gt;&lt;!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) --&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-clean-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0&lt;/version&gt; &lt;/plugin&gt; &lt;!-- see http://maven.apache.org/ref/current/maven-core/default-bindings.html#Plugin_bindings_for_jar_packaging --&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.2&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.7.0&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;2.20.1&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.2&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt; &lt;version&gt;2.5.2&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt; &lt;version&gt;2.8.2&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;/build&gt;&lt;/project&gt; D„ÄÅËÆæÁΩÆSpringÁöÑÈÖçÁΩÆÂíåÁºñÂÜôÁÆÄÂçïÁöÑSpring‰ª£Á†Å ÂàõÂª∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑ ÁôªÂΩïÊé•Âè£ ILoginÔºö 123public interface ILogin &#123; String loginCheck(String userName,String password);&#125; ÂÆÉÊúâ‰∏™ÂÆûÁé∞Á±ªÔºö 12345678910111213141516public class LoginServiceImpl implements ILogin &#123; String id = ""; @Autowired(required = false) public void setId(String id) &#123; this.id = id; &#125; @Override public String loginCheck(String userName, String password) &#123; System.out.println("boyÁôªÂΩï..."); return "success"; &#125;&#125; ÁÑ∂ÂêéÔºåÊääËØ•bean Ê≥®ÂÜåÂà∞ÈÖçÁΩÆ‰∏≠(Ë∑ØÂæÑspring-debug/src/spring-config.xml)Ôºö 1234567&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; &lt;bean id="loginService" class="com.joey.demo.service.impl.LoginServiceImpl"/&gt;&lt;/beans&gt; ÊúÄÂêéÔºåÁºñÂÜôË∞ÉÁî®ÁöÑ‰ª£Á†ÅÔºö 1234567891011121314151617public class App&#123; public static void main( String[] args ) &#123; ApplicationContext applicationContext = new ClassPathXmlApplicationContext("classpath:applicationContext.xml");// String XMLPath = "//Users/sky/Java/spring-framework/spring-debug/src/spring-config.xml";// ApplicationContext applicationContext = new FileSystemXmlApplicationContext(XMLPath); ILogin login = (ILogin) applicationContext.getBean("loginService"); login.loginCheck("boy", "123"); &#125;&#125; ÁÑ∂ÂêéÂ∞±ÂèØ‰ª• ËøõË°åDebug‰∫ÜÔºåÂπ∂‰∏îÂèØ‰ª•DebugÂà∞SpringÊ∫êÁ†ÅÂÜÖÈÉ®„ÄÇ]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[XMindÂø´Êç∑ÈîÆÊåáÂçó]]></title>
    <url>%2F2018%2F07%2F20%2FXMind%E5%BF%AB%E6%8D%B7%E9%94%AE%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[Âø´Êç∑ÈçµÔºàWindowsÔºâ Âø´Êç∑ÈçµÔºàMacÔºâ ÊèèËø∞ Ctrl+N Command+N Âª∫Á´ãÊñ∞Â∑•‰ΩúÁ∞ø Ctrl+O Command+O ÂºÄÂêØÂ∑•‰ΩúÁ∞ø Ctrl+S Command+S ÂÇ®Â≠òÁõÆÂâçÂ∑•‰ΩúÁ∞ø Ctrl+Shift+S Command+Shift+S ÂÇ®Â≠òÂÖ®ÈÉ®Â∑•‰ΩúÁ∞ø Ctrl+W Command+W ÂÖ≥Èó≠ÁõÆÂâçÂ∑•‰ΩúÁ∞ø Ctrl+Shift+W Command+Shift+W ÂÖ≥Èó≠ÂÖ®ÈÉ®Â∑•‰ΩúÁ∞ø Ctrl+P Command+P ÂàóÂç∞ Ctrl+Z Command+Z Â§çÂéü Ctrl+Y Command+Y ÈáçÂÅö Ctrl+X Command+X Ââ™Âàá Ctrl+C Command+C Â§çÂà∂ Ctrl+V Command+V Ë¥¥‰∏ä Delete Delete Âà†Èô§ Ctrl+Home Command+Home ËøîÂõû‰∏≠ÂøÉ‰∏ªÈ°å Ctrl+A Command+A ÈÄâÊã©ÂÖ®ÈÉ®‰∏ªÈ°å Ctrl+Shift+A Command+Shift+A ÈÄâÊã©ÂêåÂ±§Á¥ö‰∏ªÈ°å Ctrl+Alt+A Command+Alt+A ÈÄâÊã©Â≠ê‰∏ªÈ°å Ctrl+F Command+F ÂØªÊâæ/Âèñ‰ª£ Ctrl++ Command++ ÊîæÂ§ß Ctrl+- Command+- Áº©Â∞è Ctrl+= Command+= Ê≠£Â∏∏Â§ßÂ∞è Ctrl+] Command+] ÊèíÂÖ•ÊëòË¶Å Alt+Enter Alt+Enter Â±ûÊÄßÂÜÖÂÆπÂÖßÂÆπ Enter Enter ÊèíÂÖ•‰∏ªÈ¢ò Tab Tab ÊèíÂÖ•Â≠ê‰∏ªÈ¢ò Shift+Enter Shift+Enter Âú®ÁõÆÂâç‰∏ªÈ¢òÂâçÊèíÂÖ•‰∏ªÈ¢ò Ctrl+Enter Command+Enter ÊèíÂÖ•ÁõÆÂâç‰∏ªÈ¢òÁà∂‰∏ªÈ¢ò Ctrl+Shift+L Command+Shift+L Âø´Êç∑ÈçµÂä©Êâã Ctrl+I Ctrl+I ÊèíÂÖ•ÂõæÁâá Ctrl+Shift+H Command+Shift+H ÊèíÂÖ•Ë∂ÖÈìæÊé• Ctrl+B Command+B Ê∑ªÂä†Â§ñÊ°Ü Ctrl+L Command+L Ê∑ªÂä†ÂÖ≥ËÅî F2 F2 ÁºñËæë‰∏ªÈ¢ò F3 F3 Ê∑ªÂä†/ÁºñËæëÊ†áÁ≠æ F4 F4 Ê∑ªÂä†/ÁºñËæëÂ§áÊ≥® F5 F5 ÁÆÄÊä•ÊºîÁ§∫ F6 F6 ‰∏ãÈíª Shift+F6 Shift+F6 ‰∏äÈíª F7 F7 Êô∫ÊÖßÊà™ÂèñÂõæÈù¢ + + Â±ïÂºÄÁõÆÂâçÂàÜÊîØ - - Êî∂Áº©ÁõÆÂâçÂàÜÊîØ * * Â±ïÂºÄÊâÄÊúâÂàÜÊîØ / / Êî∂Áº©ÊâÄÊúâÂàÜÊîØ Alt+Up Alt+Up ÂêëÂâçÁßªÂä® Alt+Down Alt+Down ÂêëÂêéÁßªÂä® Ctrl+T Command+T Âª∫Á´ãÊñ∞ÂøÉÊô∫Âõæ Ctrl+1,2,3,4,5,6 Command+1,2,3,4,5,6 Âø´ÈÄüÊ∑ªÂä†‰ºòÂÖàÁ≠âÁ∫ßÂõæÊ†á Esc Esc ÂÖ≥Èó≠Ë∑≥Âá∫ÁöÑÂ§áÊ≥®ÂØπËØùÊ°Ü / ÂèñÊ∂àÊà™Âõæ Ctrl+ÊªëÈº†ÊªöËΩÆ Command+ÊªëÈº†ÊªöËΩÆ ÊîæÂ§ßÁº©Â∞èÁõÆÂâçÁöÑÁîªÈù¢]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÁêÜËß£spring‰∏≠ÁöÑBeanFactory‰∏éFactoryBeanÂå∫Âà´]]></title>
    <url>%2F2018%2F07%2F19%2F%E7%90%86%E8%A7%A3spring%E4%B8%AD%E7%9A%84BeanFactory%E4%B8%8EFactoryBean%E5%8C%BA%E5%88%AB%2F</url>
    <content type="text"><![CDATA[ÂÆûÁé∞ BeanFactory Êé•Âè£ÁöÑÁ±ªË°®ÊòéÊ≠§Á±ª‰∫ã‰∏Ä‰∏™Â∑•ÂéÇÔºå‰ΩúÁî®Â∞±ÊòØÈÖçÁΩÆ„ÄÅÊñ∞Âª∫„ÄÅÁÆ°ÁêÜ ÂêÑÁßçBean„ÄÇDefaultListBeanFacoryÁ≠âÈÉΩÂÆûÁé∞Ëøô‰∏™Êé•Âè£ÔºåIOCÂÆπÂô®ÔºåÁÆ°ÁêÜbean„ÄÇ ËÄå ÂÆûÁé∞ FactoryBean ÁöÑÁ±ªË°®ÊòéÊ≠§Á±ª‰πüÊòØ‰∏Ä‰∏™BeanÔºåÁ±ªÂûã‰∏∫Â∑•ÂéÇBeanÔºàSpring‰∏≠ÂÖ±Êúâ‰∏§ÁßçbeanÔºå‰∏ÄÁßç‰∏∫ÊôÆÈÄöbeanÔºåÂè¶‰∏ÄÁßçÂàô‰∏∫Â∑•ÂéÇbeanÔºâ„ÄÇÈ°æÂêçÊÄù‰πâÔºåÂÆÉ‰πüÊòØÁî®Êù•ÁÆ°ÁêÜBeanÁöÑÔºåËÄåÂÆÉÊú¨Ë∫´Áî±springÁÆ°ÁêÜ„ÄÇ ‰∏Ä‰∏™BeanÊÉ≥Ë¶ÅÂÆûÁé∞ FactoryBean ÔºåÂøÖÈ°ªÂÆûÁé∞‰ª•‰∏ã‰∏â‰∏™Êé•Âè£Ôºö 123451. Object getObject():ËøîÂõûÁî±FactoryBeanÂàõÂª∫ÁöÑBeanÁöÑÂÆû‰æã2. boolean isSingleton():Á°ÆÂÆöÁî±FactoryBeanÂàõÂª∫ÁöÑBeanÁöÑ‰ΩúÁî®ÂüüÊòØsingletonËøòÊòØprototypeÔºõ3. getObjectType():ËøîÂõûFactoryBeanÂàõÂª∫ÁöÑBeanÁöÑÁ±ªÂûã„ÄÇ12345 Êúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÔºåÂ¶ÇÊûúÂ∞Ü‰∏Ä‰∏™ÂÆûÁé∞‰∫ÜFactoryBeanÁöÑÁ±ªÊàêÂäüÈÖçÁΩÆÂà∞‰∫Üspring‰∏ä‰∏ãÊñá‰∏≠ÔºåÈÇ£‰πàÈÄöËøáËØ•Á±ªÂØπË±°ÁöÑÂêçÁß∞ÔºàÊØîÂ¶ÇappleFactoryBeanÔºâ‰ªéspringÁöÑapplicationContextÊàñËÄÖbeanFactoryËé∑ÂèñbeanÊó∂ÔºåËé∑ÂèñÂà∞ÁöÑÊòØappleFactoryBeanÂàõÂª∫ÁöÑappleÂÆû‰æãÔºåËÄå‰∏çÊòØappleFactoryBeanËá™Â∑±ÔºåÂ¶ÇÊûúÊÉ≥ÈÄöËøáspringÊãøÂà∞appleFactoryBeanÔºåÈúÄË¶ÅÂú®ÂêçÁß∞ÂâçÂä† &amp; Á¨¶Âè∑ Ôºö 1out.println(applicationContext.getBean("&amp;appleFactoryBean"))1 Ëøô‰∏™prefixÂú®BeanFactoryÊé•Âè£Ê∫êÁ†Å‰∏≠ÊúâÊèêÂà∞Ôºö 1234567/*** Used to dereference a &#123;@link FactoryBean&#125; instance and distinguish it from* beans &lt;i&gt;created&lt;/i&gt; by the FactoryBean. For example, if the bean named* &#123;@code myJndiObject&#125; is a FactoryBean, getting &#123;@code &amp;myJndiObject&#125;* will return the factory, not the instance returned by the factory.*/ String FACTORY_BEAN_PREFIX = "&amp;";1234567 ËøòÊúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÔºåFactoryBeanÁÆ°ÁêÜÁöÑbeanÂÆûÈôÖ‰∏ä‰πüÊòØÁî±springËøõË°åÈÖçÁΩÆ„ÄÅÂÆû‰æãÂåñ„ÄÅÁÆ°ÁêÜÔºåÂõ†Ê≠§Áî±FactoryBeanÁÆ°ÁêÜÁöÑbean‰∏çËÉΩÂÜçÊ¨°ÈÖçÁΩÆÂà∞springÈÖçÁΩÆÊñá‰ª∂‰∏≠Ôºàxml„ÄÅjavaÁ±ªÈÖçÁΩÆ„ÄÅÊ≥®Ëß£Âùá‰∏çÂèØ‰ª•ÔºâÔºåÂê¶Âàô‰ºöÊä•Â¶Ç‰∏ãÂºÇÂ∏∏Ôºö 1234567891011121314Exception in thread "main" org.springframework.beans.factory.BeanIsNotAFactoryException: Bean named 'appleFactoryBean' is expected to be of type 'org.springframework.beans.factory.FactoryBean' but was actually of type 'java.lang.Object' at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectForBeanInstance(AbstractBeanFactory.java:1612) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:317) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197) at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:742) at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:866) at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:542) at org.springframework.context.annotation.AnnotationConfigApplicationContext.&lt;init&gt;(AnnotationConfigApplicationContext.java:84) at com.joen.testspringcontainer.Start.main(Start.java:11) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)1234567891011121314 ÈôÑ‰∏ä‰∏Ä‰∏™‰æãÂ≠êÔºö springÈÖçÁΩÆÁ±ªÔºö 1234@Configuration@ComponentScanpublic class Configurations &#123;&#125;1234 AppleBean : 1234//@Component ËøôÈáå‰∏çÂèØ‰ª•Âä†Ê≥®Ëß£ ÔºÅÔºÅÔºÅÔºÅÔºÅÔºÅpublic class AppleBean&#123;&#125;1234 AppleFactoryBean : 123456789101112131415@Componentpublic class AppleFactoryBean implements FactoryBean&#123; public Object getObject() throws Exception &#123; return new AppleBean(); &#125; public Class&lt;?&gt; getObjectType() &#123; return AppleBean.class; &#125; public boolean isSingleton() &#123; return false; &#125;&#125;123456789101112131415 ÂêØÂä®Á±ª : 1234567public class Start &#123; public static void main(String[] args)&#123; ApplicationContext applicationContext = new AnnotationConfigApplicationContext(Configurations.class); out.println(applicationContext.getBean("appleFactoryBean"));//ÂæóÂà∞ÁöÑÊòØapple out.println(applicationContext.getBean("&amp;appleFactoryBean"));//ÂæóÂà∞ÁöÑÊòØappleÂ∑•ÂéÇ &#125;&#125;]]></content>
      <categories>
        <category>Spring</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[cookie‰∏≠ÁöÑpath‰∏édomainÂ±ûÊÄßËØ¶Ëß£]]></title>
    <url>%2F2018%2F07%2F13%2Fcookie%E4%B8%AD%E7%9A%84path%E4%B8%8Edomain%E5%B1%9E%E6%80%A7%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[#Â≠óÊÆµËß£Èáä Domain ‚Äì ÂüüdomainË°®Á§∫ÁöÑÊòØcookieÊâÄÂú®ÁöÑÂüüÔºåÈªòËÆ§‰∏∫ËØ∑Ê±ÇÁöÑÂú∞ÂùÄÔºåÂ¶ÇÁΩëÂùÄ‰∏∫www.jb51.net/test/test.aspxÔºåÈÇ£‰πàdomainÈªòËÆ§‰∏∫www.jb51.net„ÄÇËÄåË∑®ÂüüËÆøÈóÆÔºåÂ¶ÇÂüüA‰∏∫t1.test.comÔºåÂüüB‰∏∫t2.test.comÔºåÈÇ£‰πàÂú®ÂüüAÁîü‰∫ß‰∏Ä‰∏™‰ª§ÂüüAÂíåÂüüBÈÉΩËÉΩËÆøÈóÆÁöÑcookieÂ∞±Ë¶ÅÂ∞ÜËØ•cookieÁöÑdomainËÆæÁΩÆ‰∏∫.test.comÔºõÂ¶ÇÊûúË¶ÅÂú®ÂüüAÁîü‰∫ß‰∏Ä‰∏™‰ª§ÂüüA‰∏çËÉΩËÆøÈóÆËÄåÂüüBËÉΩËÆøÈóÆÁöÑcookieÂ∞±Ë¶ÅÂ∞ÜËØ•cookieÁöÑdomainËÆæÁΩÆ‰∏∫t2.test.com„ÄÇ ÂÄºÊòØÂüüÂêçÔºåÊØîÂ¶Çwww.china.com„ÄÇËøôÊòØÂØπpathË∑ØÂæÑÂ±ûÊÄßÁöÑ‰∏Ä‰∏™Âª∂‰º∏„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥ËÆ© www.china.comËÉΩÂ§üËÆøÈóÆbbs.china.comËÆæÁΩÆÁöÑcookiesÔºåËØ•ÊÄé‰πàÂäû? Êàë‰ª¨ÂèØ‰ª•ÊäädomainÂ±ûÊÄßËÆæÁΩÆÊàê‚Äú.china.com‚ÄùÔºåÂπ∂ÊääpathÂ±ûÊÄßËÆæÁΩÆÊàê‚Äú/‚Äù„ÄÇ Ë∑ØÂæÑËÉΩËß£ÂÜ≥Âú®Âêå‰∏Ä‰∏™Âüü‰∏ãËÆøÈóÆ cookie ÁöÑÈóÆÈ¢òÔºåÂí±‰ª¨Êé•ÁùÄËØ¥ cookie ÂÆûÁé∞ÂêåÂüü‰πãÈó¥ËÆøÈóÆÁöÑÈóÆÈ¢ò„ÄÇËØ≠Ê≥ïÂ¶Ç‰∏ãÔºö document.cookie = ‚Äúname=value;path=path;domain=domain‚Äú Á∫¢Ëâ≤ÁöÑdomainÂ∞±ÊòØËÆæÁΩÆÁöÑ cookie ÂüüÁöÑÂÄº„ÄÇ‰æãÂ¶Ç ‚Äúwww.qq.com‚Äù ‰∏é ‚Äúsports.qq.com‚Äù ÂÖ¨Áî®‰∏Ä‰∏™ÂÖ≥ËÅîÁöÑÂüüÂêç‚Äùqq.com‚ÄùÔºåÊàë‰ª¨Â¶ÇÊûúÊÉ≥ËÆ©‚Äùsports.qq.com‚Äù ‰∏ãÁöÑcookieË¢´ ‚Äúwww.qq.com‚Äù ËÆøÈóÆÔºåÊàë‰ª¨Â∞±ÈúÄË¶ÅÁî®Âà∞cookie ÁöÑdomainÂ±ûÊÄßÔºåÂπ∂‰∏îÈúÄË¶ÅÊääpathÂ±ûÊÄßËÆæÁΩÆ‰∏∫ ‚Äú/‚Äú„ÄÇ‰æãÔºö document.cookie = ‚Äúusername=Darren;path=/;domain=qq.com‚Äú Ê≥®Ôºö‰∏ÄÂÆöÁöÑÊòØÂêåÂüü‰πãÈó¥ÁöÑËÆøÈóÆÔºå‰∏çËÉΩÊäädomainÁöÑÂÄºËÆæÁΩÆÊàêÈùû‰∏ªÂüüÁöÑÂüüÂêç„ÄÇ Path ‚Äì Ë∑ØÂæÑpathË°®Á§∫cookieÊâÄÂú®ÁöÑÁõÆÂΩïÔºåasp.netÈªòËÆ§‰∏∫/ÔºåÂ∞±ÊòØÊ†πÁõÆÂΩï„ÄÇÂú®Âêå‰∏Ä‰∏™ÊúçÂä°Âô®‰∏äÊúâÁõÆÂΩïÂ¶Ç‰∏ãÔºö/test/,/test/cd/,/test/dd/ÔºåÁé∞ËÆæ‰∏Ä‰∏™cookie1ÁöÑpath‰∏∫/test/Ôºåcookie2ÁöÑpath‰∏∫/test/cd/ÔºåÈÇ£‰πàtest‰∏ãÁöÑÊâÄÊúâÈ°µÈù¢ÈÉΩÂèØ‰ª•ËÆøÈóÆÂà∞cookie1ÔºåËÄå/test/Âíå/test/dd/ÁöÑÂ≠êÈ°µÈù¢‰∏çËÉΩËÆøÈóÆcookie2„ÄÇËøôÊòØÂõ†‰∏∫cookieËÉΩËÆ©ÂÖ∂pathË∑ØÂæÑ‰∏ãÁöÑÈ°µÈù¢ËÆøÈóÆ„ÄÇ ÂÄºÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÁõÆÂΩïÔºåÊàñËÄÖÊòØ‰∏Ä‰∏™Ë∑ØÂæÑ„ÄÇÂ¶ÇÊûúhttp://www.china.com/test/index.html Âª∫Á´ã‰∫Ü‰∏Ä‰∏™cookieÔºåÈÇ£‰πàÂú®http://www.china.com/test/ÁõÆÂΩïÈáåÁöÑÊâÄÊúâÈ°µÈù¢Ôºå‰ª•ÂèäËØ•ÁõÆÂΩï‰∏ãÈù¢‰ªª‰ΩïÂ≠êÁõÆÂΩïÈáåÁöÑÈ°µÈù¢ÈÉΩÂèØ‰ª•ËÆøÈóÆËøô‰∏™cookie„ÄÇËøôÂ∞±ÊòØËØ¥ÔºåÂú®http://www.china.com/test/test2/test3 ÈáåÁöÑ‰ªª‰ΩïÈ°µÈù¢ÈÉΩÂèØ‰ª•ËÆøÈóÆhttp://www.china.com/test/index.htmlÂª∫Á´ãÁöÑcookie„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúhttp://www.china.com/test/ ÈúÄË¶ÅËÆøÈóÆhttp://www.china.com/test/index.htmlËÆæÁΩÆÁöÑcookesÔºåËØ•ÊÄé‰πàÂäûÔºüËøôÊó∂ÔºåÊàë‰ª¨Ë¶ÅÊääcookiesÁöÑpathÂ±ûÊÄßËÆæÁΩÆÊàê‚Äú/‚Äù„ÄÇÂú®ÊåáÂÆöË∑ØÂæÑÁöÑÊó∂ÂÄôÔºåÂá°ÊòØÊù•Ëá™Âêå‰∏ÄÊúçÂä°Âô®ÔºåURLÈáåÊúâÁõ∏ÂêåË∑ØÂæÑÁöÑÊâÄÊúâWEBÈ°µÈù¢ÈÉΩÂèØ‰ª•ÂÖ±‰∫´cookies„ÄÇ Expires ‚Äì ËøáÊúüÊó∂Èó¥ÊåácookieÁöÑÁîüÂëΩÊúüÔºåÁ°ÆÂàáÂú∞ËØ¥ÊòØËøáÊúüÊó•Êúü„ÄÇÂ¶ÇÊûúÊÉ≥ËÆ©cookieÁöÑÂ≠òÂú®ÊúüÈôêË∂ÖËøáÂΩìÂâçÊµèËßàÂô®ÁöÑ‰ºöËØùÊó∂Èó¥ÔºåÂ∞±ÂøÖÈ°ª‰ΩøÁî®Ëøô‰∏™Â±ûÊÄß„ÄÇÂΩìËøá‰∫ÜÂà∞ÊúüÊó•ÊúüÊó∂ÔºåÊµèËßàÂô®‰ºöËá™Âä®Âà†Èô§cookieÊñá‰ª∂„ÄÇ expires/Max-Age Â≠óÊÆµ‰∏∫Ê≠§cookieË∂ÖÊó∂Êó∂Èó¥„ÄÇËã•ËÆæÁΩÆÂÖ∂ÂÄº‰∏∫‰∏Ä‰∏™Êó∂Èó¥ÔºåÈÇ£‰πàÂΩìÂà∞ËææÊ≠§Êó∂Èó¥ÂêéÔºåÊ≠§cookieÂ§±Êïà„ÄÇ‰∏çËÆæÁΩÆÁöÑËØùÈªòËÆ§ÂÄºÊòØSessionÔºåÊÑèÊÄùÊòØcookie‰ºöÂíåsession‰∏ÄËµ∑Â§±Êïà„ÄÇÂΩìÊµèËßàÂô®ÂÖ≥Èó≠(‰∏çÊòØÊµèËßàÂô®Ê†áÁ≠æÈ°µÔºåËÄåÊòØÊï¥‰∏™ÊµèËßàÂô®) ÂêéÔºåÊ≠§cookieÂ§±Êïà„ÄÇ 3.ÊµèËßàÂô®‰ºöÂ∞ÜdomainÂíåpathÈÉΩÁõ∏ÂêåÁöÑcookie‰øùÂ≠òÂú®‰∏Ä‰∏™Êñá‰ª∂ÈáåÔºåcookieÈó¥Áî®*ÈöîÂºÄ„ÄÇ ##Secure ‚Äì ÂÆâÂÖ® ËÆæÁΩÆÊòØÂê¶Âè™ËÉΩÈÄöËøáhttpsÊù•‰º†ÈÄícookie ##httpÂ≠óÊÆµ cookieÁöÑhttponlyÂ±ûÊÄß„ÄÇËã•Ê≠§Â±ûÊÄß‰∏∫trueÔºåÂàôÂè™ÊúâÂú®httpËØ∑Ê±ÇÂ§¥‰∏≠‰ºöÂ∏¶ÊúâÊ≠§cookieÁöÑ‰ø°ÊÅØÔºåËÄå‰∏çËÉΩÈÄöËøádocument.cookieÊù•ËÆøÈóÆÊ≠§cookie„ÄÇ SizeÂ≠óÊÆµÊ≠§cookieÂ§ßÂ∞è„ÄÇ ÊµãËØï‰ªäÂ§©Á†îÁ©∂‰∏ÄÂ§©ÂèëÁé∞cookieÊó†Ê≥ïËÆæÁΩÆÈô§ÂΩìÂâçÂüüÂêçÊàñËÄÖÂÖ∂Áà∂ÂüüÂêç‰πãÂ§ñÁöÑÂÖ∂‰ªñdomain. Ëøô‰∏™ÊòØÊµèËßàÂô®Âá∫‰∫éÂØπcookieÁöÑ‰øùÊä§ÈÄ†ÊàêÁöÑÔºå‰πüÂ∞±ÊòØcookieÊó†Ê≥ïË∑®ÂüüËÆæÁΩÆ„ÄÇ ÂØπ‰∫éÂ≠êÂüüÂêç‰πüÊúâÂ¶Ç‰∏ãËßÑÂàôÔºåÂΩìÂâçÂüüÂêçÂè™ËÉΩËÆæÁΩÆÂΩìÂâçÂüüÂêç‰ª•Âèä‰ªñÁöÑÁà∂ÂüüÂêçÔºå‰∏çËÉΩËÆæÁΩÆÂ≠êÂüüÂêç Â¶ÇÂú®www.wo.cao.baidu.com ÂüüÂêç‰∏ãÂè™ËÉΩËÆæÁΩÆ cao.baidu.com baidu.com ‰∏çËÉΩËÆæÁΩÆ da.jia.wo.cao.baidu.comÁöÑcookie„ÄÇ ÂΩìÊàë‰ª¨ÁªôÁΩëÁ´ôËÆæÁΩÆcookieÊó∂ÔºåÂ§ßÂÆ∂ÊúâÊ≤°ÊúâÂèëÁé∞Âú®ÁΩëÁ´ôÁöÑÂÖ∂‰ªñÂüüÂêç‰∏ã‰πüÊé•Êî∂Âà∞‰∫ÜËøô‰∫õcookie„ÄÇËøô‰∫õÊ≤°Áî®ÁöÑcookieÁúã‰ºº‰∏çÂç†Â§öÂ∞ëÊµÅÈáèÔºå‰ΩÜÂ¶ÇÊûúÂØπ‰∏Ä‰∏™Êó•PVÂçÉ‰∏áÁöÑÁ´ôÁÇπÊù•ËØ¥ÔºåÈÇ£Êµ™Ë¥πÁöÑËµÑÊ∫êÂ∞±‰∏çÊòØ‰∏ÄÁÇπÁÇπ‰∫Ü„ÄÇÂõ†Ê≠§Âú®ËÆæÁΩÆcookieÊó∂ÔºåÂØπÂÆÉÁöÑ‰ΩúÁî®Âüü‰∏ÄÂÆöË¶ÅËÆæÁΩÆÂáÜÁ°Æ‰∫Ü„ÄÇ Êàë‰ª¨ÈÉΩÁü•ÈÅìÂú®PHP‰∏≠Áî®setcookie Êù•ËÆæÁΩÆÁΩëÁ´ôÁöÑcookieÔºåËØ•ÂáΩÊï∞ÁöÑÁî®Ê≥ïÂ¶Ç‰∏ãÔºö bool setcookie ( string $name [, string $value [, int$expire = 0 [, string$path [, string $domain [, bool$secure = false [, bool$httponly = false ]]]]]] ) ‰ªäÂ§©Êàë‰ª¨Â∞±Êù•Êé¢ËÆ®‰∏Ä‰∏ãÂÆÉÁöÑÁ¨¨‰∫î‰∏™ÂèÇÊï∞$domainÔºåÂõ†‰∏∫ÂÆÉÂÜ≥ÂÆö‰∫ÜcookieÁöÑ‰ΩúÁî®Âüü„ÄÇ Áé∞Âú®ÊúâÂ¶Ç‰∏ã3‰∏™ÂüüÂêçÔºå‰∏Ä‰∏™È°∂Á∫ßÂüüÂêç„ÄÅ‰∏Ä‰∏™‰∫åÁ∫ßÂüüÂêçÂíå‰∏Ä‰∏™‰∏âÁ∫ßÂüüÂêçÔºö ‚ë† zydya.com‚ë°blog.zyday.com‚ë¢one.blog.zyday.com È¶ñÂÖàÂú®‚ë†zyday.comÂüüÂêç‰∏ãËÆæÁΩÆcookieÔºåÂÅöÂõõÊ¨°ÊµãËØïÔºåÂàÜÂà´ËÆæÁΩÆdomainÂèÇÊï∞‰∏∫Á©∫„ÄÅ‚Äôzyday.com‚Äô„ÄÅ‚Äôblog.zyday.com‚Äô‰∏é‚Äôone.blog.zyday.com‚Äô„ÄÇ‚àöË°®Á§∫ËØ•ÂüüÂêç‰∏ãËÉΩÂèñÂà∞cookieÔºå√óË°®Á§∫‰∏çËÉΩÂèñÂà∞cookie domainÂèÇÊï∞ zydya.com blog.zyday.com one.blog.zyday.com setcookie(‚Äòname‚Äô,1,time()+1) ‚àö ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,‚Äôzyday.com‚Äô) ‚àö ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time() +1,‚Äô/‚Äò,‚Äôblog.zyday.com‚Äô) √ó √ó √ó setcookie(‚Äòname‚Äô,1,time() +1,‚Äô/‚Äò,‚Äôone.blog.zyday.com‚Äô) √ó √ó √ó ÂΩìdomainËÆæÁΩÆ‰∏∫Á©∫Êó∂ÔºådomainÈªòËÆ§‰∏∫ÂΩìÂâçÂüüÂêçÔºåÂπ∂‰∏îËØ•ÂüüÂêç‰∏ãÁöÑÂ≠êÂüüÂêçÈÉΩÂèØ‰ª•Êé•Êî∂Âà∞cookie„ÄÇ‰ΩÜÊòØdomainÂèÇÊï∞ËÆæÁΩÆÂÖ∂Â≠êÂüüÂêçÊó∂ÔºåÊâÄÊúâÂüüÂêçÂ∞±Êé•Êî∂‰∏çÂà∞‰∫ÜÔºåÂåÖÊã¨ÈÇ£‰∏™Â≠êÂüüÂêç„ÄÇ Âè™ËÉΩËÆæÁΩÆÂΩìÂâçÂüüÂêçÊàñËÄÖÁà∂ÂüüÂêçÁöÑcookieÔºå ÁÑ∂ÂêéÂú®‚ë°blog.zyday.comÂüüÂêç‰∏ãËÆæÁΩÆcookieÔºåÊµãËØïÊù°‰ª∂Âêå‰∏ä domainÂèÇÊï∞ zydya.com *blog.zyday.com* one.blog.zyday.com setcookie(‚Äòname‚Äô,1,time() +1) √ó ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,‚Äôzyday.com‚Äô) ‚àö ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,‚Äôblog.zyday.com‚Äô) √ó ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,one.blog.zyday.com‚Äô) √ó √ó √ó ÁúãÁ¨¨‰∫åË°åÔºådomainÂèÇÊï∞ÊòØzyday.comÔºåÊòØblog.zyday.comÁöÑÁà∂ÂüüÂêçÔºåÈÇ£‰πàzyday.com‰∏ãÊâÄÊúâÂ≠êÂüüÂêç(ÂåÖÊã¨zyday.com„ÄÅblog.zyday.com„ÄÅone.blog.zyday.com)ÈÉΩËÉΩÊé•Êî∂Âà∞cookie„ÄÇÂΩìdomain‰∏∫Ëá™Ë∫´ÂüüÂêçÊó∂ÔºåÈÇ£‰πàÂÖ∂Áà∂ÂüüÂêçÂèóÂΩ±ÂìçÔºåÂÖ∂Êú¨Ë∫´‰∏éÂÖ∂Â≠êÂüüÂêçÂèØ‰ª•Êé•Êî∂Âà∞cookie„ÄÇËÄåËÆæÁΩÆÂÖ∂Â≠êÂüüÂêçÊàñÂÖ∂‰ªñÂüüÂêçÊó∂ÔºåÊâÄÊúâÂüüÂêçÈÉΩÊé•Êî∂‰∏çÂà∞cookie‰∫Ü„ÄÇ ÊúÄÂêéÂú®‚ë¢one.blog.zyday.comÂüüÂêç‰∏ãËÆæÁΩÆcookie domainÂèÇÊï∞ zydya.com blog.zyday.com *one.blog.zyday.com* setcookie(‚Äòname‚Äô,1,time() +1) √ó √ó ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,‚Äôzyday.com‚Äô) ‚àö ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,‚Äôblog.zyday.com‚Äô) √ó ‚àö ‚àö setcookie(‚Äòname‚Äô,1,time()+1,‚Äô/‚Äò,one.blog.zyday.com‚Äô) √ó √ó ‚àö Á¨¨‰∏â‰∏™ÊµãËØïÂæóÂá∫ÁöÑÁªìËÆ∫Âú®‰∏äÈù¢Â∑≤ÁªèÊÄªÁªì‰∫Ü„ÄÇÂÜçÁúã‰∏ÄÈÅçÔºåËøôÈáåÂ∞±‰∏çÂ§öËß£Èáä‰∫Ü„ÄÇ domainÁöÑËÆæÁΩÆÔºåÊúâ‰∏§ÁÇπË¶ÅÊ≥®ÊÑèÔºö 1.Âú®setcookie‰∏≠ÁúÅÁï•domainÂèÇÊï∞ÔºåÈÇ£‰πàdomainÈªòËÆ§‰∏∫ÂΩìÂâçÂüüÂêç„ÄÇ 2.domainÂèÇÊï∞ÂèØ‰ª•ËÆæÁΩÆÁà∂ÂüüÂêç‰ª•ÂèäËá™Ë∫´Ôºå‰ΩÜ‰∏çËÉΩËÆæÁΩÆÂÖ∂ÂÆÉÂüüÂêçÔºåÂåÖÊã¨Â≠êÂüüÂêçÔºåÂê¶Âàôcookie‰∏çËµ∑‰ΩúÁî®„ÄÇ ÈÇ£‰πàcookieÁöÑ‰ΩúÁî®ÂüüÔºö cookieÁöÑ‰ΩúÁî®ÂüüÊòØdomainÊú¨Ë∫´‰ª•Âèädomain‰∏ãÁöÑÊâÄÊúâÂ≠êÂüüÂêç„ÄÇ ËÆæÁΩÆCOOKIEÈ°∂Á∫ßÂüüÂêçÈ°∂Á∫ßÂüüÂêçÂè™ËÉΩËÆæÁΩÆdomain‰∏∫È°∂Á∫ßÂüüÂêçÔºå‰∏çËÉΩËÆæÁΩÆ‰∏∫‰∫åÁ∫ßÂüüÂêçÊàñËÄÖ‰∏âÁ∫ßÂüüÂêçÁ≠âÁ≠âÔºåÂê¶ÂàôcookieÊó†Ê≥ïÁîüÊàê„ÄÇ Â¶Çyangbai.comËÉΩËÆæÁΩÆdomain‰∏∫yangbai.comÊàñËÄÖwww.yangbai.comÔºå‰ΩÜ‰∏çËÉΩËÆæÁΩÆdomain‰∏∫login.yangbai.comÔºåËøôÊ†∑cookie‰∏ç‰ºöÁîüÊàê„ÄÇ ‰ª•‰∏ãÈù¢ÁöÑ‰ª£Á†Å‰∏∫‰æãÔºö 1234setcookie("name1", "yangbai", time() + 1000);//yangbai.comËá™Â∑±ÂèØ‰ª•ÁúãÂà∞setcookie("name2", "yangbai", time() + 1000, "/", "www.yangbai.com");//*.www.yangbai.comÈÉΩÂèØ‰ª•ÁúãÂà∞setcookie("name3", "yangbai", time() + 1000, "/", "yangbai.com");//*.yangbai.comÈÉΩÂèØ‰ª•ÁúãÂà∞setcookie("name4", "yangbai", time() + 1000, "/", "login.youzan.com");//ËÆæÁΩÆÊó†Êïà ËÆæÁΩÆdomainÁöÑÊó∂ÂÄôÔºå.yangbai.comÂíåyangbai.comÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇÊú™ÊåáÂÆödomainÊó∂ÔºåÈªòËÆ§ÁöÑdomain‰∏∫Áî®Âì™‰∏™ÂüüÂêçËÆøÈóÆÂ∞±ÊòØÂì™‰∏™„ÄÇ ÊâßË°åÂêéÔºåwww.yangbai.comÂú®ÊµèËßàÂô®ÁöÑcookieÊÉÖÂÜµÂ¶Ç‰∏ãÂõæÔºö ‰∫åÁ∫ßÂüüÂêçlogin.yangbai.comÂíågame.yangbai.comÊµèËßàÂô®ÁöÑcookieÊÉÖÂÜµÂ¶Ç‰∏ãÂõæÔºö ÊÄªÁöÑÊù•ËØ¥ÔºåÈ°∂Á∫ßÂüüÂêçËÆæÁΩÆÁöÑcookieÂèØ‰ª•ÂÖ±‰∫´„ÄêÈúÄË¶ÅÊåáÂÆödomain‰∏ªÂüüÂêçÁöÑhost„ÄëÁªô‰∫åÁ∫ßÂüüÂêçÔºå‰πüÂèØ‰ª•Ëá™Â∑±ÁßÅÊúâ„Äê‰∏çÊåáÂÆödomain„Äë„ÄÇ ‰∫åÁ∫ßÂüüÂêçÊãøgame.yangbai.com‰∏∫‰æãÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123setcookie("game", "yangbai");//Âè™ÊúâËá™Â∑±ÂèØ‰ª•ÁúãÂà∞setcookie("game1", "yangbai", time() + 1000, "/", "yangbai.com");//*.yangbai.comÈÉΩÂèØ‰ª•ÁúãÂà∞setcookie("game2", "yangbai", time() + 1000, "/", "chip.game.yangbai.com");//ËÆæÁΩÆÊó†Êïà ÊâßË°åÂêéÔºågame.yangbai.comÂú®ÊµèËßàÂô®ÁöÑcookieÊÉÖÂÜµÂ¶Ç‰∏ãÂõæÔºö ÊÄªÁöÑÊù•ËØ¥ÔºåËÆæÁΩÆcookieÁöÑËØùÂè™ËÉΩÂú®Êú¨ÂüüÂêç‰∏ãÊàñËÄÖdomainÁ∫ßÂà´È´ò‰∫éËá™Ë∫´ÁöÑÂüüÂêç‰∏ãÊâç‰ºöÁîüÊïàÔºÅ ËØªÂèñCOOKIEÊúâ‰∫Ü‰∏äÈù¢ÁöÑ‰æãÂ≠êÂíåÂÆûË∑µÔºåÂ§ßÊ¶ÇÁöÑËßÑÂàôÂ¶Ç‰∏ãÔºö ‰∫åÁ∫ßÂüüÂêçËÉΩËØªÂèñËÆæÁΩÆ‰∫Üdomain‰∏∫È°∂Á∫ßÂüüÂêçÊàñËÄÖËá™Ë∫´ÁöÑcookieÔºå‰∏çËÉΩËØªÂèñÂÖ∂‰ªñ‰∫åÁ∫ßÂüüÂêçdomainÁöÑcookie„ÄÇ‰æãÂ¶ÇÔºöË¶ÅÊÉ≥cookieÂú®Â§ö‰∏™‰∫åÁ∫ßÂüüÂêç‰∏≠ÂÖ±‰∫´ÔºåÈúÄË¶ÅËÆæÁΩÆdomain‰∏∫È°∂Á∫ßÂüüÂêçÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Âú®ÊâÄÊúâ‰∫åÁ∫ßÂüüÂêçÈáåÈù¢ÊàñËÄÖÂà∞Ëøô‰∏™cookieÁöÑÂÄº‰∫Ü„ÄÇ È°∂Á∫ßÂüüÂêçÂè™ËÉΩËé∑ÂèñÂà∞domainËÆæÁΩÆ‰∏∫È°∂Á∫ßÂüüÂêçÁöÑcookieÔºådomainËÆæÁΩÆ‰∏∫ÂÖ∂‰ªñÂ≠êÁ∫ßÂüüÂêçÁöÑÊó†Ê≥ïËé∑Âèñ„ÄÇ ‰øÆÊîπCOOKIEÈ°∂Á∫ßÂüüÂêçÈ°∂Á∫ßÂüüÂêçÁöÑcookieÂú®È°∂Á∫ßÂüüÂêçÊàñËÄÖÈùûÈ°∂Á∫ßÂüüÂêç„ÄêÈúÄË¶ÅËÆæÁΩÆdomain‰∏∫È°∂Á∫ßÂüüÂêçÊâçÂèØ‰ª•„ÄëÈÉΩÂèØ‰ª•‰øÆÊîπ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345#‰∏∫ÊâÄÊúâ‰∫åÁ∫ßÂüüÂêçËÆæÁΩÆ‰∏Ä‰∏™cookiesetcookie("name", "yangbai", time() + 1000, "/", "yangbai.com");#Âú®game.yangbai.com‰∏ãÈù¢‰øÆÊîπËøô‰∏™cookieÂÄºsetcookie("name", "yangbai11", time() + 1000, "/", "yangbai.com"); ‰∫åÁ∫ßÂüüÂêç‰øÆÊîπ‰∫åÁ∫ßÂüüÂêçËá™Ë∫´ÁîüÊàêÁöÑcookie‰∏çÈúÄË¶ÅËÆæÁΩÆdomainÔºåÁõ¥Êé•ËÆæÁΩÆÂç≥ÂèØ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12#‰øÆÊîπgame.yangbai.com‰∏ãÈù¢Ëá™Ë∫´ÁöÑcookieÂÄºsetcookie("game", "chip", time() + 10000); Âà†Èô§COOKIEÂà†Èô§cookieÁêÜËß£‰∏∫ÊòØ‰øÆÊîπcookieÁöÑ‰∏ÄÁßçÁâπÊÆäÂú∫ÊôØÔºåÂè™ÈúÄÂ∞ÜexpireËÆæÁΩÆ‰∏∫ËøáÊúü„ÄÅÂÄºËÆæÁΩÆ‰∏∫nullÂç≥ÂèØÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345#Âà†Èô§yangbai.com‰∏ãÈù¢ÁöÑcookieÂÄºsetcookie("name", null, time() - 1000, "/", "yangbai.com");#Âà†Èô§game.yangbai.com‰∏ãÈù¢Ëá™Ë∫´ÁöÑcookieÂÄºsetcookie("game", null, time() - 1000);]]></content>
      <categories>
        <category>ÂâçÁ´Ø</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Mysql for mac ÂÆâË£ÖÂèäÁéØÂ¢ÉÈÖçÁΩÆ]]></title>
    <url>%2F2018%2F07%2F07%2FMysql-for-mac-%E5%AE%89%E8%A3%85%E5%8F%8A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[‰∏Ä.‰∏ãËΩΩÂèäÂÆâË£ÖÈ¶ñÂÖàÂéªÂÆòÁΩë‰∏ãËΩΩmacÂØπÂ∫îÁâàÊú¨ÁöÑMysql,Â∞æÁºÄ‰∏∫.dmgÁöÑÁ®ãÂ∫èÂåÖ ‰∏ãËΩΩÂú∞ÂùÄÔºöhttps://dev.mysql.com/downloads/mysql/ ‰∏ãËΩΩÂÆåÊØïÂêéÔºå‰∏ÄÊ≠•Ê≠•ÂÇªÁìúÂºèÂÆâË£ÖÂç≥ÂèØÔºåÂÆâË£ÖÂÆåÂêémysql‰ºöÂºπÂá∫‰∏Ä‰∏™Ê°ÜÊ°ÜÔºåÂëäËØâ‰Ω†ÂÆâË£ÖÊàêÂäü‰ª•ÂèärootÁî®Êà∑ÁöÑÂàùÂßãÂØÜÁ†ÅÔºåÊ≥®ÊÑèMysql for Mac ÁöÑÂàùÂßãÂØÜÁ†ÅÊòØÈöèÊú∫ÁîüÊàêÁöÑÔºåÊúÄÂ•ΩËÆ∞‰Ωè ‰∫å.Êõ¥ÊîπÂàùÂßãÂØÜÁ†ÅA.ÊâìÂºÄÁªàÁ´Ø 1.ËøõÂÖ•mysqlÁöÑbinÁõÆÂΩï‰∏ãÔºàÈªòËÆ§ÂÆâË£ÖÁöÑÁõÆÂΩï‰∏∫ /usr/local/mysql/binÔºâ cd /usr/local/mysql/bin/ 2.ËæìÂÖ•Êåá‰ª§Ôºå‰ºöÊèêÁ§∫ËæìÂÖ•ÂØÜÁ†ÅÔºàËæìÂÖ•macË¥¶Êà∑ÁöÑrootÂØÜÁ†ÅÔºâ sudo ./mysqld_safe ‚Äìskip-grant-tables 3.ËæìÂÖ•ÂØÜÁ†ÅÂêéÔºå‰ºöÂèëÁé∞Êúâ‰∏Ä‰∫õÊèêÁ§∫Ôºå‰∏îMysql‰ºöËá™Âä®ÈáçÂêØ B.Âè¶ÂºÄ‰∏Ä‰∏™ÁªàÁ´Ø 1„ÄÅËæìÂÖ•Êåá‰ª§1ÔºöÔºàËøõÂÖ•Âà∞mysqlÁöÑbinÁõÆÂΩï‰∏ãÔºâËæìÂÖ•Ôºöcd /usr/local/mysql/bin/2„ÄÅËæìÂÖ•Êåá‰ª§2ÔºöËæìÂÖ•Ôºö./mysql3„ÄÅËøõÂÖ•Âà∞mysqlÂëΩ‰ª§Áä∂ÊÄÅ‰∏ãÔºöÔºàmysql&gt;ÊòØmysqlÂëΩ‰ª§Áä∂ÊÄÅÊèêÁ§∫ÔºâËæìÂÖ•Ôºömysql&gt; FLUSH PRIVILEGES;4„ÄÅËÆæÁΩÆÂØÜÁ†ÅrootËæìÂÖ•Ôºömysql&gt; SET PASSWORD FOR &#39;root&#39;@&#39;localhost&#39; = PASSWORD(&#39;root&#39;); Ëá≥Ê≠§ÔºåÂàùÂßãÂØÜÁ†ÅËÆæÁΩÆÂÆåÊØï ‰∏â.ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáèËã•‰∏çËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºåËæìÂÖ•ÂëΩ‰ª§Â§™ÁπÅÁêêÔºåÊØèÊ¨°ÁôªÈôÜMysqlÁöÑÂëΩ‰ª§‰∏∫Ôºö/usr/local/mysql/bin/ mysql -u root -p windowsÁ≥ªÁªüÁõ¥Êé•Âú®ÁéØÂ¢ÉÂèòÈáè‰∏≠Ê∑ªÂä†mysqlÁöÑË∑ØÂæÑÂ∞±Â•ΩÔºåmacÁ≥ªÁªüÂàôÈúÄË¶ÅÂú®homeÁõÆÂΩï‰∏ãÁöÑ.bash_profileÊñá‰ª∂‰∏≠Êñ∞Âª∫pathË∑ØÂæÑÊåáÂêëmysqlÁöÑË∑ØÂæÑ Êü•ÁúãhomeÁõÆÂΩïÔºö ËæìÂÖ•ÂëΩ‰ª§ echo $HOME macÈªòËÆ§ÁöÑhomeÁõÆÂΩï‰∏∫ÂΩìÂâçÁî®Êà∑Ê†πÁõÆÂΩï /Users/silverlaw ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáèÔºö 1.ÊâìÂºÄÁªàÁ´Ø,ËæìÂÖ•Ôºö open .bash_profile 2.Áõ¥Êé•ËæìÂÖ•Â¶Ç‰∏ãËØ≠Âè•Ôºö export PATH=${PATH}:/usr/local/mysql/bin ‰øùÂ≠òÔºåÂÖ≥Èó≠ÁªàÁ´ØÂíåTextEdit ÈáçÊñ∞ÊâìÂºÄÁªàÁ´ØÔºåËæìÂÖ•Ôºömysql -u root -pÔºåÂç≥ÂèØÊàêÂäüÁôªÈôÜ]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[linuxÊääÊñá‰ª∂ÂéãÁº©Êàê.tar.gzÁöÑÂëΩ‰ª§]]></title>
    <url>%2F2018%2F07%2F05%2Flinux%E6%8A%8A%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9%E6%88%90-tar-gz%E7%9A%84%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585901-.tarÊ†ºÂºèËß£ÂåÖÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar xvf FileName.tarÊâìÂåÖÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar cvf FileName.tar DirNameÔºàÊ≥®ÔºötarÊòØÊâìÂåÖÔºå‰∏çÊòØÂéãÁº©ÔºÅÔºâ02-.gzÊ†ºÂºèËß£Âéã1Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ gunzip FileName.gzËß£Âéã2Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ gzip -d FileName.gzÂéã Áº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ gzip FileName03-.tar.gzÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar zxvf FileName.tar.gzÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar zcvf FileName.tar.gz DirNameÊü•ÁúãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar ztvf FileName.tar.gz04-.bz2Ê†ºÂºèËß£Âéã1Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ bzip2 -d FileName.bz2Ëß£Âéã2Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ bunzip2 FileName.bz2Âéã Áº©Ôºö [ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ bzip2 -z FileName05-.tar.bz2Ê†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar jxvf FileName.tar.bz2ÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar jcvf FileName.tar.bz2 DirName06-.bzÊ†ºÂºèËß£Âéã1Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ bzip2 -d FileName.bzËß£Âéã2Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ bunzip2 FileName.bz07-.tar.bzÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar jxvf FileName.tar.bz08-.ZÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ uncompress FileName.ZÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ compress FileName09-.tar.ZÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar Zxvf FileName.tar.ZÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar Zcvf FileName.tar.Z DirName10-.tgzÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar zxvf FileName.tgz11-.tar.tgzÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar zxvf FileName.tar.tgzÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ tar zcvf FileName.tar.tgz FileName12-.zipÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ unzip FileName.zipÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ zip FileName.zip DirName13-.lhaÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ lha -e FileName.lhaÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ lha -a FileName.lha FileName14-.rarÊ†ºÂºèËß£ÂéãÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ rar a FileName.rarÂéãÁº©Ôºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ rar e FileName.rarrarËØ∑Âà∞Ôºö‰∏ãËΩΩÔºÅËß£ÂéãÂêéËØ∑Â∞Ürar_staticÊã∑Ë¥ùÂà∞/usr/binÁõÆÂΩïÔºàÂÖ∂‰ªñÁî±$PATHÁéØÂ¢ÉÂèòÈáèÊåáÂÆöÁöÑÁõÆÂΩï‰πüË°åÔºâÔºö[ÔºäÔºäÔºäÔºäÔºäÔºäÔºä]$ cp rar_static /usr/bin/rar]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[NginxÂ∏∏Áî®ÈÖçÁΩÆÂèäÂèçÂêë‰ª£ÁêÜËß£ÂÜ≥Ë∑®ÂüüÈóÆÈ¢ò]]></title>
    <url>%2F2018%2F06%2F28%2FNginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[1.ÂÆö‰πâË∑®ÂüüÊòØÊåáaÈ°µÈù¢ÊÉ≥Ëé∑ÂèñbÈ°µÈù¢ËµÑÊ∫êÔºåÂ¶ÇÊûúa„ÄÅbÈ°µÈù¢ÁöÑÂçèËÆÆ„ÄÅÂüüÂêç„ÄÅÁ´ØÂè£„ÄÅÂ≠êÂüüÂêç‰∏çÂêåÔºåÊâÄËøõË°åÁöÑËÆøÈóÆË°åÂä®ÈÉΩÊòØË∑®ÂüüÁöÑÔºåËÄåÊµèËßàÂô®‰∏∫‰∫ÜÂÆâÂÖ®ÈóÆÈ¢ò‰∏ÄËà¨ÈÉΩÈôêÂà∂‰∫ÜË∑®ÂüüËÆøÈóÆÔºå‰πüÂ∞±ÊòØ‰∏çÂÖÅËÆ∏Ë∑®ÂüüËØ∑Ê±ÇËµÑÊ∫ê„ÄÇÂøÖÈ°ªÊòØÂçèËÆÆ„ÄÅÂüüÂêç„ÄÅÁ´ØÂè£ÂÖ®ÈÉ®‰∏ÄËá¥„ÄÇÊ≥®ÊÑèÔºöË∑®ÂüüÈôêÂà∂ËÆøÈóÆÔºåÂÖ∂ÂÆûÊòØÊµèËßàÂô®ÁöÑÈôêÂà∂„ÄÇÁêÜËß£Ëøô‰∏ÄÁÇπÂæàÈáçË¶ÅÔºÅÔºÅÔºÅ 2.Ë∑®ÂüüËÆøÈóÆÁ§∫‰æãÂÅáËÆæÊúâ‰∏§‰∏™ÁΩëÁ´ôÔºåAÁΩëÁ´ôÈÉ®ÁΩ≤Âú®Ôºöhttp://localhost:81 Âç≥Êú¨Âú∞ipÁ´ØÂè£81‰∏äÔºõBÁΩëÁ´ôÈÉ®ÁΩ≤Âú®Ôºöhttp://localhost:82 Âç≥Êú¨Âú∞ipÁ´ØÂè£82‰∏ä„ÄÇ Áé∞Âú®AÁΩëÁ´ôÁöÑÈ°µÈù¢ÊÉ≥ÂéªËÆøÈóÆBÁΩëÁ´ôÁöÑ‰ø°ÊÅØÔºåAÁΩëÁ´ôÈ°µÈù¢ÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºàËøôÈáå‰ΩøÁî®jqueryÁöÑÂºÇÊ≠•ËØ∑Ê±ÇÔºâÔºö 12345678&lt;h2&gt;Index&lt;/h2&gt;&lt;div id="show"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt; $(function () &#123; $.get("http://localhost:82/api/values", &#123;&#125;, function (result) &#123; $("#show").html(result); &#125;) &#125;) ÊµèËßàÂô®‰ºöÊèêÁ§∫Â¶Ç‰∏ãÈîôËØØ‰ø°ÊÅØÔºö Origin ... is therefore not allowed access 3.nginxÂèçÂêë‰ª£ÁêÜËß£ÂÜ≥Ë∑®ÂüüÈóÆÈ¢ò3.1nginxÈÖçÁΩÆÊâæÂà∞nginxÁöÑÈÖçÁΩÆÊñá‰ª∂‚Äúnginx.conf‚ÄùÔºå‰øÆÊîπ‰∏Ä‰∏ã‰ø°ÊÅØ 123456789101112131415161718server &#123; listen 80; #ÁõëÂê¨80Á´ØÂè£ÔºåÂèØ‰ª•ÊîπÊàêÂÖ∂‰ªñÁ´ØÂè£ server_name localhost; # ÂΩìÂâçÊúçÂä°ÁöÑÂüüÂêç #charset koi8-r; #access_log logs/host.access.log main; location / &#123; proxy_pass http://localhost:81; proxy_redirect default; &#125; location /apis &#123; #Ê∑ªÂä†ËÆøÈóÆÁõÆÂΩï‰∏∫/apisÁöÑ‰ª£ÁêÜÈÖçÁΩÆ rewrite ^/apis/(.*)$ /$1 break; proxy_pass http://localhost:82; &#125;#‰ª•‰∏ãÈÖçÁΩÆÁúÅÁï• ÈÖçÁΩÆËß£ÈáäÔºö Áî±ÈÖçÁΩÆ‰ø°ÊÅØÂèØÁü•ÔºåÊàë‰ª¨ËÆ©nginxÁõëÂê¨localhostÁöÑ80Á´ØÂè£ÔºåÁΩëÁ´ôA‰∏éÁΩëÁ´ôBÁöÑËÆøÈóÆÈÉΩÊòØÁªèËøálocalhostÁöÑ80Á´ØÂè£ËøõË°åËÆøÈóÆ„ÄÇ Êàë‰ª¨ÁâπÊÆäÈÖçÁΩÆ‰∫Ü‰∏Ä‰∏™‚Äú/apis‚ÄùÁõÆÂΩïÁöÑËÆøÈóÆÔºåÂπ∂‰∏îÂØπurlÊâßË°å‰∫ÜÈáçÂÜôÔºåÊúÄÂêé‰Ωø‰ª•‚Äú/apis‚ÄùÂºÄÂ§¥ÁöÑÂú∞ÂùÄÈÉΩËΩ¨Âà∞‚Äúhttp://localhost:82‚ÄùËøõË°åÂ§ÑÁêÜ„ÄÇ rewrite ^/apis/(.*)$ /$1 break; ‰ª£Ë°®ÈáçÂÜôÊã¶Êà™ËøõÊù•ÁöÑËØ∑Ê±ÇÔºåÂπ∂‰∏îÂè™ËÉΩÂØπÂüüÂêçÂêéËæπ‰ª•‚Äú/apis‚ÄùÂºÄÂ§¥ÁöÑËµ∑‰ΩúÁî®Ôºå‰æãÂ¶Çwww.a.com/apis/msg?x=1ÈáçÂÜô„ÄÇÂè™ÂØπ/apisÈáçÂÜô„ÄÇ ËØ∑Ê±Ç/msg?x=1ËΩ¨ÂèëÂà∞localhost:82 rewriteÂêéÈù¢ÁöÑÂèÇÊï∞ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊ≠£Âàô ^/apis/(.*)$ ,$1‰ª£Ë°®Ê≠£Âàô‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™(),$2‰ª£Ë°®Á¨¨‰∫å‰∏™()ÁöÑÂÄº,‰ª•Ê≠§Á±ªÊé®„ÄÇ break‰ª£Ë°®ÂåπÈÖç‰∏Ä‰∏™‰πãÂêéÂÅúÊ≠¢ÂåπÈÖç„ÄÇ 3.2 ËÆøÈóÆÂú∞ÂùÄ‰øÆÊîπÊó¢ÁÑ∂ÈÖçÁΩÆ‰∫ÜnginxÔºåÈÇ£‰πàÊâÄÊúâÁöÑËÆøÈóÆÈÉΩË¶ÅËµ∞nginxÔºåËÄå‰∏çÊòØËµ∞ÁΩëÁ´ôÂéüÊú¨ÁöÑÂú∞ÂùÄÔºàAÁΩëÁ´ôlocalhost:81,BÁΩëÁ´ôlocalhost:82Ôºâ„ÄÇÊâÄ‰ª•Ë¶Å‰øÆÊîπAÁΩëÁ´ô‰∏≠ÁöÑajaxËÆøÈóÆÂú∞ÂùÄÔºåÊääËÆøÈóÆÂú∞ÂùÄÁî± ‚Äúhttp://localhost:82/api/values‚ÄùÊîπÊàê„Äã„Äã„Äã‚Äú/apis/api/values‚Äù„ÄÇÂ¶Ç‰∏ã‰ª£Á†ÅÔºö api/valuesËΩ¨ÂèëÂà∞localhost:82 12345678910&lt;h2&gt;Index&lt;/h2&gt;&lt;div id="show"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt; $(function () &#123; $.get("/apis/api/values", &#123;&#125;, function (result) &#123; $("#show").html(result); &#125;) &#125;)&lt;/script&gt; Á§∫‰æãÊ°à‰æãÂâçÁ´ØÊîæÂú®tomcat-test/webapps/testÁõÆÂΩï hello.htmlÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8"&gt;&lt;title&gt;ËèúÈ∏üÊïôÁ®ã(runoob.com)&lt;/title&gt;&lt;script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"&gt;&lt;/script&gt;&lt;script&gt;$(document).ready(function()&#123; $("button").click(function()&#123; $.get("/apis/api/hello",function(data,status)&#123; alert("Êï∞ÊçÆ: " + data + "\nÁä∂ÊÄÅ: " + status); &#125;); &#125;);&#125;);&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;ÂèëÈÄÅ‰∏Ä‰∏™ HTTP GET ËØ∑Ê±ÇÂπ∂Ëé∑ÂèñËøîÂõûÁªìÊûú&lt;/button&gt;&lt;/body&gt;&lt;/html&gt; ÂêØÂä®./tomcat-test/bin/startup.sh ÔºåÁ´ØÂè£Âú®8080 ÂêéÁ´ØÂêØÂä®Âú®8011Á´ØÂè£ÔºåËÆøÈóÆË∑ØÂæÑlocalhost:8011/api/hello 12345678910@RestController@RequestMapping("/api")public class HelloController &#123; @RequestMapping(value = "/hello", method = RequestMethod.GET) public String test() &#123; return "hello,world"; &#125;&#125; nginx.confÈÖçÁΩÆ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#user nobody;worker_processes 1;#error_log logs/error.log;#error_log logs/error.log notice;#error_log logs/error.log info;#pid logs/nginx.pid;events &#123; worker_connections 1024;&#125;http &#123; include mime.types; default_type application/octet-stream; #log_format main '$remote_addr - $remote_user [$time_local] "$request" ' # '$status $body_bytes_sent "$http_referer" ' # '"$http_user_agent" "$http_x_forwarded_for"'; #access_log logs/access.log main; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; server &#123; listen 6080; server_name localhost; #ÂêéÁ´ØÊé•Âè£ËΩ¨ÂèëÔºåËß£ÂÜ≥Ë∑®Âüü location /apis &#123; rewrite ^/apis/(.*)$ /$1 break; proxy_pass http://127.0.0.1:8011; &#125; location /html &#123; rewrite ^/html/(.*)$ /$1 break; proxy_pass http://127.0.0.1:8080; &#125; &#125; include servers/*;&#125; ËÆøÈóÆhttp://localhost:6080/html/test/hello.html NginxÂåπÈÖçËßÑÂàô https://moonbingbing.gitbooks.io/openresty-best-practices/ngx/nginx_local_pcre.html Â∏∏Áî®location ^~ /uriÂâçÁºÄÂåπÈÖç location /ÈÄöÁî®ÂåπÈÖçÔºå‰ªª‰ΩïÊú™ÂåπÈÖçÂà∞ÂÖ∂ÂÆÉlocationÁöÑËØ∑Ê±ÇÈÉΩ‰ºöÂåπÈÖçÂà∞ÔºåÁõ∏ÂΩì‰∫éswitch‰∏≠ÁöÑdefault ËØ≠Ê≥ïËßÑÂàô location [=|~|~*|^~] /uri/ { ‚Ä¶ } Ê®°Âºè Âê´‰πâ location = /uri = Ë°®Á§∫Á≤æÁ°ÆÂåπÈÖçÔºåÂè™ÊúâÂÆåÂÖ®ÂåπÈÖç‰∏äÊâçËÉΩÁîüÊïà location ^~ /uri ^~ ÂºÄÂ§¥ÂØπURLË∑ØÂæÑËøõË°åÂâçÁºÄÂåπÈÖçÔºåÂπ∂‰∏îÂú®Ê≠£Âàô‰πãÂâç„ÄÇ location ~ pattern ÂºÄÂ§¥Ë°®Á§∫Âå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑÊ≠£ÂàôÂåπÈÖç location ~* pattern ÂºÄÂ§¥Ë°®Á§∫‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑÊ≠£ÂàôÂåπÈÖç location /uri ‰∏çÂ∏¶‰ªª‰Ωï‰øÆÈ•∞Á¨¶Ôºå‰πüË°®Á§∫ÂâçÁºÄÂåπÈÖçÔºå‰ΩÜÊòØÂú®Ê≠£ÂàôÂåπÈÖç‰πãÂêé location / ÈÄöÁî®ÂåπÈÖçÔºå‰ªª‰ΩïÊú™ÂåπÈÖçÂà∞ÂÖ∂ÂÆÉlocationÁöÑËØ∑Ê±ÇÈÉΩ‰ºöÂåπÈÖçÂà∞ÔºåÁõ∏ÂΩì‰∫éswitch‰∏≠ÁöÑdefault ÂâçÁºÄÂåπÈÖçÊó∂ÔºåNginx ‰∏çÂØπ url ÂÅöÁºñÁ†ÅÔºåÂõ†Ê≠§ËØ∑Ê±Ç‰∏∫ /static/20%/aaÔºåÂèØ‰ª•Ë¢´ËßÑÂàô ^~ /static/ /aa ÂåπÈÖçÂà∞ÔºàÊ≥®ÊÑèÊòØÁ©∫Ê†ºÔºâ Â§ö‰∏™ location ÈÖçÁΩÆÁöÑÊÉÖÂÜµ‰∏ãÂåπÈÖçÈ°∫Â∫è‰∏∫ÔºàÂèÇËÄÉËµÑÊñôËÄåÊù•ÔºåËøòÊú™ÂÆûÈôÖÈ™åËØÅÔºåËØïËØïÂ∞±Áü•ÈÅì‰∫ÜÔºå‰∏çÂøÖÊãòÊ≥•Ôºå‰ªÖ‰æõÂèÇËÄÉÔºâ: È¶ñÂÖàÁ≤æÁ°ÆÂåπÈÖç = ÂÖ∂Ê¨°ÂâçÁºÄÂåπÈÖç ^~ ÂÖ∂Ê¨°ÊòØÊåâÊñá‰ª∂‰∏≠È°∫Â∫èÁöÑÊ≠£ÂàôÂåπÈÖç ÁÑ∂ÂêéÂåπÈÖç‰∏çÂ∏¶‰ªª‰Ωï‰øÆÈ•∞ÁöÑÂâçÁºÄÂåπÈÖç„ÄÇ ÊúÄÂêéÊòØ‰∫§Áªô / ÈÄöÁî®ÂåπÈÖç ÂΩìÊúâÂåπÈÖçÊàêÂäüÊó∂ÂÄôÔºåÂÅúÊ≠¢ÂåπÈÖçÔºåÊåâÂΩìÂâçÂåπÈÖçËßÑÂàôÂ§ÑÁêÜËØ∑Ê±Ç Ê≥®ÊÑèÔºöÂâçÁºÄÂåπÈÖçÔºåÂ¶ÇÊûúÊúâÂåÖÂê´ÂÖ≥Á≥ªÊó∂ÔºåÊåâÊúÄÂ§ßÂåπÈÖçÂéüÂàôËøõË°åÂåπÈÖç„ÄÇÊØîÂ¶ÇÂú®ÂâçÁºÄÂåπÈÖçÔºölocation /dir01 ‰∏é location /dir01/dir02ÔºåÂ¶ÇÊúâËØ∑Ê±Ç http://localhost/dir01/dir02/file Â∞ÜÊúÄÁªàÂåπÈÖçÂà∞ location /dir01/dir02 ‰æãÂ≠êÔºåÊúâÂ¶Ç‰∏ãÂåπÈÖçËßÑÂàôÔºö 123456789101112131415161718192021222324location = / &#123; echo "ËßÑÂàôA";&#125;location = /login &#123; echo "ËßÑÂàôB";&#125;location ^~ /static/ &#123; echo "ËßÑÂàôC";&#125;location ^~ /static/files &#123; echo "ËßÑÂàôX";&#125;location ~ \.(gif|jpg|png|js|css)$ &#123; echo "ËßÑÂàôD";&#125;location ~* \.png$ &#123; echo "ËßÑÂàôE";&#125;location /img &#123; echo "ËßÑÂàôY";&#125;location / &#123; echo "ËßÑÂàôF";&#125; ÈÇ£‰πà‰∫ßÁîüÁöÑÊïàÊûúÂ¶Ç‰∏ãÔºö ËÆøÈóÆÊ†πÁõÆÂΩï /ÔºåÊØîÂ¶Ç http://localhost/ Â∞ÜÂåπÈÖç ËßÑÂàôA ËÆøÈóÆ http://localhost/login Â∞ÜÂåπÈÖç ËßÑÂàôBÔºåhttp://localhost/register ÂàôÂåπÈÖç ËßÑÂàôF ËÆøÈóÆ http://localhost/static/a.html Â∞ÜÂåπÈÖç ËßÑÂàôC ËÆøÈóÆ http://localhost/static/files/a.exe Â∞ÜÂåπÈÖç ËßÑÂàôXÔºåËôΩÁÑ∂ ËßÑÂàôC ‰πüËÉΩÂåπÈÖçÂà∞Ôºå‰ΩÜÂõ†‰∏∫ÊúÄÂ§ßÂåπÈÖçÂéüÂàôÔºåÊúÄÁªàÈÄâ‰∏≠‰∫Ü ËßÑÂàôX„ÄÇ‰Ω†ÂèØ‰ª•ÊµãËØï‰∏ãÔºåÂéªÊéâËßÑÂàô X ÔºåÂàôÂΩìÂâç URL ‰ºöÂåπÈÖç‰∏ä ËßÑÂàôC„ÄÇ ËÆøÈóÆ http://localhost/a.gif, http://localhost/b.jpg Â∞ÜÂåπÈÖç ËßÑÂàôD Âíå ËßÑÂàô E Ôºå‰ΩÜÊòØ ËßÑÂàô D È°∫Â∫è‰ºòÂÖàÔºåËßÑÂàô E ‰∏çËµ∑‰ΩúÁî®ÔºåËÄå http://localhost/static/c.png Âàô‰ºòÂÖàÂåπÈÖçÂà∞ ËßÑÂàô C ËÆøÈóÆ http://localhost/a.PNG ÂàôÂåπÈÖç ËßÑÂàô E ÔºåËÄå‰∏ç‰ºöÂåπÈÖç ËßÑÂàô D ÔºåÂõ†‰∏∫ ËßÑÂàô E ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇ ËÆøÈóÆ http://localhost/img/a.gif ‰ºöÂåπÈÖç‰∏ä ËßÑÂàôD,ËôΩÁÑ∂ ËßÑÂàôY ‰πüÂèØ‰ª•ÂåπÈÖç‰∏äÔºå‰ΩÜÊòØÂõ†‰∏∫Ê≠£ÂàôÂåπÈÖç‰ºòÂÖàÔºåËÄåÂøΩÁï•‰∫Ü ËßÑÂàôY„ÄÇ ËÆøÈóÆ http://localhost/img/a.tiff ‰ºöÂåπÈÖç‰∏ä ËßÑÂàôY„ÄÇ ËÆøÈóÆ http://localhost/category/id/1111 ÂàôÊúÄÁªàÂåπÈÖçÂà∞ËßÑÂàô F ÔºåÂõ†‰∏∫‰ª•‰∏äËßÑÂàôÈÉΩ‰∏çÂåπÈÖçÔºåËøô‰∏™Êó∂ÂÄôÂ∫îËØ•ÊòØ Nginx ËΩ¨ÂèëËØ∑Ê±ÇÁªôÂêéÁ´ØÂ∫îÁî®ÊúçÂä°Âô®ÔºåÊØîÂ¶Ç FastCGIÔºàphpÔºâÔºåtomcatÔºàjspÔºâÔºåNginx ‰Ωú‰∏∫ÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®Â≠òÂú®„ÄÇ ÊâÄ‰ª•ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÔºåÁ¨îËÄÖËßâÂæóËá≥Â∞ëÊúâ‰∏â‰∏™ÂåπÈÖçËßÑÂàôÂÆö‰πâÔºåÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122# Áõ¥Êé•ÂåπÈÖçÁΩëÁ´ôÊ†πÔºåÈÄöËøáÂüüÂêçËÆøÈóÆÁΩëÁ´ôÈ¶ñÈ°µÊØîËæÉÈ¢ëÁπÅÔºå‰ΩøÁî®Ëøô‰∏™‰ºöÂä†ÈÄüÂ§ÑÁêÜÔºåÂÆòÁΩëÂ¶ÇÊòØËØ¥„ÄÇ# ËøôÈáåÊòØÁõ¥Êé•ËΩ¨ÂèëÁªôÂêéÁ´ØÂ∫îÁî®ÊúçÂä°Âô®‰∫ÜÔºå‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÈ¶ñÈ°µ# Á¨¨‰∏Ä‰∏™ÂøÖÈÄâËßÑÂàôlocation = / &#123; proxy_pass http://tomcat:8080/index&#125;# Á¨¨‰∫å‰∏™ÂøÖÈÄâËßÑÂàôÊòØÂ§ÑÁêÜÈùôÊÄÅÊñá‰ª∂ËØ∑Ê±ÇÔºåËøôÊòØ nginx ‰Ωú‰∏∫ http ÊúçÂä°Âô®ÁöÑÂº∫È°π# Êúâ‰∏§ÁßçÈÖçÁΩÆÊ®°ÂºèÔºåÁõÆÂΩïÂåπÈÖçÊàñÂêéÁºÄÂåπÈÖçÔºå‰ªªÈÄâÂÖ∂‰∏ÄÊàñÊê≠ÈÖç‰ΩøÁî®location ^~ /static/ &#123; root /webroot/static/;&#125;location ~* \.(gif|jpg|jpeg|png|css|js|ico)$ &#123; root /webroot/res/;&#125;# Á¨¨‰∏â‰∏™ËßÑÂàôÂ∞±ÊòØÈÄöÁî®ËßÑÂàôÔºåÁî®Êù•ËΩ¨ÂèëÂä®ÊÄÅËØ∑Ê±ÇÂà∞ÂêéÁ´ØÂ∫îÁî®ÊúçÂä°Âô®# ÈùûÈùôÊÄÅÊñá‰ª∂ËØ∑Ê±ÇÂ∞±ÈªòËÆ§ÊòØÂä®ÊÄÅËØ∑Ê±ÇÔºåËá™Â∑±Ê†πÊçÆÂÆûÈôÖÊääÊè°# ÊØïÁ´üÁõÆÂâçÁöÑ‰∏Ä‰∫õÊ°ÜÊû∂ÁöÑÊµÅË°åÔºåÂ∏¶.php„ÄÅ.jspÂêéÁºÄÁöÑÊÉÖÂÜµÂæàÂ∞ë‰∫Ülocation / &#123; proxy_pass http://tomcat:8080/&#125; rewrite ËØ≠Ê≥ï last ‚Äì Âü∫Êú¨‰∏äÈÉΩÁî®Ëøô‰∏™ Flag break ‚Äì ‰∏≠Ê≠¢ RewirteÔºå‰∏çÂÜçÁªßÁª≠ÂåπÈÖç redirect ‚Äì ËøîÂõû‰∏¥Êó∂ÈáçÂÆöÂêëÁöÑ HTTP Áä∂ÊÄÅ 302 permanent ‚Äì ËøîÂõûÊ∞∏‰πÖÈáçÂÆöÂêëÁöÑ HTTP Áä∂ÊÄÅ 301 1„ÄÅ‰∏ãÈù¢ÊòØÂèØ‰ª•Áî®Êù•Âà§Êñ≠ÁöÑË°®ËææÂºèÔºö 1234-f Âíå !-f Áî®Êù•Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Êñá‰ª∂-d Âíå !-d Áî®Êù•Âà§Êñ≠ÊòØÂê¶Â≠òÂú®ÁõÆÂΩï-e Âíå !-e Áî®Êù•Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Êñá‰ª∂ÊàñÁõÆÂΩï-x Âíå !-x Áî®Êù•Âà§Êñ≠Êñá‰ª∂ÊòØÂê¶ÂèØÊâßË°å 2„ÄÅ‰∏ãÈù¢ÊòØÂèØ‰ª•Áî®‰ΩúÂà§Êñ≠ÁöÑÂÖ®Â±ÄÂèòÈáè 1234567‰æãÔºöhttp://localhost:88/test1/test2/test.php?k=v$hostÔºölocalhost$server_portÔºö88$request_uriÔºö/test1/test2/test.php?k=v$document_uriÔºö/test1/test2/test.php$document_rootÔºöD:\nginx/html$request_filenameÔºöD:\nginx/html/test1/test2/test.php redirect ËØ≠Ê≥ï123456789server &#123; listen 80; server_name start.igrow.cn; index index.html index.php; root html; if ($http_host !~ "^star\.igrow\.cn$") &#123; rewrite ^(.*) http://star.igrow.cn$1 redirect; &#125;&#125; Èò≤ÁõóÈìæ123456location ~* \.(gif|jpg|swf)$ &#123; valid_referers none blocked start.igrow.cn sta.igrow.cn; if ($invalid_referer) &#123; rewrite ^/ http://$host/logo.png; &#125;&#125; Ê†πÊçÆÊñá‰ª∂Á±ªÂûãËÆæÁΩÆËøáÊúüÊó∂Èó¥123456location ~* \.(js|css|jpg|jpeg|gif|png|swf)$ &#123; if (-f $request_filename) &#123; expires 1h; break; &#125;&#125; Á¶ÅÊ≠¢ËÆøÈóÆÊüê‰∏™ÁõÆÂΩï1234location ~* \.(txt|doc)$&#123; root /data/www/wwwroot/linuxtone/test; deny all;&#125; MacËÆøÈóÆ80Á´ØÂè£1 . ÂÖàÂØπpf.confËøõË°åÂ§á‰ªΩÔºö1sudo cp /etc/pf.conf /etc/pf.conf.normal.bak ‰πãÂêéÂú®ËØ•Êñá‰ª∂‰∏≠‰ª•‰∏ãË°åÔºö 1sudo vim /etc/pf.conf rdr-anchor &quot;com.apple/*&quot; ÂêéÈù¢Ê∑ªÂä†‰∏ÄË°åÈÖçÁΩÆÔºåËΩ¨ÂèëÂà∞5555,Â¶Ç‰∏ãÔºö 1rdr on lo0 inet proto tcp from any to 127.0.0.1 port 80 -&gt; 127.0.0.1 port 5555 2„ÄÅ‰æùÊ¨°ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºö123sudo pfctl -dsudo pfctl -f /etc/pf.confsudo pfctl -e Ê≥®ÊÑèÔºöÂ¶ÇÊûúÊúâapacheÁ≠âÊúçÂä°Âô®Âç†Áî®‰∫Ü80Á´ØÂè£ÔºåÂàôÈúÄË¶ÅÂ∞ÜÂÖ∂ÂÅúÊéâÊñπËÉΩÊàêÂäüÔºÅ Â¶ÇÊûúÂá∫Áé∞ 123No ALTQ support in kernelALTQ related functions disabledpfctl: pf not enabled ÂøΩÁï•Âç≥ÂèØ„ÄÇ Â∏∏Áî®ÂëΩ‰ª§##1„ÄÅÊü•ÁúãnginxËøõÁ®ã 1ps -ef|grep nginx ËØ¥ÊòéÔºönginxÁöÑËøõÁ®ãÁî±‰∏ªËøõÁ®ãÂíåÂ∑•‰ΩúËøõÁ®ãÁªÑÊàê„ÄÇ ##2„ÄÅÂêØÂä®nginx 1234nginxnginx -c ~/Dropbox/commonConfig/nginx/nginx.confnginx -t -c ~/Dropbox/commonConfig/nginx/nginx.conf ÂêØÂä®ÁªìÊûúÊòæÁ§∫nginxÁöÑ‰∏ªÁ∫øÁ®ãÂíåÂ∑•‰ΩúÁ∫øÁ®ãÔºåÂ∑•‰ΩúÁ∫øÁ®ãÁöÑÊï∞ÈáèË∑ünginx.conf‰∏≠ÁöÑÈÖçÁΩÆÂèÇÊï∞worker_processesÊúâÂÖ≥„ÄÇ ##3„ÄÅÂπ≥ÊªëÂêØÂä®nginx 12345kill -HUP `cat /var/run/nginx.pid`ÊàñËÄÖnginx -s reloadnginx -s reload -c ~/Dropbox/commonConfig/nginx/nginx.conf ÂÖ∂‰∏≠ËøõÁ®ãÊñá‰ª∂Ë∑ØÂæÑÂú®ÈÖçÁΩÆÊñá‰ª∂nginx.conf‰∏≠ÂèØ‰ª•ÊâæÂà∞„ÄÇ Âπ≥ÊªëÂêØÂä®ÁöÑÊÑèÊÄùÊòØÂú®‰∏çÂÅúÊ≠¢nginxÁöÑÊÉÖÂÜµ‰∏ãÔºåÈáçÂêØnginxÔºåÈáçÊñ∞Âä†ËΩΩÈÖçÁΩÆÊñá‰ª∂ÔºåÂêØÂä®Êñ∞ÁöÑÂ∑•‰ΩúÁ∫øÁ®ãÔºåÂÆåÁæéÂÅúÊ≠¢ÊóßÁöÑÂ∑•‰ΩúÁ∫øÁ®ã„ÄÇ ##4„ÄÅÂÆåÁæéÂÅúÊ≠¢nginx 1kill -QUIT `cat /var/run/nginx.pid` ##5„ÄÅÂø´ÈÄüÂÅúÊ≠¢nginx 123kill -TERM `cat /var/run/nginx.pid`ÊàñËÄÖkill -INT `cat /var/run/nginx.pid` ##6„ÄÅÂÆåÁæéÂÅúÊ≠¢Â∑•‰ΩúËøõÁ®ãÔºà‰∏ªË¶ÅÁî®‰∫éÂπ≥ÊªëÂçáÁ∫ßÔºâ 1kill -WINCH `cat /var/run/nginx.pid` ##7„ÄÅÂº∫Âà∂ÂÅúÊ≠¢nginx 1pkill -9 nginx ##8„ÄÅÊ£ÄÊü•ÂØπnginx.confÊñá‰ª∂ÁöÑ‰øÆÊîπÊòØÂê¶Ê≠£Á°Æ 123nginx -t -c /etc/nginx/nginx.conf ÊàñËÄÖ nginx -tnginx -t -c ~/Dropbox/commonConfig/nginx/nginx.conf ##9„ÄÅÂÅúÊ≠¢nginxÁöÑÂëΩ‰ª§ 1nginx -s stop ##10„ÄÅÊü•ÁúãnginxÁöÑÁâàÊú¨‰ø°ÊÅØ 1nginx -v ##11„ÄÅÊü•ÁúãÂÆåÊï¥ÁöÑnginxÁöÑÈÖçÁΩÆ‰ø°ÊÅØ 1nginx -V]]></content>
      <categories>
        <category>Nginx</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Homebrew nginxÂ∏∏Áî®ÂëΩ‰ª§]]></title>
    <url>%2F2018%2F06%2F28%2FHomebrew%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[123456789brew updatebrew search nginx //Êü•ËØ¢Ë¶ÅÂÆâË£ÖÁöÑËΩØ‰ª∂ÊòØÂê¶Â≠òÂú®brew info nginxbrew install nginxnginx ÂÆâË£ÖÂ∑•ÂÖ∑Ôºö homebrewÔºàËøòÊ≤°Áî®ËøáÁöÑÂ∞è‰ºô‰º¥ÂèØ‰ª•ÁÇπÈìæÊé•ËøõË°å‰∫ÜËß£ÊàñËÄÖËá™Ë°åÁôæÂ∫¶Ôºâ Ê≠•È™§Ôºö 1„ÄÅÊâìÂºÄÁªàÁ´ØÔºå‰π†ÊÉØÊÄßÂëΩ‰ª§Ôºö 12brew update//ÁªìÊûúÔºöAlready up-to-date. 2„ÄÅÁªàÁ´ØÁªßÁª≠ÊâßË°åÂëΩ‰ª§Ôºö 1brew search nginx //Êü•ËØ¢Ë¶ÅÂÆâË£ÖÁöÑËΩØ‰ª∂ÊòØÂê¶Â≠òÂú® 3„ÄÅËøôÈáåÊàë‰ª¨Â§öÊâßË°å‰∏ÄÊ≠•‚ÄúÂ∫ü‚ÄùÂëΩ‰ª§Ôºå‰∏çËøáÊúâÂà©‰∫éÊàë‰ª¨ÂêéÈù¢ÁöÑÈÖçÁΩÆÔºö 1brew info nginx ËøêË°åÁªìÊûúÔºö Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºånginxÂú®Êú¨Âú∞ËøòÊú™ÂÆâË£ÖÔºàNot installedÔºâÔºånginxÁöÑÊù•Ê∫êÔºàFromÔºâÔºåDocrootÈªòËÆ§‰∏∫/usr/local/var/wwwÔºåÂú®/usr/local/etc/nginx/nginx.confÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈªòËÆ§Á´ØÂè£Ë¢´ÈÖçÁΩÆ‰∏∫8080‰ªéËÄå‰ΩønginxËøêË°åÊó∂‰∏çÈúÄË¶ÅÂä†sudoÔºånginxÂ∞ÜÂú®/usr/local/etc/nginx/servers/ÁõÆÂΩï‰∏≠Âä†ËΩΩÊâÄÊúâÊñá‰ª∂Ôºå‰ª•ÂèäÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊúÄÁÆÄÂçïÁöÑÂëΩ‰ª§ ‚Äònginx‚Äô Êù•ÂêØÂä®nginx„ÄÇ 4„ÄÅÊ≠£ÂºèÂºÄÂßãÂÆâË£ÖÔºö 1brew install nginx 5„ÄÅÊü•ÁúãnginxÂÆâË£ÖÁõÆÂΩïÔºàÊòØÂê¶Â¶ÇinfoÊâÄËØ¥ÔºâÔºö 1open /usr/local/etc/nginx/ ÊàêÂäüÊâìÂºÄnginxÁõÆÂΩïÔºå‰πüÂèØ‰ª•ÁúãÂà∞Â¶ÇinfoÊâÄËØ¥serversÁõÆÂΩï‰ª•Âèänginx.confÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºàÂêéÈù¢‰ºöÁî®Âà∞Ëøô‰∏™ÈÖçÁΩÆÊñá‰ª∂Ôºâ„ÄÇ‰ΩÜÊàë‰ª¨Âπ∂Ê≤°ÊúâÊâæÂà∞nginxË¢´ÂÆâË£ÖÂà∞‰∫ÜÂì™Èáå„ÄÇ ÁªàÁ´ØÁªßÁª≠ÊâßË°åÔºö 1open /usr/local/Cellar/nginx //ÂÖ∂ÂÆûËøô‰∏™ÊâçÊòØnginxË¢´ÂÆâË£ÖÂà∞ÁöÑÁõÆÂΩï ‰ºöÁúãÂà∞‰∏Ä‰∏™‰ª•ÂΩìÂâçÂÆâË£ÖÁöÑnginxÁöÑÁâàÊú¨Âè∑‰∏∫ÂêçÁß∞ÁöÑÊñá‰ª∂Â§πÔºåËøô‰∏™Â∞±ÊòØÊàë‰ª¨ÂÆâË£ÖÁöÑnginxÊ†πÁõÆÂΩïÂï¶„ÄÇËøõÂÖ•1.12.2_1/bin ÁõÆÂΩïÔºå‰ºöÁúãÂà∞nginxÁöÑÂèØÊâßË°åÂêØÂä®Êñá‰ª∂„ÄÇ ÂêåÊ†∑ÁöÑÔºåÊàë‰ª¨Âú®1.12.2_1/ÁõÆÂΩï‰∏ãËøòÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™ÂêçÂ≠ó‰∏∫htmlÁöÑÂø´Êç∑ÊñπÂºèÊñá‰ª∂Â§πÔºàÊöÇ‰∏îÂ∞±Ëøô‰πàÂè´ÂêßÔºâÔºåËøõÂÖ•ËØ•ÁõÆÂΩïÊàë‰ª¨‰ºöÂèëÁé∞ÂÖ∂ÂÆûÂÆÉÊåáÂêëÁöÑÂ∞±ÊòØ/usr/local/var/wwwÁõÆÂΩïÔºåËøô‰∏™Âú®‰∏äÈù¢Êàë‰ª¨Êü•ÁúãÁöÑinfo‰ø°ÊÅØ‰∏≠ÊúâÊèêÂà∞ÔºàDcrootÔºâ 6„ÄÅÂêØÂä®nginxÔºåÁªàÁ´ØËæìÂÖ•Â¶Ç‰∏ãÂëΩ‰ª§Ôºö 1nginx Ê≤°ÊúâÊä•ÈîôÂç≥‰∏∫ÂêØÂä®ÊàêÂäü„ÄÇ 7„ÄÅËÆøÈóÆÈ™åËØÅÔºö ÊâìÂºÄÊµèËßàÂô®ËÆøÈóÆlocalhost:8080,ËøôÈáåË∑üÁΩë‰∏äÁöÑ‰∏Ä‰∫õÊïôÁ®ã‰ºöÊúâ‰∫õ‰∏ç‰∏ÄÊ†∑ÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÂà∞Ëøô‰∏ÄÊ≠•Â∞±‰ºöËÉΩÁúãÂà∞nginxÁöÑÊ¨¢ËøéÁïåÈù¢Âï¶ÔºåÁÑ∂ËÄåÂçö‰∏ªÂç¥ÈÅáÂà∞‰∫ÜÂùëÁàπÁöÑÊÉÖÂÜµÔºàÂ¶ÇÊûú‰Ω†ËÉΩÊ≠£Â∏∏ÁúãÂà∞nginxÊ¨¢ËøéÁïåÈù¢ÔºåÂèØ‰ª•Áõ¥Êé•Ë∑≥ËøáËøô‰∏ÄÊ≠•‰∫ÜÔºâ ÊÉ≥ÂøÖËøô‰∏™ÈîôËØØÂ§ßÂÆ∂ÈÉΩÂæàÁÜüÊÇâ‰∫ÜÔºåÊàëÂ∞±‰∏çÂÜçÂ§öÂÅöËß£ÈáäÔºåÊé•‰∏ãÊù•Áõ¥Êé•ËØ¥ÂéüÂõ†ÔºàËØ•ÂéüÂõ†‰ªÖ‰∏∫ÁåúÊµãÔºåÂõ†‰∏∫Êó†‰ªéÈ™åËØÅÔºâÔºöÂÆâË£ÖÁöÑnginx‰ºöÈªòËÆ§Âú®htmlÔºà‰πüÂ∞±ÊòØ/usr/local/var/wwwÔºâÁõÆÂΩï‰∏ãÁîüÊàê‰∏Ä‰∏™Ê¨¢ËøéÈ°µÈù¢Êñá‰ª∂ÔºåËÄåÂá∫Áé∞‰∏äÈù¢ËøôÁßçÊÉÖÂÜµÂ∞±ÊòØÊ¨¢ËøéÈ°µÈù¢Êñá‰ª∂Ê≤°ÊúâÁîüÊàêÔºàËá≥‰∫é‰∏∫‰ªÄ‰πàÊ≤°ÊúâÁîüÊàêÂ∞±‰∏çÂæóËÄåÁü•‰∫ÜÔºå‰∏ÄÂàáÈÉΩÊòØÁåúÊµãÔºâ„ÄÇ ÈÇ£Âú®Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò‰πãÂâçÔºåÊàë‰ª¨ÂÖàÊù•‰∫ÜËß£‰∏Ä‰∏ãnginxÁöÑÈÖçÁΩÆÊñá‰ª∂ÂêßÔºànginx.confÔºâ: 1cat /usr/local/etc/nginx/nginx.conf ÊòæÁ§∫ÈÖçÁΩÆÊñá‰ª∂ÁöÑ‰ª£Á†Å‰∏∫Ôºö ;) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#user nobody;worker_processes 1;#error_log logs/error.log;#error_log logs/error.log notice;#error_log logs/error.log info;#pid logs/nginx.pid;events &#123; worker_connections 1024;&#125;http &#123; include mime.types; default_type application/octet-stream; #log_format main '$remote_addr - $remote_user [$time_local] "$request" ' # '$status $body_bytes_sent "$http_referer" ' # '"$http_user_agent" "$http_x_forwarded_for"'; #access_log logs/access.log main; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; server &#123; #‰æ¶Âê¨8080Á´ØÂè£ listen 8080; #ÂÆö‰πâ‰ΩøÁî® localhostËÆøÈóÆ server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / &#123; #ÂÆö‰πâÊúçÂä°Âô®ÁöÑÈªòËÆ§ÁΩëÁ´ôÊ†πÁõÆÂΩï‰ΩçÁΩÆ root html; #ÂÆö‰πâÈ¶ñÈ°µÁ¥¢ÂºïÊñá‰ª∂ÁöÑÂêçÁß∞ index index.html index.htm; &#125; ... ... ... (Ê≥®Èáä‰ª£Á†ÅÂ§™Â§öÔºåÂ∞±‰∏çÂÖ®ÈÉ®Ë¥¥Âá∫Êù•‰∫Ü) include servers/*;&#125; ;) ÈÄöËøáÈÖçÁΩÆÊñá‰ª∂Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂÖ∂ÈªòËÆ§ÁöÑÁΩëÁ´ôÊ†πÁõÆÂΩï‰∏∫htmlÔºàÂç≥/usr/local/var/wwwÔºâÔºåËÄåÈªòËÆ§ÁöÑÁ¥¢ÂºïÊñá‰ª∂‰∏∫index.html Âíå index.htmÔºåËøô‰∏ãÂ∞±ÊâæÂà∞ÂéüÂõ†‰∫ÜÔºåÂéüÊù•Êàë‰ª¨ÁöÑÊ†πÁõÆÂΩïÂ∞ë‰∫ÜÈ¶ñÈ°µÁ¥¢ÂºïÊñá‰ª∂ÔºåÈÇ£Â∞±Êù•ÊâãÂä®ÂàõÂª∫‰∏Ä‰∏™ÂêßÔºö 123cd /usr/local/var/www/ //ËøõÂÖ•Âà∞wwwÁõÆÂΩï‰∏ãtouch index.html //ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑindex.htmlÊñá‰ª∂vim index.html //ÁºñËæëËØ•Êñá‰ª∂ Â∞ÜÂ¶Ç‰∏ã‰ª£Á†ÅÂÜôÂÖ•index.htmlÊñá‰ª∂‰∏≠Ôºö ;) 123456789101112&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;title&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt; &lt;h1&gt;ÊàëÁöÑnginxÊ¨¢ËøéÈ°µÈù¢&lt;/h1&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ;) ÊåâescÈîÆÔºåËæìÂÖ•:wqÊé®Âá∫ÁºñËæëÂπ∂‰øùÂ≠òÔºàËøô‰∏™Áõ∏‰ø°Â§ßÂÆ∂ÈÉΩ‰ºöÔºå‰ΩÜËøòÊòØÂº∫Ëø´ÁóáÁöÑÂÜô‰∏ä‰∫ÜÔºâ„ÄÇ ÂõûÂà∞ÊµèËßàÂô®Ôºàlocalhost:8080ÔºâÂà∑Êñ∞Ôºö OKÔºåÂ§ßÂäüÂëäÊàêÂï¶ÔºÅ]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DubboÊ∫êÁ†ÅÂàÜÊûê‰πãÊúçÂä°Ê∂àË¥πËøáÁ®ã]]></title>
    <url>%2F2018%2F06%2F28%2FDubbo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%BF%87%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[Ê∂àË¥πÁ´ØÂèëÈÄÅÊ∂àÊÅØÊµÅÁ®ã Ê∂àË¥πÁ´ØÁöÑË∞ÉÁî®ËøáÁ®ã invokerË∞ÉÁî®ÈìæÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637InvokerInvocationHandler.invoke()MockClusterInvoker.invoke()AbstractClusterInvoker.invoke() ÂæóÂà∞invokerList Âíå loadbalanceFailoverClusterInvoker.doInvoke() ÁÑ∂ÂêéselectÈÄâÂá∫ÁöÑInvoker‰∏∫: RegistryDirectory.InvokerDelegate(ProtocolFilterWrapper(ListenerInvoker(DubboInvoker)))Â§áÊ≥®Ôºöprivate static class InvokerDelegete&lt;T&gt; extends InvokerWrapperProtocolFilterWrapper Ë∞ÉÁî®buildInvokerChainË∞ÉÁî®ÊûÑÂª∫‰∏Ä‰∏™FilterÈìæÊù° , new Filter()ÁÑ∂ÂêéÊâßË°åFilter.invoker(Invoker invoker , Invocation invocation)ÊñπÊ≥ïMonitorFilterÂÖ∂‰ªñFilter====ÂÜçÊâßË°åÁúüÊ≠£ÁöÑDubboInvoker extends AbstractInvokerDubboInvoker&lt;T&gt; extends AbstractInvoker&lt;T&gt;AbstractInvoker.invoke()DubboInvoker.doInvoke() DefaultFuture.get() ËøîÂõû ResultReferenceCountExchangeClient.request() ËøîÂõû DefaultFutureHeaderExchangeClient.request() ËøîÂõû DefaultFutureHeaderExchangeChannel.request() ËøîÂõû DefaultFutureAbstractPeer.send()AbstractClient.send()NettyChannel.send()NioClientSocket.write() ÊúçÂä°Á´ØÊé•Êî∂Ê∂àÊÅØÂ§ÑÁêÜËøáÁ®ãNettyHandler. messageReceivedÊé•Êî∂Ê∂àÊÅØÁöÑÊó∂ÂÄôÔºåÈÄöËøáNettyHandler.messageReceived‰Ωú‰∏∫ÂÖ•Âè£„ÄÇ 123456789Overridepublic void messageReceived(ChannelHandlerContext ctx, MessageEvent e) throws Exception &#123; NettyChannel channel = NettyChannel.getOrAddChannel(ctx.getChannel(), url, handler); try &#123; handler.received(channel, e.getMessage()); &#125; finally &#123; NettyChannel.removeChannelIfDisconnected(ctx.getChannel()); &#125;&#125; Âú®ÊúçÂä°ÂèëÂ∏ÉÁöÑÊó∂ÂÄôÔºåÁªÑË£Ö‰∫Ü‰∏ÄÁ≥ªÂàóÁöÑhandler HeaderExchanger.bind 123public ExchangeServer bind(URL url, ExchangeHandler handler) throws RemotingException &#123; return new HeaderExchangeServer(Transporters.bind(url, new DecodeHandler(new HeaderExchangeHandler(handler))));&#125; Êé•ÁùÄÂèàÂú®Nettyserver‰∏≠Ôºåwrap‰∫ÜÂ§ö‰∏™handler 12345678public NettyServer(URL url, ChannelHandler handler) throws RemotingException &#123; super(url, ChannelHandlers.wrap(handler, ExecutorUtil.setThreadName(url, SERVER_THREAD_POOL_NAME)));&#125;protected ChannelHandler wrapInternal(ChannelHandler handler, URL url) &#123; return new MultiMessageHandler(new HeartbeatHandler(ExtensionLoader.getExtensionLoader(Dispatcher.class) .getAdaptiveExtension().dispatch(handler, url)));&#125; ÊâÄ‰ª•ÊúçÂä°Á´ØÁöÑhandlerÂ§ÑÁêÜÈìæ‰∏∫ MultiMessageHandler(HeartbeatHandler(AllChannelHandler(DecodeHandler))) MultiMessageHandler: Â§çÂêàÊ∂àÊÅØÂ§ÑÁêÜ HeartbeatHandlerÔºöÂøÉË∑≥Ê∂àÊÅØÂ§ÑÁêÜÔºåÊé•Êî∂ÂøÉË∑≥Âπ∂ÂèëÈÄÅÂøÉË∑≥ÂìçÂ∫î AllChannelHandlerÔºö‰∏öÂä°Á∫øÁ®ãËΩ¨ÂåñÂ§ÑÁêÜÂô®ÔºåÊääÊé•Êî∂Âà∞ÁöÑÊ∂àÊÅØÂ∞ÅË£ÖÊàêChannelEventRunnableÂèØÊâßË°å‰ªªÂä°ÁªôÁ∫øÁ®ãÊ±†Â§ÑÁêÜ DecodeHandler:‰∏öÂä°Ëß£Á†ÅÂ§ÑÁêÜÂô® Ë∞ÉÁî®ÈìæÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637MultiMessageHandler.received()HeartbeatHandler.received()AllChannelHandler.received ÊîæÂà∞Á∫øÁ®ãÊ±†executor.execute(ChannelEventRunnable) run() RECEIVEDDecodeHandler.received()HeaderExchangeHandler.received()DubboProtocol.reply()ProtocolFilterWrapperÈáåÈù¢buildInvokerChainÔºàÔºâ‰∏≠last = new Invoker&lt;T&gt;()ÁöÑinvoke()ÊñπÊ≥ïÂºÄÂßãnew Invoker().invoker(Invocation invocation) ÈáåÈù¢ÂÆûÁé∞ÊòØ filter.invoke(invoker , invocation)====EchoFilter.invoke()ClassLoaderFilter.invoke()GenericFilter.invoke()ContextFilter.invoke()TraceFilter.invoke()TimeoutFilter.invoke()MonitorFilter.invoke()ÂÜçÊâßË°åÁúüÊ≠£ÁöÑAbstractProxyInvokerAbstractProxyInvoker.invoke()AbstractProxyInvokerÁöÑdoInvokeÊñπÊ≥ïJavassistProxyFactory‰∏≠getInvokerÔºàÔºâÊñπÊ≥ï return new AbstractProxyInvoker&lt;T&gt;(proxy, type, url) &#123; @Override protected Object doInvoke(T proxy, String methodName, Class&lt;?&gt;[] parameterTypes, Object[] arguments) throws Throwable &#123; return wrapper.invokeMethod(proxy, methodName, parameterTypes, arguments); &#125; &#125;; ÊúçÂä°ÂèëÂ∏ÉÊó∂ RegistryProtol.exportÔºàInvoker invokerÔºâÊñπÊ≥ï‰∏≠ 123final Invoker&lt;?&gt; invokerDelegete = new InvokerDelegete&lt;T&gt;(originInvoker, getProviderUrl(originInvoker));Filter(Listener(InvokerDelegete(AbstractProxyInvoker (Wrapper.invokeMethod))) HeaderExchangeHandler.received‰∫§‰∫íÂ±ÇËØ∑Ê±ÇÂìçÂ∫îÂ§ÑÁêÜÔºåÊúâ‰∏âÁßçÂ§ÑÁêÜÊñπÂºè handlerRequestÔºåÂèåÂêëËØ∑Ê±Ç 2.handler.received ÂçïÂêëËØ∑Ê±Ç 3.handleResponse ÂìçÂ∫îÊ∂àÊÅØ 123456789101112131415161718192021222324252627282930313233343536public void received(Channel channel, Object message) throws RemotingException &#123; channel.setAttribute(KEY_READ_TIMESTAMP, System.currentTimeMillis()); ExchangeChannel exchangeChannel = HeaderExchangeChannel.getOrAddChannel(channel); try &#123; if (message instanceof Request) &#123; // handle request. Request request = (Request) message; if (request.isEvent()) &#123; handlerEvent(channel, request); &#125; else &#123; if (request.isTwoWay()) &#123; Response response = handleRequest(exchangeChannel, request); channel.send(response); &#125; else &#123; handler.received(exchangeChannel, request.getData()); &#125; &#125; &#125; else if (message instanceof Response) &#123; handleResponse(channel, (Response) message); &#125; else if (message instanceof String) &#123; if (isClientSide(channel)) &#123; Exception e = new Exception("Dubbo client can not supported string message: " + message + " in channel: " + channel + ", url: " + channel.getUrl()); logger.error(e.getMessage(), e); &#125; else &#123; String echo = handler.telnet(channel, (String) message); if (echo != null &amp;&amp; echo.length() &gt; 0) &#123; channel.send(echo); &#125; &#125; &#125; else &#123; handler.received(exchangeChannel, message); &#125; &#125; finally &#123; HeaderExchangeChannel.removeChannelIfDisconnected(channel); &#125;&#125; handleRequestÂ§ÑÁêÜËØ∑Ê±ÇÂπ∂ËøîÂõûresponse 1234567891011121314151617181920212223242526Response handleRequest(ExchangeChannel channel, Request req) throws RemotingException &#123; Response res = new Response(req.getId(), req.getVersion()); if (req.isBroken()) &#123; Object data = req.getData(); String msg; if (data == null) msg = null; else if (data instanceof Throwable) msg = StringUtils.toString((Throwable) data); else msg = data.toString(); res.setErrorMessage("Fail to decode request due to: " + msg); res.setStatus(Response.BAD_REQUEST); return res; &#125; // find handler by message class. Object msg = req.getData(); try &#123; // handle data. Object result = handler.reply(channel, msg); res.setStatus(Response.OK); res.setResult(result); &#125; catch (Throwable e) &#123; res.setStatus(Response.SERVICE_ERROR); res.setErrorMessage(StringUtils.toString(e)); &#125; return res;&#125; ExchangeHandlerAdaptive.replay(DubboProtocol)Ë∞ÉÁî®DubboProtocol‰∏≠ÂÆö‰πâÁöÑExchangeHandlerAdapter. replyÊñπÊ≥ïÂ§ÑÁêÜÊ∂àÊÅØ 12345private ExchangeHandler requestHandler = new ExchangeHandlerAdapter() &#123; public Object reply(ExchangeChannel channel, Object message) throws RemotingException &#123; invoker.invoke(inv);&#125; ÈÇ£Êé•‰∏ãÊù•invoker.invoke‰ºöË∞ÉÁî®Âì™‰∏™Á±ª‰∏≠ÁöÑÊñπÊ≥ïÂë¢ÔºüËøòËÆ∞ÂæóÂú®RegistryDirectory‰∏≠ÂèëÂ∏ÉÊú¨Âú∞ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂØπinvokerÂÅöÁöÑÂåÖË£ÖÂêóÔºüÈÄöËøáInvokerDelegeteÂØπÂéüÊú¨ÁöÑinvokerÂÅö‰∫Ü‰∏ÄÂ±ÇÂåÖË£ÖÔºåËÄåÂéüÊú¨ÁöÑinvokerÊòØ‰ªÄ‰πàÂë¢ÔºüÊòØ‰∏Ä‰∏™JavassistProxyFactoryÁîüÊàêÁöÑÂä®ÊÄÅ‰ª£ÁêÜÂêß„ÄÇÊâÄ‰ª•Ê≠§Â§ÑÁöÑinvokerÂ∫îËØ•ÊòØ Filter(Listener(InvokerDelegete(AbstractProxyInvoker (Wrapper.invokeMethod))) RegistryDirectoryÁîüÊàêinvokerÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ã 123456789101112131415private &lt;T&gt; ExporterChangeableWrapper&lt;T&gt; doLocalExport(final Invoker&lt;T&gt; originInvoker)&#123; String key = getCacheKey(originInvoker); ExporterChangeableWrapper&lt;T&gt; exporter = (ExporterChangeableWrapper&lt;T&gt;) bounds.get(key); if (exporter == null) &#123; synchronized (bounds) &#123; exporter = (ExporterChangeableWrapper&lt;T&gt;) bounds.get(key); if (exporter == null) &#123; final Invoker&lt;?&gt; invokerDelegete = new InvokerDelegete&lt;T&gt;(originInvoker, getProviderUrl(originInvoker)); exporter = new ExporterChangeableWrapper&lt;T&gt;((Exporter&lt;T&gt;)protocol.export(invokerDelegete), originInvoker); bounds.put(key, exporter); &#125; &#125; &#125; return (ExporterChangeableWrapper&lt;T&gt;) exporter;&#125; DirectoryÈõÜÁæ§ÁõÆÂΩïÊúçÂä°DirectoryÔºå ‰ª£Ë°®Â§ö‰∏™Invoker, ÂèØ‰ª•ÁúãÊàêList,ÂÆÉÁöÑÂÄºÂèØËÉΩÊòØÂä®ÊÄÅÂèòÂåñÁöÑÊØîÂ¶ÇÊ≥®ÂÜå‰∏≠ÂøÉÊé®ÈÄÅÂèòÊõ¥„ÄÇÈõÜÁæ§ÈÄâÊã©Ë∞ÉÁî®ÊúçÂä°Êó∂ÈÄöËøáÁõÆÂΩïÊúçÂä°ÊâæÂà∞ÊâÄÊúâÊúçÂä° StaticDirectory: ÈùôÊÄÅÁõÆÂΩïÊúçÂä°Ôºå ÂÆÉÁöÑÊâÄÊúâInvokerÈÄöËøáÊûÑÈÄ†ÂáΩÊï∞‰º†ÂÖ•Ôºå ÊúçÂä°Ê∂àË¥πÊñπÂºïÁî®ÊúçÂä°ÁöÑÊó∂ÂÄôÔºå ÊúçÂä°ÂØπÂ§öÊ≥®ÂÜå‰∏≠ÂøÉÁöÑÂºïÁî®ÔºåÂ∞ÜInvokersÈõÜÂêàÁõ¥Êé•‰º†ÂÖ• StaticDirectoryÊûÑÈÄ†Âô®ÔºåÂÜçÁî±Cluster‰º™Ë£ÖÊàê‰∏Ä‰∏™InvokerÔºõStaticDirectoryÁöÑlistÊñπÊ≥ïÁõ¥Êé•ËøîÂõûÊâÄÊúâinvokerÈõÜÂêàÔºõ RegistryDirectory: Ê≥®ÂÜåÁõÆÂΩïÊúçÂä°Ôºå ÂÆÉÁöÑInvokerÈõÜÂêàÊòØ‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñÁöÑÔºå ÂÆÉÂÆûÁé∞‰∫ÜNotifyListenerÊé•Âè£ÂÆûÁé∞‰∫ÜÂõûË∞ÉÊé•Âè£notify(List) DirectoryÁõÆÂΩïÊúçÂä°ÁöÑÊõ¥Êñ∞ËøáÁ®ãRegistryProtocol.doReferÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØÊ∂àË¥πÁ´ØÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºåËøôÈáåÊ∂âÂèäÂà∞‰∫ÜRegistryDirectoryËøô‰∏™Á±ª„ÄÇÁÑ∂ÂêéÊâßË°åcluster.join(directory)ÊñπÊ≥ï„ÄÇ cluster.joinÂÖ∂ÂÆûÂ∞±ÊòØÂ∞ÜDirectory‰∏≠ÁöÑÂ§ö‰∏™Invoker‰º™Ë£ÖÊàê‰∏Ä‰∏™Invoker, ÂØπ‰∏äÂ±ÇÈÄèÊòéÔºåÂåÖÂê´ÈõÜÁæ§ÁöÑÂÆπÈîôÊú∫Âà∂ 1234567891011121314151617181920212223242526private &lt;T&gt; Invoker&lt;T&gt; doRefer(Cluster cluster, Registry registry, Class&lt;T&gt; type, URL url) &#123; RegistryDirectory&lt;T&gt; directory = new RegistryDirectory&lt;T&gt;(type, url);//ÂØπÂ§ö‰∏™invokerËøõË°åÁªÑË£Ö directory.setRegistry(registry); //ZookeeperRegistry directory.setProtocol(protocol); //protocol=Protocol$Adaptive //url=consumer://192.168.111.... URL subscribeUrl = new URL(Constants.CONSUMER_PROTOCOL, NetUtils.getLocalHost(), 0, type.getName(), directory.getUrl().getParameters()); //‰ºöÊääconsumer://192... Ê≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ if (! Constants.ANY_VALUE.equals(url.getServiceInterface()) &amp;&amp; url.getParameter(Constants.REGISTER_KEY, true)) &#123; //zkClient.create() registry.register(subscribeUrl.addParameters(Constants.CATEGORY_KEY, Constants.CONSUMERS_CATEGORY, Constants.CHECK_KEY, String.valueOf(false))); &#125; directory.subscribe(subscribeUrl.addParameter(Constants.CATEGORY_KEY, Constants.PROVIDERS_CATEGORY + "," + Constants.CONFIGURATORS_CATEGORY + "," + Constants.ROUTERS_CATEGORY)); //Cluster$Adaptive return cluster.join(directory);&#125; directory.subscribeËÆ¢ÈòÖËäÇÁÇπÁöÑÂèòÂåñÔºå ÂΩìzookeeper‰∏äÊåáÂÆöËäÇÁÇπÂèëÁîüÂèòÂåñ‰ª•ÂêéÔºå‰ºöÈÄöÁü•Âà∞RegistryDirectoryÁöÑnotifyÊñπÊ≥ï 2.Â∞ÜurlËΩ¨Âåñ‰∏∫invokerÂØπË±° Ë∞ÉÁî®ËøáÁ®ã‰∏≠invokersÁöÑ‰ΩøÁî®ÂÜçË∞ÉÁî®ËøáÁ®ã‰∏≠ÔºåAbstractClusterInvoker.invokeÊñπÊ≥ï‰∏≠Ôºå 123456789101112131415161718public Result invoke(final Invocation invocation) throws RpcException &#123; checkWhetherDestroyed(); LoadBalance loadbalance; List&lt;Invoker&lt;T&gt;&gt; invokers = list(invocation); if (invokers != null &amp;&amp; invokers.size() &gt; 0) &#123; loadbalance = ExtensionLoader.getExtensionLoader(LoadBalance.class).getExtension(invokers.get(0).getUrl().getMethodParameter(invocation.getMethodName(),Constants.LOADBALANCE_KEY, Constants.DEFAULT_LOADBALANCE)); &#125; else &#123; loadbalance = ExtensionLoader.getExtensionLoader(LoadBalance.class).getExtension(Constants.DEFAULT_LOADBALANCE); &#125; RpcUtils.attachInvocationIdIfAsync(getUrl(), invocation); return doInvoke(invocation, invokers, loadbalance);&#125; listÊñπÊ≥ï‰ªédirectory‰∏≠Ëé∑Âæóinvokers 1234protected List&lt;Invoker&lt;T&gt;&gt; list(Invocation invocation) throws RpcException &#123; List&lt;Invoker&lt;T&gt;&gt; invokers = directory.list(invocation); return invokers;&#125; Ë¥üËΩΩÂùáË°°LoadBalanceLoadBalanceË¥üËΩΩÂùáË°°Ôºå Ë¥üË¥£‰ªéÂ§ö‰∏™ Invokers‰∏≠ÈÄâÂá∫ÂÖ∑‰ΩìÁöÑ‰∏Ä‰∏™InvokerÁî®‰∫éÊú¨Ê¨°Ë∞ÉÁî®ÔºåË∞ÉÁî®ËøáÁ®ã‰∏≠ÂåÖÂê´‰∫ÜË¥üËΩΩÂùáË°°ÁöÑÁÆóÊ≥ï„ÄÇ Ë¥üËΩΩÂùáË°°‰ª£Á†ÅËÆøÈóÆÂÖ•Âè£Âú®AbstractClusterInvoker.invoke‰∏≠‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÈÄöËøáÂêçÁß∞Ëé∑ÂæóÊåáÂÆöÁöÑÊâ©Â±ïÁÇπ„ÄÇRandomLoadBalance AbstractClusterInvoker.doselectË∞ÉÁî®LoadBalance.selectÊñπÊ≥ïÔºåËÆ≤invokersÊåâÁÖßÊåáÂÆöÁÆóÊ≥ïËøõË°åË¥üËΩΩ 1234567891011121314151617181920212223242526272829303132333435private Invoker&lt;T&gt; doselect(LoadBalance loadbalance, Invocation invocation, List&lt;Invoker&lt;T&gt;&gt; invokers, List&lt;Invoker&lt;T&gt;&gt; selected) throws RpcException &#123; if (invokers == null || invokers.size() == 0) return null; if (invokers.size() == 1) return invokers.get(0); // Â¶ÇÊûúÂè™Êúâ‰∏§‰∏™invokerÔºåÈÄÄÂåñÊàêËΩÆÂæ™ if (invokers.size() == 2 &amp;&amp; selected != null &amp;&amp; selected.size() &gt; 0) &#123; return selected.get(0) == invokers.get(0) ? invokers.get(1) : invokers.get(0); &#125; Invoker&lt;T&gt; invoker = loadbalance.select(invokers, getUrl(), invocation); //Â¶ÇÊûú selected‰∏≠ÂåÖÂê´Ôºà‰ºòÂÖàÂà§Êñ≠Ôºâ ÊàñËÄÖ ‰∏çÂèØÁî®&amp;&amp;availablecheck=true ÂàôÈáçËØï. if( (selected != null &amp;&amp; selected.contains(invoker)) ||(!invoker.isAvailable() &amp;&amp; getUrl()!=null &amp;&amp; availablecheck))&#123; try&#123; Invoker&lt;T&gt; rinvoker = reselect(loadbalance, invocation, invokers, selected, availablecheck); if(rinvoker != null)&#123; invoker = rinvoker; &#125;else&#123; //Áúã‰∏ãÁ¨¨‰∏ÄÊ¨°ÈÄâÁöÑ‰ΩçÁΩÆÔºåÂ¶ÇÊûú‰∏çÊòØÊúÄÂêéÔºåÈÄâ+1‰ΩçÁΩÆ. int index = invokers.indexOf(invoker); try&#123; //ÊúÄÂêéÂú®ÈÅøÂÖçÁ¢∞Êíû invoker = index &lt;invokers.size()-1?invokers.get(index+1) :invoker; &#125;catch (Exception e) &#123; logger.warn(e.getMessage()+" may because invokers list dynamic change, ignore.",e); &#125; &#125; &#125;catch (Throwable t)&#123; logger.error("clustor relselect fail reason is :"+t.getMessage() +" if can not slove ,you can set cluster.availablecheck=false in url",t); &#125; &#125; return invoker;&#125; ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåLoadBalance‰ΩøÁî®ÁöÑÊòØRandomÁÆóÊ≥ïÔºå‰ΩÜÊòØËøô‰∏™ÈöèÊú∫ÂíåÊàë‰ª¨ÁêÜËß£‰∏äÁöÑÈöèÊú∫ËøòÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ,Âõ†‰∏∫‰ªñËøòÊúâ‰∏™Ê¶ÇÂøµÂè´weight(ÊùÉÈáç) RandomLoadBalanceÂÅáËÆæÊúâÂõõ‰∏™ÈõÜÁæ§ËäÇÁÇπA,B,C,D,ÂØπÂ∫îÁöÑÊùÉÈáçÂàÜÂà´ÊòØ1,2,3,4,ÈÇ£‰πàËØ∑Ê±ÇÂà∞AËäÇÁÇπÁöÑÊ¶ÇÁéáÂ∞±‰∏∫1/(1+2+3+4) = 10%.B,C,DËäÇÁÇπ‰æùÊ¨°Á±ªÊé®‰∏∫20%,30%,40%. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051protected &lt;T&gt; Invoker&lt;T&gt; doSelect(List&lt;Invoker&lt;T&gt;&gt; invokers, URL url, Invocation invocation) &#123; int length = invokers.size(); // ÊÄª‰∏™Êï∞ int totalWeight = 0; // ÊÄªÊùÉÈáç boolean sameWeight = true; // ÊùÉÈáçÊòØÂê¶ÈÉΩ‰∏ÄÊ†∑ for (int i = 0; i &lt; length; i++) &#123; int weight = getWeight(invokers.get(i), invocation); totalWeight += weight; // Á¥ØËÆ°ÊÄªÊùÉÈáç if (sameWeight &amp;&amp; i &gt; 0 &amp;&amp; weight != getWeight(invokers.get(i - 1), invocation)) &#123; sameWeight = false; // ËÆ°ÁÆóÊâÄÊúâÊùÉÈáçÊòØÂê¶‰∏ÄÊ†∑ &#125; &#125; if (totalWeight &gt; 0 &amp;&amp; ! sameWeight) &#123; // Â¶ÇÊûúÊùÉÈáç‰∏çÁõ∏Âêå‰∏îÊùÉÈáçÂ§ß‰∫é0ÂàôÊåâÊÄªÊùÉÈáçÊï∞ÈöèÊú∫ int offset = random.nextInt(totalWeight); // Âπ∂Á°ÆÂÆöÈöèÊú∫ÂÄºËêΩÂú®Âì™‰∏™ÁâáÊñ≠‰∏ä for (int i = 0; i &lt; length; i++) &#123; offset -= getWeight(invokers.get(i), invocation); if (offset &lt; 0) &#123; return invokers.get(i); &#125; &#125; &#125; // Â¶ÇÊûúÊùÉÈáçÁõ∏ÂêåÊàñÊùÉÈáç‰∏∫0ÂàôÂùáÁ≠âÈöèÊú∫ return invokers.get(random.nextInt(length));&#125; new Invoker ÂåÖË£ÖFilterË¥£‰ªªÈìæÊ®°Âºè123public interface Filter &#123; Result invoke(Invoker&lt;?&gt; invoker, Invocation invocation) throws RpcException;&#125; 12345678public class ClassLoaderFilter implements Filter &#123; public Result invoke(Invoker&lt;?&gt; invoker, Invocation invocation) throws RpcException &#123; doSomething(); return invoker.invoke(invocation); &#125;&#125; 12345678public class OneFilter implements Filter&#123; public Result invoke(Invoker&lt;?&gt; invoker, Invocation invocation) &#123; doOne(); return invoker.invoke(invocation); &#125;&#125; 123456789for(Filter filter : filterList)&#123; Filter next = last; last = new Invoker()&#123; public Result invoke(Invocation invocation) throws RpcException &#123; return filter.invoke(next, invocation); &#125; &#125;&#125; 123456789for (int i = filters.size() - 1; i &gt;= 0; i --) &#123; final Filter filter = filters.get(i); final Invoker&lt;T&gt; next = last; last = new Invoker&lt;T&gt;() &#123; public Result invoke(Invocation invocation) throws RpcException &#123; return filter.invoke(next, invocation); &#125; &#125;;&#125;]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[SpringBootÊ∫êÁ†ÅÂàÜÊûê‰πãÊù°‰ª∂Ê≥®Ëß£ÁöÑÂ∫ïÂ±ÇÂÆûÁé∞]]></title>
    <url>%2F2018%2F06%2F25%2FSpringBoot%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E6%9D%A1%E4%BB%B6%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[SpringBootÂÜÖÈÉ®Êèê‰æõ‰∫ÜÁâπÊúâÁöÑÊ≥®Ëß£ÔºöÊù°‰ª∂Ê≥®Ëß£(Conditional Annotation)„ÄÇÊØîÂ¶Ç@ConditionalOnBean„ÄÅ@ConditionalOnClass„ÄÅ@ConditionalOnExpression„ÄÅ@ConditionalOnMissingBeanÁ≠â„ÄÇ Êù°‰ª∂Ê≥®Ëß£Â≠òÂú®ÁöÑÊÑè‰πâÂú®‰∫éÂä®ÊÄÅËØÜÂà´(‰πüÂèØ‰ª•ËØ¥ÊòØ‰ª£Á†ÅËá™Âä®ÂåñÊâßË°å)„ÄÇÊØîÂ¶Ç@ConditionalOnClass‰ºöÊ£ÄÊü•Á±ªÂä†ËΩΩÂô®‰∏≠ÊòØÂê¶Â≠òÂú®ÂØπÂ∫îÁöÑÁ±ªÔºåÂ¶ÇÊûúÊúâÁöÑËØùË¢´Ê≥®Ëß£‰øÆÈ•∞ÁöÑÁ±ªÂ∞±ÊúâËµÑÊ†ºË¢´SpringÂÆπÂô®ÊâÄÊ≥®ÂÜåÔºåÂê¶Âàô‰ºöË¢´skip„ÄÇ ÊØîÂ¶ÇFreemarkerAutoConfigurationËøô‰∏™Ëá™Âä®ÂåñÈÖçÁΩÆÁ±ªÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºö 123456@Configuration@ConditionalOnClass(&#123; freemarker.template.Configuration.class, FreeMarkerConfigurationFactory.class &#125;)@AutoConfigureAfter(WebMvcAutoConfiguration.class)@EnableConfigurationProperties(FreeMarkerProperties.class)public class FreeMarkerAutoConfiguration Ëøô‰∏™Ëá™Âä®ÂåñÈÖçÁΩÆÁ±ªË¢´@ConditionalOnClassÊù°‰ª∂Ê≥®Ëß£‰øÆÈ•∞ÔºåËøô‰∏™Êù°‰ª∂Ê≥®Ëß£Â≠òÂú®ÁöÑÊÑè‰πâÂú®‰∫éÂà§Êñ≠Á±ªÂä†ËΩΩÂô®‰∏≠ÊòØÂê¶Â≠òÂú®freemarker.template.ConfigurationÂíåFreeMarkerConfigurationFactoryËøô‰∏§‰∏™Á±ªÔºåÂ¶ÇÊûúÈÉΩÂ≠òÂú®ÁöÑËØù‰ºöÂú®SpringÂÆπÂô®‰∏≠Âä†ËΩΩËøô‰∏™FreeMarkerAutoConfigurationÈÖçÁΩÆÁ±ªÔºõÂê¶Âàô‰∏ç‰ºöÂä†ËΩΩ„ÄÇ Êù°‰ª∂Ê≥®Ëß£ÂÜÖÈÉ®ÁöÑ‰∏Ä‰∫õÂü∫Á°ÄÂú®ÂàÜÊûêÊù°‰ª∂Ê≥®Ëß£ÁöÑÂ∫ïÂ±ÇÂÆûÁé∞‰πãÂâçÔºåÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãËøô‰∫õÊù°‰ª∂Ê≥®Ëß£ÁöÑÂÆö‰πâ„ÄÇ‰ª•@ConditionalOnClassÊ≥®Ëß£‰∏∫‰æãÔºåÂÆÉÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºö 12345678@Target(&#123; ElementType.TYPE, ElementType.METHOD &#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Conditional(OnClassCondition.class)public @interface ConditionalOnClass &#123; Class&lt;?&gt;[] value() default &#123;&#125;; // ÈúÄË¶ÅÂåπÈÖçÁöÑÁ±ª String[] name() default &#123;&#125;; // ÈúÄË¶ÅÂåπÈÖçÁöÑÁ±ªÂêç&#125; ÂÆÉÊúâ2‰∏™Â±ûÊÄßÔºåÂàÜÂà´ÊòØÁ±ªÊï∞ÁªÑÂíåÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ(‰ΩúÁî®‰∏ÄÊ†∑ÔºåÁ±ªÂûã‰∏ç‰∏ÄÊ†∑)ÔºåËÄå‰∏îË¢´@ConditionalÊ≥®Ëß£ÊâÄ‰øÆÈ•∞ÔºåËøô‰∏™@ConditionalÊ≥®Ëß£Êúâ‰∏™Âêç‰∏∫valuesÁöÑClass&lt;? extends Condition&gt;[]Á±ªÂûãÁöÑÂ±ûÊÄß„ÄÇ Ëøô‰∏™ConditionÊòØ‰∏™Êé•Âè£ÔºåÁî®‰∫éÂåπÈÖçÁªÑ‰ª∂ÊòØÂê¶ÊúâËµÑÊ†ºË¢´ÂÆπÂô®Ê≥®ÂÜåÔºåÂÆö‰πâÂ¶Ç‰∏ãÔºö 1234public interface Condition &#123; // ConditionContextÂÜÖÈÉ®‰ºöÂ≠òÂÇ®SpringÂÆπÂô®„ÄÅÂ∫îÁî®Á®ãÂ∫èÁéØÂ¢É‰ø°ÊÅØ„ÄÅËµÑÊ∫êÂä†ËΩΩÂô®„ÄÅÁ±ªÂä†ËΩΩÂô® boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);&#125; ‰πüÂ∞±ÊòØËØ¥@ConditionalÊ≥®Ëß£Â±ûÊÄß‰∏≠ÂèØ‰ª•ÊåÅÊúâÂ§ö‰∏™ConditionÊé•Âè£ÁöÑÂÆûÁé∞Á±ªÔºåÊâÄÊúâÁöÑConditionÊé•Âè£ÈúÄË¶ÅÂÖ®ÈÉ®ÂåπÈÖçÊàêÂäüÂêéËøô‰∏™@Conditional‰øÆÈ•∞ÁöÑÁªÑ‰ª∂ÊâçÊúâËµÑÊ†ºË¢´Ê≥®ÂÜå„ÄÇ ConditionÊé•Âè£Êúâ‰∏™Â≠êÊé•Âè£ConfigurationConditionÔºö 123456789101112public interface ConfigurationCondition extends Condition &#123; ConfigurationPhase getConfigurationPhase(); public static enum ConfigurationPhase &#123; PARSE_CONFIGURATION, REGISTER_BEAN &#125;&#125; Ëøô‰∏™Â≠êÊé•Âè£ÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊù°‰ª∂Êé•Âè£ÔºåÂ§ö‰∫Ü‰∏Ä‰∏™getConfigurationPhaseÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØÊù°‰ª∂Ê≥®Ëß£ÁöÑÁîüÊïàÈò∂ÊÆµ„ÄÇÂè™ÊúâÂú®ConfigurationPhase‰∏≠ÂÆö‰πâÁöÑ‰∏§ÁßçÈò∂ÊÆµ‰∏ãÊâç‰ºöÁîüÊïà„ÄÇ ConditionÊé•Âè£Êúâ‰∏™ÂÆûÁé∞ÊäΩË±°Á±ªSpringBootConditionÔºåSpringBoot‰∏≠ÊâÄÊúâÊù°‰ª∂Ê≥®Ëß£ÂØπÂ∫îÁöÑÊù°‰ª∂Á±ªÈÉΩÁªßÊâøËøô‰∏™ÊäΩË±°Á±ª„ÄÇÂÆÉÂÆûÁé∞‰∫ÜmatchesÊñπÊ≥ïÔºö 12345678910111213141516171819202122232425@Overridepublic final boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) &#123; String classOrMethodName = getClassOrMethodName(metadata); // ÂæóÂà∞Á±ªÂêçÊàñËÄÖÊñπÊ≥ïÂêç(Êù°‰ª∂Ê≥®Ëß£ÂèØ‰ª•‰ΩúÁî®ÁöÑÁ±ªÊàñËÄÖÊñπÊ≥ï‰∏ä) try &#123; ConditionOutcome outcome = getMatchOutcome(context, metadata); // ÊäΩË±°ÊñπÊ≥ïÔºåÂÖ∑‰ΩìÂ≠êÁ±ªÂÆûÁé∞„ÄÇConditionOutcomeËÆ∞ÂΩï‰∫ÜÂåπÈÖçÁªìÊûúbooleanÂíålog‰ø°ÊÅØ logOutcome(classOrMethodName, outcome); // logËÆ∞ÂΩï‰∏Ä‰∏ãÂåπÈÖç‰ø°ÊÅØ recordEvaluation(context, classOrMethodName, outcome); // Êä•ÂëäËÆ∞ÂΩï‰∏Ä‰∏ãÂåπÈÖç‰ø°ÊÅØ return outcome.isMatch(); // ËøîÂõûÊòØÂê¶ÂåπÈÖç &#125; catch (NoClassDefFoundError ex) &#123; throw new IllegalStateException( "Could not evaluate condition on " + classOrMethodName + " due to " + ex.getMessage() + " not " + "found. Make sure your own configuration does not rely on " + "that class. This can also happen if you are " + "@ComponentScanning a springframework package (e.g. if you " + "put a @ComponentScan in the default package by mistake)", ex); &#125; catch (RuntimeException ex) &#123; throw new IllegalStateException( "Error processing condition on " + getName(metadata), ex); &#125;&#125; Âü∫‰∫éClassÁöÑÊù°‰ª∂Ê≥®Ëß£SpringBootÊèê‰æõ‰∫Ü‰∏§‰∏™Âü∫‰∫éClassÁöÑÊù°‰ª∂Ê≥®Ëß£Ôºö@ConditionalOnClass(Á±ªÂä†ËΩΩÂô®‰∏≠Â≠òÂú®ÊåáÊòéÁöÑÁ±ª)ÊàñËÄÖ@ConditionalOnMissingClass(Á±ªÂä†ËΩΩÂô®‰∏≠‰∏çÂ≠òÂú®ÊåáÊòéÁöÑÁ±ª)„ÄÇ @ConditionalOnClassÊàñËÄÖ@ConditionalOnMissingClassÊ≥®Ëß£ÂØπÂ∫îÁöÑÊù°‰ª∂Á±ªÊòØOnClassConditionÔºåÂÆö‰πâÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465@Order(Ordered.HIGHEST_PRECEDENCE) // ‰ºòÂÖàÁ∫ß„ÄÅÊúÄÈ´òÁ∫ßÂà´class OnClassCondition extends SpringBootCondition &#123; @Override public ConditionOutcome getMatchOutcome(ConditionContext context, AnnotatedTypeMetadata metadata) &#123; StringBuffer matchMessage = new StringBuffer(); // ËÆ∞ÂΩïÂåπÈÖç‰ø°ÊÅØ MultiValueMap&lt;String, Object&gt; onClasses = getAttributes(metadata, ConditionalOnClass.class); // ÂæóÂà∞@ConditionalOnClassÊ≥®Ëß£ÁöÑÂ±ûÊÄß if (onClasses != null) &#123; // Â¶ÇÊûúÂ±ûÊÄßÂ≠òÂú® List&lt;String&gt; missing = getMatchingClasses(onClasses, MatchType.MISSING, context); // ÂæóÂà∞Âú®Á±ªÂä†ËΩΩÂô®‰∏≠‰∏çÂ≠òÂú®ÁöÑÁ±ª if (!missing.isEmpty()) &#123; // Â¶ÇÊûúÂ≠òÂú®Á±ªÂä†ËΩΩÂô®‰∏≠‰∏çÂ≠òÂú®ÂØπÂ∫îÁöÑÁ±ªÔºåËøîÂõû‰∏Ä‰∏™ÂåπÈÖçÂ§±Ë¥•ÁöÑConditionalOutcome return ConditionOutcome .noMatch("required @ConditionalOnClass classes not found: " + StringUtils.collectionToCommaDelimitedString(missing)); &#125; // Â¶ÇÊûúÁ±ªÂä†ËΩΩÂô®‰∏≠Â≠òÂú®ÂØπÂ∫îÁöÑÁ±ªÁöÑËØùÔºåÂåπÈÖç‰ø°ÊÅØËøõË°åËÆ∞ÂΩï matchMessage.append("@ConditionalOnClass classes found: " + StringUtils.collectionToCommaDelimitedString( getMatchingClasses(onClasses, MatchType.PRESENT, context))); &#125; // ÂØπ@ConditionalOnMissingClassÊ≥®Ëß£ÂÅöÁõ∏ÂêåÁöÑÈÄªËæëÂ§ÑÁêÜ(ËØ¥Êòé@ConditionalOnClassÂíå@ConditionalOnMissingClassÂèØ‰ª•‰∏ÄËµ∑‰ΩøÁî®) MultiValueMap&lt;String, Object&gt; onMissingClasses = getAttributes(metadata, ConditionalOnMissingClass.class); if (onMissingClasses != null) &#123; List&lt;String&gt; present = getMatchingClasses(onMissingClasses, MatchType.PRESENT, context); if (!present.isEmpty()) &#123; return ConditionOutcome .noMatch("required @ConditionalOnMissing classes found: " + StringUtils.collectionToCommaDelimitedString(present)); &#125; matchMessage.append(matchMessage.length() == 0 ? "" : " "); matchMessage.append("@ConditionalOnMissing classes not found: " + StringUtils.collectionToCommaDelimitedString(getMatchingClasses( onMissingClasses, MatchType.MISSING, context))); &#125; // ËøîÂõûÂÖ®ÈÉ®ÂåπÈÖçÊàêÂäüÁöÑConditionalOutcome return ConditionOutcome.match(matchMessage.toString()); &#125; private enum MatchType &#123; // Êûö‰∏æÔºöÂåπÈÖçÁ±ªÂûã„ÄÇÁî®‰∫éÊü•ËØ¢Á±ªÂêçÂú®ÂØπÂ∫îÁöÑÁ±ªÂä†ËΩΩÂô®‰∏≠ÊòØÂê¶Â≠òÂú®„ÄÇ PRESENT &#123; // ÂåπÈÖçÊàêÂäü @Override public boolean matches(String className, ConditionContext context) &#123; return ClassUtils.isPresent(className, context.getClassLoader()); &#125; &#125;, MISSING &#123; // ÂåπÈÖç‰∏çÊàêÂäü @Override public boolean matches(String className, ConditionContext context) &#123; return !ClassUtils.isPresent(className, context.getClassLoader()); &#125; &#125;; public abstract boolean matches(String className, ConditionContext context); &#125;&#125; ÊØîÂ¶ÇFreemarkerAutoConfiguration‰∏≠ÁöÑ@ConditionalOnClassÊ≥®Ëß£‰∏≠ÊúâvalueÂ±ûÊÄßÊòØfreemarker.template.Configuration.classÂíåFreeMarkerConfigurationFactory.class„ÄÇÂú®OnClassConditionÊâßË°åËøáÁ®ã‰∏≠ÂæóÂà∞ÁöÑÊúÄÁªàConditionalOutcome‰∏≠ÁöÑlog messageÂ¶Ç‰∏ãÔºö 1@ConditionalOnClass classes found: freemarker.template.Configuration,org.springframework.ui.freemarker.FreeMarkerConfigurationFactory Âü∫‰∫éBeanÁöÑÊù°‰ª∂Ê≥®Ëß£@ConditionalOnBean(SpringÂÆπÂô®‰∏≠Â≠òÂú®ÊåáÊòéÁöÑbean)„ÄÅ@ConditionalOnMissingBean(SpringÂÆπÂô®‰∏≠‰∏çÂ≠òÂú®ÊåáÊòéÁöÑbean)‰ª•ÂèäConditionalOnSingleCandidate(SpringÂÆπÂô®‰∏≠Â≠òÂú®‰∏îÂè™Â≠òÂú®‰∏Ä‰∏™ÊåáÊòéÁöÑbean)ÈÉΩÊòØÂü∫‰∫éBeanÁöÑÊù°‰ª∂Ê≥®Ëß£ÔºåÂÆÉ‰ª¨ÂØπÂ∫îÁöÑÊù°‰ª∂Á±ªÊòØConditionOnBean„ÄÇ @ConditionOnBeanÊ≥®Ëß£ÂÆö‰πâÂ¶Ç‰∏ãÔºö 1234567891011@Target(&#123; ElementType.TYPE, ElementType.METHOD &#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Conditional(OnBeanCondition.class)public @interface ConditionalOnBean &#123; Class&lt;?&gt;[] value() default &#123;&#125;; // ÂåπÈÖçÁöÑbeanÁ±ªÂûã String[] type() default &#123;&#125;; // ÂåπÈÖçÁöÑbeanÁ±ªÂûãÁöÑÁ±ªÂêç Class&lt;? extends Annotation&gt;[] annotation() default &#123;&#125;; // ÂåπÈÖçÁöÑbeanÊ≥®Ëß£ String[] name() default &#123;&#125;; // ÂåπÈÖçÁöÑbeanÁöÑÂêçÂ≠ó SearchStrategy search() default SearchStrategy.ALL; // ÊêúÁ¥¢Á≠ñÁï•„ÄÇÊèê‰æõCURRENT(Âè™Âú®ÂΩìÂâçÂÆπÂô®‰∏≠Êâæ)„ÄÅPARENTS(Âè™Âú®ÊâÄÊúâÁöÑÁà∂ÂÆπÂô®‰∏≠ÊâæÔºõ‰ΩÜÊòØ‰∏çÂåÖÊã¨ÂΩìÂâçÂÆπÂô®)ÂíåALL(CURRENTÂíåPARENTSÁöÑÁªÑÂêà)&#125; OnBeanConditionÊù°‰ª∂Á±ªÁöÑÂåπÈÖç‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445@Overridepublic ConditionOutcome getMatchOutcome(ConditionContext context, AnnotatedTypeMetadata metadata) &#123; StringBuffer matchMessage = new StringBuffer(); // ËÆ∞ÂΩïÂåπÈÖç‰ø°ÊÅØ if (metadata.isAnnotated(ConditionalOnBean.class.getName())) &#123; BeanSearchSpec spec = new BeanSearchSpec(context, metadata, ConditionalOnBean.class); // ÊûÑÈÄ†‰∏Ä‰∏™BeanSearchSpecÔºå‰ºö‰ªé@ConditionalOnBeanÊ≥®Ëß£‰∏≠Ëé∑ÂèñÂ±ûÊÄßÔºåÁÑ∂ÂêéËÆæÁΩÆÂà∞BeanSearchSpec‰∏≠ List&lt;String&gt; matching = getMatchingBeans(context, spec); // ‰ªéBeanFactory‰∏≠Ê†πÊçÆÁ≠ñÁï•ÊâæÂá∫ÊâÄÊúâÂåπÈÖçÁöÑbean if (matching.isEmpty()) &#123; // Â¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÁöÑbeanÔºåËøîÂõû‰∏Ä‰∏™Ê≤°ÊúâÂåπÈÖçÊàêÂäüÁöÑConditionalOutcome return ConditionOutcome .noMatch("@ConditionalOnBean " + spec + " found no beans"); &#125; // Â¶ÇÊûúÊâæÂà∞ÂåπÈÖçÁöÑbeanÔºåÂåπÈÖç‰ø°ÊÅØËøõË°åËÆ∞ÂΩï matchMessage.append( "@ConditionalOnBean " + spec + " found the following " + matching); &#125; if (metadata.isAnnotated(ConditionalOnSingleCandidate.class.getName())) &#123; // Áõ∏ÂêåÁöÑÈÄªËæëÔºåÈíàÂØπ@ConditionalOnSingleCandidateÊ≥®Ëß£ BeanSearchSpec spec = new SingleCandidateBeanSearchSpec(context, metadata, ConditionalOnSingleCandidate.class); List&lt;String&gt; matching = getMatchingBeans(context, spec); if (matching.isEmpty()) &#123; return ConditionOutcome.noMatch( "@ConditionalOnSingleCandidate " + spec + " found no beans"); &#125; else if (!hasSingleAutowireCandidate(context.getBeanFactory(), matching)) &#123; // Â§ö‰∫Ü‰∏ÄÂ±ÇÂà§Êñ≠ÔºåÂà§Êñ≠ÊòØÂê¶Âè™Êúâ‰∏Ä‰∏™bean return ConditionOutcome.noMatch("@ConditionalOnSingleCandidate " + spec + " found no primary candidate amongst the" + " following " + matching); &#125; matchMessage.append("@ConditionalOnSingleCandidate " + spec + " found " + "a primary candidate amongst the following " + matching); &#125; if (metadata.isAnnotated(ConditionalOnMissingBean.class.getName())) &#123; // Áõ∏ÂêåÁöÑÈÄªËæëÔºåÈíàÂØπ@ConditionalOnMissingBeanÊ≥®Ëß£ BeanSearchSpec spec = new BeanSearchSpec(context, metadata, ConditionalOnMissingBean.class); List&lt;String&gt; matching = getMatchingBeans(context, spec); if (!matching.isEmpty()) &#123; return ConditionOutcome.noMatch("@ConditionalOnMissingBean " + spec + " found the following " + matching); &#125; matchMessage.append(matchMessage.length() == 0 ? "" : " "); matchMessage.append("@ConditionalOnMissingBean " + spec + " found no beans"); &#125; return ConditionOutcome.match(matchMessage.toString()); //ËøîÂõûÂåπÈÖçÊàêÂäüÁöÑConditonalOutcome&#125; SpringBootËøòÊèê‰æõ‰∫ÜÂÖ∂‰ªñÊØîÂ¶ÇConditionalOnJava„ÄÅConditionalOnNotWebApplication„ÄÅConditionalOnWebApplication„ÄÅConditionalOnResource„ÄÅConditionalOnProperty„ÄÅConditionalOnExpressionÁ≠âÊù°‰ª∂Ê≥®Ëß£ÔºåÊúâÂÖ¥Ë∂£ÁöÑËØªËÄÖÂèØ‰ª•Ëá™Ë°åÊü•ÁúãÂÆÉ‰ª¨ÁöÑÂ∫ïÂ±ÇÂ§ÑÁêÜÈÄªËæë„ÄÇ ÂêÑÁßçÊù°‰ª∂Ê≥®Ëß£ÁöÑÊÄªÁªì Êù°‰ª∂Ê≥®Ëß£ ÂØπÂ∫îÁöÑConditionÂ§ÑÁêÜÁ±ª Â§ÑÁêÜÈÄªËæë @ConditionalOnBean OnBeanCondition SpringÂÆπÂô®‰∏≠ÊòØÂê¶Â≠òÂú®ÂØπÂ∫îÁöÑÂÆû‰æã„ÄÇÂèØ‰ª•ÈÄöËøáÂÆû‰æãÁöÑÁ±ªÂûã„ÄÅÁ±ªÂêç„ÄÅÊ≥®Ëß£„ÄÅÊòµÁß∞ÂéªÂÆπÂô®‰∏≠Êü•Êâæ(ÂèØ‰ª•ÈÖçÁΩÆ‰ªéÂΩìÂâçÂÆπÂô®‰∏≠Êü•ÊâæÊàñËÄÖÁà∂ÂÆπÂô®‰∏≠Êü•ÊâæÊàñËÄÖ‰∏§ËÄÖ‰∏ÄËµ∑Êü•Êâæ)Ëøô‰∫õÂ±ûÊÄßÈÉΩÊòØÊï∞ÁªÑÔºåÈÄöËøá‚Äù‰∏é‚ÄùÁöÑÂÖ≥Á≥ªËøõË°åÊü•Êâæ @ConditionalOnClass OnClassCondition Á±ªÂä†ËΩΩÂô®‰∏≠ÊòØÂê¶Â≠òÂú®ÂØπÂ∫îÁöÑÁ±ª„ÄÇÂèØ‰ª•ÈÄöËøáClassÊåáÂÆö(valueÂ±ûÊÄß)ÊàñËÄÖClassÁöÑÂÖ®ÂêçÊåáÂÆö(nameÂ±ûÊÄß)„ÄÇÂ¶ÇÊûúÊòØÂ§ö‰∏™Á±ªÊàñËÄÖÂ§ö‰∏™Á±ªÂêçÁöÑËØùÔºåÂÖ≥Á≥ªÊòØ‚Äù‰∏é‚ÄùÂÖ≥Á≥ªÔºå‰πüÂ∞±ÊòØËØ¥Ëøô‰∫õÁ±ªÊàñËÄÖÁ±ªÂêçÈÉΩÂøÖÈ°ªÂêåÊó∂Âú®Á±ªÂä†ËΩΩÂô®‰∏≠Â≠òÂú® @ConditionalOnExpression OnExpressionCondition Âà§Êñ≠SpEL Ë°®ËææÂºèÊòØÂê¶ÊàêÁ´ã @ConditionalOnJava OnJavaCondition ÊåáÂÆöJavaÁâàÊú¨ÊòØÂê¶Á¨¶ÂêàË¶ÅÊ±Ç„ÄÇÂÜÖÈÉ®Êúâ2‰∏™Â±ûÊÄßvalueÂíårange„ÄÇvalueË°®Á§∫‰∏Ä‰∏™Êûö‰∏æÁöÑJavaÁâàÊú¨ÔºårangeË°®Á§∫ÊØîËøô‰∏™ËÄÅÊàñËÄÖÊñ∞‰∫éÁ≠â‰∫éÊåáÂÆöÁöÑJavaÁâàÊú¨(ÈªòËÆ§ÊòØÊñ∞‰∫éÁ≠â‰∫é)„ÄÇÂÜÖÈÉ®‰ºöÂü∫‰∫éÊüê‰∫õjdkÁâàÊú¨ÁâπÊúâÁöÑÁ±ªÂéªÁ±ªÂä†ËΩΩÂô®‰∏≠Êü•ËØ¢ÔºåÊØîÂ¶ÇÂ¶ÇÊûúÊòØjdk9ÔºåÁ±ªÂä†ËΩΩÂô®‰∏≠ÈúÄË¶ÅÂ≠òÂú®java.security.cert.URICertStoreParametersÔºõÂ¶ÇÊûúÊòØjdk8ÔºåÁ±ªÂä†ËΩΩÂô®‰∏≠ÈúÄË¶ÅÂ≠òÂú®java.util.function.FunctionÔºõÂ¶ÇÊûúÊòØjdk7ÔºåÁ±ªÂä†ËΩΩÂô®‰∏≠ÈúÄË¶ÅÂ≠òÂú®java.nio.file.FilesÔºõÂ¶ÇÊûúÊòØjdk6ÔºåÁ±ªÂä†ËΩΩÂô®‰∏≠ÈúÄË¶ÅÂ≠òÂú®java.util.ServiceLoader @ConditionalOnMissingBean OnBeanCondition SpringÂÆπÂô®‰∏≠ÊòØÂê¶Áº∫Â∞ëÂØπÂ∫îÁöÑÂÆû‰æã„ÄÇÂèØ‰ª•ÈÄöËøáÂÆû‰æãÁöÑÁ±ªÂûã„ÄÅÁ±ªÂêç„ÄÅÊ≥®Ëß£„ÄÅÊòµÁß∞ÂéªÂÆπÂô®‰∏≠Êü•Êâæ(ÂèØ‰ª•ÈÖçÁΩÆ‰ªéÂΩìÂâçÂÆπÂô®‰∏≠Êü•ÊâæÊàñËÄÖÁà∂ÂÆπÂô®‰∏≠Êü•ÊâæÊàñËÄÖ‰∏§ËÄÖ‰∏ÄËµ∑Êü•Êâæ)Ëøô‰∫õÂ±ûÊÄßÈÉΩÊòØÊï∞ÁªÑÔºåÈÄöËøá‚Äù‰∏é‚ÄùÁöÑÂÖ≥Á≥ªËøõË°åÊü•Êâæ„ÄÇËøòÂ§ö‰∫Ü2‰∏™Â±ûÊÄßignored(Á±ªÂêç)ÂíåignoredType(Á±ªÂêç)ÔºåÂåπÈÖçÁöÑËøáÁ®ã‰∏≠‰ºöÂøΩÁï•Ëøô‰∫õbean @ConditionalOnMissingClass OnClassCondition Ë∑üConditionalOnClassÁöÑÂ§ÑÁêÜÈÄªËæë‰∏ÄÊ†∑ÔºåÂè™ÊòØÊù°‰ª∂Áõ∏ÂèçÔºåÂú®Á±ªÂä†ËΩΩÂô®‰∏≠‰∏çÂ≠òÂú®ÂØπÂ∫îÁöÑÁ±ª @ConditionalOnNotWebApplication OnWebApplicationCondition Â∫îÁî®Á®ãÂ∫èÊòØÂê¶ÊòØÈùûWebÁ®ãÂ∫èÔºåÊ≤°ÊúâÊèê‰æõÂ±ûÊÄßÔºåÂè™ÊòØ‰∏Ä‰∏™Ê†áËØÜ„ÄÇ‰ºö‰ªéÂà§Êñ≠WebÁ®ãÂ∫èÁâπÊúâÁöÑÁ±ªÊòØÂê¶Â≠òÂú®ÔºåÁéØÂ¢ÉÊòØÂê¶ÊòØServletÁéØÂ¢ÉÔºåÂÆπÂô®ÊòØÂê¶ÊòØWebÂÆπÂô®Á≠â @ConditionalOnProperty OnPropertyCondition Â∫îÁî®ÁéØÂ¢É‰∏≠ÁöÑÂ±¨ÊÄßÊòØÂê¶Â≠òÂú®„ÄÇÊèê‰æõprefix„ÄÅname„ÄÅhavingValue‰ª•ÂèämatchIfMissingÂ±ûÊÄß„ÄÇprefixË°®Á§∫Â±ûÊÄßÂêçÁöÑÂâçÁºÄÔºånameÊòØÂ±ûÊÄßÂêçÔºåhavingValueÊòØÂÖ∑‰ΩìÁöÑÂ±ûÊÄßÂÄºÔºåmatchIfMissingÊòØ‰∏™booleanÂÄºÔºåÂ¶ÇÊûúÂ±ûÊÄß‰∏çÂ≠òÂú®ÔºåËøô‰∏™matchIfMissing‰∏∫trueÁöÑËØùÔºå‰ºöÁªßÁª≠È™åËØÅ‰∏ãÂéªÔºåÂê¶ÂàôÂ±ûÊÄß‰∏çÂ≠òÂú®ÁöÑËØùÁõ¥Êé•Â∞±Áõ∏ÂΩì‰∫éÂåπÈÖç‰∏çÊàêÂäü @ConditionalOnResource OnResourceCondition ÊòØÂê¶Â≠òÂú®ÊåáÂÆöÁöÑËµÑÊ∫êÊñá‰ª∂„ÄÇÂè™Êúâ‰∏Ä‰∏™Â±ûÊÄßresourcesÔºåÊòØ‰∏™StringÊï∞ÁªÑ„ÄÇ‰ºö‰ªéÁ±ªÂä†ËΩΩÂô®‰∏≠ÂéªÊü•ËØ¢ÂØπÂ∫îÁöÑËµÑÊ∫êÊñá‰ª∂ÊòØÂê¶Â≠òÂú® @ConditionalOnSingleCandidate OnBeanCondition SpringÂÆπÂô®‰∏≠ÊòØÂê¶Â≠òÂú®‰∏îÂè™Â≠òÂú®‰∏Ä‰∏™ÂØπÂ∫îÁöÑÂÆû‰æã„ÄÇÂè™Êúâ3‰∏™Â±ûÊÄßvalue„ÄÅtype„ÄÅsearch„ÄÇË∑üConditionalOnBean‰∏≠ÁöÑËøô3ÁßçÂ±ûÊÄßÂÄºÊÑè‰πâ‰∏ÄÊ†∑ @ConditionalOnWebApplication OnWebApplicationCondition Â∫îÁî®Á®ãÂ∫èÊòØÂê¶ÊòØWebÁ®ãÂ∫èÔºåÊ≤°ÊúâÊèê‰æõÂ±ûÊÄßÔºåÂè™ÊòØ‰∏Ä‰∏™Ê†áËØÜ„ÄÇ‰ºö‰ªéÂà§Êñ≠WebÁ®ãÂ∫èÁâπÊúâÁöÑÁ±ªÊòØÂê¶Â≠òÂú®ÔºåÁéØÂ¢ÉÊòØÂê¶ÊòØServletÁéØÂ¢ÉÔºåÂÆπÂô®ÊòØÂê¶ÊòØWebÂÆπÂô®Á≠â ‰æãÂ≠ê ‰æãÂ≠êÊÑè‰πâ @ConditionalOnBean(javax.sql.DataSource.class) SpringÂÆπÂô®ÊàñËÄÖÊâÄÊúâÁà∂ÂÆπÂô®‰∏≠ÈúÄË¶ÅÂ≠òÂú®Ëá≥Â∞ë‰∏Ä‰∏™javax.sql.DataSourceÁ±ªÁöÑÂÆû‰æã @ConditionalOnClass ({ Configuration.class, FreeMarkerConfigurationFactory.class }) Á±ªÂä†ËΩΩÂô®‰∏≠ÂøÖÈ°ªÂ≠òÂú®ConfigurationÂíåFreeMarkerConfigurationFactoryËøô‰∏§‰∏™Á±ª @ConditionalOnExpression (‚Äú‚Äò${server.host}‚Äô==‚Äôlocalhost‚Äô‚Äù) server.hostÈÖçÁΩÆÈ°πÁöÑÂÄºÈúÄË¶ÅÊòØlocalhost ConditionalOnJava(JavaVersion.EIGHT) JavaÁâàÊú¨Ëá≥Â∞ëÊòØ8 @ConditionalOnMissingBean(value = ErrorController.class, search = SearchStrategy.CURRENT) SpringÂΩìÂâçÂÆπÂô®‰∏≠‰∏çÂ≠òÂú®ErrorControllerÁ±ªÂûãÁöÑbean @ConditionalOnMissingClass (‚ÄúGenericObjectPool‚Äù) Á±ªÂä†ËΩΩÂô®‰∏≠‰∏çËÉΩÂ≠òÂú®GenericObjectPoolËøô‰∏™Á±ª @ConditionalOnNotWebApplication ÂøÖÈ°ªÂú®ÈùûWebÂ∫îÁî®‰∏ãÊâç‰ºöÁîüÊïà @ConditionalOnProperty(prefix = ‚Äúspring.aop‚Äù, name = ‚Äúauto‚Äù, havingValue = ‚Äútrue‚Äù, matchIfMissing = true) Â∫îÁî®Á®ãÂ∫èÁöÑÁéØÂ¢É‰∏≠ÂøÖÈ°ªÊúâspring.aop.autoËøôÈ°πÈÖçÁΩÆÔºå‰∏îÂÆÉÁöÑÂÄºÊòØtrueÊàñËÄÖÁéØÂ¢É‰∏≠‰∏çÂ≠òÂú®spring.aop.autoÈÖçÁΩÆ(matchIfMissing‰∏∫true) @ConditionalOnResource (resources=‚Äùmybatis.xml‚Äù) Á±ªÂä†ËΩΩË∑ØÂæÑ‰∏≠ÂøÖÈ°ªÂ≠òÂú®mybatis.xmlÊñá‰ª∂ @ConditionalOnSingleCandidate (PlatformTransactionManager.class) SpringÂΩìÂâçÊàñÁà∂ÂÆπÂô®‰∏≠ÂøÖÈ°ªÂ≠òÂú®PlatformTransactionManagerËøô‰∏™Á±ªÂûãÁöÑÂÆû‰æãÔºå‰∏îÂè™Êúâ‰∏Ä‰∏™ÂÆû‰æã @ConditionalOnWebApplication ÂøÖÈ°ªÂú®WebÂ∫îÁî®‰∏ãÊâç‰ºöÁîüÊïà SpringBootÊù°‰ª∂Ê≥®Ëß£ÁöÑÊøÄÊ¥ªÊú∫Âà∂ÂàÜÊûêÂÆå‰∫ÜÊù°‰ª∂Ê≥®Ëß£ÁöÑÊâßË°åÈÄªËæë‰πãÂêéÔºåÊé•‰∏ãÊù•ÁöÑÈóÆÈ¢òÂ∞±ÊòØSpringBootÊòØÂ¶Ç‰ΩïËÆ©Ëøô‰∫õÊù°‰ª∂Ê≥®Ëß£ÁîüÊïàÁöÑÔºü SpringBoot‰ΩøÁî®ConditionEvaluatorËøô‰∏™ÂÜÖÈÉ®Á±ªÂÆåÊàêÊù°‰ª∂Ê≥®Ëß£ÁöÑËß£ÊûêÂíåÂà§Êñ≠„ÄÇ Âú®SpringÂÆπÂô®ÁöÑrefreshËøáÁ®ã‰∏≠ÔºåÂè™ÊúâË∑üËß£ÊûêÊàñËÄÖÊ≥®ÂÜåbeanÊúâÂÖ≥Á≥ªÁöÑÁ±ªÈÉΩ‰ºö‰ΩøÁî®ConditionEvaluatorÂÆåÊàêÊù°‰ª∂Ê≥®Ëß£ÁöÑÂà§Êñ≠ÔºåËøô‰∏™ËøáÁ®ã‰∏≠‰∏Ä‰∫õÁ±ª‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑËØùÂ∞±‰ºöË¢´skip„ÄÇËøô‰∫õÁ±ªÊØîÂ¶ÇÊúâAnnotatedBeanDefinitionReader„ÄÅConfigurationClassBeanDefinitionReader„ÄÅConfigurationClassParse„ÄÅClassPathScanningCandidateComponentProviderÁ≠â„ÄÇ ÊØîÂ¶ÇConfigurationClassParserÁöÑÊûÑÈÄ†ÂáΩÊï∞‰ºöÂàùÂßãÂåñÂÜÖÈÉ®Â±ûÊÄßconditionEvaluatorÔºö 1234567891011121314public ConfigurationClassParser(MetadataReaderFactory metadataReaderFactory, ProblemReporter problemReporter, Environment environment, ResourceLoader resourceLoader, BeanNameGenerator componentScanBeanNameGenerator, BeanDefinitionRegistry registry) &#123; this.metadataReaderFactory = metadataReaderFactory; this.problemReporter = problemReporter; this.environment = environment; this.resourceLoader = resourceLoader; this.registry = registry; this.componentScanParser = new ComponentScanAnnotationParser( resourceLoader, environment, componentScanBeanNameGenerator, registry); // ÊûÑÈÄ†ConditionEvaluatorÁî®‰∫éÂ§ÑÁêÜÊù°‰ª∂Ê≥®Ëß£ this.conditionEvaluator = new ConditionEvaluator(registry, environment, resourceLoader);&#125; ConfigurationClassParserÂØπÊØè‰∏™ÈÖçÁΩÆÁ±ªËøõË°åËß£ÊûêÁöÑÊó∂ÂÄôÈÉΩ‰ºö‰ΩøÁî®ConditionEvaluatorÔºö 123if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) &#123; return;&#125; ConditionEvaluatorÁöÑskipÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344public boolean shouldSkip(AnnotatedTypeMetadata metadata, ConfigurationPhase phase) &#123; // Â¶ÇÊûúËøô‰∏™Á±ªÊ≤°ÊúâË¢´@ConditionalÊ≥®Ëß£ÊâÄ‰øÆÈ•∞Ôºå‰∏ç‰ºöskip if (metadata == null || !metadata.isAnnotated(Conditional.class.getName())) &#123; return false; &#125; // Â¶ÇÊûúÂèÇÊï∞‰∏≠Ê≤íÊúâËÆæÁΩÆÊù°‰ª∂Ê≥®Ëß£ÁöÑÁîüÊïàÈò∂ÊÆµ if (phase == null) &#123; // ÊòØÈÖçÁΩÆÁ±ªÁöÑËØùÁõ¥Êé•‰ΩøÁî®PARSE_CONFIGURATIONÈò∂ÊÆµ if (metadata instanceof AnnotationMetadata &amp;&amp; ConfigurationClassUtils.isConfigurationCandidate((AnnotationMetadata) metadata)) &#123; return shouldSkip(metadata, ConfigurationPhase.PARSE_CONFIGURATION); &#125; // Âê¶Âàô‰ΩøÁî®REGISTER_BEANÈò∂ÊÆµ return shouldSkip(metadata, ConfigurationPhase.REGISTER_BEAN); &#125; // Ë¶ÅËß£ÊûêÁöÑÈÖçÁΩÆÁ±ªÁöÑÊù°‰ª∂ÈõÜÂêà List&lt;Condition&gt; conditions = new ArrayList&lt;Condition&gt;(); // Ëé∑ÂèñÈÖçÁΩÆÁ±ªÁöÑÊù°‰ª∂Ê≥®Ëß£ÂæóÂà∞Êù°‰ª∂Êï∞ÊçÆÔºåÂπ∂Ê∑ªÂä†Âà∞ÈõÜÂêà‰∏≠ for (String[] conditionClasses : getConditionClasses(metadata)) &#123; for (String conditionClass : conditionClasses) &#123; Condition condition = getCondition(conditionClass, this.context.getClassLoader()); conditions.add(condition); &#125; &#125; // ÂØπÊù°‰ª∂ÈõÜÂêàÂÅö‰∏™ÊéíÂ∫è AnnotationAwareOrderComparator.sort(conditions); // ÈÅçÂéÜÊù°‰ª∂ÈõÜÂêà for (Condition condition : conditions) &#123; ConfigurationPhase requiredPhase = null; if (condition instanceof ConfigurationCondition) &#123; requiredPhase = ((ConfigurationCondition) condition).getConfigurationPhase(); &#125; // Ê≤°ÊúâËøô‰∏™Ëß£ÊûêÁ±ª‰∏çÈúÄË¶ÅÈò∂ÊÆµÁöÑÂà§Êñ≠ÊàñËÄÖËß£ÊûêÁ±ªÂíåÂèÇÊï∞‰∏≠ÁöÑÈò∂ÊÆµ‰∏ÄËá¥Êâç‰ºöÁªßÁª≠ËøõË°å if (requiredPhase == null || requiredPhase == phase) &#123; // Èò∂ÊÆµ‰∏ÄËá¥Âàá‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑËØùÔºåËøîÂõûtrueÂπ∂Ë∑≥ËøáËøô‰∏™beanÁöÑËß£Êûê if (!condition.matches(this.context, metadata)) &#123; return true; &#125; &#125; &#125; return false;&#125; SpringBootÂú®Êù°‰ª∂Ê≥®Ëß£ÁöÑËß£ÊûêlogËÆ∞ÂΩïÂú®‰∫ÜConditionEvaluationReportÁ±ª‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáBeanFactoryËé∑Âèñ(BeanFactoryÊòØÊúâÁà∂Â≠êÂÖ≥Á≥ªÁöÑÔºõÊØè‰∏™BeanFactoryÈÉΩÂ≠òÊúâ‰∏Ä‰ªΩConditionEvaluationReportÔºå‰∫í‰∏çÁõ∏Âπ≤)Ôºö 12345678910ConditionEvaluationReport conditionEvaluationReport = beanFactory.getBean("autoConfigurationReport", ConditionEvaluationReport.class);Map&lt;String, ConditionEvaluationReport.ConditionAndOutcomes&gt; result = conditionEvaluationReport.getConditionAndOutcomesBySource();for(String key : result.keySet()) &#123; ConditionEvaluationReport.ConditionAndOutcomes conditionAndOutcomes = result.get(key); Iterator&lt;ConditionEvaluationReport.ConditionAndOutcome&gt; iterator = conditionAndOutcomes.iterator(); while(iterator.hasNext()) &#123; ConditionEvaluationReport.ConditionAndOutcome conditionAndOutcome = iterator.next(); System.out.println(key + " -- " + conditionAndOutcome.getCondition().getClass().getSimpleName() + " -- " + conditionAndOutcome.getOutcome()); &#125;&#125; ÊâìÂç∞Âá∫Êù°‰ª∂Ê≥®Ëß£‰∏ãÁöÑÁ±ªÂä†ËΩΩ‰ø°ÊÅØÔºö 12345678.......org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration -- OnClassCondition -- required @ConditionalOnClass classes not found: freemarker.template.Configuration,org.springframework.ui.freemarker.FreeMarkerConfigurationFactoryorg.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration -- OnClassCondition -- required @ConditionalOnClass classes not found: groovy.text.markup.MarkupTemplateEngineorg.springframework.boot.autoconfigure.gson.GsonAutoConfiguration -- OnClassCondition -- required @ConditionalOnClass classes not found: com.google.gson.Gsonorg.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration -- OnClassCondition -- required @ConditionalOnClass classes not found: org.h2.server.web.WebServletorg.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration -- OnClassCondition -- required @ConditionalOnClass classes not found: org.springframework.hateoas.Resource,org.springframework.plugin.core.Pluginorg.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration -- OnClassCondition -- required @ConditionalOnClass classes not found: com.hazelcast.core.HazelcastInstance.......]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DubboÊ∫êÁ†ÅÂàÜÊûê‰πãÊúçÂä°ÂèëÂ∏ÉËøáÁ®ã]]></title>
    <url>%2F2018%2F06%2F24%2FDubbo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8B%E6%9C%8D%E5%8A%A1%E5%8F%91%E5%B8%83%E8%BF%87%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[ÊúçÂä°Á´ØÂèëÂ∏ÉÊµÅÁ®ã Spring ÂØπÂ§ñÁïôÂá∫ÁöÑÊâ©Â±ïdubbo ÊòØÂü∫‰∫é spring ÈÖçÁΩÆÊù•ÂÆûÁé∞ÊúçÂä°ÁöÑÂèëÂ∏ÉÁöÑÔºå‰∏ÄÂÆöÊòØÂü∫‰∫é spring ÁöÑÊâ©Â±ïÊù•ÂÜô‰∫Ü‰∏ÄÂ•óËá™Â∑±ÁöÑÊ†áÁ≠æ„ÄÇÂú® dubbo ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁúãÂà∞ÁöÑ&lt;dubbo:service&gt; ÔºåÂ∞±ÊòØÂ±û‰∫éËá™ÂÆö‰πâÊâ©Â±ïÊ†áÁ≠æË¶ÅÂÆûÁé∞Ëá™ÂÆö‰πâÊâ©Â±ïÔºåÊúâ‰∏â‰∏™Ê≠•È™§(Âú® spring ‰∏≠ÂÆö‰πâ‰∫Ü‰∏§‰∏™Êé•Âè£ÔºåÁî®Êù•ÂÆûÁé∞ Êâ©Â±ï) NamespaceHandler: Ê≥®ÂÜå‰∏ÄÂ†Ü BeanDefinitionParserÔºåÂà©Áî®‰ªñ‰ª¨Êù•ËøõË°åËß£Êûê BeanDefinitionParser:Áî®‰∫éËß£ÊûêÊØè‰∏™elementÁöÑÂÜÖÂÆπ Spring ÈªòËÆ§‰ºöÂä†ËΩΩ jar ÂåÖ‰∏ãÁöÑ META-INF/spring.handlers Êñá‰ª∂ÂØªÊâæÂØπÂ∫îÁöÑ NamespaceHandler„ÄÇ Ëøô‰∏™ÈáåÈù¢‰∏ªË¶ÅÂÅö‰∫Ü‰∏Ä‰ª∂‰∫ãÔºåÊää‰∏çÂêåÁöÑÈÖçÁΩÆÂàÜÂà´ËΩ¨ÂåñÊàê spring ÂÆπÂô®‰∏≠ÁöÑ bean ÂØπË±°application ÂØπÂ∫î ApplicationConfigregistry ÂØπÂ∫î RegistryConfigmonitor ÂØπÂ∫î MonitorConfigprovider ÂØπÂ∫î ProviderConfigconsumer ÂØπÂ∫î ConsumerConfig ‰∏∫‰∫ÜÂú® spring ÂêØÂä®ÁöÑÊó∂ÂÄôÔºå‰πüÁõ∏Â∫îÁöÑÂêØÂä® provider ÂèëÂ∏ÉÊúçÂä°Ê≥®ÂÜåÊúçÂä°ÁöÑ ËøáÁ®ãÔºåËÄåÂêåÊó∂‰∏∫‰∫ÜËÆ©ÂÆ¢Êà∑Á´ØÂú®ÂêØÂä®ÁöÑÊó∂ÂÄôËá™Âä®ËÆ¢ÈòÖÂèëÁé∞ÊúçÂä°ÔºåÂä†ÂÖ•‰∫Ü‰∏§‰∏™ beanServiceBean„ÄÅReferenceBean„ÄÇÂàÜÂà´ÁªßÊâø‰∫Ü ServiceConfig Âíå ReferenceConfigÂêå Êó∂ Ëøò ÂàÜ Âà´ ÂÆû Áé∞ ‰∫Ü InitializingBean „ÄÅ DisposableBean, ApplicationContextAware, ApplicationListener, BeanNameAware InitializingBean Êé•Âè£‰∏∫ bean Êèê‰æõ‰∫ÜÂàùÂßãÂåñÊñπÊ≥ïÁöÑÊñπÂºèÔºåÂÆÉÂè™ÂåÖÊã¨ afterPropertiesSet ÊñπÊ≥ïÔºåÂá°ÊòØÁªßÊâøËØ•Êé•Âè£ÁöÑÁ±ªÔºåÂú®ÂàùÂßãÂåñ bean ÁöÑÊó∂ÂÄô‰ºö ÊâßË°åËØ•ÊñπÊ≥ï„ÄÇDisposableBean bean Ë¢´ÈîÄÊØÅÁöÑÊó∂ÂÄôÔºåspring ÂÆπÂô®‰ºöËá™Âä®ÊâßË°å destory Êñπ Ê≥ïÔºåÊØîÂ¶ÇÈáäÊîæËµÑÊ∫êApplicationContextAware ÂÆûÁé∞‰∫ÜËøô‰∏™Êé•Âè£ÁöÑ beanÔºåÂΩì spring ÂÆπÂô®ÂàùÂßã ÂåñÁöÑÊó∂ÂÄôÔºå‰ºöËá™Âä®ÁöÑÂ∞Ü ApplicationContext Ê≥®ÂÖ•ËøõÊù•ApplicationListener ApplicationEvent ‰∫ã‰ª∂ÁõëÂê¨Ôºåspring ÂÆπÂô®ÂêØÂä®Âêé‰ºöÂèë‰∏Ä‰∏™‰∫ã‰ª∂ÈÄöÁü•BeanNameAware Ëé∑ÂæóËá™Ë∫´ÂàùÂßãÂåñÊó∂ÔºåÊú¨Ë∫´ÁöÑ bean ÁöÑ id Â±ûÊÄß ÈÇ£‰πàÂü∫Êú¨ÁöÑÂÆûÁé∞ÊÄùË∑ØÂèØ‰ª•Êï¥ÁêÜÂá∫Êù•‰∫Ü Âà©Áî® spring ÁöÑËß£ÊûêÊî∂ÈõÜ xml ‰∏≠ÁöÑÈÖçÁΩÆ‰ø°ÊÅØÔºåÁÑ∂ÂêéÊääËøô‰∫õÈÖçÁΩÆ‰ø°ÊÅØÂ≠òÂÇ®Âà∞ serviceConfig ‰∏≠ Ë∞ÉÁî®ServiceConfigÁöÑexportÊñπÊ≥ïÊù•ËøõË°åÊúçÂä°ÁöÑÂèëÂ∏ÉÂíåÊ≥®ÂÜå ÊúçÂä°ÁöÑÂèëÂ∏ÉËøáÁ®ãserviceBean ÊòØÊúçÂä°ÂèëÂ∏ÉÁöÑÂàáÂÖ•ÁÇπÔºåÈÄöËøá afterPropertiesSet ÊñπÊ≥ïÔºåË∞ÉÁî® export()ÊñπÊ≥ïËøõË°åÂèëÂ∏É„ÄÇexport ‰∏∫Áà∂Á±ª ServiceConfig ‰∏≠ÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•Ë∑≥ËΩ¨Âà∞ SeviceConfig Á±ª‰∏≠ÁöÑ export ÊñπÊ≥ï delay‰ΩúÁî® export ÊòØ synchronized ‰øÆÈ•∞ÁöÑÊñπÊ≥ï„ÄÇ‰πüÂ∞±ÊòØËØ¥Êö¥Èú≤ÁöÑËøáÁ®ãÊòØÂéüÂ≠êÊìç‰ΩúÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÂá∫Áé∞ÈîÅÁ´û‰∫âÁöÑÈóÆÈ¢òÔºåÊØïÁ´üÂàùÂßãÂåñËøáÁ®ãÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÈÉΩÊòØ Âçï‰∏ÄÁ∫øÁ®ãÊìç‰ΩúÔºåËøôÈáåËÅîÊÉ≥Âà∞‰∫Ü spring ÁöÑÂàùÂßãÂåñÊµÅÁ®ãÔºå‰πüËøõË°å‰∫ÜÂä†ÈîÅÊìç ‰ΩúÔºåËøôÈáå‰πüÁªôÊàë‰ª¨Âπ≥Êó∂ËÆæËÆ°‰∏Ä‰∏™‰∏çÈîôÁöÑÂêØÁ§∫:ÂàùÂßãÂåñÊµÅÁ®ãÁöÑÊÄßËÉΩË∞É‰ºò‰ºòÂÖàÁ∫ßÂ∫îËØ•ÊØîËæÉ‰ΩéÔºå‰ΩÜÊòØÂÆâÂÖ®ÁöÑ‰ºòÂÖàÁ∫ßÂ∫îËØ•ÊîæÁöÑÊØîËæÉÈ´ò! ÁªßÁª≠ÁúãdoExport()ÊñπÊ≥ï„ÄÇÂêåÊ†∑ÊòØ‰∏ÄÂ†ÜÂàùÂßãÂåñ‰ª£ 12345678910111213141516171819202122232425262728293031public synchronized void export() &#123; if (provider != null) &#123; if (export == null) &#123; export = provider.getExport(); &#125; if (delay == null) &#123; delay = provider.getDelay(); &#125; &#125; if (export != null &amp;&amp; ! export.booleanValue()) &#123; return; &#125; if (delay != null &amp;&amp; delay &gt; 0) &#123; Thread thread = new Thread(new Runnable() &#123; public void run() &#123; try &#123; Thread.sleep(delay); &#125; catch (Throwable e) &#123; &#125; doExport(); &#125; &#125;); thread.setDaemon(true); thread.setName("DelayExportServiceThread"); thread.start(); &#125; else &#123; doExport(); &#125;&#125; ÁªßÁª≠Áúã doExport()ÔºåÊúÄÁªà‰ºöË∞ÉÁî®Âà∞ doExportUrls()‰∏≠:123456private void doExportUrls() &#123; List&lt;URL&gt; registryURLs = loadRegistries(true);//ÊòØ‰∏çÊòØËé∑ÂæóÊ≥®ÂÜå‰∏≠ÂøÉÁöÑÈÖçÁΩÆ for (ProtocolConfig protocolConfig : protocols) &#123; //ÊòØ‰∏çÊòØÊîØÊåÅÂ§öÂçèËÆÆÂèëÂ∏É doExportUrlsFor1Protocol(protocolConfig, registryURLs); &#125;&#125; Ëøô ‰∏™ protocols Èïø Ëøô ‰∏™ Ê†∑ Â≠ê protocols ‰πüÊòØÊ†πÊçÆÈÖçÁΩÆË£ÖÈÖçÂá∫Êù•ÁöÑ„ÄÇÊé•‰∏ã Êù•ËÆ©Êàë‰ª¨ËøõÂÖ• doExportUrlsFor1Protocol ÊñπÊ≥ïÁúãÁúã dubbo ÂÖ∑‰ΩìÊòØÊÄé‰πàÊ†∑ Â∞ÜÊúçÂä°Êö¥Èú≤Âá∫Âéª doExportUrlsFor1Protocol1234567891011121314151617181920212223242526272829303132//Â¶ÇÊûúÈÖçÁΩÆ‰∏çÊòØlocalÂàôÊö¥Èú≤‰∏∫ËøúÁ®ãÊúçÂä°.(ÈÖçÁΩÆ‰∏∫localÔºåÂàôË°®Á§∫Âè™Êö¥Èú≤Êú¨Âú∞ÊúçÂä°)//Ê≥®ÂÜåÊúçÂä°if (! Constants.SCOPE_LOCAL.toString().equalsIgnoreCase(scope) )&#123; if (logger.isInfoEnabled()) &#123; logger.info("Export dubbo service " + interfaceClass.getName() + " to url " + url); &#125; if (registryURLs != null &amp;&amp; registryURLs.size() &gt; 0 &amp;&amp; url.getParameter("register", true)) &#123; for (URL registryURL : registryURLs) &#123;// url = url.addParameterIfAbsent("dynamic", registryURL.getParameter("dynamic")); URL monitorUrl = loadMonitor(registryURL); if (monitorUrl != null) &#123; url = url.addParameterAndEncoded(Constants.MONITOR_KEY, monitorUrl.toFullString()); &#125; if (logger.isInfoEnabled()) &#123; logger.info("Register dubbo service " + interfaceClass.getName() + " url " + url + " to registry " + registryURL); &#125; //ÈÄöËøáproxyFactoryÊù•Ëé∑ÂèñInvokerÂØπË±° Invoker&lt;?&gt; invoker = proxyFactory.getInvoker(ref, (Class)interfaceClass,registryURL.addParameterAndEncoded(Constants.EXPORT_KEY, url.toFullString())); //Ê≥®ÂÜåÊúçÂä° Exporter&lt;?&gt; exporter = protocol.export(invoker); //Â∞ÜexporterÊ∑ªÂä†Âà∞list‰∏≠ exporters.add(exporter); &#125; &#125; else &#123; Invoker&lt;?&gt; invoker = proxyFactory.getInvoker(ref, (Class) interfaceClass, url); Exporter&lt;?&gt; exporter = protocol.export(invoker); exporters.add(exporter); &#125;&#125; doExportUrlsFor1Protocol Êñπ Ê≥ïÔºåÂÖàÂàõÂª∫‰∏§‰∏™ URLÔºåÂàÜÂà´Â¶Ç‰∏ã dubbo://192.168.xx.63:20888/com.gupaoedu.IGHello; registry://192.168.xx ;ÊòØ‰∏çÊòØËßâÂæóËøô‰∏™ URL ÂæàÁúºÁÜüÔºåÊ≤°ÈîôÂú®Ê≥®ÂÜå‰∏≠ÂøÉÁúãÂà∞ÁöÑ services ÁöÑ providers ‰ø°ÊÅØÂ∞±ÊòØËøô‰∏™Âú®‰∏äÈù¢ËøôÊÆµ‰ª£Á†Å‰∏≠ÂèØ‰ª•ÁúãÂà∞ Dubbo ÁöÑÊØîËæÉÊ†∏ÂøÉÁöÑÊäΩË±°:Invoke„ÄÇInvoker ÊòØ‰∏Ä‰∏™‰ª£ÁêÜÁ±ªÔºå‰ªé ProxyFactory ‰∏≠ÁîüÊàê„ÄÇ Ëøô‰∏™Âú∞ÊñπÂèØ‰ª•ÂÅö‰∏Ä‰∏™Â∞èÁªì Invoker - ÊâßË°åÂÖ∑‰ΩìÁöÑËøúÁ®ãË∞ÉÁî® Protocol ‚Äì ÊúçÂä°Âú∞ÂùÄÁöÑÂèëÂ∏ÉÂíåËÆ¢ÈòÖ Exporter ‚Äì Êö¥Èú≤ÊúçÂä°ÊàñÂèñÊ∂àÊö¥Èú≤ protocol.export(invoker)protocol Ëøô‰∏™Âú∞ÊñπÔºåÂÖ∂ÂÆûÂπ∂‰∏çÊòØÁõ¥Êé•Ë∞ÉÁî® DubboProtocol ÂçèËÆÆÁöÑ export, Â§ßÂÆ∂Ë∑üÊàëÁúãÁúã protocol Ëøô‰∏™Â±ûÊÄßÊòØÂú®Âì™ÈáåÂÆû‰æãÂåñÁöÑ?‰ª•ÂèäÂÆû‰æãÂåñÁöÑ‰ª£Á†Å ÊòØ‰ªÄ‰πà?Ëøô‰∏™ Protocol ÂæóÂà∞ÁöÑÂ∫îËØ•ÊòØ‰∏Ä‰∏™ Protocol$Adaptive‰∏Ä‰∏™Ëá™ÈÄÇÂ∫î ÁöÑÈÄÇÈÖçÂô®„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÈÄöËøá protocol.export(invoker),ÂÆûÈôÖ‰∏äË∞ÉÁî®ÁöÑÂ∫îËØ•ÊòØProtocol$Adaptive Ëøô‰∏™Âä®ÊÄÅÁ±ªÁöÑ export ÊñπÊ≥ï„ÄÇ Protocol$AdaptiveÂâçÈù¢ÁöÑExtensionLoaderÊúâËÆ≤ËøáÔºåÈªòËÆ§ÊòØdubbo„ÄÇ ‰∏äÈù¢ËøôÊÆµ‰ª£Á†ÅÂÅö‰∏§‰∏™‰∫ãÊÉÖ ‰ªé url ‰∏≠Ëé∑Âæó protocol ÁöÑÂçèËÆÆÂú∞ÂùÄÔºåÂ¶ÇÊûú protocol ‰∏∫Á©∫ÔºåË°®Á§∫Â∑≤ dubboÂçèËÆÆÂèëÂ∏ÉÊúçÂä°ÔºåÂê¶ÂàôÊ†πÊçÆÈÖçÁΩÆÁöÑÂçèËÆÆÁ±ªÂûãÊù•ÂèëÂ∏ÉÊúçÂä°„ÄÇ Ë∞É Áî®ExtensionLoader.getExtensionLoader(Protocol.class).getExtension(extName);ExtensionLoader.getExtensionLoader(Protocol.class).getExtension(extName); ËøôÊÆµ‰ª£Á†ÅÂÅö‰∫Ü‰ªÄ‰πà‰∫ãÊÉÖÂë¢?ÂâçÈù¢ËøôÊÆµ‰ª£Á†ÅÊàë‰ª¨Â∑≤ÁªèÁêÜËß£‰∫ÜÔºåÈÄöËøáÂ∑•ÂéÇÊ®°Âºè Ëé∑Âæó‰∏Ä‰∏™ ExtensionLoader ÂÆû‰æãÔºåÊàë‰ª¨Êù•ÂàÜÊûê‰∏ã‰∏ã getExtension Ëøô‰∏™ÊñπÊ≥ï„ÄÇgetExtensionËøô‰∏™ÊñπÊ≥ïÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØÁî®Êù•Ëé∑Âèñ ExtensionLoader ÂÆû‰æã‰ª£Ë°®ÁöÑÊâ©Â±ïÁöÑÊåáÂÆö ÂÆûÁé∞ÔºåÂ∑≤Êâ©Â±ïÂÆûÁé∞ÁöÑÂêçÂ≠ó‰Ωú‰∏∫ÂèÇÊï∞„ÄÇ 1234567891011121314151617181920212223242526272829303132 /** * ËøîÂõûÊåáÂÆöÂêçÂ≠óÁöÑÊâ©Â±ï„ÄÇÂ¶ÇÊûúÊåáÂÆöÂêçÂ≠óÁöÑÊâ©Â±ï‰∏çÂ≠òÂú®ÔºåÂàôÊäõÂºÇÂ∏∏ &#123;@link IllegalStateException&#125;. * * @param name * @return */@SuppressWarnings("unchecked")public T getExtension(String name) &#123; if (name == null || name.length() == 0) throw new IllegalArgumentException("Extension name == null"); if ("true".equals(name)) &#123; return getDefaultExtension(); &#125; ////Âà§Êñ≠ÊòØÂê¶Â∑≤ÁªèÁºìÂ≠òËøáËØ•Êâ©Â±ïÁÇπ Holder&lt;Object&gt; holder = cachedInstances.get(name); if (holder == null) &#123; cachedInstances.putIfAbsent(name, new Holder&lt;Object&gt;()); holder = cachedInstances.get(name); &#125; Object instance = holder.get(); if (instance == null) &#123; synchronized (holder) &#123; instance = holder.get(); if (instance == null) &#123; ////createExtension ÔºåÂàõÂª∫Êâ©Â±ïÁÇπ instance = createExtension(name); holder.set(instance); &#125; &#125; &#125; return (T) instance;&#125; createExtension Ê†πÊçÆ name Ëé∑ÂèñÂØπÂ∫îÁöÑ class Ê†πÊçÆclassÂàõÂª∫‰∏Ä‰∏™ÂÆû‰æã ÂØπËé∑ÂèñÁöÑÂÆû‰æãËøõË°å‰æùËµñÊ≥®ÂÖ• ÂØπÂÆû‰æãËøõË°åÂåÖË£ÖÔºåÂàÜÂà´Ë∞ÉÁî®Â∏¶ Protocol ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ÂàõÂª∫ÂÆû‰æãÔºåÁÑ∂ÂêéËøõË°å‰æùËµñÊ≥®ÂÖ•„ÄÇa) Âú® dubbo-rpc-api ÁöÑ resources Ë∑Ø ÂæÑ ‰∏ã Ôºå Êâæ Âà∞com.alibaba.dubbo.rcp.Protocol Êñá‰ª∂‰∏≠ÊúâÂ≠òÂú® filter/listenerb) ÈÅçÂéÜ cachedWrapperClass ÂØπ DubboProtocol ËøõË°åÂåÖË£ÖÔºå‰ºöÈÄöËøáProtocolFilterWrapper„ÄÅProtocolListenerWrapper ÂåÖË£Ö 12345678910111213141516171819202122232425private T createExtension(String name) &#123; Class&lt;?&gt; clazz = getExtensionClasses().get(name);//"dubbo" clazz=DubboProtocol if (clazz == null) &#123; throw findException(name); &#125; try &#123; T instance = (T) EXTENSION_INSTANCES.get(clazz); if (instance == null) &#123; EXTENSION_INSTANCES.putIfAbsent(clazz, (T) clazz.newInstance()); instance = (T) EXTENSION_INSTANCES.get(clazz); &#125; injectExtension(instance); Set&lt;Class&lt;?&gt;&gt; wrapperClasses = cachedWrapperClasses; if (wrapperClasses != null &amp;&amp; wrapperClasses.size() &gt; 0) &#123; for (Class&lt;?&gt; wrapperClass : wrapperClasses) &#123; //// ÂØπÂÆû‰æãËøõË°åÂåÖË£ÖÔºåÂàÜÂà´Ë∞ÉÁî®Â∏¶ Protocol ÂèÇÊï∞ÁöÑÊûÑ ÈÄ†ÂáΩÊï∞ÂàõÂª∫ÂÆû‰æãÔºåÁÑ∂ÂêéËøõË°å‰æùËµñÊ≥®ÂÖ•„ÄÇ instance = injectExtension((T) wrapperClass.getConstructor(type).newInstance(instance)); &#125; &#125; return instance; &#125; catch (Throwable t) &#123; throw new IllegalStateException("Extension instance(name: " + name + ", class: " + type + ") could not be instantiated: " + t.getMessage(), t); &#125;&#125; getExtensionClassesËøô‰∏™ÊñπÊ≥ï‰πãÂâçÂú®ËÆ≤Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÁöÑÊó∂ÂÄôËÆ≤Ëøá‰∫ÜÔºåÂÖ∂ÂÆûÂ∞±ÊòØÂä†ËΩΩÊâ©Â±ïÁÇπÂÆûÁé∞ Á±ª‰∫Ü„ÄÇÁÑ∂ÂêéË∞ÉÁî® loadExtensionClassesÔºåÂéªÂØπÂ∫îÊñá‰ª∂‰∏ãÂéªÂä†ËΩΩÊåáÂÆöÁöÑÊâ©Â±ï ÁÇπ123456789101112131415//Âä†ËΩΩÊâ©Â±ïÁÇπÁöÑÂÆûÁé∞Á±ªprivate Map&lt;String, Class&lt;?&gt;&gt; getExtensionClasses() &#123; Map&lt;String, Class&lt;?&gt;&gt; classes = cachedClasses.get(); if (classes == null) &#123; synchronized (cachedClasses) &#123; classes = cachedClasses.get(); if (classes == null) &#123; classes = loadExtensionClasses(); cachedClasses.set(classes); &#125; &#125; &#125; return classes;&#125; ResigtryProtocolExtensionLoader.getExtensionLoader(Protocol.class).getExtension(extN ame); ÂΩì extName ‰∏∫ registry ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÂÜçÊ¨°ÂéªÈòÖËØªËøôÂùó‰ª£Á†Å ‰∫ÜÔºåÁõ¥Êé•ÂèØ‰ª•Âú®Êâ©Â±ïÁÇπ‰∏≠ÊâæÂà∞Áõ∏Â∫îÁöÑÂÆûÁé∞Êâ©Â±ïÁÇπ[/dubbo-registry- api/src/main/resources/META- INF/dubbo/internal/com.alibaba.dubbo.rpc.Protocol] ÈÖçÁΩÆÂ¶Ç‰∏ãÊâÄ‰ª•ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÆö‰ΩçÂà∞ RegistryProtocolËøô‰∏™Á±ª‰∏≠ÁöÑexportÊñπÊ≥ï 1234567891011121314151617181920212223242526272829303132333435363738public &lt;T&gt; Exporter&lt;T&gt; export(final Invoker&lt;T&gt; originInvoker) throws RpcException &#123; //export invoker Ôºå Êú¨Âú∞ÂèëÂ∏ÉÊúçÂä°ÔºàÂêØÂä®nettyÔºâ final ExporterChangeableWrapper&lt;T&gt; exporter = doLocalExport(originInvoker); //registry provider final Registry registry = getRegistry(originInvoker); final URL registedProviderUrl = getRegistedProviderUrl(originInvoker); registry.register(registedProviderUrl); // ËÆ¢ÈòÖoverrideÊï∞ÊçÆ // FIXME Êèê‰æõËÄÖËÆ¢ÈòÖÊó∂Ôºå‰ºöÂΩ±ÂìçÂêå‰∏ÄJVMÂç≥Êö¥Èú≤ÊúçÂä°ÔºåÂèàÂºïÁî®Âêå‰∏ÄÊúçÂä°ÁöÑÁöÑÂú∫ÊôØÔºåÂõ†‰∏∫subscribed‰ª•ÊúçÂä°Âêç‰∏∫ÁºìÂ≠òÁöÑkeyÔºåÂØºËá¥ËÆ¢ÈòÖ‰ø°ÊÅØË¶ÜÁõñ„ÄÇ final URL overrideSubscribeUrl = getSubscribedOverrideUrl(registedProviderUrl); final OverrideListener overrideSubscribeListener = new OverrideListener(overrideSubscribeUrl); overrideListeners.put(overrideSubscribeUrl, overrideSubscribeListener); registry.subscribe(overrideSubscribeUrl, overrideSubscribeListener); //‰øùËØÅÊØèÊ¨°exportÈÉΩËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑexporterÂÆû‰æã return new Exporter&lt;T&gt;() &#123; public Invoker&lt;T&gt; getInvoker() &#123; return exporter.getInvoker(); &#125; public void unexport() &#123; try &#123; exporter.unexport(); &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; try &#123; registry.unregister(registedProviderUrl); &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; try &#123; overrideListeners.remove(overrideSubscribeUrl); registry.unsubscribe(overrideSubscribeUrl, overrideSubscribeListener); &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; &#125; &#125;;&#125; Êú¨Âú∞ÂÖàÂêØÂä®ÁõëÂê¨ÊúçÂä° 123456789101112131415private &lt;T&gt; ExporterChangeableWrapper&lt;T&gt; doLocalExport(final Invoker&lt;T&gt; originInvoker)&#123; String key = getCacheKey(originInvoker); ExporterChangeableWrapper&lt;T&gt; exporter = (ExporterChangeableWrapper&lt;T&gt;) bounds.get(key); if (exporter == null) &#123; synchronized (bounds) &#123; exporter = (ExporterChangeableWrapper&lt;T&gt;) bounds.get(key); if (exporter == null) &#123; final Invoker&lt;?&gt; invokerDelegete = new InvokerDelegete&lt;T&gt;(originInvoker, getProviderUrl(originInvoker)); exporter = new ExporterChangeableWrapper&lt;T&gt;((Exporter&lt;T&gt;)protocol.export(invokerDelegete), originInvoker); bounds.put(key, exporter); &#125; &#125; &#125; return (ExporterChangeableWrapper&lt;T&gt;) exporter;&#125; ‰∏äÈù¢‰ª£Á†Å‰∏≠Ôºåprotocol‰ª£Á†ÅÊòØÊÄé‰πàËµãÂÄºÁöÑÂë¢ÔºüÊàë‰ª¨ÁúãÁúã‰ª£Á†ÅÔºåÁÜüÊÇâÂêóÔºüÊòØ‰∏Ä‰∏™‰æùËµñÊ≥®ÂÖ•ÁöÑÊâ©Â±ïÁÇπ„ÄÇ‰∏çÁÜüÊÇâÁöÑËØùÔºåÊàë‰ª¨ÂÜçÂõûÊÉ≥‰∏Ä‰∏ãÔºåÂú®Âä†ËΩΩÊâ©Â±ïÁÇπÁöÑÊó∂ÂÄôÔºå Êúâ‰∏Ä‰∏™injectExtensionÊñπÊ≥ïÔºåÈíàÂØπÂ∑≤ÁªèÂä†ËΩΩÁöÑÊâ©Â±ïÁÇπ‰∏≠ÁöÑÊâ©Â±ïÁÇπÂ±ûÊÄßËøõË°å‰æùËµñÊ≥®ÂÖ•„ÄÇÔºàÁâõÈÄºÁöÑ‰ª£Á†ÅÔºâ 12345private Protocol protocol;public void setProtocol(Protocol protocol) &#123; this.protocol = protocol;&#125; Âõ†Ê≠§Êàë‰ª¨Áü•ÈÅìprotocolÊòØ‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÔºåProtocol$AdaptiveÔºåÁÑ∂ÂêéË∞ÉÁî®Ëøô‰∏™Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπ‰∏≠ÁöÑexportÊñπÊ≥ïÔºåËøô‰∏™Êó∂ÂÄô‰º†ÂÖ•ÁöÑÂçèËÆÆÂú∞ÂùÄÂ∫îËØ•ÊòØ dubbo://127.0.0.1/xxxx‚Ä¶ Âõ†Ê≠§Âú®Protocol$Adaptive.exportÊñπÊ≥ï‰∏≠ÔºåExtensionLoader.getExtension(Protocol.class).getExtension(extName)„ÄÇÂ∫îËØ•Â∞±ÊòØProtocolFilterWrapper(ProtocolListenerWrapper(DubboProtocol)))ÔºåÂú®ExtensionLoader‰∏≠‰ºöÊâ´ÊèèÊòØÂê¶ÊúâwrappedClassÔºåÂ∞±ÊòØÂ≠òÂú®ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂèÇÊï∞ÊòØÁà∂Á±ªÊé•Âè£„ÄÇ ËøôÈáåÂπ∂‰∏çÊòØËé∑Âæó‰∏Ä‰∏™ÂçïÁ∫ØÁöÑDubboProtocolÊâ©Â±ïÁÇπÔºåËÄåÊòØ‰ºöÈÄöËøáWrapperÂØπProtocolËøõË°åË£ÖÈ•∞ÔºåË£ÖÈ•∞Âô®ÂàÜÂà´‰∏∫: ProtocolFilterWrapper/ ProtocolListenerWrapper; Ëá≥‰∫éMockProtocol‰∏∫‰ªÄ‰πà‰∏çÂú®Ë£ÖÈ•∞Âô®ÈáåÈù¢Âë¢ÔºüÂ§ßÂÆ∂ÂÜçÂõûÊÉ≥‰∏Ä‰∏ãÊàë‰ª¨Âú®ÁúãExtensionLoader.loadFileËøôÊÆµ‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊúâ‰∏Ä‰∏™Âà§Êñ≠ÔºåË£ÖÈ•∞Âô®ÂøÖÈ°ªË¶ÅÂÖ∑Â§á‰∏Ä‰∏™Â∏¶ÊúâProtocolÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåÂ¶Ç‰∏ã 123456public ProtocolFilterWrapper(Protocol protocol)&#123; if (protocol == null) &#123; throw new IllegalArgumentException("protocol == null"); &#125; this.protocol = protocol;&#125; ÂàÜÊûêProtocolFilterWrapperÂíåProtocolListenerWrapperProtocolFilterWrapperËøô‰∏™Á±ªÈùûÂ∏∏ÈáçË¶ÅÔºådubboÊú∫Âà∂ÈáåÈù¢Êó•ÂøóËÆ∞ÂΩï„ÄÅË∂ÖÊó∂Á≠âÁ≠âÂäüËÉΩÈÉΩÊòØÂú®Ëøô‰∏ÄÈÉ®ÂàÜÂÆûÁé∞ÁöÑ Ëøô‰∏™Á±ªÊúâ3‰∏™ÁâπÁÇπÔºå Á¨¨‰∏ÄÂÆÉÊúâ‰∏Ä‰∏™ÂèÇÊï∞‰∏∫Protocol protocolÁöÑÊûÑÈÄ†ÂáΩÊï∞Ôºõ Á¨¨‰∫åÔºåÂÆÉÂÆûÁé∞‰∫ÜProtocolÊé•Âè£Ôºõ Á¨¨‰∏âÔºåÂÆÉ‰ΩøÁî®Ë¥£‰ªªÈìæÊ®°ÂºèÔºåÂØπexportÂíåreferÂáΩÊï∞ËøõË°å‰∫ÜÂ∞ÅË£Ö„ÄÇÂàÜÂà´‰ΩøÁî®SERVICE_FILTER_KEYÂíåREFERENCE_FILTER_KEYË∞ÉÁî®buildInvokerChainÊñπÊ≥ï„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374public class ProtocolFilterWrapper implements Protocol &#123; private final Protocol protocol; public ProtocolFilterWrapper(Protocol protocol)&#123; if (protocol == null) &#123; throw new IllegalArgumentException("protocol == null"); &#125; this.protocol = protocol; &#125; public int getDefaultPort() &#123; return protocol.getDefaultPort(); &#125; public &lt;T&gt; Exporter&lt;T&gt; export(Invoker&lt;T&gt; invoker) throws RpcException &#123; if (Constants.REGISTRY_PROTOCOL.equals(invoker.getUrl().getProtocol())) &#123; return protocol.export(invoker); &#125; return protocol.export(buildInvokerChain(invoker, Constants.SERVICE_FILTER_KEY, Constants.PROVIDER)); &#125; public &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url) throws RpcException &#123; if (Constants.REGISTRY_PROTOCOL.equals(url.getProtocol())) &#123; return protocol.refer(type, url); &#125; return buildInvokerChain(protocol.refer(type, url), Constants.REFERENCE_FILTER_KEY, Constants.CONSUMER); &#125; public void destroy() &#123; protocol.destroy(); &#125;//buildInvokerChainÂáΩÊï∞ÔºöÂÆÉËØªÂèñÊâÄÊúâÁöÑfilterÁ±ªÔºåÂà©Áî®Ëøô‰∫õÁ±ªÂ∞ÅË£Öinvoker private static &lt;T&gt; Invoker&lt;T&gt; buildInvokerChain(final Invoker&lt;T&gt; invoker, String key, String group) &#123; Invoker&lt;T&gt; last = invoker; List&lt;Filter&gt; filters = ExtensionLoader.getExtensionLoader(Filter.class).getActivateExtension(invoker.getUrl(), key, group); if (filters.size() &gt; 0) &#123; for (int i = filters.size() - 1; i &gt;= 0; i --) &#123; final Filter filter = filters.get(i); final Invoker&lt;T&gt; next = last; last = new Invoker&lt;T&gt;() &#123; public Class&lt;T&gt; getInterface() &#123; return invoker.getInterface(); &#125; public URL getUrl() &#123; return invoker.getUrl(); &#125; public boolean isAvailable() &#123; return invoker.isAvailable(); &#125; public Result invoke(Invocation invocation) throws RpcException &#123; return filter.invoke(next, invocation); &#125; public void destroy() &#123; invoker.destroy(); &#125; @Override public String toString() &#123; return invoker.toString(); &#125; &#125;; &#125; &#125; return last; &#125;&#125; Êàë‰ª¨ÁúãÂ¶Ç‰∏ãÊñá‰ª∂Ôºö /dubbo-rpc-api/src/main/resources/META-INF/dubbo/internal/com.alibaba.dubbo.rpc.Filter ÂÖ∂ÂÆûÂ∞±ÊòØÂØπInvokerÔºåÈÄöËøáÂ¶Ç‰∏ãÁöÑFilterÁªÑË£ÖÊàê‰∏Ä‰∏™Ë¥£‰ªªÈìæ 1234567891011121314echo=com.alibaba.dubbo.rpc.filter.EchoFiltergeneric=com.alibaba.dubbo.rpc.filter.GenericFiltergenericimpl=com.alibaba.dubbo.rpc.filter.GenericImplFiltertoken=com.alibaba.dubbo.rpc.filter.TokenFilteraccesslog=com.alibaba.dubbo.rpc.filter.AccessLogFilteractivelimit=com.alibaba.dubbo.rpc.filter.ActiveLimitFilterclassloader=com.alibaba.dubbo.rpc.filter.ClassLoaderFiltercontext=com.alibaba.dubbo.rpc.filter.ContextFilterconsumercontext=com.alibaba.dubbo.rpc.filter.ConsumerContextFilterexception=com.alibaba.dubbo.rpc.filter.ExceptionFilterexecutelimit=com.alibaba.dubbo.rpc.filter.ExecuteLimitFilterdeprecated=com.alibaba.dubbo.rpc.filter.DeprecatedFiltercompatible=com.alibaba.dubbo.rpc.filter.CompatibleFiltertimeout=com.alibaba.dubbo.rpc.filter.TimeoutFilter ËøôÂÖ∂‰∏≠Ê∂âÂèäÂà∞ÂæàÂ§öÂäüËÉΩÔºåÂåÖÊã¨ÊùÉÈôêÈ™åËØÅ„ÄÅÂºÇÂ∏∏„ÄÅË∂ÖÊó∂Á≠âÁ≠âÔºåÂΩìÁÑ∂ÂèØ‰ª•È¢ÑËÆ°ËÆ°ÁÆóË∞ÉÁî®Êó∂Èó¥Á≠âÁ≠âÂ∫îËØ•‰πüÊòØÂú®ËøôÂÖ∂‰∏≠ÁöÑÊüê‰∏™Á±ªÂÆûÁé∞ÁöÑÔºõ ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞exportÂíåreferËøáÁ®ãÈÉΩ‰ºöË¢´filterËøáÊª§ ProtocolListenerWrapperÂú®ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞exportÂíåreferÂàÜÂà´ÂØπÂ∫î‰∫Ü‰∏çÂêåÁöÑWrapperÔºõexportÊòØÂØπÂ∫îÁöÑListenerExporterWrapper„ÄÇËøôÂùóÊöÇÊó∂ÂÖà‰∏çÂéªÂàÜÊûêÔºåÂõ†‰∏∫Ëøô‰∏™Âú∞ÊñπÂπ∂Ê≤°ÊúâÊèê‰æõÂÆûÁé∞Á±ª„ÄÇ 123456789101112131415161718public &lt;T&gt; Exporter&lt;T&gt; export(Invoker&lt;T&gt; invoker) throws RpcException &#123; if (Constants.REGISTRY_PROTOCOL.equals(invoker.getUrl().getProtocol())) &#123; return protocol.export(invoker); &#125; return new ListenerExporterWrapper&lt;T&gt;(protocol.export(invoker), Collections.unmodifiableList(ExtensionLoader.getExtensionLoader(ExporterListener.class) .getActivateExtension(invoker.getUrl(), Constants.EXPORTER_LISTENER_KEY)));&#125;public &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url) throws RpcException &#123; if (Constants.REGISTRY_PROTOCOL.equals(url.getProtocol())) &#123; return protocol.refer(type, url); &#125; return new ListenerInvokerWrapper&lt;T&gt;(protocol.refer(type, url), Collections.unmodifiableList( ExtensionLoader.getExtensionLoader(InvokerListener.class) .getActivateExtension(url, Constants.INVOKER_LISTENER_KEY)));&#125; DubboProtocol.exportÈÄöËøá‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂàÜÊûêÂÆå‰ª•ÂêéÔºåÊúÄÁªàÊàë‰ª¨ËÉΩÂ§üÂÆö‰ΩçÂà∞DubboProtocol.exportÊñπÊ≥ï„ÄÇÊàë‰ª¨Áúã‰∏Ä‰∏ãdubboProtocolÁöÑexportÊñπÊ≥ïÔºöopenServer(urlÔºâ 123456789101112131415161718192021222324252627public &lt;T&gt; Exporter&lt;T&gt; export(Invoker&lt;T&gt; invoker) throws RpcException &#123; URL url = invoker.getUrl(); // export service. String key = serviceKey(url); DubboExporter&lt;T&gt; exporter = new DubboExporter&lt;T&gt;(invoker, key, exporterMap); exporterMap.put(key, exporter); //export an stub service for dispaching event Boolean isStubSupportEvent = url.getParameter(Constants.STUB_EVENT_KEY,Constants.DEFAULT_STUB_EVENT); Boolean isCallbackservice = url.getParameter(Constants.IS_CALLBACK_SERVICE, false); if (isStubSupportEvent &amp;&amp; !isCallbackservice)&#123; String stubServiceMethods = url.getParameter(Constants.STUB_EVENT_METHODS_KEY); if (stubServiceMethods == null || stubServiceMethods.length() == 0 )&#123; if (logger.isWarnEnabled())&#123; logger.warn(new IllegalStateException("consumer [" +url.getParameter(Constants.INTERFACE_KEY) + "], has set stubproxy support event ,but no stub methods founded.")); &#125; &#125; else &#123; stubServiceMethodsMap.put(url.getServiceKey(), stubServiceMethods); &#125; &#125; //Êö¥Èú≤ÊúçÂä° openServer(url); return exporter;&#125; openServerÂºÄÂêØÊúçÂä° 123456789101112131415private void openServer(URL url) &#123; // find server. String key = url.getAddress();//192.168.11.156Ôºö20880 //client ‰πüÂèØ‰ª•Êö¥Èú≤‰∏Ä‰∏™Âè™ÊúâserverÂèØ‰ª•Ë∞ÉÁî®ÁöÑÊúçÂä°„ÄÇ boolean isServer = url.getParameter(Constants.IS_SERVER_KEY,true); if (isServer) &#123; ExchangeServer server = serverMap.get(key); if (server == null) &#123;//Ê≤°ÊúâÁöÑËØùÂ∞±ÊòØÂàõÂª∫ÊúçÂä° serverMap.put(key, createServer(url)); &#125; else &#123; //serverÊîØÊåÅreset,ÈÖçÂêàoverrideÂäüËÉΩ‰ΩøÁî® server.reset(url); &#125; &#125;&#125; createServerÂàõÂª∫ÊúçÂä°,ÂºÄÂêØÂøÉË∑≥Ê£ÄÊµãÔºåÈªòËÆ§‰ΩøÁî®netty„ÄÇÁªÑË£Öurl 1234567891011121314151617181920212223242526private ExchangeServer createServer(URL url) &#123; //ÈªòËÆ§ÂºÄÂêØserverÂÖ≥Èó≠Êó∂ÂèëÈÄÅreadonly‰∫ã‰ª∂ url = url.addParameterIfAbsent(Constants.CHANNEL_READONLYEVENT_SENT_KEY, Boolean.TRUE.toString()); //ÈªòËÆ§ÂºÄÂêØheartbeat url = url.addParameterIfAbsent(Constants.HEARTBEAT_KEY, String.valueOf(Constants.DEFAULT_HEARTBEAT)); String str = url.getParameter(Constants.SERVER_KEY, Constants.DEFAULT_REMOTING_SERVER); if (str != null &amp;&amp; str.length() &gt; 0 &amp;&amp; ! ExtensionLoader.getExtensionLoader(Transporter.class).hasExtension(str)) throw new RpcException("Unsupported server type: " + str + ", url: " + url); url = url.addParameter(Constants.CODEC_KEY, Version.isCompatibleVersion() ? COMPATIBLE_CODEC_NAME : DubboCodec.NAME); ExchangeServer server; try &#123; server = Exchangers.bind(url, requestHandler); &#125; catch (RemotingException e) &#123; throw new RpcException("Fail to start server(url: " + url + ") " + e.getMessage(), e); &#125; str = url.getParameter(Constants.CLIENT_KEY); if (str != null &amp;&amp; str.length() &gt; 0) &#123; Set&lt;String&gt; supportedTypes = ExtensionLoader.getExtensionLoader(Transporter.class).getSupportedExtensions(); if (!supportedTypes.contains(str)) &#123; throw new RpcException("Unsupported client type: " + str); &#125; &#125; return server;&#125; Exchangers.bind12345678910public static ExchangeServer bind(URL url, ExchangeHandler handler) throws RemotingException &#123; if (url == null) &#123; throw new IllegalArgumentException("url == null"); &#125; if (handler == null) &#123; throw new IllegalArgumentException("handler == null"); &#125; url = url.addParameterIfAbsent(Constants.CODEC_KEY, "exchange"); return getExchanger(url).bind(url, handler);&#125; ÈÄöËøáExtensionLoaderËé∑ÂæóÊåáÂÆöÁöÑÊâ©Â±ïÁÇπÔºåtypeÈªòËÆ§‰∏∫header 123456789public static Exchanger getExchanger(URL url) &#123; //url‰∏≠Ëé∑Âæóexchanger, ÈªòËÆ§‰∏∫header String type = url.getParameter(Constants.EXCHANGER_KEY, Constants.DEFAULT_EXCHANGER); return getExchanger(type);&#125;public static Exchanger getExchanger(String type) &#123; return ExtensionLoader.getExtensionLoader(Exchanger.class).getExtension(type);&#125; HeaderExchanger.bindË∞ÉÁî®headerExchangerÁöÑbindÊñπÊ≥ï 123public ExchangeServer bind(URL url, ExchangeHandler handler) throws RemotingException &#123; return new HeaderExchangeServer(Transporters.bind(url, new DecodeHandler(new HeaderExchangeHandler(handler))));&#125; ÈÄöËøátransporter.bindÊù•ËøõË°åÁªëÂÆö„ÄÇ 123456789101112131415public static Server bind(URL url, ChannelHandler... handlers) throws RemotingException &#123; if (url == null) &#123; throw new IllegalArgumentException("url == null"); &#125; if (handlers == null || handlers.length == 0) &#123; throw new IllegalArgumentException("handlers == null"); &#125; ChannelHandler handler; if (handlers.length == 1) &#123; handler = handlers[0]; &#125; else &#123; handler = new ChannelHandlerDispatcher(handlers); &#125; return getTransporter().bind(url, handler);&#125; NettyTransport.bindÈÄöËøáNettyTranportÂàõÂª∫Âü∫‰∫éNettyÁöÑserverÊúçÂä° 123public Server bind(URL url, ChannelHandler listener) throws RemotingException &#123; return new NettyServer(url, listener);&#125; new HeaderExchangeServerÂú®Ë∞ÉÁî®HeaderExchanger.bindÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÊòØÂÖànew‰∏Ä‰∏™HeaderExchangeServer. Ëøô‰∏™serverÊòØÂπ≤ÂòõÂë¢Ôºü ÊòØÂØπÂΩìÂâçËøô‰∏™ËøûÊé•ÂéªÂª∫Á´ãÂøÉË∑≥Êú∫Âà∂ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class HeaderExchangeServer implements ExchangeServer &#123; private final ScheduledExecutorService scheduled = Executors. newScheduledThreadPool(1,new NamedThreadFactory( "dubbo-remoting-server-heartbeat", true)); // ÂøÉË∑≥ÂÆöÊó∂Âô® private ScheduledFuture&lt;?&gt; heatbeatTimer; // ÂøÉË∑≥Ë∂ÖÊó∂ÔºåÊØ´Áßí„ÄÇÁº∫ÁúÅ0Ôºå‰∏ç‰ºöÊâßË°åÂøÉË∑≥„ÄÇ private int heartbeat; private int heartbeatTimeout; private final Server server; private volatile boolean closed = false; public HeaderExchangeServer(Server server) &#123; //..Â±ûÊÄßËµãÂÄº //ÂøÉË∑≥ startHeatbeatTimer(); &#125; private void startHeatbeatTimer() &#123; //ÂÖ≥Èó≠ÂøÉË∑≥ÂÆöÊó∂ stopHeartbeatTimer(); if (heartbeat &gt; 0) &#123; //ÊØèÈöîheartbeatÊó∂Èó¥ÊâßË°å‰∏ÄÊ¨° heatbeatTimer = scheduled.scheduleWithFixedDelay( new HeartBeatTask( new HeartBeatTask.ChannelProvider() &#123; //Ëé∑Âèñchannels public Collection&lt;Channel&gt; getChannels() &#123; return Collections.unmodifiableCollection( HeaderExchangeServer.this.getChannels() ); &#125; &#125;, heartbeat, heartbeatTimeout), heartbeat, heartbeat,TimeUnit.MILLISECONDS); &#125; &#125; //ÂÖ≥Èó≠ÂøÉË∑≥ÂÆöÊó∂ private void stopHeartbeatTimer() &#123; try &#123; ScheduledFuture&lt;?&gt; timer = heatbeatTimer; if (timer != null &amp;&amp; ! timer.isCancelled()) &#123; timer.cancel(true); &#125; &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; finally &#123; heatbeatTimer =null; &#125; &#125; ÊúçÂä°Ê≥®ÂÜåÁöÑËøáÁ®ãÂâçÈù¢ÔºåÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅìÔºåÂü∫‰∫éspringËøô‰∏™Ëß£ÊûêÂÖ•Âè£ÔºåÂà∞ÂèëÂ∏ÉÊúçÂä°ÁöÑËøáÁ®ãÔºåÊé•ÁùÄÂü∫‰∫éDubboProtocolÂéªÂèëÂ∏ÉÔºåÊúÄÁªàË∞ÉÁî®NettyÁöÑapiÂàõÂª∫‰∫Ü‰∏Ä‰∏™NettyServer„ÄÇ ÈÇ£‰πàÁªßÁª≠Ê≤øÁùÄRegistryProtocol.exportËøô‰∏™ÊñπÊ≥ïÔºåÊù•ÁúãÁúãÊ≥®ÂÜåÊúçÂä°ÁöÑ‰ª£Á†Å RegistryProtocol.export1234567891011121314151617181920212223242526272829303132333435363738public &lt;T&gt; Exporter&lt;T&gt; export(final Invoker&lt;T&gt; originInvoker) throws RpcException &#123; //export invokerÈÄöËøáDubboProtocalÂèëÂ∏ÉÊú¨Âú∞ÊúçÂä° final ExporterChangeableWrapper&lt;T&gt; exporter = doLocalExport(originInvoker); //registry provider Ëøô‰∏™ÊñπÊ≥ïÊòØinvokerÁöÑÂú∞ÂùÄËé∑ÂèñregistryÂÆû‰æã final Registry registry = getRegistry(originInvoker); final URL registedProviderUrl = getRegistedProviderUrl(originInvoker); registry.register(registedProviderUrl); // ËÆ¢ÈòÖoverrideÊï∞ÊçÆ // FIXME Êèê‰æõËÄÖËÆ¢ÈòÖÊó∂Ôºå‰ºöÂΩ±ÂìçÂêå‰∏ÄJVMÂç≥Êö¥Èú≤ÊúçÂä°ÔºåÂèàÂºïÁî®Âêå‰∏ÄÊúçÂä°ÁöÑÁöÑÂú∫ÊôØÔºåÂõ†‰∏∫subscribed‰ª•ÊúçÂä°Âêç‰∏∫ÁºìÂ≠òÁöÑkeyÔºåÂØºËá¥ËÆ¢ÈòÖ‰ø°ÊÅØË¶ÜÁõñ„ÄÇ final URL overrideSubscribeUrl = getSubscribedOverrideUrl(registedProviderUrl); final OverrideListener overrideSubscribeListener = new OverrideListener(overrideSubscribeUrl); overrideListeners.put(overrideSubscribeUrl, overrideSubscribeListener); registry.subscribe(overrideSubscribeUrl, overrideSubscribeListener); //‰øùËØÅÊØèÊ¨°exportÈÉΩËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑexporterÂÆû‰æã return new Exporter&lt;T&gt;() &#123; public Invoker&lt;T&gt; getInvoker() &#123; return exporter.getInvoker(); &#125; public void unexport() &#123; try &#123; exporter.unexport(); &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; try &#123; registry.unregister(registedProviderUrl); &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; try &#123; overrideListeners.remove(overrideSubscribeUrl); registry.unsubscribe(overrideSubscribeUrl, overrideSubscribeListener); &#125; catch (Throwable t) &#123; logger.warn(t.getMessage(), t); &#125; &#125; &#125;;&#125; getRegistryËøô‰∏™ÊñπÊ≥ïÊòØinvokerÁöÑÂú∞ÂùÄËé∑ÂèñregistryÂÆû‰æã registry://192.168.11.156Ôºö2181ÁöÑÂçèËÆÆÂú∞ÂùÄ , registryUrlÂ∞±‰ºöÂèòÊàê‰∫Üzookeeper://192.168.11.156 12345678910111213141516/** * Ê†πÊçÆinvokerÁöÑÂú∞ÂùÄËé∑ÂèñregistryÂÆû‰æã * @param originInvoker * @return */private Registry getRegistry(final Invoker&lt;?&gt; originInvoker)&#123; URL registryUrl = originInvoker.getUrl(); //Ëé∑Âæóregistry://192.168.11.156Ôºö2181ÁöÑÂçèËÆÆÂú∞ÂùÄ if (Constants.REGISTRY_PROTOCOL.equals(registryUrl.getProtocol())) &#123;//ÂæóÂà∞zookeeperÁöÑÂçèËÆÆÂú∞ÂùÄ String protocol = registryUrl.getParameter(Constants.REGISTRY_KEY, Constants.DEFAULT_DIRECTORY); //registryUrlÂ∞±‰ºöÂèòÊàê‰∫Üzookeeper://192.168.11.156registryUrl = registryUrl.setProtocol(protocol).removeParameter(Constants.REGISTRY_KEY); &#125;//registryFactoryÊòØ‰ªÄ‰πàÔºü return registryFactory.getRegistry(registryUrl);&#125; registryFactory.getRegistryËøôÊÆµ‰ª£Á†ÅÂæàÊòéÊòæ‰∫ÜÔºåÈÄöËøáÂâçÈù¢ËøôÊÆµ‰ª£Á†ÅÁöÑÂàÜÊûêÔºåÂÖ∂ÂÆûÂ∞±ÊòØÊääregistryÁöÑÂçèËÆÆÂ§¥ÊîπÊàêÊúçÂä°Êèê‰æõËÄÖÈÖçÁΩÆÁöÑÂçèËÆÆÂú∞ÂùÄÔºå‰πüÂ∞±ÊòØÊàë‰ª¨ÈÖçÁΩÆÁöÑ ÁÑ∂ÂêéregistryFactory.getRegistryÁöÑÁõÆÁöÑÔºåÂ∞±ÊòØÈÄöËøáÂçèËÆÆÂú∞ÂùÄÂåπÈÖçÂà∞ÂØπÂ∫îÁöÑÊ≥®ÂÜå‰∏≠ÂøÉ„ÄÇÈÇ£registryFactoryÊòØ‰∏Ä‰∏™‰ªÄ‰πàÊ†∑ÁöÑÂØπË±°Âë¢ÔºüÔºåÊàë‰ª¨Êâæ‰∏Ä‰∏ãËøô‰∏™‰ª£Á†ÅÁöÑÂÆö‰πâ 12345private RegistryFactory registryFactory;public void setRegistryFactory(RegistryFactory registryFactory) &#123; this.registryFactory = registryFactory;&#125; Ëøô‰∏™‰ª£Á†ÅÊúâÁÇπÁúºÁÜüÔºåÂÜçÊù•ÁúãÁúãRegistryFactoryËøô‰∏™Á±ªÁöÑÂÆö‰πâÔºåÊàëÁåúÊÉ≥‰∏ÄÂÆöÊòØ‰∏Ä‰∏™Êâ©Â±ïÁÇπÔºå‰∏ç‰ø°ÔºåÂí±‰ª¨Áúã Âπ∂‰∏îÔºåÂ§ßÂÆ∂ËøòË¶ÅÊ≥®ÊÑèËøôÈáåÈù¢ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ï‰∏äÔºåÊúâ‰∏Ä‰∏™@AdaptiveÁöÑÊ≥®Ëß£ÔºåËØ¥Êòé‰ªÄ‰πàÔºü Ëøô‰∏™ÊòØ‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπ„ÄÇÊåâÁÖßÊàë‰ª¨‰πãÂâçÁúãËøá‰ª£Á†ÅÔºåËá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÂä†Âú®ÊñπÊ≥ï Â±ÇÈù¢‰∏äÔºåË°®Á§∫‰ºöÂä®ÊÄÅÁîüÊàê‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÁöÑÈÄÇÈÖçÂô®„ÄÇÊâÄ‰ª•Ëøô‰∏™Ëá™ÈÄÇÂ∫îÈÄÇÈÖçÂô®Â∫îËØ•ÊòØRegistryFactory$Adaptive 12345@SPI("dubbo")public interface RegistryFactory &#123; @Adaptive(&#123;"protocol"&#125;) Registry getRegistry(URL url);&#125; 123456789101112131415public class RegistryFactory$Adaptive implements com.alibaba.dubbo.registry.RegistryFactory &#123; public com.alibaba.dubbo.registry.Registry getRegistry(com.alibaba.dubbo.common.URL arg0) &#123; if (arg0 == null) throw new IllegalArgumentException("url == null"); com.alibaba.dubbo.common.URL url = arg0; String extName = (url.getProtocol() == null ? "dubbo" : url.getProtocol()); if (extName == null) throw new IllegalStateException("Fail to get extension(com.alibaba.dubbo.registry.RegistryFactory) " + "name from url(" + url.toString() + ") use keys([protocol])"); com.alibaba.dubbo.registry.RegistryFactory extension = (com.alibaba.dubbo.registry.RegistryFactory) ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.registry.RegistryFactory.class). getExtension(extName); return extension.getRegistry(arg0); &#125;&#125; ZookeeperRegistryFactoryËøô‰∏™ÊñπÊ≥ï‰∏≠Âπ∂Ê≤°ÊúâgetRegistryÊñπÊ≥ïÔºåËÄåÊòØÂú®Áà∂Á±ªAbstractRegistryFactory ‰ªéÁºìÂ≠òREGISTRIES‰∏≠ÔºåÊ†πÊçÆkeyËé∑ÂæóÂØπÂ∫îÁöÑRegistry Â¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàôÂàõÂª∫Registry 1234567891011121314151617181920212223public Registry getRegistry(URL url) &#123; url = url.setPath(RegistryService.class.getName()) .addParameter(Constants.INTERFACE_KEY, RegistryService.class.getName()) .removeParameters(Constants.EXPORT_KEY, Constants.REFER_KEY); String key = url.toServiceString(); // ÈîÅÂÆöÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñËøáÁ®ãÔºå‰øùËØÅÊ≥®ÂÜå‰∏≠ÂøÉÂçï‰∏ÄÂÆû‰æã LOCK.lock(); try &#123; Registry registry = REGISTRIES.get(key); if (registry != null) &#123; return registry; &#125; registry = createRegistry(url); if (registry == null) &#123; throw new IllegalStateException("Can not create registry " + url); &#125; REGISTRIES.put(key, registry); return registry; &#125; finally &#123; // ÈáäÊîæÈîÅ LOCK.unlock(); &#125;&#125; createRegistryÂàõÂª∫‰∏Ä‰∏™Ê≥®ÂÜå‰∏≠ÂøÉÔºåËøô‰∏™ÊòØ‰∏Ä‰∏™ÊäΩË±°ÊñπÊ≥ïÔºåÂÖ∑‰ΩìÁöÑÂÆûÁé∞Âú®ÂØπÂ∫îÁöÑÂ≠êÁ±ªÂÆû‰æã‰∏≠ÂÆûÁé∞ÁöÑÔºåÂú®ZookeeperRegistryFactory‰∏≠ 123456789101112131415161718192021222324252627public Registry createRegistry(URL url) &#123; return new ZookeeperRegistry(url, zookeeperTransporter);&#125;//ÈÄöËøázkClientÔºåËé∑Âæó‰∏Ä‰∏™zookeeperÁöÑËøûÊé•ÂÆû‰æãpublic ZookeeperRegistry(URL url, ZookeeperTransporter zookeeperTransporter) &#123; super(url); if (url.isAnyHost()) &#123; throw new IllegalStateException("registry address == null"); &#125; String group = url.getParameter(Constants.GROUP_KEY, DEFAULT_ROOT); if (! group.startsWith(Constants.PATH_SEPARATOR)) &#123; group = Constants.PATH_SEPARATOR + group; &#125; this.root = group; //ËÆæÁΩÆÊ†πËäÇÁÇπ zkClient = zookeeperTransporter.connect(url);//Âª∫Á´ãËøûÊé• zkClient.addStateListener(new StateListener() &#123; public void stateChanged(int state) &#123; if (state == RECONNECTED) &#123; try &#123; recover(); &#125; catch (Exception e) &#123; logger.error(e.getMessage(), e); &#125; &#125;);&#125; ‰ª£Á†ÅÂàÜÊûêÂà∞ËøôÈáåÔºåÊàë‰ª¨ÂØπ‰∫égetRegistryÂæóÂá∫‰∫Ü‰∏Ä‰∏™ÁªìËÆ∫ÔºåÊ†πÊçÆÂΩìÂâçÊ≥®ÂÜå‰∏≠ÂøÉÁöÑÈÖçÁΩÆ‰ø°ÊÅØÔºåËé∑Âæó‰∏Ä‰∏™ÂåπÈÖçÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÔºå‰πüÂ∞±ÊòØZookeeperRegistry registry.register(registedProviderUrl);ZookeeperRegistry extends FailbackRegistry ÁªßÁª≠ÂæÄ‰∏ãÂàÜÊûêÔºå‰ºöË∞ÉÁî®registry.registerÂéªÂ∞Üdubbo://ÁöÑÂçèËÆÆÂú∞ÂùÄÊ≥®ÂÜåÂà∞zookeeper‰∏ä Ëøô‰∏™ÊñπÊ≥ï‰ºöË∞ÉÁî®FailbackRegistryÁ±ª‰∏≠ÁöÑregister. ‰∏∫‰ªÄ‰πàÂë¢ÔºüÂõ†‰∏∫ZookeeperRegistryËøô‰∏™Á±ª‰∏≠Âπ∂Ê≤°ÊúâregisterËøô‰∏™ÊñπÊ≥ïÔºå‰ΩÜÊòØ‰ªñÁöÑÁà∂Á±ªFailbackRegistry‰∏≠Â≠òÂú®registerÊñπÊ≥ïÔºåËÄåËøô‰∏™Á±ªÂèàÈáçÂÜô‰∫ÜAbstractRegistryÁ±ª‰∏≠ÁöÑregisterÊñπÊ≥ï„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÂÆö‰ΩçFailbackRegistryËøô‰∏™Á±ª‰∏≠ÁöÑregisterÊñπÊ≥ï‰∏≠ FailbackRegistry.register FailbackRegistryÔºå‰ªéÂêçÂ≠ó‰∏äÊù•ÁúãÔºåÊòØ‰∏Ä‰∏™Â§±Ë¥•ÈáçËØïÊú∫Âà∂ Ë∞ÉÁî®Áà∂Á±ªÁöÑregisterÊñπÊ≥ïÔºåËÆ≤ÂΩìÂâçurlÊ∑ªÂä†Âà∞ÁºìÂ≠òÈõÜÂêà‰∏≠ Ë∞ÉÁî®doRegisterÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÂæàÊòéÊòæÔºåÊòØ‰∏Ä‰∏™ÊäΩË±°ÊñπÊ≥ïÔºå‰ºöÁî±ZookeeperRegistryÂ≠êÁ±ªÂÆûÁé∞„ÄÇ 12345678910111213141516171819202122232425262728@Overridepublic void register(URL url) &#123; super.register(url); failedRegistered.remove(url); failedUnregistered.remove(url); try &#123; // ÂêëÊúçÂä°Âô®Á´ØÂèëÈÄÅÊ≥®ÂÜåËØ∑Ê±Ç doRegister(url); &#125; catch (Exception e) &#123; Throwable t = e; // Â¶ÇÊûúÂºÄÂêØ‰∫ÜÂêØÂä®Êó∂Ê£ÄÊµãÔºåÂàôÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏ boolean check = getUrl().getParameter(Constants.CHECK_KEY, true) &amp;&amp; url.getParameter(Constants.CHECK_KEY, true) &amp;&amp; ! Constants.CONSUMER_PROTOCOL.equals(url.getProtocol()); boolean skipFailback = t instanceof SkipFailbackWrapperException; if (check || skipFailback) &#123; if(skipFailback) &#123; t = t.getCause(); &#125; throw new IllegalStateException("Failed to register " + url + " to registry " + getUrl().getAddress() + ", cause: " + t.getMessage(), t); &#125; else &#123; logger.error("Failed to register " + url + ", waiting for retry, cause: " + t.getMessage(), t); &#125; // Â∞ÜÂ§±Ë¥•ÁöÑÊ≥®ÂÜåËØ∑Ê±ÇËÆ∞ÂΩïÂà∞Â§±Ë¥•ÂàóË°®ÔºåÂÆöÊó∂ÈáçËØï failedRegistered.add(url); &#125;&#125; 1234567protected void doRegister(URL url) &#123; try &#123; zkClient.create(toUrlPath(url), url.getParameter(Constants.DYNAMIC_KEY, true)); &#125; catch (Throwable e) &#123; throw new RpcException("Failed to register " + url + " to zookeeper " + getUrl() + ", cause: " + e.getMessage(), e); &#125;&#125; RegistryProtocol.export Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÂêéÁª≠ÁöÑ‰ª£Á†ÅÂ∞±‰∏çÁî®ÂÜçÂàÜÊûê‰∫Ü„ÄÇÂ∞±ÊòØÂéªÂØπÊúçÂä°Êèê‰æõÁ´ØÂéªÊ≥®ÂÜå‰∏Ä‰∏™zookeeperÁõëÂê¨ÔºåÂΩìÁõëÂê¨ÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄôÔºåÊúçÂä°Á´ØÂÅöÁõ∏Â∫îÁöÑÂ§ÑÁêÜ„ÄÇ Ê∂àË¥πÁ´ØÂêØÂä®ÂàùÂßãÂåñËøáÁ®ãÊ∂àË¥πÁ´ØÁöÑ‰ª£Á†ÅËß£ÊûêÊòØ‰ªé‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÂºÄÂßãÁöÑ 1ReferenceBean(afterPropertiesSet) -&gt;getObject() -&gt;get()-&gt;init()-&gt;createProxy ÊúÄÁªà‰ºöËé∑Âæó‰∏Ä‰∏™‰ª£ÁêÜÂØπË±°„ÄÇ createProxyÁ¨¨375Ë°åÂâçÈù¢ÂæàÂ§ö‰ª£Á†ÅÈÉΩÊòØÂàùÂßãÂåñÁöÑÂä®‰ΩúÔºåÈúÄË¶Å‰ªîÁªÜÂàÜÊûêÁöÑ‰ª£Á†Å‰ª£Á†Å‰ªécreateProxyÁ¨¨375Ë°åÂºÄÂßã 1234567891011121314151617181920212223242526272829303132List&lt;URL&gt; us = loadRegistries(false); //‰ªéÊ≥®ÂÜå‰∏≠ÂøÉ‰∏äËé∑ÂæóÁõ∏Â∫îÁöÑÂçèËÆÆurlÂú∞ÂùÄif (us != null &amp;&amp; us.size() &gt; 0) &#123; for (URL u : us) &#123; URL monitorUrl = loadMonitor(u); if (monitorUrl != null) &#123; map.put(Constants.MONITOR_KEY, URL.encode(monitorUrl.toFullString())); &#125; urls.add(u.addParameterAndEncoded(Constants.REFER_KEY, StringUtils.toQueryString(map))); &#125;&#125;if (urls == null || urls.size() == 0) &#123; throw new IllegalStateException("No such any registry to reference " + interfaceName + " on the consumer " + NetUtils.getLocalHost() + " use dubbo version " + Version.getVersion() + ", please config &lt;dubbo:registry address=\"...\" /&gt; to your spring config."); &#125;if (urls.size() == 1) &#123; invoker = refprotocol.refer(interfaceClass, urls.get(0)); //Ëé∑Âæóinvoker‰ª£ÁêÜÂØπË±°&#125; else &#123; List&lt;Invoker&lt;?&gt;&gt; invokers = new ArrayList&lt;Invoker&lt;?&gt;&gt;(); URL registryURL = null; for (URL url : urls) &#123; invokers.add(refprotocol.refer(interfaceClass, url)); if (Constants.REGISTRY_PROTOCOL.equals(url.getProtocol())) &#123; registryURL = url; // Áî®‰∫ÜÊúÄÂêé‰∏Ä‰∏™registry url &#125; &#125; if (registryURL != null) &#123; // Êúâ Ê≥®ÂÜå‰∏≠ÂøÉÂçèËÆÆÁöÑURL // ÂØπÊúâÊ≥®ÂÜå‰∏≠ÂøÉÁöÑCluster Âè™Áî® AvailableCluster URL u = registryURL.addParameter(Constants.CLUSTER_KEY, AvailableCluster.NAME); invoker = cluster.join(new StaticDirectory(u, invokers)); &#125; else &#123; // ‰∏çÊòØ Ê≥®ÂÜå‰∏≠ÂøÉÁöÑURL invoker = cluster.join(new StaticDirectory(invokers)); &#125;&#125; refprotocol.refer‚Äã invokers.add(refprotocol.refer(interfaceClass, url)); Ë∞ÉÁî®protocolÁöÑreferÊñπÊ≥ïÔºåÂæóÂà∞invokerÔºå ‰º†ÈÄíËøõÊù•ÁöÑÂèÇÊï∞urlÔºåÂçèËÆÆÂú∞ÂùÄ‰∏∫registry://„ÄÇ refprotocolËøô‰∏™ÂØπË±°ÔºåÂÆö‰πâÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÊòØ‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÔºåÂæóÂà∞ÁöÑÊòØProtocol$Adaptive ReferenceConfig‰∏≠refprotocolÁöÑÂÆö‰πâÂ¶Ç‰∏ã 1private static final Protocol refprotocol = ExtensionLoader.getExtensionLoader(Protocol.class).getAdaptiveExtension(); ÊâÄ‰ª•ÊúÄÁªàË∞ÉÁî®RegistryProtocol.refer‰ª£Á†Å RegistryProtocol.referËøô‰∏™ÊñπÊ≥ïÈáåÈù¢ÁöÑ‰ª£Á†ÅÔºåÂü∫Êú¨‰∏äÈÉΩËÉΩÁúãÊáÇ1.Ê†πÊçÆÊ†πÊçÆurlËé∑ÂæóÊ≥®ÂÜå‰∏≠ÂøÉÔºåËøô‰∏™registryÊòØzookeeperRegistry2.Ë∞ÉÁî®doReferÔºåÊåâÊñπÊ≥ïÔºå‰º†ÈÄí‰∫ÜÂá†‰∏™ÂèÇÊï∞Ôºå ÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™culsterÂèÇÊï∞ÔºåËøô‰∏™ÈúÄË¶ÅÊ≥®ÊÑè‰∏ã 123456789101112131415161718192021222324252627282930313233public &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url) throws RpcException &#123; url = url.setProtocol(url.getParameter(Constants.REGISTRY_KEY, Constants.DEFAULT_REGISTRY)).removeParameter(Constants.REGISTRY_KEY); Registry registry = registryFactory.getRegistry(url); if (RegistryService.class.equals(type)) &#123; return proxyFactory.getInvoker((T) registry, type, url); &#125; // group="a,b" or group="*" Map&lt;String, String&gt; qs = StringUtils.parseQueryString(url.getParameterAndDecoded(Constants.REFER_KEY)); String group = qs.get(Constants.GROUP_KEY); if (group != null &amp;&amp; group.length() &gt; 0 ) &#123; if ( ( Constants.COMMA_SPLIT_PATTERN.split( group ) ).length &gt; 1 || "*".equals( group ) ) &#123; return doRefer( getMergeableCluster(), registry, type, url ); &#125; &#125; return doRefer(cluster, registry, type, url); &#125; clusterdoReferÊñπÊ≥ï‰∏≠Êúâ‰∏Ä‰∏™ÂèÇÊï∞ÊòØcluster,Êàë‰ª¨ÊâæÂà∞ÂÆÉÁöÑÂÆö‰πâ‰ª£Á†ÅÂ¶Ç‰∏ãÔºå„ÄÇÂèàÊòØ‰∏Ä‰∏™Ëá™Âä®Ê≥®ÂÖ•ÁöÑÊâ©Â±ïÁÇπ„ÄÇ 12345private Cluster cluster;public void setCluster(Cluster cluster) &#123; this.cluster = cluster;&#125; ‰ªé‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫ÔºåËøô‰∏™‰∏ç‰ªÖ‰ªÖÊòØ‰∏Ä‰∏™Êâ©Â±ïÁÇπÔºåËÄå‰∏îÊñπÊ≥ïÂ±ÇÈù¢‰∏äÔºåËøòÊúâ‰∏Ä‰∏™@AdaptiveÔºåË°®Á§∫‰ºöÂä®ÊÄÅÁîüÊàê‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÈÄÇÈÖçÂô®Cluster$Adaptive 1234567@SPI(FailoverCluster.NAME)public interface Cluster &#123; @Adaptive &lt;T&gt; Invoker&lt;T&gt; join(Directory&lt;T&gt; directory) throws RpcException;&#125; Cluster$AdaptiveÈÄöËøádebugÁöÑÊñπÂºèÔºåÔºåËé∑ÂèñÂà∞Cluster$AdaptiveËøô‰∏™ÈÄÇÈÖçÂô®Ôºå‰ª£Á†ÅÂ¶Ç‰∏ã„ÄÇÊàë‰ª¨Áü•ÈÅìclusterËøô‰∏™ÂØπË±°ÁöÑÂÆû‰æã‰ª•ÂêéÔºåÁªßÁª≠ÁúãdoReferÊñπÊ≥ïÔºõÊ≥®ÊÑèÔºöËøôÈáåÁöÑCluster$Adaptive‰πüÂπ∂‰∏çÂçïÁ∫ØÔºåÂ§ßÂÆ∂ËøòËÆ∞ÂæóÂú®ËÆ≤Êâ©Â±ïÁÇπÁöÑÊó∂ÂÄôÊúâ‰∏Ä‰∏™Êâ©Â±ïÁÇπË£ÖÈ•∞Âô®ÂêóÔºüÂ¶ÇÊûúËøô‰∏™Êâ©Â±ïÁÇπÂ≠òÂú®‰∏Ä‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂπ∂‰∏îÊûÑÈÄ†ÂáΩÊï∞Â∞±ÊòØÊâ©Â±ïÊé•Âè£Êú¨Ë∫´ÔºåÈÇ£‰πàËøô‰∏™Êâ©Â±ïÁÇπÂ∞±‰ºöËøô‰∏™wrapperË£ÖÈ•∞ÔºåËÄåClusterË¢´Ë£ÖÈ•∞ÁöÑÊòØÔºöMockClusterWrapper 123456789101112131415public class Cluster$Adaptive implements com.alibaba.dubbo.rpc.cluster.Cluster &#123; public Invoker join(Directory arg0) throws RpcException &#123; if (arg0 == null) throw new IllegalArgumentException("com.alibaba.dubbo.rpc.cluster.Directory argument == null"); if (arg0.getUrl() == null) throw new IllegalArgumentException("com.alibaba.dubbo.rpc.cluster.Directory argument getUrl() == null"); com.alibaba.dubbo.common.URL url = arg0.getUrl(); String extName = url.getParameter("cluster", "failover"); if (extName == null) throw new IllegalStateException("Fail to get extension(com.alibaba.dubbo.rpc.cluster.Cluster) name from url(" + url.toString() + ") use keys([cluster])"); com.alibaba.dubbo.rpc.cluster.Cluster extension = (com.alibaba.dubbo.rpc.cluster.Cluster) ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.rpc.cluster.Cluster.class).getExtension(extName); return extension.join(arg0); &#125;&#125; RegistryProtocol.doReferËøôÊÆµ‰ª£Á†Å‰∏≠ÔºåÊúâ‰∏Ä‰∏™RegistryDirectory,ÂèØËÉΩÁúã‰∏çÊáÇÔºåÊàë‰ª¨ÊöÇÊó∂ÂÖàÂøΩÁï•ÔºåÁ≠â‰ºöÂçïÁã¨ËÆ≤.ÔºàÂü∫‰∫éÊ≥®ÂÜå‰∏≠ÂøÉÂä®ÊÄÅÂèëÁé∞ÊúçÂä°Êèê‰æõËÄÖÔºâ Â∞Üconsumer://ÂçèËÆÆÂú∞ÂùÄÊ≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ registryDirectoryÁöÑsubscribeÊñπÊ≥ïÔºåËÆ¢ÈòÖzookeeperÂú∞ÂùÄÁöÑÂèòÂåñ Ë∞ÉÁî®cluster.join()ÊñπÊ≥ï 12345678910111213141516171819private &lt;T&gt; Invoker&lt;T&gt; doRefer(Cluster cluster, Registry registry, Class&lt;T&gt; type, URL url) &#123; RegistryDirectory&lt;T&gt; directory = new RegistryDirectory&lt;T&gt;(type, url); directory.setRegistry(registry); directory.setProtocol(protocol); URL subscribeUrl = new URL(Constants.CONSUMER_PROTOCOL, NetUtils.getLocalHost(), 0, type.getName(), directory.getUrl().getParameters()); if (! Constants.ANY_VALUE.equals(url.getServiceInterface()) &amp;&amp; url.getParameter(Constants.REGISTER_KEY, true)) &#123;// Â∞Üconsumer://ÂçèËÆÆÂú∞ÂùÄÊ≥®ÂÜåÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ registry.register(subscribeUrl.addParameters(Constants.CATEGORY_KEY, Constants.CONSUMERS_CATEGORY, Constants.CHECK_KEY, String.valueOf(false))); &#125; //ÈÄöËøáregistryDirectoryÁöÑsubscribeÔºå directory.subscribe(subscribeUrl.addParameter(Constants.CATEGORY_KEY, Constants.PROVIDERS_CATEGORY + "," + Constants.CONFIGURATORS_CATEGORY + "," + Constants.ROUTERS_CATEGORY)); return cluster.join(directory);&#125; cluster.joinÁî±ÂâçÈù¢ÁöÑCluster$AdaptiveËøô‰∏™Á±ª‰∏≠ÁöÑjoinÊñπÊ≥ïÁöÑÂàÜÊûêÔºåÂæóÁü•cluster.join‰ºöË∞ÉÁî®MockClusterWrapper.joinÊñπÊ≥ïÔºå ÁÑ∂ÂêéÂÜçË∞ÉÁî®FailoverCluster.joinÊñπÊ≥ï„ÄÇ MockClusterWrapper.joinËøô‰∏™ÊÑèÊÄùÂæàÊòéÊòæ‰∫Ü„ÄÇ‰πüÂ∞±ÊòØÊàë‰ª¨‰∏äËäÇËØæËÆ≤ËøáÁöÑmockÂÆπÈîôÊú∫Âà∂ÔºåÂ¶ÇÊûúÂá∫Áé∞ÂºÇÂ∏∏ÊÉÖÂÜµÔºå‰ºöË∞ÉÁî®MockClusterInvokerÔºåÂê¶ÂàôÔºåË∞ÉÁî®FailoverClusterInvoker. 12345678910111213public class MockClusterWrapper implements Cluster &#123; private Cluster cluster; public MockClusterWrapper(Cluster cluster) &#123; this.cluster = cluster; &#125; public &lt;T&gt; Invoker&lt;T&gt; join(Directory&lt;T&gt; directory) throws RpcException &#123; return new MockClusterInvoker&lt;T&gt;(directory, this.cluster.join(directory)); &#125;&#125; Â∞èÁªìrefprotocol.refÔºåËøô‰∏™ÊñπÊ≥ïÔºå‰ºöËøîÂõû‰∏Ä‰∏™MockClusterInvoker(FailoverClusterInvoker)„ÄÇËøôÈáåÈù¢‰∏ÄÂÆöËøòÊúâÁñëÈóÆÔºåÊàë‰ª¨ÂÖàÊää‰∏ªÁ∫øËµ∞ÂÆåÔºåÂÜçÂõûËøáÂ§¥ÁúãÁúã‰ªÄ‰πàÊòØcluster„ÄÅ‰ªÄ‰πàÊòØdirectory proxyFactory.getProxy(invoker);ÂÜçÂõûÂà∞ReferenceConfigËøô‰∏™Á±ªÔºåÂú®createProxyÊñπÊ≥ïÁöÑÊúÄÂêé‰∏ÄË°åÔºåË∞ÉÁî®proxyFactory.getProxy(invoker). ÊääÂâçÈù¢ÁîüÊàêÁöÑinvokerÂØπË±°‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂÜçÈÄöËøáproxyFactoryÂ∑•ÂéÇÂéªËé∑Âæó‰∏Ä‰∏™‰ª£ÁêÜÂØπË±°„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨ÂàÜÊûê‰∏ãËøôÊÆµ‰ª£Á†ÅÂÅö‰∫Ü‰ªÄ‰πà„ÄÇ ÂÖ∂ÂÆûÂâçÈù¢Âú®ÂàÜÊûêÊúçÂä°ÂèëÂ∏ÉÁöÑÊó∂ÂÄôÔºåÂü∫Êú¨ÂàÜÊûêËøá‰∫ÜÔºåÊâÄ‰ª•ÂÜçÁúãËøôÊÆµ‰ª£Á†ÅÔºåÂ∫îËØ•‰ºöÂæàÁÜüÊÇâ ProxyFactoryÔºå ‰ºöÁîüÊàê‰∏Ä‰∏™Âä®ÊÄÅÁöÑËá™ÈÄÇÂ∫îÈÄÇÈÖçÂô®„ÄÇProxyFactory$AdaptiveÔºåÁÑ∂ÂêéË∞ÉÁî®Ëøô‰∏™ÈÄÇÈÖçÂô®‰∏≠ÁöÑgetProxyÊñπÊ≥ïÔºå‰ª£Á†ÅÂ¶Ç‰∏ã 123ReferenceConfig// ÂàõÂª∫ÊúçÂä°‰ª£ÁêÜ return (T) proxyFactory.getProxy(invoker); 12345678910public java.lang.Object getProxy(Invoker arg0) throws RpcException &#123; if (arg0 == null) throw new IllegalArgumentException("com.alibaba.dubbo.rpc.Invoker argument == null"); if (arg0.getUrl() == null) throw new IllegalArgumentException("com.alibaba.dubbo.rpc.Invoker argument getUrl() == null");com.alibaba.dubbo.common.URL url = arg0.getUrl(); String extName = url.getParameter("proxy", "javassist"); if(extName == null) throw new IllegalStateException("Fail to get extension(com.alibaba.dubbo.rpc.ProxyFactory) name from url(" + url.toString() + ") use keys([proxy])"); com.alibaba.dubbo.rpc.ProxyFactory extension = (com.alibaba.dubbo.rpc.ProxyFactory)ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.rpc.ProxyFactory.class).getExtension(extName); return extension.getProxy(arg0); ÂæàÊòæÁÑ∂ÔºåÂèàÊòØÈÄöËøájavassistÂÆûÁé∞ÁöÑ‰∏Ä‰∏™Âä®ÊÄÅ‰ª£ÁêÜÔºåÊàë‰ª¨Êù•ÁúãÁúãJavassistProxyFactory.getProxy JavassistProxyFactory.getProxyÈÄöËøájavasssistÂä®ÊÄÅÂ≠óËäÇÁ†ÅÁîüÊàêÂä®ÊÄÅ‰ª£ÁêÜÁ±ªÔºå 123public &lt;T&gt; T getProxy(Invoker&lt;T&gt; invoker, Class&lt;?&gt;[] interfaces) &#123; return (T) Proxy.getProxy(interfaces).newInstance(new InvokerInvocationHandler(invoker));&#125; Proxy.getProxy(interfaces)Âú®Proxy.getProxyËøô‰∏™Á±ªÁöÑÂ¶Ç‰∏ã‰ª£Á†Å‰∏≠Ê∑ªÂä†Êñ≠ÁÇπÔºåÂú®debug‰∏ãÂèØ‰ª•ÁúãÂà∞Âä®ÊÄÅÂ≠óËäÇÁ†ÅÂ¶Ç‰∏ã 123456public java.lang.String sayHello(java.lang.String arg0)&#123; Object[] args = new Object[1]; args[0] = ($w)$1; Object ret = handler.invoke(this, methods[0], args);return (java.lang.String)ret;&#125; ‰∏äÈù¢‰ª£Á†ÅÁöÑhandlerÔºåÂ∞±ÊòØÂú®JavassistProxyFactory.getProxy‰∏≠„ÄÇ‰º†ÈÄíÁöÑnew InvokerInvocationHandler(invoker) ‰ªÄ‰πàÊó∂ÂÄôÂª∫Á´ãÂíåÊúçÂä°Á´ØÁöÑËøûÊé•ÂâçÈù¢Êàë‰ª¨ÈÄöËøá‰ª£Á†ÅÂàÜÊûêÂà∞‰∫ÜÔºåÊ∂àË¥πÁ´ØÁöÑÂàùÂßãÂåñËøáÁ®ãÔºå‰ΩÜÊòØ‰ºº‰πéÊ≤°ÊúâÁúãÂà∞ÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´ØÂª∫Á´ãNIOËøûÊé•„ÄÇÂÆûÈôÖ‰∏äÔºåÂª∫Á´ãËøûÊé•ÁöÑËøáÁ®ãÂú®Ê∂àË¥πÁ´ØÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂ∞±Âª∫Á´ãÂ•ΩÁöÑÔºåÂè™ÊòØÂâçÈù¢Êàë‰ª¨Ê≤°ÊúâÂàÜÊûêÔºå‰ª£Á†ÅÂú®RegistryProtocol.doReferÊñπÊ≥ïÂÜÖÁöÑdirectory.subscribeÊñπÊ≥ï‰∏≠„ÄÇ 1234567891011121314151617181920212223private &lt;T&gt; Invoker&lt;T&gt; doRefer(Cluster cluster, Registry registry, Class&lt;T&gt; type, URL url) &#123; RegistryDirectory&lt;T&gt; directory = new RegistryDirectory&lt;T&gt;(type, url); directory.setRegistry(registry); directory.setProtocol(protocol); // consumer://192.*** URL subscribeUrl = new URL(Constants.CONSUMER_PROTOCOL, NetUtils.getLocalHost(), 0, type.getName(), directory.getUrl().getParameters()); if (! Constants.ANY_VALUE.equals(url.getServiceInterface()) &amp;&amp; url.getParameter(Constants.REGISTER_KEY, true)) &#123; // consumer://192.***Ê≥®ÂÜåÂà∞zkÊ≥®ÂÜå‰∏≠ÂøÉ registry.register(subscribeUrl.addParameters(Constants.CATEGORY_KEY, Constants.CONSUMERS_CATEGORY, Constants.CHECK_KEY, String.valueOf(false))); &#125; //registryDirectoryËÆ¢ÈòÖprovider„ÄÅconfigurator„ÄÅrouterÁöÑÁõÆÂΩïÁöÑÂèòÂåñ directory.subscribe(subscribeUrl.addParameter(Constants.CATEGORY_KEY, Constants.PROVIDERS_CATEGORY + "," + Constants.CONFIGURATORS_CATEGORY + "," + Constants.ROUTERS_CATEGORY)); return cluster.join(directory);&#125; directory.subscribeRegistryProtocolÁöÑreferÊñπÊ≥ïInvoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url)Ôºå‰º†ÂÖ•ÁöÑÂèÇÊï∞url‰∏∫zookeeper://127.0.0.1:2181/com.alibaba.dubbo.registry.RegistryService?application=dubbo-client-demo ËÄåregistryFactoryÊòØRegistryFactory$AdaptiveÔºåÊâÄ‰ª•Ê†πÊçÆurlÁöÑprotocolÔºåÂÆûÈôÖË∞ÉÁî®ÁöÑÊòØZookeeperRegistryFactoryÁöÑgetRegistryÊñπÊ≥ïÔºåÊúÄÁªàÂæóÂà∞ZookeeperRegsitryÂÆû‰æã„ÄÇ 12345678910111213141516171819202122//RegistryProtocol public &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url) throws RpcException &#123; url = url.setProtocol(url.getParameter(Constants.REGISTRY_KEY, Constants.DEFAULT_REGISTRY)).removeParameter(Constants.REGISTRY_KEY); //ZookeeperRegistyFactoryÂæóÂà∞ZookeeperRegistry Registry registry = registryFactory.getRegistry(url); if (RegistryService.class.equals(type)) &#123; return proxyFactory.getInvoker((T) registry, type, url); &#125; // group="a,b" or group="*" Map&lt;String, String&gt; qs = StringUtils.parseQueryString(url.getParameterAndDecoded(Constants.REFER_KEY)); String group = qs.get(Constants.GROUP_KEY); if (group != null &amp;&amp; group.length() &gt; 0 ) &#123; if ( ( Constants.COMMA_SPLIT_PATTERN.split( group ) ).length &gt; 1 || "*".equals( group ) ) &#123; return doRefer( getMergeableCluster(), registry, type, url ); &#125; &#125; return doRefer(cluster, registry, type, url); &#125; Âú®RegistryProtocolÁöÑdoReferÊñπÊ≥ï‰∏≠Ôºådirectory.setResgitry‰∏≠ÂèÇÊï∞‰∏∫zookeeperRegistry„ÄÇ Âõ†‰∏∫ZookeeperRegistry extends FailbackRegistryÔºåFailbackRegistry extends AbstractRegistry ÊâÄ‰ª•registryDirectoryÁöÑË∞ÉÁî®Èìæ‰∏∫Ôºö RegistryDirectory.subscribe -&gt;FailbackRegistry. subscribe-&gt;- AbstractRegistry.subscribe&gt;zookeeperRegistry.doSubscribe 123456//RegistryDirectorypublic void subscribe(URL url) &#123; setConsumerUrl(url); registry.subscribe(url, this);&#125; FailbackRegistry. subscribeË∞ÉÁî®FailbackRegistry.subscribe ËøõË°åËÆ¢ÈòÖÔºåËøôÈáåÊúâ‰∏Ä‰∏™ÁâπÊÆäÂ§ÑÁêÜÔºåÂ¶ÇÊûúËÆ¢ÈòÖÂ§±Ë¥•ÔºåÂàô‰ºöÊ∑ªÂä†Âà∞ÂÆöÊó∂‰ªªÂä°‰∏≠ËøõË°åÈáçËØï 1234567@Overridepublic void subscribe(URL url, NotifyListener listener) &#123; super.subscribe(url, listener); removeFailedSubscribed(url, listener); try &#123; // ÂêëÊúçÂä°Âô®Á´ØÂèëÈÄÅËÆ¢ÈòÖËØ∑Ê±Ç doSubscribe(url, listener); zookeeperRegistry. doSubscribeË∞ÉÁî®zookeeperRegistryÊâßË°åÁúüÊ≠£ÁöÑËÆ¢ÈòÖÊìç‰ΩúÔºåËøôÊÆµ‰ª£Á†ÅÂ§™ÈïøÔºåÊàëÂ∞±‰∏çË¥¥Âá∫Êù•‰∫ÜÔºåËøôÈáåÈù¢‰∏ªË¶ÅÂÅö‰∏§‰∏™Êìç‰Ωú ÂØπproviders/routers/configurator‰∏â‰∏™ËäÇÁÇπËøõË°åÂàõÂª∫ÂíåÁõëÂê¨ Ë∞ÉÁî®notify(url,listener,urls) Â∞ÜÂ∑≤ÁªèÂèØÁî®ÁöÑÂàóË°®ËøõË°åÈÄöÁü• AbstractRegistry.notify12345678910111213141516171819202122232425262728293031323334353637383940414243protected void notify(URL url, NotifyListener listener, List&lt;URL&gt; urls) &#123; if (url == null) &#123; throw new IllegalArgumentException("notify url == null"); &#125; if (listener == null) &#123; throw new IllegalArgumentException("notify listener == null"); &#125; if ((urls == null || urls.size() == 0) &amp;&amp; ! Constants.ANY_VALUE.equals(url.getServiceInterface())) &#123; logger.warn("Ignore empty notify urls for subscribe url " + url); return; &#125; if (logger.isInfoEnabled()) &#123; logger.info("Notify urls for subscribe url " + url + ", urls: " + urls); &#125; Map&lt;String, List&lt;URL&gt;&gt; result = new HashMap&lt;String, List&lt;URL&gt;&gt;(); for (URL u : urls) &#123; if (UrlUtils.isMatch(url, u)) &#123; String category = u.getParameter(Constants.CATEGORY_KEY, Constants.DEFAULT_CATEGORY); List&lt;URL&gt; categoryList = result.get(category); if (categoryList == null) &#123; categoryList = new ArrayList&lt;URL&gt;(); result.put(category, categoryList); &#125; categoryList.add(u); &#125; &#125; if (result.size() == 0) &#123; return; &#125; Map&lt;String, List&lt;URL&gt;&gt; categoryNotified = notified.get(url); if (categoryNotified == null) &#123; notified.putIfAbsent(url, new ConcurrentHashMap&lt;String, List&lt;URL&gt;&gt;()); categoryNotified = notified.get(url); &#125; for (Map.Entry&lt;String, List&lt;URL&gt;&gt; entry : result.entrySet()) &#123; String category = entry.getKey(); List&lt;URL&gt; categoryList = entry.getValue(); categoryNotified.put(category, categoryList); saveProperties(url); listener.notify(categoryList); &#125;&#125; ÊÄªÁªìÊ∂àË¥πÁ´ØÂàùÂßãÂåñËøôÂùóÂ∞±ÂÆå‰∫Ü]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DubboÊ∫êÁ†ÅÂàÜÊûê‰πãExtensionLoaderÂä®ÊÄÅÊâ©Â±ï]]></title>
    <url>%2F2018%2F06%2F24%2FDubbo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8BExtensionLoader%E5%8A%A8%E6%80%81%E6%89%A9%E5%B1%95%2F</url>
    <content type="text"><![CDATA[1. Áõ∏ÂÖ≥Ê≥®Ëß£SPIÂÆö‰πâ‰∏Ä‰∏™Êâ©Â±ïÁÇπÔºåservice provider interface AdaptiveËá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÔºåÂú®{@link ExtensionLoader}ÁîüÊàêExtensionÁöÑAdaptive InstanceÊó∂Ôºå‰∏∫{@link ExtensionLoader}Êèê‰æõ‰ø°ÊÅØ„ÄÇ ActivateËá™Âä®ÊøÄÊ¥ªÂä†ËΩΩÊâ©Â±ïÁÇπ Âú®Ëøô‰∏™Ê∫êÁ†Å‰∏≠ÂèØ‰ª•ÁúãÂà∞Êúâ‰∏§‰∏™Ê≥® Ëß£Ôºå‰∏Ä‰∏™ÊòØÂú®Á±ªÁ∫ßÂà´‰∏äÁöÑ@SPI(‚Äúdubbo‚Äù), Âè¶‰∏Ä‰∏™ÊòØ @Adaptive@SPI Ë°®Á§∫ÂΩìÂâçËøô‰∏™Êé•Âè£ÊòØ‰∏Ä‰∏™Êâ©Â±ïÁÇπÔºåÂèØ‰ª•ÂÆûÁé∞Ëá™Â∑±ÁöÑ Êâ©Â±ïÂÆûÁé∞ÔºåÈªòËÆ§ÁöÑÊâ©Â±ïÁÇπÊòØ DubboProtocol„ÄÇ@Adaptive Ë°®Á§∫‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÔºåÂú®ÊñπÊ≥ïÁ∫ßÂà´‰∏äÔºå‰ºöÂä®ÊÄÅÊãºÊé•Â≠óÁ¨¶‰∏≤ÁîüÊàê‰∏Ä‰∏™ÈÄÇÈÖçÂô®Á±ª„ÄÇÂú®Á±ª‰∏äÔºåÂàô‰∏ç‰ºö„ÄÇ 123456789101112@SPI("dubbo")public interface Protocol &#123; int getDefaultPort(); @Adaptive &lt;T&gt; Exporter&lt;T&gt; export(Invoker&lt;T&gt; invoker) throws RpcException; @Adaptive &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url) throws RpcException; void destroy();&#125; 2. getAdaptiveExtensionËé∑ÂèñËá™ÈÄÇÂ∫îÁöÑÊâ©Â±ïÁÇπÊµÅÁ®ãÊó∂Â∫èÂõæÂ¶Ç‰∏ãÔºö getExtensionLoader‰∏çÂ≠òÂú®Ôºånew‰∏Ä‰∏™123456789 public static &lt;T&gt; ExtensionLoader&lt;T&gt; getExtensionLoader(Class&lt;T&gt; type) &#123;//ÂºÇÂ∏∏nullÂ§ÑÁêÜÁúÅÁï•„ÄÇ„ÄÇ„ÄÇ ExtensionLoader&lt;T&gt; loader = (ExtensionLoader&lt;T&gt;) EXTENSION_LOADERS.get(type); if (loader == null) &#123; EXTENSION_LOADERS.putIfAbsent(type, new ExtensionLoader&lt;T&gt;(type)); loader = (ExtensionLoader&lt;T&gt;) EXTENSION_LOADERS.get(type); &#125; return loader; &#125; 123456private ExtensionLoader(Class&lt;?&gt; type) &#123;//Protocol.class this.type = type; objectFactory = (type == ExtensionFactory.class ? null : ExtensionLoader.getExtensionLoader(ExtensionFactory.class). getAdaptiveExtension());&#125; getAdaptiveExtensionËøô‰∏™ÊñπÊ≥ïÈáåÈù¢‰∏ªË¶ÅÂÅöÂá†‰∏™‰∫ãÊÉÖ: ‰ªé cacheAdaptiveInstance Ëøô‰∏™ÂÜÖÂ≠òÁºìÂ≠ò‰∏≠Ëé∑Âæó‰∏Ä‰∏™ÂØπË±°ÂÆû‰æã Â¶ÇÊûúÂÆû‰æã‰∏∫Á©∫ÔºåËØ¥ÊòéÊòØÁ¨¨‰∏ÄÊ¨°Âä†ËΩΩÔºåÂàôÈÄöËøáÂèåÈáçÊ£ÄÊü•ÈîÅÁöÑÊñπÂºèÂéªÂàõÂª∫‰∏Ä‰∏™ÈÄÇÈÖçÂô®Êâ©Â±ïÁÇπ123456789101112131415161718192021public T getAdaptiveExtension() &#123; Object instance = cachedAdaptiveInstance.get(); if (instance == null) &#123; if(createAdaptiveInstanceError == null) &#123; synchronized (cachedAdaptiveInstance) &#123; instance = cachedAdaptiveInstance.get(); if (instance == null) &#123; try &#123; instance = createAdaptiveExtension(); cachedAdaptiveInstance.set(instance); &#125; catch (Throwable t) &#123; createAdaptiveInstanceError = t; throw new IllegalStateException("fail to create adaptive instance: " + t.toString(), t); &#125; &#125; &#125; &#125; &#125; return (T) instance;&#125; createAdaptiveExtensionËøôÊÆµ‰ª£Á†ÅÈáåÈù¢Êúâ‰∏§‰∏™ÁªìÊûÑÔºå‰∏Ä‰∏™ÊòØ injectExtension. Âè¶‰∏Ä ‰∏™ÊòØ getAdaptiveExtensionClass() 12345678private T createAdaptiveExtension() &#123; try &#123; //ÂèØ‰ª•ÂÆûÁé∞Êâ©Â±ïÁÇπÁöÑÊ≥®ÂÖ• return injectExtension((T) getAdaptiveExtensionClass().newInstance()); &#125; catch (Exception e) &#123; throw new IllegalStateException("Can not create adaptive extenstion " + type + ", cause: " + e.getMessage(), e); &#125;&#125; getAdaptiveExtensionClass‰ªéÁ±ªÂêçÊù•ÁúãÔºåÊòØËé∑Âæó‰∏Ä‰∏™ÈÄÇÈÖçÂô®Êâ©Â±ïÁÇπÁöÑÁ±ª„ÄÇ Âú®ËøôÊÆµ‰ª£Á†Å‰∏≠ÔºåÂÅö‰∫Ü‰∏§‰∏™‰∫ãÊÉÖ getExtensionClasses() Âä†ËΩΩÊâÄÊúâË∑ØÂæÑ‰∏ãÁöÑÊâ©Â±ïÁÇπ createAdaptiveExtensionClass() Âä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™Êâ©Â±ïÁÇπ cachedAdaptiveClass ËøôÈáåÊúâ‰∏™Âà§Êñ≠ÔºåÁî®Êù•Âà§Êñ≠ÂΩìÂâç Protocol Ëøô‰∏™Êâ©Â±ïÁÇπÊòØÂê¶Â≠òÂú®‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÈÄÇÈÖçÂô®ÔºåÂ¶ÇÊûú ÊúâÔºåÂàôÁõ¥Êé•ËøîÂõûËá™ÂÆö‰πâÈÄÇÈÖçÂô®ÔºåÂê¶ÂàôÔºåÂ∞±Âä®ÊÄÅÂàõÂª∫ÔºåËøô‰∏™ÂÄº ÊòØÂú® getExtensionClasses ‰∏≠ËµãÂÄºÁöÑÔºåËøôÂùó‰ª£Á†ÅÊàë‰ª¨Á®çÂêéÂÜçÁúã1234567private Class&lt;?&gt; getAdaptiveExtensionClass() &#123; getExtensionClasses(); if (cachedAdaptiveClass != null) &#123; return cachedAdaptiveClass; //AdaptiveCompiler &#125; return cachedAdaptiveClass = createAdaptiveExtensionClass();&#125; createAdaptiveExtensionClassÂä®ÊÄÅÁîüÊàêÈÄÇÈÖçÂô®‰ª£Á†ÅÔºå‰ª•ÂèäÂä®ÊÄÅÁºñËØë createAdaptiveExtensionClassCode, Âä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™Â≠óËäÇÁ†ÅÊñá‰ª∂„ÄÇËøîÂõû code Ëøô‰∏™Â≠óÁ¨¶‰∏≤ ÈÄöËøá compiler.compile ËøõË°åÁºñËØë(ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰ΩøÁî®ÁöÑÊòØjavassist) ÈÄöËøá ClassLoader Âä†ËΩΩÂà∞ jvm ‰∏≠12345678910//ÂàõÂª∫‰∏Ä‰∏™ÈÄÇÈÖçÂô®Êâ©Â±ïÁÇπ„ÄÇÔºàÂàõÂª∫‰∏Ä‰∏™Âä®ÊÄÅÁöÑÂ≠óËäÇÁ†ÅÊñá‰ª∂Ôºâprivate Class&lt;?&gt; createAdaptiveExtensionClass() &#123; //ÁîüÊàêÂ≠óËäÇÁ†Å‰ª£Á†Å String code = createAdaptiveExtensionClassCode(); //Ëé∑ÂæóÁ±ªÂä†ËΩΩÂô® ClassLoader classLoader = findClassLoader(); com.alibaba.dubbo.common.compiler.Compiler compiler = ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.common.compiler.Compiler.class).getAdaptiveExtension(); //Âä®ÊÄÅÁºñËØëÂ≠óËäÇÁ†Å return compiler.compile(code, classLoader);&#125; codeÁöÑÂ≠óËäÇÁ†ÅÂÜÖÂÆπ12345678910111213141516171819202122232425262728293031public class Protocol$Adaptive implements com.alibaba.dubbo.rpc.Protocol &#123; public void destroy() &#123; throw new UnsupportedOperationException("method public abstract void com.alibaba.dubbo.rpc.Protocol.destroy() of interface com.alibaba.dubbo.rpc.Protocol is not adaptive method!"); &#125; public int getDefaultPort() &#123; throw new UnsupportedOperationException("method public abstract int com.alibaba.dubbo.rpc.Protocol.getDefaultPort() of interface com.alibaba.dubbo.rpc.Protocol is not adaptive method!"); &#125; public com.alibaba.dubbo.rpc.Invoker refer(java.lang.Class arg0, com.alibaba.dubbo.common.URL arg1) throws com.alibaba.dubbo.rpc.RpcException &#123; if (arg1 == null) throw new IllegalArgumentException("url == null"); com.alibaba.dubbo.common.URL url = arg1; String extName = (url.getProtocol() == null ? "dubbo" : url.getProtocol()); if (extName == null) throw new IllegalStateException("Fail to get extension(com.alibaba.dubbo.rpc.Protocol) name from url(" + url.toString() + ") use keys([protocol])"); com.alibaba.dubbo.rpc.Protocol extension = (com.alibaba.dubbo.rpc.Protocol) ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.rpc.Protocol.class).getExtension(extName); return extension.refer(arg0, arg1); &#125; public com.alibaba.dubbo.rpc.Exporter export(com.alibaba.dubbo.rpc.Invoker arg0) throws com.alibaba.dubbo.rpc.RpcException &#123; if (arg0 == null) throw new IllegalArgumentException("com.alibaba.dubbo.rpc.Invoker argument == null"); if (arg0.getUrl() == null) throw new IllegalArgumentException("com.alibaba.dubbo.rpc.Invoker argument getUrl() == null"); com.alibaba.dubbo.common.URL url = arg0.getUrl(); String extName = (url.getProtocol() == null ? "dubbo" : url.getProtocol()); if (extName == null) throw new IllegalStateException("Fail to get extension(com.alibaba.dubbo.rpc.Protocol) name from url(" + url.toString() + ") use keys([protocol])"); com.alibaba.dubbo.rpc.Protocol extension = (com.alibaba.dubbo.rpc.Protocol) ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.rpc.Protocol.class).getExtension(extName); return extension.export(arg0); &#125;&#125; Protocol$Adaptive ÁöÑ‰∏ªË¶ÅÂäüËÉΩ ‰ªé url ÊàñÊâ©Â±ïÊé•Âè£Ëé∑ÂèñÊâ©Â±ïÊé•Âè£ÂÆûÁé∞Á±ªÁöÑÂêçÁß∞; Ê†π ÊçÆ Âêç Áß∞ Ôºå Ëé∑ Âèñ ÂÆû Áé∞ Á±ª ExtensionLoader.getExtensionLoader( Êâ© Â±ï Êé• Âè£ Á±ª).getExtension(Êâ©Â±ïÊé•Âè£ÂÆûÁé∞Á±ªÂêçÁß∞)ÔºåÁÑ∂ÂêéË∞ÉÁî®ÂÆûÁé∞Á±ª ÁöÑÊñπÊ≥ï„ÄÇÈúÄË¶ÅÊòéÁôΩ‰∏ÄÁÇπ dubbo ÁöÑÂÜÖÈÉ®‰º†ÂèÇÂü∫Êú¨‰∏äÈÉΩÊòØÂü∫‰∫é Url Êù•ÂÆû Áé∞ÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ Dubbo ÊòØÂü∫‰∫é URL È©±Âä®ÁöÑÊäÄÊúØ ÊâÄ‰ª•ÔºåÈÄÇÈÖçÂô®Á±ªÁöÑÁõÆÁöÑÊòØÂú®ËøêË°åÊúüËé∑ÂèñÊâ©Â±ïÁöÑÁúüÊ≠£ÂÆûÁé∞Êù•Ë∞ÉÁî®ÔºåËß£ËÄ¶Êé•Âè£ÂíåÂÆûÁé∞ÔºåËøôÊ†∑ÁöÑËØù‰∏çË¶ÅÊàë‰ª¨Ëá™Â∑±ÂÆûÁé∞ÈÄÇÈÖçÂô®Á±ªÔºåËÄåËøô‰∫õÈÉΩÊòØÈÄöËøá Adpative Êù•ÂÆûÁé∞„ÄÇÂà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÊàë‰ª¨ÁöÑ AdaptiveExtension ÁöÑ‰∏ªÁ∫øËµ∞ÂÆå‰∫ÜÔºåÂèØ ‰ª•ÁÆÄÂçïÊï¥ÁêÜ‰∏Ä‰∏ã‰ªñ‰ª¨ÁöÑË∞ÉÁî®ÂÖ≥Á≥ªÂ¶Ç‰∏ã getExtensionClassesËøôÊÆµ‰ª£Á†Å‰∏ªË¶ÅÂÅöÂ¶Ç‰∏ãÂá†‰∏™‰∫ãÊÉÖ ‰ªé cachedClasses ‰∏≠Ëé∑Âæó‰∏Ä‰∏™ÁªìÊûúÔºåËøô‰∏™ÁªìÊûúÂÆûÈôÖ‰∏äÂ∞± ÊòØÊâÄÊúâÁöÑÊâ©Â±ïÁÇπÁ±ªÔºåkey ÂØπÂ∫î nameÔºåvalue ÂØπÂ∫î class ÈÄöËøáÂèåÈáçÊ£ÄÊü•ÈîÅËøõË°åÂà§Êñ≠ Ë∞ÉÁî® loadExtensionClassesÔºåÂéªÂä†ËΩΩÂ∑¶Âè≥Êâ©Â±ïÁÇπÁöÑÂÆûÁé∞ 123456789101112131415//Âä†ËΩΩÊâ©Â±ïÁÇπÁöÑÂÆûÁé∞Á±ªprivate Map&lt;String, Class&lt;?&gt;&gt; getExtensionClasses() &#123; Map&lt;String, Class&lt;?&gt;&gt; classes = cachedClasses.get(); if (classes == null) &#123; synchronized (cachedClasses) &#123; classes = cachedClasses.get(); if (classes == null) &#123; classes = loadExtensionClasses(); cachedClasses.set(classes); &#125; &#125; &#125; return classes;&#125; loadExtensionClasses‰ªé‰∏çÂêåÁõÆÂΩïÂéªÂä†ËΩΩÊâ©Â±ïÁÇπÁöÑÂÆûÁé∞ÔºåMETA-INF/dubbo ; META-INF/internal ; META- INF/ser vices‰∏ªË¶ÅÈÄªËæë Ëé∑ÂæóÂΩìÂâçÊâ©Â±ïÁÇπÁöÑÊ≥®Ëß£Ôºå‰πüÂ∞±ÊòØ Protocol.class Ëøô‰∏™Á±ªÁöÑ Ê≥®Ëß£Ôºå@SPI Âà§Êñ≠Ëøô‰∏™Ê≥®Ëß£‰∏ç‰∏∫Á©∫ÔºåÂàôÂÜçÊ¨°Ëé∑Âæó@SPI ‰∏≠ÁöÑ value ÂÄº Â¶ÇÊûú value ÊúâÂÄºÔºå‰πüÂ∞±ÊòØ@SPI(‚Äúdubbo‚Äù)ÔºåÂàôËÆ≤Ëøô‰∏™ dubbo ÁöÑÂÄºËµãÁªô cachedDefaultName„ÄÇËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊàë‰ª¨ËÉΩÂ§üÈÄöËøá ExtensionLoader.getExtensionLoader(Protocol.class).getDefaultExtension() ,ËÉΩÂ§üËé∑Âæó DubboProtocol Ëøô‰∏™Êâ© Â±ïÁÇπÁöÑÂéüÂõ† ÊúÄÂêéÔºåÈÄöËøá loadFile ÂéªÂä†ËΩΩÊåáÂÆöË∑ØÂæÑ‰∏ãÁöÑÊâÄÊúâÊâ©Â±ïÁÇπ„ÄÇ ‰πü Â∞± ÊòØ META-INF/dubbo;META-INF/internal;META-INF/services ËØªÂèñcom.alibaba.dubbo.common.extension.ExtensionFactoryÁöÑÊñá‰ª∂ÂÜÖÂÆπÔºåÊåâË°åËØªÂèñÔºåÊñá‰ª∂ÈááÁî® name=value ÊñπÂºè123adaptive=com.alibaba.dubbo.common.extension.factory.AdaptiveExtensionFactoryspi=com.alibaba.dubbo.common.extension.factory.SpiExtensionFactoryspring=com.alibaba.dubbo.config.spring.extension.SpringExtensionFactory 1.AdaptiveÊ≥®Ëß£Âú®Á±ª‰∏äApaptiveÊ≥®Ëß£Âú®Á±ª‰∏äÔºåÊØîÂ¶ÇAdaptiveExtensionFactoryÊòØExtensionFactoryÁöÑÂÆûÁé∞ÔºåÂàôÁõ¥Êé•cachedAdaptiveClass = clazz„ÄÇÂõ†‰∏∫`cachedAdaptiveClassÂ∑≤Áªè‰∏ç‰∏∫nullÔºå‰∏ç‰ºöÂéªÂÜçÊâßË°åÂä®ÊÄÅÊãºÊé•Â≠óËäÇÁ†Å„ÄÇ @AdaptiveÂ¶ÇÊûúÊòØÂä†Âú®Á±ª‰∏äÔºå Ë°®Á§∫ÂΩìÂâçÁ±ªÊòØ‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑËá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπ „ÄÇÂ¶ÇÊûúÊòØÂä†Âú®ÊñπÊ≥ïÁ∫ßÂà´‰∏äÔºåË°®Á§∫ÈúÄË¶ÅÂä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™Ëá™ÈÄÇÂ∫îÊâ©Â±ïÁÇπÔºå‰πüÂ∞±ÊòØProtocol$Adaptive 1234567if (clazz.isAnnotationPresent(Adaptive.class)) &#123; if(cachedAdaptiveClass == null) &#123; cachedAdaptiveClass = clazz; &#125; else if (! cachedAdaptiveClass.equals(clazz)) &#123; throw new IllegalStateException("More than 1 adaptive class found: "+ cachedAdaptiveClass.getClass().getName()+ ", " + clazz.getClass().getName()); &#125;&#125; 12345678private Class&lt;?&gt; getAdaptiveExtensionClass() &#123; getExtensionClasses(); //Â¶ÇÊûúcachedAdaptiveClassÂ∑≤ÁªèËµãÂÄºÔºåÁõ¥Êé•ËøîÂõû if (cachedAdaptiveClass != null) &#123; return cachedAdaptiveClass; &#125; return cachedAdaptiveClass = createAdaptiveExtensionClass();&#125; 2.Á±ªÊ≤°ÊúâAdaptiveÊ≥®Ëß£Â¶ÇÊûúÁ±ªÊ≤°ÊúâAdaptiveÊ≥®Ëß£ÔºåÊØîÂ¶ÇSpringExtensionFactoryÔºå‰∏çÂ≠òÂú®ÔºàExtensionFactoryÔºâÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåËµ∞catchÁöÑÈÄªËæëÔºåspring=com.alibaba.dubbo.config.spring.extension.SpringExtensionFactoryÔºåÊúÄÂêéÂàÜÂà´ÂêëcachedNamesÂíåextensionClassesÂ≠òÂÖ•key value : Â≠óÁ¨¶‰∏≤springÂíåSpringExtensionFactoryÁöÑclassÂ≠óËäÇÁ†Å„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344else &#123; try &#123; clazz.getConstructor(type); Set&lt;Class&lt;?&gt;&gt; wrappers = cachedWrapperClasses; if (wrappers == null) &#123; cachedWrapperClasses = new ConcurrentHashSet&lt;Class&lt;?&gt;&gt;(); wrappers = cachedWrapperClasses; &#125; wrappers.add(clazz); &#125; catch (NoSuchMethodException e) &#123; //SpringExtensionFactory‰∏çÂ≠òÂú®ÔºàExtensionFactoryÔºâÁöÑÊûÑÈÄ†ÂáΩÊï∞ clazz.getConstructor(); if (name == null || name.length() == 0) &#123; name = findAnnotationName(clazz); if (name == null || name.length() == 0) &#123; if (clazz.getSimpleName().length() &gt; type.getSimpleName().length() &amp;&amp; clazz.getSimpleName().endsWith(type.getSimpleName())) &#123; name = clazz.getSimpleName().substring(0, clazz.getSimpleName().length() - type.getSimpleName().length()).toLowerCase(); &#125; else &#123; throw new IllegalStateException("No such extension name for the class " + clazz.getName() + " in the config " + url); &#125; &#125; &#125; String[] names = NAME_SEPARATOR.split(name); if (names != null &amp;&amp; names.length &gt; 0) &#123; Activate activate = clazz.getAnnotation(Activate.class); if (activate != null) &#123; cachedActivates.put(names[0], activate); &#125; for (String n : names) &#123; if (! cachedNames.containsKey(clazz)) &#123; cachedNames.put(clazz, n); &#125; Class&lt;?&gt; c = extensionClasses.get(n); if (c == null) &#123; extensionClasses.put(n, clazz); &#125; else if (c != clazz) &#123; throw new IllegalStateException("Duplicate extension " + type.getName() + " name " + n + " on " + c.getName() + " and " + clazz.getName()); &#125; &#125; &#125; &#125;&#125; 3.Â≠òÂú®ÊûÑÈÄ†ÂáΩÊï∞ProtocolListenerWrapperÂ≠òÂú®ÊûÑÈÄ†ÂáΩÊï∞ProtocolListenerWrapper(Protocol protocol)ÔºåÂàôÂêëwrappersÈõÜÂêà‰∏≠Ê∑ªÂä†clazz Â¶ÇÊûúÊ≤°Êúâ Adaptive Ê≥®Ëß£ÔºåÂàôÂà§Êñ≠ÂΩìÂâçÁ±ªÊòØÂê¶Â∏¶ÊúâÂèÇÊï∞ÊòØ type Á±ªÂûãÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂ¶ÇÊûúÊúâÔºåÂàôËÆ§‰∏∫ÊòØwrapper Á±ª„ÄÇËøô‰∏™ wrapper ÂÆûÈôÖ‰∏äÂ∞±ÊòØÂØπÊâ©Â±ïÁ±ªËøõË°åË£Ö È•∞.ÂèØ ‰ª•Âú® dubbo-rpc-api/internal ‰∏ãÊâæÂà∞ Protocol Êñá‰ª∂ÔºåÂèëÁé∞ Protocol ÈÖçÁΩÆ‰∫Ü 3 ‰∏™Ë£ÖÈ•∞ÂàÜÂà´ÊòØ,filter/listener/mock. ÊâÄ‰ª• Protocol Ëøô‰∏™ÂÆû ‰æãÊù•ËØ¥Ôºå‰ºöÂ¢ûÂä†ÂØπÂ∫îÁöÑË£ÖÈ•∞Âô® 1234567clazz.getConstructor(type); Set&lt;Class&lt;?&gt;&gt; wrappers = cachedWrapperClasses; if (wrappers == null) &#123; cachedWrapperClasses = new ConcurrentHashSet&lt;Class&lt;?&gt;&gt;(); wrappers = cachedWrapperClasses; &#125; wrappers.add(clazz); 3. ExtensionFactory12ExtensionLoader.getExtensionLoader(ExtensionFactory.class).getAdaptiveExtension() Object object = objectFactory.getExtension(pt, property); objectFactory =&gt; AdaptiveExtensionFactory AdaptiveExtensionFactory123456789public &lt;T&gt; T getExtension(Class&lt;T&gt; type, String name) &#123; for (ExtensionFactory factory : factories) &#123; T extension = factory.getExtension(type, name); if (extension != null) &#123; return extension; &#125; &#125; return null;&#125; 1registry://127.0.0.1:2181/com.alibaba.dubbo.registry.RegistryService?application=dubbo-client&amp;dubbo=2.5.3&amp;owner=joey&amp;pid=57644&amp;registry=zookeeper&amp;timestamp=1529844392952 1234 if (urls.size() == 1) &#123; invoker = refprotocol.refer(interfaceClass, urls.get(0)); &#125;//ËøôÈáåinvoker‰∏∫ MockClusterInvoker 12345678public com.alibaba.dubbo.rpc.Invoker refer(java.lang.Class arg0, com.alibaba.dubbo.common.URL arg1) &#123; if (arg1 == null) throw new IllegalArgumentException("url == null"); com.alibaba.dubbo.common.URL url = arg1; String extName = ( url.getProtocol() == null ? "dubbo" : url.getProtocol() ); if(extName == null) throw new IllegalStateException("Fail to get extension(com.alibaba.dubbo.rpc.Protocol) name from url(" + url.toString() + ") use keys([protocol])"); com.alibaba.dubbo.rpc.Protocol extension = (com.alibaba.dubbo.rpc.Protocol)ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.rpc.Protocol.class).getExtension(extName); return extension.refer(arg0, arg1);&#125; 12345678910111213141516171819public &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; type, URL url) throws RpcException &#123; url = url.setProtocol(url.getParameter(Constants.REGISTRY_KEY, Constants.DEFAULT_REGISTRY)).removeParameter(Constants.REGISTRY_KEY); //Ëé∑ÂæóÊ≥®ÂÜå‰∏≠ÂøÉ Registry registry = registryFactory.getRegistry(url); if (RegistryService.class.equals(type)) &#123; return proxyFactory.getInvoker((T) registry, type, url); &#125; // group="a,b" or group="*" Map&lt;String, String&gt; qs = StringUtils.parseQueryString(url.getParameterAndDecoded(Constants.REFER_KEY)); String group = qs.get(Constants.GROUP_KEY); if (group != null &amp;&amp; group.length() &gt; 0 ) &#123; if ( ( Constants.COMMA_SPLIT_PATTERN.split( group ) ).length &gt; 1 || "*".equals( group ) ) &#123; return doRefer( getMergeableCluster(), registry, type, url ); &#125; &#125; return doRefer(cluster, registry, type, url); &#125; 1234567891011121314151617private &lt;T&gt; Invoker&lt;T&gt; doRefer(Cluster cluster, Registry registry, Class&lt;T&gt; type, URL url) &#123; RegistryDirectory&lt;T&gt; directory = new RegistryDirectory&lt;T&gt;(type, url); directory.setRegistry(registry); directory.setProtocol(protocol); URL subscribeUrl = new URL(Constants.CONSUMER_PROTOCOL, NetUtils.getLocalHost(), 0, type.getName(), directory.getUrl().getParameters()); if (! Constants.ANY_VALUE.equals(url.getServiceInterface()) &amp;&amp; url.getParameter(Constants.REGISTER_KEY, true)) &#123; //Â∞ÜÊ∂àË¥πËÄÖÁöÑÂú∞ÂùÄÊ≥®ÂÜåÂà∞zk registry.register(subscribeUrl.addParameters(Constants.CATEGORY_KEY, Constants.CONSUMERS_CATEGORY, Constants.CHECK_KEY, String.valueOf(false))); &#125; directory.subscribe(subscribeUrl.addParameter(Constants.CATEGORY_KEY, Constants.PROVIDERS_CATEGORY + "," + Constants.CONFIGURATORS_CATEGORY + "," + Constants.ROUTERS_CATEGORY)); return cluster.join(directory);&#125; 1234directory.subscribe(subscribeUrl.addParameter(Constants.CATEGORY_KEY, Constants.PROVIDERS_CATEGORY + "," + Constants.CONFIGURATORS_CATEGORY + "," + Constants.ROUTERS_CATEGORY)); url = zookeeper://127.0.0.1:2181/com.alibaba.dubbo.registry.RegistryService?application=dubbo-client&amp;dubbo=2.5.3&amp;owner=joey&amp;pid=57644&amp;refer=application%3Ddubbo-client%26dubbo%3D2.5.3%26interface%3Dcom.joey.hello.IhelloService%26methods%3DsayHello%26owner%3Djoey%26pid%3D57644%26side%3Dconsumer%26timestamp%3D1529844387888&amp;timestamp=1529844392952 123456789mock=com.alibaba.dubbo.rpc.cluster.support.wrapper.MockClusterWrapperfailover=com.alibaba.dubbo.rpc.cluster.support.FailoverClusterfailfast=com.alibaba.dubbo.rpc.cluster.support.FailfastClusterfailsafe=com.alibaba.dubbo.rpc.cluster.support.FailsafeClusterfailback=com.alibaba.dubbo.rpc.cluster.support.FailbackClusterforking=com.alibaba.dubbo.rpc.cluster.support.ForkingClusteravailable=com.alibaba.dubbo.rpc.cluster.support.AvailableClustermergeable=com.alibaba.dubbo.rpc.cluster.support.MergeableClusterbroadcast=com.alibaba.dubbo.rpc.cluster.support.BroadcastCluster MockClusterWrapperÂ≠òÂú®MockClusterWrapper(Cluster cluster)ÔºåÊâÄ‰ª•‰ºöÂ∞ÜFailfastClusterÁ≠âËøõË°åÂåÖË£ÖÔºåÊòØÂ§±Ë¥•ÈôçÁ∫ßÁî®ÁöÑ„ÄÇ 1234567891011121314public class MockClusterWrapper implements Cluster &#123; private Cluster cluster; public MockClusterWrapper(Cluster cluster) &#123; this.cluster = cluster; &#125; public &lt;T&gt; Invoker&lt;T&gt; join(Directory&lt;T&gt; directory) throws RpcException &#123; return new MockClusterInvoker&lt;T&gt;(directory, this.cluster.join(directory)); &#125;&#125; ProxyFactory$Adaptive StubProxyFactoryWrapperÂ≠òÂú®ÊûÑÈÄ†ÂáΩÊï∞ÔºåÊòØwrapperÔºå‰ºöÊääJavassistProxyFactoryÂåÖË£Ö 123public StubProxyFactoryWrapper(ProxyFactory proxyFactory) &#123; this.proxyFactory = proxyFactory;&#125; ÊúÄÁªàËøòÊòØJavassistProxyFactory Proxy123456789// create Proxy class.String fcn = Proxy.class.getName() + id;ccm = ClassGenerator.newInstance(cl);ccm.setClassName(fcn);ccm.addDefaultConstructor();ccm.setSuperClass(Proxy.class);ccm.addMethod("public Object newInstance(" + InvocationHandler.class.getName() + " h)&#123; return new " + pcn + "($1); &#125;");Class&lt;?&gt; pc = ccm.toClass();proxy = (Proxy)pc.newInstance(); ccm method debugÁöÑÁªìÊûú 12345public java.lang.String sayHello(java.lang.String arg0)&#123;Object[] args = new Object[1]; args[0] = ($w)$1;Object ret = handler.invoke(this, methods[0], args);return (java.lang.String)ret;&#125; 1public java.lang.Object $echo(java.lang.Object arg0)&#123;Object[] args = new Object[1]; args[0] = ($w)$1; Object ret = handler.invoke(this, methods[1], args); return (java.lang.Object)ret;&#125; Proxy0 hander invoker :interface com.joey.hello.IhelloService -&gt; zookeeper://127.0.0.1:2181/com.alibaba.dubbo.registry.RegistryService?anyhost=true&amp;application=dubbo-client&amp;check=false&amp;dubbo=2.5.3&amp;interface=com.joey.hello.IhelloService&amp;methods=sayHello&amp;owner=joey&amp;pid=57718&amp;side=consumer&amp;timestamp=1529847722831,directory: com.alibaba.dubbo.registry.integration.RegistryDirectory@3cfdd820 1234567891011121314151617181920212223List&lt;URL&gt; urls = new ArrayList&lt;URL&gt;();for (String path : toCategoriesPath(url)) &#123; ConcurrentMap&lt;NotifyListener, ChildListener&gt; listeners = zkListeners.get(url); if (listeners == null) &#123; zkListeners.putIfAbsent(url, new ConcurrentHashMap&lt;NotifyListener, ChildListener&gt;()); listeners = zkListeners.get(url); &#125; ChildListener zkListener = listeners.get(listener); if (zkListener == null) &#123; listeners.putIfAbsent(listener, new ChildListener() &#123; public void childChanged(String parentPath, List&lt;String&gt; currentChilds) &#123; ZookeeperRegistry.this.notify(url, listener, toUrlsWithEmpty(url, parentPath, currentChilds)); &#125; &#125;); zkListener = listeners.get(listener); &#125; zkClient.create(path, false); List&lt;String&gt; children = zkClient.addChildListener(path, zkListener); if (children != null) &#123; urls.addAll(toUrlsWithEmpty(url, path, children)); &#125;&#125;notify(url, listener, urls); AbstractRegistry1234567for (Map.Entry&lt;String, List&lt;URL&gt;&gt; entry : result.entrySet()) &#123; String category = entry.getKey(); List&lt;URL&gt; categoryList = entry.getValue(); categoryNotified.put(category, categoryList); saveProperties(url); listener.notify(categoryList);&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142/** * Ê†πÊçÆinvokerURLÂàóË°®ËΩ¨Êç¢‰∏∫invokerÂàóË°®„ÄÇËΩ¨Êç¢ËßÑÂàôÂ¶Ç‰∏ãÔºö * 1.Â¶ÇÊûúurlÂ∑≤ÁªèË¢´ËΩ¨Êç¢‰∏∫invokerÔºåÂàô‰∏çÂú®ÈáçÊñ∞ÂºïÁî®ÔºåÁõ¥Êé•‰ªéÁºìÂ≠ò‰∏≠Ëé∑ÂèñÔºåÊ≥®ÊÑèÂ¶ÇÊûúurl‰∏≠‰ªª‰Ωï‰∏Ä‰∏™ÂèÇÊï∞ÂèòÊõ¥‰πü‰ºöÈáçÊñ∞ÂºïÁî® * 2.Â¶ÇÊûú‰º†ÂÖ•ÁöÑinvokerÂàóË°®‰∏ç‰∏∫Á©∫ÔºåÂàôË°®Á§∫ÊúÄÊñ∞ÁöÑinvokerÂàóË°® * 3.Â¶ÇÊûú‰º†ÂÖ•ÁöÑinvokerUrlÂàóË°®ÊòØÁ©∫ÔºåÂàôË°®Á§∫Âè™ÊòØ‰∏ãÂèëÁöÑoverrideËßÑÂàôÊàñrouteËßÑÂàôÔºåÈúÄË¶ÅÈáçÊñ∞‰∫§ÂèâÂØπÊØîÔºåÂÜ≥ÂÆöÊòØÂê¶ÈúÄË¶ÅÈáçÊñ∞ÂºïÁî®„ÄÇ * @param invokerUrls ‰º†ÂÖ•ÁöÑÂèÇÊï∞‰∏çËÉΩ‰∏∫null */private void refreshInvoker(List&lt;URL&gt; invokerUrls)&#123; if (invokerUrls != null &amp;&amp; invokerUrls.size() == 1 &amp;&amp; invokerUrls.get(0) != null &amp;&amp; Constants.EMPTY_PROTOCOL.equals(invokerUrls.get(0).getProtocol())) &#123; this.forbidden = true; // Á¶ÅÊ≠¢ËÆøÈóÆ this.methodInvokerMap = null; // ÁΩÆÁ©∫ÂàóË°® destroyAllInvokers(); // ÂÖ≥Èó≠ÊâÄÊúâInvoker &#125; else &#123; this.forbidden = false; // ÂÖÅËÆ∏ËÆøÈóÆ Map&lt;String, Invoker&lt;T&gt;&gt; oldUrlInvokerMap = this.urlInvokerMap; // local reference if (invokerUrls.size() == 0 &amp;&amp; this.cachedInvokerUrls != null)&#123; invokerUrls.addAll(this.cachedInvokerUrls); &#125; else &#123; this.cachedInvokerUrls = new HashSet&lt;URL&gt;(); this.cachedInvokerUrls.addAll(invokerUrls);//ÁºìÂ≠òinvokerUrlsÂàóË°®Ôºå‰æø‰∫é‰∫§ÂèâÂØπÊØî &#125; if (invokerUrls.size() ==0 )&#123; return; &#125; Map&lt;String, Invoker&lt;T&gt;&gt; newUrlInvokerMap = toInvokers(invokerUrls) ;// Â∞ÜURLÂàóË°®ËΩ¨ÊàêInvokerÂàóË°® Map&lt;String, List&lt;Invoker&lt;T&gt;&gt;&gt; newMethodInvokerMap = toMethodInvokers(newUrlInvokerMap); // Êç¢ÊñπÊ≥ïÂêçÊò†Â∞ÑInvokerÂàóË°® // state change //Â¶ÇÊûúËÆ°ÁÆóÈîôËØØÔºåÂàô‰∏çËøõË°åÂ§ÑÁêÜ. if (newUrlInvokerMap == null || newUrlInvokerMap.size() == 0 )&#123; logger.error(new IllegalStateException("urls to invokers error .invokerUrls.size :"+invokerUrls.size() + ", invoker.size :0. urls :"+invokerUrls.toString())); return ; &#125; this.methodInvokerMap = multiGroup ? toMergeMethodInvokerMap(newMethodInvokerMap) : newMethodInvokerMap; this.urlInvokerMap = newUrlInvokerMap; try&#123; destroyUnusedInvokers(oldUrlInvokerMap,newUrlInvokerMap); // ÂÖ≥Èó≠Êú™‰ΩøÁî®ÁöÑInvoker &#125;catch (Exception e) &#123; logger.warn("destroyUnusedInvokers error. ", e); &#125; &#125;&#125; filter(listener(dubboProtocol)) DubboProtocol 123456public &lt;T&gt; Invoker&lt;T&gt; refer(Class&lt;T&gt; serviceType, URL url) throws RpcException &#123; // create rpc invoker. DubboInvoker&lt;T&gt; invoker = new DubboInvoker&lt;T&gt;(serviceType, url, getClients(url), invokers); invokers.add(invoker); return invoker;&#125; 12Map&lt;String, Invoker&lt;T&gt;&gt; newUrlInvokerMap = toInvokers(invokerUrls) ;// Â∞ÜURLÂàóË°®ËΩ¨ÊàêInvokerÂàóË°®Map&lt;String, List&lt;Invoker&lt;T&gt;&gt;&gt; newMethodInvokerMap = toMethodInvokers(newUrlInvokerMap); // Êç¢ÊñπÊ≥ïÂêçÊò†Â∞ÑInvokerÂàóË°® MockClusterInvoker invoke -&gt; 1MockClusterInvoker 4.dubbo SPIÊú∫Âà∂Â§ßÈÉ®ÂàÜÁöÑÊÄùÊÉ≥ÈÉΩÊòØÂíå SPI ÊòØ‰∏ÄÊ†∑ÔºåÂè™ÊòØ‰∏ãÈù¢‰∏§‰∏™Âú∞ÊñπÊúâÂ∑Æ ÂºÇ„ÄÇ ÈúÄË¶ÅÂú® resource ÁõÆÂΩï‰∏ãÈÖçÁΩÆ META-INF/dubbo ÊàñËÄÖ META-INF/dubbo/internal ÊàñËÄÖ META-INF/servicesÔºåÂπ∂Âü∫ ‰∫é SPI Êé•Âè£ÂéªÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂ Êñá‰ª∂ÂêçÁß∞ÂíåÊé•Âè£ÂêçÁß∞‰øùÊåÅ‰∏ÄËá¥ÔºåÊñá‰ª∂ÂÜÖÂÆπÂíå SPI ÊúâÂ∑ÆÂºÇÔºå ÂÜÖÂÆπÊòØ KEY ÂØπÂ∫î Value Â¶ÇÊûúÁ±ªÊ≤°ÊúâAdaptiveÊ≥®Ëß£ÔºåÊØîÂ¶ÇSpringExtensionFactoryÔºå‰∏çÂ≠òÂú®ÔºàExtensionFactoryÔºâÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåËµ∞catchÁöÑÈÄªËæëÔºåspring=com.alibaba.dubbo.config.spring.extension.SpringExtensionFactoryÔºåÊúÄÂêéÂàÜÂà´ÂêëcachedNamesÂíåextensionClassesÂ≠òÂÖ•key value : Â≠óÁ¨¶‰∏≤springÂíåSpringExtensionFactoryÁöÑclassÂ≠óËäÇÁ†Å„ÄÇ]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TCPÂçèËÆÆËØ¶Ëß£]]></title>
    <url>%2F2018%2F06%2F21%2FTCP%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[TCP‰∏âÊ¨°Êè°Êâã Client A Â∫èÂè∑ Server B ‚Äî‚Äî1‚Äî‚Äî&gt; &lt;‚Äî‚Äî2‚Äî‚Äî ‚Äî‚Äî3‚Äî‚Äî&gt; ClientA -&gt; ServerB: SYN=1, ACK=0 , Â∫èÂàóÂè∑seq=x „ÄÇ Ê≠§Êó∂ÔºåTCPÂÆ¢Êà∑Á´ØClientAËøõÁ®ãËøõÂÖ•‰∫Ü SYN-SENTÔºàÂêåÊ≠•Â∑≤ÂèëÈÄÅÁä∂ÊÄÅÔºâÁä∂ÊÄÅ„ÄÇTCPËßÑÂÆöÔºåSYNÊä•ÊñáÊÆµÔºàSYN=1ÁöÑÊä•ÊñáÊÆµÔºâ‰∏çËÉΩÊê∫Â∏¶Êï∞ÊçÆÔºå‰ΩÜÈúÄË¶ÅÊ∂àËÄóÊéâ‰∏Ä‰∏™Â∫èÂè∑„ÄÇ ServerB -&gt; ClientA: SYN=1, ACK=1 , Â∫èÂàóÂè∑seq=y , Á°ÆËÆ§Âè∑ack=x+1 „ÄÇÊ≠§Êó∂ÔºåServerBËøõÂÖ•SYN-RCVDÂêåÊ≠•Êî∂Âà∞Áä∂ÊÄÅ„ÄÇSNCÊä•ÊñáÊÆµ‰∏çËÉΩÊê∫Â∏¶Êï∞ÊçÆÔºå‰ΩÜÊòØÈúÄË¶ÅÊ∂àËÄó‰∏Ä‰∏™Â∫èÂàóÂè∑„ÄÇ ClientA -&gt; ServerB: ACK=1, seq=x+1 , ack=y+1 „ÄÇclinetAÂèëÈÄÅÂêéËøõÂÖ•ESTABLISHEDÔºàÂ∑≤Âª∫Á´ãËøûÊé•ÔºâÁä∂ÊÄÅÔºåserverBÊî∂Âà∞Âêé=Ôºå‰πüËøõÂÖ•ESTABLISHEDÔºàÂ∑≤Âª∫Á´ãËøûÊé•ÔºâÁä∂ÊÄÅ„ÄÇ TCPËßÑÂÆöÔºåACKÊä•ÊñáÊÆµÂèØ‰ª•Êê∫Â∏¶Êï∞ÊçÆÔºå‰ΩÜÊòØÂ¶ÇÊûú‰∏çÊê∫Â∏¶Êï∞ÊçÆÂàô‰∏çÊ∂àËÄóÂ∫èÂè∑„ÄÇ ACK: TCPÂçèËÆÆËßÑÂÆöÔºåÂè™ÊúâACK=1Êó∂ÊúâÊïàÔºå‰πüËßÑÂÆöËøûÊé•Âª∫Á´ãÂêéÊâÄÊúâÂèëÈÄÅÁöÑÊä•ÊñáÁöÑACKÂøÖÈ°ª‰∏∫1 SYN(SYNchronization) Ôºö Âú®ËøûÊé•Âª∫Á´ãÊó∂Áî®Êù•ÂêåÊ≠•Â∫èÂè∑„ÄÇ ÂΩìSYN=1ÔºåACK=0Êó∂ÔºåË°®ÊòéËøôÊòØ‰∏Ä‰∏™ËøûÊé•ËØ∑Ê±ÇÊä•Êñá„ÄÇÂØπÊñπËã•ÂêåÊÑèÂª∫Á´ãËøûÊé•ÔºåÂàôÂ∫îÂú®ÂìçÂ∫îÊä•Êñá‰∏≠‰ΩøSYN=1ÔºåACK=1„ÄÇ FINÔºåÁî®Êù•ÈáäÊîæËøûÊé•„ÄÇÂΩìFIN=1ÔºåË°®ÊòéÊ≠§Êä•ÊñáÁöÑÂèëÈÄÅÊñπÁöÑÊï∞ÊçÆÂ∑≤ÁªèÂèëÈÄÅÂÆåÊØïÔºåÂπ∂‰∏îË¶ÅÊ±ÇÈáäÊîæ„ÄÇ ‰∏∫‰ªÄ‰πàÈúÄË¶Å‰∏âÊ¨°Êè°ÊâãÔºåËÄå‰∏çÊòØ‰∏§Ê¨°‚Äã clientA Á¨¨‰∏ÄÊ¨°Âú®Ê≠•È™§1‰∏≠ÂèëÈÄÅ‰∏Ä‰∏™ËØ∑Ê±ÇÔºåÁî±‰∫éÁΩëÁªúÂéüÂõ†ÔºåÈïøÊó∂Èó¥Ê≤°ÊúâÊî∂Âà∞ServerBÁ°ÆËÆ§ÂõûÂ§ç„ÄÇ‰∫éÊòØÔºåclientAÁ¨¨‰∫åÊ¨°ÂèëÈÄÅËØ∑Ê±ÇÔºåÊàêÂäüÂª∫Á´ãËøûÊé•ÔºåÂ§ÑÁêÜÂÆåÊàêÂêéÔºåÂÖ≥Èó≠ËøûÊé•„ÄÇ‰ΩÜÊòØÔºåÁ¨¨‰∏ÄÊ¨°ÁöÑËØ∑Ê±ÇÁªèËøáÊº´ÈïøÁöÑ‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºåÂà∞Ëææ‰∫ÜServerBÔºåÂπ∂‰∏îÁªô‰∫ÜÂõûÂ§çÁ°ÆËÆ§„ÄÇÂç≥Â∑≤Â§±ÊïàÁöÑËØ∑Ê±ÇËøûÊé•Êä•ÊñáÊÆµ„ÄÇ ‚Äã Â¶ÇÊûúÂè™Êúâ‰∏§Ê¨°Êè°ÊâãÔºåÈÇ£‰πàÁ¨¨‰∏ÄÊ¨°ÁöÑËøô‰∏™ËøûÊé•Â∞±Âª∫Á´ã‰∫ÜÔºåÂÆûÈôÖÊòØ‰∏çÂ∫îËØ•Âª∫Á´ãÁöÑÔºåÂØºËá¥‰∏çË¶ÅÁöÑÈîôËØØÂíåËµÑÊ∫êÊµ™Ë¥π„ÄÇ ‚Äã ÈááÁî®‰∏âÊ¨°Êè°ÊâãÔºåÂ∞±ÂèØ‰ª•Èò≤Ê≠¢‰∏äÈù¢ÁöÑÈóÆÈ¢ò„ÄÇclientAÂØπ‰∫éÁöÑServerBÁöÑÂõûÂ§çÁ°ÆËÆ§‰∏ç‰∫àÁêÜÁù¨ÔºåServerBÊî∂‰∏çÂà∞clinetAÁöÑÁ¨¨‰∏âÊ¨°ÂõûÂ§çÔºåËøôÊ†∑Â∞±‰∏ç‰ºöÊµ™Ë¥πÂª∫Á´ãÊñ∞ÁöÑËøûÊé•„ÄÇ TCPÂõõÊ¨°Êå•Êâã Client A Â∫èÂè∑ Server B ‚Äî‚Äî1‚Äî‚Äî&gt; &lt;‚Äî‚Äî2‚Äî‚Äî &lt;‚Äî‚Äî3‚Äî‚Äî ‚Äî‚Äî4‚Äî‚Äî&gt; clientA -&gt; ServerB : FIN=1 , Â∫èÂàóÂè∑seq=uÔºàÁ≠â‰∫éÂâçÈù¢Â∑≤Áªè‰º†ÈÄÅËøáÊù•ÁöÑÊï∞ÊçÆÁöÑÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÁöÑÂ∫èÂè∑Âä†1Ôºâ „ÄÇ Ê≠§Êó∂ClientA‰ªéESTABLISHEDÂª∫Á´ãËøûÊé•Áä∂ÊÄÅÂèò‰∏∫FIN-WAIT-1ÁªàÊ≠¢Á≠âÂæÖ1Áä∂ÊÄÅ„ÄÇTCPËßÑÂÆöÔºåFINÊä•ÊñáÊÆµÂç≥‰Ωø‰∏çÊê∫Â∏¶Êï∞ÊçÆÔºå‰πüË¶ÅÊ∂àËÄó‰∏Ä‰∏™Â∫èÂè∑„ÄÇ ServerB -&gt; clientA : ACK=1 , seq=v , ack=u+1 „ÄÇ Ê≠§Êó∂Ôºå ServerB‰ªéESTABLISHEDÂª∫Á´ãËøûÊé•Áä∂ÊÄÅÂèò‰∏∫CLOSE-WAITÂÖ≥Èó≠Á≠âÂæÖÁä∂ÊÄÅ„ÄÇclientAÊî∂Âà∞ÂêéÔºåÂèò‰∏∫FIN-WAIT-2ÁªàÊ≠¢Á≠âÂæÖ2Áä∂ÊÄÅ„ÄÇ Âç≥ÂÆ¢Êà∑Á´ØÂ∑≤ÁªèÊ≤°ÊúâÊï∞ÊçÆË¶ÅÂèëÈÄÅ‰∫ÜÔºå‰ΩÜÊòØÊúçÂä°Âô®Ëã•ÂèëÈÄÅÊï∞ÊçÆÔºåÂÆ¢Êà∑Á´Ø‰æùÁÑ∂Ë¶ÅÊé•Âèó„ÄÇ ServerB -&gt; clientA : FIN=1 , ACK=1 , seq=w , ack=u+1 „ÄÇ ÊúçÂä°Âô®ServerBÂ∞±ËøõÂÖ•‰∫ÜLAST-ACKÔºàÊúÄÂêéÁ°ÆËÆ§ÔºâÁä∂ÊÄÅÔºåÁ≠âÂæÖÂÆ¢Êà∑Á´ØÁöÑÁ°ÆËÆ§„ÄÇ clientA -&gt; ServerB : ACK=1 , seq=u+1 , ack=w+1 „ÄÇ clientAÂèëÂá∫ÂêéÔºåËøõÂÖ•TIME_WAITÁä∂ÊÄÅ„ÄÇ Ê≥®ÊÑèÊ≠§Êó∂TCPËøûÊé•ËøòÊ≤°ÊúâÈáäÊîæÔºåÂøÖÈ°ªÁªèËøá2*MSLÔºàÊúÄÈïøÊä•ÊñáÊÆµÂØøÂëΩÔºâÁöÑÊó∂Èó¥ÂêéÔºåÂΩìÂÆ¢Êà∑Á´ØÊí§ÈîÄÁõ∏Â∫îÁöÑTCBÂêéÔºåÊâçËøõÂÖ•CLOSEDÁä∂ÊÄÅ„ÄÇÊúçÂä°Âô®Âè™Ë¶ÅÊî∂Âà∞‰∫ÜÂÆ¢Êà∑Á´ØÂèëÂá∫ÁöÑÁ°ÆËÆ§ÔºåÁ´ãÂç≥ËøõÂÖ•CLOSEDÁä∂ÊÄÅ„ÄÇÂêåÊ†∑ÔºåÊí§ÈîÄTCBÂêéÔºåÂ∞±ÁªìÊùü‰∫ÜËøôÊ¨°ÁöÑTCPËøûÊé•„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåÊúçÂä°Âô®ÁªìÊùüTCPËøûÊé•ÁöÑÊó∂Èó¥Ë¶ÅÊØîÂÆ¢Êà∑Á´ØÊó©‰∏Ä‰∫õ„ÄÇ ‰∏∫‰ªÄ‰πàÂÆ¢Êà∑Á´ØÊúÄÂêéÈúÄË¶ÅÁ≠âÂæÖ2MSL]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[sublime user setting]]></title>
    <url>%2F2018%2F06%2F19%2Fsublime-user-setting%2F</url>
    <content type="text"><![CDATA[Sublime3 Preferences -&gt; settings UserÈÖçÁΩÆ 12345678910111213141516171819202122&#123; "atomic_save": true, "color_scheme": "Packages/Color Scheme - Default/Mariana.sublime-color-scheme", "draw_white_space": "all", "font_face": "YaHei Consolas Hybrid", "font_size": 14, "ignored_packages": [ "Vintage" ], "open_files_in_new_window": false, "save_on_focus_lost": true, "soda_classic_tabs": true, "soda_folder_icons": true, "tab_size": 4, "theme": "Soda Light 3.sublime-theme", "translate_tabs_to_spaces": true, "trim_trailing_white_space_on_save": true, "update_check": false, "fold_buttons": true, "fade_fold_buttons": false,&#125; ÊâãÂä®ÂÆâË£Ösoda Preferences -&gt; browse packages Â∞ÜTheme - SodaËß£ÂéãÊîæÂà∞ÁõÆÂΩïÔºåÂêå‰∏ÄÁ∫ßÁöÑËøòÊúâPretty JSON User ‰∏≠ÊñáÁΩë http://www.sublimetextcn.com/ Âà†Èô§Á©∫Ë°åCTRL+HÊâìÂºÄreplaceÂäüËÉΩÔºåÂãæÈÄâ‰∏äÂ∑¶‰æßÁöÑregular expressionÔºåÂπ∂Â°´ÂÜô find whatÊ†è : \s+$ ÔºàÊ≠£ÂàôË°®ËææÂºèÔºâreplace withÊ†è : ÔºàËøôË°åÁïôÁ©∫Ôºâ Êìç‰ΩúÂ§öË°å5ÁßçÊñπÊ≥ï 1ÔºåÈº†Ê†áÈÄâ‰∏≠Â§öË°åÔºåÊåâ‰∏ã Ctrl Shift L (Command Shift L) Âç≥ÂèØÂêåÊó∂ÁºñËæëËøô‰∫õË°åÔºõ2ÔºåÈº†Ê†áÈÄâ‰∏≠ÊñáÊú¨ÔºåÂèçÂ§çÊåâ CTRL D (Command D) Âç≥ÂèØÁªßÁª≠Âêë‰∏ãÂêåÊó∂ÈÄâ‰∏≠‰∏ã‰∏Ä‰∏™Áõ∏ÂêåÁöÑÊñáÊú¨ËøõË°åÂêåÊó∂ÁºñËæëÔºõ3ÔºåÈº†Ê†áÈÄâ‰∏≠ÊñáÊú¨ÔºåÊåâ‰∏ã Alt F3 (Win) Êàñ Ctrl Command G(Mac) Âç≥ÂèØ‰∏ÄÊ¨°ÊÄßÈÄâÊã©ÂÖ®ÈÉ®ÁöÑÁõ∏ÂêåÊñáÊú¨ËøõË°åÂêåÊó∂ÁºñËæëÔºõ4ÔºåShift Èº†Ê†áÂè≥ÈîÆ (Win) Êàñ Option Èº†Ê†áÂ∑¶ÈîÆ (Mac) Êàñ‰ΩøÁî®Èº†Ê†á‰∏≠ÈîÆÂèØ‰ª•Áî®Èº†Ê†áËøõË°åÁ´ñÂêëÂ§öË°åÈÄâÊã©Ôºõ5ÔºåCtrl Èº†Ê†áÂ∑¶ÈîÆ(Win) Êàñ Command Èº†Ê†áÂ∑¶ÈîÆ(Mac) ÂèØ‰ª•ÊâãÂä®ÈÄâÊã©ÂêåÊó∂Ë¶ÅÁºñËæë„ÄÇ]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[telnetÂëΩ‰ª§ËØ¶Ëß£]]></title>
    <url>%2F2018%2F06%2F12%2Ftelnet%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[telnetÂëΩ‰ª§Áî®‰∫éÁôªÂΩïËøúÁ®ã‰∏ªÊú∫ÔºåÂØπËøúÁ®ã‰∏ªÊú∫ËøõË°åÁÆ°ÁêÜ„ÄÇtelnetÂõ†‰∏∫ÈááÁî®ÊòéÊñá‰º†ÈÄÅÊä•ÊñáÔºåÂÆâÂÖ®ÊÄß‰∏çÂ•ΩÔºåÂæàÂ§öLinuxÊúçÂä°Âô®ÈÉΩ‰∏çÂºÄÊîætelnetÊúçÂä°ÔºåËÄåÊîπÁî®Êõ¥ÂÆâÂÖ®ÁöÑsshÊñπÂºè‰∫Ü„ÄÇ‰ΩÜ‰ªçÁÑ∂ÊúâÂæàÂ§öÂà´ÁöÑÁ≥ªÁªüÂèØËÉΩÈááÁî®‰∫ÜtelnetÊñπÂºèÊù•Êèê‰æõËøúÁ®ãÁôªÂΩïÔºåÂõ†Ê≠§ÂºÑÊ∏ÖÊ•ötelnetÂÆ¢Êà∑Á´ØÁöÑ‰ΩøÁî®ÊñπÂºè‰ªçÊòØÂæàÊúâÂøÖË¶ÅÁöÑ„ÄÇ ËØ≠Ê≥ï1telnet(ÈÄâÈ°π)(ÂèÇÊï∞) ÈÄâÈ°π123456789101112131415161718-8ÔºöÂÖÅËÆ∏‰ΩøÁî®8‰ΩçÂ≠óÁ¨¶ËµÑÊñôÔºåÂåÖÊã¨ËæìÂÖ•‰∏éËæìÂá∫Ôºõ-aÔºöÂ∞ùËØïËá™Âä®ÁôªÂÖ•ËøúÁ´ØÁ≥ªÁªüÔºõ-b&lt;‰∏ªÊú∫Âà´Âêç&gt;Ôºö‰ΩøÁî®Âà´ÂêçÊåáÂÆöËøúÁ´Ø‰∏ªÊú∫ÂêçÁß∞Ôºõ-cÔºö‰∏çËØªÂèñÁî®Êà∑‰∏ìÂ±ûÁõÆÂΩïÈáåÁöÑ.telnetrcÊñá‰ª∂Ôºõ-dÔºöÂêØÂä®ÊéíÈîôÊ®°ÂºèÔºõ-e&lt;ËÑ±Á¶ªÂ≠óÁ¨¶&gt;ÔºöËÆæÁΩÆËÑ±Á¶ªÂ≠óÁ¨¶Ôºõ-EÔºöÊª§Èô§ËÑ±Á¶ªÂ≠óÁ¨¶Ôºõ-fÔºöÊ≠§ÂèÇÊï∞ÁöÑÊïàÊûúÂíåÊåáÂÆö"-F"ÂèÇÊï∞Áõ∏ÂêåÔºõ-FÔºö‰ΩøÁî®Kerberos V5ËÆ§ËØÅÊó∂ÔºåÂä†‰∏äÊ≠§ÂèÇÊï∞ÂèØÊääÊú¨Âú∞‰∏ªÊú∫ÁöÑËÆ§ËØÅÊï∞ÊçÆ‰∏ä‰º†Âà∞ËøúÁ´Ø‰∏ªÊú∫Ôºõ-k&lt;ÂüüÂêç&gt;Ôºö‰ΩøÁî®KerberosËÆ§ËØÅÊó∂ÔºåÂä†‰∏äÊ≠§ÂèÇÊï∞ËÆ©ËøúÁ´Ø‰∏ªÊú∫ÈááÁî®ÊåáÂÆöÁöÑÈ¢ÜÂüüÂêçÔºåËÄåÈùûËØ•‰∏ªÊú∫ÁöÑÂüüÂêçÔºõ-KÔºö‰∏çËá™Âä®ÁôªÂÖ•ËøúÁ´Ø‰∏ªÊú∫Ôºõ-l&lt;Áî®Êà∑ÂêçÁß∞&gt;ÔºöÊåáÂÆöË¶ÅÁôªÂÖ•ËøúÁ´Ø‰∏ªÊú∫ÁöÑÁî®Êà∑ÂêçÁß∞Ôºõ-LÔºöÂÖÅËÆ∏ËæìÂá∫8‰ΩçÂ≠óÁ¨¶ËµÑÊñôÔºõ-n&lt;ËÆ∞ÂΩïÊñá‰ª∂&gt;ÔºöÊåáÂÆöÊñá‰ª∂ËÆ∞ÂΩïÁõ∏ÂÖ≥‰ø°ÊÅØÔºõ-rÔºö‰ΩøÁî®Á±ª‰ººrloginÊåá‰ª§ÁöÑÁî®Êà∑ÁïåÈù¢Ôºõ-S&lt;ÊúçÂä°Á±ªÂûã&gt;ÔºöËÆæÁΩÆtelnetËøûÁ∫øÊâÄÈúÄÁöÑip TOS‰ø°ÊÅØÔºõ-xÔºöÂÅáËÆæ‰∏ªÊú∫ÊúâÊîØÊåÅÊï∞ÊçÆÂä†ÂØÜÁöÑÂäüËÉΩÔºåÂ∞±‰ΩøÁî®ÂÆÉÔºõ-X&lt;ËÆ§ËØÅÂΩ¢ÊÄÅ&gt;ÔºöÂÖ≥Èó≠ÊåáÂÆöÁöÑËÆ§ËØÅÂΩ¢ÊÄÅ„ÄÇ ÂèÇÊï∞ ËøúÁ®ã‰∏ªÊú∫ÔºöÊåáÂÆöË¶ÅÁôªÂΩïËøõË°åÁÆ°ÁêÜÁöÑËøúÁ®ã‰∏ªÊú∫Ôºõ Á´ØÂè£ÔºöÊåáÂÆöTELNETÂçèËÆÆ‰ΩøÁî®ÁöÑÁ´ØÂè£Âè∑„ÄÇ ÂÆû‰æã12345678910telnet 192.168.2.10Trying 192.168.2.10...Connected to 192.168.2.10 (192.168.2.10).Escape character is '^]'. localhost (Linux release 2.6.18-274.18.1.el5 #1 SMP Thu Feb 9 12:45:44 EST 2012) (1)login: rootPassword:Login incorrect Á§∫‰æã1ÔºöËøúÁ®ãÊúçÂä°Âô®Êó†Ê≥ïËÆøÈóÆ 1234[root@linuxprobe ~]# telnet 192.168.120.209Trying 192.168.120.209...telnet: connect to address 192.168.120.209: No route to hosttelnet: Unable to connect to remote host: No route to host Â§ÑÁêÜËøôÁßçÊÉÖÂÜµÊñπÊ≥ïÔºöÔºà1ÔºâÁ°ÆËÆ§IPÂú∞ÂùÄÊòØÂê¶Ê≠£Á°ÆÔºà2ÔºâÁ°ÆËÆ§IPÂú∞ÂùÄÂØπÂ∫îÁöÑË£ÖÊú∫ÊòØÂê¶Â∑≤ÁªèÂºÄÊú∫Ôºà3ÔºâÂ¶ÇÊûú‰∏ªÊú∫Â∑≤ÁªèÂêØÂä®ÔºåÁ°ÆËÆ§Ë∑ØÁî±ËÆæÁΩÆÊòØÂê¶ËÆæÁΩÆÊ≠£Á°ÆÔºà‰ΩøÁî®routeÂëΩ‰ª§Êü•ÁúãÔºâÔºà4ÔºâÂ¶ÇÊûú‰∏ªÊú∫Â∑≤ÁªèÂêØÂä®ÔºåÁ°ÆËÆ§‰∏ªÊú∫‰∏äÊòØÂê¶ÂºÄÂêØ‰∫ÜtelnetÊúçÂä°Ôºà‰ΩøÁî®netstatÂëΩ‰ª§Êü•ÁúãÔºåTCPÁöÑ23Á´ØÂè£ÊòØÂê¶ÊúâLISTENÁä∂ÊÄÅË°åÔºâÔºà5ÔºâÂ¶ÇÊûú‰∏ªÊú∫Â∑≤ÁªèÂêØÂä®telnetÊúçÂä°ÔºåÁ°ÆËÆ§Èò≤ÁÅ´Â¢ôÊòØÂê¶ÂºÄÊîæ‰∫Ü23Á´ØÂè£ÁöÑËÆøÈóÆÔºà‰ΩøÁî®iptables-saveÊü•ÁúãÔºâ Á§∫‰æã2ÔºöÂüüÂêçÊó†Ê≥ïËß£Êûê 12[root@linuxprobe ~]# telnet www.baidu.comwww.baidu.com/telnet: Temporary failure in name resolution Â§ÑÁêÜËøôÁßçÊÉÖÂÜµÊñπÊ≥ïÔºöÔºà1ÔºâÁ°ÆËÆ§ÂüüÂêçÊòØÂê¶Ê≠£Á°ÆÔºà2ÔºâÁ°ÆËÆ§Êú¨Êú∫ÁöÑÂüüÂêçËß£ÊûêÊúâÂÖ≥ÁöÑËÆæÁΩÆÊòØÂê¶Ê≠£Á°Æ(/etc/resolv.conf‰∏≠nameserverÁöÑÈÖçÁΩÆÊòØÂê¶Ê≠£Á°ÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂèØ‰ª•‰ΩøÁî®nameserver 8.8.8.8)Ôºà3ÔºâÁ°ÆËÆ§Èò≤ÁÅ´Â¢ôÊòØÂê¶ÊîæÂºÄ‰∫ÜUDP53Á´ØÂè£ÁöÑËÆøÈóÆ(DNS‰ΩøÁî®UDPÂçèËÆÆÔºåÁ´ØÂè£53Ôºå‰ΩøÁî®iptables-saveÊü•Áúã) Á§∫‰æã3ÔºöÊãíÁªùËÆøÈóÆ 1234[root@linuxprobe ~]# telnet 192.168.120.206Trying 192.168.120.206...telnet: connect to address 192.168.120.206: Connection refusedtelnet: Unable to connect to remote host: Connection refused Â§ÑÁêÜËøôÁßçÊÉÖÂÜµÊñπÊ≥ïÔºöÔºà1ÔºâÁ°ÆËÆ§IPÂú∞ÂùÄÊàñËÄÖ‰∏ªÊú∫ÂêçÊòØÂê¶Ê≠£Á°ÆÔºà2ÔºâÁ°ÆËÆ§Á´ØÂè£ÊòØÂê¶Ê≠£Á°ÆÔºåÊòØÂê¶ÈªòËÆ§23Á´ØÂè£ Ëã•Ë¶ÅÊ£ÄÊü•192.168.120.206ÁöÑÊüêÁ´ØÂè£ÊòØÂê¶ËÉΩÂê¶ËÉΩËÆøÈóÆÔºåÂ¶Ç443Á´ØÂè£ÔºåÂèØ‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ 123[root@linuxprobe ~]# telnet 192.168.120.206 443Trying 192.168.120.206...telnet: connect to address 192.168.120.206: Connection refused ËØ¥ÊòéÔºöËøôË°®Á§∫192.168.120.206ÁöÑ443Á´ØÂè£‰∏çËÉΩËÆøÈóÆ Á§∫‰æã4Ôºötelnet rootÁî®Êà∑ÁöÑÁôªÂÖ• 12345678910[root@linuxprobe ~]# telnet 192.168.120.204Trying 192.168.120.204...Connected to 192.168.120.204 (192.168.120.204).Escape character is '^]'. localhost (Linux release 2.6.18-274.18.1.el5 #1 SMP Thu Feb 9 12:45:44 EST 2012) (1)login: rootPassword:Login incorrect ËØ¥ÊòéÔºö‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏çÂÖÅËÆ∏root‰ªéËøúÁ®ãÁôªÂΩïÔºåÂèØ‰ª•ÂÖàÁî®ÊôÆÈÄöË¥¶Âè∑ÁôªÂΩïÔºåÁÑ∂ÂêéÂÜçsu -ÂàáÂà∞rootÁî®Êà∑„ÄÇËã•Ë¶ÅÂÖÅËÆ∏rootÁî®Êà∑ÁôªÂÖ•ÔºåÂèØÁî®‰∏ãÂàóÊñπÊ≥ïÔºö 1234[root@linuxprobe ~]# vi /etc/pam.d/login#auth required pam_securetty.so #Â∞ÜËøô‰∏ÄË°åÂä†‰∏äÊ≥®ÈáäÔºÅÊàñ[root@linuxprobe ~]# mv /etc/securetty /etc/securetty.bak Á§∫‰æã5ÔºöÂêØÁî®telnetÊúçÂä° 123456789101112131415161718192021222324252627282930313233343536[root@linuxprobe ~]# cd /etc/xinetd.d/[root@linuxprobe xinetd.d]# llÊÄªËÆ° 124-rw-r--r-- 1 root root 1157 2011-05-31 chargen-dgram-rw-r--r-- 1 root root 1159 2011-05-31 chargen-stream-rw-r--r-- 1 root root 523 2009-09-04 cvs-rw-r--r-- 1 root root 1157 2011-05-31 daytime-dgram-rw-r--r-- 1 root root 1159 2011-05-31 daytime-stream-rw-r--r-- 1 root root 1157 2011-05-31 discard-dgram-rw-r--r-- 1 root root 1159 2011-05-31 discard-stream-rw-r--r-- 1 root root 1148 2011-05-31 echo-dgram-rw-r--r-- 1 root root 1150 2011-05-31 echo-stream-rw-r--r-- 1 root root 323 2004-09-09 eklogin-rw-r--r-- 1 root root 347 2005-09-06 ekrb5-telnet-rw-r--r-- 1 root root 326 2004-09-09 gssftp-rw-r--r-- 1 root root 310 2004-09-09 klogin-rw-r--r-- 1 root root 323 2004-09-09 krb5-telnet-rw-r--r-- 1 root root 308 2004-09-09 kshell-rw-r--r-- 1 root root 317 2004-09-09 rsync-rw-r--r-- 1 root root 1212 2011-05-31 tcpmux-server-rw-r--r-- 1 root root 1149 2011-05-31 time-dgram-rw-r--r-- 1 root root 1150 2011-05-31 time-stream[root@linuxprobe xinetd.d]# cat krb5-telnet# default: off# description: The kerberized telnet server accepts normal telnet sessions, \# but can also use Kerberos 5 authentication.service telnet&#123; flags = REUSE socket_type = stream wait = no user = root server = /usr/kerberos/sbin/telnetd log_on_failure += USERID disable = yes&#125; ÈÖçÁΩÆÂèÇÊï∞ÈÄöÂ∏∏Â¶Ç‰∏ãÔºö 12345678910111213141516171819service telnet&#123;disable = no #ÂêØÁî®flags = REUSE #socketÂèØÈáçÁî®socket_type = stream #ËøûÊé•ÊñπÂºè‰∏∫TCPwait = no #‰∏∫ÊØè‰∏™ËØ∑Ê±ÇÂêØÂä®‰∏Ä‰∏™ËøõÁ®ãuser = root #ÂêØÂä®ÊúçÂä°ÁöÑÁî®Êà∑‰∏∫rootserver = /usr/sbin/in.telnetd #Ë¶ÅÊøÄÊ¥ªÁöÑËøõÁ®ãlog_on_failure += USERID #ÁôªÂΩïÂ§±Ë¥•Êó∂ËÆ∞ÂΩïÁôªÂΩïÁî®Êà∑Âêç&#125; Â¶ÇÊûúË¶ÅÈÖçÁΩÆÂÖÅËÆ∏ÁôªÂΩïÁöÑÂÆ¢Êà∑Á´ØÂàóË°®ÔºåÂä†ÂÖ•only_from = 192.168.0.2 #Âè™ÂÖÅËÆ∏192.168.0.2ÁôªÂΩïÂ¶ÇÊûúË¶ÅÈÖçÁΩÆÁ¶ÅÊ≠¢ÁôªÂΩïÁöÑÂÆ¢Êà∑Á´ØÂàóË°®ÔºåÂä†ÂÖ•no_access = 192.168.0.{2,3,4} #Á¶ÅÊ≠¢192.168.0.2„ÄÅ192.168.0.3„ÄÅ192.168.0.4ÁôªÂΩïÂ¶ÇÊûúË¶ÅËÆæÁΩÆÂºÄÊîæÊó∂ÊÆµÔºåÂä†ÂÖ•access_times = 9:00-12:00 13:00-17:00 # ÊØèÂ§©Âè™ÊúâËøô‰∏§‰∏™Êó∂ÊÆµÂºÄÊîæÊúçÂä°ÔºàÊàë‰ª¨ÁöÑ‰∏äÁè≠Êó∂Èó¥ÔºöPÔºâÂ¶ÇÊûú‰Ω†Êúâ‰∏§‰∏™IPÂú∞ÂùÄÔºå‰∏Ä‰∏™ÊòØÁßÅÁΩëÁöÑIPÂú∞ÂùÄÂ¶Ç192.168.0.2Ôºå‰∏Ä‰∏™ÊòØÂÖ¨ÁΩëÁöÑIPÂú∞ÂùÄÂ¶Ç218.75.74.83ÔºåÂ¶ÇÊûú‰Ω†Â∏åÊúõÁî®Êà∑Âè™ËÉΩ‰ªéÁßÅÁΩëÊù•ÁôªÂΩïtelnetÊúçÂä°ÔºåÈÇ£‰πàÂä†ÂÖ•bind = 192.168.0.2ÂêÑÈÖçÁΩÆÈ°πÂÖ∑‰ΩìÁöÑÂê´‰πâÂíåËØ≠Ê≥ïÂèØÂèÇËÄÉxinedÈÖçÁΩÆÊñá‰ª∂Â±ûÊÄßËØ¥ÊòéÔºàman xinetd.confÔºâÈÖçÁΩÆÁ´ØÂè£Ôºå‰øÆÊîπservicesÊñá‰ª∂Ôºö# vi /etc/servicesÊâæÂà∞‰ª•‰∏ã‰∏§Âè•telnet 23/tcptelnet 23/udpÂ¶Ç ÊûúÂâçÈù¢Êúâ#Â≠óÁ¨¶ÔºåÂ∞±ÂéªÊéâÂÆÉ„ÄÇtelnetÁöÑÈªòËÆ§Á´ØÂè£ÊòØ23ÔºåËøô‰∏™Á´ØÂè£‰πüÊòØÈªëÂÆ¢Á´ØÂè£Êâ´ÊèèÁöÑ‰∏ªË¶ÅÂØπË±°ÔºåÂõ†Ê≠§ÊúÄÂ•ΩÂ∞ÜËøô‰∏™Á´ØÂè£‰øÆÊîπÊéâÔºå‰øÆÊîπÁöÑÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂ∞Ü 23Ëøô‰∏™Êï∞Â≠ó‰øÆÊîπÊéâÔºåÊîπÊàêÂ§ß‰∏ÄÁÇπÁöÑÊï∞Â≠óÔºåÊØîÂ¶Ç61123„ÄÇÊ≥®ÊÑèÔºå1024‰ª•‰∏ãÁöÑÁ´ØÂè£Âè∑ÊòØinternet‰øùÁïôÁöÑÁ´ØÂè£Âè∑ÔºåÂõ†Ê≠§ÊúÄÂ•Ω‰∏çË¶ÅÁî®ÔºåËøòÂ∫îËØ•Ê≥®ÊÑè‰∏çË¶Å‰∏é ÂÖ∂ÂÆÉÊúçÂä°ÁöÑÁ´ØÂè£ÂÜ≤Á™Å„ÄÇÂêØÂä®ÊúçÂä°Ôºöservice xinetd restart]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[zookeeper watcherÊú∫Âà∂Ê∫êÁ†ÅÂàÜÊûê]]></title>
    <url>%2F2018%2F06%2F10%2Fzookeeper-watcher%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[WatcherÁöÑÂü∫Êú¨ÊµÅÁ®ãZooKeeper ÁöÑ Watcher Êú∫Âà∂ÔºåÊÄªÁöÑÊù•ËØ¥ÂèØ‰ª•ÂàÜ‰∏∫‰∏â‰∏™ËøáÁ®ãÔºöÂÆ¢Êà∑Á´ØÊ≥®ÂÜå Watcher„ÄÅÊúçÂä°Âô®Â§ÑÁêÜ Watcher ÂíåÂÆ¢Êà∑Á´ØÂõûË∞É Watcher ÂÆ¢Êà∑Á´ØÊ≥®ÂÜåwatcherÊúâ3ÁßçÊñπÂºèÔºågetData„ÄÅexists„ÄÅgetChildrenÔºõ‰ª•Â¶Ç‰∏ã‰ª£Á†Å‰∏∫‰æãÊù•ÂàÜÊûêÊï¥‰∏™Ëß¶ÂèëÊú∫Âà∂ÁöÑÂéüÁêÜ 12345678910ZooKeeper zookeeper=new ZooKeeper(‚Äú192.168.11.152:2181‚Äù,4000,new Watcher()&#123; public void processor(WatchedEvent event)&#123; System.out.println(‚Äúevent.type‚Äù);&#125;&#125;)Ôºõzookeeper.create(‚Äú/mic‚Äù,‚Äù0‚Äù.getByte(),ZooDefs.Ids. OPEN_ACL_UNSAFE,CreateModel. PERSISTENT); //ÂàõÂª∫ËäÇÁÇπzookeeper.exists(‚Äú/mic‚Äù,true); //Ê≥®ÂÜåÁõëÂê¨zookeeper.setData(‚Äú/mic‚Äù, ‚Äú1‚Äù.getByte(),-1) ; //‰øÆÊîπËäÇÁÇπÁöÑÂÄºËß¶ÂèëÁõëÂê¨ ZooKeeper APIÁöÑÂàùÂßãÂåñËøáÁ®ã12345ZooKeeper zookeeper=new ZooKeeper(‚Äú192.168.11.152:2181‚Äù,4000,new Watcher()&#123; public void processor(WatchedEvent event)&#123; System.out.println(‚Äúevent.type‚Äù);&#125;&#125;)Ôºõ Âú®ÂàõÂª∫‰∏Ä‰∏™ ZooKeeper ÂÆ¢Êà∑Á´ØÂØπË±°ÂÆû‰æãÊó∂ÔºåÊàë‰ª¨ÈÄöËøánew Watcher()ÂêëÊûÑÈÄ†ÊñπÊ≥ï‰∏≠‰º†ÂÖ•‰∏Ä‰∏™ÈªòËÆ§ÁöÑ Watcher, Ëøô‰∏™ Watcher Â∞Ü‰Ωú‰∏∫Êï¥‰∏™ ZooKeeper‰ºöËØùÊúüÈó¥ÁöÑÈªòËÆ§ WatcherÔºå‰ºö‰∏ÄÁõ¥Ë¢´‰øùÂ≠òÂú®ÂÆ¢Êà∑Á´Ø ZKWatchManager ÁöÑ defaultWatcher ‰∏≠;‰ª£Á†ÅÂ¶Ç‰∏ã 123456789101112131415161718192021public ZooKeeper(String connectString, int sessionTimeout, Watcher watcher, boolean canBeReadOnly, HostProvider aHostProvider, ZKClientConfig clientConfig) throws IOException &#123; LOG.info("Initiating client connection, connectString=" + connectString + " sessionTimeout=" + sessionTimeout + " watcher=" + watcher); if (clientConfig == null) &#123; clientConfig = new ZKClientConfig(); &#125; this.clientConfig = clientConfig; watchManager = defaultWatchManager(); watchManager.defaultWatcher = watcher; --Âú®ËøôÈáåÂ∞ÜwatcherËÆæÁΩÆÂà∞ZKWatchManager ConnectStringParser connectStringParser = new ConnectStringParser( connectString); hostProvider = aHostProvider; --ÂàùÂßãÂåñ‰∫ÜClientCnxnÔºåÂπ∂‰∏îË∞ÉÁî®cnxn.start()ÊñπÊ≥ï cnxn = new ClientCnxn(connectStringParser.getChrootPath(), hostProvider, sessionTimeout, this, watchManager, getClientCnxnSocket(), canBeReadOnly); cnxn.start(); &#125; ClientCnxn:ÊòØZookeeperÂÆ¢Êà∑Á´ØÂíåZookeeperÊúçÂä°Âô®Á´ØËøõË°åÈÄö‰ø°Âíå‰∫ã‰ª∂ÈÄöÁü•Â§ÑÁêÜÁöÑ‰∏ªË¶ÅÁ±ªÔºåÂÆÉÂÜÖÈÉ®ÂåÖÂê´‰∏§‰∏™Á±ªÔºå SendThread ÔºöË¥üË¥£ÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Âô®Á´ØÁöÑÊï∞ÊçÆÈÄö‰ø°, ‰πüÂåÖÊã¨‰∫ã‰ª∂‰ø°ÊÅØÁöÑ‰º†Ëæì EventThread : ‰∏ªË¶ÅÂú®ÂÆ¢Êà∑Á´ØÂõûË∞ÉÊ≥®ÂÜåÁöÑWatchersËøõË°åÈÄöÁü•Â§ÑÁêÜ ClientCnxnÂàùÂßãÂåñ123456789101112131415161718192021222324public ClientCnxn(String chrootPath, HostProvider hostProvider, int sessionTimeout, ZooKeeper zooKeeper, ClientWatchManager watcher, ClientCnxnSocket clientCnxnSocket, long sessionId, byte[] sessionPasswd, boolean canBeReadOnly) &#123; this.zooKeeper = zooKeeper; this.watcher = watcher; this.sessionId = sessionId; this.sessionPasswd = sessionPasswd; this.sessionTimeout = sessionTimeout; this.hostProvider = hostProvider; this.chrootPath = chrootPath; connectTimeout = sessionTimeout / hostProvider.size(); readTimeout = sessionTimeout * 2 / 3; readOnly = canBeReadOnly; sendThread = new SendThread(clientCnxnSocket); --ÂàùÂßãÂåñsendThread eventThread = new EventThread(); --ÂàùÂßãÂåñeventThread this.clientConfig=zooKeeper.getClientConfig(); &#125; public void start() &#123; --ÂêØÂä®‰∏§‰∏™Á∫øÁ®ã sendThread.start(); eventThread.start(); &#125; ÂÆ¢Êà∑Á´ØÈÄöËøáexistsÊ≥®ÂÜåÁõëÂê¨1zookeeper.exists(‚Äú/mic‚Äù,true); //Ê≥®ÂÜåÁõëÂê¨ ÈÄöËøáexistsÊñπÊ≥ïÊù•Ê≥®ÂÜåÁõëÂê¨Ôºå‰ª£Á†ÅÂ¶Ç‰∏ã 12345678910111213141516171819202122232425262728293031323334 public Stat exists(final String path, Watcher watcher) throws KeeperException, InterruptedException &#123; final String clientPath = path; PathUtils.validatePath(clientPath); // the watch contains the un-chroot path WatchRegistration wcb = null; if (watcher != null) &#123; wcb = new ExistsWatchRegistration(watcher, clientPath); //ÊûÑÂª∫ExistWatchRegistration &#125; final String serverPath = prependChroot(clientPath); // ÊûÑÈÄ†RequestHeader RequestHeader h = new RequestHeader(); h.setType(ZooDefs.OpCode.exists); //ËÆæÁΩÆÊìç‰ΩúÁ±ªÂûã‰∏∫exists ExistsRequest request = new ExistsRequest(); // ÊûÑÈÄ†ExistsRequest request.setPath(serverPath); request.setWatch(watcher != null); //ÊòØÂê¶Ê≥®ÂÜåÁõëÂê¨ SetDataResponse response = new SetDataResponse(); //ËÆæÁΩÆÊúçÂä°Á´ØÂìçÂ∫îÁöÑÊé•Êî∂Á±ª//Â∞ÜÂ∞ÅË£ÖÁöÑRequestHeader„ÄÅExistsRequest„ÄÅSetDataResponse„ÄÅWatchRegistrationÊ∑ªÂä†Âà∞ÂèëÈÄÅÈòüÂàó ReplyHeader r = cnxn.submitRequest(h, request, response, wcb); if (r.getErr() != 0) &#123; if (r.getErr() == KeeperException.Code.NONODE.intValue()) &#123; return null; &#125; throw KeeperException.create(KeeperException.Code.get(r.getErr()), clientPath); &#125; //ËøîÂõûexistsÂæóÂà∞ÁöÑÁªìÊûúÔºàStat‰ø°ÊÅØÔºâ return response.getStat().getCzxid() == -1 ? null : response.getStat(); &#125; cnxn.submitRequest1234567891011121314public ReplyHeader submitRequest(RequestHeader h, Record request, Record response, WatchRegistration watchRegistration, WatchDeregistration watchDeregistration) throws InterruptedException &#123; ReplyHeader r = new ReplyHeader(); //Â∞ÜÊ∂àÊÅØÊ∑ªÂä†Âà∞ÈòüÂàó,Âπ∂ÊûÑÈÄ†‰∏Ä‰∏™Packet‰º†ËæìÂØπË±° Packet packet = queuePacket(h, r, request, response, null, null, null, null, watchRegistration, watchDeregistration); synchronized (packet) &#123; while (!packet.finished) &#123; //Âú®Êï∞ÊçÆÂåÖÊ≤°ÊúâÂ§ÑÁêÜÂÆåÊàê‰πãÂâçÔºå‰∏ÄÁõ¥ÈòªÂ°û packet.wait(); &#125; &#125; return r; &#125; Â∞ÜRequestHeader h, ReplyHeader r, Record request, Record responseÔºåÂ∞ÅË£ÖÊàêpackageÔºå Ê∑ªÂä†Âà∞outgoingQueueÈòüÂàó‰∏≠ÔºåÂÜçÂî§ÈÜísendThread,ÈÄöÁü•ÊúâÊï∞ÊçÆÂåÖËøáÊù•„ÄÇoutgoingQueueÊòØ‰∏Ä‰∏™ÈòªÂ°ûÈòüÂàóÔºåoutgoingQueueÊòØÂæÖÂèëÈÄÅÁöÑÈòüÂàó„ÄÇ 1private final LinkedBlockingDeque&lt;Packet&gt; outgoingQueue = new LinkedBlockingDeque&lt;Packet&gt;(); 1234567891011121314151617181920212223242526public Packet queuePacket(RequestHeader h, ReplyHeader r, Record request, Record response, AsyncCallback cb, String clientPath, String serverPath, Object ctx, WatchRegistration watchRegistration, WatchDeregistration watchDeregistration) &#123; //Â∞ÜÁõ∏ÂÖ≥‰º†ËæìÂØπË±°ËΩ¨ÂåñÊàêPacket Packet packet = null; packet = new Packet(h, r, request, response, watchRegistration); packet.cb = cb; packet.ctx = ctx; packet.clientPath = clientPath; packet.serverPath = serverPath; packet.watchDeregistration = watchDeregistration; synchronized (state) &#123; if (!state.isAlive() || closing) &#123; conLossPacket(packet); &#125; else &#123; if (h.getType() == OpCode.closeSession) &#123; closing = true; &#125; outgoingQueue.add(packet); //Ê∑ªÂä†Âà∞outgoingQueue &#125; &#125; sendThread.getClientCnxnSocket().packetAdded();//Ê≠§Â§ÑÊòØÂ§öË∑ØÂ§çÁî®Êú∫Âà∂ÔºåÂî§ÈÜíSelectorÔºåÂëäËØâ‰ªñÊúâÊï∞ÊçÆÂåÖÊ∑ªÂä†ËøáÊù•‰∫Ü return packet;&#125; Âú® ZooKeeper ‰∏≠ÔºåPacket ÊòØ‰∏Ä‰∏™ÊúÄÂ∞èÁöÑÈÄö‰ø°ÂçèËÆÆÂçïÂÖÉÔºåÂç≥Êï∞ÊçÆÂåÖ„ÄÇPakcet Áî®‰∫éËøõË°åÂÆ¢Êà∑Á´Ø‰∏éÊúçÂä°Á´Ø‰πãÈó¥ÁöÑÁΩëÁªú‰º†ËæìÔºå‰ªª‰ΩïÈúÄË¶Å‰º†ËæìÁöÑÂØπË±°ÈÉΩÈúÄË¶ÅÂåÖË£ÖÊàê‰∏Ä‰∏™ Packet ÂØπË±°„ÄÇÂú® ClientCnxn ‰∏≠ WatchRegistration ‰πü‰ºöË¢´Â∞ÅË£ÖÂà∞ Pakcet ‰∏≠ÔºåÁÑ∂ÂêéÁî± SendThread Á∫øÁ®ãË∞ÉÁî®queuePacketÊñπÊ≥ïÊää Packet ÊîæÂÖ•ÂèëÈÄÅÈòüÂàó‰∏≠Á≠âÂæÖÂÆ¢Êà∑Á´ØÂèëÈÄÅÔºåËøôÂèàÊòØ‰∏Ä‰∏™ÂºÇÊ≠•ËøáÁ®ãÔºåÂàÜÂ∏ÉÂºèÁ≥ªÁªüÈááÁî®ÂºÇÊ≠•ÈÄö‰ø°ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Â∏∏ËßÅÁöÑÊâãÊÆµ„ÄÇ SendThreadÁöÑÂèëÈÄÅËøáÁ®ãÂú®ÂàùÂßãÂåñËøûÊé•ÁöÑÊó∂ÂÄôÔºåzookeeperÂàùÂßãÂåñ‰∫Ü‰∏§‰∏™Á∫øÁ®ãÂπ∂‰∏îÂêØÂä®‰∫Ü„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨Êù•ÂàÜÊûêSendThreadÁöÑÂèëÈÄÅËøáÁ®ãÔºåÂõ†‰∏∫ÊòØ‰∏Ä‰∏™Á∫øÁ®ãÔºåÊâÄ‰ª•ÂêØÂä®ÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®SendThread.runÊñπÊ≥ï„ÄÇ runÊñπÊ≥ï‰∏≠ÔºåÈÄöËøáclientCnxnSocketÔºåÂéªÊãøÈòüÂàóÁöÑÊï∞ÊçÆÂ§ÑÁêÜ„ÄÇ 1clientCnxnSocket.doTransport(to, pendingQueue, ClientCnxn.this); 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152public void run() &#123; clientCnxnSocket.introduce(this, sessionId, outgoingQueue); clientCnxnSocket.updateNow(); clientCnxnSocket.updateLastSendAndHeard(); int to; long lastPingRwServer = Time.currentElapsedTime(); final int MAX_SEND_PING_INTERVAL = 10000; //10 seconds while (state.isAlive()) &#123; try &#123; if (!clientCnxnSocket.isConnected()) &#123;// Â¶ÇÊûúÊ≤°ÊúâËøûÊé•ÔºöÂèëËµ∑ËøûÊé• // don't re-establish connection if we are closing if (closing) &#123; break; &#125; startConnect(); //ÂèëËµ∑ËøûÊé• clientCnxnSocket.updateLastSendAndHeard(); &#125; if (state.isConnected()) &#123; //Â¶ÇÊûúÊòØËøûÊé•Áä∂ÊÄÅÔºåÂàôÂ§ÑÁêÜsaslÁöÑËÆ§ËØÅÊéàÊùÉ // determine whether we need to send an AuthFailed event. if (zooKeeperSaslClient != null) &#123; boolean sendAuthEvent = false; if (zooKeeperSaslClient.getSaslState() == ZooKeeperSaslClient.SaslState.INITIAL) &#123; try &#123; zooKeeperSaslClient.initialize(ClientCnxn.this); &#125; catch (SaslException e) &#123; LOG.error("SASL authentication with Zookeeper Quorum member failed: " + e); state = States.AUTH_FAILED; sendAuthEvent = true; &#125; &#125; KeeperState authState = zooKeeperSaslClient.getKeeperState(); if (authState != null) &#123; if (authState == KeeperState.AuthFailed) &#123; // An authentication error occurred during authentication with the Zookeeper Server. state = States.AUTH_FAILED; sendAuthEvent = true; &#125; else &#123; if (authState == KeeperState.SaslAuthenticated) &#123; sendAuthEvent = true; &#125; &#125; &#125; if (sendAuthEvent == true) &#123; eventThread.queueEvent(new WatchedEvent( Watcher.Event.EventType.None, authState,null)); &#125; &#125; to = readTimeout - clientCnxnSocket.getIdleRecv(); &#125; else &#123; to = connectTimeout - clientCnxnSocket.getIdleRecv(); &#125; //to,Ë°®Á§∫ÂÆ¢Êà∑Á´ØË∑ùÁ¶ªtimeoutËøòÂâ©Â§öÂ∞ëÊó∂Èó¥ÔºåÂáÜÂ§áÂèëËµ∑pingËøûÊé• if (to &lt;= 0) &#123;//Ë°®Á§∫Â∑≤ÁªèË∂ÖÊó∂‰∫Ü„ÄÇ String warnInfo; warnInfo = "Client session timed out, have not heard from server in " + clientCnxnSocket.getIdleRecv() + "ms" + " for sessionid 0x" + Long.toHexString(sessionId); LOG.warn(warnInfo); throw new SessionTimeoutException(warnInfo); &#125; if (state.isConnected()) &#123; //ËÆ°ÁÆó‰∏ã‰∏ÄÊ¨°pingËØ∑Ê±ÇÁöÑÊó∂Èó¥ int timeToNextPing = readTimeout / 2 - clientCnxnSocket.getIdleSend() - ((clientCnxnSocket.getIdleSend() &gt; 1000) ? 1000 : 0); //send a ping request either time is due or no packet sent out within MAX_SEND_PING_INTERVAL if (timeToNextPing &lt;= 0 || clientCnxnSocket.getIdleSend() &gt; MAX_SEND_PING_INTERVAL) &#123; sendPing(); //ÂèëÈÄÅpingËØ∑Ê±Ç clientCnxnSocket.updateLastSend(); &#125; else &#123; if (timeToNextPing &lt; to) &#123; to = timeToNextPing; &#125; &#125; &#125; // If we are in read-only mode, seek for read/write server if (state == States.CONNECTEDREADONLY) &#123; long now = Time.currentElapsedTime(); int idlePingRwServer = (int) (now - lastPingRwServer); if (idlePingRwServer &gt;= pingRwTimeout) &#123; lastPingRwServer = now; idlePingRwServer = 0; pingRwTimeout = Math.min(2*pingRwTimeout, maxPingRwTimeout); pingRwServer(); &#125; to = Math.min(to, pingRwTimeout - idlePingRwServer); &#125; Ë∞ÉÁî®clientCnxnSocketÔºåÂèëËµ∑‰º†Ëæì ÂÖ∂‰∏≠ pendingQueueÊòØ‰∏Ä‰∏™Áî®Êù•Â≠òÊîæÂ∑≤ÁªèÂèëÈÄÅ„ÄÅÁ≠âÂæÖÂõûÂ∫îÁöÑPacketÈòüÂàóÔºåclientCnxnSocketÈªòËÆ§‰ΩøÁî®ClientCnxnSocketNIOÔºàpsÔºöËøòËÆ∞ÂæóÂú®Âì™ÈáåÂàùÂßãÂåñÂêóÔºüÂú®ÂÆû‰æãÂåñzookeeperÁöÑÊó∂ÂÄôÔºâ clientCnxnSocket.doTransport(to, pendingQueue, ClientCnxn.this); &#125; catch (Throwable e) &#123; if (closing) &#123; if (LOG.isDebugEnabled()) &#123; // closing so this is expected LOG.debug("An exception was thrown while closing send thread for session 0x" + Long.toHexString(getSessionId()) + " : " + e.getMessage()); &#125; break; &#125; else &#123; // this is ugly, you have a better way speak up if (e instanceof SessionExpiredException) &#123; LOG.info(e.getMessage() + ", closing socket connection"); &#125; else if (e instanceof SessionTimeoutException) &#123; LOG.info(e.getMessage() + RETRY_CONN_MSG); &#125; else if (e instanceof EndOfStreamException) &#123; LOG.info(e.getMessage() + RETRY_CONN_MSG); &#125; else if (e instanceof RWServerFoundException) &#123; LOG.info(e.getMessage()); &#125; else &#123; LOG.warn( "Session 0x" + Long.toHexString(getSessionId()) + " for server " + clientCnxnSocket.getRemoteSocketAddress() + ", unexpected error" + RETRY_CONN_MSG, e); &#125; // At this point, there might still be new packets appended to outgoingQueue. // they will be handled in next connection or cleared up if closed. cleanup(); if (state.isAlive()) &#123; eventThread.queueEvent(new WatchedEvent( Event.EventType.None, Event.KeeperState.Disconnected, null)); &#125; clientCnxnSocket.updateNow(); clientCnxnSocket.updateLastSendAndHeard(); &#125; &#125; &#125; synchronized (state) &#123; // When it comes to this point, it guarantees that later queued // packet to outgoingQueue will be notified of death. cleanup(); &#125; clientCnxnSocket.close(); if (state.isAlive()) &#123; eventThread.queueEvent(new WatchedEvent(Event.EventType.None, Event.KeeperState.Disconnected, null)); &#125; ZooTrace.logTraceMessage(LOG, ZooTrace.getTextTraceLevel(), "SendThread exited loop for session: 0x" + Long.toHexString(getSessionId())); &#125; client Âíå serverÁöÑÁΩëÁªú‰∫§‰∫ídoTransportÊúâ‰∏§ÁßçÂÆûÁé∞Ôºå‰∏ÄÁßçjava nioÔºåÂè¶‰∏ÄÁßçÊòØnetty ËøôÈáåÂ∞±ÊòØsendThreadÁöÑrunÊñπÊ≥ïÔºåÂèëÈÄÅÊï∞ÊçÆÁöÑÂÖ∑‰Ωì‰ª£Á†Å„ÄÇpendingQueueË°®Á§∫Â§Ñ‰∫éÂ∑≤ÁªèÂèëÈÄÅËøáÁ≠âÂæÖÂìçÂ∫îÁöÑpacketÈòüÂàó„ÄÇoutgoingQueue‰∏∫ÂæÖÂèëÈÄÅÁöÑÊï∞ÊçÆÂåÖÈòüÂàó„ÄÇËøôÈáåÂÖà‰ªéoutgoingQueue.pollÂá∫‰∏Ä‰∏™packageÔºåÂáÜÂ§áÂèëÈÄÅ„ÄÇÂÜçË∞ÉÁî®doWrite(pendingQueue, head, cnxn)ÊîæÂÖ•pendingQueue‰∏≠ÔºåÁ≠âÂæÖserverÁöÑÂìçÂ∫î„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637@Override void doTransport(int waitTimeOut, List&lt;Packet&gt; pendingQueue, ClientCnxn cnxn) throws IOException, InterruptedException &#123; try &#123; if (!firstConnect.await(waitTimeOut, TimeUnit.MILLISECONDS)) &#123; return; &#125; Packet head = null; if (needSasl.get()) &#123; if (!waitSasl.tryAcquire(waitTimeOut, TimeUnit.MILLISECONDS)) &#123; return; &#125; &#125; else &#123; //Âà§Êñ≠outgoingQueueÊòØÂê¶Â≠òÂú®ÂæÖÂèëÈÄÅÁöÑÊï∞ÊçÆÂåÖÔºå‰∏çÂ≠òÂú®ÂàôÁõ¥Êé•ËøîÂõû if ((head = outgoingQueue.poll(waitTimeOut, TimeUnit.MILLISECONDS)) == null) &#123; return; &#125; &#125; // check if being waken up on closing. if (!sendThread.getZkState().isAlive()) &#123; // adding back the patck to notify of failure in conLossPacket(). addBack(head); return; &#125; // channel disconnection happened if (disconnected.get()) &#123; //ÂºÇÂ∏∏ÊµÅÁ®ãÔºåchannelÂÖ≥Èó≠‰∫ÜÔºåËÆ≤ÂΩìÂâçÁöÑpacketÊ∑ªÂä†Âà∞addBack‰∏≠ addBack(head); throw new EndOfStreamException("channel for sessionid 0x" + Long.toHexString(sessionId) + " is lost"); &#125; if (head != null) &#123; //Â¶ÇÊûúÂΩìÂâçÂ≠òÂú®ÈúÄË¶ÅÂèëÈÄÅÁöÑÊï∞ÊçÆÂåÖÔºåÂàôË∞ÉÁî®doWriteÊñπÊ≥ïÔºåpendingQueueË°®Á§∫Â§Ñ‰∫éÂ∑≤ÁªèÂèëÈÄÅËøáÁ≠âÂæÖÂìçÂ∫îÁöÑpacketÈòüÂàó doWrite(pendingQueue, head, cnxn); &#125; &#125; finally &#123; updateNow(); &#125; &#125; DoWriteÊñπÊ≥ïÂ∞ÜÂΩìÂâçÁöÑpacketÊ∑ªÂä†Âà∞pendingQueueÈòüÂàó‰∏≠ 1234567891011121314151617181920private void doWrite(List&lt;Packet&gt; pendingQueue, Packet p, ClientCnxn cnxn) &#123; updateNow(); while (true) &#123; if (p != WakeupPacket.getInstance()) &#123; if ((p.requestHeader != null) &amp;&amp; //Âà§Êñ≠ËØ∑Ê±ÇÂ§¥‰ª•ÂèäÂà§Êñ≠ÂΩìÂâçËØ∑Ê±ÇÁ±ªÂûã‰∏çÊòØpingÊàñËÄÖauthÊìç‰Ωú (p.requestHeader.getType() != ZooDefs.OpCode.ping) &amp;&amp; (p.requestHeader.getType() != ZooDefs.OpCode.auth)) &#123; p.requestHeader.setXid(cnxn.getXid()); //ËÆæÁΩÆxidÔºåËøô‰∏™xidÁî®Êù•Âå∫ÂàÜËØ∑Ê±ÇÁ±ªÂûã synchronized (pendingQueue) &#123; pendingQueue.add(p); //Â∞ÜÂΩìÂâçÁöÑpacketÊ∑ªÂä†Âà∞pendingQueueÈòüÂàó‰∏≠ &#125; &#125; sendPkt(p); //Â∞ÜÊï∞ÊçÆÂåÖÂèëÈÄÅÂá∫Âéª &#125; if (outgoingQueue.isEmpty()) &#123; break; &#125; p = outgoingQueue.remove(); &#125;&#125; sendPktÈÄöËøánio channelÂèëÈÄÅÂ≠óËäÇÁºìÂ≠òÂà∞ÊúçÂä°Á´Ø 12345678private void sendPkt(Packet p) &#123; // Assuming the packet will be sent out successfully. Because if it fails, // the channel will close and clean up queues. p.createBB(); //Â∫èÂàóÂåñËØ∑Ê±ÇÊï∞ÊçÆ updateLastSend(); //Êõ¥Êñ∞ÊúÄÂêé‰∏ÄÊ¨°ÂèëÈÄÅupdateLastSend sentCount++; //Êõ¥Êñ∞ÂèëÈÄÅÊ¨°Êï∞ channel.write(ChannelBuffers.wrappedBuffer(p.bb)); //ÈÄöËøánio channelÂèëÈÄÅÂ≠óËäÇÁºìÂ≠òÂà∞ÊúçÂä°Á´Ø &#125; createBB1234567891011121314151617181920212223public void createBB() &#123; try &#123; ByteArrayOutputStream baos = new ByteArrayOutputStream(); BinaryOutputArchive boa = BinaryOutputArchive.getArchive(baos); boa.writeInt(-1, "len"); // We'll fill this in later if (requestHeader != null) &#123; requestHeader.serialize(boa, "header"); //Â∫èÂàóÂåñheaderÂ§¥(requestHeader) &#125; if (request instanceof ConnectRequest) &#123; request.serialize(boa, "connect"); // append "am-I-allowed-to-be-readonly" flag boa.writeBool(readOnly, "readOnly"); &#125; else if (request != null) &#123; request.serialize(boa, "request"); //Â∫èÂàóÂåñrequest(request) &#125; baos.close(); this.bb = ByteBuffer.wrap(baos.toByteArray()); this.bb.putInt(this.bb.capacity() - 4); this.bb.rewind(); &#125; catch (IOException e) &#123; LOG.warn("Ignoring unexpected exception", e); &#125; &#125; ‰ªécreateBBÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨ÁúãÂà∞Âú®Â∫ïÂ±ÇÂÆûÈôÖÁöÑÁΩëÁªú‰º†ËæìÂ∫èÂàóÂåñ‰∏≠ÔºåzookeeperÂè™‰ºöËÆ≤requestHeaderÂíårequest‰∏§‰∏™Â±ûÊÄßËøõË°åÂ∫èÂàóÂåñÔºåÂç≥Âè™ÊúâËøô‰∏§‰∏™‰ºöË¢´Â∫èÂàóÂåñÂà∞Â∫ïÂ±ÇÂ≠óËäÇÊï∞ÁªÑ‰∏≠ÂéªËøõË°åÁΩëÁªú‰º†ËæìÔºå‰∏ç‰ºöÂ∞ÜwatchRegistrationÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØËøõË°åÁΩëÁªú‰º†Ëæì„ÄÇ ÊÄªÁªìÁî®Êà∑Ë∞ÉÁî®existsÊ≥®ÂÜåÁõëÂê¨‰ª•ÂêéÔºå‰ºöÂÅöÂá†‰∏™‰∫ãÊÉÖ ËÆ≤ËØ∑Ê±ÇÊï∞ÊçÆÂ∞ÅË£Ö‰∏∫packetÔºåÊ∑ªÂä†Âà∞outgoingQueue SendThreadËøô‰∏™Á∫øÁ®ã‰ºöÊâßË°åÊï∞ÊçÆÂèëÈÄÅÊìç‰ΩúÔºå‰∏ªË¶ÅÊòØÂ∞ÜoutgoingQueueÈòüÂàó‰∏≠ÁöÑÊï∞ÊçÆÂèëÈÄÅÂà∞ÊúçÂä°Á´Ø ÈÄöËøáclientCnxnSocket.doTransport(to, pendingQueue, ClientCnxn.this); ÂÖ∂‰∏≠ClientCnxnSocketÂè™zookeeperÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´ØÁöÑËøûÊé•ÈÄö‰ø°ÁöÑÂ∞ÅË£ÖÔºåÊúâ‰∏§‰∏™ÂÖ∑‰ΩìÁöÑÂÆûÁé∞Á±ªClientCnxnSocketNettyÂíåClientCnxnSocketNIO;ÂÖ∑‰Ωì‰ΩøÁî®Âì™‰∏Ä‰∏™Á±ªÊù•ÂÆûÁé∞ÂèëÈÄÅÔºåÊòØÂú®ÂàùÂßãÂåñËøáÁ®ãÊòØÂú®ÂÆû‰æãÂåñZookeeperÁöÑÊó∂ÂÄôËÆæÁΩÆÁöÑÔºå‰ª£Á†ÅÂ¶Ç‰∏ã 12345678910111213141516171819cnxn = new ClientCnxn(connectStringParser.getChrootPath(), hostProvider, sessionTimeout, this, watchManager, getClientCnxnSocket(), canBeReadOnly); private ClientCnxnSocket getClientCnxnSocket() throws IOException &#123; String clientCnxnSocketName = getClientConfig().getProperty( ZKClientConfig.ZOOKEEPER_CLIENT_CNXN_SOCKET); if (clientCnxnSocketName == null) &#123; clientCnxnSocketName = ClientCnxnSocketNIO.class.getName(); &#125; try &#123; Constructor&lt;?&gt; clientCxnConstructor = Class.forName(clientCnxnSocketName).getDeclaredConstructor(ZKClientConfig.class); ClientCnxnSocket clientCxnSocket = (ClientCnxnSocket) clientCxnConstructor.newInstance(getClientConfig()); return clientCxnSocket; &#125; catch (Exception e) &#123; IOException ioe = new IOException("Couldn't instantiate " + clientCnxnSocketName); ioe.initCause(e); throw ioe; &#125; &#125; Âü∫‰∫éÁ¨¨3Ê≠•ÔºåÊúÄÁªà‰ºöÂú®ClientCnxnSocketNettyÊñπÊ≥ï‰∏≠ÊâßË°åsendPktÂ∞ÜËØ∑Ê±ÇÁöÑÊï∞ÊçÆÂåÖÂèëÈÄÅÂà∞ÊúçÂä°Á´Ø ÊúçÂä°Á´ØÊé•Êî∂ËØ∑Ê±ÇÂ§ÑÁêÜÊµÅÁ®ãÊúçÂä°Á´ØÊúâ‰∏Ä‰∏™NettyServerCnxnÁ±ªÔºåÁî®Êù•Â§ÑÁêÜÂÆ¢Êà∑Á´ØÂèëÈÄÅËøáÊù•ÁöÑËØ∑Ê±Ç„ÄÇ ÈÄöËøázks.processPacket(this, bb)Â§ÑÁêÜÂÆ¢Êà∑Á´Ø‰º†ËøáÊù•ÁöÑÊï∞ÊçÆÂåÖ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109public void receiveMessage(ChannelBuffer message) &#123; try &#123; while(message.readable() &amp;&amp; !throttled) &#123; if (bb != null) &#123; //ByteBuffer‰∏ç‰∏∫Á©∫ if (LOG.isTraceEnabled()) &#123; LOG.trace("message readable " + message.readableBytes() + " bb len " + bb.remaining() + " " + bb); ByteBuffer dat = bb.duplicate(); dat.flip(); LOG.trace(Long.toHexString(sessionId) + " bb 0x" + ChannelBuffers.hexDump( ChannelBuffers.copiedBuffer(dat))); &#125; //bbÂâ©‰ΩôÁ©∫Èó¥Â§ß‰∫émessage‰∏≠ÂèØËØªÂ≠óËäÇÂ§ßÂ∞è if (bb.remaining() &gt; message.readableBytes()) &#123; int newLimit = bb.position() + message.readableBytes(); bb.limit(newLimit); &#125; // Â∞ÜmessageÂÜôÂÖ•bb‰∏≠ message.readBytes(bb); bb.limit(bb.capacity()); if (LOG.isTraceEnabled()) &#123; LOG.trace("after readBytes message readable " + message.readableBytes() + " bb len " + bb.remaining() + " " + bb); ByteBuffer dat = bb.duplicate(); dat.flip(); LOG.trace("after readbytes " + Long.toHexString(sessionId) + " bb 0x" + ChannelBuffers.hexDump( ChannelBuffers.copiedBuffer(dat))); &#125; if (bb.remaining() == 0) &#123; // Â∑≤ÁªèËØªÂÆåmessageÔºåË°®Á§∫ÂÜÖÂÆπÂ∑≤ÁªèÂÖ®ÈÉ®Êé•Êî∂ packetReceived(); // ÁªüËÆ°Êé•Êî∂‰ø°ÊÅØ bb.flip(); ZooKeeperServer zks = this.zkServer; if (zks == null || !zks.isRunning()) &#123;//ZookeeperÊúçÂä°Âô®‰∏∫Á©∫ ,ËØ¥ÊòéÊúçÂä°Á´ØÊåÇ‰∫Ü throw new IOException("ZK down"); &#125; if (initialized) &#123; //Â§ÑÁêÜÂÆ¢Êà∑Á´Ø‰º†ËøáÊù•ÁöÑÊï∞ÊçÆÂåÖ zks.processPacket(this, bb); if (zks.shouldThrottle(outstandingCount.incrementAndGet())) &#123; disableRecvNoWait(); &#125; &#125; else &#123; LOG.debug("got conn req request from " + getRemoteSocketAddress()); zks.processConnectRequest(this, bb); initialized = true; &#125; bb = null; &#125; &#125; else &#123; //bb‰∏∫nullÁöÑÊÉÖÂÜµÔºåÂ§ßÂÆ∂Ëá™Â∑±ÂéªÁúãÔºåÊàëÂ∞±‰∏çÁªÜËÆ≤‰∫Ü if (LOG.isTraceEnabled()) &#123; LOG.trace("message readable " + message.readableBytes() + " bblenrem " + bbLen.remaining()); ByteBuffer dat = bbLen.duplicate(); dat.flip(); LOG.trace(Long.toHexString(sessionId) + " bbLen 0x" + ChannelBuffers.hexDump( ChannelBuffers.copiedBuffer(dat))); &#125; if (message.readableBytes() &lt; bbLen.remaining()) &#123; bbLen.limit(bbLen.position() + message.readableBytes()); &#125; message.readBytes(bbLen); bbLen.limit(bbLen.capacity()); if (bbLen.remaining() == 0) &#123; bbLen.flip(); if (LOG.isTraceEnabled()) &#123; LOG.trace(Long.toHexString(sessionId) + " bbLen 0x" + ChannelBuffers.hexDump( ChannelBuffers.copiedBuffer(bbLen))); &#125; int len = bbLen.getInt(); if (LOG.isTraceEnabled()) &#123; LOG.trace(Long.toHexString(sessionId) + " bbLen len is " + len); &#125; bbLen.clear(); if (!initialized) &#123; if (checkFourLetterWord(channel, message, len)) &#123; return; &#125; &#125; if (len &lt; 0 || len &gt; BinaryInputArchive.maxBuffer) &#123; throw new IOException("Len error " + len); &#125; bb = ByteBuffer.allocate(len); &#125; &#125; &#125; &#125; catch(IOException e) &#123; LOG.warn("Closing connection to " + getRemoteSocketAddress(), e); close(); &#125; &#125; NettyServerCnxnZookeeperServer-zks.processPacket(this, bb);Â§ÑÁêÜÂÆ¢Êà∑Á´Ø‰º†ÈÄÅËøáÊù•ÁöÑÊï∞ÊçÆÂåÖÔºåÂ∞ÅË£ÖËØ∑Ê±ÇÂØπË±°ÔºåÂπ∂ÂèëÈÄÅ„ÄÇ 12Request si = new Request(cnxn, cnxn.getSessionId(), h.getXid(), h.getType(), incomingBuffer, cnxn.getAuthInfo()); 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970public void processPacket(ServerCnxn cnxn, ByteBuffer incomingBuffer) throws IOException &#123; // We have the request, now process and setup for next InputStream bais = new ByteBufferInputStream(incomingBuffer); BinaryInputArchive bia = BinaryInputArchive.getArchive(bais); RequestHeader h = new RequestHeader(); h.deserialize(bia, "header"); //ÂèçÂ∫èÂàóÂåñÂÆ¢Êà∑Á´ØheaderÂ§¥‰ø°ÊÅØ // Through the magic of byte buffers, txn will not be // pointing // to the start of the txn incomingBuffer = incomingBuffer.slice(); if (h.getType() == OpCode.auth) &#123; //Âà§Êñ≠ÂΩìÂâçÊìç‰ΩúÁ±ªÂûãÔºåÂ¶ÇÊûúÊòØauthÊìç‰ΩúÔºåÂàôÊâßË°å‰∏ãÈù¢ÁöÑ‰ª£Á†Å LOG.info("got auth packet " + cnxn.getRemoteSocketAddress()); AuthPacket authPacket = new AuthPacket(); ByteBufferInputStream.byteBuffer2Record(incomingBuffer, authPacket); String scheme = authPacket.getScheme(); ServerAuthenticationProvider ap = ProviderRegistry.getServerProvider(scheme); Code authReturn = KeeperException.Code.AUTHFAILED; if(ap != null) &#123; try &#123; authReturn = ap.handleAuthentication(new ServerAuthenticationProvider.ServerObjs(this, cnxn), authPacket.getAuth()); &#125; catch(RuntimeException e) &#123; LOG.warn("Caught runtime exception from AuthenticationProvider: " + scheme + " due to " + e); authReturn = KeeperException.Code.AUTHFAILED; &#125; &#125; if (authReturn == KeeperException.Code.OK) &#123; if (LOG.isDebugEnabled()) &#123; LOG.debug("Authentication succeeded for scheme: " + scheme); &#125; LOG.info("auth success " + cnxn.getRemoteSocketAddress()); ReplyHeader rh = new ReplyHeader(h.getXid(), 0, KeeperException.Code.OK.intValue()); cnxn.sendResponse(rh, null, null); &#125; else &#123; if (ap == null) &#123; LOG.warn("No authentication provider for scheme: " + scheme + " has " + ProviderRegistry.listProviders()); &#125; else &#123; LOG.warn("Authentication failed for scheme: " + scheme); &#125; // send a response... ReplyHeader rh = new ReplyHeader(h.getXid(), 0, KeeperException.Code.AUTHFAILED.intValue()); cnxn.sendResponse(rh, null, null); // ... and close connection cnxn.sendBuffer(ServerCnxnFactory.closeConn); cnxn.disableRecv(); &#125; return; &#125; else &#123; //Â¶ÇÊûú‰∏çÊòØÊéàÊùÉÊìç‰ΩúÔºåÂÜçÂà§Êñ≠ÊòØÂê¶‰∏∫saslÊìç‰Ωú if (h.getType() == OpCode.sasl) &#123; Record rsp = processSasl(incomingBuffer,cnxn); ReplyHeader rh = new ReplyHeader(h.getXid(), 0, KeeperException.Code.OK.intValue()); cnxn.sendResponse(rh,rsp, "response"); // not sure about 3rd arg..what is it? return; &#125; else &#123;//ÊúÄÁªàËøõÂÖ•Ëøô‰∏™‰ª£Á†ÅÂùóËøõË°åÂ§ÑÁêÜ //Â∞ÅË£ÖËØ∑Ê±ÇÂØπË±° Request si = new Request(cnxn, cnxn.getSessionId(), h.getXid(), h.getType(), incomingBuffer, cnxn.getAuthInfo()); si.setOwner(ServerCnxn.me); // Always treat packet from the client as a possible // local request. setLocalSessionFlag(si); submitRequest(si); //Êèê‰∫§ËØ∑Ê±Ç &#125; &#125; cnxn.incrOutstandingRequests(h); &#125; submitRequestË¥üË¥£Âú®ÊúçÂä°Á´ØÊèê‰∫§ÂΩìÂâçËØ∑Ê±Ç 123456789101112131415161718192021222324252627282930313233343536373839public void submitRequest(Request si) &#123; if (firstProcessor == null) &#123; //processorÂ§ÑÁêÜÂô®ÔºårequestËøáÊù•‰ª•Âêé‰ºöÁªèÂéÜ‰∏ÄÁ≥ªÂàóÂ§ÑÁêÜÂô®ÁöÑÂ§ÑÁêÜËøáÁ®ã synchronized (this) &#123; try &#123; // Since all requests are passed to the request // processor it should wait for setting up the request // processor chain. The state will be updated to RUNNING // after the setup. while (state == State.INITIAL) &#123; wait(1000); &#125; &#125; catch (InterruptedException e) &#123; LOG.warn("Unexpected interruption", e); &#125; if (firstProcessor == null || state != State.RUNNING) &#123; throw new RuntimeException("Not started"); &#125; &#125; &#125; try &#123; touch(si.cnxn); boolean validpacket = Request.isValid(si.type); //Âà§Êñ≠ÊòØÂê¶ÂêàÊ≥ï if (validpacket) &#123; firstProcessor.processRequest(si); Ë∞ÉÁî®firstProcessorÂèëËµ∑ËØ∑Ê±ÇÔºåËÄåËøô‰∏™firstProcessÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåÊúâÂ§ö‰∏™ÂÆûÁé∞Á±ªÔºåÂÖ∑‰ΩìÁöÑË∞ÉÁî®ÈìæÊòØÊÄé‰πàÊ†∑ÁöÑÔºüÂæÄ‰∏ãÁúãÂêß if (si.cnxn != null) &#123; incInProcess(); &#125; &#125; else &#123; LOG.warn("Received packet at server of unknown type " + si.type); new UnimplementedRequestProcessor().processRequest(si); &#125; &#125; catch (MissingSessionException e) &#123; if (LOG.isDebugEnabled()) &#123; LOG.debug("Dropping request: " + e.getMessage()); &#125; &#125; catch (RequestProcessorException e) &#123; LOG.error("Unable to process request:" + e.getMessage(), e); &#125; &#125; firstProcessorÁöÑËØ∑Ê±ÇÈìæÁªÑÊàê firstProcessorÁöÑÂàùÂßãÂåñÊòØÂú®ZookeeperServerÁöÑsetupRequestProcessor‰∏≠ÂÆåÊàêÁöÑÔºå‰ª£Á†ÅÂ¶Ç‰∏ã 1234567protected void setupRequestProcessors() &#123; RequestProcessor finalProcessor = new FinalRequestProcessor(this); RequestProcessor syncProcessor = new SyncRequestProcessor(this, finalProcessor); ((SyncRequestProcessor)syncProcessor).start(); firstProcessor = new PrepRequestProcessor(this, syncProcessor);//ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåPrepRequestProcessor‰∏≠‰º†ÈÄíÁöÑÊòØ‰∏Ä‰∏™syncProcessor ((PrepRequestProcessor)firstProcessor).start(); &#125; ‰ªé‰∏äÈù¢Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞firstProcessorÁöÑÂÆû‰æãÊòØ‰∏Ä‰∏™PrepRequestProcessorÔºåËÄåËøô‰∏™ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠Âèà‰º†ÈÄí‰∫Ü‰∏Ä‰∏™ProcessorÊûÑÊàê‰∫Ü‰∏Ä‰∏™Ë∞ÉÁî®Èìæ„ÄÇ RequestProcessor syncProcessor = new SyncRequestProcessor(this, finalProcessor); ËÄåsyncProcessorÁöÑÊûÑÈÄ†ÊñπÊ≥ï‰º†ÈÄíÁöÑÂèàÊòØ‰∏Ä‰∏™ProcessorÔºåÂØπÂ∫îÁöÑÊòØFinalRequestProcessor ÊâÄ‰ª•Êï¥‰∏™Ë∞ÉÁî®ÈìæÊòØPrepRequestProcessor -&gt; SyncRequestProcessor -&gt;FinalRequestProcessor PredRequestProcessor.processRequest(si);ÈÄöËøá‰∏äÈù¢‰∫ÜËß£Âà∞Ë∞ÉÁî®ÈìæÂÖ≥Á≥ª‰ª•ÂêéÔºåÊàë‰ª¨ÁªßÁª≠ÂÜçÁúãfirstProcessor.processRequest(si)Ôºõ ‰ºöË∞ÉÁî®Âà∞PrepRequestProcessor ÂîâÔºåÂæàÂ•áÊÄ™ÔºåprocessRequestÂè™ÊòØÊäärequestÊ∑ªÂä†Âà∞submittedRequests‰∏≠ÔºåÊ†πÊçÆÂâçÈù¢ÁöÑÁªèÈ™åÔºåÂæàËá™ÁÑ∂ÁöÑÊÉ≥Âà∞ËøôÈáåÂèàÊòØ‰∏Ä‰∏™ÂºÇÊ≠•Êìç‰Ωú„ÄÇËÄåsubittedRequestsÂèàÊòØ‰∏Ä‰∏™ÈòªÂ°ûÈòüÂàó LinkedBlockingQueue&lt;Request&gt; submittedRequests = new LinkedBlockingQueue&lt;Request&gt;(); ËÄåPrepRequestProcessorËøô‰∏™Á±ªÂèàÁªßÊâø‰∫ÜÁ∫øÁ®ãÁ±ªÔºåÂõ†Ê≠§Êàë‰ª¨Áõ¥Êé•ÊâæÂà∞ÂΩìÂâçÁ±ª‰∏≠ÁöÑrunÊñπÊ≥ïÂ¶Ç‰∏ã 1234567891011121314151617181920212223242526public void run() &#123; try &#123; while (true) &#123; Request request = submittedRequests.take(); //okÔºå‰ªéÈòüÂàó‰∏≠ÊãøÂà∞ËØ∑Ê±ÇËøõË°åÂ§ÑÁêÜ long traceMask = ZooTrace.CLIENT_REQUEST_TRACE_MASK; if (request.type == OpCode.ping) &#123; traceMask = ZooTrace.CLIENT_PING_TRACE_MASK; &#125; if (LOG.isTraceEnabled()) &#123; ZooTrace.logRequest(LOG, traceMask, 'P', request, ""); &#125; if (Request.requestOfDeath == request) &#123; break; &#125; pRequest(request); //Ë∞ÉÁî®pRequestËøõË°åÈ¢ÑÂ§ÑÁêÜ &#125; &#125; catch (RequestProcessorException e) &#123; if (e.getCause() instanceof XidRolloverException) &#123; LOG.info(e.getCause().getMessage()); &#125; handleException(this.getName(), e); &#125; catch (Exception e) &#123; handleException(this.getName(), e); &#125; LOG.info("PrepRequestProcessor exited loop!"); &#125; pRequestÈ¢ÑÂ§ÑÁêÜËøôÂùóÁöÑ‰ª£Á†ÅÂ§™ÈïøÔºåÂ∞±‰∏çÂ•ΩË¥¥‰∫Ü„ÄÇÂâçÈù¢ÁöÑNË°å‰ª£Á†ÅÈÉΩÊòØÊ†πÊçÆÂΩìÂâçÁöÑOPÁ±ªÂûãËøõË°åÂà§Êñ≠ÂíåÂÅöÁõ∏Â∫îÁöÑÂ§ÑÁêÜÔºåÂú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÁöÑÊúÄÂêé‰∏ÄË°å‰∏≠ÔºåÊàë‰ª¨‰ºöÁúãÂà∞Â¶Ç‰∏ã‰ª£Á†Å 1nextProcessor.processRequest(request); ÂæàÊòæÁÑ∂ÔºånextProcessorÂØπÂ∫îÁöÑÂ∫îËØ•ÊòØSyncRequestProcessor SyncRequestProcessor. processRequest1234public void processRequest(Request request) &#123; // request.addRQRec("&gt;sync"); queuedRequests.add(request); &#125; Ëøô‰∏™ÊñπÊ≥ïÁöÑ‰ª£Á†Å‰πüÊòØ‰∏ÄÊ†∑ÔºåÂü∫‰∫éÂºÇÊ≠•ÂåñÁöÑÊìç‰ΩúÔºåÊääËØ∑Ê±ÇÊ∑ªÂä†Âà∞queuedRequets‰∏≠ÔºåÈÇ£‰πàÊàë‰ª¨ÁªßÁª≠Âú®ÂΩìÂâçÁ±ªÊâæÂà∞runÊñπÊ≥ï 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374public void run() &#123; try &#123; int logCount = 0; // we do this in an attempt to ensure that not all of the servers // in the ensemble take a snapshot at the same time int randRoll = r.nextInt(snapCount/2); while (true) &#123; Request si = null; //‰ªéÈòªÂ°ûÈòüÂàó‰∏≠Ëé∑ÂèñËØ∑Ê±Ç if (toFlush.isEmpty()) &#123; si = queuedRequests.take(); &#125; else &#123; si = queuedRequests.poll(); if (si == null) &#123; flush(toFlush); continue; &#125; &#125; if (si == requestOfDeath) &#123; break; &#125; if (si != null) &#123; // track the number of records written to the log //‰∏ãÈù¢ËøôÂùó‰ª£Á†ÅÔºåÁ≤óÁï•ÁúãÊù•ÊòØËß¶ÂèëÂø´ÁÖßÊìç‰ΩúÔºåÂêØÂä®‰∏Ä‰∏™Â§ÑÁêÜÂø´ÁÖßÁöÑÁ∫øÁ®ã if (zks.getZKDatabase().append(si)) &#123; logCount++; if (logCount &gt; (snapCount / 2 + randRoll)) &#123; randRoll = r.nextInt(snapCount/2); // roll the log zks.getZKDatabase().rollLog(); // take a snapshot if (snapInProcess != null &amp;&amp; snapInProcess.isAlive()) &#123; LOG.warn("Too busy to snap, skipping"); &#125; else &#123; snapInProcess = new ZooKeeperThread("Snapshot Thread") &#123; public void run() &#123; try &#123; zks.takeSnapshot(); &#125; catch(Exception e) &#123; LOG.warn("Unexpected exception", e); &#125; &#125; &#125;; snapInProcess.start(); &#125; logCount = 0; &#125; &#125; else if (toFlush.isEmpty()) &#123; // optimization for read heavy workloads // iff this is a read, and there are no pending // flushes (writes), then just pass this to the next // processor if (nextProcessor != null) &#123; nextProcessor.processRequest(si); //ÁªßÁª≠Ë∞ÉÁî®‰∏ã‰∏Ä‰∏™Â§ÑÁêÜÂô®Êù•Â§ÑÁêÜËØ∑Ê±Ç if (nextProcessor instanceof Flushable) &#123; ((Flushable)nextProcessor).flush(); &#125; &#125; continue; &#125; toFlush.add(si); if (toFlush.size() &gt; 1000) &#123; flush(toFlush); &#125; &#125; &#125; &#125; catch (Throwable t) &#123; handleException(this.getName(), t); &#125; finally&#123; running = false; &#125; LOG.info("SyncRequestProcessor exited!"); &#125; FinalRequestProcessor. processRequestËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÊàë‰ª¨Âú®ËØæÂ†Ç‰∏äÂàÜÊûêÂà∞ÁöÑÊñπÊ≥ï‰∫ÜÔºåFinalRequestProcessor.processRequestÊñπÊ≥ïÂπ∂Ê†πÊçÆRequestÂØπË±°‰∏≠ÁöÑÊìç‰ΩúÊõ¥Êñ∞ÂÜÖÂ≠ò‰∏≠Session‰ø°ÊÅØÊàñËÄÖznodeÊï∞ÊçÆ„ÄÇ ËøôÂùó‰ª£Á†ÅÊúâÂ∞è300Â§öË°åÔºåÂ∞±‰∏çÂÖ®ÈÉ®Ë¥¥Âá∫Êù•‰∫ÜÔºåÊàë‰ª¨Áõ¥Êé•ÂÆö‰ΩçÂà∞ÂÖ≥ÈîÆ‰ª£Á†ÅÔºåÊ†πÊçÆÂÆ¢Êà∑Á´ØÁöÑOPÁ±ªÂûãÊâæÂà∞Â¶Ç‰∏ãÁöÑ‰ª£Á†Å 1234567891011121314151617 case OpCode.exists: &#123; lastOp = "EXIS"; // TODO we need to figure out the security requirement for this! ExistsRequest existsRequest = new ExistsRequest(); //ÂèçÂ∫èÂàóÂåñ (Â∞ÜByteBufferÂèçÂ∫èÂàóÂåñÊàê‰∏∫ExitsRequest.Ëøô‰∏™Â∞±ÊòØÊàë‰ª¨Âú®ÂÆ¢Êà∑Á´ØÂèëËµ∑ËØ∑Ê±ÇÁöÑÊó∂ÂÄô‰º†ÈÄíËøáÊù•ÁöÑRequestÂØπË±° ByteBufferInputStream.byteBuffer2Record(request.request, existsRequest); String path = existsRequest.getPath(); //ÂæóÂà∞ËØ∑Ê±ÇÁöÑË∑ØÂæÑ if (path.indexOf('\0') != -1) &#123; throw new KeeperException.BadArgumentsException(); &#125; //Áªà‰∫éÊâæÂà∞‰∏Ä‰∏™ÂæàÂÖ≥ÈîÆÁöÑ‰ª£Á†ÅÔºåÂà§Êñ≠ËØ∑Ê±ÇÁöÑgetWatchÊòØÂê¶Â≠òÂú®ÔºåÂ¶ÇÊûúÂ≠òÂú®ÔºåÂàô‰º†ÈÄícnxnÔºàservercnxnÔºâ//ÂØπ‰∫éexistsËØ∑Ê±ÇÔºåÈúÄË¶ÅÁõëÂê¨dataÂèòÂåñ‰∫ã‰ª∂ÔºåÊ∑ªÂä†watcher Stat stat = zks.getZKDatabase().statNode(path, existsRequest.getWatch() ? cnxn : null); rsp = new ExistsResponse(stat); //Âú®ÊúçÂä°Á´ØÂÜÖÂ≠òÊï∞ÊçÆÂ∫ì‰∏≠Ê†πÊçÆË∑ØÂæÑÂæóÂà∞ÁªìÊûúËøõË°åÁªÑË£ÖÔºåËÆæÁΩÆ‰∏∫ExistsResponse break; &#125; statNodeËøô‰∏™ÊñπÊ≥ïÂÅö‰∫Ü‰ªÄ‰πàÔºü123public Stat statNode(String path, ServerCnxn serverCnxn) throws KeeperException.NoNodeException &#123; return dataTree.statNode(path, serverCnxn); &#125; ‰∏ÄË∑ØÂêë‰∏ãÔºåÂú®‰∏ãÈù¢Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÔºåËÆ≤ServerCnxnÂêë‰∏äËΩ¨Âûã‰∏∫Watcher‰∫Ü„ÄÇ Âõ†‰∏∫ServerCnxnÂÆûÁé∞‰∫ÜWatcherÊé•Âè£ 123456789101112131415public Stat statNode(String path, Watcher watcher) throws KeeperException.NoNodeException &#123; Stat stat = new Stat(); DataNode n = nodes.get(path); //Ëé∑ÂæóËäÇÁÇπÊï∞ÊçÆ if (watcher != null) &#123; //Â¶ÇÊûúwatcher‰∏ç‰∏∫Á©∫ÔºåÂàôËÆ≤ÂΩìÂâçÁöÑwatcherÂíåpathËøõË°åÁªëÂÆö dataWatches.addWatch(path, watcher); &#125; if (n == null) &#123; throw new KeeperException.NoNodeException(); &#125; synchronized (n) &#123; n.copyStat(stat); return stat; &#125; &#125; WatchManager.addWatch(path, watcher);12345678910111213141516171819synchronized void addWatch(String path, Watcher watcher) &#123; HashSet&lt;Watcher&gt; list = watchTable.get(path); //Âà§Êñ≠watcherTable‰∏≠ÊòØÂê¶Â≠òÂú®ÂΩìÂâçË∑ØÂæÑÂØπÂ∫îÁöÑwatcher if (list == null) &#123; //‰∏çÂ≠òÂú®Âàô‰∏ªÂä®Ê∑ªÂä† // don't waste memory if there are few watches on a node // rehash when the 4th entry is added, doubling size thereafter // seems like a good compromise list = new HashSet&lt;Watcher&gt;(4); // Êñ∞ÁîüÊàêwatcherÈõÜÂêà watchTable.put(path, list); &#125; list.add(watcher); //Ê∑ªÂä†Âà∞watcherË°® HashSet&lt;String&gt; paths = watch2Paths.get(watcher); if (paths == null) &#123; // cnxns typically have many watches, so use default cap here paths = new HashSet&lt;String&gt;(); watch2Paths.put(watcher, paths); // ËÆæÁΩÆwatcherÂà∞ËäÇÁÇπË∑ØÂæÑÁöÑÊò†Â∞Ñ &#125; paths.add(path); // Â∞ÜË∑ØÂæÑÊ∑ªÂä†Ëá≥pathsÈõÜÂêà &#125; ÂÖ∂Â§ßËá¥ÊµÅÁ®ãÂ¶Ç‰∏ã ‚ë† ÈÄöËøá‰º†ÂÖ•ÁöÑpathÔºàËäÇÁÇπË∑ØÂæÑÔºâ‰ªéwatchTableËé∑ÂèñÁõ∏Â∫îÁöÑwatcherÈõÜÂêàÔºåËøõÂÖ•‚ë° ‚ë° Âà§Êñ≠‚ë†‰∏≠ÁöÑwatcherÊòØÂê¶‰∏∫Á©∫ÔºåËã•‰∏∫Á©∫ÔºåÂàôËøõÂÖ•‚ë¢ÔºåÂê¶ÂàôÔºåËøõÂÖ•‚ë£ ‚ë¢ Êñ∞ÁîüÊàêwatcherÈõÜÂêàÔºåÂπ∂Â∞ÜË∑ØÂæÑpathÂíåÊ≠§ÈõÜÂêàÊ∑ªÂä†Ëá≥watchTable‰∏≠ÔºåËøõÂÖ•‚ë£ ‚ë£ Â∞Ü‰º†ÂÖ•ÁöÑwatcherÊ∑ªÂä†Ëá≥watcherÈõÜÂêàÔºåÂç≥ÂÆåÊàê‰∫ÜpathÂíåwatcherÊ∑ªÂä†Ëá≥watchTableÁöÑÊ≠•È™§ÔºåËøõÂÖ•‚ë§ ‚ë§ ÈÄöËøá‰º†ÂÖ•ÁöÑwatcher‰ªéwatch2Paths‰∏≠Ëé∑ÂèñÁõ∏Â∫îÁöÑpathÈõÜÂêàÔºåËøõÂÖ•‚ë• ‚ë• Âà§Êñ≠pathÈõÜÂêàÊòØÂê¶‰∏∫Á©∫ÔºåËã•‰∏∫Á©∫ÔºåÂàôËøõÂÖ•‚ë¶ÔºåÂê¶ÂàôÔºåËøõÂÖ•‚ëß ‚ë¶ Êñ∞ÁîüÊàêpathÈõÜÂêàÔºåÂπ∂Â∞ÜwatcherÂíåpathsÊ∑ªÂä†Ëá≥watch2Paths‰∏≠ÔºåËøõÂÖ•‚ëß ‚ëß Â∞Ü‰º†ÂÖ•ÁöÑpathÔºàËäÇÁÇπË∑ØÂæÑÔºâÊ∑ªÂä†Ëá≥pathÈõÜÂêàÔºåÂç≥ÂÆåÊàê‰∫ÜpathÂíåwatcherÊ∑ªÂä†Ëá≥watch2PathsÁöÑÊ≠•È™§ ÊÄªÁªìË∞ÉÁî®ÂÖ≥Á≥ªÈìæÂ¶Ç‰∏ã NettyServerCnxn(processPackage) -&gt; ZookeeperServer(processRequest) -&gt; PredRequestProcessor(processRequest) -&gt; SyncRequestProcessor(processRequest) -&gt; FinalRequestProcessor(processRequest) -&gt; ZKDataBase (statNode)-&gt; DataTree(statNode) -&gt; WatchManager(addWatch) ÂÆ¢Êà∑Á´ØÊé•Êî∂ÊúçÂä°Á´ØÂ§ÑÁêÜÂÆåÊàêÁöÑÂìçÂ∫îClientCnxnSocketNetty.messageReceivedÊúçÂä°Á´ØÂ§ÑÁêÜÂÆåÊàê‰ª•ÂêéÔºå‰ºöÈÄöËøáNettyServerCnxn.sendResponseÂèëÈÄÅËøîÂõûÁöÑÂìçÂ∫î‰ø°ÊÅØÔºå ÂÆ¢Êà∑Á´Ø‰ºöÂú®ClientCnxnSocketNetty.messageReceivedÊé•Êî∂ÊúçÂä°Á´ØÁöÑËøîÂõû 12345678910111213141516171819202122232425262728293031323334public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) throws Exception &#123; updateNow(); ChannelBuffer buf = (ChannelBuffer) e.getMessage(); while (buf.readable()) &#123; if (incomingBuffer.remaining() &gt; buf.readableBytes()) &#123; int newLimit = incomingBuffer.position() + buf.readableBytes(); incomingBuffer.limit(newLimit); &#125; buf.readBytes(incomingBuffer); incomingBuffer.limit(incomingBuffer.capacity()); if (!incomingBuffer.hasRemaining()) &#123; incomingBuffer.flip(); if (incomingBuffer == lenBuffer) &#123; recvCount++; readLength(); &#125; else if (!initialized) &#123; readConnectResult(); lenBuffer.clear(); incomingBuffer = lenBuffer; initialized = true; updateLastHeard(); &#125; else &#123; sendThread.readResponse(incomingBuffer); //Êî∂Âà∞Ê∂àÊÅØ‰ª•ÂêéËß¶ÂèëSendThread.readResponseÊñπÊ≥ï lenBuffer.clear(); incomingBuffer = lenBuffer; updateLastHeard(); &#125; &#125; &#125; wakeupCnxn(); &#125; SendThread. readResponseËøô‰∏™ÊñπÊ≥ïÈáåÈù¢‰∏ªË¶ÅÁöÑÊµÅÁ®ãÂ¶Ç‰∏ã È¶ñÂÖàËØªÂèñheaderÔºåÂ¶ÇÊûúÂÖ∂xid == -2ÔºåË°®ÊòéÊòØ‰∏Ä‰∏™pingÁöÑresponseÔºåreturn Â¶ÇÊûúxidÊòØ -4 ÔºåË°®ÊòéÊòØ‰∏Ä‰∏™AuthPacketÁöÑresponse return Â¶ÇÊûúxidÊòØ -1ÔºåË°®ÊòéÊòØ‰∏Ä‰∏™notification,Ê≠§Êó∂Ë¶ÅÁªßÁª≠ËØªÂèñÂπ∂ÊûÑÈÄ†‰∏Ä‰∏™enentÔºåÈÄöËøáEventThread.queueEventÂèëÈÄÅÔºåreturn ÂÖ∂ÂÆÉÊÉÖÂÜµ‰∏ãÔºö ‰ªépendingQueueÊãøÂá∫‰∏Ä‰∏™PacketÔºåÊ†°È™åÂêéÊõ¥Êñ∞packet‰ø°ÊÅØ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118void readResponse(ByteBuffer incomingBuffer) throws IOException &#123; ByteBufferInputStream bbis = new ByteBufferInputStream( incomingBuffer); BinaryInputArchive bbia = BinaryInputArchive.getArchive(bbis); ReplyHeader replyHdr = new ReplyHeader(); replyHdr.deserialize(bbia, "header"); //ÂèçÂ∫èÂàóÂåñheader if (replyHdr.getXid() == -2) &#123; //? // -2 is the xid for pings if (LOG.isDebugEnabled()) &#123; LOG.debug("Got ping response for sessionid: 0x" + Long.toHexString(sessionId) + " after " + ((System.nanoTime() - lastPingSentNs) / 1000000) + "ms"); &#125; return; &#125; if (replyHdr.getXid() == -4) &#123; // -4 is the xid for AuthPacket if(replyHdr.getErr() == KeeperException.Code.AUTHFAILED.intValue()) &#123; state = States.AUTH_FAILED; eventThread.queueEvent( new WatchedEvent(Watcher.Event.EventType.None, Watcher.Event.KeeperState.AuthFailed, null) ); &#125; if (LOG.isDebugEnabled()) &#123; LOG.debug("Got auth sessionid:0x" + Long.toHexString(sessionId)); &#125; return; &#125; if (replyHdr.getXid() == -1) &#123; //Ë°®Á§∫ÂΩìÂâçÁöÑÊ∂àÊÅØÁ±ªÂûã‰∏∫‰∏Ä‰∏™notification(ÊÑèÂë≥ÁùÄÊòØÊúçÂä°Á´ØÁöÑ‰∏Ä‰∏™ÂìçÂ∫î‰∫ã‰ª∂) // -1 means notification if (LOG.isDebugEnabled()) &#123; LOG.debug("Got notification sessionid:0x" + Long.toHexString(sessionId)); &#125; WatcherEvent event = new WatcherEvent();//? event.deserialize(bbia, "response"); //ÂèçÂ∫èÂàóÂåñÂìçÂ∫î‰ø°ÊÅØ // convert from a server path to a client path if (chrootPath != null) &#123; String serverPath = event.getPath(); if(serverPath.compareTo(chrootPath)==0) event.setPath("/"); else if (serverPath.length() &gt; chrootPath.length()) event.setPath(serverPath.substring(chrootPath.length())); else &#123; LOG.warn("Got server path " + event.getPath() + " which is too short for chroot path " + chrootPath); &#125; &#125; WatchedEvent we = new WatchedEvent(event); if (LOG.isDebugEnabled()) &#123; LOG.debug("Got " + we + " for sessionid 0x" + Long.toHexString(sessionId)); &#125; eventThread.queueEvent( we ); return; &#125; // If SASL authentication is currently in progress, construct and // send a response packet immediately, rather than queuing a // response as with other packets. if (tunnelAuthInProgress()) &#123; GetSASLRequest request = new GetSASLRequest(); request.deserialize(bbia,"token"); zooKeeperSaslClient.respondToServer(request.getToken(), ClientCnxn.this); return; &#125; Packet packet; synchronized (pendingQueue) &#123; if (pendingQueue.size() == 0) &#123; throw new IOException("Nothing in the queue, but got " + replyHdr.getXid()); &#125; packet = pendingQueue.remove(); //Âõ†‰∏∫ÂΩìÂâçËøô‰∏™Êï∞ÊçÆÂåÖÂ∑≤ÁªèÊî∂Âà∞‰∫ÜÂìçÂ∫îÔºåÊâÄ‰ª•ËÆ≤ÂÆÉ‰ªépendingQueued‰∏≠ÁßªÈô§ &#125; /* * Since requests are processed in order, we better get a response * to the first request! */ try &#123;//Ê†°È™åÊï∞ÊçÆÂåÖ‰ø°ÊÅØÔºåÊ†°È™åÊàêÂäüÂêéËÆ≤Êï∞ÊçÆÂåÖ‰ø°ÊÅØËøõË°åÊõ¥Êñ∞ÔºàÊõøÊç¢‰∏∫ÊúçÂä°Á´ØÁöÑ‰ø°ÊÅØÔºâ if (packet.requestHeader.getXid() != replyHdr.getXid()) &#123; packet.replyHeader.setErr( KeeperException.Code.CONNECTIONLOSS.intValue()); throw new IOException("Xid out of order. Got Xid " + replyHdr.getXid() + " with err " + + replyHdr.getErr() + " expected Xid " + packet.requestHeader.getXid() + " for a packet with details: " + packet ); &#125; packet.replyHeader.setXid(replyHdr.getXid()); packet.replyHeader.setErr(replyHdr.getErr()); packet.replyHeader.setZxid(replyHdr.getZxid()); if (replyHdr.getZxid() &gt; 0) &#123; lastZxid = replyHdr.getZxid(); &#125; if (packet.response != null &amp;&amp; replyHdr.getErr() == 0) &#123; packet.response.deserialize(bbia, "response"); //Ëé∑ÂæóÊúçÂä°Á´ØÁöÑÂìçÂ∫îÔºåÂèçÂ∫èÂàóÂåñ‰ª•ÂêéËÆæÁΩÆÂà∞packet.responseÂ±ûÊÄß‰∏≠„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Âú®existsÊñπÊ≥ïÁöÑÊúÄÂêé‰∏ÄË°åÈÄöËøápacket.responseÊãøÂà∞ÊîπËØ∑Ê±ÇÁöÑËøîÂõûÁªìÊûú &#125; if (LOG.isDebugEnabled()) &#123; LOG.debug("Reading reply sessionid:0x" + Long.toHexString(sessionId) + ", packet:: " + packet); &#125; &#125; finally &#123; finishPacket(packet); //ÊúÄÂêéË∞ÉÁî®finishPacketÊñπÊ≥ïÂÆåÊàêÂ§ÑÁêÜ &#125; &#125; finishPacketÊñπÊ≥ï‰∏ªË¶ÅÂäüËÉΩÊòØÊää‰ªé Packet ‰∏≠ÂèñÂá∫ÂØπÂ∫îÁöÑ Watcher Âπ∂Ê≥®ÂÜåÂà∞ ZKWatchManager ‰∏≠Âéª 123456789101112131415161718192021222324252627282930313233343536373839private void finishPacket(Packet p) &#123; int err = p.replyHeader.getErr(); if (p.watchRegistration != null) &#123; p.watchRegistration.register(err); //Â∞Ü‰∫ã‰ª∂Ê≥®ÂÜåÂà∞zkwatchemanager‰∏≠watchRegistrationÔºåÁÜüÊÇâÂêóÔºüÂú®ÁªÑË£ÖËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂàùÂßãÂåñ‰∫ÜËøô‰∏™ÂØπË±°ÊääwatchRegistration Â≠êÁ±ªÈáåÈù¢ÁöÑ Watcher ÂÆû‰æãÊîæÂà∞ ZKWatchManager ÁöÑ existsWatches ‰∏≠Â≠òÂÇ®Ëµ∑Êù•„ÄÇ &#125; //Â∞ÜÊâÄÊúâÁßªÈô§ÁöÑÁõëËßÜ‰∫ã‰ª∂Ê∑ªÂä†Âà∞‰∫ã‰ª∂ÈòüÂàó, ËøôÊ†∑ÂÆ¢Êà∑Á´ØËÉΩÊî∂Âà∞ ‚Äúdata/child ‰∫ã‰ª∂Ë¢´ÁßªÈô§‚ÄùÁöÑ‰∫ã‰ª∂Á±ªÂûã if (p.watchDeregistration != null) &#123; Map&lt;EventType, Set&lt;Watcher&gt;&gt; materializedWatchers = null; try &#123; materializedWatchers = p.watchDeregistration.unregister(err); for (Entry&lt;EventType, Set&lt;Watcher&gt;&gt; entry : materializedWatchers.entrySet()) &#123; Set&lt;Watcher&gt; watchers = entry.getValue(); if (watchers.size() &gt; 0) &#123; queueEvent(p.watchDeregistration.getClientPath(), err, watchers, entry.getKey()); // ignore connectionloss when removing from local // session p.replyHeader.setErr(Code.OK.intValue()); &#125; &#125; &#125; catch (KeeperException.NoWatcherException nwe) &#123; p.replyHeader.setErr(nwe.code().intValue()); &#125; catch (KeeperException ke) &#123; p.replyHeader.setErr(ke.code().intValue()); &#125; &#125; //cbÂ∞±ÊòØAsnycCallbackÔºåÂ¶ÇÊûú‰∏∫nullÔºåË°®ÊòéÊòØÂêåÊ≠•Ë∞ÉÁî®ÁöÑÊé•Âè£Ôºå‰∏çÈúÄË¶ÅÂºÇÊ≠•ÂõûÊéâÔºåÂõ†Ê≠§ÔºåÁõ¥Êé•notifyAllÂç≥ÂèØ„ÄÇ if (p.cb == null) &#123; synchronized (p) &#123; p.finished = true; p.notifyAll(); &#125; &#125; else &#123; p.finished = true; eventThread.queuePacket(p); &#125; &#125; watchRegistration12345678910111213public void register(int rc) &#123; if (shouldAddWatch(rc)) &#123; Map&lt;String, Set&lt;Watcher&gt;&gt; watches = getWatches(rc); // //ÈÄöËøáÂ≠êÁ±ªÁöÑÂÆûÁé∞ÂèñÂæóZKWatchManager ‰∏≠ÁöÑ existsWatches synchronized(watches) &#123; Set&lt;Watcher&gt; watchers = watches.get(clientPath); if (watchers == null) &#123; watchers = new HashSet&lt;Watcher&gt;(); watches.put(clientPath, watchers); &#125; watchers.add(watcher); //Â∞Ü Watcher ÂØπË±°ÊîæÂà∞ ZKWatchManager ‰∏≠ÁöÑ existsWatchesÈáåÈù¢ &#125; &#125; &#125; ‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÊòØÂÆ¢Êà∑Á´ØÂ≠òÂÇ®watcherÁöÑÂá†‰∏™mapÈõÜÂêàÔºåÂàÜÂà´ÂØπÂ∫î‰∏âÁßçÊ≥®ÂÜåÁõëÂê¨‰∫ã‰ª∂ 1234567static class ZKWatchManager implements ClientWatchManager &#123; private final Map&lt;String, Set&lt;Watcher&gt;&gt; dataWatches = new HashMap&lt;String, Set&lt;Watcher&gt;&gt;(); private final Map&lt;String, Set&lt;Watcher&gt;&gt; existWatches = new HashMap&lt;String, Set&lt;Watcher&gt;&gt;(); private final Map&lt;String, Set&lt;Watcher&gt;&gt; childWatches = new HashMap&lt;String, Set&lt;Watcher&gt;&gt;(); ÊÄªÁöÑÊù•ËØ¥ÔºåÂΩì‰ΩøÁî®ZooKeeper ÊûÑÈÄ†ÊñπÊ≥ïÊàñËÄÖ‰ΩøÁî® getData„ÄÅexists Âíå getChildren ‰∏â‰∏™Êé•Âè£Êù•Âêë ZooKeeper ÊúçÂä°Âô®Ê≥®ÂÜå Watcher ÁöÑÊó∂ÂÄôÔºåÈ¶ñÂÖàÂ∞ÜÊ≠§Ê∂àÊÅØ‰º†ÈÄíÁªôÊúçÂä°Á´ØÔºå‰º†ÈÄíÊàêÂäüÂêéÔºåÊúçÂä°Á´Ø‰ºöÈÄöÁü•ÂÆ¢Êà∑Á´ØÔºåÁÑ∂ÂêéÂÆ¢Êà∑Á´ØÂ∞ÜËØ•Ë∑ØÂæÑÂíåWatcherÂØπÂ∫îÂÖ≥Á≥ªÂ≠òÂÇ®Ëµ∑Êù•Â§áÁî®„ÄÇ EventThread.queuePacket()finishPacketÊñπÊ≥ïÊúÄÁªà‰ºöË∞ÉÁî®eventThread.queuePacketÔºå ËÆ≤ÂΩìÂâçÁöÑÊï∞ÊçÆÂåÖÊ∑ªÂä†Âà∞Á≠âÂæÖ‰∫ã‰ª∂ÈÄöÁü•ÁöÑÈòüÂàó‰∏≠ 12345678910public void queuePacket(Packet packet) &#123; if (wasKilled) &#123; synchronized (waitingEvents) &#123; if (isRunning) waitingEvents.add(packet); else processEvent(packet); &#125; &#125; else &#123; waitingEvents.add(packet); &#125; &#125; ‰∫ã‰ª∂Ëß¶ÂèëÂâçÈù¢Ëøô‰πàÈïøÁöÑËØ¥ÊòéÔºåÂè™ÊòØ‰∏∫‰∫ÜÊ∏ÖÊ¥óÁöÑËØ¥Êòé‰∫ã‰ª∂ÁöÑÊ≥®ÂÜåÊµÅÁ®ãÔºåÊúÄÁªàÁöÑËß¶ÂèëÔºåËøòÂæóÈúÄË¶ÅÈÄöËøá‰∫ãÂä°ÂûãÊìç‰ΩúÊù•ÂÆåÊàê Âú®Êàë‰ª¨ÊúÄÂºÄÂßãÁöÑÊ°à‰æã‰∏≠ÔºåÈÄöËøáÂ¶Ç‰∏ã‰ª£Á†ÅÂéªÂÆåÊàê‰∫Ü‰∫ã‰ª∂ÁöÑËß¶Âèë 1zookeeper.setData(‚Äú/mic‚Äù, ‚Äú1‚Äù.getByte(),-1) ; //‰øÆÊîπËäÇÁÇπÁöÑÂÄºËß¶ÂèëÁõëÂê¨ ÂâçÈù¢ÁöÑÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´ØÂØπÊé•ÁöÑÊµÅÁ®ãÂ∞±‰∏çÂÜçÈáçÂ§çËÆ≤Ëß£‰∫ÜÔºå‰∫§‰∫íÊµÅÁ®ãÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂîØ‰∏ÄÁöÑÂ∑ÆÂà´Âú®‰∫é‰∫ã‰ª∂Ëß¶Âèë‰∫Ü ÊúçÂä°Á´ØÁöÑ‰∫ã‰ª∂ÂìçÂ∫îDataTree.setData()12345678910111213141516171819202122232425public Stat setData(String path, byte data[], int version, long zxid, long time) throws KeeperException.NoNodeException &#123; Stat s = new Stat(); DataNode n = nodes.get(path); if (n == null) &#123; throw new KeeperException.NoNodeException(); &#125; byte lastdata[] = null; synchronized (n) &#123; lastdata = n.data; n.data = data; n.stat.setMtime(time); n.stat.setMzxid(zxid); n.stat.setVersion(version); n.copyStat(s); &#125; // now update if the path is in a quota subtree. String lastPrefix = getMaxPrefixWithQuota(path); if(lastPrefix != null) &#123; this.updateBytes(lastPrefix, (data == null ? 0 : data.length) - (lastdata == null ? 0 : lastdata.length)); &#125; dataWatches.triggerWatch(path, EventType.NodeDataChanged); //Ëß¶ÂèëÂØπÂ∫îËäÇÁÇπÁöÑNodeDataChanged‰∫ã‰ª∂ return s; &#125; WatcherManager. triggerWatch 12345678910111213141516171819202122232425262728Set&lt;Watcher&gt; triggerWatch(String path, EventType type, Set&lt;Watcher&gt; supress) &#123; WatchedEvent e = new WatchedEvent(type, KeeperState.SyncConnected, path); // Ê†πÊçÆ‰∫ã‰ª∂Á±ªÂûã„ÄÅËøûÊé•Áä∂ÊÄÅ„ÄÅËäÇÁÇπË∑ØÂæÑÂàõÂª∫WatchedEvent HashSet&lt;Watcher&gt; watchers; synchronized (this) &#123; watchers = watchTable.remove(path); // ‰ªéwatcherË°®‰∏≠ÁßªÈô§pathÔºåÂπ∂ËøîÂõûÂÖ∂ÂØπÂ∫îÁöÑwatcherÈõÜÂêà if (watchers == null || watchers.isEmpty()) &#123; if (LOG.isTraceEnabled()) &#123; ZooTrace.logTraceMessage(LOG, ZooTrace.EVENT_DELIVERY_TRACE_MASK, "No watchers for " + path); &#125; return null; &#125; for (Watcher w : watchers) &#123; // ÈÅçÂéÜwatcherÈõÜÂêà HashSet&lt;String&gt; paths = watch2Paths.get(w); // Ê†πÊçÆwatcher‰ªéwatcherË°®‰∏≠ÂèñÂá∫Ë∑ØÂæÑÈõÜÂêà if (paths != null) &#123; paths.remove(path); //ÁßªÈô§Ë∑ØÂæÑ &#125; &#125; &#125; for (Watcher w : watchers) &#123; // ÈÅçÂéÜwatcherÈõÜÂêà if (supress != null &amp;&amp; supress.contains(w)) &#123; continue; &#125; w.process(e); //OKÔºåÈáçÁÇπÂèàÊù•‰∫ÜÔºåw.processÊòØÂÅö‰ªÄ‰πàÂë¢Ôºü &#125; return watchers; &#125; w.process(e);ËøòËÆ∞ÂæóÊàë‰ª¨Âú®ÊúçÂä°Á´ØÁªëÂÆö‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºåwatcherÁªëÂÆöÊòØÊòØ‰ªÄ‰πàÔºüÊòØServerCnxnÔºå ÊâÄ‰ª•w.process(e)ÔºåÂÖ∂ÂÆûË∞ÉÁî®ÁöÑÂ∫îËØ•ÊòØServerCnxnÁöÑprocessÊñπÊ≥ï„ÄÇËÄåservercnxnÂèàÊòØ‰∏Ä‰∏™ÊäΩË±°ÊñπÊ≥ïÔºåÊúâ‰∏§‰∏™ÂÆûÁé∞Á±ªÔºåÂàÜÂà´ÊòØÔºöNIOServerCnxnÂíåNettyServerCnxn„ÄÇÈÇ£Êé•‰∏ãÊù•Êàë‰ª¨ÊâíÂºÄNettyServerCnxnËøô‰∏™Á±ªÁöÑprocessÊñπÊ≥ïÁúãÁúãÁ©∂Á´ü 123456789101112131415161718192021public void process(WatchedEvent event) &#123; ReplyHeader h = new ReplyHeader(-1, -1L, 0); if (LOG.isTraceEnabled()) &#123; ZooTrace.logTraceMessage(LOG, ZooTrace.EVENT_DELIVERY_TRACE_MASK, "Deliver event " + event + " to 0x" + Long.toHexString(this.sessionId) + " through " + this); &#125; // Convert WatchedEvent to a type that can be sent over the wire WatcherEvent e = event.getWrapper(); try &#123; sendResponse(h, e, "notification"); //lookÔºå Ëøô‰∏™Âú∞ÊñπÂèëÈÄÅ‰∫Ü‰∏Ä‰∏™‰∫ã‰ª∂Ôºå‰∫ã‰ª∂ÂØπË±°‰∏∫WatcherEvent„ÄÇÂÆåÁæé &#125; catch (IOException e1) &#123; if (LOG.isDebugEnabled()) &#123; LOG.debug("Problem sending to " + getRemoteSocketAddress(), e1); &#125; close(); &#125; &#125; ÈÇ£Êé•‰∏ãÈáåÔºåÂÆ¢Êà∑Á´Ø‰ºöÊî∂Âà∞Ëøô‰∏™responseÔºåËß¶ÂèëSendThread.readResponseÊñπÊ≥ï ÂÆ¢Êà∑Á´ØÂ§ÑÁêÜ‰∫ã‰ª∂ÂìçÂ∫îSendThread.readResponseËøôÂùó‰ª£Á†Å‰∏äÈù¢Â∑≤ÁªèË¥¥Ëøá‰∫ÜÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÊåëÈÄâÂΩìÂâçÊµÅÁ®ãÁöÑ‰ª£Á†ÅËøõË°åËÆ≤Ëß£ÔºåÊåâÁÖßÂâçÈù¢Êàë‰ª¨Â∞ÜÂà∞ËøáÁöÑÔºånotifacationÈÄöÁü•Ê∂àÊÅØÁöÑxid‰∏∫-1ÔºåÊÑèÂë≥ÁùÄ~Áõ¥Êé•ÊâæÂà∞-1ÁöÑÂà§Êñ≠ËøõË°åÂàÜÊûêÂú®‰∏ãÈù¢‰ª£Á†ÅÊ†áÁ∫¢Â§Ñ. eventThread.queueEvent SendThread Êé•Êî∂Âà∞ÊúçÂä°Á´ØÁöÑÈÄöÁü•‰∫ã‰ª∂ÂêéÔºå‰ºöÈÄöËøáË∞ÉÁî® EventThread Á±ªÁöÑ queueEvent ÊñπÊ≥ïÂ∞Ü‰∫ã‰ª∂‰º†Áªô EventThread Á∫øÁ®ãÔºåqueueEvent ÊñπÊ≥ïÊ†πÊçÆËØ•ÈÄöÁü•‰∫ã‰ª∂Ôºå‰ªé ZKWatchManager ‰∏≠ÂèñÂá∫ÊâÄÊúâÁõ∏ÂÖ≥ÁöÑ WatcherÔºåÂ¶ÇÊûúËé∑ÂèñÂà∞Áõ∏Â∫îÁöÑWatcherÔºåÂ∞±‰ºöËÆ©WatcherÁßªÈô§Â§±Êïà„ÄÇ MeterializeÊñπÊ≥ïÈÄöËøádataWatchesÊàñËÄÖexistWatchesÊàñËÄÖchildWatchesÁöÑremoveÂèñÂá∫ÂØπÂ∫îÁöÑwatchÔºåË°®ÊòéÂÆ¢Êà∑Á´Øwatch‰πüÊòØÊ≥®ÂÜå‰∏ÄÊ¨°Â∞±ÁßªÈô§ÂêåÊó∂ÈúÄË¶ÅÊ†πÊçÆkeeperState„ÄÅeventTypeÂíåpathËøîÂõûÂ∫îËØ•Ë¢´ÈÄöÁü•ÁöÑWatcherÈõÜÂêà waitingEvents.addÊúÄÂêé‰∏ÄÊ≠•ÔºåÊé•ËøëÁúüÁõ∏‰∫ÜwaitingEventsÊòØEventThreadËøô‰∏™Á∫øÁ®ã‰∏≠ÁöÑÈòªÂ°ûÈòüÂàóÔºåÂæàÊòéÊòæÔºåÂèàÊòØÂú®Êàë‰ª¨Á¨¨‰∏ÄÊ≠•Êìç‰ΩúÁöÑÊó∂ÂÄôÂÆû‰æãÂåñÁöÑ‰∏Ä‰∏™Á∫øÁ®ã„ÄÇ‰ªéÂêçÂ≠óÂèØ‰ª•ÊåáÂØºÔºåwaitingEvents ÊòØ‰∏Ä‰∏™ÂæÖÂ§ÑÁêÜ Watcher ÁöÑÈòüÂàóÔºåEventThread ÁöÑ run() ÊñπÊ≥ï‰ºö‰∏çÊñ≠‰ªéÈòüÂàó‰∏≠ÂèñÊï∞ÊçÆÔºå‰∫§Áî± processEvent ÊñπÊ≥ïÂ§ÑÁêÜÔºö ProcessEventÁî±‰∫éËøôÂùóÁöÑ‰ª£Á†ÅÂ§™ÈïøÔºåÊàëÂè™ÊääÊ†∏ÂøÉÁöÑ‰ª£Á†ÅË¥¥Âá∫Êù•ÔºåËøôÈáåÂ∞±ÊòØÂ§ÑÁêÜ‰∫ã‰ª∂Ëß¶ÂèëÁöÑÊ†∏ÂøÉ‰ª£]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
      <tags>
        <tag>zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zookeeperÂéüÁîüAPI‰ΩøÁî®]]></title>
    <url>%2F2018%2F06%2F09%2Fzookeeper%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0_05_%E5%8E%9F%E7%94%9FAPI%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[1„ÄÅÂáÜÂ§áÂ∑•‰Ωú1.1„ÄÅjarÂåÖ12345&lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.8&lt;/version&gt;&lt;/dependency&gt; 1.2„ÄÅÂáÜÂ§áÂ∑•‰ΩúÊú¨‰∫∫‰ΩøÁî®ÁöÑÊòØVMware + CentOS7ÁéØÂ¢ÉÔºåÂç≥ËôöÊãüÊú∫ÔºåËøôÈáåÈúÄË¶ÅÂ∞ÜzookeeperÂÆ¢Êà∑Á´ØËÆøÈóÆÊé•Âè£ÂØπÂ§ñÊö¥Èú≤„ÄÇÂèÇËÄÉÔºöCentosÈò≤ÁÅ´Â¢ôËÆæÁΩÆ‰∏éÁ´ØÂè£ÂºÄÊîæÁöÑÊñπÊ≥ï123456// Âú®ÊåáÂÆöÂå∫ÂüüÊâìÂºÄÁ´ØÂè£firewall-cmd --zone=public --add-port=80/tcpfirewall-cmd --zone=public --add-port=80/tcp --permanent // Ê∞∏‰πÖÁîüÊïà// ÈáçÂêØÈò≤ÁÅ´Â¢ôfirewall-cmd --reload 2„ÄÅÂàõÂª∫ËøûÊé•„ÄÅÂàõÂª∫ËäÇÁÇπ„ÄÅ‰øÆÊîπËäÇÁÇπ„ÄÅÂà†Èô§ËäÇÁÇπ2.1„ÄÅÂàõÂª∫ËøûÊé•12345// org.apache.zookeeper.ZooKeeperpublic ZooKeeper(String connectString, int sessionTimeout, Watcher watcher)public ZooKeeper(String connectString, int sessionTimeout, Watcher watcher, boolean canBeReadOnly)public ZooKeeper(String connectString, int sessionTimeout, Watcher watcher, long sessionId, byte[] sessionPasswd)public ZooKeeper(String connectString, int sessionTimeout, Watcher watcher, long sessionId, byte[] sessionPasswd, boolean canBeReadOnly) ÂèÇÊï∞ Âê´‰πâ connectString ZookeeperÊúçÂä°Âô®ÁöÑÂú∞ÂùÄÂíåÁ´ØÂè£Âè∑ip:port„ÄÇÈõÜÁæ§ÁéØÂ¢É‰ΩøÁî®ÈÄóÂè∑ÈöîÂºÄ„ÄÇ sessionTimeout Ë∂ÖÊó∂Êó∂Èó¥ÔºåË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥‰∏çÂú®ËøûÊé• watcher ÁõëÂê¨‰∫ã‰ª∂ canBeReadOnly Ë°®Á§∫ÂΩìÂâçnewÁöÑÂØπË±°Âè™ËÉΩÊâßË°åËØªÊìç‰ΩúÔºå‰∏çËÉΩÊâßË°åÂÜôÊìç‰Ωú„ÄÇÈªòËÆ§Ôºöfalse sessionId Âõ†ZookeeperÁöÑÈáçËøûÊú∫Âà∂ÔºåÂç≥Êñ≠ÂºÄËøûÊé•ÂêéÔºåÂú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÂèØÂÜçÊ¨°ËøûÊé•Ôºå‰øùÊåÅÂêå‰∏Ä‰∏™‰ºöËØù„ÄÇzookeeper.getSessionId()ÂèØ‰ª•Âú®Êñ≠ÂºÄËøûÊé•ÂâçËé∑ÂèñsessionId sessionPasswd Âõ†ZookeeperÁöÑÈáçËøûÊú∫Âà∂ÔºåÂç≥Êñ≠ÂºÄËøûÊé•ÂêéÔºåÂú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÂèØÂÜçÊ¨°ËøûÊé•Ôºå‰øùÊåÅÂêå‰∏Ä‰∏™‰ºöËØù„ÄÇzookeeper.getSessionPasswd()sessionPasswd ÂèÇËÄÉÔºöZookeeperÂÆû‰æãÂéüÁîüAPI‚ÄìÂ§çÁî®sessionIdÂíåsessionPasswd 2.2„ÄÅÂàõÂª∫ËäÇÁÇπ12String create(final String path, byte[] data, List&lt;ACL&gt; acl, CreateMode createMode)void create(final String path, byte[] data, List&lt;ACL&gt; acl, CreateMode createMode, StringCallback cb, Object ctx) ÂèÇÊï∞ Âê´‰πâ path Ë¢´ÂàõÂª∫ËäÇÁÇπÁöÑË∑ØÂæÑ data Ë¢´ÂàõÂª∫ËäÇÁÇπÁöÑÂÄº acl aclÁ≠ñÁï•„ÄÇËØ¶ËßÅzookeeperÂÆ¢Êà∑Á´ØÁöÑ‰ΩøÁî®ÁöÑ1.6Á´†ËäÇ createMode ËäÇÁÇπÁ±ªÂûãÔºå‰∏¥Êó∂ÊàñËÄÖÊåÅ‰πÖÔºåÊúâÂ∫èËäÇÁÇπÁ≠â„ÄÇËØ¶ËßÅzookeeperÂÆ¢Êà∑Á´ØÁöÑ‰ΩøÁî®ÁöÑ1.2„ÄÅ1.3Á´†ËäÇ cb ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÊ≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåÈúÄÂÆûÁé∞StringCallbackÊé•Âè£„ÄÇÊï∞ÊçÆËäÇÁÇπÂàõÂª∫ÂÆåÊàê‰πãÂêéÔºå‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïËøõË°å‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜ„ÄÇ‰∏ªË¶ÅÈíàÂØπpublic void processResult(int rc, String path, Object ctx, String name)Êé•Âè£ËøõË°åÈáçÂÜô„ÄÇÂèÇËÄÉÔºöZookeeperÂÆ¢Êà∑Á´ØAPI‰πãÂàõÂª∫ËäÇÁÇπÔºà‰∏ÉÔºâ ctx ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÁî®Êà∑‰º†ÈÄí‰∏Ä‰∏™ÂØπË±°ÔºåÂèØ‰ª•Âú®ÂõûË∞ÉÊñπÊ≥ïÊâßË°åÊó∂‰ΩøÁî® ‰∏¥Êó∂ËäÇÁÇπ‰∏ã‰∏çËÉΩÂàõÂª∫Â≠êËäÇÁÇπ Âõ†‰∏∫ÊòØÂéüÁîüAPIÔºåÊïÖ‰∏çËÉΩÂú®Ê≤°ÊúâÁà∂ËäÇÁÇπÁöÑÂâçÊèê‰∏ãÁõ¥Êé•ÂàõÂª∫Â≠êËäÇÁÇπ 2.2.1„ÄÅÂÖ≥‰∫éStringCallbackËΩ¨Ëá™ÔºöZookeeperÂÆ¢Êà∑Á´ØAPI‰πãÂàõÂª∫ËäÇÁÇπÔºà‰∏ÉÔºâ StringCallbackÊé•Âè£ÁªßÊâø‰∫ÜAsyncCallbackÊé•Âè£ÔºåÊù•ÂÆûÁé∞ÂõûË∞ÉÊó∂ÁöÑ‰∏öÂä°Â§ÑÁêÜ„ÄÇÂÖ∂‰∏≠AsyncCallbackÊé•Âè£ËøòÂåÖ8‰∏™ÂõûË∞ÉÊé•Âè£ÔºöStatCallback„ÄÅDataCallback„ÄÅACLCallback„ÄÅChildrenCallback„ÄÅChildren2Callback„ÄÅVoidCallback„ÄÅMultiCallback„ÄÅStringCallback„ÄÇÂèØ‰ª•Âú®‰∏çÂêåÁöÑÂºÇÊ≠•Êé•Âè£‰∏≠ÂÆûÁé∞‰∏çÂêåÁöÑÂõûË∞ÉÊé•Âè£„ÄÇ StringCallbackÊé•Âè£ÁöÑpublic void processResult(int rc, String path, Object ctx, String name)ÊñπÊ≥ï„ÄÇ ÂèÇÊï∞ Âê´‰πâ rc ÊúçÂä°Âô®ÁöÑÂìçÂ∫îÁ†ÅÔºåÂç≥Event.KeeperStateÔºå0Ë°®Á§∫Ë∞ÉÁî®ÊàêÂäüÔºå-4Ë°®Á§∫ËøûÊé•Â∑≤Êñ≠ÂºÄÔºå-110Ë°®Á§∫ÊåáÂÆöËäÇÁÇπÂ∑≤Â≠òÂú®Ôºå-112Ë°®Á§∫‰ºöËØùÂ∑≤ËøáÊúü„ÄÇ path Ë∞ÉÁî®createÊñπÊ≥ïÊó∂‰º†ÂÖ•ÁöÑpath„ÄÇ ctx Ë∞ÉÁî®createÊñπÊ≥ïÊó∂‰º†ÂÖ•ÁöÑctx„ÄÇ name ÂàõÂª∫ÊàêÂäüÁöÑËäÇÁÇπÂêçÁß∞„ÄÇ 2.3„ÄÅ‰øÆÊîπËäÇÁÇπ12Stat setData(final String path, byte data[], int version)public void setData(final String path, byte data[], int version, StatCallback cb, Object ctx) ÂèÇÊï∞ Âê´‰πâ path Ë¢´‰øÆÊîπËäÇÁÇπÁöÑË∑ØÂæÑ data Ë¢´‰øÆÊîπËäÇÁÇπÁöÑÊñ∞ÂÄº version ‰ª£Ë°®ËäÇÁÇπÁöÑÁâàÊú¨Âè∑ÔºåÂ¶ÇÊûúËØ•ÂÄº‰∏ézookeeperÊúçÂä°Âô®Ê≠§ËäÇÁÇπÁöÑdataVersionÂ±ûÊÄßÂÄº‰∏çÁõ∏ÂêåÔºåÂàô‰øÆÊîπÂ§±Ë¥•„ÄÇ -1‰ª£Ë°®ÂøΩÁï•ÁâàÊú¨Âè∑ÁöÑ‰ΩúÁî®ÔºåÂº∫Âà∂‰øÆÊîπÔºÅ cb ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÊ≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåÈúÄÂÆûÁé∞StatCallbackÊé•Âè£„ÄÇÊï∞ÊçÆËäÇÁÇπÂàõÂª∫ÂÆåÊàê‰πãÂêéÔºå‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïËøõË°å‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜ„ÄÇ ctx ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÁî®Êà∑‰º†ÈÄí‰∏Ä‰∏™ÂØπË±°ÔºåÂèØ‰ª•Âú®ÂõûË∞ÉÊñπÊ≥ïÊâßË°åÊó∂‰ΩøÁî® ËøîÂõûÂÄºStat ÊèèËø∞‰∏Ä‰∏™ËäÇÁÇπÁöÑ‰ø°ÊÅØÔºåÂÖ∑‰ΩìÂèØ‰ª•Êü•ÁúãzookeeperÂÆ¢Êà∑Á´ØÁöÑ‰ΩøÁî®ÁöÑÁ´†ËäÇ2 ÂÖ≥‰∫éStatCallbackÔºå‰∏éStringCallbackÁ±ª‰ºº„ÄÇ ÂÆûÁé∞ÁöÑÊñπÊ≥ïÊòØpublic void processResult(int rc, String path, Object ctx, Stat stat) 2.4„ÄÅÂà†Èô§ËäÇÁÇπ12void delete(final String path, int version)void delete(final String path, int version, VoidCallback cb, Object ctx) ‰∏é‰øÆÊîπËäÇÁÇπsetDataÊñπÊ≥ïÁ±ª‰ºº„ÄÇ Âõ†‰∏∫ÊòØÂéüÂßãAPIÔºå‰∏çÂÖÅËÆ∏Âà†Èô§Â≠òÂú®Â≠êËäÇÁÇπÁöÑËäÇÁÇπ 2.5„ÄÅDemo12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576public class ApiZookeeper&#123; // ÈõÜÁæ§ÁéØÂ¢ÉÁî®,ÈöîÂºÄ private static final String CONNECTSTRING = "192.168.27.128:2181"; private static ZooKeeper zookeeper; public static void main(String[] args) throws Exception &#123; connect(); createNode("/xych", "xych"); // createNode("/xych1/lanboo","lanboo"); // Êä•Èîô setNode("/xych", "XYCH", -1); deleteNode("/xych", -1); &#125; /** * Âà†Èô§ËäÇÁÇπ */ public static void deleteNode(String nodePath, int version) throws Exception &#123; zookeeper.delete(nodePath, version); System.out.println("Âà†Èô§ÊàêÂäü"); &#125; /** * ‰øÆÊîπËäÇÁÇπ */ public static void setNode(String nodePath, String value, int version) throws Exception &#123; Stat stat = zookeeper.setData(nodePath, value.getBytes(), version); System.out.println("‰øÆÊîπÊàêÂäü " + stat); &#125; /** * ÂàõÂª∫ËäÇÁÇπ */ public static void createNode(String nodePath, String value) throws Exception &#123; String result = zookeeper.create(nodePath, value.getBytes(), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL); System.out.println("ÂàõÂª∫ÊàêÂäü " + result); &#125; /** * ÂàõÂª∫ËøûÊé• */ public static void connect() throws Exception &#123; // ‰ΩøÁî®CountDownLatchÔºå‰Ωø‰∏ªÁ∫øÁ®ãÁ≠âÂæÖ CountDownLatch countDownLatch = new CountDownLatch(1); zookeeper = new ZooKeeper(CONNECTSTRING, 10000, new Watcher() &#123; @Override public void process(WatchedEvent event) &#123; if(event.getState() == Event.KeeperState.SyncConnected) &#123; System.out.println("Watcher " + zookeeper.getState()); countDownLatch.countDown(); &#125; &#125; &#125;); System.out.println("connect " + zookeeper.getState()); countDownLatch.await(); System.out.println("connect " + zookeeper.getState()); // zookeeper.close(); &#125;&#125;/* ËæìÂá∫ÁªìÊûúconnect CONNECTINGWatcher CONNECTEDconnect CONNECTEDÂàõÂª∫ÊàêÂäü /xych‰øÆÊîπÊàêÂäü 46,47,1524152856857,1524152856864,1,0,0,72057600313458694,4,0,46Âà†Èô§ÊàêÂäü*/ 3„ÄÅexists„ÄÅgetData„ÄÅgetChildren3.1„ÄÅexists Âà§Êñ≠ÊüêËäÇÁÇπÊòØÂê¶Â≠òÂú®1234Stat exists(String path, boolean watch)Stat exists(final String path, Watcher watcher)void exists(String path, boolean watch, StatCallback cb, Object ctx)void exists(final String path, Watcher watcher, StatCallback cb, Object ctx) ÂèÇÊï∞ Âê´‰πâ path Ë¢´Âà§Êñ≠ËäÇÁÇπÁöÑË∑ØÂæÑ watch ÊòØÂê¶Ê∑ªÂä†‰∏Ä‰∏™ÈªòËÆ§Watcher watcher ÁõëÂê¨‰∫ã‰ª∂ cb ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÊ≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåÈúÄÂÆûÁé∞StatCallbackÊé•Âè£„ÄÇÊï∞ÊçÆËäÇÁÇπÂàõÂª∫ÂÆåÊàê‰πãÂêéÔºå‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïËøõË°å‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜ„ÄÇ ctx ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÁî®Êà∑‰º†ÈÄí‰∏Ä‰∏™ÂØπË±°ÔºåÂèØ‰ª•Âú®ÂõûË∞ÉÊñπÊ≥ïÊâßË°åÊó∂‰ΩøÁî® ÂÖ≥‰∫éStatCallbackÂèØ‰ª•ÂèÇËÄÉÊú¨Êñá2.2.1„ÄÇ 3.2„ÄÅgetData Ëé∑ÂèñËäÇÁÇπÂÜÖÂÆπÔºåÂêåÊ≠•Ëé∑ÂèñÂíåÂºÇÊ≠•Ëé∑Âèñ1234byte[] getData(String path, boolean watch, Stat stat)byte[] getData(final String path, Watcher watcher, Stat stat)void getData(String path, boolean watch, DataCallback cb, Object ctx)void getData(final String path, Watcher watcher, DataCallback cb, Object ctx) ÂèÇÊï∞ Âê´‰πâ path ËäÇÁÇπÁöÑË∑ØÂæÑ watch ÊòØÂê¶Ê≥®ÂÜå‰∏Ä‰∏™ÈªòËÆ§Watcher watcher ÁõëÂê¨‰∫ã‰ª∂ cb ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÊ≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåÈúÄÂÆûÁé∞DataCallbackÊé•Âè£„ÄÇÊï∞ÊçÆËäÇÁÇπÂàõÂª∫ÂÆåÊàê‰πãÂêéÔºå‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïËøõË°å‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜ„ÄÇ ctx ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÁî®Êà∑‰º†ÈÄí‰∏Ä‰∏™ÂØπË±°ÔºåÂèØ‰ª•Âú®ÂõûË∞ÉÊñπÊ≥ïÊâßË°åÊó∂‰ΩøÁî® ÂÖ≥‰∫éDataCallbackÂèØ‰ª•ÂèÇËÄÉÊú¨Êñá2.2.1„ÄÇ 3.3„ÄÅgetChildren Ëé∑ÂèñÂ≠êËäÇÁÇπÂàóË°®ÔºåÂêåÊ≠•Ëé∑ÂèñÂíåÂºÇÊ≠•Ëé∑Âèñ12345678List&lt;String&gt; getChildren(String path, boolean watch)List&lt;String&gt; getChildren(final String path, Watcher watcher)List&lt;String&gt; getChildren(String path, boolean watch, Stat stat)List&lt;String&gt; getChildren(final String path, Watcher watcher, Stat stat)void getChildren(String path, boolean watch, ChildrenCallback cb, Object ctx)void getChildren(String path, boolean watch, Children2Callback cb, Object ctx)void getChildren(final String path, Watcher watcher, ChildrenCallback cb, Object ctx)void getChildren(final String path, Watcher watcher, Children2Callback cb, Object ctx) ÂèÇÊï∞ Âê´‰πâ path ËäÇÁÇπÁöÑË∑ØÂæÑ watch ÊòØÂê¶Ê≥®ÂÜå‰∏Ä‰∏™ÈªòËÆ§Watcher watcher ÁõëÂê¨‰∫ã‰ª∂ stat ÊèèËø∞‰∏Ä‰∏™ËäÇÁÇπÁöÑ‰ø°ÊÅØ‰ºöÂ∞ÜpathÊåáÂÆöÁöÑËäÇÁÇπÁöÑ‰ø°ÊÅØÊõ¥Êñ∞ÂÖ∑‰ΩìÂèØ‰ª•Êü•ÁúãzookeeperÂÆ¢Êà∑Á´ØÁöÑ‰ΩøÁî®ÁöÑÁ´†ËäÇ2 cb ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÊ≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåÈúÄÂÆûÁé∞ChildrenCallback„ÄÅChildren2CallbackÊé•Âè£„ÄÇÊï∞ÊçÆËäÇÁÇπÂàõÂª∫ÂÆåÊàê‰πãÂêéÔºå‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïËøõË°å‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜ„ÄÇ ctx ÂºÇÊ≠•ÂàõÂª∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇÁî®Êà∑‰º†ÈÄí‰∏Ä‰∏™ÂØπË±°ÔºåÂèØ‰ª•Âú®ÂõûË∞ÉÊñπÊ≥ïÊâßË°åÊó∂‰ΩøÁî® ÂÖ≥‰∫éChildrenCallback„ÄÅChildren2CallbackÂèØ‰ª•ÂèÇËÄÉÊú¨Êñá2.2.1„ÄÇ 4„ÄÅWatcher‰∫ã‰ª∂ÁõëÊéß WatcherÊòØ‰∏ÄÊ¨°ÊÄßÁöÑÔºåÁî®ÂÆåÂ∞±‰ºöÂ§±Êïà ËΩ¨Ëá™ÔºöZooKeeperÁõëÂê¨Êú∫Âà∂ 4.1„ÄÅ‰∫ã‰ª∂Á±ªÂûã ‰∫ã‰ª∂Á±ªÂûã Âê´‰πâ EventType.None ‰∏éÊúçÂä°Âô®Âª∫Á´ãËøûÊé•Êó∂Ëß¶Âèë EventType.NodeCreated Ë¢´ÁõëÊéßÁöÑËäÇÁÇπË¢´ÂàõÂª∫Ëß¶Âèë EventType.NodeDeleted Ë¢´ÁõëÊéßÁöÑËäÇÁÇπË¢´Âà†Èô§Ëß¶Âèë EventType.NodeDataChanged Ë¢´ÁõëÊéßÁöÑËäÇÁÇπË¢´‰øÆÊîπËß¶Âèë EventType.NodeChildrenChanged Ë¢´ÁõëÊéßÁöÑËäÇÁÇπÁöÑÂ≠êËäÇÁÇπÊï∞ÈáèÂèëÁîüÊîπÂèòÊó∂Ëß¶Âèë 4.2„ÄÅËØªÊìç‰ΩúÁªëÂÆö‰∫ã‰ª∂ ËØªÊìç‰Ωú Âê´‰πâ new ZooKeeper ‰∏ç‰ºöÊåáÂÆöÊüêËäÇÁÇπÔºåÊïÖËß¶ÂèëÁ±ªÂûã‰∏∫EventType.None exists Âà§Êñ≠ÊüêËäÇÁÇπÊòØÂê¶Â≠òÂú®ÔºåÂêåÊó∂ÂØπËØ•ËäÇÁÇπÊ∑ªÂä†Watcher getData Ëé∑ÂèñÊüêËäÇÁÇπÁöÑÂÄºÔºåÂêåÊó∂ÂØπËØ•ËäÇÁÇπÊ∑ªÂä†Watcher getChildren Ëé∑ÂèñÊüêËäÇÁÇπÁöÑÂ≠êËäÇÁÇπÂàóË°®ÔºåÂêåÊó∂ÂØπËØ•ËäÇÁÇπÊ∑ªÂä†Watcher 4.3„ÄÅÂÜôÊìç‰ΩúËß¶Âèë‰∫ã‰ª∂ ÂÜôÊìç‰Ωú Event For ‚Äú/path‚Äù Event For ‚Äú/path/child‚Äù create(‚Äú/path‚Äù) EventType.NodeCreated - delete(‚Äú/path‚Äù) EventType.NodeDeleted - setData(‚Äú/path‚Äù) EventType.NodeDataChanged - create(‚Äú/path/child‚Äù) EventType.NodeChildrenChanged EventType.NodeCreated delete(‚Äú/path/child‚Äù) EventType.NodeChildrenChanged EventType.NodeDeleted setData(‚Äú/path/child‚Äù) - EventType.NodeDataChanged 4.4„ÄÅÂÜôÊìç‰ΩúËß¶Âèë[ËØªÊìç‰ΩúÁªëÂÆöÁöÑ‰∫ã‰ª∂] ‚Äú/path‚Äù ‚Äú/path/child‚Äù ÂÜôÊìç‰ΩúÊâÄËß¶ÂèëÁöÑÁªëÂÆö‰∫ã‰ª∂ exists getData getChildren exists getData getChildren create(‚Äú/path‚Äù) ‚àö ‚àö delete(‚Äú/path‚Äù) ‚àö ‚àö ‚àö setData(‚Äú/path‚Äù) ‚àö ‚àö create(‚Äú/path/child‚Äù) ‚àö ‚àö ‚àö delete(‚Äú/path/child‚Äù) ‚àö ‚àö ‚àö ‚àö setData(‚Äú/path/child‚Äù) ‚àö ‚àö create(&quot;/path/child&quot;)Âíådelete(&quot;/path/child&quot;)Âè™‰ºöËß¶ÂèëgetChildrenÂØπ&quot;/path&quot;ÁöÑÁªëÂÆö‰∫ã‰ª∂Ôºõ ‰∏ç‰ºöËß¶Âèëexists„ÄÅgetDataÂØπ&quot;/path&quot;ÁöÑÁªëÂÆö‰∫ã‰ª∂„ÄÇ 4.4„ÄÅDemo123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184public class ApiZookeeperWatcher implements Watcher&#123; // ÈõÜÁæ§ÁéØÂ¢ÉÁî®,ÈöîÂºÄ private static final String CONNECTSTRING = "192.168.27.131:2181"; private static ZooKeeper zookeeper; // ‰ΩøÁî®CountDownLatchÔºå‰Ωø‰∏ªÁ∫øÁ®ãÁ≠âÂæÖ private static CountDownLatch countDownLatch = new CountDownLatch(1); public static void main(String[] args) throws Exception &#123; connect(); createWatcher("/xych", "xych"); setDataWatcher("/xych", "XYCH"); deleteWatcher("/xych"); // ËøôÈáå"/xych"Â∑≤Ë¢´Âà†Èô§ÔºåÂÜçÊ¨°ÂàõÂª∫„ÄÇÔºàÊ≠§Êó∂"/xych"Ê≤°Êúâ‰ªª‰ΩïWatcherÔºâ // Ê≥®ÊÑèÔºö‰∏¥Êó∂ËäÇÁÇπ‰∏ã‰∏çËÉΩÂàõÂª∫ËäÇÁÇπ if(zookeeper.exists("/xych1", false) == null) &#123; zookeeper.create("/xych1", "xych".getBytes(), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT); &#125; createWatcher_Children("/xych1", "/lanboo", "lanboo"); setDataWatcher_Children("/xych1", "/lanboo", "LANBOO"); deleteWatcher_Children("/xych1", "/lanboo"); &#125; public static void deleteWatcher_Children(String path, String children) throws Exception &#123; countDownLatch = new CountDownLatch(1); // Âà©Áî®getChildrenÔºåÂØπÁà∂ËäÇÁÇπÊ∑ªÂä†Watcher List&lt;String&gt; pathChildren = zookeeper.getChildren(path, new ApiZookeeperWatcher()); System.out.println("deleteWatcher_ChildrenÔºö" + path + "ÁöÑÂ≠êËäÇÁÇπÔºö" + pathChildren); // Âà©Áî®existsÔºåÂØπÂ≠êËäÇÁÇπÊ∑ªÂä†Watcher Stat childrenStat = zookeeper.exists(path + children, new ApiZookeeperWatcher()); if(pathChildren != null &amp;&amp; childrenStat != null) &#123; zookeeper.delete(path + children, -1); countDownLatch.await(); &#125; System.out.println(); &#125; public static void setDataWatcher_Children(String path, String children, String value) throws Exception &#123; countDownLatch = new CountDownLatch(1); // Âà©Áî®getChildrenÔºåÂØπÁà∂ËäÇÁÇπÊ∑ªÂä†Watcher List&lt;String&gt; pathChildren = zookeeper.getChildren(path, new ApiZookeeperWatcher()); System.out.println("setDataWatcher_ChildrenÔºö" + path + "ÁöÑÂ≠êËäÇÁÇπÔºö" + pathChildren); // Âà©Áî®existsÔºåÂØπÂ≠êËäÇÁÇπÊ∑ªÂä†Watcher Stat childrenStat = zookeeper.exists(path + children, new ApiZookeeperWatcher()); if(pathChildren != null &amp;&amp; childrenStat != null) &#123; zookeeper.setData(path + children, value.getBytes(), -1); countDownLatch.await(); &#125; System.out.println(); &#125; /** * ÂØπÊüêËäÇÁÇπÊ∑ªÂä†WarcherÔºåÂØπËØ•ËäÇÁÇπÊ∑ªÂä†Â≠êËäÇÁÇπ */ public static void createWatcher_Children(String path, String children, String value) throws Exception &#123; countDownLatch = new CountDownLatch(2); // Âà©Áî®getChildrenÔºåÂØπÁà∂ËäÇÁÇπÊ∑ªÂä†Watcher List&lt;String&gt; pathChildren = zookeeper.getChildren(path, new ApiZookeeperWatcher()); System.out.println("createWatcher_ChildrenÔºö" + path + "ÁöÑÂ≠êËäÇÁÇπÔºö" + pathChildren); // Âà©Áî®existsÔºåÂØπÂ≠êËäÇÁÇπÊ∑ªÂä†Watcher Stat childrenStat = zookeeper.exists(path + children, new ApiZookeeperWatcher()); if(pathChildren != null &amp;&amp; childrenStat == null) &#123; zookeeper.create(path + children, value.getBytes(), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL); countDownLatch.await(); &#125; System.out.println(); &#125; /** * ÂØπsetDataÁõëÊéß * ÂÅöÊ≥ïÔºö * 1„ÄÅÂà©Áî®existsÔºåÂà§Êñ≠ÊüêËäÇÁÇπÊòØÂê¶Â≠òÂú®ÔºåÂêåÊó∂ÂØπËØ•ËäÇÁÇπÊ∑ªÂä†‰∏Ä‰∏™Watcher * 2„ÄÅÂà†Èô§ËØ•ËäÇÁÇπ */ public static void deleteWatcher(String path) throws Exception &#123; countDownLatch = new CountDownLatch(1); // Âà§Êñ≠"/xych"ËäÇÁÇπÊòØÂê¶Â≠òÂú®ÔºåÂπ∂‰∏îÂØπÊ≠§ËäÇÁÇπÊ∑ªÂä†‰∏Ä‰∏™Watcher Stat stat = zookeeper.exists(path, new ApiZookeeperWatcher()); System.out.println("deleteWatcherÔºö" + path + "ÁöÑËäÇÁÇπÂ±ûÊÄßÔºö" + stat); if(stat != null) &#123; zookeeper.delete(path, -1); countDownLatch.await(); &#125; System.out.println(); &#125; /** * ÂØπsetDataÁõëÊéß * ÂÅöÊ≥ïÔºö * 1„ÄÅÂà©Áî®getDataÔºåËé∑ÂèñÊüêËäÇÁÇπÁöÑvalueÔºåÂêåÊó∂ÂØπËØ•ËäÇÁÇπÊ∑ªÂä†‰∏Ä‰∏™Watcher * 2„ÄÅÂàõÂª∫ËØ•ËäÇÁÇπ */ public static void setDataWatcher(String path, String value) throws Exception &#123; countDownLatch = new CountDownLatch(1); Stat stat = new Stat(); byte[] bytes = zookeeper.getData(path, new ApiZookeeperWatcher(), stat); System.out.println("setDataWatcherÔºö" + path + "ÁöÑÂéüÂßãÂÄº = " + new String(bytes)); System.out.println("setDataWatcherÔºö" + path + "ÁöÑËäÇÁÇπ‰ø°ÊÅØ = " + stat); zookeeper.setData(path, value.getBytes(), -1); countDownLatch.await(); System.out.println(); &#125; /** * ÂØπcreateÁõëÊéß * ÂÅöÊ≥ïÔºö * 1„ÄÅÂà©Áî®existsÔºåÂà§Êñ≠ÊüêËäÇÁÇπÊòØÂê¶Â≠òÂú®ÔºåÂêåÊó∂ÂØπËØ•ËäÇÁÇπÊ∑ªÂä†‰∏Ä‰∏™Watcher * 2„ÄÅÂàõÂª∫ËØ•ËäÇÁÇπ */ public static void createWatcher(String path, String value) throws Exception &#123; countDownLatch = new CountDownLatch(1); // Âà§Êñ≠pathËäÇÁÇπÊòØÂê¶Â≠òÂú®ÔºåÂπ∂‰∏îÂØπÊ≠§ËäÇÁÇπÊ∑ªÂä†‰∏Ä‰∏™Watcher Stat stat = zookeeper.exists(path, new ApiZookeeperWatcher()); System.out.println("createWatcherÔºö" + path + "ÁöÑËäÇÁÇπÂ±ûÊÄßÔºö" + stat); if(stat == null) &#123; zookeeper.create(path, value.getBytes(), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL); countDownLatch.await(); &#125; System.out.println(); &#125; /** * ÂàõÂª∫ËøûÊé• */ public static void connect() throws Exception &#123; zookeeper = new ZooKeeper(CONNECTSTRING, 10000, new ApiZookeeperWatcher()); System.out.println("connect " + zookeeper.getState()); countDownLatch.await(); System.out.println("connect " + zookeeper.getState()); System.out.println(); &#125; @Override public void process(WatchedEvent watchedEvent) &#123; // Âè™Âú®ËøûÊé•ÊàêÂäüÁöÑÊÉÖÂÜµ‰∏ãÔºåËøõË°å‰∫ã‰ª∂ÁõëÂê¨ if(watchedEvent.getState() == Watcher.Event.KeeperState.SyncConnected) &#123; try &#123; if(Event.EventType.None == watchedEvent.getType()) &#123; System.out.println("WatcherÔºö" + watchedEvent.getState() + "--&gt;" + watchedEvent.getType()); &#125; else if(Event.EventType.NodeCreated == watchedEvent.getType()) &#123; System.out.println("WatcherÔºö" + watchedEvent.getPath() + "Ë¢´ÂàõÂª∫"); &#125; else if(Event.EventType.NodeDeleted == watchedEvent.getType()) &#123; System.out.println("WatcherÔºö" + watchedEvent.getPath() + "Ë¢´Âà†Èô§"); &#125; else if(Event.EventType.NodeDataChanged == watchedEvent.getType()) &#123; System.out.println("WatcherÔºö" + watchedEvent.getPath() + "Ë¢´‰øÆÊîπ"); &#125; else if(Event.EventType.NodeChildrenChanged == watchedEvent.getType()) &#123; System.out.println("WatcherÔºö" + watchedEvent.getPath() + "ÁöÑÂ≠êËäÇÁÇπÊï∞ÈáèÂèëÁîüÊîπÂèò"); &#125; countDownLatch.countDown(); &#125; catch(Exception e) &#123; e.printStackTrace(); &#125; &#125; System.out.println("WatcherÔºö" + this); &#125;&#125; ËæìÂá∫12345678910111213141516171819202122232425262728293031323334353637connect CONNECTINGWatcherÔºöSyncConnected--&gt;NoneWatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@7b23ec81connect CONNECTEDcreateWatcherÔºö/xychÁöÑËäÇÁÇπÂ±ûÊÄßÔºönullWatcherÔºö/xychË¢´ÂàõÂª∫WatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@1a7d63bdsetDataWatcherÔºö/xychÁöÑÂéüÂßãÂÄº = xychsetDataWatcherÔºö/xychÁöÑËäÇÁÇπ‰ø°ÊÅØ = 165,165,1524221468877,1524221468877,0,0,0,72057600313458724,4,0,165WatcherÔºö/xychË¢´‰øÆÊîπWatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@7aa0aa6fdeleteWatcherÔºö/xychÁöÑËäÇÁÇπÂ±ûÊÄßÔºö165,166,1524221468877,1524221468884,1,0,0,72057600313458724,4,0,165WatcherÔºö/xychË¢´Âà†Èô§WatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@bb15e0dcreateWatcher_ChildrenÔºö/xych1ÁöÑÂ≠êËäÇÁÇπÔºö[]WatcherÔºö/xych1/lanbooË¢´ÂàõÂª∫WatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@2cce4a9aWatcherÔºö/xych1ÁöÑÂ≠êËäÇÁÇπÊï∞ÈáèÂèëÁîüÊîπÂèòWatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@2d8e2810setDataWatcher_ChildrenÔºö/xych1ÁöÑÂ≠êËäÇÁÇπÔºö[lanboo]WatcherÔºö/xych1/lanbooË¢´‰øÆÊîπWatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@7333dbfedeleteWatcher_ChildrenÔºö/xych1ÁöÑÂ≠êËäÇÁÇπÔºö[lanboo]WatcherÔºö/xych1/lanbooË¢´Âà†Èô§WatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@7165a6c4WatcherÔºö/xych1ÁöÑÂ≠êËäÇÁÇπÊï∞ÈáèÂèëÁîüÊîπÂèòWatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@2f21b320WatcherÔºö/xych1ÁöÑÂ≠êËäÇÁÇπÊï∞ÈáèÂèëÁîüÊîπÂèòWatcherÔºöcom.xych.zookeeper.api.ApiZookeeperWatcher@31ecabd5]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
      <tags>
        <tag>zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â§ßÂûãË∑®Â¢ÉÁîµÂïÜJVMË∞É‰ºòÁªèÂéÜ]]></title>
    <url>%2F2018%2F05%2F29%2F%E5%A4%A7%E5%9E%8B%E8%B7%A8%E5%A2%83%E7%94%B5%E5%95%86JVM%E8%B0%83%E4%BC%98%E7%BB%8F%E5%8E%86%2F</url>
    <content type="text"><![CDATA[Á§∫‰æã ÂºïÁî®Ëá™ https://juejin.im/post/5b091ee35188253892389683?utm_source=gold_browser_extension ÂâçÊèêÔºöÊüêÂ§ßÂûãË∑®Â¢ÉÁîµÂïÜ‰∏öÂä°ÂèëÂ±ïÈùûÂ∏∏Âø´ÔºåÁ∫ø‰∏äÊú∫Âô®Êâ©ÂÆπ‰πüÂæàÈ¢ëÁπÅÔºå‰ΩÜÊòØÂØπ‰∫éÁ∫ø‰∏äÊú∫Âô®ÁöÑËøêË°åÊÉÖÂÜµÔºåÁâπÂà´ÊòØjvmÂÜÖÂ≠òÁöÑÊÉÖÂÜµÔºå‰∏ÄÁõ¥Ê≤°Êúâ‰∏Ä‰∏™Áªü‰∏ÄÁöÑÊ†áÂáÜÊù•ÁªôÂà∞ÂêÑ‰∏™Â∫îÁî®ÊúçÂä°ÁöÑowner„ÄÇÁªèËøá618Â§ß‰øÉ‰πãÂêéÔºåÂíåËøêÁª¥ÁöÑÂêåÂ≠¶ËÆ®ËÆ∫‰∫Ü‰∏ãÔºåÂ∏åÊúõÂ∞ÜÁ∫ø‰∏äÊúçÂä°Âô®ÁöÑjvmÂèÇÊï∞Ê†áÂáÜÂåñÔºåÂèØ‰ª•‰ª•‰∏Ä‰∏™Áªü‰∏ÄÁöÑÊñπÂºèÁªôÂà∞ÂêÑ‰∏™Â∫îÁî®ÔºåÊèêÂçáÁ∫ø‰∏äÊúçÂä°Âô®ÁöÑÁ®≥ÂÆöÊÄßÔºåÂêåÊó∂ÂáèÂ∞ëÂ§ßÂÆ∂ÈÉΩÂéªË∞ÉÊï¥jvmÂèÇÊï∞ÁöÑÊó∂Èó¥„ÄÇÂèÇËÄÉ‰∫Ü‰πãÂâçÂú®Ê∑òÂÆùÂ§©Áå´Â∑•‰ΩúÁöÑÂÖ¨Âè∏ÁöÑÁªèÂéÜÔºöÁªèËøáÂ§ßÂÆ∂ËÆ®ËÆ∫ÔºåÊ†πÊçÆjdkÁöÑÁâàÊú¨‰ª•ÂèäÁ∫ø‰∏äÊú∫Âô®ÈÖçÁΩÆÔºåÁ°ÆÂÆö‰∫Ü‰∏Ä‰∏™Êé®ËçêÁöÑÈªòËÆ§jvmÊ®°ÁâàÔºöÊúÄÁªàÊé®ËçêÁöÑjvmÊ®°ÁâàÔºöjdkÁâàÊú¨ Êú∫Âô®ÈÖçÁΩÆ Âª∫ËÆÆjvmÂèÇÊï∞ Â§áÊ≥® 1jdk1.7 6V8G -server -Xms4g -Xmx4g -Xmn2g -Xss768k -XX:PermSize=512m -XX:MaxPermSize=512m -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+CMSClassUnloadingEnabled -XX:+DisableExplicitGC -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=68 -verbose:gc -XX:+PrintGCDetails -Xloggc:&#123;CATALINA_BASE&#125;/logs/gc.log -XX:+PrintGCDateStamps -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&#123;CATALINA_BASE&#125;/logs ÂâçÂè∞ 1jdk1.7 8V8G -server -Xms4g -Xmx4g -Xmn2g -Xss768k -XX:PermSize=512m -XX:MaxPermSize=512m -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+CMSClassUnloadingEnabled -XX:+DisableExplicitGC -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=68 -verbose:gc -XX:+PrintGCDetails -Xloggc:&#123;CATALINA_BASE&#125;/logs/gc.log -XX:+PrintGCDateStamps -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&#123;CATALINA_BASE&#125;/logs ÂâçÂè∞ 1jdk1.7 4V8G -server -Xms4g -Xmx4g -Xmn2g -Xss768k -XX:PermSize=512m -XX:MaxPermSize=512m -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+CMSClassUnloadingEnabled -XX:+DisableExplicitGC -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=68 -verbose:gc -XX:+PrintGCDetails -Xloggc:&#123;CATALINA_BASE&#125;/logs/gc.log -XX:+PrintGCDateStamps -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&#123;CATALINA_BASE&#125;/logs ÂâçÂè∞ 123jdk1.7 6V8G -server -Xms4g -Xmx4g -XX:MaxPermSize=512m \-verbose:gc -XX:+PrintGCDetails -XloggcÔøº&#123;CATALINA_BASE&#125;/logs/gc.log -XX:+PrintGCTimeStamps \ ÂêéÂè∞ ÈÖçÁΩÆËØ¥ÊòéÔºö Â†ÜËÆæÁΩÆ o -Xms:ÂàùÂßãÂ†ÜÂ§ßÂ∞èo -Xmx:ÊúÄÂ§ßÂ†ÜÂ§ßÂ∞èo -XX:NewSize=n:ËÆæÁΩÆÂπ¥ËΩª‰ª£Â§ßÂ∞èo -XX:NewRatio=n:ËÆæÁΩÆÂπ¥ËΩª‰ª£ÂíåÂπ¥ËÄÅ‰ª£ÁöÑÊØîÂÄº„ÄÇÂ¶Ç:‰∏∫3ÔºåË°®Á§∫Âπ¥ËΩª‰ª£‰∏éÂπ¥ËÄÅ‰ª£ÊØîÂÄº‰∏∫1Ôºö3ÔºåÂπ¥ËΩª‰ª£Âç†Êï¥‰∏™Âπ¥ËΩª‰ª£Âπ¥ËÄÅ‰ª£ÂíåÁöÑ1/4o -XX:SurvivorRatio=n:Âπ¥ËΩª‰ª£‰∏≠EdenÂå∫‰∏é‰∏§‰∏™SurvivorÂå∫ÁöÑÊØîÂÄº„ÄÇÊ≥®ÊÑèSurvivorÂå∫Êúâ‰∏§‰∏™„ÄÇÂ¶ÇÔºö3ÔºåË°®Á§∫EdenÔºöSurvivor=3Ôºö2Ôºå‰∏Ä‰∏™SurvivorÂå∫Âç†Êï¥‰∏™Âπ¥ËΩª‰ª£ÁöÑ1/5o -XX:MaxPermSize=n:ËÆæÁΩÆÊåÅ‰πÖ‰ª£Â§ßÂ∞è Êî∂ÈõÜÂô®ËÆæÁΩÆ o -XX:+UseSerialGC:ËÆæÁΩÆ‰∏≤Ë°åÊî∂ÈõÜÂô®o -XX:+UseParallelGC:ËÆæÁΩÆÂπ∂Ë°åÊî∂ÈõÜÂô®o -XX:+UseParalledlOldGC:ËÆæÁΩÆÂπ∂Ë°åÂπ¥ËÄÅ‰ª£Êî∂ÈõÜÂô®o -XX:+UseConcMarkSweepGC:ËÆæÁΩÆÂπ∂ÂèëÊî∂ÈõÜÂô® ÂûÉÂúæÂõûÊî∂ÁªüËÆ°‰ø°ÊÅØ-XX:+PrintGC-XX:+PrintGCDetails-XX:+PrintGCTimeStamps-Xloggc:filename Âπ∂Ë°åÊî∂ÈõÜÂô®ËÆæÁΩÆ-XX:ParallelGCThreads=n:ËÆæÁΩÆÂπ∂Ë°åÊî∂ÈõÜÂô®Êî∂ÈõÜÊó∂‰ΩøÁî®ÁöÑCPUÊï∞„ÄÇÂπ∂Ë°åÊî∂ÈõÜÁ∫øÁ®ãÊï∞„ÄÇ-XX:MaxGCPauseMillis=n:ËÆæÁΩÆÂπ∂Ë°åÊî∂ÈõÜÊúÄÂ§ßÊöÇÂÅúÊó∂Èó¥-XX:GCTimeRatio=n:ËÆæÁΩÆÂûÉÂúæÂõûÊî∂Êó∂Èó¥Âç†Á®ãÂ∫èËøêË°åÊó∂Èó¥ÁöÑÁôæÂàÜÊØî„ÄÇÂÖ¨Âºè‰∏∫1/(1+n) Âπ∂ÂèëÊî∂ÈõÜÂô®ËÆæÁΩÆ-XX:+CMSIncrementalMode:ËÆæÁΩÆ‰∏∫Â¢ûÈáèÊ®°Âºè„ÄÇÈÄÇÁî®‰∫éÂçïCPUÊÉÖÂÜµ„ÄÇ-XX:ParallelGCThreads=n:ËÆæÁΩÆÂπ∂ÂèëÊî∂ÈõÜÂô®Âπ¥ËΩª‰ª£Êî∂ÈõÜÊñπÂºè‰∏∫Âπ∂Ë°åÊî∂ÈõÜÊó∂Ôºå‰ΩøÁî®ÁöÑCPUÊï∞„ÄÇÂπ∂Ë°åÊî∂ÈõÜÁ∫øÁ®ãÊï∞„ÄÇ ÂèÇÊï∞Ëß£ÈáäÔºö-Xms3072m -Xmx3072mÈíàÂØπJVMÂ†ÜÁöÑËÆæÁΩÆÔºåÈÄöËøá-Xms -XmxÈôêÂÆöÂÖ∂ÊúÄÂ∞è„ÄÅÊúÄÂ§ßÂÄº -Xmn1024mËÆæÁΩÆÂπ¥ËΩª‰ª£Â§ßÂ∞è‰∏∫1024mÊï¥‰∏™JVMÂÜÖÂ≠òÂ§ßÂ∞è=Âπ¥ËΩª‰ª£Â§ßÂ∞è + Âπ¥ËÄÅ‰ª£Â§ßÂ∞è + ÊåÅ‰πÖ‰ª£Â§ßÂ∞èÔºàpermÔºâ„ÄÇ -Xss768k ËÆæÁΩÆÊØè‰∏™Á∫øÁ®ãÁöÑÂ†ÜÊ†àÂ§ßÂ∞è„ÄÇJDK5.0‰ª•ÂêéÊØè‰∏™Á∫øÁ®ãÂ†ÜÊ†àÂ§ßÂ∞è‰∏∫1MÔºå‰ª•ÂâçÊØè‰∏™Á∫øÁ®ãÂ†ÜÊ†àÂ§ßÂ∞è‰∏∫256K„ÄÇÊõ¥ÂÖ∑Â∫îÁî®ÁöÑÁ∫øÁ®ãÊâÄÈúÄÂÜÖÂ≠òÂ§ßÂ∞èËøõË°åË∞ÉÊï¥„ÄÇÂú®Áõ∏ÂêåÁâ©ÁêÜÂÜÖÂ≠ò‰∏ãÔºåÂáèÂ∞èËøô‰∏™ÂÄºËÉΩÁîüÊàêÊõ¥Â§öÁöÑÁ∫øÁ®ã„ÄÇ‰ΩÜÊòØÊìç‰ΩúÁ≥ªÁªüÂØπ‰∏Ä‰∏™ËøõÁ®ãÂÜÖÁöÑÁ∫øÁ®ãÊï∞ËøòÊòØÊúâÈôêÂà∂ÁöÑÔºå‰∏çËÉΩÊó†ÈôêÁîüÊàêÔºåÁªèÈ™åÂÄºÂú®3000~5000Â∑¶Âè≥„ÄÇ -XX:PermSize=512m -XX:MaxPermSize=512mÊåÅ‰πÖ‰ª£‰∏ÄËà¨Âõ∫ÂÆöÂ§ßÂ∞è‰∏∫64mÔºåÊâÄ‰ª•Â¢ûÂ§ßÂπ¥ËΩª‰ª£ÂêéÔºåÂ∞Ü‰ºöÂáèÂ∞èÂπ¥ËÄÅ‰ª£Â§ßÂ∞è„ÄÇÊ≠§ÂÄºÂØπÁ≥ªÁªüÊÄßËÉΩÂΩ±ÂìçËæÉÂ§ßÔºåSunÂÆòÊñπÊé®ËçêÈÖçÁΩÆ‰∏∫Êï¥‰∏™Â†ÜÁöÑ3/8„ÄÇËÆæÁΩÆÈùûÂ†ÜÂÜÖÂ≠òÂàùÂßãÂÄºÔºåÈªòËÆ§ÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑ1/64ÔºõÁî±XX:MaxPermSizeËÆæÁΩÆÊúÄÂ§ßÈùûÂ†ÜÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÔºåÈªòËÆ§ÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑ1/4 -XX:+UseConcMarkSweepGCCMSÊî∂ÈõÜÂô®‰πüË¢´Áß∞‰∏∫Áü≠ÊöÇÂÅúÈ°øÂπ∂ÂèëÊî∂ÈõÜÂô®„ÄÇÂÆÉÊòØÂØπÂπ¥ËÄÅ‰ª£ËøõË°åÂûÉÂúæÊî∂ÈõÜÁöÑ„ÄÇCMSÊî∂ÈõÜÂô®ÈÄöËøáÂ§öÁ∫øÁ®ãÂπ∂ÂèëËøõË°åÂûÉÂúæÂõûÊî∂ÔºåÂ∞ΩÈáèÂáèÂ∞ëÂûÉÂúæÊî∂ÈõÜÈÄ†ÊàêÁöÑÂÅúÈ°ø„ÄÇCMSÊî∂ÈõÜÂô®ÂØπÂπ¥ËΩª‰ª£ËøõË°åÂûÉÂúæÂõûÊî∂‰ΩøÁî®ÁöÑÁÆóÊ≥ïÂíåParallelÊî∂ÈõÜÂô®‰∏ÄÊ†∑„ÄÇËøô‰∏™ÂûÉÂúæÊî∂ÈõÜÂô®ÈÄÇÁî®‰∫é‰∏çËÉΩÂøçÂèóÈïøÊó∂Èó¥ÂÅúÈ°øË¶ÅÊ±ÇÂø´ÈÄüÂìçÂ∫îÁöÑÂ∫îÁî®„ÄÇ -XX:+UseParNewGCÂØπÂπ¥ËΩª‰ª£ÈááÁî®Â§öÁ∫øÁ®ãÂπ∂Ë°åÂõûÊî∂ÔºåËøôÊ†∑Êî∂ÂæóÂø´Ôºõ -XX:+CMSClassUnloadingEnabledÂ¶ÇÊûú‰Ω†ÂêØÁî®‰∫ÜCMSClassUnloadingEnabled ÔºåÂûÉÂúæÂõûÊî∂‰ºöÊ∏ÖÁêÜÊåÅ‰πÖ‰ª£ÔºåÁßªÈô§‰∏çÂÜç‰ΩøÁî®ÁöÑclasses„ÄÇËøô‰∏™ÂèÇÊï∞Âè™ÊúâÂú® UseConcMarkSweepGC ‰πüÂêØÁî®ÁöÑÊÉÖÂÜµ‰∏ãÊâçÊúâÁî®„ÄÇ -XX:+DisableExplicitGCÁ¶ÅÊ≠¢System.gc()ÔºåÂÖçÂæóÁ®ãÂ∫èÂëòËØØË∞ÉÁî®gcÊñπÊ≥ïÂΩ±ÂìçÊÄßËÉΩÔºõ -XX:+UseCMSInitiatingOccupancyOnlyÊ†áÂøóÊù•ÂëΩ‰ª§JVM‰∏çÂü∫‰∫éËøêË°åÊó∂Êî∂ÈõÜÁöÑÊï∞ÊçÆÊù•ÂêØÂä®CMSÂûÉÂúæÊî∂ÈõÜÂë®Êúü„ÄÇËÄåÊòØÔºåÂΩìËØ•Ê†áÂøóË¢´ÂºÄÂêØÊó∂ÔºåJVMÈÄöËøáCMSInitiatingOccupancyFractionÁöÑÂÄºËøõË°åÊØè‰∏ÄÊ¨°CMSÊî∂ÈõÜÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØÁ¨¨‰∏ÄÊ¨°„ÄÇÁÑ∂ËÄåÔºåËØ∑ËÆ∞‰ΩèÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåJVMÊØîÊàë‰ª¨Ëá™Â∑±ËÉΩ‰ΩúÂá∫Êõ¥Â•ΩÁöÑÂûÉÂúæÊî∂ÈõÜÂÜ≥Á≠ñ„ÄÇÂõ†Ê≠§ÔºåÂè™ÊúâÂΩìÊàë‰ª¨ÂÖÖË∂≥ÁöÑÁêÜÁî±(ÊØîÂ¶ÇÊµãËØï)Âπ∂‰∏îÂØπÂ∫îÁî®Á®ãÂ∫è‰∫ßÁîüÁöÑÂØπË±°ÁöÑÁîüÂëΩÂë®ÊúüÊúâÊ∑±ÂàªÁöÑËÆ§Áü•Êó∂ÔºåÊâçÂ∫îËØ•‰ΩøÁî®ËØ•Ê†áÂøó„ÄÇ -XX:CMSInitiatingOccupancyFraction=68ÈªòËÆ§CMSÊòØÂú®tenured generation(Âπ¥ËÄÅ‰ª£ÔºâÂç†Êª°68%ÁöÑÊó∂ÂÄôÂºÄÂßãËøõË°åCMSÊî∂ÈõÜÔºåÂ¶ÇÊûú‰Ω†ÁöÑÂπ¥ËÄÅ‰ª£Â¢ûÈïø‰∏çÊòØÈÇ£‰πàÂø´ÔºåÂπ∂‰∏îÂ∏åÊúõÈôç‰ΩéCMSÊ¨°Êï∞ÁöÑËØùÔºåÂèØ‰ª•ÈÄÇÂΩìË∞ÉÈ´òÊ≠§ÂÄºÔºõ -XX:+UseParNewGCÔºöÂØπÂπ¥ËΩª‰ª£ÈááÁî®Â§öÁ∫øÁ®ãÂπ∂Ë°åÂõûÊî∂ÔºåËøôÊ†∑Êî∂ÂæóÂø´Ôºõ -XX:HeapDumpPath-XX:+PrintGCDetails-XX:+PrintGCTimeStamps-Xloggc:/usr/aaa/dump/heap_trace.txt‰∏äÈù¢ÁöÑÁöÑÂèÇÊï∞ÊâìHeap Dump‰ø°ÊÅØ ‚Äú -XX:+HeapDumpOnOutOfMemoryErrorÊ≠§ÂèÇÊï∞ÂèØ‰ª•ÊéßÂà∂OutOfMemoryErrorÊó∂ÊâìÂç∞Â†ÜÁöÑ‰ø°ÊÅØ Â§ßÂÆ∂ÂèØËÉΩÊ≥®ÊÑèÂà∞‰∫ÜÔºåËøôÈáåÊé®ËçêÈááÁî®cmsÊñπÂºèËøõË°åÂûÉÂúæÂõûÊî∂ÔºõCMSÊòØ‰∏ÄÁßç‰ª•Ëé∑ÂèñÊúÄÁü≠ÂõûÊî∂ÂÅúÈ°øÊó∂Èó¥‰∏∫ÁõÆÊ†áÁöÑÊî∂ÈõÜÂô®ÔºåÂèØ‰ª•ÊúâÊïàÂáèÂ∞ëÊúçÂä°Âô®ÂÅúÈ°øÁöÑÊó∂Èó¥ÔºõCMSÁöÑGCÁ∫øÁ®ãÂØπCPUÁöÑÂç†Áî®Áéá‰ºöÊØîËæÉÈ´òÔºå‰ΩÜÂú®Â§öÊ†∏ÁöÑÊúçÂä°Âô®‰∏äËøòÊòØÂ±ïÁé∞‰∫Ü‰ºòË∂äÁöÑÁâπÊÄßÔºåÁõÆÂâç‰πüË¢´ÈÉ®ÁΩ≤Âú®ÂõΩÂÜÖÁöÑÂêÑÂ§ßÁîµÂïÜÁΩëÁ´ô‰∏ä„ÄÇÊâÄ‰ª•ËøôÈáåÂº∫ÁÉàÊé®ËçêÔºÅcmsÁöÑÊ¶ÇÂøµÔºö CMSÊî∂ÈõÜÂô®‰πüË¢´Áß∞‰∏∫Áü≠ÊöÇÂÅúÈ°øÂπ∂ÂèëÊî∂ÈõÜÂô®„ÄÇÂÆÉÊòØÂØπÂπ¥ËÄÅ‰ª£ËøõË°åÂûÉÂúæÊî∂ÈõÜÁöÑ„ÄÇCMSÊî∂ÈõÜÂô®ÈÄöËøáÂ§öÁ∫øÁ®ãÂπ∂ÂèëËøõË°åÂûÉÂúæÂõûÊî∂ÔºåÂ∞ΩÈáèÂáèÂ∞ëÂûÉÂúæÊî∂ÈõÜÈÄ†ÊàêÁöÑÂÅúÈ°ø„ÄÇCMSÊî∂ÈõÜÂô®ÂØπÂπ¥ËΩª‰ª£ËøõË°åÂûÉÂúæÂõûÊî∂‰ΩøÁî®ÁöÑÁÆóÊ≥ïÂíåParallelÊî∂ÈõÜÂô®‰∏ÄÊ†∑„ÄÇËøô‰∏™ÂûÉÂúæÊî∂ÈõÜÂô®ÈÄÇÁî®‰∫é‰∏çËÉΩÂøçÂèóÈïøÊó∂Èó¥ÂÅúÈ°øË¶ÅÊ±ÇÂø´ÈÄüÂìçÂ∫îÁöÑÂ∫îÁî®„ÄÇCMSÈááÁî®‰∫ÜÂ§öÁßçÊñπÂºèÂ∞ΩÂèØËÉΩÈôç‰ΩéGCÁöÑÊöÇÂÅúÊó∂Èó¥,ÂáèÂ∞ëÁî®Êà∑Á®ãÂ∫èÂÅúÈ°ø„ÄÇÂÅúÈ°øÊó∂Èó¥Èôç‰ΩéÁöÑÂêåÊó∂Áâ∫Áâ≤‰∫ÜCPUÂêûÂêêÈáè „ÄÇËøôÊòØÂú®ÂÅúÈ°øÊó∂Èó¥ÂíåÊÄßËÉΩÈó¥ÂÅöÂá∫ÁöÑÂèñËàçÔºåÂèØ‰ª•ÁÆÄÂçïÁêÜËß£‰∏∫‚ÄùÁ©∫Èó¥(ÊÄßËÉΩ)‚ÄùÊç¢Êó∂Èó¥„ÄÇ Ë∞ÉÊï¥ÁöÑËäÇÂ•èÔºöÁî±‰∫éÊÄïÂΩ±ÂìçÁ∫ø‰∏äÂ∫îÁî®ÔºåÊâÄ‰ª•Ë∞ÉÊï¥ÁöÑÊ≠•È™§ÂàÜ‰∏âÊ≠•ÔºöÁ¨¨‰∏ÄÊ≠•ÔºöÈÉ®ÂàÜÂΩ±ÂìçÂ∞ëÈáèÊú∫Âô®ËØïÁÇπÔºåÂØπÊØîÊú™Ë∞ÉÊï¥ÁöÑÊú∫Âô®ÔºåËßÇÂØüË∞ÉÊï¥ÂêéÁöÑÁªìÊûúÔºõÁ¨¨‰∫åÊ≠•ÔºöË∞ÉÊï¥ÈÉ®ÂàÜÂ∫îÁî®ÁöÑÂèÇÊï∞ÔºåËøõË°åÂéãÊµãÔºåËßÇÂØüÈ´òÂπ∂ÂèëÂéãÊµã‰πãÂêéÁöÑÊïàÊûúÔºõÁ¨¨‰∏âÊ≠•ÔºöË∞ÉÊï¥ÈÉ®ÂàÜÊ†∏ÂøÉÂ∫îÁî®ÁöÑjvmÂèÇÊï∞ÔºåÈÄöËøá818Â§ß‰øÉÊù•ÂÆûÈôÖÊ£ÄÈ™åÊïàÊûúÔºõ ‰∏Ä:ÈïøÊúüË°®Áé∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèòÂåñÔºöfgcÁöÑÊ¨°Êï∞ÂáèÂ∞ëÔºåÂáèÂ∞ë‰∫ÜÂ§ßÊ¶Ç‰∏ÄÂÄç‰ª•‰∏äÔºõmobileÂ∑•Á®ãÔºåË∞ÉÊï¥ÂâçÂü∫Êú¨‰∏ä‰∏ÄÂ§©1-2ËæÜÊ¨°ÔºåË∞ÉÊï¥ÂêéÂü∫Êú¨‰∏äÂ∞±ÊòØ2-3Â§©‰∏ÄÊ¨°ÔºöonlineÔºàÂè¶Â§ñ‰∏Ä‰∏™Â∑•Á®ãÔºâÔºöÂèØ‰ª•ÊòéÊòæÁúãÂà∞fgcÁöÑÁªüËÆ°È¢ëÁéáÂ∞ë‰∫ÜÂæàÂ§öÔºõ Á¨¨‰∫å‰∏™ÂèòÂåñÔºöfgcÁöÑÊó∂Èó¥ÂáèÂ∞ëÂéüÊù•‰∏ÄÊ¨°fgcË¶ÅÂ∞ÜËøë500msÔºåÁé∞Âú®Âè™Ë¶Å100ms‰∏çÂà∞‰∫Ü„ÄÇ‰πüËØÅÊòé‰∫ÜcmsÊúÄÂ§ßÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØÂáèÂ∞ëfgcÁöÑÂÅúÈ°øÊó∂Èó¥„ÄÇ]]></content>
      <categories>
        <category>Ë∞É‰ºò</category>
      </categories>
      <tags>
        <tag>jvm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MysqlËØ≠Âè•‰ºòÂåñexplain‰ΩøÁî®]]></title>
    <url>%2F2018%2F05%2F18%2FMysql%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96explain%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[id1Â¶ÇÊûúÊòØÂ≠êÊü•ËØ¢ÔºåidÁöÑÂ∫èÂè∑‰ºöÈÄíÂ¢ûÔºåidÁöÑÂÄºË∂äÂ§ß‰ºòÂÖàÁ∫ßË∂äÈ´òÔºåË∂äÂÖàË¢´ÊâßË°å select_typeÊü•ËØ¢ÁöÑÁ±ªÂûãÔºå‰∏ªË¶ÅÁî®‰∫éÂå∫Âà´ÊôÆÈÄöÊü•ËØ¢„ÄÅËÅîÂêàÊü•ËØ¢„ÄÅÂ≠êÊü•ËØ¢Á≠âÁöÑÂ§çÊùÇÊü•ËØ¢ SIMPLE:ÁÆÄÂçïÁöÑselectÊü•ËØ¢ÔºåÊü•ËØ¢‰∏≠‰∏çÂåÖÂê´Â≠êÊü•ËØ¢ÊàñËÄÖUNION PRIMARY:Êü•ËØ¢‰∏≠Ëã•ÂåÖÂê´‰ªª‰ΩïÂ§çÊùÇÁöÑÂ≠êÈÉ®ÂàÜÔºåÊúÄÂ§ñÂ±ÇÊü•ËØ¢ÂàôË¢´Ê†áËÆ∞‰∏∫PRIMARYÔºàÊúÄÂêéÂä†ËΩΩÁöÑÈÇ£‰∏Ä‰∏™ Ôºâ SUBQUERY:Âú®SELECTÊàñWHEREÂàóË°®‰∏≠ÂåÖÂê´‰∫ÜÂ≠êÊü•ËØ¢ DERIVED:Âú®FROMÂàóË°®‰∏≠ÂåÖÂê´ÁöÑÂ≠êÊü•ËØ¢Ë¢´Ê†áËÆ∞‰∏∫DERIVEDÔºàË°çÁîüÔºâÔºåMysql‰ºöÈÄíÂΩíÊâßË°åËøô‰∫õÂ≠êÊü•ËØ¢ÔºåÊääÁªìÊûúÊîæÂú®‰∏¥Êó∂Ë°®Èáå„ÄÇ UNION:Ëã•Á¨¨‰∫å‰∏™SELECTÂá∫Áé∞Âú®UNION‰πãÂêéÔºåÂàôË¢´Ê†áËÆ∞‰∏∫UNIONÔºõËã•UNIONÂåÖÂê´Âú®FROMÂ≠óÂè•ÁöÑÊü•ËØ¢‰∏≠ÔºåÂ§ñÂ±ÇSELECTÂ∞ÜË¢´Ê†áËÆ∞‰∏∫:DERIVED UNION RESULT:‰ªéUNIONË°®Ëé∑ÂèñÁªìÊûúÁöÑSELECT type ÊòæÁ§∫Êü•ËØ¢‰ΩøÁî®‰∫Ü‰ΩïÁßçÁ±ªÂûãÔºå‰ªéÊúÄÂ•ΩÂà∞ÊúÄÂ∑Æ‰æùÊ¨°ÊòØSystem&gt;const&gt;eq_ref&gt;range&gt;index&gt;AllÔºàÂÖ®Ë°®Êâ´ÊèèÔºâÔºå‰∏ÄËà¨Êù•ËØ¥Ëá≥Â∞ëËææÂà∞rangeÁ∫ßÂà´ÔºåÊúÄÂ•ΩËææÂà∞ref All:ÂÖ®Ë°®Êâ´Êèè System:Ë°®Âè™Êúâ‰∏ÄË°åËÆ∞ÂΩïÔºåËøôÊòØconstÁ±ªÂûãÁöÑÁâπ‰æãÔºåÂπ≥Êó∂‰∏ç‰ºöÂá∫Áé∞(ÂøΩÁï•‰∏çËÆ°) const:Ë°®Á§∫ÈÄöËøáÁ¥¢Âºï‰∏ÄÊ¨°Â∞±ÊâæÂà∞‰∫Ü,constÁî®‰∫éÊØîËæÉprimary keyÊàñËÄÖuniqueÁ¥¢ÂºïÔºåÂõ†‰∏∫Âè™ÂåπÈÖç‰∏ÄË°åÊï∞ÊçÆÔºåÊâÄ‰ª•ÂæàÂø´„ÄÇÂ¶ÇÂ∞Ü‰∏ªÈîÆÁΩÆ‰∫éwhereÂàóË°®‰∏≠ÔºåMySQLÂ∞±ËÉΩÂ∞ÜËØ•Êü•ËØ¢ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Â∏∏Èáè„ÄÇ const:Ë°®Á§∫ÈÄöËøáÁ¥¢Âºï‰∏ÄÊ¨°Â∞±ÊâæÂà∞‰∫Ü,constÁî®‰∫éÊØîËæÉprimary keyÊàñËÄÖuniqueÁ¥¢ÂºïÔºåÂõ†‰∏∫Âè™ÂåπÈÖç‰∏ÄË°åÊï∞ÊçÆÔºåÊâÄ‰ª•ÂæàÂø´„ÄÇÂ¶ÇÂ∞Ü‰∏ªÈîÆÁΩÆ‰∫éwhereÂàóË°®‰∏≠ÔºåMySQLÂ∞±ËÉΩÂ∞ÜËØ•Êü•ËØ¢ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Â∏∏Èáè„ÄÇ eq_ref:ÂîØ‰∏ÄÊÄßÁ¥¢ÂºïÊâ´ÊèèÔºåÂØπ‰∫éÊØè‰∏™Á¥¢ÂºïÈîÆÔºåË°®‰∏≠Âè™Êúâ‰∏ÄÊù°ËÆ∞ÂΩï‰∏é‰πãÂåπÈÖç„ÄÇÂ∏∏ËßÅ‰∫é‰∏ªÈîÆÊàñÂîØ‰∏ÄÁ¥¢ÂºïÊâ´Êèè„ÄÇ refÔºöÈùûÂîØ‰∏ÄÁ¥¢ÂºïÊâ´ÊèèÔºåËøîÂõûÂåπÈÖçÊüê‰∏™ÂçïÁã¨ÂÄºÁöÑË°åÔºåÊú¨Ë¥®‰∏ä‰πüÊòØ‰∏ÄÁßçÁ¥¢ÂºïËÆøÈóÆÔºåÂÆÉËøîÂõûÊâÄÊúâÂåπÈÖçÊüê‰∏™ÂçïÁã¨ÂÄºÁöÑË°åÔºåÁÑ∂ËÄåÂÆÉÂèØËÉΩ‰ºöÊâæÂà∞Â§ö‰∏™Á¨¶ÂêàÊù°‰ª∂ÁöÑË°åÔºåÊâÄ‰ª•ÂÆÉÂ∫îËØ•Â±û‰∫éÊü•ÊâæÂíåÊâ´ÊèèÁöÑÊ∑∑Âêà‰Ωì rangeÔºöÂè™Ê£ÄÁ¥¢ÁªôÂÆöËåÉÂõ¥ÁöÑË°åÔºå‰ΩøÁî®‰∏Ä‰∏™Á¥¢ÂºïÊù•ÈÄâÊã©Ë°å„ÄÇkeyÂàóÊòæÁ§∫‰ΩøÁî®‰∫ÜÂì™‰∏™Á¥¢ÂºïÔºå‰∏ÄËà¨Â∞±ÊòØÂú®‰Ω†ÁöÑwhereËØ≠Âè•‰∏≠Âá∫Áé∞‰∫Übetween„ÄÅ&lt;„ÄÅ&gt;„ÄÅinÁ≠âÁöÑÊü•ËØ¢„ÄÇËøôÁßçËåÉÂõ¥Êâ´ÊèèÁ¥¢ÂºïÊØîÂÖ®Ë°®Êâ´ÊèèË¶ÅÂ•ΩÔºåÂõ†‰∏∫ÂÆÉÂè™ÈúÄË¶ÅÂºÄÂßã‰∫éÁ¥¢ÂºïÁöÑÊüê‰∏ÄÁÇπÔºåËÄåÁªìÊùü‰∫éÂè¶‰∏ÄÁÇπÔºå‰∏çÁî®Êâ´ÊèèÂÖ®ÈÉ®Á¥¢Âºï„ÄÇ index:FULL INDEX SCAN,index‰∏éallÂå∫Âà´‰∏∫indexÁ±ªÂûãÂè™ÈÅçÂéÜÁ¥¢ÂºïÊ†ë„ÄÇËøôÈÄöÂ∏∏ÊØîallÂø´ÔºåÂõ†‰∏∫Á¥¢ÂºïÊñá‰ª∂ÈÄöÂ∏∏ÊØîÊï∞ÊçÆÊñá‰ª∂Â∞è„ÄÇ rowsÊ†πÊçÆË°®ÁªüËÆ°‰ø°ÊÅØÂèäÁ¥¢ÂºïÈÄâÁî®ÊÉÖÂÜµÔºåÂ§ßËá¥‰º∞ÁÆóÂá∫ÊâæÂà∞ÊâÄÈúÄËÆ∞ÂΩïÊâÄÈúÄË¶ÅËØªÂèñÁöÑË°åÊï∞ extraÂåÖÂê´‰∏çÈÄÇÂêàÂú®ÂÖ∂‰ªñÂàó‰∏≠ÊòæÁ§∫‰ΩÜÂçÅÂàÜÈáçË¶ÅÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ ÂåÖÂê´ÁöÑ‰ø°ÊÅØÔºö ÔºàÂç±Èô©!ÔºâUsing filesort:ËØ¥Êòémysql‰ºöÂØπÊï∞ÊçÆ‰ΩøÁî®‰∏Ä‰∏™Â§ñÈÉ®ÁöÑÁ¥¢ÂºïÊéíÂ∫èÔºåËÄå‰∏çÊòØÊåâÁÖßË°®ÂÜÖÁöÑÁ¥¢ÂºïÈ°∫Â∫èËøõË°åËØªÂèñÔºåMYSQL‰∏≠Êó†Ê≥ïÂà©Áî®Á¥¢ÂºïÂÆåÊàêÁöÑÊéíÂ∫èÊìç‰ΩúÁß∞‰∏∫‚ÄúÊñá‰ª∂ÊéíÂ∫è‚Äù ÔºàÁâπÂà´Âç±Èô©!ÔºâUsing temporary:‰ΩøÁî®‰∫Ü‰∏¥Êó∂Ë°®‰øùÂ≠ò‰∏≠Èó¥ÁªìÊûúÔºåMYSQLÂú®ÂØπÊü•ËØ¢ÁªìÊûúÊéíÂ∫èÊó∂‰ΩøÁî®‰∏¥Êó∂Ë°®„ÄÇÂ∏∏ËßÅ‰∫éÊéíÂ∫èorder by ÂíåÂàÜÁªÑÊü•ËØ¢ group by Using index:Ë°®Á§∫Áõ∏Â∫îÁöÑselectÊìç‰Ωú‰∏≠‰ΩøÁî®‰∫ÜË¶ÜÁõñÁ¥¢ÂºïÔºåÈÅøÂÖçËÆøÈóÆ‰∫ÜË°®ÁöÑÊï∞ÊçÆË°åÔºåÊïàÁéá‰∏çÈîô„ÄÇÂ¶ÇÊûúÂêåÊó∂Âá∫Áé∞using whereÔºåË°®ÊòéÁ¥¢ÂºïË¢´Áî®Êù•ÊâßË°åÁ¥¢ÂºïÈîÆÂÄºÁöÑÊü•ÊâæÔºõÂ¶ÇÊûúÊ≤°ÊúâÂêåÊó∂Âá∫Áé∞using whereÔºåË°®ÊòéÁ¥¢ÂºïÁî®Êù•ËØªÂèñÊï∞ÊçÆËÄåÈùûÊâßË°åÊü•ÊâæÊìç‰Ωú„ÄÇ possible_keysÊòæÁ§∫ÂèØËÉΩÂ∫îÁî®Âú®ËøôÂº†Ë°®‰∏≠ÁöÑÁ¥¢ÂºïÔºå‰∏Ä‰∏™ÊàñÂ§ö‰∏™„ÄÇÊü•ËØ¢Ê∂âÂèäÂà∞ÁöÑÂ≠óÊÆµ‰∏äËã•Â≠òÂú®Á¥¢ÂºïÔºåÂàôËØ•Á¥¢ÂºïÂ∞ÜË¢´ÂàóÂá∫Ôºå ‰ΩÜ‰∏ç‰∏ÄÂÆöË¢´Êü•ËØ¢ÂÆûÈôÖ‰ΩøÁî® keyÂÆûÈôÖ‰ΩøÁî®ÁöÑÁ¥¢ÂºïÔºåÂ¶ÇÊûú‰∏∫NULLÔºåÂàôÊ≤°Êúâ‰ΩøÁî®Á¥¢Âºï„ÄÇÊü•ËØ¢‰∏≠Ëã•‰ΩøÁî®‰∫ÜË¶ÜÁõñÁ¥¢ÂºïÔºåÂàôËØ•Á¥¢Âºï‰ªÖÂá∫Áé∞Âú®keyÂàóË°®‰∏≠ÔºåkeyÂèÇÊï∞ÂèØ‰ª•‰Ωú‰∏∫‰ΩøÁî®‰∫ÜÁ¥¢ÂºïÁöÑÂà§Êñ≠Ê†áÂáÜ key_len:Ë°®Á§∫Á¥¢Âºï‰∏≠‰ΩøÁî®ÁöÑÂ≠óËäÇÊï∞ÔºåÂèØÈÄöËøáËØ•ÂàóËÆ°ÁÆóÊü•ËØ¢‰∏≠Á¥¢ÂºïÁöÑÈïøÂ∫¶ÔºåÂú®‰∏çÊçüÂ§±Á≤æÁ°ÆÊÄßÁöÑÊÉÖÂÜµ‰∏ãÔºåÈïøÂ∫¶Ë∂äÁü≠Ë∂äÂ•ΩÔºåkey_lenÊòæÁ§∫ÁöÑÂÄº‰∏∫Á¥¢ÂºïÂ≠óÊÆµÁöÑÊúÄÂ§ßÂèØËÉΩÈïøÂ∫¶ÔºåÂπ∂ÈùûÂÆûÈôÖ‰ΩøÁî®ÈïøÂ∫¶ÔºåÂç≥key_lenÊòØÊ†πÊçÆË°®ÂÆö‰πâËÆ°ÁÆóËÄåÂæóÔºå‰∏çÊòØÈÄöËøáË°®ÂÜÖÊ£ÄÁ¥¢Âá∫ÁöÑ„ÄÇ refÂØπÂ∫îÁ¥¢ÂºïÁöÑËµãÂÄºÔºåÊòæÁ§∫Á¥¢ÂºïÁöÑÂì™‰∏ÄÂàóË¢´‰ΩøÁî®‰∫ÜÔºåÂ¶ÇÊûúÂèØËÉΩÁöÑËØùÔºåÊòØ‰∏Ä‰∏™Â∏∏Êï∞„ÄÇÂì™‰∫õÂàóÊàñÂ∏∏ÈáèË¢´Áî®‰∫éÊü•ÊâæÁ¥¢Âºï‰∏äÁöÑÂÄº„ÄÇ]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âü∫‰∫é Redis ÁöÑÂàÜÂ∏ÉÂºèÈîÅ]]></title>
    <url>%2F2018%2F05%2F15%2F%E5%9F%BA%E4%BA%8E-Redis-%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂàÜÂ∏ÉÂºèÈîÅÂú®ÂàÜÂ∏ÉÂºèÂ∫îÁî®‰∏≠Â∫îÁî®ÂπøÊ≥õÔºåÊÉ≥Ë¶ÅÊêûÊáÇ‰∏Ä‰∏™Êñ∞‰∫ãÁâ©È¶ñÂÖàÂæó‰∫ÜËß£ÂÆÉÁöÑÁî±Êù•ÔºåËøôÊ†∑ÊâçËÉΩÊõ¥Âä†ÁöÑÁêÜËß£ÁîöËá≥ÂèØ‰ª•‰∏æ‰∏ÄÂèç‰∏â„ÄÇ È¶ñÂÖàË∞àÂà∞ÂàÜÂ∏ÉÂºèÈîÅËá™ÁÑ∂‰πüÂ∞±ËÅîÊÉ≥Âà∞ÂàÜÂ∏ÉÂºèÂ∫îÁî®„ÄÇ Âú®Êàë‰ª¨Â∞ÜÂ∫îÁî®ÊãÜÂàÜ‰∏∫ÂàÜÂ∏ÉÂºèÂ∫îÁî®‰πãÂâçÁöÑÂçïÊú∫Á≥ªÁªü‰∏≠ÔºåÂØπ‰∏Ä‰∫õÂπ∂ÂèëÂú∫ÊôØËØªÂèñÂÖ¨ÂÖ±ËµÑÊ∫êÊó∂Â¶ÇÊâ£Â∫ìÂ≠òÔºåÂçñËΩ¶Á•®‰πãÁ±ªÁöÑÈúÄÊ±ÇÂèØ‰ª•ÁÆÄÂçïÁöÑ‰ΩøÁî®ÂêåÊ≠•ÊàñËÄÖÊòØÂä†ÈîÅÂ∞±ÂèØ‰ª•ÂÆûÁé∞„ÄÇ ‰ΩÜÊòØÂ∫îÁî®ÂàÜÂ∏ÉÂºè‰∫Ü‰πãÂêéÁ≥ªÁªüÁî±‰ª•ÂâçÁöÑÂçïËøõÁ®ãÂ§öÁ∫øÁ®ãÁöÑÁ®ãÂ∫èÂèò‰∏∫‰∫ÜÂ§öËøõÁ®ãÂ§öÁ∫øÁ®ãÔºåËøôÊó∂‰ΩøÁî®‰ª•‰∏äÁöÑËß£ÂÜ≥ÊñπÊ°àÊòéÊòæÂ∞±‰∏çÂ§ü‰∫Ü„ÄÇ Âõ†Ê≠§‰∏öÁïåÂ∏∏Áî®ÁöÑËß£ÂÜ≥ÊñπÊ°àÈÄöÂ∏∏ÊòØÂÄüÂä©‰∫é‰∏Ä‰∏™Á¨¨‰∏âÊñπÁªÑ‰ª∂Âπ∂Âà©Áî®ÂÆÉËá™Ë∫´ÁöÑÊéí‰ªñÊÄßÊù•ËææÂà∞Â§öËøõÁ®ãÁöÑ‰∫íÊñ•„ÄÇÂ¶ÇÔºö Âü∫‰∫é DB ÁöÑÂîØ‰∏ÄÁ¥¢Âºï„ÄÇ Âü∫‰∫é ZK ÁöÑ‰∏¥Êó∂ÊúâÂ∫èËäÇÁÇπ„ÄÇ Âü∫‰∫é Redis ÁöÑ NX EX ÂèÇÊï∞„ÄÇ ËøôÈáå‰∏ªË¶ÅÂü∫‰∫é Redis ËøõË°åËÆ®ËÆ∫„ÄÇ ÂÆûÁé∞Êó¢ÁÑ∂ÊòØÈÄâÁî®‰∫Ü RedisÔºåÈÇ£‰πàÂÆÉÂ∞±ÂæóÂÖ∑ÊúâÊéí‰ªñÊÄßÊâçË°å„ÄÇÂêåÊó∂ÂÆÉÊúÄÂ•Ω‰πüÊúâÈîÅÁöÑ‰∏Ä‰∫õÂü∫Êú¨ÁâπÊÄßÔºö È´òÊÄßËÉΩ(Âä†„ÄÅËß£ÈîÅÊó∂È´òÊÄßËÉΩ) ÂèØ‰ª•‰ΩøÁî®ÈòªÂ°ûÈîÅ‰∏éÈùûÈòªÂ°ûÈîÅ„ÄÇ ‰∏çËÉΩÂá∫Áé∞Ê≠ªÈîÅ„ÄÇ ÂèØÁî®ÊÄß(‰∏çËÉΩÂá∫Áé∞ËäÇÁÇπ down ÊéâÂêéÂä†ÈîÅÂ§±Ë¥•)„ÄÇ ËøôÈáåÂà©Áî® Redis set key Êó∂ÁöÑ‰∏Ä‰∏™ NX ÂèÇÊï∞ÂèØ‰ª•‰øùËØÅÂú®Ëøô‰∏™ key ‰∏çÂ≠òÂú®ÁöÑÊÉÖÂÜµ‰∏ãÂÜôÂÖ•ÊàêÂäü„ÄÇÂπ∂‰∏îÂÜçÂä†‰∏ä EX ÂèÇÊï∞ÂèØ‰ª•ËÆ©ËØ• key Âú®Ë∂ÖÊó∂‰πãÂêéËá™Âä®Âà†Èô§„ÄÇ ÊâÄ‰ª•Âà©Áî®‰ª•‰∏ä‰∏§‰∏™ÁâπÊÄßÂèØ‰ª•‰øùËØÅÂú®Âêå‰∏ÄÊó∂ÂàªÂè™‰ºöÊúâ‰∏Ä‰∏™ËøõÁ®ãËé∑ÂæóÈîÅÔºåÂπ∂‰∏î‰∏ç‰ºöÂá∫Áé∞Ê≠ªÈîÅ(ÊúÄÂùèÁöÑÊÉÖÂÜµÂ∞±ÊòØË∂ÖÊó∂Ëá™Âä®Âà†Èô§ key)„ÄÇ Âä†ÈîÅÂÆûÁé∞‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112private static final String SET_IF_NOT_EXIST = "NX";private static final String SET_WITH_EXPIRE_TIME = "PX";public boolean tryLock(String key, String request) &#123; String result = this.jedis.set(LOCK_PREFIX + key, request, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, 10 * TIME); if (LOCK_MSG.equals(result))&#123; return true ; &#125;else &#123; return false ; &#125;&#125; Ê≥®ÊÑèËøôÈáå‰ΩøÁî®ÁöÑ jedis ÁöÑ 1String set(String key, String value, String nxxx, String expx, long time); api„ÄÇ ËØ•ÂëΩ‰ª§ÂèØ‰ª•‰øùËØÅ NX EX ÁöÑÂéüÂ≠êÊÄß„ÄÇ ‰∏ÄÂÆö‰∏çË¶ÅÊää‰∏§‰∏™ÂëΩ‰ª§(NX EX)ÂàÜÂºÄÊâßË°åÔºåÂ¶ÇÊûúÂú® NX ‰πãÂêéÁ®ãÂ∫èÂá∫Áé∞ÈóÆÈ¢òÂ∞±ÊúâÂèØËÉΩ‰∫ßÁîüÊ≠ªÈîÅ„ÄÇ ÈòªÂ°ûÈîÅÂêåÊó∂‰πüÂèØ‰ª•ÂÆûÁé∞‰∏Ä‰∏™ÈòªÂ°ûÈîÅÔºö 123456789101112131415161718192021222324252627282930//‰∏ÄÁõ¥ÈòªÂ°ûpublic void lock(String key, String request) throws InterruptedException &#123; for (;;)&#123; String result = this.jedis.set(LOCK_PREFIX + key, request, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, 10 * TIME); if (LOCK_MSG.equals(result))&#123; break ; &#125; //Èò≤Ê≠¢‰∏ÄÁõ¥Ê∂àËÄó CPU Thread.sleep(DEFAULT_SLEEP_TIME) ; &#125;&#125; //Ëá™ÂÆö‰πâÈòªÂ°ûÊó∂Èó¥ public boolean lock(String key, String request,int blockTime) throws InterruptedException &#123; while (blockTime &gt;= 0)&#123; String result = this.jedis.set(LOCK_PREFIX + key, request, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, 10 * TIME); if (LOCK_MSG.equals(result))&#123; return true ; &#125; blockTime -= DEFAULT_SLEEP_TIME ; Thread.sleep(DEFAULT_SLEEP_TIME) ; &#125; return false ;&#125; Ëß£ÈîÅËß£ÈîÅ‰πüÂæàÁÆÄÂçïÔºåÂÖ∂ÂÆûÂ∞±ÊòØÊääËøô‰∏™ key Âà†ÊéâÂ∞±‰∏á‰∫ãÂ§ßÂêâ‰∫ÜÔºåÊØîÂ¶Ç‰ΩøÁî® del key ÂëΩ‰ª§„ÄÇ ‰ΩÜÁé∞ÂÆûÂæÄÂæÄÊ≤°ÊúâÈÇ£‰πà easy„ÄÇ Â¶ÇÊûúËøõÁ®ã A Ëé∑Âèñ‰∫ÜÈîÅËÆæÁΩÆ‰∫ÜË∂ÖÊó∂Êó∂Èó¥Ôºå‰ΩÜÊòØÁî±‰∫éÊâßË°åÂë®ÊúüËæÉÈïøÂØºËá¥Âà∞‰∫ÜË∂ÖÊó∂Êó∂Èó¥‰πãÂêéÈîÅÂ∞±Ëá™Âä®ÈáäÊîæ‰∫Ü„ÄÇËøôÊó∂ËøõÁ®ã B Ëé∑Âèñ‰∫ÜËØ•ÈîÅÊâßË°åÂæàÂø´Â∞±ÈáäÊîæÈîÅ„ÄÇËøôÊ†∑Â∞±‰ºöÂá∫Áé∞ËøõÁ®ã B Â∞ÜËøõÁ®ã A ÁöÑÈîÅÈáäÊîæ‰∫Ü„ÄÇ ÊâÄ‰ª•ÊúÄÂ•ΩÁöÑÊñπÂºèÊòØÂú®ÊØèÊ¨°Ëß£ÈîÅÊó∂ÈÉΩÈúÄË¶ÅÂà§Êñ≠ÈîÅÊòØÂê¶ÊòØËá™Â∑±ÁöÑ„ÄÇ ËøôÊó∂Â∞±ÈúÄË¶ÅÁªìÂêàÂä†ÈîÅÊú∫Âà∂‰∏ÄËµ∑ÂÆûÁé∞‰∫Ü„ÄÇ Âä†ÈîÅÊó∂ÈúÄË¶Å‰º†ÈÄí‰∏Ä‰∏™ÂèÇÊï∞ÔºåÂ∞ÜËØ•ÂèÇÊï∞‰Ωú‰∏∫Ëøô‰∏™ key ÁöÑ valueÔºåËøôÊ†∑ÊØèÊ¨°Ëß£ÈîÅÊó∂Âà§Êñ≠ value ÊòØÂê¶Áõ∏Á≠âÂç≥ÂèØ„ÄÇ ÊâÄ‰ª•Ëß£ÈîÅ‰ª£Á†ÅÂ∞±‰∏çËÉΩÊòØÁÆÄÂçïÁöÑ del‰∫Ü„ÄÇ 1234567891011121314151617181920public boolean unlock(String key,String request)&#123; //lua script String script = "if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end"; Object result = null ; if (jedis instanceof Jedis)&#123; result = ((Jedis)this.jedis).eval(script, Collections.singletonList(LOCK_PREFIX + key), Collections.singletonList(request)); &#125;else if (jedis instanceof JedisCluster)&#123; result = ((JedisCluster)this.jedis).eval(script, Collections.singletonList(LOCK_PREFIX + key), Collections.singletonList(request)); &#125;else &#123; //throw new RuntimeException("instance is error") ; return false ; &#125; if (UNLOCK_MSG.equals(result))&#123; return true ; &#125;else &#123; return false ; &#125;&#125; ËøôÈáå‰ΩøÁî®‰∫Ü‰∏Ä‰∏™ lua ËÑöÊú¨Êù•Âà§Êñ≠ value ÊòØÂê¶Áõ∏Á≠âÔºåÁõ∏Á≠âÊâçÊâßË°å del ÂëΩ‰ª§„ÄÇ ‰ΩøÁî® lua ‰πüÂèØ‰ª•‰øùËØÅËøôÈáå‰∏§‰∏™Êìç‰ΩúÁöÑÂéüÂ≠êÊÄß„ÄÇ Âõ†Ê≠§‰∏äÊñáÊèêÂà∞ÁöÑÂõõ‰∏™Âü∫Êú¨ÁâπÊÄß‰πüËÉΩÊª°Ë∂≥‰∫ÜÔºö ‰ΩøÁî® Redis ÂèØ‰ª•‰øùËØÅÊÄßËÉΩ„ÄÇ ÈòªÂ°ûÈîÅ‰∏éÈùûÈòªÂ°ûÈîÅËßÅ‰∏äÊñá„ÄÇ Âà©Áî®Ë∂ÖÊó∂Êú∫Âà∂Ëß£ÂÜ≥‰∫ÜÊ≠ªÈîÅ„ÄÇ Redis ÊîØÊåÅÈõÜÁæ§ÈÉ®ÁΩ≤ÊèêÈ´ò‰∫ÜÂèØÁî®ÊÄß„ÄÇ ‰ΩøÁî®ÊàëËá™Â∑±ÊúâÊí∏‰∫Ü‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÂÆûÁé∞ÔºåÂπ∂‰∏îÂ∑≤ÁªèÁî®‰∫é‰∫ÜÁîü‰∫ßÔºåÊúâÂÖ¥Ë∂£ÁöÑÊúãÂèãÂèØ‰ª•ÂºÄÁÆ±‰ΩøÁî®: maven ‰æùËµñÔºö 12345&lt;dependency&gt; &lt;groupId&gt;top.crossoverjie.opensource&lt;/groupId&gt; &lt;artifactId&gt;distributed-redis-lock&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt;&lt;/dependency&gt; ÈÖçÁΩÆ bean : 1234567891011121314@Configurationpublic class RedisLockConfig &#123; @Bean public RedisLock build()&#123; RedisLock redisLock = new RedisLock() ; HostAndPort hostAndPort = new HostAndPort("127.0.0.1",7000) ; JedisCluster jedisCluster = new JedisCluster(hostAndPort) ; // Jedis Êàñ JedisCluster ÈÉΩÂèØ‰ª• redisLock.setJedisCluster(jedisCluster) ; return redisLock ; &#125;&#125; ‰ΩøÁî®Ôºö 123456789101112131415161718192021@Autowiredprivate RedisLock redisLock ;public void use() &#123; String key = "key"; String request = UUID.randomUUID().toString(); try &#123; boolean locktest = redisLock.tryLock(key, request); if (!locktest) &#123; System.out.println("locked error"); return; &#125; //do something &#125; finally &#123; redisLock.unlock(key,request) ; &#125;&#125; ‰ΩøÁî®ÂæàÁÆÄÂçï„ÄÇËøôÈáå‰∏ªË¶ÅÊòØÊÉ≥Âà©Áî® Spring Êù•Â∏ÆÊàë‰ª¨ÁÆ°ÁêÜ RedisLock Ëøô‰∏™Âçï‰æãÁöÑ beanÔºåÊâÄ‰ª•Âú®ÈáäÊîæÈîÅÁöÑÊó∂ÂÄôÈúÄË¶ÅÊâãÂä®(Âõ†‰∏∫Êï¥‰∏™‰∏ä‰∏ãÊñáÂè™Êúâ‰∏Ä‰∏™ RedisLock ÂÆû‰æã)ÁöÑ‰º†ÂÖ• key ‰ª•Âèä request(api ÁúãËµ∑Êù•‰∏çÊòØÁâπÂà´‰ºòÈõÖ)„ÄÇ ‰πüÂèØ‰ª•Âú®ÊØèÊ¨°‰ΩøÁî®ÈîÅÁöÑÊó∂ÂÄô new ‰∏Ä‰∏™ RedisLock ‰º†ÂÖ• key ‰ª•Âèä requestÔºåËøôÊ†∑ÂÄíÊòØÂú®Ëß£ÈîÅÊó∂ÂæàÊñπ‰æø„ÄÇ‰ΩÜÊòØÈúÄË¶ÅËá™Ë°åÁÆ°ÁêÜ RedisLock ÁöÑÂÆû‰æã„ÄÇÂêÑÊúâ‰ºòÂä£Âêß„ÄÇ È°πÁõÆÊ∫êÁ†ÅÂú®Ôºö https://github.com/crossoverJie/distributed-lock-redis Ê¨¢ËøéËÆ®ËÆ∫„ÄÇ ÂçïÊµãÂú®ÂÅöËøô‰∏™È°πÁõÆÁöÑÊó∂ÂÄôËÆ©Êàë‰∏çÂæó‰∏çÊÉ≥Êèê‰∏Ä‰∏ãÂçïÊµã„ÄÇ Âõ†‰∏∫Ëøô‰∏™Â∫îÁî®ÊòØÂº∫‰æùËµñ‰∫éÁ¨¨‰∏âÊñπÁªÑ‰ª∂ÁöÑ(Redis)Ôºå‰ΩÜÊòØÂú®ÂçïÊµã‰∏≠Êàë‰ª¨ÈúÄË¶ÅÊéíÈô§ÊéâËøôÁßç‰æùËµñ„ÄÇÊØîÂ¶ÇÂÖ∂‰ªñ‰ºô‰º¥ fork ‰∫ÜËØ•È°πÁõÆÊÉ≥Âú®Êú¨Âú∞Ë∑ë‰∏ÄÈÅçÂçïÊµãÔºåÁªìÊûúËøêË°å‰∏çËµ∑Êù•Ôºö ÊúâÂèØËÉΩÊòØ Redis ÁöÑ ip„ÄÅÁ´ØÂè£ÂíåÂçïÊµãÈáåÁöÑ‰∏ç‰∏ÄËá¥„ÄÇ Redis Ëá™Ë∫´ÂèØËÉΩ‰πüÊúâÈóÆÈ¢ò„ÄÇ ‰πüÊúâÂèØËÉΩÊòØËØ•ÂêåÂ≠¶ÁöÑÁéØÂ¢É‰∏≠Âπ∂Ê≤°Êúâ Redis„ÄÇ ÊâÄ‰ª•ÊúÄÂ•ΩÊòØË¶ÅÊääËøô‰∫õÂ§ñÈÉ®‰∏çÁ®≥ÂÆöÁöÑÂõ†Á¥†ÊéíÈô§ÊéâÔºåÂçïÊµãÂè™ÊµãÊàë‰ª¨ÂÜôÂ•ΩÁöÑ‰ª£Á†Å„ÄÇ ‰∫éÊòØÂ∞±ÂèØ‰ª•ÂºïÂÖ•ÂçïÊµãÂà©Âô® Mock ‰∫Ü„ÄÇ ÂÆÉÁöÑÊÉ≥Ê≥ïÂæàÁÆÄÁ≠îÔºåÂ∞±ÊòØË¶ÅÊää‰Ω†ÊâÄ‰æùËµñÁöÑÂ§ñÈÉ®ËµÑÊ∫êÁªüÁªüÂ±èËîΩÊéâ„ÄÇÂ¶ÇÔºöÊï∞ÊçÆÂ∫ì„ÄÅÂ§ñÈÉ®Êé•Âè£„ÄÅÂ§ñÈÉ®Êñá‰ª∂Á≠âÁ≠â„ÄÇ ‰ΩøÁî®ÊñπÂºè‰πüÊå∫ÁÆÄÂçïÔºåÂèØ‰ª•ÂèÇËÄÉËØ•È°πÁõÆÁöÑÂçïÊµãÔºö 12345678910111213141516@Testpublic void tryLock() throws Exception &#123; String key = "test"; String request = UUID.randomUUID().toString(); Mockito.when(jedisCluster.set(Mockito.anyString(), Mockito.anyString(), Mockito.anyString(), Mockito.anyString(), Mockito.anyLong())).thenReturn("OK"); boolean locktest = redisLock.tryLock(key, request); System.out.println("locktest=" + locktest); Assert.assertTrue(locktest); //check Mockito.verify(jedisCluster).set(Mockito.anyString(), Mockito.anyString(), Mockito.anyString(), Mockito.anyString(), Mockito.anyLong());&#125; ËøôÈáåÂè™ÊòØÁÆÄÂçïÊºîÁ§∫‰∏ãÔºåÂèØ‰ª•ÁöÑËØù‰∏ãÊ¨°‰ªîÁªÜÂàÜÊûêÂàÜÊûê„ÄÇ ÂÆÉÁöÑÂéüÁêÜÂÖ∂ÂÆû‰πüÊå∫ÁÆÄÂçïÔºådebug ÁöÑËØùÂèØ‰ª•ÂæàÁõ¥Êé•ÁöÑÁúãÂá∫Êù•Ôºö ËøôÈáåÊàë‰ª¨ÊâÄ‰æùËµñÁöÑ JedisCluster ÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ cglib ‰ª£ÁêÜÂØπË±°„ÄÇÊâÄ‰ª•‰πü‰∏çÈöæÊÉ≥Âà∞ÂÆÉÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ ÊØîÂ¶ÇËøôÈáåÊàë‰ª¨ÈúÄË¶ÅÁî®Âà∞ JedisCluster ÁöÑ set ÂáΩÊï∞Âπ∂ÈúÄË¶ÅÂÆÉÁöÑËøîÂõûÂÄº„ÄÇ Mock Â∞±Â∞ÜËØ•ÂØπË±°‰ª£ÁêÜ‰∫ÜÔºåÂπ∂Âú®ÂÆûÈôÖÊâßË°å set ÊñπÊ≥ïÂêéÁªô‰Ω†ËøîÂõû‰∫Ü‰∏Ä‰∏™‰Ω†Ëá™ÂÆö‰πâÁöÑÂÄº„ÄÇ ËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÈöèÂøÉÊâÄÊ¨≤ÁöÑÊµãËØï‰∫ÜÔºåÂÆåÂÖ®ÊääÂ§ñÈÉ®‰æùËµñÊâÄÂ±èËîΩ‰∫Ü„ÄÇ ÊÄªÁªìËá≥Ê≠§‰∏Ä‰∏™Âü∫‰∫é Redis ÁöÑÂàÜÂ∏ÉÂºèÈîÅÂÆåÊàêÔºå‰ΩÜÊòØ‰æùÁÑ∂Êúâ‰∫õÈóÆÈ¢ò„ÄÇ Â¶ÇÂú® key Ë∂ÖÊó∂‰πãÂêé‰∏öÂä°Âπ∂Ê≤°ÊúâÊâßË°åÂÆåÊØï‰ΩÜÂç¥Ëá™Âä®ÈáäÊîæÈîÅ‰∫ÜÔºåËøôÊ†∑Â∞±‰ºöÂØºËá¥Âπ∂ÂèëÈóÆÈ¢ò„ÄÇ Â∞±ÁÆó Redis ÊòØÈõÜÁæ§ÈÉ®ÁΩ≤ÁöÑÔºåÂ¶ÇÊûúÊØè‰∏™ËäÇÁÇπÈÉΩÂè™ÊòØ master Ê≤°Êúâ slaveÔºåÈÇ£‰πà master ÂÆïÊú∫Êó∂ËØ•ËäÇÁÇπ‰∏äÁöÑÊâÄÊúâ key Âú®ÈÇ£‰∏ÄÊó∂ÂàªÈÉΩÁõ∏ÂΩì‰∫éÊòØÈáäÊîæÈîÅ‰∫ÜÔºåËøôÊ†∑‰πü‰ºöÂá∫Áé∞Âπ∂ÂèëÈóÆÈ¢ò„ÄÇÂ∞±ÁÆóÊòØÊúâ slave ËäÇÁÇπÔºå‰ΩÜÂ¶ÇÊûúÂú®Êï∞ÊçÆÂêåÊ≠•Âà∞ salve ‰πãÂâç master ÂÆïÊú∫‰πüÊòØ‰ºöÂá∫Áé∞‰∏äÈù¢ÁöÑÈóÆÈ¢ò„ÄÇ ÊÑüÂÖ¥Ë∂£ÁöÑÊúãÂèãËøòÂèØ‰ª•ÂèÇËÄÉ Redisson ÁöÑÂÆûÁé∞„ÄÇ]]></content>
      <categories>
        <category>ÁºìÂ≠ò</category>
        <category>redis</category>
      </categories>
      <tags>
        <tag>ÂàÜÂ∏ÉÂºèÈîÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DisruptorÂπ∂ÂèëÊ°ÜÊû∂‰∏äÊâãdemo]]></title>
    <url>%2F2018%2F05%2F15%2FDisruptor%E5%B9%B6%E5%8F%91%E6%A1%86%E6%9E%B6%E4%B8%8A%E6%89%8Bdemo%2F</url>
    <content type="text"><![CDATA[Ê°ÜÊû∂ÁÆÄ‰ªã Martin FowlerÂú®Ëá™Â∑±ÁΩëÁ´ô‰∏äÂÜô‰∫Ü‰∏ÄÁØáLMAXÊû∂ÊûÑÁöÑÊñáÁ´†ÔºåÂú®ÊñáÁ´†‰∏≠‰ªñ‰ªãÁªç‰∫ÜLMAXÊòØ‰∏ÄÁßçÊñ∞ÂûãÈõ∂ÂîÆÈáëËûç‰∫§ÊòìÂπ≥Âè∞ÔºåÂÆÉËÉΩÂ§ü‰ª•Âæà‰ΩéÁöÑÂª∂Ëøü‰∫ßÁîüÂ§ßÈáè‰∫§Êòì„ÄÇËøô‰∏™Á≥ªÁªüÊòØÂª∫Á´ãÂú®JVMÂπ≥Âè∞‰∏äÔºåÂÖ∂Ê†∏ÂøÉÊòØ‰∏Ä‰∏™‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜÂô®ÔºåÂÆÉËÉΩÂ§üÂú®‰∏Ä‰∏™Á∫øÁ®ãÈáåÊØèÁßíÂ§ÑÁêÜ6Áôæ‰∏áËÆ¢Âçï„ÄÇ‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜÂô®ÂÆåÂÖ®ÊòØËøêË°åÂú®ÂÜÖÂ≠ò‰∏≠Ôºå‰ΩøÁî®‰∫ã‰ª∂Ê∫êÈ©±Âä®ÊñπÂºè„ÄÇ‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜÂô®ÁöÑÊ†∏ÂøÉÊòØDisruptor„ÄÇ DisruptorÂÆÉÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÂπ∂ÂèëÊ°ÜÊû∂ÔºåÂπ∂Ëé∑Âæó2011 Duke‚Äôs Á®ãÂ∫èÊ°ÜÊû∂ÂàõÊñ∞Â•ñÔºåËÉΩÂ§üÂú®Êó†ÈîÅÁöÑÊÉÖÂÜµ‰∏ãÂÆûÁé∞ÁΩëÁªúÁöÑQueueÂπ∂ÂèëÊìç‰Ωú„ÄÇ DisruptorÊòØ‰∏Ä‰∏™È´òÊÄßËÉΩÁöÑÂºÇÊ≠•Â§ÑÁêÜÊ°ÜÊû∂ÔºåÊàñËÄÖÂèØ‰ª•ËÆ§‰∏∫ÊòØÊúÄÂø´ÁöÑÊ∂àÊÅØÊ°ÜÊû∂ÔºàËΩªÈáèÁöÑJMSÔºâÔºå‰πüÂèØ‰ª•ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™ËßÇÂØüËÄÖÊ®°ÂºèÁöÑÂÆûÁé∞ÔºåÊàñËÄÖ‰∫ã‰ª∂ÁõëÂê¨Ê®°ÂºèÁöÑÂÆûÁé∞„ÄÇ Âú®‰ΩøÁî®‰πãÂâçÔºåÈ¶ñÂÖàËØ¥Êòédisruptor‰∏ªË¶ÅÂäüËÉΩÂä†‰ª•ËØ¥ÊòéÔºå‰Ω†ÂèØ‰ª•ÁêÜËß£‰∏∫‰ªñÊòØ‰∏ÄÁßçÈ´òÊïàÁöÑ‚ÄùÁîü‰∫ßËÄÖ-Ê∂àË¥πËÄÖ‚ÄùÊ®°Âûã„ÄÇ‰πüÂ∞±ÊÄßËÉΩËøúËøúÈ´ò‰∫é‰º†ÁªüÁöÑBlockingQueueÂÆπÂô®„ÄÇ ‰∏äÊâãdemo È¶ñÂÖàÂ£∞Êòé‰∏Ä‰∏™EventÊù•ÂåÖÂê´ÈúÄË¶Å‰º†ÈÄíÁöÑÊï∞ÊçÆÔºö 12345678910public class LongEvent &#123; private long value; public long getValue() &#123; return value; &#125; public void setValue(long value) &#123; this.value = value; &#125;&#125; ‰∫éÈúÄË¶ÅËÆ©Disruptor‰∏∫Êàë‰ª¨ÂàõÂª∫‰∫ã‰ª∂ÔºåÊàë‰ª¨ÂêåÊó∂ËøòÂ£∞Êòé‰∫Ü‰∏Ä‰∏™EventFactoryÊù•ÂÆû‰æãÂåñEventÂØπË±°„ÄÇ 12345678// ÈúÄË¶ÅËÆ©disruptor‰∏∫Êàë‰ª¨ÂàõÂª∫‰∫ã‰ª∂ÔºåÊàë‰ª¨ÂêåÊó∂ËøòÂ£∞Êòé‰∫Ü‰∏Ä‰∏™EventFactoryÊù•ÂÆû‰æãÂåñEventÂØπË±°„ÄÇpublic class LongEventFactory implements EventFactory &#123; @Override public Object newInstance() &#123; return new LongEvent(); &#125;&#125; Êàë‰ª¨ËøòÈúÄË¶Å‰∏Ä‰∏™‰∫ã‰ª∂Ê∂àË¥πËÄÖÔºå‰πüÂ∞±ÊòØ‰∏Ä‰∏™‰∫ã‰ª∂Â§ÑÁêÜÂô®„ÄÇËøô‰∏™‰∫ã‰ª∂Â§ÑÁêÜÂô®ÁÆÄÂçïÂú∞Êää‰∫ã‰ª∂‰∏≠Â≠òÂÇ®ÁöÑÊï∞ÊçÆÊâìÂç∞Âà∞ÁªàÁ´ØÔºö 12345678public class LongEventHandler implements EventHandler&lt;LongEvent&gt; &#123; @Override public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception &#123; System.out.println(longEvent.getValue()); &#125;&#125; ‰∫ã‰ª∂ÈÉΩ‰ºöÊúâ‰∏Ä‰∏™ÁîüÊàê‰∫ã‰ª∂ÁöÑÊ∫êÔºåËøô‰∏™‰æãÂ≠ê‰∏≠ÂÅáËÆæ‰∫ã‰ª∂ÊòØÁî±‰∫éÁ£ÅÁõòIOÊàñËÄÖnetworkËØªÂèñÊï∞ÊçÆÁöÑÊó∂ÂÄôËß¶ÂèëÁöÑÔºå‰∫ã‰ª∂Ê∫ê‰ΩøÁî®‰∏Ä‰∏™ByteBufferÊù•Ê®°ÊãüÂÆÉÊé•ÂèóÂà∞ÁöÑÊï∞ÊçÆÔºå‰πüÂ∞±ÊòØËØ¥Ôºå‰∫ã‰ª∂Ê∫ê‰ºöÂú®IOËØªÂèñÂà∞‰∏ÄÈÉ®ÂàÜÊï∞ÊçÆÁöÑÊó∂ÂÄôËß¶Âèë‰∫ã‰ª∂ÔºàËß¶Âèë‰∫ã‰ª∂‰∏çÊòØËá™Âä®ÁöÑÔºåÁ®ãÂ∫èÂëòÈúÄË¶ÅÂú®ËØªÂèñÂà∞Êï∞ÊçÆÁöÑÊó∂ÂÄôËá™Â∑±Ëß¶Âèë‰∫ã‰ª∂Âπ∂ÂèëÂ∏ÉÔºâ 1234567891011121314151617181920212223242526272829public class LongEventProducer &#123; private final RingBuffer&lt;LongEvent&gt; ringBuffer; public LongEventProducer(RingBuffer&lt;LongEvent&gt; ringBuffer)&#123; this.ringBuffer = ringBuffer; &#125; /** * onDataÁî®Êù•ÂèëÂ∏É‰∫ã‰ª∂ÔºåÊØèË∞ÉÁî®‰∏ÄÊ¨°Â∞±ÂèëÂ∏É‰∏ÄÊ¨°‰∫ã‰ª∂ * ÂÆÉÁöÑÂèÇÊï∞‰ºöÁî®Ëøá‰∫ã‰ª∂‰º†ÈÄíÁªôÊ∂àË¥πËÄÖ */ public void onData(ByteBuffer bb)&#123; //1.ÂèØ‰ª•ÊääringBufferÁúãÂÅö‰∏Ä‰∏™‰∫ã‰ª∂ÈòüÂàóÔºåÈÇ£‰πànextÂ∞±ÊòØÂæóÂà∞‰∏ãÈù¢‰∏Ä‰∏™‰∫ã‰ª∂ÊßΩ long sequence = ringBuffer.next(); try &#123; //2.Áî®‰∏äÈù¢ÁöÑÁ¥¢ÂºïÂèñÂá∫‰∏Ä‰∏™Á©∫ÁöÑ‰∫ã‰ª∂Áî®‰∫éÂ°´ÂÖÖÔºàËé∑ÂèñËØ•Â∫èÂè∑ÂØπÂ∫îÁöÑ‰∫ã‰ª∂ÂØπË±°Ôºâ LongEvent event = ringBuffer.get(sequence); //3.Ëé∑ÂèñË¶ÅÈÄöËøá‰∫ã‰ª∂‰º†ÈÄíÁöÑ‰∏öÂä°Êï∞ÊçÆ event.setValue(bb.getLong(0)); &#125; finally &#123; //4.ÂèëÂ∏É‰∫ã‰ª∂ //Ê≥®ÊÑèÔºåÊúÄÂêéÁöÑ ringBuffer.publish ÊñπÊ≥ïÂøÖÈ°ªÂåÖÂê´Âú® finally ‰∏≠‰ª•Á°Æ‰øùÂøÖÈ°ªÂæóÂà∞Ë∞ÉÁî®Ôºõ // Â¶ÇÊûúÊüê‰∏™ËØ∑Ê±ÇÁöÑ sequence Êú™Ë¢´Êèê‰∫§ÔºåÂ∞Ü‰ºöÂ†µÂ°ûÂêéÁª≠ÁöÑÂèëÂ∏ÉÊìç‰ΩúÊàñËÄÖÂÖ∂ÂÆÉÁöÑ producer„ÄÇ ringBuffer.publish(sequence); &#125; &#125;&#125; mainÂáΩÊï∞ÊâßË°åË∞ÉÁî® 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public class LongEventMain &#123; public static void main(String[] args) throws Exception &#123; //ÂàõÂª∫ÁºìÂÜ≤Ê±† ExecutorService executor = Executors.newCachedThreadPool(); //ÂàõÂª∫Â∑•ÂéÇ LongEventFactory factory = new LongEventFactory(); //ÂàõÂª∫bufferSize ,‰πüÂ∞±ÊòØRingBufferÂ§ßÂ∞èÔºåÂøÖÈ°ªÊòØ2ÁöÑNÊ¨°Êñπ int ringBufferSize = 1024 * 1024; // /** //BlockingWaitStrategy ÊòØÊúÄ‰ΩéÊïàÁöÑÁ≠ñÁï•Ôºå‰ΩÜÂÖ∂ÂØπCPUÁöÑÊ∂àËÄóÊúÄÂ∞èÂπ∂‰∏îÂú®ÂêÑÁßç‰∏çÂêåÈÉ®ÁΩ≤ÁéØÂ¢É‰∏≠ËÉΩÊèê‰æõÊõ¥Âä†‰∏ÄËá¥ÁöÑÊÄßËÉΩË°®Áé∞ WaitStrategy BLOCKING_WAIT = new BlockingWaitStrategy(); //SleepingWaitStrategy ÁöÑÊÄßËÉΩË°®Áé∞Ë∑üBlockingWaitStrategyÂ∑Æ‰∏çÂ§öÔºåÂØπCPUÁöÑÊ∂àËÄó‰πüÁ±ª‰ººÔºå‰ΩÜÂÖ∂ÂØπÁîü‰∫ßËÄÖÁ∫øÁ®ãÁöÑÂΩ±ÂìçÊúÄÂ∞èÔºåÈÄÇÂêàÁî®‰∫éÂºÇÊ≠•Êó•ÂøóÁ±ª‰ººÁöÑÂú∫ÊôØ WaitStrategy SLEEPING_WAIT = new SleepingWaitStrategy(); //YieldingWaitStrategy ÁöÑÊÄßËÉΩÊòØÊúÄÂ•ΩÁöÑÔºåÈÄÇÂêàÁî®‰∫é‰ΩéÂª∂ËøüÁöÑÁ≥ªÁªü„ÄÇÂú®Ë¶ÅÊ±ÇÊûÅÈ´òÊÄßËÉΩ‰∏î‰∫ã‰ª∂Â§ÑÁêÜÁ∫øÊï∞Â∞è‰∫éCPUÈÄªËæëÊ†∏ÂøÉÊï∞ÁöÑÂú∫ÊôØ‰∏≠ÔºåÊé®Ëçê‰ΩøÁî®Ê≠§Á≠ñÁï•Ôºõ‰æãÂ¶ÇÔºåCPUÂºÄÂêØË∂ÖÁ∫øÁ®ãÁöÑÁâπÊÄß WaitStrategy YIELDING_WAIT = new YieldingWaitStrategy(); */ /** * ÂèÇÊï∞ËØ¥ÊòéÔºö */ //ÂàõÂª∫disruptor Disruptor&lt;LongEvent&gt; disruptor = new Disruptor&lt;LongEvent&gt;(factory, ringBufferSize, executor, ProducerType.SINGLE, new YieldingWaitStrategy()); // ËøûÊé•Ê∂àË¥π‰∫ã‰ª∂ÊñπÊ≥ï disruptor.handleEventsWith(new LongEventHandler()); // ÂêØÂä® disruptor.start(); //Disruptor ÁöÑ‰∫ã‰ª∂ÂèëÂ∏ÉËøáÁ®ãÊòØ‰∏Ä‰∏™‰∏§Èò∂ÊÆµÊèê‰∫§ÁöÑËøáÁ®ãÔºö //ÂèëÂ∏É‰∫ã‰ª∂ RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.getRingBuffer(); LongEventProducer producer = new LongEventProducer(ringBuffer); //LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer); ByteBuffer byteBuffer = ByteBuffer.allocate(8); for(long l = 0; l&lt;100; l++)&#123; byteBuffer.putLong(0, l); producer.onData(byteBuffer); //Thread.sleep(1000); &#125; disruptor.shutdown();//ÂÖ≥Èó≠ disruptorÔºåÊñπÊ≥ï‰ºöÂ†µÂ°ûÔºåÁõ¥Ëá≥ÊâÄÊúâÁöÑ‰∫ã‰ª∂ÈÉΩÂæóÂà∞Â§ÑÁêÜÔºõ executor.shutdown();//ÂÖ≥Èó≠ disruptor ‰ΩøÁî®ÁöÑÁ∫øÁ®ãÊ±†ÔºõÂ¶ÇÊûúÈúÄË¶ÅÁöÑËØùÔºåÂøÖÈ°ªÊâãÂä®ÂÖ≥Èó≠Ôºå disruptor Âú® shutdown Êó∂‰∏ç‰ºöËá™Âä®ÂÖ≥Èó≠Ôºõ &#125;&#125;]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>javaÂπ∂ÂèëÂåÖ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[StreamÂàÜÁªÑÂíåÂàÜÂå∫]]></title>
    <url>%2F2018%2F05%2F14%2FStream%E5%88%86%E7%BB%84%E5%92%8C%E5%88%86%E5%8C%BA%2F</url>
    <content type="text"><![CDATA[ËøôÁØáÊñáÁ´†Â±ïÁ§∫‰∫ÜÂ¶Ç‰Ωï‰ΩøÁî® Streams API ‰∏≠ÁöÑ Collector Âèä groupingBy Âíå partitioningBy Êù•ÂØπÊµÅ‰∏≠ÁöÑÂÖÉÁ¥†ËøõË°åÂàÜÁªÑÂíåÂàÜÂå∫„ÄÇ ÊÄùËÄÉ‰∏Ä‰∏ã Employee ÂØπË±°ÊµÅÔºåÊØè‰∏™ÂØπË±°ÂØπÂ∫î‰∏Ä‰∏™ÂêçÂ≠ó„ÄÅÂüéÂ∏ÇÂíåÈîÄÂîÆÊï∞ÈáèÔºåÂ¶Ç‰∏ãË°®ÊâÄÁ§∫Ôºö 12345678+----------+------------+-----------------+| Name | City | Number of Sales |+----------+------------+-----------------+| Alice | London | 200 || Bob | London | 150 || Charles | New York | 160 || Dorothy | Hong Kong | 190 |+----------+------------+-----------------+ ÂàÜÁªÑÈ¶ñÂÖàÔºåÊàë‰ª¨Âà©Áî®ÔºàlambdaË°®ËææÂºèÂá∫Áé∞‰πãÂâçÁöÑÔºâÂëΩ‰ª§ÂºèÈ£éÊ†ºJava Á®ãÂ∫èÂØπÊµÅ‰∏≠ÁöÑÈõáÂëòÊåâÂüéÂ∏ÇËøõË°åÂàÜÁªÑÔºö 12345678910Map&lt;String, List&lt;Employee&gt;&gt; result = new HashMap&lt;&gt;();for (Employee e : employees) &#123; String city = e.getCity(); List&lt;Employee&gt; empsInCity = result.get(city); if (empsInCity == null) &#123; empsInCity = new ArrayList&lt;&gt;(); result.put(city, empsInCity); &#125; empsInCity.add(e);&#125; ‰Ω†ÂèØËÉΩÂæàÁÜüÊÇâÂÜôËøôÊ†∑ÁöÑ‰ª£Á†ÅÔºå‰Ω†‰πüÁúãÂà∞‰∫ÜÔºå‰∏Ä‰∏™Â¶ÇÊ≠§ÁÆÄÂçïÁöÑ‰ªªÂä°Â∞±ÈúÄË¶ÅËøô‰πàÂ§ö‰ª£Á†ÅÔºÅ ËÄåÂú® Java 8 ‰∏≠Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî® groupingBy Êî∂ÈõÜÂô®Ôºå‰∏ÄÊù°ËØ≠Âè•Â∞±ËÉΩÂÆåÊàêÁõ∏ÂêåÁöÑÂäüËÉΩÔºåÂÉèËøôÊ†∑Ôºö 12Map&lt;String, List&lt;Employee&gt;&gt; employeesByCity = employees.stream().collect(groupingBy(Employee::getCity)); ÁªìÊûúÂ¶Ç‰∏ãÈù¢ÁöÑ map ÊâÄÁ§∫Ôºö 1&#123;New York=[Charles], Hong Kong=[Dorothy], London=[Alice, Bob]&#125; ËøòÂèØ‰ª•ËÆ°ÁÆóÊØè‰∏™ÂüéÂ∏Ç‰∏≠ÈõáÂëòÁöÑÊï∞ÈáèÔºåÂè™ÈúÄ‰º†ÈÄí‰∏Ä‰∏™ËÆ°Êï∞Êî∂ÈõÜÂô®Áªô groupingBy Êî∂ÈõÜÂô®„ÄÇÁ¨¨‰∫å‰∏™Êî∂ÈõÜÂô®ÁöÑ‰ΩúÁî®ÊòØÂú®ÊµÅÂàÜÁ±ªÁöÑÂêå‰∏Ä‰∏™ÁªÑ‰∏≠ÂØπÊØè‰∏™ÂÖÉÁ¥†ËøõË°åÈÄíÂΩíÊìç‰Ωú„ÄÇ 12Map&lt;String, Long&gt; numEmployeesByCity = employees.stream().collect(groupingBy(Employee::getCity, counting())); ÁªìÊûúÂ¶Ç‰∏ãÈù¢ÁöÑ map ÊâÄÁ§∫Ôºö 1&#123;New York=1, Hong Kong=1, London=2&#125; È°∫‰æøÊèê‰∏Ä‰∏ãÔºåËØ•ÂäüËÉΩ‰∏é‰∏ãÈù¢ÁöÑ SQL ËØ≠Âè•ÊòØÁ≠âÂêåÁöÑÔºö 1select city, count(*) from Employee group by city Âè¶‰∏Ä‰∏™‰æãÂ≠êÊòØËÆ°ÁÆóÊØè‰∏™ÂüéÂ∏ÇÁöÑÂπ≥ÂùáÂπ¥ÈæÑÔºåËøôÂèØ‰ª•ËÅîÂêà‰ΩøÁî® averagingInt Âíå groupingBy Êî∂ÈõÜÂô®Ôºö 123Map&lt;String, Double&gt; avgSalesByCity = employees.stream().collect(groupingBy(Employee::getCity, averagingInt(Employee::getNumSales))); ÁªìÊûúÂ¶Ç‰∏ã map ÊâÄÁ§∫Ôºö 1&#123;New York=160.0, Hong Kong=190.0, London=175.0&#125; ÂàÜÂå∫ÂàÜÂå∫ÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÂàÜÁªÑÔºåÁªìÊûú map Ëá≥Â∞ëÂåÖÂê´‰∏§‰∏™‰∏çÂêåÁöÑÂàÜÁªÑ‚Äî‚Äî‰∏Ä‰∏™trueÔºå‰∏Ä‰∏™false„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûúÊÉ≥ÊâæÂá∫ÊúÄ‰ºòÁßÄÁöÑÂëòÂ∑•Ôºå‰Ω†ÂèØ‰ª•Â∞ÜÊâÄÊúâÈõáÂëòÂàÜ‰∏∫‰∏§ÁªÑÔºå‰∏ÄÁªÑÈîÄÂîÆÈáèÂ§ß‰∫é NÔºåÂè¶‰∏ÄÁªÑÂ∞è‰∫é NÔºå‰ΩøÁî® partitioningBy Êî∂ÈõÜÂô®Ôºö 12Map&lt;Boolean, List&lt;Employee&gt;&gt; partitioned = employees.stream().collect(partitioningBy(e -&gt; e.getNumSales() &gt; 150)); ËæìÂá∫Â¶Ç‰∏ãÁªìÊûúÔºö 1&#123;false=[Bob], true=[Alice, Charles, Dorothy]&#125; ‰Ω†‰πüÂèØ‰ª•Â∞Ü groupingBy Êî∂ÈõÜÂô®‰º†ÈÄíÁªô partitioningBy Êî∂ÈõÜÂô®Êù•Â∞ÜËÅîÂêà‰ΩøÁî®ÂàÜÂå∫ÂíåÂàÜÁªÑ„ÄÇ‰æãÂ¶ÇÔºå‰Ω†ÂèØ‰ª•ÁªüËÆ°ÊØè‰∏™ÂàÜÂå∫‰∏≠ÁöÑÊØè‰∏™ÂüéÂ∏ÇÁöÑÈõáÂëò‰∫∫Êï∞Ôºö ËøôÊ†∑‰ºöÁîüÊàê‰∏Ä‰∏™‰∫åÁ∫ß Map: 123Map&lt;Boolean, Map&lt;String, Long&gt;&gt; result = employees.stream().collect(partitioningBy(e -&gt; e.getNumSales() &gt; 150, groupingBy(Employee::getCity, counting())));]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[javaÊ≠ªÈîÅÈáçÁé∞‰∏éÊéíÊü•]]></title>
    <url>%2F2018%2F05%2F14%2Fjava%E6%AD%BB%E9%94%81%E9%87%8D%E7%8E%B0%E4%B8%8E%E6%8E%92%E6%9F%A5%2F</url>
    <content type="text"><![CDATA[1.ÊûÑÈÄ†Ê≠ªÈîÅÈÄöËøáÊ®°Êãü‰∏§‰∏™Âì≤Â≠¶ÂêÉÈ•≠ÔºåÈúÄË¶Å‰∏§ÊääÂèâÂ≠ê„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * Created by xiaowu.zhou@tongdun.cn on 2018/5/14. */public class DeadLock extends Thread&#123; //Âì≤Â≠¶ÂÆ∂ÂêÉÈ•≠ÈúÄË¶ÅÁöÑÂàÄÂèâ static Object fork1 = new Object(); static Object fork2 = new Object(); private Object tool; public DeadLock(Object object) &#123; this.tool = object; if (tool == fork1)&#123; this.setName("Âì≤Â≠¶ÂÆ∂1"); &#125;else if (tool == fork2)&#123; this.setName("Âì≤Â≠¶ÂÆ∂2"); &#125; &#125; @Override public void run() &#123; if (tool == fork1)&#123; synchronized (fork1)&#123; try &#123; System.out.println("Âì≤Â≠¶ÂÆ∂1ÂºÄÂßãÂáÜÂ§áÔºåÊúâ‰∫Ü‰∏ÄÊääÂèâÂ≠ê1"); Thread.sleep(500); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; synchronized (fork2)&#123; System.out.println("Âì≤Â≠¶ÂÆ∂1ÂºÄÂßãÂêÉÈ•≠ÔºåÊúâ‰∫Ü‰∏§ÊääÂèâÂ≠ê"); &#125; &#125; &#125; if(tool == fork2)&#123; synchronized (fork2)&#123; try &#123; System.out.println("Âì≤Â≠¶ÂÆ∂2ÂºÄÂßãÂáÜÂ§áÔºåÊúâ‰∫Ü‰∏ÄÊääÂèâÂ≠ê2"); Thread.sleep(1500); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; synchronized (fork1)&#123; System.out.println("Âì≤Â≠¶ÂÆ∂2ÂºÄÂßãÂêÉÈ•≠ÔºåÊúâ‰∫Ü‰∏§ÊääÂèâÂ≠ê"); &#125; &#125; &#125; &#125; public static void main(String[] args) throws InterruptedException &#123; DeadLock deadLock1 = new DeadLock(fork1); DeadLock deadLock2 = new DeadLock(fork2); deadLock1.start(); deadLock2.start(); while (true)&#123; &#125; &#125;&#125; 2. ÊéíÊü•ÈóÆÈ¢òÊ≠ªÈîÅÁöÑÁ∫øÁ®ã‰∏çÂç†Áî®cpuÔºåÈÄöËøájstackÂèØ‰ª•ÊéíÊü• 1jstack 59356 &gt; dead_lock_stack.log ÊêúÁ¥¢deadlock 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071082018-05-14 09:08:13Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.144-b01 mixed mode):"Attach Listener" #12 daemon prio=9 os_prio=31 tid=0x00007fb3818c8000 nid=0x1407 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"Âì≤Â≠¶ÂÆ∂2" #11 prio=5 os_prio=31 tid=0x00007fb38185a000 nid=0x5103 waiting for monitor entry [0x000070000d069000] java.lang.Thread.State: BLOCKED (on object monitor) at DeadLock.run(DeadLock.java:59) - waiting to lock &lt;0x0000000795782620&gt; (a java.lang.Object) - locked &lt;0x0000000795782630&gt; (a java.lang.Object)"Âì≤Â≠¶ÂÆ∂1" #10 prio=5 os_prio=31 tid=0x00007fb382042800 nid=0x4f03 waiting for monitor entry [0x000070000cf66000] java.lang.Thread.State: BLOCKED (on object monitor) at DeadLock.run(DeadLock.java:41) - waiting to lock &lt;0x0000000795782630&gt; (a java.lang.Object) - locked &lt;0x0000000795782620&gt; (a java.lang.Object)"Service Thread" #9 daemon prio=9 os_prio=31 tid=0x00007fb38206c800 nid=0x4b03 runnable [0x0000000000000000] java.lang.Thread.State: RUNNABLE"C1 CompilerThread2" #8 daemon prio=9 os_prio=31 tid=0x00007fb38185f000 nid=0x4903 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"C2 CompilerThread1" #7 daemon prio=9 os_prio=31 tid=0x00007fb382815800 nid=0x4703 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"C2 CompilerThread0" #6 daemon prio=9 os_prio=31 tid=0x00007fb381859000 nid=0x4503 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"Monitor Ctrl-Break" #5 daemon prio=5 os_prio=31 tid=0x00007fb3830b9000 nid=0x4303 runnable [0x000070000c954000] java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284) at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326) at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178) - locked &lt;0x0000000795708738&gt; (a java.io.InputStreamReader) at java.io.InputStreamReader.read(InputStreamReader.java:184) at java.io.BufferedReader.fill(BufferedReader.java:161) at java.io.BufferedReader.readLine(BufferedReader.java:324) - locked &lt;0x0000000795708738&gt; (a java.io.InputStreamReader) at java.io.BufferedReader.readLine(BufferedReader.java:389) at com.intellij.rt.execution.application.AppMainV2$1.run(AppMainV2.java:64)"Signal Dispatcher" #4 daemon prio=9 os_prio=31 tid=0x00007fb382030800 nid=0x4103 runnable [0x0000000000000000] java.lang.Thread.State: RUNNABLE"Finalizer" #3 daemon prio=8 os_prio=31 tid=0x00007fb38202b000 nid=0x3103 in Object.wait() [0x000070000c74e000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x0000000795588ec8&gt; (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143) - locked &lt;0x0000000795588ec8&gt; (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164) at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)"Reference Handler" #2 daemon prio=10 os_prio=31 tid=0x00007fb382805000 nid=0x2f03 in Object.wait() [0x000070000c64b000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on &lt;0x0000000795586b68&gt; (a java.lang.ref.Reference$Lock) at java.lang.Object.wait(Object.java:502) at java.lang.ref.Reference.tryHandlePending(Reference.java:191) - locked &lt;0x0000000795586b68&gt; (a java.lang.ref.Reference$Lock) at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)"main" #1 prio=5 os_prio=31 tid=0x00007fb382005800 nid=0x1c03 runnable [0x000070000c039000] java.lang.Thread.State: RUNNABLE at DeadLock.main(DeadLock.java:81)"VM Thread" os_prio=31 tid=0x00007fb382802800 nid=0x2d03 runnable"GC task thread#0 (ParallelGC)" os_prio=31 tid=0x00007fb38200e800 nid=0x2503 runnable"GC task thread#1 (ParallelGC)" os_prio=31 tid=0x00007fb38200f800 nid=0x2703 runnable"GC task thread#2 (ParallelGC)" os_prio=31 tid=0x00007fb382010000 nid=0x2903 runnable"GC task thread#3 (ParallelGC)" os_prio=31 tid=0x00007fb382010800 nid=0x2b03 runnable"VM Periodic Task Thread" os_prio=31 tid=0x00007fb382085800 nid=0x4d03 waiting on conditionJNI global references: 22Found one Java-level deadlock:============================="Âì≤Â≠¶ÂÆ∂2": waiting to lock monitor 0x00007fb38202a5f8 (object 0x0000000795782620, a java.lang.Object), which is held by "Âì≤Â≠¶ÂÆ∂1""Âì≤Â≠¶ÂÆ∂1": waiting to lock monitor 0x00007fb3818ca808 (object 0x0000000795782630, a java.lang.Object), which is held by "Âì≤Â≠¶ÂÆ∂2"Java stack information for the threads listed above:==================================================="Âì≤Â≠¶ÂÆ∂2": at DeadLock.run(DeadLock.java:59) - waiting to lock &lt;0x0000000795782620&gt; (a java.lang.Object) - locked &lt;0x0000000795782630&gt; (a java.lang.Object)"Âì≤Â≠¶ÂÆ∂1": at DeadLock.run(DeadLock.java:41) - waiting to lock &lt;0x0000000795782630&gt; (a java.lang.Object) - locked &lt;0x0000000795782620&gt; (a java.lang.Object)Found 1 deadlock. ÂèëÁé∞Âì≤Â≠¶ÂÆ∂1ÔºåÊåÅÊúâÈîÅ0x0000000795782620,Á≠âÂæÖÈîÅ0x0000000795782630 Ôºõ ËÄåÂì≤Â≠¶ÂÆ∂2ÔºåÂàôÁõ∏Âèç„ÄÇ]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[MAT‰ΩøÁî®ÊïôÁ®ã]]></title>
    <url>%2F2018%2F05%2F13%2FMAT%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[MAT ÂÖ®Áß∞ Eclipse Memory Analysis Tools ÊòØ‰∏Ä‰∏™ÂàÜÊûê JavaÂ†ÜÊï∞ÊçÆÁöÑ‰∏ì‰∏öÂ∑•ÂÖ∑ÔºåÂèØ‰ª•ËÆ°ÁÆóÂá∫ÂÜÖÂ≠ò‰∏≠ÂØπË±°ÁöÑÂÆû‰æãÊï∞Èáè„ÄÅÂç†Áî®Á©∫Èó¥Â§ßÂ∞è„ÄÅÂºïÁî®ÂÖ≥Á≥ªÁ≠âÔºåÁúãÁúãÊòØË∞ÅÈòªÊ≠¢‰∫ÜÂûÉÂúæÊî∂ÈõÜÂô®ÁöÑÂõûÊî∂Â∑•‰ΩúÔºå‰ªéËÄåÂÆö‰ΩçÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÂéüÂõ†„ÄÇ ‰ªÄ‰πàÊó∂ÂÄô‰ºöÁî®Âà∞MAT? aÔºâ OutOfMemoryErrorÁöÑÊó∂ÂÄôÔºåËß¶Âèëfull gcÔºå‰ΩÜÁ©∫Èó¥Âç¥ÂõûÊî∂‰∏ç‰∫ÜÔºåÂºïÂèëÂÜÖÂ≠òÊ≥ÑÈú≤ bÔºâjavaÊúçÂä°Âô®Á≥ªÁªüÂºÇÂ∏∏ÔºåÊØîÂ¶ÇloadÈ£ôÈ´òÔºåioÂºÇÂ∏∏ÔºåÊàñËÄÖÁ∫øÁ®ãÊ≠ªÈîÅÁ≠âÔºåÈÉΩÂèØËÉΩÈÄöËøáÂàÜÊûêÂ†Ü‰∏≠ÁöÑÂÜÖÂ≠òÂØπË±°Êù•ÂÆö‰ΩçÂéüÂõ† Â¶Ç‰ΩïÂÆâË£ÖÔºö eclipseÊèí‰ª∂ÂÆâË£ÖÔºåÂú∞ÂùÄÔºöhttp://download.eclipse.org/mat/1.0/update-site/ ÂàÜÊûêÊñá‰ª∂ÁîüÊàêÊñπÂºèÔºö aÔºâËá™Âä®ÁîüÊàêÔºåjvmÂêØÂä®ÂèÇÊï∞ÈáåÊ∑ªÂä†‰∏ãÈù¢ÈÖçÁΩÆÔºåÂΩìÂèëÁîüOutOfMemoryErrorÊó∂ÔºåËôöÊãüÊú∫‰ºöËá™Âä®dumpÂÜÖÂ≠òÂø´ÁÖß [html] view plain copy -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=$LOG_DIR/java.hprof‚Äù bÔºâÊâãÂä®ÁîüÊàêÔºåÈÄöËøáÊâßË°åjdkËá™Â∏¶ÂëΩ‰ª§ jmap -dump:format=b,file=heap.bin Êé•‰∏ãÂ∞±ÂèØ‰ª•Áî® MATÊâìÂºÄËΩ¨Êç¢ÂêéÁöÑ hprofÊñá‰ª∂ ÊâìÂºÄÂêéÁöÑÈ¶ñÈ°µÔºåÈáåÈù¢ÊòØ‰∏Ä‰∫õÂ†ÜÁöÑÂü∫Êú¨Ê¶ÇË¶Å‰ø°ÊÅØÔºåÊØîÂ¶ÇÁ©∫Èó¥Â§ßÂ∞è„ÄÅÁ±ªÁöÑÊï∞Èáè„ÄÅÂØπË±°ÂÆû‰æãÊï∞Èáè„ÄÅÁ±ªÂä†ËΩΩÂô®Á≠âÁ≠â AtcionÈáåÈù¢Êèê‰æõ‰∫ÜÂ§öÁßçÂàÜÊûêÁª¥Â∫¶Ôºö HistogramÂèØ‰ª•ÂàóÂá∫ÂÜÖÂ≠ò‰∏≠ÁöÑÂØπË±°ÔºåÂØπË±°ÁöÑ‰∏™Êï∞‰ª•ÂèäÂ§ßÂ∞è„ÄÇ Dominator TreeÂèØ‰ª•ÂàóÂá∫ÈÇ£‰∏™Á∫øÁ®ãÔºå‰ª•ÂèäÁ∫øÁ®ã‰∏ãÈù¢ÁöÑÈÇ£‰∫õÂØπË±°Âç†Áî®ÁöÑÁ©∫Èó¥„ÄÇ Top consumersÈÄöËøáÂõæÂΩ¢ÂàóÂá∫ÊúÄÂ§ßÁöÑobject„ÄÇ Leak SuspectsÈÄöËøáMAËá™Âä®ÂàÜÊûêÊ≥ÑÊºèÁöÑÂéüÂõ†„ÄÇ Histogram ÂÆÉÊåâÁ±ªÂêçÂ∞ÜÊâÄÊúâÁöÑÂÆû‰æãÂØπË±°ÂàóÂá∫Êù•ÔºåÁÇπÂáªË°®Â§¥ÔºàClass NameÔºâÂèØ‰ª•ÊéíÂ∫èÔºåÁ¨¨‰∏ÄË°åËæìÂÖ•Ê≠£ÂàôË°®ËææÂºèÂèØ‰ª•ËøáÊª§Á≠õÈÄâ Ôºõ Shallow Heap Ôºö‰∏Ä‰∏™ÂØπË±°ÂÜÖÂ≠òÁöÑÊ∂àËÄóÂ§ßÂ∞èÔºå‰∏çÂåÖÂê´ÂØπÂÖ∂‰ªñÂØπË±°ÁöÑÂºïÁî®ÔºõRetained Heap ÔºöÊòØshallow HeapÁöÑÊÄªÂíåÔºå‰πüÂ∞±ÊòØËØ•ÂØπË±°Ë¢´GC‰πãÂêéÊâÄËÉΩÂõûÊî∂ÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºõ ËØ¶ÁªÜËß£ÈáäÂèØÂèÇËÄÉÊñáÁ´†ÔºöShallow heap &amp; Retained heap Âú®Êüê‰∏ÄÈ°π‰∏äÂè≥ÈîÆÊâìÂºÄËèúÂçïÈÄâÊã© list objects Ôºö with incoming references Â∞ÜÂàóÂá∫Âì™‰∫õÁ±ªÂºïÂÖ•ËØ•Á±ªÔºõ with outgoing references ÂàóÂá∫ËØ•Á±ªÂºïÁî®‰∫ÜÂì™‰∫õÁ±ª ‰ªéÂ∑•ÂÖ∑Ê†è‰∏≠ÁÇπÂºÄ Heap Dump OverviewËßÜÂõæÔºåÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÂÜÖÂ≠òÂç†Áî®‰ø°ÊÅØ Dominator Tree ÂèØ‰ª•ÂàóÂá∫ÂÜÖÂ≠ò‰∏≠Â≠òÊ¥ªÁöÑÂ§ßÂØπË±°ÂàóË°®Ôºå‰ºòÁÇπÊòØÊúâPercentageÂ≠óÊÆµÔºåÂèØ‰ª•ÁúãÂêÑÁßçÊÉÖÂÜµÁöÑÁôæÂàÜÊØî„ÄÇ ÂàÜÁªÑÂ∑•ÂÖ∑ÂèØ‰ª•Ê†πÊçÆËá™Â∑±ÁöÑÈúÄÊ±ÇÂàÜÁªÑÊü•ÊâæÔºåÈªòËÆ§Ê†πÊçÆclassÂàÜÁªÑÔºåÊú¨Êñá‰∏≠ÊòØÊ†πÊçÆ packageÂàÜÁªÑÔºåÂèëÁé∞Â≠òÂú®Â§ßÈáèÁöÑSSLSocketImplÁ±ªÊó†Ê≥ïÂõûÊî∂ÔºåËøôÊ†∑‰ºöÂØºËá¥ÊâÄÊúâÁõ¥Êé•ÊàñÈó¥Êé•ÂºïÁî®Âà∞SSLSocketImplÁöÑÁ±ªÈÉΩÊó†Ê≥ïÂõûÊî∂ÔºåÂõæ‰∏≠ÂèØ‰ª•ÁúãÂá∫ËôΩÁÑ∂Shallow HeapÂ§ßÂ∞èÂè™Êúâ1.6MÔºå‰ΩÜRetained HeapÂ§ßÂ∞èÂç¥Êúâ378M„ÄÇ Âø´ÈÄüÊâæÂá∫Êüê‰∏™ÂÆû‰æãÊ≤°Ë¢´ÈáäÊîæÁöÑÂéüÂõ†ÔºåÂèØ‰ª•Âè≥ÂÅ• Path to GC Roots‚Äì&gt;exclude all phantom/weak/soft etc. references ÂÆÉÂ±ïÁ§∫‰∫ÜÂØπË±°Èó¥ÁöÑÂºïÁî®ÂÖ≥Á≥ªÔºåÊØîÂ¶ÇSSLSocketImpl @0xa124b208Ë¢´PushNotificationManager ÂÆû‰æã‰∏≠ÁöÑsocketÂ±ûÊÄßÊâÄÂºïÁî®„ÄÇ Top consumers Â§öÁßçÁª¥Â∫¶ÔºàÂåÖÊã¨ Á±ªÂ§ßÂ∞è„ÄÅÁ±ªÂä†ËΩΩÂô®„ÄÅÂåÖÂêçÔºâÂ±ïÁ§∫Âç†Áî®ÂÜÖÂ≠òÊØîËæÉÂ§öÁöÑÂØπË±°ÁöÑÂàÜÂ∏ÉÔºå‰ªéËÄåÂÆö‰ΩçÂÜÖÂ≠òËµÑÊ∫ê‰∏ªË¶ÅËÄóË¥πÂú®Âì™‰∫õÂú∞ÊñπÔºÅ Leak Suspects MATÊèí‰ª∂‰ºöÁªôÂá∫‰∏Ä‰ªΩÂèØÁñëÁöÑÂàÜÊûêÊä•ÂëäÔºåÈùûÂ∏∏Êñπ‰æøÔºåÊàë‰ª¨Âè™ÈúÄÁªìÂêàÊ∫ê‰ª£Á†ÅÁ®çÂä†ÂàÜÊûêÂà∞Â∫ïÂì™‰∏™ProblemÊâçÊòØÂºïÂèëÈóÆÈ¢òÁúüÊ≠£ÂéüÂõ†ÊâÄÂú®„ÄÇ ÂèÇËÄÉËµÑÊñôÔºö http://www.eclipse.org/mat/about/screenshots.php https://www.yourkit.com/docs/java/help/garbage_collection.jsp http://www.ibm.com/developerworks/cn/opensource/os-cn-ecl-ma/index.html http://help.eclipse.org/luna/index.jsp?topic=/org.eclipse.mat.ui.help/welcome.html]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JDKÂÜÖÁΩÆÂ∑•ÂÖ∑]]></title>
    <url>%2F2018%2F05%2F13%2FJDK%E5%86%85%E7%BD%AE%E5%B7%A5%E5%85%B7%2F</url>
    <content type="text"><![CDATA[1. jps -mlÁî®‰∫éÊü•ÁúãJVMÈáåÈù¢ÊâÄÊúâËøõÁ®ãÁöÑÂÖ∑‰ΩìÁä∂ÊÄÅÔºåÂåÖÊã¨ËøõÁ®ãIDÔºåËøõÁ®ãÂêØÂä®ÁöÑË∑ØÂæÑÁ≠âÁ≠â ÂèÇÊï∞Ê†ºÂºèÔºö -m ËæìÂá∫‰º†ÈÄíÁªômainÊñπÊ≥ïÁöÑÂèÇÊï∞ÔºåÂ¶ÇÊûúÊòØÂÜÖÂµåÁöÑJVMÂàôËæìÂá∫‰∏∫null„ÄÇ -l ËæìÂá∫Â∫îÁî®Á®ãÂ∫è‰∏ªÁ±ªÁöÑÂÆåÊï¥ÂåÖÂêçÔºåÊàñËÄÖÊòØÂ∫îÁî®Á®ãÂ∫èJARÊñá‰ª∂ÁöÑÂÆåÊï¥Ë∑ØÂæÑ„ÄÇÔºàÈùûÂ∏∏ÈÄÇÁî®‰∫étask‰ªªÂä°Ôºâ -v ËæìÂá∫‰º†ÁªôJVMÁöÑÂèÇÊï∞„ÄÇ ‚Äã 2. jstat -gcutil pid Êó∂Èó¥Èó¥Èöî1ÔºâÁÆÄ‰ªãÔºö JstatÊòØJDKËá™Â∏¶ÁöÑ‰∏Ä‰∏™ËΩªÈáèÁ∫ßÂ∞èÂ∑•ÂÖ∑„ÄÇÂÖ®Áß∞‚ÄúJava Virtual Machine statistics monitoring tool‚ÄùÔºåÂÆÉ‰Ωç‰∫éjavaÁöÑbinÁõÆÂΩï‰∏ãÔºå‰∏ªË¶ÅÂà©Áî®JVMÂÜÖÂª∫ÁöÑÊåá‰ª§ÂØπJavaÂ∫îÁî®Á®ãÂ∫èÁöÑËµÑÊ∫êÂíåÊÄßËÉΩËøõË°åÂÆûÊó∂ÁöÑÂëΩ‰ª§Ë°åÁöÑÁõëÊéßÔºåÂåÖÊã¨‰∫ÜÂØπHeap sizeÂíåÂûÉÂúæÂõûÊî∂Áä∂ÂÜµÁöÑÁõëÊéß„ÄÇÂèØËßÅÔºåJstatÊòØËΩªÈáèÁ∫ßÁöÑ„ÄÅ‰∏ìÈó®ÈíàÂØπJVMÁöÑÂ∑•ÂÖ∑ÔºåÈùûÂ∏∏ÈÄÇÁî®„ÄÇÁî±‰∫éJVMÂÜÖÂ≠òËÆæÁΩÆËæÉÂ§ßÔºåÂõæ‰∏≠ÁôæÂàÜÊØîÂèòÂåñ‰∏çÂ§™ÊòéÊòæ‰∏Ä‰∏™ÊûÅÂº∫ÁöÑÁõëËßÜVMÂÜÖÂ≠òÂ∑•ÂÖ∑„ÄÇÂèØ‰ª•Áî®Êù•ÁõëËßÜVMÂÜÖÂ≠òÂÜÖÁöÑÂêÑÁßçÂ†ÜÂíåÈùûÂ†ÜÁöÑÂ§ßÂ∞èÂèäÂÖ∂ÂÜÖÂ≠ò‰ΩøÁî®Èáè„ÄÇ jstatÂ∑•ÂÖ∑ÁâπÂà´Âº∫Â§ßÔºåÊúâ‰ºóÂ§öÁöÑÂèØÈÄâÈ°πÔºåËØ¶ÁªÜÊü•ÁúãÂ†ÜÂÜÖÂêÑ‰∏™ÈÉ®ÂàÜÁöÑ‰ΩøÁî®ÈáèÔºå‰ª•ÂèäÂä†ËΩΩÁ±ªÁöÑÊï∞Èáè„ÄÇ‰ΩøÁî®Êó∂ÔºåÈúÄÂä†‰∏äÊü•ÁúãËøõÁ®ãÁöÑËøõÁ®ãidÔºåÂíåÊâÄÈÄâÂèÇÊï∞„ÄÇ ÂÆÉ‰∏ªË¶ÅÊòØÁî®Êù•ÊòæÁ§∫GCÂèäPermGenÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ. 2ÔºâÂèÇÊï∞Ôºö -class Option -compiler Option -gc Option -gccapacity Option -gccause Option -gcnew Option -gcnewcapacity Option -gcold Option -gcoldcapacity Option -gcpermcapacity Option -gcutil Option -printcompilation Option Ê≥®ÔºöÂÖ∂‰∏≠ÊúÄÂ∏∏Áî®ÁöÑÂ∞±ÊòØ -gcutil ÈÄâÈ°π‰∫ÜÔºåÂõ†‰∏∫‰ªñËÉΩÂ§üÁªôÊàë‰ª¨Â±ïÁ§∫Â§ßËá¥ÁöÑGC‰ø°ÊÅØ„ÄÇ OptionÔºöÊåáÁöÑÊòØvmid„ÄÅÊòæÁ§∫Èó¥ÈöîÊó∂Èó¥ÂèäÈó¥ÈöîÊ¨°Êï∞Á≠â vmid ‚ÄîVMÁöÑËøõÁ®ãÂè∑ÔºåÂç≥ÂΩìÂâçËøêË°åÁöÑjavaËøõÁ®ãÂè∑ interval Èó¥ÈöîÊó∂Èó¥ÔºåÂçï‰ΩçÊØ´Áßí count ‚Äî ÊâìÂç∞Ê¨°Êï∞ÔºåÂ¶ÇÊûúÁº∫ÁúÅÂàôÊâìÂç∞Êó†Êï∞Ê¨° 3ÔºâËæìÂá∫ÁªìÊûú S0 ‚Äî Heap‰∏äÁöÑ Survivor space 0 Âå∫Â∑≤‰ΩøÁî®Á©∫Èó¥ÁöÑÁôæÂàÜÊØî S0CÔºöS0ÂΩìÂâçÂÆπÈáèÁöÑÂ§ßÂ∞è S0UÔºöS0Â∑≤Áªè‰ΩøÁî®ÁöÑÂ§ßÂ∞è S1 ‚Äî Heap‰∏äÁöÑ Survivor space 1 Âå∫Â∑≤‰ΩøÁî®Á©∫Èó¥ÁöÑÁôæÂàÜÊØî S1CÔºöS1ÂΩìÂâçÂÆπÈáèÁöÑÂ§ßÂ∞è S1UÔºöS1Â∑≤Áªè‰ΩøÁî®ÁöÑÂ§ßÂ∞è E ‚Äî Heap‰∏äÁöÑ Eden space Âå∫Â∑≤‰ΩøÁî®Á©∫Èó¥ÁöÑÁôæÂàÜÊØî ECÔºöEden spaceÂΩìÂâçÂÆπÈáèÁöÑÂ§ßÂ∞è EUÔºöEden spaceÂ∑≤Áªè‰ΩøÁî®ÁöÑÂ§ßÂ∞è O ‚Äî Heap‰∏äÁöÑ Old space Âå∫Â∑≤‰ΩøÁî®Á©∫Èó¥ÁöÑÁôæÂàÜÊØî OCÔºöOld spaceÂΩìÂâçÂÆπÈáèÁöÑÂ§ßÂ∞è OUÔºöOld spaceÂ∑≤Áªè‰ΩøÁî®ÁöÑÂ§ßÂ∞è P ‚Äî Perm space Âå∫Â∑≤‰ΩøÁî®Á©∫Èó¥ÁöÑÁôæÂàÜÊØî PCÔºöPerm spaceÂΩìÂâçÂÆπÈáèÁöÑÂ§ßÂ∞è PUÔºöPerm spaceÂ∑≤Áªè‰ΩøÁî®ÁöÑÂ§ßÂ∞è YGC ‚Äî ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂ÂèëÁîü Young GC ÁöÑÊ¨°Êï∞ YGCT‚Äì ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂ Young GC ÊâÄÁî®ÁöÑÊó∂Èó¥(Âçï‰ΩçÁßí) FGC ‚Äî ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂ÂèëÁîü Full GC ÁöÑÊ¨°Êï∞ FGCT‚Äì ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂ Full GC ÊâÄÁî®ÁöÑÊó∂Èó¥(Âçï‰ΩçÁßí) GCT ‚Äî ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂Áî®‰∫éÂûÉÂúæÂõûÊî∂ÁöÑÊÄªÊó∂Èó¥(Âçï‰ΩçÁßí)ÔºåÂÆÉÁöÑÂÄºÁ≠â‰∫éYGC+FGC 4ÔºâÁ§∫‰æã jstat -gcutil [pid]. interval Âõæ‰∏≠ÂêåÊó∂ÊâìÂç∞‰∫Üyoung gcÂíåfull gcÁöÑÊÄªÊ¨°Êï∞„ÄÅÊÄªËÄóÊó∂„ÄÇËÄåÊØèÊ¨°young gcÊ∂àËÄóÁöÑÊó∂Èó¥ÔºåÂèØ‰ª•Áî®Áõ∏Èó¥ÈöîÁöÑ‰∏§Ë°åÔºàÁ∫¢Á∫øÊ†áÁ§∫ÁöÑÔºâYGCTÁõ∏ÂáèÂæóÂà∞„ÄÇÊØèÊ¨°full gcÊ∂àËÄóÁöÑÊó∂Èó¥ÔºåÂèØ‰ª•Áî®Áõ∏ÈöîÁöÑ‰∏§Ë°åFGCTÁõ∏ÂáèÂæóÂà∞„ÄÇ Â∏∏È©ªÂÜÖÂ≠òÂå∫(P)ÁöÑ‰ΩøÁî®ÁéáÔºåÂßãÁªàÂÅúÁïôÂú®64.78%Â∑¶Âè≥ÔºåËØ¥ÊòéÂ∏∏È©ªÂÜÖÂ≠òÊ≤°ÊúâÁ™ÅÂèòÔºåÊØîËæÉÊ≠£Â∏∏„ÄÇÂ¶ÇÊûúyoung gcÂíåfull gcËÉΩÂ§üÊ≠£Â∏∏ÂèëÁîüÔºåËÄå‰∏îÈÉΩËÉΩÊúâÊïàÂõûÊî∂ÂÜÖÂ≠òÔºåÂ∏∏È©ªÂÜÖÂ≠òÂå∫ÂèòÂåñ‰∏çÊòéÊòæÔºåÂàôËØ¥ÊòéjavaÂÜÖÂ≠òÈáäÊîæÊÉÖÂÜµÊ≠£Â∏∏ÔºåÂûÉÂúæÂõûÊî∂ÂèäÊó∂ÔºåjavaÂÜÖÂ≠òÊ≥ÑÈú≤ÁöÑÂá†ÁéáÂ∞±‰ºöÂ§ßÂ§ßÈôç‰ΩéÔºå‰ΩÜ‰πü‰∏çËÉΩËØ¥Êòé‰∏ÄÂÆöÊ≤°ÊúâÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ jstat -class ËøõÁ®ãid ÊòæÁ§∫Âä†ËΩΩclassÁöÑÊï∞ÈáèÔºåÂèäÊâÄÂç†Á©∫Èó¥Á≠â‰ø°ÊÅØ„ÄÇ 12341. [yang@vm-cbu-qa-172-43 ~]$ jstat -class 12384 20002. Loaded Bytes Unloaded Bytes Time3. 11493 23583.9 195 291.8 12.31 3. jinfoÊ†ºÂºèÔºöjinfo ËøõÁ®ãid ËßÇÂØüËøêË°å‰∏≠ÁöÑjavaÁ®ãÂ∫èÁöÑËøêË°åÁéØÂ¢ÉÂèÇÊï∞ÔºöÂèÇÊï∞ÂåÖÊã¨Java SystemÂ±ûÊÄßÂíåJVMÂëΩ‰ª§Ë°åÂèÇÊï∞ 4. jstackËßÇÂØüjvm‰∏≠ÂΩìÂâçÊâÄÊúâÁ∫øÁ®ãÁöÑËøêË°åÊÉÖÂÜµÂíåÁ∫øÁ®ãÂΩìÂâçÁä∂ÊÄÅ ËØ¶ÁªÜ‰ΩøÁî®ÂèØÂèÇËÄÉ„ÄäjavaÊúçÂä°Âô®loadÈ£öÈ´òÊéíÊü•ÊÄùË∑Ø„Äã 5. jmap1ÔºâÁÆÄ‰ªã ËæìÂá∫ÂÜÖÂ≠ò‰∏≠ÂØπË±°ÁöÑÂ∑•ÂÖ∑ÔºåÊâìÂç∞Âá∫Êüê‰∏™javaËøõÁ®ãÂú®ÂÜÖÂ≠ò‰∏≠ÊâÄÊúâ‚ÄúÂØπË±°‚ÄùÁöÑ‰ΩøÁî®ÊÉÖÂÜµÔºàÂ¶ÇÔºö‰∫ßÁîüÈÇ£‰∫õÂØπË±°„ÄÅÊï∞ÈáèÔºâ 1jmap -histo pid &gt; aa.log ÂèØ‰ª•Â∞Ü‰∫åËøõÂà∂ËæìÂá∫Âà∞ÊñáÊú¨Ôºàaa.logÔºâ‰∏≠ÔºåÂú®‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºå‰ΩøÁî®ÊñáÊú¨ÊØîËæÉÂ∑•ÂÖ∑ÔºåÂèØ‰ª•ÂØπÊØîÂá∫GCÂõûÊî∂‰∫ÜÂì™‰∫õÂØπË±°„ÄÇ 1jmap -dump:format=b,file=heap.bin 12384 ÂèØ‰ª•Â∞Ü12384ËøõÁ®ãÁöÑÂÜÖÂ≠òÂ†ÜÊ†àËæìÂá∫Âà∞heap.bin Êñá‰ª∂ÈáåÔºåÂÜçÈÖçÂêàMATÔºàÂÜÖÂ≠òÂàÜÊûêÂ∑•ÂÖ∑(Memory Analysis ToolÔºâÔºåÂèÇËÄÉÊñáÁ´† Êàñ jhat (Java Heap Analysis Tool)‰∏ÄËµ∑‰ΩøÁî®ÔºåËÉΩÂ§ü‰ª•ÂõæÂÉèÁöÑÂΩ¢ÂºèÁõ¥ËßÇÁöÑÂèçÊò†ÂΩìÂâçÂÜÖÂ≠òÊòØÂê¶Â≠òÂú®ÈóÆÈ¢ò„ÄÇ Â¶ÇÊûú‰Ω†ÁöÑÊú∫Â≠êÊòØ64‰ΩçÔºåÊ†ºÂºèÔºöjmap -J-d64 -heap pid 2ÔºâÂèÇÊï∞Ê†ºÂºè 1-dump:[live,]format=b,file=&lt;filename&gt; ‰ΩøÁî®hprof‰∫åËøõÂà∂ÂΩ¢ÂºèÔºåËæìÂá∫jvmÁöÑheapÂÜÖÂÆπÂà∞Êñá‰ª∂‰∏≠„ÄÇ liveÂ≠êÈÄâÈ°πÊòØÂèØÈÄâÁöÑÔºåÂÅáÂ¶ÇÊåáÂÆöliveÈÄâÈ°πÔºåÈÇ£‰πàÂè™ËæìÂá∫Ê¥ªÁöÑÂØπË±° -finalizerinfo ÊâìÂç∞Ê≠£Á≠âÂÄôÂõûÊî∂ÁöÑÂØπË±°ÁöÑ‰ø°ÊÅØ. -heap ÊâìÂç∞heapÁöÑÊ¶ÇË¶Å‰ø°ÊÅØÔºàÂπ¥ËΩª‰ª£„ÄÅÂπ¥ËÄÅ‰ª£„ÄÅÊåÅ‰πÖ‰ª£ÁöÑÊ¶ÇÊã¨‰ΩøÁî®ÊÉÖÂÜµÔºâÔºåGC‰ΩøÁî®ÁöÑÁÆóÊ≥ïÔºåheapÁöÑÈÖçÁΩÆÂèäwise heapÁöÑ‰ΩøÁî®ÊÉÖÂÜµ„ÄÇ -histo[:live] ËæìÂá∫ÊØè‰∏™ÂØπË±°ÁöÑÂÆû‰æã‰∏™Êï∞„ÄÅÂç†Áî®Â≠óËäÇÊï∞„ÄÅÁ±ªÂÖ®Âêç‰ø°ÊÅØ„ÄÇ VMÁöÑÂÜÖÈÉ®Á±ªÂêçÂ≠óÂºÄÂ§¥‰ºöÂä†‰∏äÂâçÁºÄ‚Äù*‚Äù„ÄÇÂ¶ÇÊûúÂä†‰∏äliveÂ≠êÂèÇÊï∞ÔºåÂè™ÁªüËÆ°Ê¥ªÁöÑÂØπË±°Êï∞Èáè„ÄÇÔºàpsÔºöÈªòËÆ§ÊåâÂÜÖÂ≠ò‰∏≠Âç†Áî®ÁöÑÂ≠óËäÇÊï∞Â§ßÂ∞èÊéíÂ∫èÔºå‰ΩøÁî®Âú∫ÊôØËæÉÂ§öÔºâ -permstat ÊâìÂç∞classloaderÂíåjvm heapÁöÑ‰ø°ÊÅØ„ÄÇ ÂåÖÂê´classloaderÁöÑÂêçÂ≠ó„ÄÅÂä†ËΩΩÁöÑclassÊï∞Èáè„ÄÅÂç†Áî®ÂÜÖÂ≠òÂ§ßÂ∞è„ÄÅÁà∂classloader„ÄÅÊ¥ªË∑ÉÊÄß„ÄÅÁ±ªÂûã„ÄÇ 3ÔºâÂÆû‰æã 11. [yang@vm-cbu-qa-172-43 ~]$ jmap -histo 12384 &gt;aa.log]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êïô‰Ω†Â¶Ç‰ΩïÊàê‰∏∫JavaÁöÑOOM Killer]]></title>
    <url>%2F2018%2F05%2F13%2F%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BAJava%E7%9A%84OOM-Killer%2F</url>
    <content type="text"><![CDATA[Become OOM KillerÊàë‰ª¨ÈÉΩÁü•ÈÅìJVMÁöÑÂÜÖÂ≠òÁÆ°ÁêÜÊòØËá™Âä®ÂåñÁöÑÔºåJavaËØ≠Ë®ÄÁöÑÁ®ãÂ∫èÊåáÈíà‰πü‰∏çÈúÄË¶ÅÂºÄÂèë‰∫∫ÂëòÊâãÂ∑•ÈáäÊîæÔºåJVMÁöÑGC‰ºöËá™Âä®ÁöÑËøõË°åÂõûÊî∂Ôºå‰ΩÜÊòØÔºåÂ¶ÇÊûúÁºñÁ®ã‰∏çÂΩìÔºåJVM‰ªçÁÑ∂‰ºöÂèëÁîüÂÜÖÂ≠òÊ≥ÑÈú≤ÔºåÂØºËá¥JavaÁ®ãÂ∫è‰∫ßÁîü‰∫ÜOutOfMemoryErrorÔºàOOMÔºâÈîôËØØ„ÄÇ ‰∫ßÁîüOutOfMemoryErrorÈîôËØØÁöÑÂéüÂõ†ÂåÖÊã¨Ôºö java.lang.OutOfMemoryError: Java heap space java.lang.OutOfMemoryError: PermGen spaceÂèäÂÖ∂Ëß£ÂÜ≥ÊñπÊ≥ï java.lang.OutOfMemoryError: unable to create new native thread java.lang.OutOfMemoryErrorÔºöGC overhead limit exceeded ÂØπ‰∫éÁ¨¨1ÁßçÂºÇÂ∏∏ÔºåË°®Á§∫JavaÂ†ÜÁ©∫Èó¥‰∏çÂ§üÔºåÂΩìÂ∫îÁî®Á®ãÂ∫èÁî≥ËØ∑Êõ¥Â§öÁöÑÂÜÖÂ≠òÔºåËÄåJavaÂ†ÜÂÜÖÂ≠òÂ∑≤ÁªèÊó†Ê≥ïÊª°Ë∂≥Â∫îÁî®Á®ãÂ∫èÂØπÂÜÖÂ≠òÁöÑÈúÄË¶ÅÔºåÂ∞ÜÊäõÂá∫ËøôÁßçÂºÇÂ∏∏„ÄÇ ÂØπ‰∫éÁ¨¨2ÁßçÂºÇÂ∏∏ÔºåË°®Á§∫JavaÊ∞∏‰πÖÂ∏¶ÔºàÊñπÊ≥ïÂå∫ÔºâÁ©∫Èó¥‰∏çÂ§üÔºåÊ∞∏‰πÖÂ∏¶Áî®‰∫éÂ≠òÊîæÁ±ªÁöÑÂ≠óËäÇÁ†ÅÂíåÈïøÂ∏∏ÈáèÊ±†ÔºåÁ±ªÁöÑÂ≠óËäÇÁ†ÅÂä†ËΩΩÂêéÂ≠òÊîæÂú®Ëøô‰∏™Âå∫ÂüüÔºåËøôÂíåÂ≠òÊîæÂØπË±°ÂÆû‰æãÁöÑÂ†ÜÂå∫ÊòØ‰∏çÂêåÁöÑÔºåÂ§ßÂ§öÊï∞JVMÁöÑÂÆûÁé∞ÈÉΩ‰∏ç‰ºöÂØπÊ∞∏‰πÖÂ∏¶ËøõË°åÂûÉÂúæÂõûÊî∂ÔºåÂõ†Ê≠§ÔºåÂè™Ë¶ÅÁ±ªÂä†ËΩΩÁöÑËøáÂ§öÂ∞±‰ºöÂá∫Áé∞Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ‰∏ÄËà¨ÁöÑÂ∫îÁî®Á®ãÂ∫èÈÉΩ‰∏ç‰ºö‰∫ßÁîüËøô‰∏™ÈîôËØØÔºåÁÑ∂ËÄåÔºåÂØπ‰∫éWebÊúçÂä°Âô®Êù•ËÆ≤Ôºå‰ºö‰∫ßÁîüÊúâÂ§ßÈáèÁöÑJSPÔºåJSPÂú®ËøêË°åÊó∂Ë¢´Âä®ÊÄÅÁöÑÁºñËØëÊàêJava ServletÁ±ªÔºåÁÑ∂ÂêéÂä†ËΩΩÂà∞ÊñπÊ≥ïÂå∫ÔºåÂõ†Ê≠§ÔºåÂ§™Â§öÁöÑJSPÁöÑWebÂ∑•Á®ãÂèØËÉΩ‰∫ßÁîüËøô‰∏™ÂºÇÂ∏∏„ÄÇ ÂØπ‰∫éÁ¨¨3ÁßçÂºÇÂ∏∏ÔºåÊú¨Ë¥®ÂéüÂõ†ÊòØÂàõÂª∫‰∫ÜÂ§™Â§öÁöÑÁ∫øÁ®ãÔºåËÄåËÉΩÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞ÊòØÊúâÈôêÂà∂ÁöÑÔºåÂØºËá¥‰∫ÜËøôÁßçÂºÇÂ∏∏ÁöÑÂèëÁîü„ÄÇ ÂØπ‰∫éÁ¨¨4ÁßçÂºÇÂ∏∏ÔºåÊòØÂú®Âπ∂Ë°åÊàñËÄÖÂπ∂ÂèëÂõûÊî∂Âô®Âú®GCÂõûÊî∂Êó∂Èó¥ËøáÈïø„ÄÅË∂ÖËøá98%ÁöÑÊó∂Èó¥Áî®Êù•ÂÅöGCÂπ∂‰∏îÂõûÊî∂‰∫Ü‰∏çÂà∞2%ÁöÑÂ†ÜÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊäõÂá∫ËøôÁßçÂºÇÂ∏∏ËøõË°åÊèêÂâçÈ¢ÑË≠¶ÔºåÁî®Êù•ÈÅøÂÖçÂÜÖÂ≠òËøáÂ∞èÈÄ†ÊàêÂ∫îÁî®‰∏çËÉΩÊ≠£Â∏∏Â∑•‰Ωú„ÄÇ ‰∏ãÈù¢‰∏§‰∏™ÂºÇÂ∏∏‰∏éOOMÊúâÂÖ≥Á≥ªÔºå‰ΩÜÊòØÔºåÂèàÊ≤°ÊúâÁªùÂØπÂÖ≥Á≥ª„ÄÇ java.lang.StackOverflowError ‚Ä¶ java.net.SocketException: Too many open files ÂØπ‰∫éÁ¨¨1ÁßçÂºÇÂ∏∏ÔºåÊòØJVMÁöÑÁ∫øÁ®ãÁî±‰∫éÈÄíÂΩíÊàñËÄÖÊñπÊ≥ïË∞ÉÁî®Â±ÇÊ¨°Â§™Â§öÔºåÂç†Êª°‰∫ÜÁ∫øÁ®ãÂ†ÜÊ†àËÄåÂØºËá¥ÁöÑÔºåÁ∫øÁ®ãÂ†ÜÊ†àÈªòËÆ§Â§ßÂ∞è‰∏∫1M„ÄÇ ÂØπ‰∫éÁ¨¨2ÁßçÂºÇÂ∏∏ÔºåÊòØÁî±‰∫éÁ≥ªÁªüÂØπÊñá‰ª∂Âè•ÊüÑÁöÑ‰ΩøÁî®ÊòØÊúâÈôêÂà∂ÁöÑÔºåËÄåÊüê‰∏™Â∫îÁî®Á®ãÂ∫è‰ΩøÁî®ÁöÑÊñá‰ª∂Âè•ÊüÑË∂ÖËøá‰∫ÜËøô‰∏™ÈôêÂà∂ÔºåÂ∞±‰ºöÂØºËá¥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ ‰∏äÈù¢‰ªãÁªç‰∫ÜOOMÁõ∏ÂÖ≥ÁöÑÂü∫Á°ÄÁü•ËØÜÔºåÊé•‰∏ãÊù•Êàë‰ª¨ÂºÄÂßãËÆ≤Ëø∞Á¨îËÄÖÁªèÂéÜÁöÑ‰∏ÄÊ¨°OOMÈóÆÈ¢òÁöÑÂÆö‰ΩçÂíåËß£ÂÜ≥ÁöÑËøáÁ®ã„ÄÇ 1. ‰∫ßÁîüÈóÆÈ¢òÁöÑÁé∞Ë±° Âú®Êüê‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÔºåÊàë‰ª¨ÂèëÁé∞‰∏çÂêåÁöÑ‰∏öÂä°ÊúçÂä°ÂºÄÂßãÂÅ∂ÂèëÁöÑÊä•OOMÁöÑÂºÇÂ∏∏ÔºåÊúâÁöÑÊó∂ÂÄôÊòØÁôΩÂ§©ÂèëÁîüÔºåÊúâÁöÑÊó∂ÂÄôÊòØÊôö‰∏äÂèëÁîüÔºåÊúâÁöÑÊó∂ÂÄôÊòØÂü∫Á°ÄÊúçÂä°AÂèëÁîüÔºåÊúâÁöÑÊó∂ÂÄôÊòØ‰∏äÂ±ÇÊúçÂä°BÂèëÁîüÔºåÊúâÁöÑÊó∂ÂÄôÊòØ‰∏äÂ±ÇÊúçÂä°CÂèëÁîüÔºåÊúâÁöÑÊó∂ÂÄôÊòØ‰∏ãÂ±ÇÊúçÂä°DÂèëÁîüÔºå‰∏ùÊØ´Áúã‰∏çÂà∞‰∏ÄÁÇπËßÑÂæã„ÄÇ ‰∫ßÁîüÈóÆÈ¢òÁöÑÂºÇÂ∏∏Â¶Ç‰∏ãÔºö 123Caused by: java.lang.OutOfMemoryError: unable to create new native thread at java.lang.Thread.start0(Native Method)at java.lang.Thread.start(Thread.java:597)at java.util.Timer.&lt;init&gt;(Timer.java:154) 2. Ëß£ÂÜ≥ÈóÆÈ¢òÁöÑÊÄùË∑ØÂíåËøáÁ®ã ÁªèËøáÁªÜÂøÉËßÇÂØüÂèëÁé∞Ôºå‰∫ßÁîüÈóÆÈ¢òËôΩÁÑ∂Âú®‰∏çÂêåÁöÑÊó∂Èó¥ÂèëÁîüÂú®‰∏çÂêåÁöÑÊúçÂä°Ê±†Ôºå‰ΩÜÊòØÔºåÊôö‰∏ä0ÁÇπÂèëÁîüÁöÑÊó∂ÂÄôÊ¶ÇÁéáËæÉÂ§ßÔºå‰πüÊúâÂÖ∂‰ªñÊó∂Èó¥ÂÅ∂ÂèëÔºå‰ΩÜÊòØÈÉΩÂú®Êï¥ÁÇπ„ÄÇ Ëøô‰∏™ËßÑÂæãÂæàÈáçË¶ÅÔºåËôΩÁÑ∂‰∏çÊòØ‰∏Ä‰∏™Êó∂Èó¥Ôºå‰ΩÜÊòØÂü∫Êú¨ÈÉΩÂú®Êï¥ÁÇπÂ∑¶Âè≥ÂèëÁîüÔºåÂπ∂‰∏îÊôö‰∏ä0ÁÇπÂ±ÖÂ§ö„ÄÇ‰ªéËøô‰∏™ËßíÂ∫¶ÊÄùËÄÉÔºåÊï¥ÁÇπÊàñËÄÖ0ÁÇπÁ≥ªÁªüÊòØÂê¶ÊúâÂÆöÊó∂Ôºå‰∏éÂá∫ÈóÆÈ¢òÁöÑÊØè‰∏™‰∏öÂä°Á≥ªÁªüÊäÄÊúØË¥üË¥£‰∫∫Ê†∏ÂÆûÔºå0ÁÇπÊ≤°ÊúâÂÆöÊó∂‰ªªÂä°ÔºåÂÖ∂‰ªñÊó∂Èó¥ÁöÑÊï¥ÁÇπÊúâÂÆöÊó∂‰ªªÂä°Ôºå‰ΩÜÊòØ‰∏éÂèëÁîüÈóÆÈ¢òÁöÑÊó∂Èó¥‰∏çÂêªÂêàÔºåËøô‰∏™ÊÄùË∑ØË°å‰∏çÈÄö„ÄÇ Âà∞Áé∞Âú®‰∏∫Ê≠¢Ôºå‰ªéÁé∞Ë±°ÁöÑËßÑÂæã‰∏äÊàë‰ª¨Â∑≤ÁªèÊ≤°Ê≥ïÁªßÁª≠ÂàÜÊûê‰∏ãÂéª‰∫ÜÔºåÈÇ£Êàë‰ª¨ÂõûÈ°æ‰∏Ä‰∏ãÈîôËØØÊú¨Ë∫´Ôºö java.lang.OutOfMemoryError: unable to create new native thread È°æÂêçÊÄù‰πâÔºåÈîôËØØ‰∫ßÁîüÁöÑÂéüÂõ†Â∞±ÊòØÂ∫îÁî®‰∏çËÉΩÂàõÂª∫Á∫øÁ®ã‰∫ÜÔºå‰ΩÜÊòØÔºåÂ∫îÁî®ËøòÈúÄË¶ÅÂàõÂª∫Á∫øÁ®ã„ÄÇ‰∏∫‰ªÄ‰πàÁ®ãÂ∫è‰∏çËÉΩÂàõÂª∫Á∫øÁ®ãÂë¢Ôºü Êúâ‰∏§‰∏™ÂÖ∑‰ΩìÂéüÂõ†ÈÄ†ÊàêËøô‰∏™ÂºÇÂ∏∏: Áî±‰∫éÁ∫øÁ®ã‰ΩøÁî®ÁöÑËµÑÊ∫êËøáÂ§öÔºåÊìç‰ΩúÁ≥ªÁªüÂ∑≤Áªè‰∏çËÉΩÂÜçÊèê‰æõÁªôÂ∫îÁî®ËµÑÊ∫ê‰∫Ü„ÄÇ Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ‰∫ÜÂ∫îÁî®ÂàõÂª∫Á∫øÁ®ãÁöÑÊúÄÂ§ßÊï∞ÈáèÔºåÂπ∂‰∏îÂ∑≤ÁªèËææÂà∞‰∫ÜÊúÄÂ§ßÂÖÅËÆ∏Êï∞Èáè„ÄÇ ‰∏äÈù¢Á¨¨1Êù°ËµÑÊ∫êÊåáÁöÑÊòØÂÜÖÂ≠òÔºåËÄåÁ¨¨2Êù°‰∏≠ÔºåÂú®Linux‰∏ãÁ∫øÁ®ã‰ΩøÁî®ËΩªÈáèÁ∫ßËøõÁ®ãÂÆûÁé∞ÁöÑÔºåÂõ†Ê≠§Á∫øÁ®ãÁöÑÊúÄÂ§ßÊï∞Èáè‰πüÊòØÊìç‰ΩúÁ≥ªÁªüÂÖÅËÆ∏ÁöÑËøõÁ®ãÁöÑÊúÄÂ§ßÊï∞Èáè„ÄÇ ÂÜÖÂ≠òËÆ°ÁÆó Êìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÊúÄÂ§ßÂèØÁî®ÂÜÖÂ≠òÈô§ÂéªÊìç‰ΩúÁ≥ªÁªüÊú¨Ë∫´‰ΩøÁî®ÁöÑÈÉ®ÂàÜÔºåÂâ©‰∏ãÁöÑÈÉΩÂèØ‰ª•‰∏∫Êüê‰∏Ä‰∏™ËøõÁ®ãÊúçÂä°ÔºåÂú®JVMËøõÁ®ã‰∏≠ÔºåÂÜÖÂ≠òÂèàË¢´ÂàÜ‰∏∫Â†Ü„ÄÅÊú¨Âú∞ÂÜÖÂ≠òÂíåÊ†àÁ≠â‰∏âÂ§ßÂùóÔºåJavaÂ†ÜÊòØJVMËá™Âä®ÁÆ°ÁêÜÁöÑÂÜÖÂ≠òÔºåÂ∫îÁî®ÁöÑÂØπË±°ÁöÑÂàõÂª∫ÂíåÈîÄÊØÅ„ÄÅÁ±ªÁöÑË£ÖËΩΩÁ≠âÈÉΩÂèëÁîüÂú®ËøôÈáåÔºåÊú¨Âú∞ÂÜÖÂ≠òÊòØJavaÂ∫îÁî®‰ΩøÁî®ÁöÑ‰∏ÄÁßçÁâπÊÆäÂÜÖÂ≠òÔºåJVMÂπ∂‰∏çÁõ¥Êé•ÁÆ°ÁêÜÂÖ∂ÁîüÂëΩÂë®ÊúüÔºåÊØè‰∏™Á∫øÁ®ã‰πü‰ºöÊúâ‰∏Ä‰∏™Ê†àÔºåÊòØÁî®Êù•Â≠òÂÇ®Á∫øÁ®ãÂ∑•‰ΩúËøáÁ®ã‰∏≠‰∫ßÁîüÁöÑÊñπÊ≥ïÂ±ÄÈÉ®ÂèòÈáè„ÄÅÊñπÊ≥ïÂèÇÊï∞ÂíåËøîÂõûÂÄºÁöÑÔºåÊØè‰∏™Á∫øÁ®ãÂØπÂ∫îÁöÑÊ†àÁöÑÈªòËÆ§Â§ßÂ∞è‰∏∫1M„ÄÇ LinuxÂíåJVMÁöÑÂÜÖÂ≠òÁÆ°ÁêÜÁ§∫ÊÑèÂõæÂ¶Ç‰∏ãÔºö Âõ†Ê≠§Ôºå‰ªéÂÜÖÂ≠òËßíÂ∫¶Êù•ÁúãÂàõÂª∫Á∫øÁ®ãÈúÄË¶ÅÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂ¶ÇÊûúJVMËøõÁ®ãÊ≠£ÂΩì‰∏Ä‰∏™Â∫îÁî®ÂàõÂª∫Á∫øÁ®ãÔºåËÄåÊìç‰ΩúÁ≥ªÁªüÊ≤°ÊúâÂâ©‰ΩôÁöÑÂÜÖÂ≠òÂàÜÈÖçÁªôÊ≠§JVMËøõÁ®ãÔºåÂàô‰ºöÊäõÂá∫ÈóÆÈ¢ò‰∏≠ÁöÑOOMÂºÇÂ∏∏Ôºöunable to create new native thread„ÄÇ Â¶Ç‰∏ãÂÖ¨ÂºèÂèØ‰ª•Áî®Êù•‰ªéÂÜÖÂ≠òËßíÂ∫¶ËÆ°ÁÆóÂÖÅËÆ∏ÂàõÂª∫ÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞Ôºö ÊúÄÂ§ßÁ∫øÁ®ãÊï∞ = ÔºàÊìç‰ΩúÁ≥ªÁªüÊúÄÂ§ßÂèØÁî®ÂÜÖÂ≠ò - JVMÂÜÖÂ≠ò - Êìç‰ΩúÁ≥ªÁªüÈ¢ÑÁïôÂÜÖÂ≠òÔºâ/ Á∫øÁ®ãÊ†àÂ§ßÂ∞è Ê†πÊçÆËøô‰∏™ÂÖ¨ÂºèÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂâ©‰ΩôÂÜÖÂ≠òËÆ°ÁÆóÂèØ‰ª•ÂàõÂª∫Á∫øÁ®ãÁöÑÊï∞Èáè„ÄÇ ‰∏ãÈù¢ÊòØÈóÆÈ¢òÂá∫Áé∞ÁöÑÊó∂ÂÄôÔºå‰ªéÁîü‰∫ßÊú∫Âô®‰∏äÊâßË°åÂâçÈù¢Â∞èËäÇ‰ªãÁªçÁöÑLinuxÂëΩ‰ª§freeÁöÑËæìÂá∫Ôºö 123free -m &gt;&gt; /tmp/free.log total used free shared buffers cachedMem: 7872 7163 709 0 31 3807-/+ buffers/cache: 3324 4547Swap: 4095 173 3922Tue Jul 5 00:27:51 CST 2016 ‰ªé‰∏äÈù¢ËæìÂá∫ÂèØ‰ª•ÂæóÂá∫ÔºåÁîü‰∫ßÊú∫Âô®8GÂÜÖÂ≠òÔºå‰ΩøÁî®‰∫Ü7GÔºåÂâ©‰Ωô700MÂèØÁî®ÔºåÂÖ∂‰∏≠Êìç‰ΩúÁ≥ªÁªücache‰ΩøÁî®3.8G„ÄÇÊìç‰ΩúÁ≥ªÁªücache‰ΩøÁî®ÁöÑ3.8GÊòØÁî®Êù•ÁºìÂ≠òIOÊï∞ÊçÆÁöÑÔºåÂ¶ÇÊûúËøõÁ®ãÂÜÖÂ≠ò‰∏çÂ§üÁî®ÔºåËøô‰∫õÂÜÖÂ≠òÊòØÂèØ‰ª•ÈáäÊîæÂá∫Êù•‰ºòÂÖàÂàÜÈÖçÁªôËøõÁ®ã‰ΩøÁî®„ÄÇÁÑ∂ËÄåÔºåÊàë‰ª¨ÊöÇÊó∂Âπ∂‰∏çÈúÄË¶ÅËÄÉËôëËøôÂùóÂÜÖÂ≠òÔºåÂâ©‰ΩôÁöÑ700MÁ©∫Èó¥ÂÆåÂÖ®ÂèØ‰ª•ÁªßÁª≠Áî®Êù•ÂàõÂª∫Á∫øÁ®ãÊï∞Ôºö 700M / 1M = 700‰∏™Á∫øÁ®ã Âõ†Ê≠§ÔºåÊ†πÊçÆÂÜÖÂ≠òÂèØÁî®ËÆ°ÁÆóÔºåÂΩìOOMÂºÇÂ∏∏Ôºöunable to create new native threadÈóÆÈ¢òÂèëÁîüÁöÑÊó∂ÂÄôÔºåËøòÊúâ700MÂèØÁî®ÂÜÖÂ≠òÔºåÂèØ‰ª•ÂàõÂª∫700‰∏™Á∫øÁ®ã„ÄÇ Âà∞Áé∞Âú®‰∏∫Ê≠¢ÂèØ‰ª•ËØÅÊòéÊ≠§Ê¨°OOMÂºÇÂ∏∏‰∏çÊòØÂõ†‰∏∫Á∫øÁ®ãÂêÉÂÖâÊâÄÊúâÁöÑÂÜÖÂ≠òËÄåÂØºËá¥ÁöÑ„ÄÇ Á∫øÁ®ãÊï∞ÂØπÊØî ‰∏äÈù¢ÊèêÂà∞ÔºåÊúâ‰∏§‰∏™ÂÖ∑‰ΩìÂéüÂõ†ÈÄ†ÊàêËøô‰∏™ÂºÇÂ∏∏ÔºåÊàë‰ª¨‰∏äÈù¢Â∑≤ÁªèÊéíÈô§‰∫ÜÁ¨¨1‰∏™ÂéüÂõ†ÔºåÈÇ£Êàë‰ª¨Áé∞Âú®‰ªéÁ¨¨2‰∏™ÂéüÂõ†ÂÖ•ÊâãÔºåËØÑ‰º∞ÊòØÂê¶Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ‰∫ÜÂ∫îÁî®ÂàõÂª∫Á∫øÁ®ãÁöÑÊúÄÂ§ßÊï∞ÈáèÔºåÂπ∂‰∏îÂ∑≤ÁªèËææÂà∞‰∫ÜÊúÄÂ§ßÂÖÅËÆ∏Êï∞Èáè„ÄÇ Âú®ÈóÆÈ¢òÂá∫Áé∞ÁöÑÁîü‰∫ßÊú∫Âô®‰∏ä‰ΩøÁî®ulimit -aÊù•ÊòæÁ§∫ÂΩìÂâçÁöÑÂêÑÁßçÁ≥ªÁªüÂØπÁî®Êà∑‰ΩøÁî®ËµÑÊ∫êÁöÑÈôêÂà∂Ôºö 123456robert@robert-ubuntu1410Ôºö~$ ulimit -acore file size (blocks, -c) 0data seg size (kbytes, -d) unlimitedscheduling priority (-e) 0file size (blocks, -f) unlimitedpending signals (-i) 62819max locked memory (kbytes, -l) 64max memory size (kbytes, -m) unlimitedopen files (-n) 65535pipe size (512 bytes, -p) 8POSIX message queues (bytes, -q) 819200real-time priority (-r) 0stack size (kbytes, -s) 10240cpu time (seconds, -t) unlimitedmax user processes (-u) 1024virtual memory (kbytes, -v) unlimitedfile locks (-x) unlimited ËøôÈáåÈù¢Êàë‰ª¨ÁúãÂà∞Áîü‰∫ßÊú∫Âô®ËÆæÁΩÆÁöÑÂÖÅËÆ∏‰ΩøÁî®ÁöÑÊúÄÂ§ßÁî®Êà∑ËøõÁ®ãÊï∞‰∏∫1024Ôºö 1max user processes (-u) 1024 Áé∞Âú®ÔºåÊàë‰ª¨ÂøÖÈ°ªËé∑ÂæóÈóÆÈ¢òÂá∫Áé∞ÁöÑÊó∂ÂÄôÔºåÁî®Êà∑‰∏ãÂàõÂª∫ÁöÑÁ∫øÁ®ãÊÉÖÂÜµ„ÄÇ Âú®ÈóÆÈ¢ò‰∫ßÁîüÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰ΩøÁî®ÂâçÈù¢Â∞èÁªì‰ªãÁªçÁöÑJVMÁõëÊéßÂëΩ‰ª§jstackÂëΩ‰ª§ÊâìÂç∞Âá∫‰∫ÜJavaÁ∫øÁ®ãÊÉÖÂÜµ,jstackÂëΩ‰ª§ÁöÑÁ§∫‰æãËæìÂá∫Â¶Ç‰∏ãÔºö 12345678910111213141516171819202122robert@robert-ubuntu1410:~$ jstack 27432017-04-09 12:06:51Full thread dump Java HotSpot(TM) Server VM (25.20-b23 mixed mode):"Attach Listener" #23 daemon prio=9 os_prio=0 tid=0xc09adc00 nid=0xb4c waiting on condition [0x00000000] java.lang.Thread.State: RUNNABLE"http-nio-8080-Acceptor-0" #22 daemon prio=5 os_prio=0 tid=0xc3341000 nid=0xb02 runnable [0xbf1bd000] java.lang.Thread.State: RUNNABLE at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method) at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:241) - locked &lt;0xcf8938d8&gt; (a java.lang.Object) at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:688) at java.lang.Thread.run(Thread.java:745)"http-nio-8080-ClientPoller-1" #21 daemon prio=5 os_prio=0 tid=0xc35bc400 nid=0xb01 runnable [0xbf1fe000] java.lang.Thread.State: RUNNABLE at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method) at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269) at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:79) at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86) - locked &lt;0xcf99b100&gt; (a sun.nio.ch.Util$2) - locked &lt;0xcf99b0f0&gt; (a java.util.Collections$UnmodifiableSet) - locked &lt;0xcf99aff8&gt; (a sun.nio.ch.EPollSelectorImpl) at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97) at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1052) at java.lang.Thread.run(Thread.java:745)...... ‰ªéjstackÂëΩ‰ª§ÁöÑËæìÂá∫Âπ∂ÁªüËÆ°ÂêéÔºåÊàë‰ª¨ÂæóÁü•ÔºåJVM‰∏ÄÂÖ±ÂàõÂª∫‰∫Ü904‰∏™Á∫øÁ®ãÔºå‰ΩÜÊòØÔºåËøôËøòÊ≤°ÊúâÂà∞ÊúÄÂ§ßÁöÑËøõÁ®ãÈôêÂà∂1024„ÄÇ 12robert@robert-ubuntu1410:~$ grep "Thread " js.log | wc -l 904 ËøôÊòØÊàë‰ª¨ÊÄùËÄÉÔºåÈô§‰∫ÜJVMÂàõÂª∫ÁöÑÂ∫îÁî®Â±ÇÁ∫øÁ®ãÔºåJVMÊú¨Ë∫´ÂèØËÉΩ‰ºöÊúâ‰∏Ä‰∫õÁÆ°ÁêÜÁ∫øÁ®ãÂ≠òÂú®ÔºåËÄå‰∏îÊìç‰ΩúÁ≥ªÁªüÂÜÖÁî®Êà∑‰∏ãÂèØËÉΩ‰πü‰ºöÊúâÂÆàÊä§Á∫øÁ®ãÂú®ËøêË°å„ÄÇ Êàë‰ª¨ÁªßÁª≠‰ªéÊìç‰ΩúÁ≥ªÁªüÁöÑËßíÂ∫¶Êù•ÁªüËÆ°Á∫øÁ®ãÊï∞ÔºåÊàë‰ª¨‰ΩøÁî®‰∏äÈù¢Â∞èÁªì‰ªãÁªçÁöÑLinuxÊìç‰ΩúÁ≥ªÁªüÂëΩ‰ª§pstackÔºåÂπ∂ÂæóÂà∞Â¶Ç‰∏ãÁöÑËæìÂá∫Ôºö 123456789PID LWP USER %CPU %MEM CMD 1 1 root 0.0 0.0 /sbin/init 2 2 root 0.0 0.0 [kthreadd] 3 3 root 0.0 0.0 [migration/0] 4 4 root 0.0 0.0 [ksoftirqd/0] 5 5 root 0.0 0.0 [migration/0] 6 6 root 0.0 0.0 [watchdog/0] 7 7 root 0.0 0.0 [migration/1] 8 8 root 0.0 0.0 [migration/1] 9 9 root 0.0 0.0 [ksoftirqd/1] 10 10 root 0.0 0.0 [watchdog/1] 11 11 root 0.0 0.0 [migration/2] 12 12 root 0.0 0.0 [migration/2] 13 13 root 0.0 0.0 [ksoftirqd/2] 14 14 root 0.0 0.0 [watchdog/2] 15 15 root 0.0 0.0 [migration/3] 16 16 root 0.0 0.0 [migration/3] 17 17 root 0.0 0.0 [ksoftirqd/3] 18 18 root 0.0 0.0 [watchdog/3] 19 19 root 0.0 0.0 [events/0] 20 20 root 0.0 0.0 [events/1] 21 21 root 0.0 0.0 [events/2] 22 22 root 0.0 0.0 [events/3] 23 23 root 0.0 0.0 [cgroup] 24 24 root 0.0 0.0 [khelper] ...... 7257 7257 zabbix 0.0 0.0 /usr/local/zabbix/sbin/zabbix_agentd: active checks #2 [idle 1 sec] 7258 7258 zabbix 0.0 0.0 /usr/local/zabbix/sbin/zabbix_agentd: active checks #3 [idle 1 sec] 7259 7259 zabbix 0.0 0.0 /usr/local/zabbix/sbin/zabbix_agentd: active checks #4 [idle 1 sec] ...... 9040 9040 app 0.0 30.5 /apps/prod/jdk1.6.0_24/bin/java -Dnop -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Ddbconfigpath=/apps/dbconfig/ -Djava.io.tmpdir=/apps/data/java-tmpdir -server -Xms2048m -Xmx2048m -XX:PermSize=128m -XX:MaxPermSize=512m -Dcom.sun.management.jmxremote -Djava.rmi.server.hostname=192.168.10.194 -Dcom.sun.management.jmxremote.port=6969 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp -Xshare:off -Dhostname=sjsa-trade04 -Djute.maxbuffer=41943040 -Djava.net.preferIPv4Stack=true -Dfile.encoding=UTF-8 -Dworkdir=/apps/data/tomcat-work -Djava.endorsed.dirs=/apps/product/tomcat-trade/endorsed -classpath commonlib:/apps/product/tomcat-trade/bin/bootstrap.jar:/apps/product/tomcat-trade/bin/tomcat-juli.jar -Dcatalina.base=/apps/product/tomcat-trade -Dcatalina.home=/apps/product/tomcat-trade -Djava.io.tmpdir=/apps/data/tomcat-temp/ org.apache.catalina.startup.Bootstrap start 9040 9041 app 0.0 30.5 /apps/prod/jdk1.6.0_24/bin/java -Dnop -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Ddbconfigpath=/apps/dbconfig/ -Djava.io.tmpdir=/apps/data/java-tmpdir -server -Xms2048m -Xmx2048m -XX:PermSize=128m -XX:MaxPermSize=512m -Dcom.sun.management.jmxremote -Djava.rmi.server.hostname=192.168.10.194 -Dcom.sun.management.jmxremote.port=6969 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp -Xshare:off -Dhostname=sjsa-trade04 -Djute.maxbuffer=41943040 -Djava.net.preferIPv4Stack=true -Dfile.encoding=UTF-8 -Dworkdir=/apps/data/tomcat-work -Djava.endorsed.dirs=/apps/product/tomcat-trade/endorsed -classpath commonlib:/apps/product/tomcat-trade/bin/bootstrap.jar:/apps/product/tomcat-trade/bin/tomcat-juli.jar -Dcatalina.base=/apps/product/tomcat-trade -Dcatalina.home=/apps/product/tomcat-trade -Djava.io.tmpdir=/apps/data/tomcat-temp/ org.apache.catalina.startup.Bootstrap start...... ÈÄöËøáÂëΩ‰ª§ÁªüËÆ°Áî®Êà∑‰∏ãÂ∑≤ÁªèÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞‰∏∫1021„ÄÇ 12$ grep app pthreads.log | wc -l 1021 Áé∞Âú®Êàë‰ª¨Á°ÆÂÆöÔºå1021ÁöÑÊï∞Â≠óÂ∑≤ÁªèÁõ∏ÂΩìÁöÑÊé•Ëøë1021ÁöÑÊúÄÂ§ßËøõÁ®ãÊï∞‰∫ÜÔºåÊ≠£Â¶ÇÂâçÈù¢Êàë‰ª¨ÊèêÂà∞ÔºåÂú®LinuxÊìç‰ΩúÁ≥ªÁªüÈáåÔºåÁ∫øÁ®ãÊòØÈÄöËøáËΩªÈáèÁ∫ßÁöÑËøõÁ®ãÂÆûÁé∞ÁöÑÔºåÂõ†Ê≠§ÔºåÈôêÂà∂Áî®Êà∑ÁöÑÊúÄÂ§ßËøõÁ®ãÊï∞ÔºåÂ∞±ÊòØÈôêÂà∂Áî®Êà∑ÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÔºåËá≥‰∫é‰∏∫‰ªÄ‰πàÊ≤°ÊúâÁ≤æÁ°ÆËææÂà∞1024Ëøô‰∏™ÊúÄÂ§ßÂÄºÂ∞±Â∑≤ÁªèÊä•Âá∫ÂºÇÂ∏∏ÔºåÂ∫îËØ•ÊòØÁ≥ªÁªüÁöÑËá™Êàë‰øùÊä§ÂäüËÉΩÔºåÂú®ËøòÂâ©‰∏ã3‰∏™Á∫øÁ®ãÁöÑÂâçÊèê‰∏ãÔºåÂ∞±ÂºÄÂßãÊä•Èîô„ÄÇ Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊàë‰ª¨Â∑≤ÁªèÈÄöËøáÂàÜÊûêÊù•ÊâæÂà∞ÈóÆÈ¢òÁöÑÂéüÂõ†Ôºå‰ΩÜÊòØÔºåÊàë‰ª¨ËøòÊòØ‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πà‰ºöÂàõÂª∫Ëøô‰πàÂ§öÁöÑÁ∫øÁ®ãÔºå‰ªéÁ¨¨‰∏Ä‰∏™ËæìÂá∫ÂæóÁü•ÔºåJVMÂ∑≤ÁªèÂàõÂª∫ÁöÑÂ∫îÁî®Á∫øÁ®ãÊúâ907‰∏™ÔºåÈÇ£‰πà‰ªñ‰ª¨ÈÉΩÂú®ÂÅö‰ªÄ‰πà‰∫ãÊÉÖÂë¢Ôºü ‰∫éÊòØÔºåÂú®ÈóÆÈ¢òÂèëÁîüÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Âèà‰ΩøÁî®JVMÁöÑjstackÂëΩ‰ª§ÔºåÊü•ÁúãËæìÂá∫ÂæóÁü•ÔºåÊØè‰∏™Á∫øÁ®ãÈÉΩÈòªÂ°ûÂú®ÊâìÂç∞Êó•ÂøóÁöÑËØ≠Âè•‰∏äÔºålog4j‰∏≠ÊâìÂç∞Êó•ÂøóÁöÑ‰ª£Á†ÅÂÆûÁé∞Â¶Ç‰∏ãÔºö 1234567891011public void callAppenders(LoggingEvent event) &#123; int writes = 0; for(Category c = this; c != null; c=c.parent) &#123; // Protected against simultaneous call to addAppender, removeAppender,... synchronized(c) &#123; if(c.aai != null) &#123; writes += c.aai.appendLoopOnAppenders(event); &#125; if(!c.additive) &#123; break; &#125; &#125; &#125; if(writes == 0) &#123; repository.emitNoAppenderWarning(this); &#125;&#125; Âú®log4j‰∏≠ÔºåÊâìÂç∞Êó•ÂøóÊúâ‰∏Ä‰∏™ÈîÅÔºåÈîÅÁöÑ‰ΩúÁî®ÊòØËÆ©ÊâìÂç∞Êó•ÂøóÂèØ‰ª•‰∏≤Ë°åÔºå‰øùËØÅÊó•ÂøóÂú®Êó•ÂøóÊñá‰ª∂‰∏≠ÁöÑÊ≠£Á°ÆÊÄßÂíåÈ°∫Â∫èÊÄß„ÄÇ ÈÇ£‰πàÔºåÊñ∞ÁöÑÈóÆÈ¢òÂèàÊù•‰∫ÜÔºå‰∏∫‰ªÄ‰πàÂè™ÊúâÂáåÊô®0ÁÇπ‰ºöÂá∫Áé∞ÊâìÂç∞Êó•ÂøóÈòªÂ°ûÔºåÂÖ∂‰ªñÊó∂Èó¥‰ºöÂÅ∂Â∞îÂèëÁîüÂë¢ÔºüËøôÊó∂ÔºåÊàë‰ª¨Â∏¶ÁùÄÊñ∞ÁöÑÁ∫øÁ¥¢ÂèàÂõûÂà∞ÈóÆÈ¢òÂºÄÂßãÁöÑÊÄùË∑ØÔºåÂáåÊô®12ÁÇπÂ∫îÁî®Ê≤°ÊúâÂÆöÊó∂‰ªªÂä°ÔºåÁ≥ªÁªü‰ºö‰∏ç‰ºöÊúâÂÖ∂‰ªñÁöÑIOÂØÜÈõÜÂûãÁöÑ‰ªªÂä°ÔºåÊØîÂ¶ÇËØ¥ÂΩíÊ°£Êó•Âøó„ÄÅÁ£ÅÁõòÂ§á‰ªΩÁ≠âÔºü ÁªèËøá‰∏éËøêÁª¥ÈÉ®Èó®Á¢∞Â§¥ÔºåÂü∫Êú¨Á°ÆÂÆöÊòØÊØèÂ§©ÂáåÊô®0ÁÇπÊó•ÂøóÂàáÂâ≤ÂØºËá¥Á£ÅÁõòIOË¢´Âç†Áî®Ôºå‰∫éÊòØÂ†µÂ°ûÊâìÂç∞Êó•ÂøóÔºåÊó•ÂøóÊòØÊØè‰∏™Â∑•‰Ωú‰ªªÂä°ÈÉΩÂøÖÈ°ªÁöÑÔºåÊó•ÂøóÈòªÂ°ûÔºåÁ∫øÁ®ãÊ±†Â∞±ÈòªÂ°ûÔºåÁ∫øÁ®ãÊ±†ÈòªÂ°ûÂ∞±ÂØºËá¥Á∫øÁ®ãÊ±†Ë¢´ÊíëÂ§ßÔºåÁ∫øÁ®ãÊ±†ÈáåÈù¢ÁöÑÁ∫øÁ®ãÊï∞Ë∂ÖËøá1024Â∞±‰ºöÊä•Èîô„ÄÇ Âà∞ËøôÈáåÔºåÊàë‰ª¨Âü∫Êú¨Á°ÆÂÆö‰∫ÜÈóÆÈ¢òÁöÑÂéüÂõ†Ôºå‰ΩÜÊòØËøòÈúÄË¶ÅÂØπÊó•ÂøóÂàáÂâ≤ÂØºËá¥IOÂ¢ûÂ§ßËøõË°åÂàÜÊûêÂíåËÆ∫ËØÅ„ÄÇ È¶ñÂÖàÊàë‰ª¨‰ΩøÁî®ÂâçÈù¢Â∞èÁªì‰ªãÁªçÁöÑvmstatÊü•ÁúãÈóÆÈ¢òÂèëÁîüÊó∂IOÁ≠âÂæÖÊï∞ÊçÆÔºö 123vmstat 2 1 &gt;&gt; /tmp/vm.logprocs -----------memory---------- ---swap-- -----io---- --system-- -----cpu----- r b swpd free buff cache si so bi bo in cs us sy id wa st 3 0 177608 725636 31856 3899144 0 0 2 10 0 0 39 1 1 59 0 Tue Jul 5 00:27:51 CST 2016 ÂèØËßÅÔºåÈóÆÈ¢òÂèëÁîüÁöÑÊó∂ÂÄôÔºåCPUÁöÑIOÁ≠âÂæÖ‰∏∫59%ÔºåÂêåÊó∂Âèà‰∏éËøêÁª¥ÈÉ®Èó®Âêå‰∫ãÂ§çÁõòÔºåËøêÁª¥Âêå‰∫ãÁ°ÆËÆ§ÔºåËÑöÊú¨ÂàáÂâ≤ÈÄöËøácatÂëΩ‰ª§ÊñπÊ≥ïÔºåÂÖàÊääÊó•ÂøóÊñá‰ª∂catÂêéÔºåÈÄöËøáÁÆ°ÈÅìÊâìÂç∞Âà∞Âè¶Â§ñ‰∏Ä‰∏™Êñá‰ª∂ÔºåÂÜçÊ∏ÖÁ©∫ÂéüÊñá‰ª∂ÔºåÂõ†Ê≠§Ôºå‰∏ÄÂÆö‰ºöÂØºËá¥IOÁöÑ‰∏äÂçá„ÄÇ ÂÖ∂ÂÆûÔºåÈóÆÈ¢òÁöÑËøáÁ®ã‰∏≠ÔºåËøòÊúâ‰∏Ä‰∏™ÁñëÊÉëÔºåÊàë‰ª¨ËÆ§‰∏∫Á∫øÁ®ãË¢´IOÈòªÂ°ûÔºåÁ∫øÁ®ãÊ±†Ë¢´ÊíëÂºÄÔºåÂØºËá¥Á∫øÁ®ãÂ¢ûÂ§öÔºå‰∫éÊòØÔºåÊàë‰ª¨Êü•Áúã‰∫Ü‰∏Ä‰∏ãTomcatÁ∫øÁ®ãÊ±†ÁöÑËÆæÁΩÆÔºåÊàë‰ª¨ÂèëÁé∞TomcatÁ∫øÁ®ãÊ±†ËÆæÁΩÆ‰∫Ü800ÔºåÊåâÁêÜËØ¥ÔºåÊ∞∏Ëøú‰∏ç‰ºöË∂ÖËøá1024„ÄÇ 12345&lt;Connector port="8080" maxThreads="800" minSpareThreads="25" maxSpareThreads="75" enableLookups="false" redirectPort="8443" acceptCount="100" debug="0" connectionTimeout="20000" disableUploadTimeout="true" /&gt; ÂÖ≥ÈîÆÂú®‰∫éÔºåÁ¨îËÄÖÊâÄÂú®ÁöÑÊîØ‰ªòÂπ≥Âè∞ÊúçÂä°ÂåñÊû∂ÊûÑ‰∏≠Ôºå‰ΩøÁî®‰∫Ü‰∏§Â•óÊúçÂä°ÂåñÊ°ÜÊû∂Ôºå‰∏Ä‰∏™ÊòØÂü∫‰∫édubboÁöÑÊ°ÜÊû∂Ôºå‰∏Ä‰∏™ÊòØÁÇπÂØπÁÇπÁöÑRPCÔºåÁî®Êù•Á¥ßÊÄ•ÊÉÖÂÜµ‰∏ãdubboÊúçÂä°Âá∫Áé∞ÈóÆÈ¢òÔºåÊúçÂä°ÈôçÁ∫ß‰ΩøÁî®„ÄÇ ÊØè‰∏™ÊúçÂä°ÈÉΩÈÖçÁΩÆ‰∫ÜÁÇπÂØπÁÇπÁöÑRPCÊúçÂä°ÔºåÂπ∂‰∏îÁã¨‰∫´‰∏Ä‰∏™Á∫øÁ®ãÊ±†Ôºö 12345&lt;Connector port="8090" maxThreads="800" minSpareThreads="25" maxSpareThreads="75" enableLookups="false" redirectPort="8443" acceptCount="100" debug="0" connectionTimeout="20000" disableUploadTimeout="true" /&gt; Áî±‰∫éÊàë‰ª¨Âú®ÂØπdubboÊúçÂä°Ê°ÜÊû∂ËøõË°åÂÆöÂà∂ÂåñÁöÑÊó∂ÂÄôÔºåËÆæËÆ°‰∫ÜËá™Âä®ÈôçÁ∫ßÂéüÂàôÔºåÂ¶ÇÊûúdubboÊúçÂä°Ë¥üËΩΩÂèòÈ´òÔºå‰ºöËá™Âä®ÂàáÊç¢Âà∞ÁÇπÂØπÁÇπÁöÑRPCÊ°ÜÊû∂ÔºåËøô‰πüÁ¨¶ÂêàÂæÆÊúçÂä°ÁöÑÂ§±ÊïàËΩ¨ÁßªÂéüÂàôÔºå‰ΩÜÊòØËÆæËÆ°‰∏≠Ê≤°ÊúâËøõË°åÂÖ®Èù¢ÁöÑËÄÉËôëÔºå‰∏ÄÊó¶‰∏ÄÈÉ®ÂàÜÊúçÂä°ÂàáÊç¢Âà∞‰∫ÜÁÇπÂØπÁÇπÁöÑRPCÔºåËÄå‰∏ÄÈÉ®ÂàÜÁöÑÊúçÂä°Ê≤°ÊúâÂàáÊç¢ÔºåÂ∞±ÂØºËá¥‰∏§‰∏™Áé∞Âú∫Ê±†ÈÉΩË¢´ÊíëÊª°Ôºå‰∫éÊòØË∂ÖËøá‰∫Ü1024ÁöÑÈôêÂà∂ÔºåÂ∞±Âá∫‰∫ÜÈóÆÈ¢ò„ÄÇ Âà∞ËøôÈáåÔºåÊàë‰ª¨Âü∫Êú¨ÂèØ‰ª•È™åËØÅÔºåÈóÆÈ¢òÁöÑÊ†πÊ∫êÊòØÊó•ÂøóÂàáÂâ≤ÂØºËá¥IOË¥üËΩΩÂ¢ûÂä†ÔºåÁÑ∂ÂêéÈòªÂ°ûÁ∫øÁ®ãÊ±†ÔºåÊúÄÂêéÂèëÁîüOOMÔºöunable to create new native thread„ÄÇ Ââ©‰∏ãÁöÑ‰ªªÂä°Â∞±ÊòØÊúÄÂ∞èÂåñÈáçÁé∞ÁöÑÈóÆÈ¢òÔºåÈÄöËøáÂÆûË∑µÊù•È™åËØÅÈóÆÈ¢òÁöÑÂéüÂõ†„ÄÇÊàë‰ª¨‰∏éÊÄßËÉΩÂéãÊµãÈÉ®Èó®Ê≤üÈÄöÔºåÊèêÂá∫ÂéãÊµãÈúÄÊ±ÇÔºö TomcatÁ∫øÁ®ãÊ±†ÊúÄÂ§ßËÆæÁΩÆ‰∏∫1500. Êìç‰ΩúÁ≥ªÁªüÂÖÅËÆ∏ÁöÑÊúÄÂ§ßÁî®Êà∑ËøõÁ®ãÊï∞1024. Âú®ÁªôÊúçÂä°Âä†ÂéãÁöÑËøáÁ®ã‰∏≠ÔºåÈúÄË¶Å‰∫∫Â∑•Âà∂ÈÄ†ÁπÅÂøôÁöÑIOÊìç‰ΩúÔºåIOÁ≠âÂæÖ‰∏çÂæó‰Ωé‰∫é50%„ÄÇ ÁªèËøáÂéãÊµãÂéãÊµãÈÉ®Èó®ÁöÑ‰∏Ä‰∏ãÂçàÂä™ÂäõÔºåÁéØÂ¢ÉÊêûÂÆöÔºåÁªìÊûúËØÅÊòéÂÆåÂÖ®ÂèØ‰ª•ÈáçÁé∞Ê≠§ÈóÆÈ¢ò„ÄÇ ÊúÄÂêéÔºå‰∏éÊâÄÊúâÁõ∏ÂÖ≥ÈÉ®Èó®ËÆ®ËÆ∫ÂíåÂ§çÁõòÔºåÂ∫îÁî®Ëß£ÂÜ≥ÊñπÊ°àÔºåËß£ÂÜ≥ÊñπÊ°àÂåÖÊã¨Ôºö ÂÖ®ÈÉ®Â∫îÁî®ÊîπÊàêÊåâÁÖßÂ∞èÊó∂ÂàáÂâ≤ÔºåÊàñËÄÖÁõ¥Êé•‰ΩøÁî®log4jÁöÑÊó•ÂøóÊªöÂä®ÂäüËÉΩ„ÄÇ TomcatÁ∫øÁ®ãÊ±†ÁöÑÁ∫øÁ®ãÊï∞ËÆæÁΩÆ‰∏éÊìç‰ΩúÁ≥ªÁªüÁöÑÁ∫øÁ®ãÊï∞ËÆæÁΩÆ‰∏çÂêàÁêÜÔºåÈÄÇÂΩìÁöÑÂáèÂ∞ëTomcatÁ∫øÁ®ãÊ±†Á∫øÁ®ãÊï∞ÈáèÁöÑÂ§ßÂ∞è„ÄÇ ÂçáÁ∫ßlog4jÊó•ÂøóÔºå‰ΩøÁî®logbackÊàñËÄÖlog4j2„ÄÇ ËøôÊ¨°OOMÈóÆÈ¢òÁöÑÂèØ‰ª•ÂΩíÁªì‰∏∫‚ÄúÂ§ö‰∏™Âõ†„ÄÅÂ§ö‰∏™Êûú„ÄÅÂ§öÂè∞Êú∫Âô®„ÄÅÂ§ö‰∏™ÊúçÂä°Ê±†„ÄÅ‰∏çÂêåÊó∂Èó¥‚ÄùÔºåÈíàÂØπËøô‰∏™ÈóÆÈ¢òÔºå‰∏éËøêÁª¥ÈÉ®„ÄÅÁõëÊéßÈÉ®ÂíåÊÄßËÉΩÂéãÊµãÈÉ®Èó®ÁöÑÂêå‰∫ãÂ•ãÊñó‰∫ÜÂá†Â§©Âá†Â§úÔºåÁªà‰∫éÈÄöËøáÂú®Á∫ø‰∏äÊäìÂèñ‰ø°ÊÅØ„ÄÅÂàÜÊûêÈóÆÈ¢ò„ÄÅÂú®ÊÄßËÉΩÂéãÊµãÈÉ®Èó®Âêå‰∫ãÁöÑÂ∏ÆÂä©‰∏ãÔºåÊúÄÂ∞èÂåñÈáçÁé∞ÈóÆÈ¢òÂπ∂ÊâæÂà∞ÈóÆÈ¢òÁöÑÊ†πÊ∫êÂéüÂõ†ÔºåÊúÄÂêéÔºåÈíàÂØπÈóÆÈ¢ò‰∫ßÁîüÁöÑÊ†πÊ∫êÊèê‰æõ‰∫ÜÊúâÊïàÁöÑÊñπÊ°à„ÄÇ 3. ‰∏éÁõëÊéßÂêå‰∫ãÁé∞Âú∫ÁºñÂÜôÁöÑËÑöÊú¨ Êú¨ËäÇÊèê‰æõ‰∏Ä‰∏™Á¨îËÄÖÂú®ÂÆûË∑µËøáÁ®ã‰∏≠Ëß£ÂÜ≥OOMÈóÆÈ¢òÁöÑ‰∏Ä‰∏™ÁÆÄÂçïËÑöÊú¨ÔºåËøô‰∏™ËÑöÊú¨ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥OOMÔºàunable to create native thread)ÁöÑÈóÆÈ¢òËÄåÂú®ÈóÆÈ¢òÊú∫Âô®‰∏ä‰∏¥Êó∂ÁºñÂÜôÔºåÂπ∂‰∏¥Êó∂‰ΩøÁî®ÁöÑÔºåËÑöÊú¨Âπ∂Ê≤°ÊúâÂÜôÁöÑÂæà‰∏ì‰∏öÔºåÁ¨îËÄÖ‰πüÊ≤°ÊúâËøõË°å‰ºòÂåñÔºå‰øùÊåÅÂéüÊ±ÅÂéüÂë≥ÁöÑÈ£éÊ†ºÔºåËøôÊ†∑ËÉΩËÆ©ËØªËÄÖÊúâÁßçË∫´‰∏¥ÂÖ∂Â¢ÉÁöÑÊÑüËßâÔºåÂè™ÊòØ‰∏∫‰∫ÜÊäìÂèñÈúÄË¶ÅÁöÑ‰ø°ÊÅØÂπ∂Ëß£ÂÜ≥ÈóÆÈ¢òÔºå‰ΩÜÊòØÂú®Á∫ø‰∏äÈóÆÈ¢òÂçÅÂàÜÁÅ´ÊÄ•ÁöÑÊÉÖÂÜµ‰∏ãÔºåËøô‰∏™ËÑöÊú¨‰ºöÊúâÂ§ßÁî®Â§Ñ„ÄÇ 12345678#!/bin/bashps -Leo pid,lwp,user,pcpu,pmem,cmd &gt;&gt; /tmp/pthreads.logecho "ps -Leo pid,lwp,user,pcpu,pmem,cmd &gt;&gt; /tmp/pthreads.log" &gt;&gt; /tmp/pthreads.logecho `date` &gt;&gt; /tmp/pthreads.logecho 1pid=`ps aux|grep tomcat|grep cwh|awk -F ' ' '&#123;print $2&#125;'`echo 2echo "pstack $pid &gt;&gt; /tmp/pstack.log" &gt;&gt; /tmp/pstack.logpstack $pid &gt;&gt; /tmp/pstack.logecho `date` &gt;&gt; /tmp/pstack.logecho 3echo "lsof &gt;&gt; /tmp/sys-o-files.log" &gt;&gt; /tmp/sys-o-files.loglsof &gt;&gt; /tmp/sys-o-files.logecho `date` &gt;&gt; /tmp/sys-o-files.logecho 4echo "lsof -p $pid &gt;&gt; /tmp/service-o-files.log" &gt;&gt; /tmp/service-o-files.loglsof -p $pid &gt;&gt; /tmp/service-o-files.logecho `date` &gt;&gt; /tmp/service-o-files.logecho 5echo "jstack -l $pid &gt;&gt; /tmp/js.log" &gt;&gt; /tmp/js.logjstack -l -F $pid &gt;&gt; /tmp/js.logecho `date` &gt;&gt; /tmp/js.logecho 6 echo "free -m &gt;&gt; /tmp/free.log" &gt;&gt; /tmp/free.logfree -m &gt;&gt; /tmp/free.logecho `date` &gt;&gt; /tmp/free.logecho 7echo "vmstat 2 1 &gt;&gt; /tmp/vm.log" &gt;&gt; /tmp/vm.logvmstat 2 1 &gt;&gt; /tmp/vm.logecho `date` &gt;&gt; /tmp/vm.logecho 8echo "jmap -dump:format=b,file=/tmp/heap.hprof 2743" &gt;&gt; /tmp/jmap.logjmap -dump:format=b,file=/tmp/heap.hprof &gt;&gt; /tmp/jmap.logecho `date` &gt;&gt; /tmp/jmap.logecho 9echo end Â¶ÇÊûúËØªËÄÖÂú®Á∫ø‰∏äÂ∑≤ÁªèÈÅáÂà∞‰∫ÜOOMÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•È°∫ÁùÄËøô‰∏™Áúã‰ººÁÆÄÈôãËÄåÂèà‰ø°ÊÅØÊª°Êª°ÁöÑJavaÊúçÂä°ÁöÑÁõëÊéßËÑöÊú¨ÁöÑÊÄùË∑ØÔºåÂà©Áî®Êú¨ÊñáÊèê‰æõÁöÑÂêÑÁßçËÑöÊú¨ÂíåÂëΩ‰ª§Êù•Ê∑±ÊåñÈóÆÈ¢òÁöÑÊ†πÊú¨ÂéüÂõ†„ÄÇ]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á∫ø‰∏äÊúçÂä°ÂÜÖÂ≠òOOMÈóÆÈ¢òÂÆö‰Ωç‰∏âÊùøÊñß]]></title>
    <url>%2F2018%2F05%2F13%2F%E7%BA%BF%E4%B8%8A%E6%9C%8D%E5%8A%A1%E5%86%85%E5%AD%98OOM%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D%E4%B8%89%E6%9D%BF%E6%96%A7%2F</url>
    <content type="text"><![CDATA[Áõ∏‰ø°Â§ßÂÆ∂ÈÉΩÊúâÊÑüËß¶ÔºåÁ∫ø‰∏äÊúçÂä°ÂÜÖÂ≠òOOMÁöÑÈóÆÈ¢òÔºåÊòØÊúÄÈöæÂÆö‰ΩçÁöÑÈóÆÈ¢òÔºå‰∏çËøáÂΩíÊ†πÁªìÂ∫ïÔºåÊúÄÂ∏∏ËßÅÁöÑÂéüÂõ†Ôºö Êú¨Ë∫´ËµÑÊ∫ê‰∏çÂ§ü Áî≥ËØ∑ÁöÑÂ§™Â§ö ËµÑÊ∫êËÄóÂ∞Ω È¢òÁõÆ ÊüêÊúçÂä°Âô®‰∏äÈÉ®ÁΩ≤‰∫ÜJavaÊúçÂä°‰∏ÄÊûöÔºåÂá∫Áé∞‰∫ÜOutOfMemoryErrorÔºåËØ∑ÈóÆÊúâÂèØËÉΩÊòØ‰ªÄ‰πàÂéüÂõ†ÔºåÈóÆÈ¢òÂ∫îËØ•Â¶Ç‰ΩïÂÆö‰ΩçÔºü ‰∏çÂ¶®ËÆæÊúçÂä°ËøõÁ®ãPID‰∏∫10765 Ëß£ÂÜ≥ÊÄùË∑Ø JavaÊúçÂä°OOMÔºåÊúÄÂ∏∏ËßÅÁöÑÂéüÂõ†‰∏∫Ôºö ÊúâÂèØËÉΩÊòØÂÜÖÂ≠òÂàÜÈÖçÁ°ÆÂÆûËøáÂ∞èÔºåËÄåÊ≠£Â∏∏‰∏öÂä°‰ΩøÁî®‰∫ÜÂ§ßÈáèÂÜÖÂ≠ò Êüê‰∏Ä‰∏™ÂØπË±°Ë¢´È¢ëÁπÅÁî≥ËØ∑ÔºåÂç¥Ê≤°ÊúâÈáäÊîæÔºåÂÜÖÂ≠ò‰∏çÊñ≠Ê≥ÑÊºèÔºåÂØºËá¥ÂÜÖÂ≠òËÄóÂ∞Ω Êüê‰∏Ä‰∏™ËµÑÊ∫êË¢´È¢ëÁπÅÁî≥ËØ∑ÔºåÁ≥ªÁªüËµÑÊ∫êËÄóÂ∞ΩÔºå‰æãÂ¶ÇÔºö‰∏çÊñ≠ÂàõÂª∫Á∫øÁ®ãÔºå‰∏çÊñ≠ÂèëËµ∑ÁΩëÁªúËøûÊé• Êõ¥ÂÖ∑‰ΩìÁöÑÔºåÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÁöÑ‰∏Ä‰∫õÂ∑•ÂÖ∑ÈÄê‰∏ÄÊéíÊü•„ÄÇ ‰∏Ä„ÄÅÁ°ÆËÆ§ÊòØ‰∏çÊòØÂÜÖÂ≠òÊú¨Ë∫´Â∞±ÂàÜÈÖçËøáÂ∞èÊñπÊ≥ïÔºöjmap -heap 10765 ÂèØ‰ª•Êü•ÁúãÊñ∞Áîü‰ª£ÔºåËÄÅÁîü‰ª£Â†ÜÂÜÖÂ≠òÁöÑÂàÜÈÖçÂ§ßÂ∞è‰ª•Âèä‰ΩøÁî®ÊÉÖÂÜµÔºåÁúãÊòØÂê¶Êú¨Ë∫´ÂàÜÈÖçËøáÂ∞è„ÄÇ ‰∫å„ÄÅÊâæÂà∞ÊúÄËÄóÂÜÖÂ≠òÁöÑÂØπË±°ÊñπÊ≥ïÔºöjmap -histo:live 10765 | more ËæìÂÖ•ÂëΩ‰ª§ÂêéÔºå‰ºö‰ª•Ë°®Ê†ºÁöÑÂΩ¢ÂºèÊòæÁ§∫Â≠òÊ¥ªÂØπË±°ÁöÑ‰ø°ÊÅØÔºåÂπ∂ÊåâÁÖßÊâÄÂç†ÂÜÖÂ≠òÂ§ßÂ∞èÊéíÂ∫èÔºö ÂÆû‰æãÊï∞ ÊâÄÂç†ÂÜÖÂ≠òÂ§ßÂ∞è Á±ªÂêç ÊòØ‰∏çÊòØÂæàÁõ¥ËßÇÔºüÂØπ‰∫éÂÆû‰æãÊï∞ËæÉÂ§öÔºåÂç†Áî®ÂÜÖÂ≠òÂ§ßÂ∞èËæÉÂ§öÁöÑÂÆû‰æã/Á±ªÔºåÁõ∏ÂÖ≥ÁöÑ‰ª£Á†ÅÂ∞±Ë¶ÅÈíàÂØπÊÄßreview‰∫Ü„ÄÇ ‰∏äÂõæ‰∏≠Âç†ÂÜÖÂ≠òÊúÄÂ§öÁöÑÂØπË±°ÊòØRingBufferLogEventÔºåÂÖ±Âç†Áî®ÂÜÖÂ≠ò18MÔºåÂ±û‰∫éÊ≠£Â∏∏‰ΩøÁî®ËåÉÂõ¥„ÄÇ Â¶ÇÊûúÂèëÁé∞ÊüêÁ±ªÂØπË±°Âç†Áî®ÂÜÖÂ≠òÂæàÂ§ßÔºà‰æãÂ¶ÇÂá†‰∏™GÔºâÔºåÂæàÂèØËÉΩÊòØÁ±ªÂØπË±°ÂàõÂª∫Â§™Â§öÔºå‰∏î‰∏ÄÁõ¥Êú™ÈáäÊîæ„ÄÇ‰æãÂ¶ÇÔºö Áî≥ËØ∑ÂÆåËµÑÊ∫êÂêéÔºåÊú™Ë∞ÉÁî®close()Êàñdispose()ÈáäÊîæËµÑÊ∫ê Ê∂àË¥πËÄÖÊ∂àË¥πÈÄüÂ∫¶ÊÖ¢ÔºàÊàñÂÅúÊ≠¢Ê∂àË¥π‰∫ÜÔºâÔºåËÄåÁîü‰∫ßËÄÖ‰∏çÊñ≠ÂæÄÈòüÂàó‰∏≠ÊäïÈÄí‰ªªÂä°ÔºåÂØºËá¥ÈòüÂàó‰∏≠‰ªªÂä°Á¥ØÁßØËøáÂ§ö ‰∏â„ÄÅÁ°ÆËÆ§ÊòØÂê¶ÊòØËµÑÊ∫êËÄóÂ∞ΩÂ∑•ÂÖ∑Ôºö pstree netstat Êü•ÁúãËøõÁ®ãÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞Ôºå‰ª•ÂèäÁΩëÁªúËøûÊé•Êï∞ÔºåÂ¶ÇÊûúËµÑÊ∫êËÄóÂ∞ΩÔºå‰πüÂèØËÉΩÂá∫Áé∞OOM„ÄÇ ËøôÈáå‰ªãÁªçÂè¶‰∏ÄÁßçÊñπÊ≥ïÔºåÈÄöËøá /proc/${PID}/fd /proc/${PID}/task ÂèØ‰ª•ÂàÜÂà´Êü•ÁúãÂè•ÊüÑËØ¶ÊÉÖÂíåÁ∫øÁ®ãÊï∞„ÄÇ ‰æãÂ¶ÇÔºåÊüê‰∏ÄÂè∞Á∫ø‰∏äÊúçÂä°Âô®ÁöÑsshdËøõÁ®ãPIDÊòØ9339ÔºåÊü•Áúã ll /proc/9339/fd ll /proc/9339/task Â¶Ç‰∏äÂõæÔºåsshdÂÖ±Âç†Áî®‰∫ÜÂõõ‰∏™Âè•ÊüÑ 0 -&gt; Ê†áÂáÜËæìÂÖ• 1 -&gt; Ê†áÂáÜËæìÂá∫ 2 -&gt; Ê†áÂáÜÈîôËØØËæìÂá∫ 3 -&gt; socketÔºàÂÆπÊòìÊÉ≥Âà∞ÊòØÁõëÂê¨Á´ØÂè£Ôºâ sshdÂè™Êúâ‰∏Ä‰∏™‰∏ªÁ∫øÁ®ãPID‰∏∫9339ÔºåÂπ∂Ê≤°ÊúâÂ§öÁ∫øÁ®ã„ÄÇ ÊâÄ‰ª•ÔºåÂè™Ë¶Å ll /proc/${PID}/fd | wc -l ll /proc/${PID}/task | wc -l ÔºàÊïàÊûúÁ≠âÂêåpstree -p | wc -lÔºâ Â∞±ËÉΩÁü•ÈÅìËøõÁ®ãÊâìÂºÄÁöÑÂè•ÊüÑÊï∞ÂíåÁ∫øÁ®ãÊï∞„ÄÇ ÈôÑÔºöMATÂ∑•ÂÖ∑‰ΩøÁî®macÂÆâË£Ömat https://www.jianshu.com/p/68a657ed2286 ÊñπÊ≥ï‰∏Ä‰øÆÊîπmat.app/Contents/Eclipse/MemoryAnalyzer.ini123456789101112-startup../Eclipse/plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jar-data/Users/cdqiushengsen/Documents/mat/log--launcher.library../Eclipse/plugins/org.eclipse.equinox.launcher.cocoa.macosx.x86_64_1.1.300.v20150602-1417-vm/Library/Java/Home/jre-vmargs-Xmx1024m-Dorg.eclipse.swt.internal.carbon.smallFonts-XstartOnFirstThread ÊñπÊ≥ï‰∫åmacÂêØÂä® 1mat.app/Contents/MacOS/MemoryAnalyzer -data ./workspace ÈÖçÁΩÆËé∑ÂèñdumpÊñá‰ª∂ÔºåÈÖçÁΩÆ 1-Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryError Á§∫‰æã 1234567891011121314151617import java.util.ArrayList;import java.util.List;public class HeapDumpMain &#123; static class OOMHeapDumpObject&#123; String str ="1234567890"; &#125; public static void main(String[] args) &#123; List&lt;OOMHeapDumpObject&gt; ooms = new ArrayList&lt;OOMHeapDumpObject&gt;(); while (true) &#123; ooms.add(new OOMHeapDumpObject()); &#125; &#125;&#125; ÊâìÂºÄÁîüÊàêHeap DumpÊñá‰ª∂ Áõ¥Êé•ÁÇπÂáª‰∏ãÊñπÁöÑ Reports-&gt;Leak Suspects ÈìæÊé•Êù•ÁîüÊàêÊä•ÂëäÔºåÊü•ÁúãÂØºËá¥ÂÜÖÂ≠òÊ≥ÑÈú≤ÁöÑÁΩ™È≠ÅÁ•∏È¶ñ]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[linuxÂ∏∏Áî®ÂëΩ‰ª§]]></title>
    <url>%2F2018%2F05%2F13%2Flinux-commands%2F</url>
    <content type="text"><![CDATA[CPUÁõ∏ÂÖ≥„ÄÅËøõÁ®ãÊü•ÁúãcpuÁ°¨‰ª∂ÈÖçÁΩÆ1less /proc/cpuinfo 1234uname -a Êü•ÁúãÂÜÖÊ†∏/Êìç‰ΩúÁ≥ªÁªü/CPU‰ø°ÊÅØhead -n 1 /etc/issue Êü•ÁúãÊìç‰ΩúÁ≥ªÁªüÁâàÊú¨less /proc/cpuinfo Êü•ÁúãCPU‰ø°ÊÅØhostname Êü•ÁúãËÆ°ÁÆóÊú∫Âêç top ÂëΩ‰ª§ÂÆûÊó∂ÊòæÁ§∫ÂêÑÁßçÁ≥ªÁªüËµÑÊ∫ê‰ΩøÁî®ÊÉÖÂÜµÂèäËøõÁ®ãÁä∂ÊÄÅ 1234567ËØ¶ÁªÜÂëΩ‰ª§ÂèÇÊï∞Ôºöh: ÊòæÁ§∫Â∏ÆÂä©cÔºöÊòæÁ§∫ËØ¶ÁªÜÁöÑÂëΩ‰ª§ÂèÇÊï∞MÔºöÊåâÁÖßÂç†Áî®ÂÜÖÂ≠òÂ§ßÂ∞èÔºà%MEM ÂàóÔºâÂØπËøõÁ®ãÊéíÂ∫èÔºõPÔºöÊåâÁÖß CPU ‰ΩøÁî®Áéá( %CPU ÂàóÔºâÂØπËøõÁ®ãÊéíÂ∫èÔºõuÔºöÊòæÁ§∫ÊåáÂÆöÁî®Êà∑ÁöÑËøõÁ®ã„ÄÇÈªòËÆ§ÊòæÁ§∫ÊâÄÊúâËøõÁ®ãÔºõTÔºöÊ†πÊçÆÁ¥ØËÆ°ËøêË°åÊó∂Èó¥ÊéíÂ∫è 123456789Á¨¨‰∏ÄË°åÔºöÂΩìÂâçÊó∂Èó¥ÔºöÁ≥ªÁªüÂ∑≤ËøêË°åÊó∂Èó¥Ôºö751Â§©ÔºåÁõÆÂâç4‰∏™Áî®Êà∑Ôºå1„ÄÅ5„ÄÅ15ÂàÜÈíüÂÜÖÁöÑloadÂàÜÂà´ÊòØ0.07„ÄÅ0.02 „ÄÅ0.00Á¨¨‰∫åË°åÔºöËøõÁ®ãÊÉÖÂÜµÔºöÊÄªÂÖ±148‰∏™ÔºåÊ≠£Âú®ËøêË°åÁöÑÊúâ2‰∏™Ôºå‰ºëÁú†Êúâ139‰∏™ÔºåÂÉµÂ∞∏ËøõÁ®ã1‰∏™Á¨¨‰∏âË°åÔºöcpuÁöÑ‰ΩøÁî®ÊÉÖÂÜµÔºàÊåâÊï∞Â≠ó1ÊòæÁ§∫ÊâÄÊúâcpuÔºâÁ¨¨ÂõõË°åÔºöÂÜÖÂ≠òÊÉÖÂÜµÔºàbuffersË°®Á§∫Áî®‰ΩúÂÜÖÊ†∏ÁºìÂ≠òÁöÑÂÜÖÂ≠òÈáèÔºâÁ¨¨‰∫îË°åÔºöËôöÊãüÂÜÖÂ≠òÊÉÖÂÜµÔºàÁ≥ªÁªüÁöÑÁâ©ÁêÜÂÜÖÂ≠ò‰∏çÂ§üÁî®ÁöÑÊó∂ÂÄôÔºåÊääÁ°¨ÁõòÁ©∫Èó¥‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÁ©∫Èó¥ÈáäÊîæÂá∫Êù•Ôºå‰ª•‰æõÂΩìÂâçËøêË°åÁöÑÁ®ãÂ∫è‰ΩøÁî®ÔºâÁ¨¨ÂÖ≠Ë°åÔºöËøõÁ®ãidÔºåËôöÊãüÂÜÖÂ≠òÔºåÈ©ªÁïôÂÜÖÂ≠ò‰ΩøÁî®ÔºåcpuÔºåÂÜÖÂ≠ò‰ΩøÁî®ÁôæÂàÜÊØîÔºåËøêË°åÊó∂Èó¥,ÂëΩ‰ª§ÂèÇÊï∞Á≠â„ÄÇVIRTË°®Á§∫ËøõÁ®ãÂèØ‰ª•‰ΩøÁî®ÁöÑÂÜÖÂ≠òÊÄªÂ§ßÂ∞èÔºåVIRT=SWAP+RESÔºåÂåÖÊã¨Ëøô‰∏™ËøõÁ®ãÁúüÂÆû‰ΩøÁî®ÁöÑÂÜÖÂ≠ò, Êò†Â∞ÑËøáÁöÑÊñá‰ª∂, ÂíåÂà´ÁöÑËøõÁ®ãÂÖ±‰∫´ÁöÑÂÜÖÂ≠òÁ≠â„ÄÇRESË°®Á§∫Ëøô‰∏™ËøõÁ®ãÁúüÂÆûÂç†Áî®ÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÔºå‰∏ÄËà¨Ëøô‰∏™ÂÄºÂíåJVMÁöÑÂèÇÊï∞ÈÖçÁΩÆÊúâÂÖ≥ÔºåÂ¶ÇÊûú%MEM‰ΩøÁî®ËøáÈ´òÂàôÈúÄË¶ÅÂÖ≥Ê≥®SHRË°®Á§∫ÂèØ‰ª•ÂíåÂà´ÁöÑËøõÁ®ãÂÖ±‰∫´ÁöÑÂÜÖÂ≠òÂíåÂ∫ìÂ§ßÂ∞è„ÄÇ Êüê‰∏Ä‰∏™ËøõÁ®ã‰∏ãÁöÑÁ∫øÁ®ãËµÑÊ∫ê‰ΩøÁî®ÊÉÖÂÜµÔºö 1top -p &#123;pid&#125; -H Êü•ÁúãÁ≥ªÁªüload„ÄÅcpuËµÑÊ∫êÁöÑÂÖ∂ÂÆÉÂëΩ‰ª§ 12345mpstat 1 ÔºàÊ±áÊÄªÁöÑÔºâmpstat -P ALL 1 ÔºàÊ±áÊÄªÁöÑ+ÊØè‰∏™cpuÁöÑÔºâwuptimetop -H Âíå ps -efL/ -Tel ÊòæÁ§∫ Á∫øÁ®ã ÁªüËÆ°‰∏Ä‰∏™ËøõÁ®ã‰∏ãÁöÑÁ∫øÁ®ãÊï∞123456789cat /proc/$&#123;pid&#125;/statusËøîÂõûÔºö...ÁúÅÁï•Threads: 74....ÁúÅÁï•ÂÖ∂ÂÆÉÂëΩ‰ª§Ôºötop -bH -d 3 -p &#123;pid&#125; pstree Ôºà‰ª•Ê†ëÁä∂ÂõæÁöÑÊñπÂºèÂ±ïÁé∞ËøõÁ®ã‰πãÈó¥ÁöÑÊ¥æÁîüÂÖ≥Á≥ªÔºâLinuxÂëΩ‰ª§Â§ßÂÖ® 12pstree -ppstree -p &#123;pid&#125; | wc -l pstack ÔºàÊòæÁ§∫ÊØè‰∏™ËøõÁ®ãÁöÑÊ†àË∑üË∏™ÔºâÔºå‰πüÂèØ‰ª•Êü•Áúã‰∏Ä‰∏™ËøõÁ®ã‰∏ãÁöÑÁ∫øÁ®ãÊÄªÊï∞ 123pstack &#123;pid&#125;// ËæìÂá∫Á¨¨‰∏ÄË°åpstack &#123;pid&#125; | head -1 Êü•ÁúãÊâÄÊúâËøõÁ®ã12ps -efps -ef|grep java 5„ÄÅÂØπ‰∫éJavaÂ∫îÁî®‰ªéÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢ËßÇÂØüÔºåÂ∞±Âè™ÊúâËøõÁ®ãÂíåÁ∫øÁ®ã‰∏§‰∏™ÊåáÊ†áÔºå‰ªª‰Ωï‰∏úË•øÂú®Êìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢ÈÉΩÊòØ‰ª•Êñá‰ª∂ÁöÑÂΩ¢ÂºèÂ≠òÂÇ®ÁöÑÔºåËøõÁ®ã‰πü‰∏ç‰æãÂ§ñ„ÄÇLinux‰∏äÈÉ®ÁΩ≤‰∏Ä‰∏™TomcatÁ®ãÂ∫è‰∫ßÁîü‰∏Ä‰∏™ËøõÁ®ãÔºåËøô‰∏™ËøõÁ®ãÊâÄÊúâÁöÑ‰∏úË•øÈÉΩÂú®Ëøô‰∏™ÁõÆÂΩï‰∏ã ll /proc/{pid}/ 12## ÂèØ‰ª•Êü•ÁúãÊâÄÊúâÁöÑsocketËøûÊé•ll /proc/&#123;pid&#125;/fd | grep socket ulimit -a ÔºàÊòæÁ§∫ÂΩìÂâçÁöÑÂêÑÁßçÁî®Êà∑ËøõÁ®ãÈôêÂà∂Ôºâlinux‰øÆÊîπmax user processes limits 12345678910111213141516ulimit -acore file size (blocks, -c) 100data seg size (kbytes, -d) unlimitedfile size (blocks, -f) unlimitedpending signals (-i) 15237max locked memory (kbytes, -l) 64max memory size (kbytes, -m) unlimitedopen files (-n) 1024pipe size (512 bytes, -p) 8POSIX message queues (bytes, -q) 819200stack size (kbytes, -s) 8192cpu time (seconds, -t) unlimitedmax user processes (-u) 15237virtual memory (kbytes, -v) unlimitedfile locks (-x) unlimited 12345678910111213141516ËæìÂá∫ÁöÑÊØè‰∏ÄË°åÁî±ËµÑÊ∫êÂêçÂ≠ó„ÄÅÔºàÂçï‰ΩçÔºåulimitÂëΩ‰ª§ÁöÑÂèÇÊï∞Ôºâ„ÄÅËΩØÈôêÂà∂ÁªÑÊàê„ÄÇËØ¶ÁªÜËß£ÈáäÔºöÂèÇÊï∞ ÊèèËø∞core file size coreÊñá‰ª∂ÁöÑÊúÄÂ§ßÂÄº‰∏∫100 blocksÔºådata seg size ËøõÁ®ãÁöÑÊï∞ÊçÆÊÆµÂèØ‰ª•‰ªªÊÑèÂ§ßfile size Êñá‰ª∂ÂèØ‰ª•‰ªªÊÑèÂ§ßpending signals ÊúÄÂ§öÊúâ15237‰∏™ÂæÖÂ§ÑÁêÜÁöÑ‰ø°Âè∑max locked memory ‰∏Ä‰∏™‰ªªÂä°ÈîÅ‰ΩèÁöÑÁâ©ÁêÜÂÜÖÂ≠òÁöÑÊúÄÂ§ßÂÄº‰∏∫64kBmax memory size ‰∏Ä‰∏™‰ªªÂä°ÁöÑÂ∏∏È©ªÁâ©ÁêÜÂÜÖÂ≠òÁöÑÊúÄÂ§ßÂÄºopen files ‰∏Ä‰∏™‰ªªÂä°ÊúÄÂ§öÂèØ‰ª•ÂêåÊó∂ÊâìÂºÄ1024ÁöÑÊñá‰ª∂pipe size ÁÆ°ÈÅìÁöÑÊúÄÂ§ßÁ©∫Èó¥‰∏∫4096Â≠óËäÇPOSIX message queues POSIXÁöÑÊ∂àÊÅØÈòüÂàóÁöÑÊúÄÂ§ßÂÄº‰∏∫819200Â≠óËäÇstack size ËøõÁ®ãÁöÑÊ†àÁöÑÊúÄÂ§ßÂÄº‰∏∫8192Â≠óËäÇcpu time ËøõÁ®ã‰ΩøÁî®ÁöÑCPUÊó∂Èó¥max user processes ÂΩìÂâçÁî®Êà∑ÂêåÊó∂ÊâìÂºÄÁöÑËøõÁ®ã(ÂåÖÊã¨Á∫øÁ®ã)ÁöÑÊúÄÂ§ß‰∏™Êï∞‰∏∫15237virtual memory Ê≤°ÊúâÈôêÂà∂ËøõÁ®ãÁöÑÊúÄÂ§ßÂú∞ÂùÄÁ©∫Èó¥file locks ÊâÄËÉΩÈîÅ‰ΩèÁöÑÊñá‰ª∂ÁöÑÊúÄÂ§ß‰∏™Êï∞Ê≤°ÊúâÈôêÂà∂ ÂÜÖÂ≠òÁõ∏ÂÖ≥vmstatVirtual Memory StatisticsÔºåÁªüËÆ°ËøõÁ®ã„ÄÅÂÜÖÂ≠ò„ÄÅio„ÄÅcpuÁ≠âÁöÑÊ¥ªÂä®‰ø°ÊÅØ„ÄÇÂØπ‰∫éÂ§öCPUÁ≥ªÁªüÔºåvmstatÊâìÂç∞ÁöÑÊòØÊâÄÊúâCPUÁöÑÂπ≥ÂùáËæìÂá∫ 12345678910111213141516171819202122procsr: ËøêË°åÈòüÂàó‰∏≠ËøõÁ®ãÊï∞Èáèb: Á≠âÂæÖIOÁöÑËøõÁ®ãÊï∞Èáèmemoryswpd: ‰ΩøÁî®ËôöÊãüÂÜÖÂ≠òÂ§ßÂ∞èfree: ÂèØÁî®ÂÜÖÂ≠òÂ§ßÂ∞èbuff: Áî®‰ΩúÁºìÂÜ≤ÁöÑÂÜÖÂ≠òÂ§ßÂ∞ècache: Áî®‰ΩúÁºìÂ≠òÁöÑÂÜÖÂ≠òÂ§ßÂ∞èswapsi: ÊØèÁßí‰ªé‰∫§Êç¢Âå∫ÂÜôÂà∞ÂÜÖÂ≠òÁöÑÂ§ßÂ∞èso: ÊØèÁßí‰ªéÂÜÖÂ≠òÂÜôÂÖ•‰∫§Êç¢Âå∫ÁöÑÂ§ßÂ∞èiobi: ÊØèÁßíËØªÂèñÁöÑÂùóÊï∞ÔºàÁé∞Âú®ÁöÑLinuxÁâàÊú¨ÂùóÁöÑÂ§ßÂ∞è‰∏∫1024bytesÔºâbo: ÊØèÁßíÂÜôÂÖ•ÁöÑÂùóÊï∞systemin: ÊØèÁßí‰∏≠Êñ≠Êï∞ÔºåÂåÖÊã¨Êó∂Èíü‰∏≠Êñ≠cs: ÊØèÁßí‰∏ä‰∏ãÊñáÂàáÊç¢Êï∞cpuÔºà‰ª•ÁôæÂàÜÊØîË°®Á§∫Ôºâus: Áî®Êà∑ËøõÁ®ãÊâßË°åÊó∂Èó¥(user time)sy: Á≥ªÁªüËøõÁ®ãÊâßË°åÊó∂Èó¥(system time)id: Á©∫Èó≤Êó∂Èó¥(ÂåÖÊã¨IOÁ≠âÂæÖÊó∂Èó¥)wa: Á≠âÂæÖIOÊó∂Èó¥ Ê≥®ÊÑèÔºöÊéíÊü•ÈóÆÈ¢òÊó∂ÔºåË¶ÅÁâπÂà´ÂÖ≥Ê≥®rÁöÑÂÄºÔºåÂ¶ÇÊûúÈïøÊó∂Èó¥Ë∂ÖËøácpuÊ†∏Êï∞2ÂÄçÔºåËØ¥ÊòéÁ≥ªÁªüÁöÑË¥üËΩΩÂæàÈáçÔºåcpuÂ∑≤ÁªèÊó†Ê≥ïÂèäÊó∂Â§ÑÁêÜÂ†ÜÁßØ‰ªªÂä°„ÄÇ IOÂèäÁΩëÁªúÁΩëÁªúÂçèËÆÆOSI ‰∏ÉÂ±ÇÊ®°Âûã ÔºàÂ∫îË°®‰ºöÔºå‰º†ÁΩëÊï∞Áâ©Ôºâ Â∫îÁî®Â±Ç APDUÂ∫îÁî®ÂçèËÆÆÊï∞ÊçÆÂçïÂÖÉ Â∫îÁî®ÂçèËÆÆÊï∞ÊçÆÂçïÂÖÉ Áî®Êà∑Êé•Âè£ Ë°®Á§∫Â±Ç PPDU Êï∞ÊçÆÁöÑË°®Áé∞ÂΩ¢ÂºèÔºåÂéãÁº©„ÄÅÂä†ÂØÜ ‰ºöËØùÂ±Ç SPDU ‰ºöËØùÁöÑÁÆ°ÁêÜ„ÄÅÂêåÊ≠• ‰∏ä‰∏âÂ±ÇÔºåÁªôÁî®Êà∑ ‰º†ËæìÂ±Ç TPDU TCP/UDP ÂèØÈù†‰∏é‰∏çÂèØÈù†ÁöÑ‰º†ËæìÔºåÁ°ÆÂÆöÁ´ØÂè£ ÁΩëÁªúÂ±Ç IPÂú∞ÂùÄ Êä•ÊñáÔºåÊèê‰æõÈÄªËæëÂú∞ÂùÄÔºåÈÄâË∑ØÁî± Êï∞ÊçÆÈìæË∑ØÂ±Ç ÊàêÂ∏ß„ÄÅÁî®MACÂú∞ÂùÄËÆøÈóÆÂ™í‰ªã Áâ©ÁêÜÂ±Ç Áâ©ÁêÜÂ±ÇÂçèËÆÆ ËÆæÂ§á‰πãÈó¥ÁöÑÊØîÁâπÊµÅÁöÑ‰º†Ëæì„ÄÅÁâ©ÁêÜÊé•Âè£„ÄÅÁîµÊ∞îÁâπÊÄßÁ≠â TCP/IP ÂõõÂ±ÇÂçèËÆÆÂ∏∏Áî®ÁΩëÁªúÂëΩ‰ª§Ê∏ÖÁêÜdnsÁºìÂ≠ò mac 1sudo dscacheutil -flushcache curlÂèÇËÄÉ http://aiezu.com/article/linux_curl_command.html -iËæìÂá∫ÂìçÂ∫îÂ§¥ÂíåÂÜÖÂÆπ, -bËÆæÁΩÆcookieÂÜÖÂÆπ 1curl -i -b "TSESSIONID=K5PCUJM6W-NWH6793X36IPW7Y7QWSW3-868SY2XJ-YP6" https://portal.tongdun.cn/admin/acl/userManage.json?operationType=doSearch 12345curl -i -b "TSESSIONID=K5PCUJM6W-NWH6793X36IPW7Y7QWSW3-868SY2XJ-YP6" https://oceanus.tongdun.cn/PartnerAppSelect.json?operationType=doSelectMessagecurl -i http://login-dev.tongdun.cn:8081/userLogin.htm\?loginId\=asgard.pro.06@demo.com\&amp;password\=Tongdun123450curl -i https://login.tongdun.cn/userLogin.htm\?loginId\=asgard.pro.06@demo.com\&amp;password\=Tongdun123450 tsar ‚ÄìtrafficÔºöÊòæÁ§∫ÁΩëÁªúÂ∏¶ÂÆΩnetstat12# Êü•ÁúãÁ´ØÂè£ÔºåÂèäÂÖ∂ËøõÁ®ãnetstat -tunlp | grep 8088 1234# ÊâÄÊúâTCPÈìæÊé•netstat -nat# Êü•ËØ¢dubboÁöÑÈìæÊé•ÔºåÊÄªÊï∞netstat -nat | grep ip:20880 | wc -l ÁªüËÆ°ÊØè‰∏™Áä∂ÊÄÅÁöÑÊï∞Èáè 1netstat -n | awk '/^tcp/ &#123;++state[$NF]&#125; END &#123;for(key in state) print key,"\t",state[key]&#125;' 123456TIME_WAIT 5856CLOSE_WAIT 268FIN_WAIT1 3ESTABLISHED 4837SYN_RECV 14CLOSING 1 12345-t tcp-u udp-n numericÔºå‰ΩøÁî®Êï∞Â≠óÊòæÁ§∫Ôºå‰∏çÁî®Âà´Âêç-l listening,Ê≠£Âú®ÁõëÂê¨-p programs,ÊòæÁ§∫pidÂíåÂêçÁß∞ ‰∏ÄËà¨Áî®‰∫éÊ£ÄÈ™åÊú¨Êú∫ÂêÑÁ´ØÂè£ÁöÑÁΩëÁªúËøûÊé•ÊÉÖÂÜµ„ÄÇnetstatÊòØÂú®ÂÜÖÊ†∏‰∏≠ËÆøÈóÆÁΩëÁªúÂèäÁõ∏ÂÖ≥‰ø°ÊÅØÁöÑÁ®ãÂ∫èÔºåÂÆÉËÉΩÊèê‰æõTCPËøûÊé•ÔºåTCPÂíåUDPÁõëÂê¨ÔºåËøõÁ®ãÂÜÖÂ≠òÁÆ°ÁêÜÁöÑÁõ∏ÂÖ≥Êä•Âëä„ÄÇ ÂëΩ‰ª§ÂèÇÊï∞Ôºö 123456789101112131415161718192021222324-aÊàñ‚Äìall ÊòæÁ§∫ÊâÄÊúâËøûÁ∫ø‰∏≠ÁöÑSocket„ÄÇ-A&lt;ÁΩëÁªúÁ±ªÂûã&gt;Êàñ‚Äì&lt;ÁΩëÁªúÁ±ªÂûã&gt; ÂàóÂá∫ËØ•ÁΩëÁªúÁ±ªÂûãËøûÁ∫ø‰∏≠ÁöÑÁõ∏ÂÖ≥Âú∞ÂùÄ„ÄÇ-cÊàñ‚Äìcontinuous ÊåÅÁª≠ÂàóÂá∫ÁΩëÁªúÁä∂ÊÄÅ„ÄÇ-CÊàñ‚Äìcache ÊòæÁ§∫Ë∑ØÁî±Âô®ÈÖçÁΩÆÁöÑÂø´Âèñ‰ø°ÊÅØ„ÄÇ-eÊàñ‚Äìextend ÊòæÁ§∫ÁΩëÁªúÂÖ∂‰ªñÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇ-FÊàñ‚Äìfib ÊòæÁ§∫FIB„ÄÇ-gÊàñ‚Äìgroups ÊòæÁ§∫Â§öÈáçÂπøÊí≠ÂäüËÉΩÁæ§ÁªÑÁªÑÂëòÂêçÂçï„ÄÇ-hÊàñ‚Äìhelp Âú®Á∫øÂ∏ÆÂä©„ÄÇ-iÊàñ‚Äìinterfaces ÊòæÁ§∫ÁΩëÁªúÁïåÈù¢‰ø°ÊÅØË°®Âçï„ÄÇ-lÊàñ‚Äìlistening ÊòæÁ§∫ÁõëÊéß‰∏≠ÁöÑÊúçÂä°Âô®ÁöÑSocket„ÄÇ-MÊàñ‚Äìmasquerade ÊòæÁ§∫‰º™Ë£ÖÁöÑÁΩëÁªúËøûÁ∫ø„ÄÇ-nÊàñ‚Äìnumeric Áõ¥Êé•‰ΩøÁî®IPÂú∞ÂùÄÔºåËÄå‰∏çÈÄöËøáÂüüÂêçÊúçÂä°Âô®„ÄÇ-NÊàñ‚ÄìnetlinkÊàñ‚Äìsymbolic ÊòæÁ§∫ÁΩëÁªúÁ°¨‰ª∂Â§ñÂõ¥ËÆæÂ§áÁöÑÁ¨¶Âè∑ËøûÊé•ÂêçÁß∞„ÄÇ-oÊàñ‚Äìtimers ÊòæÁ§∫ËÆ°Êó∂Âô®„ÄÇ-pÊàñ‚Äìprograms ÊòæÁ§∫Ê≠£Âú®‰ΩøÁî®SocketÁöÑÁ®ãÂ∫èËØÜÂà´Á†ÅÂíåÁ®ãÂ∫èÂêçÁß∞„ÄÇ-rÊàñ‚Äìroute ÊòæÁ§∫Routing Table„ÄÇ-sÊàñ‚Äìstatistice ÊòæÁ§∫ÁΩëÁªúÂ∑•‰Ωú‰ø°ÊÅØÁªüËÆ°Ë°®„ÄÇ-tÊàñ‚Äìtcp ÊòæÁ§∫TCP‰º†ËæìÂçèËÆÆÁöÑËøûÁ∫øÁä∂ÂÜµ„ÄÇ-uÊàñ‚Äìudp ÊòæÁ§∫UDP‰º†ËæìÂçèËÆÆÁöÑËøûÁ∫øÁä∂ÂÜµ„ÄÇ-vÊàñ‚Äìverbose ÊòæÁ§∫Êåá‰ª§ÊâßË°åËøáÁ®ã„ÄÇ-VÊàñ‚Äìversion ÊòæÁ§∫ÁâàÊú¨‰ø°ÊÅØ„ÄÇ-wÊàñ‚Äìraw ÊòæÁ§∫RAW‰º†ËæìÂçèËÆÆÁöÑËøûÁ∫øÁä∂ÂÜµ„ÄÇ-xÊàñ‚Äìunix Ê≠§ÂèÇÊï∞ÁöÑÊïàÊûúÂíåÊåáÂÆö‚Äù-A unix‚ÄùÂèÇÊï∞Áõ∏Âêå„ÄÇ‚ÄìipÊàñ‚Äìinet Ê≠§ÂèÇÊï∞ÁöÑÊïàÊûúÂíåÊåáÂÆö‚Äù-A inet‚ÄùÂèÇÊï∞Áõ∏Âêå„ÄÇ ËæìÂá∫ÁªìÊûúÔºö 123456789101112131415161718‰∏Ä‰∏™ÊòØActive Internet connectionsÔºåÁß∞‰∏∫ÊúâÊ∫êTCPËøûÊé•ÔºåÂÖ∂‰∏≠"Recv-Q"Âíå"Send-Q"ÊåáÁöÑÊòØÊé•Êî∂ÈòüÂàóÂíåÂèëÈÄÅÈòüÂàó„ÄÇËøô‰∫õÊï∞Â≠ó‰∏ÄËà¨ÈÉΩÂ∫îËØ•ÊòØ0„ÄÇÂ¶ÇÊûú‰∏çÊòØÂàôË°®Á§∫ËΩØ‰ª∂ÂåÖÊ≠£Âú®ÈòüÂàó‰∏≠Â†ÜÁßØ„ÄÇËøôÁßçÊÉÖÂÜµÂè™ËÉΩÂú®ÈùûÂ∏∏Â∞ëÁöÑÊÉÖÂÜµËßÅÂà∞„ÄÇÂè¶‰∏Ä‰∏™ÊòØActive UNIX domain socketsÔºåÁß∞‰∏∫ÊúâÊ∫êUnixÂüüÂ•óÊé•Âè£(ÂíåÁΩëÁªúÂ•óÊé•Â≠ó‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÂè™ËÉΩÁî®‰∫éÊú¨Êú∫ÈÄö‰ø°ÔºåÊÄßËÉΩÂèØ‰ª•ÊèêÈ´ò‰∏ÄÂÄç)„ÄÇProtoÊòæÁ§∫ËøûÊé•‰ΩøÁî®ÁöÑÂçèËÆÆ,RefCntË°®Á§∫ËøûÊé•Âà∞Êú¨Â•óÊé•Âè£‰∏äÁöÑËøõÁ®ãÂè∑,TypesÊòæÁ§∫Â•óÊé•Âè£ÁöÑÁ±ªÂûã,StateÊòæÁ§∫Â•óÊé•Âè£ÂΩìÂâçÁöÑÁä∂ÊÄÅ,PathË°®Á§∫ËøûÊé•Âà∞Â•óÊé•Âè£ÁöÑÂÖ∂ÂÆÉËøõÁ®ã‰ΩøÁî®ÁöÑË∑ØÂæÑÂêç„ÄÇÁä∂ÊÄÅËØ¥ÊòéÔºöLISTENÔºö‰æ¶Âê¨Êù•Ëá™ËøúÊñπÁöÑTCPÁ´ØÂè£ÁöÑËøûÊé•ËØ∑Ê±ÇSYN-SENTÔºöÂÜçÂèëÈÄÅËøûÊé•ËØ∑Ê±ÇÂêéÁ≠âÂæÖÂåπÈÖçÁöÑËøûÊé•ËØ∑Ê±ÇÔºàÂ¶ÇÊûúÊúâÂ§ßÈáèËøôÊ†∑ÁöÑÁä∂ÊÄÅÂåÖÔºåÊ£ÄÊü•ÊòØÂê¶‰∏≠Êãõ‰∫ÜÔºâSYN-RECEIVEDÔºöÂÜçÊî∂Âà∞ÂíåÂèëÈÄÅ‰∏Ä‰∏™ËøûÊé•ËØ∑Ê±ÇÂêéÁ≠âÂæÖÂØπÊñπÂØπËøûÊé•ËØ∑Ê±ÇÁöÑÁ°ÆËÆ§ÔºàÂ¶ÇÊúâÂ§ßÈáèÊ≠§Áä∂ÊÄÅÔºå‰º∞ËÆ°Ë¢´floodÊîªÂáª‰∫ÜÔºâESTABLISHEDÔºö‰ª£Ë°®‰∏Ä‰∏™ÊâìÂºÄÁöÑËøûÊé•FIN-WAIT-1ÔºöÁ≠âÂæÖËøúÁ®ãTCPËøûÊé•‰∏≠Êñ≠ËØ∑Ê±ÇÔºåÊàñÂÖàÂâçÁöÑËøûÊé•‰∏≠Êñ≠ËØ∑Ê±ÇÁöÑÁ°ÆËÆ§FIN-WAIT-2Ôºö‰ªéËøúÁ®ãTCPÁ≠âÂæÖËøûÊé•‰∏≠Êñ≠ËØ∑Ê±ÇCLOSE-WAITÔºöÁ≠âÂæÖ‰ªéÊú¨Âú∞Áî®Êà∑ÂèëÊù•ÁöÑËøûÊé•‰∏≠Êñ≠ËØ∑Ê±ÇCLOSINGÔºöÁ≠âÂæÖËøúÁ®ãTCPÂØπËøûÊé•‰∏≠Êñ≠ÁöÑÁ°ÆËÆ§LAST-ACKÔºöÁ≠âÂæÖÂéüÊù•ÁöÑÂèëÂêëËøúÁ®ãTCPÁöÑËøûÊé•‰∏≠Êñ≠ËØ∑Ê±ÇÁöÑÁ°ÆËÆ§Ôºà‰∏çÊòØ‰ªÄ‰πàÂ•Ω‰∏úË•øÔºåÊ≠§È°πÂá∫Áé∞ÔºåÊ£ÄÊü•ÊòØÂê¶Ë¢´ÊîªÂáªÔºâTIME-WAITÔºöÁ≠âÂæÖË∂≥Â§üÁöÑÊó∂Èó¥‰ª•Á°Æ‰øùËøúÁ®ãTCPÊé•Êî∂Âà∞ËøûÊé•‰∏≠Êñ≠ËØ∑Ê±ÇÁöÑÁ°ÆËÆ§CLOSEDÔºöÊ≤°Êúâ‰ªª‰ΩïËøûÊé•Áä∂ÊÄÅ ÊâæÂá∫ËøêË°åÂú®ÊåáÂÆöÁ´ØÂè£ÁöÑËøõÁ®ã 12netstat -anpt | grep ':20130'netstat -nat | grep "172.16.49.161:20130" ÂÖ∂ÂÆÉ‰ΩøÁî®Âú∫ÊôØ 1234567netstat -nat |awk '&#123;print $6&#125;'|sort|uniq -c ‰∏çÂêåÁΩëÁªúÁä∂ÊÄÅÁªìÊûúÁªüËÆ°netstat -anop | grep 6379 Â∫îÁî®ËøûÊé•RedisÊÉÖÂÜµnetstat -pt ËæìÂá∫‰∏≠ÊòæÁ§∫ PID ÂíåËøõÁ®ãÂêçÁß∞netstat -s Êü•ÁúãÁΩëÁªúÁªüËÆ°‰ø°ÊÅØnetstat -nu ÊòæÁ§∫ÂΩìÂâçUDPËøûÊé•Áä∂ÂÜµnetstat -nt ÊòæÁ§∫ÂΩìÂâçTCPËøûÊé•Áä∂ÂÜµnetstat -i ÊòæÁ§∫ÁΩëÂç°ÂàóË°® 3„ÄÅ iostatiostatÊòØI/O statisticsÔºàËæìÂÖ•/ËæìÂá∫ÁªüËÆ°ÔºâÁöÑÁº©ÂÜôÔºå‰∏ªË¶ÅÁöÑÂäüËÉΩÊòØÂØπÁ≥ªÁªüÁöÑÁ£ÅÁõòI/OÊìç‰ΩúËøõË°åÁõëËßÜ„ÄÇÂÆÉÁöÑËæìÂá∫‰∏ªË¶ÅÊòæÁ§∫Á£ÅÁõòËØªÂÜôÊìç‰ΩúÁöÑÁªüËÆ°‰ø°ÊÅØÔºåÂêåÊó∂‰πü‰ºöÁªôÂá∫CPU‰ΩøÁî®ÊÉÖÂÜµ„ÄÇÂêåvmstat‰∏ÄÊ†∑Ôºåiostat‰πü‰∏çËÉΩÂØπÊüê‰∏™ËøõÁ®ãËøõË°åÊ∑±ÂÖ•ÂàÜÊûêÔºå‰ªÖÂØπÁ≥ªÁªüÁöÑÊï¥‰ΩìÊÉÖÂÜµËøõË°åÂàÜÊûê„ÄÇ ÂëΩ‰ª§ÂèÇÊï∞Ôºö 12345678910-c ÊòæÁ§∫CPU‰ΩøÁî®ÊÉÖÂÜµ-d ÊòæÁ§∫Á£ÅÁõò‰ΩøÁî®ÊÉÖÂÜµ-k ‰ª• KB ‰∏∫Âçï‰ΩçÊòæÁ§∫-m ‰ª• M ‰∏∫Âçï‰ΩçÊòæÁ§∫-N ÊòæÁ§∫Á£ÅÁõòÈòµÂàó(LVM) ‰ø°ÊÅØ-n ÊòæÁ§∫NFS ‰ΩøÁî®ÊÉÖÂÜµ-p[Á£ÅÁõò] ÊòæÁ§∫Á£ÅÁõòÂíåÂàÜÂå∫ÁöÑÊÉÖÂÜµ-t ÊòæÁ§∫ÁªàÁ´ØÂíåCPUÁöÑ‰ø°ÊÅØ-x ÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØ-V ÊòæÁ§∫ÁâàÊú¨‰ø°ÊÅØ ËæìÂá∫ÁªìÊûúÔºö 1234567891011121314151617181920212223242526272829cpuÂ±ûÊÄßÂÄºËØ¥ÊòéÔºö%userÔºöCPUÂ§ÑÂú®Áî®Êà∑Ê®°Âºè‰∏ãÁöÑÊó∂Èó¥ÁôæÂàÜÊØî„ÄÇ%niceÔºöCPUÂ§ÑÂú®Â∏¶NICEÂÄºÁöÑÁî®Êà∑Ê®°Âºè‰∏ãÁöÑÊó∂Èó¥ÁôæÂàÜÊØî„ÄÇ%systemÔºöCPUÂ§ÑÂú®Á≥ªÁªüÊ®°Âºè‰∏ãÁöÑÊó∂Èó¥ÁôæÂàÜÊØî„ÄÇ%iowaitÔºöCPUÁ≠âÂæÖËæìÂÖ•ËæìÂá∫ÂÆåÊàêÊó∂Èó¥ÁöÑÁôæÂàÜÊØî„ÄÇ%stealÔºöÁÆ°ÁêÜÁ®ãÂ∫èÁª¥Êä§Âè¶‰∏Ä‰∏™ËôöÊãüÂ§ÑÁêÜÂô®Êó∂ÔºåËôöÊãüCPUÁöÑÊó†ÊÑèËØÜÁ≠âÂæÖÊó∂Èó¥ÁôæÂàÜÊØî„ÄÇ%idleÔºöCPUÁ©∫Èó≤Êó∂Èó¥ÁôæÂàÜÊØî„ÄÇÂ§áÊ≥®ÔºöÂ¶ÇÊûú%iowaitÁöÑÂÄºËøáÈ´òÔºåË°®Á§∫Á°¨ÁõòÂ≠òÂú®I/OÁì∂È¢àÔºå%idleÂÄºÈ´òÔºåË°®Á§∫CPUËæÉÁ©∫Èó≤ÔºåÂ¶ÇÊûú%idleÂÄºÈ´ò‰ΩÜÁ≥ªÁªüÂìçÂ∫îÊÖ¢Êó∂ÔºåÊúâÂèØËÉΩÊòØCPUÁ≠âÂæÖÂàÜÈÖçÂÜÖÂ≠òÔºåÊ≠§Êó∂Â∫îÂä†Â§ßÂÜÖÂ≠òÂÆπÈáè„ÄÇ%idleÂÄºÂ¶ÇÊûúÊåÅÁª≠‰Ωé‰∫é10ÔºåÈÇ£‰πàÁ≥ªÁªüÁöÑCPUÂ§ÑÁêÜËÉΩÂäõÁõ∏ÂØπËæÉ‰ΩéÔºåË°®ÊòéÁ≥ªÁªü‰∏≠ÊúÄÈúÄË¶ÅËß£ÂÜ≥ÁöÑËµÑÊ∫êÊòØCPU„ÄÇdiskÂ±ûÊÄßÂÄºËØ¥ÊòéÔºöÔºàiostat -xÔºârrqm/s: ÊØèÁßíËøõË°å merge ÁöÑËØªÊìç‰ΩúÊï∞ÁõÆ„ÄÇÂç≥ rmerge/swrqm/s: ÊØèÁßíËøõË°å merge ÁöÑÂÜôÊìç‰ΩúÊï∞ÁõÆ„ÄÇÂç≥ wmerge/sr/s: ÊØèÁßíÂÆåÊàêÁöÑËØª I/O ËÆæÂ§áÊ¨°Êï∞„ÄÇÂç≥ rio/sw/s: ÊØèÁßíÂÆåÊàêÁöÑÂÜô I/O ËÆæÂ§áÊ¨°Êï∞„ÄÇÂç≥ wio/srsec/s: ÊØèÁßíËØªÊâáÂå∫Êï∞„ÄÇÂç≥ rsect/swsec/s: ÊØèÁßíÂÜôÊâáÂå∫Êï∞„ÄÇÂç≥ wsect/srkB/s: ÊØèÁßíËØªKÂ≠óËäÇÊï∞„ÄÇÊòØ rsect/s ÁöÑ‰∏ÄÂçäÔºåÂõ†‰∏∫ÊØèÊâáÂå∫Â§ßÂ∞è‰∏∫512Â≠óËäÇ„ÄÇwkB/s: ÊØèÁßíÂÜôKÂ≠óËäÇÊï∞„ÄÇÊòØ wsect/s ÁöÑ‰∏ÄÂçä„ÄÇavgrq-sz: Âπ≥ÂùáÊØèÊ¨°ËÆæÂ§áI/OÊìç‰ΩúÁöÑÊï∞ÊçÆÂ§ßÂ∞è (ÊâáÂå∫)„ÄÇavgqu-sz: Âπ≥ÂùáI/OÈòüÂàóÈïøÂ∫¶„ÄÇawait: Âπ≥ÂùáÊØèÊ¨°ËÆæÂ§áI/OÊìç‰ΩúÁöÑÁ≠âÂæÖÊó∂Èó¥ (ÊØ´Áßí)„ÄÇsvctm: Âπ≥ÂùáÊØèÊ¨°ËÆæÂ§áI/OÊìç‰ΩúÁöÑÊúçÂä°Êó∂Èó¥ (ÊØ´Áßí)„ÄÇ%util: ‰∏ÄÁßí‰∏≠ÊúâÁôæÂàÜ‰πãÂ§öÂ∞ëÁöÑÊó∂Èó¥Áî®‰∫é I/O Êìç‰ΩúÔºåÂç≥Ë¢´ioÊ∂àËÄóÁöÑcpuÁôæÂàÜÊØîÂ§áÊ≥®ÔºöÂ¶ÇÊûú %util Êé•Ëøë 100%ÔºåËØ¥Êòé‰∫ßÁîüÁöÑI/OËØ∑Ê±ÇÂ§™Â§öÔºåI/OÁ≥ªÁªüÂ∑≤ÁªèÊª°Ë¥üËç∑ÔºåËØ•Á£ÅÁõòÂèØËÉΩÂ≠òÂú®Áì∂È¢à„ÄÇÂ¶ÇÊûú svctm ÊØîËæÉÊé•Ëøë awaitÔºåËØ¥Êòé I/O Âá†‰πéÊ≤°ÊúâÁ≠âÂæÖÊó∂Èó¥ÔºõÂ¶ÇÊûú await ËøúÂ§ß‰∫é svctmÔºåËØ¥ÊòéI/O ÈòüÂàóÂ§™ÈïøÔºåioÂìçÂ∫îÂ§™ÊÖ¢ÔºåÂàôÈúÄË¶ÅËøõË°åÂøÖË¶Å‰ºòÂåñ„ÄÇÂ¶ÇÊûúavgqu-szÊØîËæÉÂ§ßÔºå‰πüË°®Á§∫ÊúâÂΩìÈáèioÂú®Á≠âÂæÖ„ÄÇ ÂÆöÊó∂ÊòæÁ§∫ÊâÄÊúâ‰ø°ÊÅØÔºàÊØèÈöî 2ÁßíÂà∑Êñ∞ÊòæÁ§∫Ôºå‰∏îÊòæÁ§∫3Ê¨°Ôºâ 1iostat 2 3 ‰ª•kB‰∏∫Âçï‰ΩçÊòæÁ§∫ÊâÄÊúâ‰ø°ÊÅØ 1iostat -k 3 4„ÄÅtraceroute1traceroute www.baidu.com 5„ÄÅtelnet ÈÄÄÂá∫Ôºåctrl+] Âá∫Áé∞telnetÂêéÔºåÂÜçËæìÂÖ•quit Êñá‰ª∂lsof (‰∏ÄÂàáÁöÜÊñá‰ª∂)ÂëΩ‰ª§ËØ¶ÊÉÖ Êü•Áúã‰Ω†ËøõÁ®ãÂºÄÊâìÁöÑÊñá‰ª∂ÔºåÊâìÂºÄÊñá‰ª∂ÁöÑËøõÁ®ãÔºåËøõÁ®ãÊâìÂºÄÁöÑÁ´ØÂè£(TCP„ÄÅUDP) 12// Êü•Áúãsys.logÊñá‰ª∂Ë¢´Âì™‰∏™ËøõÁ®ãÊâìÂºÄlsof sys.log 12// Êü•ÁúãÁ´ØÂè£Ë¢´Âì™‰∏™ËøõÁ®ãÂç†Áî®lsof -iÔºöÁ´ØÂè£Âè∑ 12// Êü•ÁúãÂêÑ‰∏™ËøõÁ®ãÊâìÂºÄÁöÑÊñá‰ª∂Êï∞Èáèlsof -n |awk '&#123;print $2&#125; " " $3'|sort|uniq -c |sort -nr|more df123df -hldf -h Êü•ÁúãÁ£ÅÁõòÁöÑ‰ΩøÁî®ÊÉÖÂÜµÁ£ÅÁõòÁöÑ‰ΩøÁî®ÊÉÖÂÜµ du12du -hlÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊúÄÂè∂Â≠êÁõÆÂΩïÁöÑÂ§ßÂ∞è 12du -sch *ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÂêÑÁõÆÂΩïÁöÑÂ§ßÂ∞è findÊñá‰ª∂Êü•Êâæ 1234567891011121314151617181920212223find . -name "*ËùôËù†‰æ†*"# ÊâæÂá∫ÂΩìÂâçÁõÆÂΩï‰ª•ÂèäÂÖ∂ÊâÄÊúâÂ≠êÁõÆÂΩï‰∏ãÊâÄÊúâÂêçÂ≠ó‰∏≠ÂåÖÂê´‚ÄúËùôËù†‰æ†‚Äù‰∏âÂ≠óÁöÑÊñá‰ª∂find . -inmae '*hello*' -maxdepth 1‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºåÂú®ÂΩìÂâçÁõÆÂΩïÊü•ÊâæÔºå‰∏çÂåÖÊã¨Â≠êÁõÆÂΩïfind . -name "*.rmvb" -maxdepth 1# ÊâæÂá∫ÂΩìÂâçÁõÆÂΩïÔºà‰∏çÂåÖÊã¨Â≠êÁõÆÂΩïÔºâ‰∏ãÊâÄÊúâÂêçÂ≠ó‰∏≠ÂêéÁºÄ‰∏∫".rmvb"ÁöÑÊñá‰ª∂find . -name sys.logÂΩìÂâçÁõÆÂΩï‰∏ãÊü•Êâæsys.logÊñá‰ª∂find . -name "sy*log"Êü•ÊâæÊñá‰ª∂ÊîØÊåÅÈÄöÈÖçÁ¨¶find . -size +20MÊü•ÊâæÂΩìÂâçÁõÆÂΩï‰∏ãÂ§ßÂ∞èË∂ÖËøá20MÁöÑÊñá‰ª∂find . -size +20M | xargs ls -lhÊü•ÊâæÂΩìÂâçÁõÆÂΩï‰∏ãÂ§ßÂ∞èË∂ÖËøá20MÁöÑÊñá‰ª∂ÔºåÂπ∂ËÆ°ÁÆóÊñá‰ª∂Â§ßÂ∞èfind -type f -printf '%s %p\n' |sort -nr | headÊü•ÊâæÂç†Áî®Á©∫Èó¥ÊúÄÂ§ßÁöÑ10‰∏™Êñá‰ª∂ grep12345--ÈÄíÂΩíÊü•ÊâæÁõÆÂΩï‰∏ãÂê´ÊúâËØ•Â≠óÁ¨¶‰∏≤ÁöÑÊâÄÊúâÊñá‰ª∂grep -rn "data_chushou_pay_info" /home/hadoop/nisj/automationDemand/--Êü•ÊâæÂΩìÂâçÁõÆÂΩï‰∏ãÂêéÁºÄÂêçËøáÊª§ÁöÑÊñá‰ª∂grep -rn "data_chushou_pay_info" *.py tail‰ªéÊåáÂÆöÁÇπÂºÄÂßãÂ∞ÜÊñá‰ª∂Ê†áÂáÜËæìÂá∫ ÊòæÁ§∫Êñá‰ª∂ÊúÄÂêé5Ë°åÂÜÖÂÆπ 1tail -n 5 test.log ÂÆûÊó∂ÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ 1tail -f test.log 12ping baidu.com &gt; 1.txt &amp;ÂêéÂè∞‰ª•ÂÆàÊä§ËøõÁ®ãÁöÑÊñπÂºèÔºåÂ∞ÜpingÂëΩ‰ª§ÁöÑËøîÂõûÁªìÊûúÂÜôÂÖ• 1.txt awk12# ÊØèË°åÊåâÁ©∫Ê†ºÊàñTABÂàÜÂâ≤ÔºåËæìÂá∫ÊñáÊú¨‰∏≠ÁöÑ1„ÄÅ4È°π awk '&#123;print $1,$4&#125;' log.txt dirnameÂú®ÂëΩ‰ª§Ë°åÁä∂ÊÄÅ‰∏ãÂçïÁ∫ØÊâßË°å1cd `dirname $0` ÊòØÊØ´Êó†ÊÑè‰πâÁöÑ„ÄÇ Âõ†‰∏∫‰ªñËøîÂõûÂΩìÂâçË∑ØÂæÑÁöÑ‚Äù.‚Äù„ÄÇËøô‰∏™ÂëΩ‰ª§ÂÜôÂú®ËÑöÊú¨Êñá‰ª∂ÈáåÊâçÊúâ‰ΩúÁî®Ôºå‰ªñËøîÂõûËøô‰∏™ËÑöÊú¨Êñá‰ª∂ÊîæÁΩÆÁöÑÁõÆÂΩïÔºåÂπ∂ÂèØ‰ª•Ê†πÊçÆËøô‰∏™ÁõÆÂΩïÊù•ÂÆö‰ΩçÊâÄË¶ÅËøêË°åÁ®ãÂ∫èÁöÑÁõ∏ÂØπ‰ΩçÁΩÆÔºàÁªùÂØπ‰ΩçÁΩÆÈô§Â§ñÔºâ„ÄÇ ÂèÇËÄÉ/Users/zhouxiaowu/Dropbox/commonShell ËøêË°å dirnameDemo.sh 1234BASE_DIR=`dirname $0`echo $BASE_DIRcd `dirname $0`echo `pwd` ËøêË°åÁªìÊûú: 12./Users/zhouxiaowu/Dropbox/commonShell ËøôÊ†∑Â∞±ÂèØ‰ª•Áü•ÈÅì‰∏Ä‰∫õÂíåËÑöÊú¨‰∏ÄËµ∑ÈÉ®ÁΩ≤ÁöÑÊñá‰ª∂ÁöÑ‰ΩçÁΩÆ‰∫ÜÔºåÂè™Ë¶ÅÁü•ÈÅìÁõ∏ÂØπ‰ΩçÁΩÆÂ∞±ÂèØ‰ª•Ê†πÊçÆËøô‰∏™ÁõÆÂΩïÊù•ÂÆö‰ΩçÔºåËÄåÂèØ‰ª•‰∏çÁî®ÂÖ≥ÂøÉÁªùÂØπ‰ΩçÁΩÆ„ÄÇËøôÊ†∑ËÑöÊú¨ÁöÑÂèØÁßªÊ§çÊÄßÂ∞±ÊèêÈ´ò‰∫ÜÔºåÊâîÂà∞‰ªª‰Ωï‰∏ÄÂè∞ÊúçÂä°Âô®ÔºåÔºàÂ¶ÇÊûúÊòØÈÉ®ÁΩ≤ËÑöÊú¨ÔºâÈÉΩÂèØ‰ª•ÊâßË°å„ÄÇ sed1sed [-hnV][-e&lt;script&gt;][-f&lt;scriptÊñá‰ª∂&gt;][ÊñáÊú¨Êñá‰ª∂] ÂèÇÊï∞ËØ¥Êòé12345- -e&lt;script&gt;Êàñ--expression=&lt;script&gt; ‰ª•ÈÄâÈ°π‰∏≠ÊåáÂÆöÁöÑscriptÊù•Â§ÑÁêÜËæìÂÖ•ÁöÑÊñáÊú¨Êñá‰ª∂„ÄÇ- -f&lt;scriptÊñá‰ª∂&gt;Êàñ--file=&lt;scriptÊñá‰ª∂&gt; ‰ª•ÈÄâÈ°π‰∏≠ÊåáÂÆöÁöÑscriptÊñá‰ª∂Êù•Â§ÑÁêÜËæìÂÖ•ÁöÑÊñáÊú¨Êñá‰ª∂„ÄÇ- -hÊàñ--help ÊòæÁ§∫Â∏ÆÂä©„ÄÇ- -nÊàñ--quietÊàñ--silent ‰ªÖÊòæÁ§∫scriptÂ§ÑÁêÜÂêéÁöÑÁªìÊûú„ÄÇ- -VÊàñ--version ÊòæÁ§∫ÁâàÊú¨‰ø°ÊÅØ„ÄÇ Âä®‰ΩúËØ¥Êòé123456- a ÔºöÊñ∞Â¢ûÔºå a ÁöÑÂêéÈù¢ÂèØ‰ª•Êé•Â≠ó‰∏≤ÔºåËÄåËøô‰∫õÂ≠ó‰∏≤‰ºöÂú®Êñ∞ÁöÑ‰∏ÄË°åÂá∫Áé∞(ÁõÆÂâçÁöÑ‰∏ã‰∏ÄË°å)ÔΩû- c ÔºöÂèñ‰ª£Ôºå c ÁöÑÂêéÈù¢ÂèØ‰ª•Êé•Â≠ó‰∏≤ÔºåËøô‰∫õÂ≠ó‰∏≤ÂèØ‰ª•Âèñ‰ª£ n1,n2 ‰πãÈó¥ÁöÑË°åÔºÅ- d ÔºöÂà†Èô§ÔºåÂõ†‰∏∫ÊòØÂà†Èô§ÂïäÔºåÊâÄ‰ª• d ÂêéÈù¢ÈÄöÂ∏∏‰∏çÊé•‰ªª‰ΩïÂíöÂíöÔºõ- i ÔºöÊèíÂÖ•Ôºå i ÁöÑÂêéÈù¢ÂèØ‰ª•Êé•Â≠ó‰∏≤ÔºåËÄåËøô‰∫õÂ≠ó‰∏≤‰ºöÂú®Êñ∞ÁöÑ‰∏ÄË°åÂá∫Áé∞(ÁõÆÂâçÁöÑ‰∏ä‰∏ÄË°å)Ôºõ- p ÔºöÊâìÂç∞Ôºå‰∫¶Âç≥Â∞ÜÊüê‰∏™ÈÄâÊã©ÁöÑÊï∞ÊçÆÂç∞Âá∫„ÄÇÈÄöÂ∏∏ p ‰ºö‰∏éÂèÇÊï∞ sed -n ‰∏ÄËµ∑ËøêË°åÔΩû- s ÔºöÂèñ‰ª£ÔºåÂèØ‰ª•Áõ¥Êé•ËøõË°åÂèñ‰ª£ÁöÑÂ∑•‰ΩúÔºåÈÄöÂ∏∏Ëøô‰∏™ s ÁöÑÂä®‰ΩúÂèØ‰ª•Êê≠ÈÖçÊ≠£ËßÑË°®Á§∫Ê≥ïÔºÅ‰æãÂ¶Ç 1,20s/old/new/g Â∞±ÊòØÂï¶ÔºÅ ÊâπÈáèÊõøÊç¢Êñá‰ª∂ÂÜÖÂÆπ12345Ê†ºÂºè: sed -i "s/Êü•ÊâæÂ≠óÊÆµ/ÊõøÊç¢Â≠óÊÆµ/g" `grep Êü•ÊâæÂ≠óÊÆµ -rl Ë∑ØÂæÑ`ÔºàcentosÊµãËØïÊúâÊïàÔºåmacÊú™ÁîüÊïàÔºâÊõøÊç¢/root/testÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÔºåbookÊõøÊç¢‰∏∫apple sed -i "s/book/apple/g" `grep book -rl /root/test` Âú®testfileÊñá‰ª∂ÁöÑÁ¨¨ÂõõË°åÂêéÊ∑ªÂä†‰∏ÄË°å 1sed -e 4a\newLine testfile ÂÖ®ÈÉ®ÊõøÊç¢ÔºåÂπ∂‰∏ç‰ºöÊîπÂèòÊñá‰ª∂ÂÜÖÂÆπ 123sed 's/book/books/g' filesed -e 's/book/books/g' file ‰ªéÁ¨¨2Â§ÑÂºÄÂßãÊõøÊç¢ 1echo sksksksksksk | sed 's/sk/SK/2g' ÂàóÂç∞Ë°åÂè∑ÔºåÂêåÊó∂ÔºåËØ∑Â∞ÜÁ¨¨ 2~5 Ë°åÂà†Èô§ 1nl /etc/passwd | sed '2,5d' Âè™Ë¶ÅÂà†Èô§Á¨¨ 2 Ë°å 1nl /etc/passwd | sed '2d' Ë¶ÅÂà†Èô§Á¨¨ 3 Âà∞ÊúÄÂêé‰∏ÄË°å 1nl /etc/passwd | sed '3,$d' Áî®Êà∑123456w Êü•ÁúãÊ¥ªÂä®Áî®Êà∑id &lt;Áî®Êà∑Âêç&gt; Êü•ÁúãÊåáÂÆöÁî®Êà∑‰ø°ÊÅØlast Êü•ÁúãÁî®Êà∑ÁôªÂΩïÊó•Âøócut -d: -f1 /etc/passwd Êü•ÁúãÁ≥ªÁªüÊâÄÊúâÁî®Êà∑cut -d: -f1 /etc/group Êü•ÁúãÁ≥ªÁªüÊâÄÊúâÁªÑcrontab -l Êü•ÁúãÂΩìÂâçÁî®Êà∑ÁöÑËÆ°Âàí‰ªªÂä° ÂëΩ‰ª§Ë°åÊìç‰Ωú123ctrl+a Ë∑≥Âà∞Ë°åÈ¶ñctrl+e Ë∑≥Âà∞Ë°åÂ∞æctrl+u Âà†Èô§Êï¥Ë°å ËæìÂá∫ÈáçÂÆöÂêë123456789101112date &gt; test.log Ê†áÂáÜËæìÂá∫Ë¶ÜÁõñÊñπÂºèdate &gt;&gt; test.log Ê†áÂáÜËæìÂá∫ËøΩÂä†ÊñπÂºèdatea 2&gt;test.log ÈîôËØØËæìÂá∫Ë¶ÜÁõñÊñπÂºèÔºå&gt;ÂêéË¶ÅÁ¥ßÊå®ÁùÄÊñá‰ª∂datea 2&gt;&gt;test.log ÈîôËØØËæìÂá∫ËøΩÂä†ÊñπÂºè,&gt;ÂêéË¶ÅÁ¥ßÊå®ÁùÄÊñá‰ª∂ifconfig &gt;&gt; test.log 2&gt;&amp;1 Â¶ÇÊûúÊòØÊ≠£Á°ÆËæìÂá∫ÁïôÁ©∫Ê†ºÔºåÈîôËØØËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫‰∏≠ÔºåÁ¥ßÊå®ÁùÄifconfig &amp;&gt;&gt; test.log ‰ª•ËøΩÂä†ÁöÑÊñπÂºèÔºåÈîôËØØÂíåÊ≠£Á°ÆÈÉΩËæìÂá∫Âà∞Êñá‰ª∂ifconfig &gt;&gt; Êñá‰ª∂1 2&gt;&gt;Êñá‰ª∂2 ‰ª•ËøΩÂä†ÁöÑÊñπÂºèÔºåÊ≠£Á°ÆÂíåÈîôËØØÂàÜÂà´Âà∞‰∏çÂêåÁöÑÊñá‰ª∂ls &amp;&gt;/dev/null Ê≠£Á°ÆÂíåÈîôËØØÈÉΩÂà∞null ËæìÂÖ•ÈáçÂÆöÂêë wcÂëΩ‰ª§ÔºåËæìÂÆåÔºåctrl+d ÁªüËÆ° wc &lt; test.log ÁªüËÆ°Êñá‰ª∂ÁöÑË°å„ÄÅÂçïËØç„ÄÅÂ≠óÁ¨¶ ÁÆ°ÈÅìÁ¨¶ÈÄªËæë‰∏éÊàñ12345678910date ; ls ; ÂàÜÂè∑ÔºåÈ°∫Â∫èÊâßË°åls &amp;&amp; date ÂëΩ‰ª§1 &amp;&amp; ÂëΩ‰ª§2 ÂëΩ‰ª§1Ê≠£Á°ÆÊâßË°åÔºåÊâç‰ºöÊâßË°å2ll || date ÂëΩ‰ª§1Ê≠£Á°ÆÊâßË°åÔºåÂëΩ‰ª§2‰∏ç‰ºöÊâßË°ålsasdfsf &amp;&amp; echo "yes" || echo "no" Âà§Êñ≠ÂëΩ‰ª§ÊòØÂê¶Ê≠£Á°Æls || echo "no" &amp;&amp; echo "yes" Á≠âÂêå‰∫é Ôºàls || echo "no"Ôºâ &amp;&amp; echo "yes" ÁÆ°ÈÅìÁ¨¶12ll | morenetstat -an | grep ESTABLISHED | wc -l ÁªüËÆ°Â§öÂ∞ëË°å ÁªüÈÖçÁ¨¶123456ls aa* * 0ÊàñÂ§ö‰∏™Â≠óÁ¨¶ls aa? ‰∏Ä‰∏™ls aa[0-9] ‰∏Ä‰∏™ÈÄâÈ°πls aa[0-9][0-9]ls aa[^0-9] ÂèñÈùûls aa[^0-9]* ÂèòÈáèÔºåÂèçÂºïÂè∑Ôºå$()1234aa=123echo $aa ËæìÂá∫123echo "$aa" 123echo '$aa' '$aa' 12aa=`ls` ÂèçÂºïÂè∑ÔºåÂÖàÊâßË°åÁªìÊûúÔºåÂÜçËµãÂÄºÂèòÈáèecho $aa $() ÂçïÂ∞èÊã¨Âè∑12aa=$(ls) ÂíåÂèçÂºïÂè∑‰∏ÄÊ†∑ÔºåÂÖàÊâßË°åÁªìÊûúÔºåÂÜçËµãÂÄºÂèòÈáèecho $aa shellËÑöÊú¨Êü•ÂΩìÂâçËÑöÊú¨ÊâÄÂú®Ë∑ØÂæÑ1script_pwd = $( cd $(dirname $0) &amp;&amp; pwd ) Êù°‰ª∂Âà§Êñ≠Êñá‰ª∂Â≠òÂú®„ÄÅÊùÉÈôêÂà§Êñ≠ [ ]1234567-d Êñá‰ª∂ÊòØÂê¶Â≠òÂú®Ôºå‰∏∫ÁõÆÂΩï-e Êñá‰ª∂ÊòØÂê¶Â≠òÂú®-f Êñá‰ª∂ÊòØÂê¶Â≠òÂú®Ôºå‰∏∫Êñá‰ª∂-r Êñá‰ª∂ÊòØÂê¶Â≠òÂú®ÔºåÊúâËØªÊùÉÈôê ‰∏ç‰ºöÂå∫ÂàÜÂΩìÂâçÁî®Êà∑ÊòØÂê¶ÊúâËØªÊùÉÈôê-w Êñá‰ª∂ÊòØÂê¶Â≠òÂú®ÔºåÊúâÂÜôÊùÉÈôê-x Êñá‰ª∂ÊòØÂê¶Â≠òÂú®ÔºåÊúâÂèØÊâßË°åÊùÉÈôê [] Âú®shell‰∏≠ÊòØ‰∏™ÂëΩ‰ª§ÔºåÂÆÉÂ∑¶Âè≥ÂøÖÈ°ªÊúâÁ©∫Ê†º,ÊâçËÉΩËØÜÂà´ÈáåÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤ 123[ -f hello.sh ] &amp;&amp; echo "yes" || echo "no" ÊµãËØïÊñá‰ª∂ÊòØÂê¶Â≠òÂú® Ê≥®ÊÑè‰∏çËÉΩÈ¢†ÂÄí &amp;&amp; || È°∫Â∫è[ -w hello.sh ] &amp;&amp; echo "yes" || echo "no" Êñá‰ª∂ÊØîËæÉ123-nf Êñ∞-ef Áõ∏Âêå-of Êóß 1[ ./hello.sh -ef ./hello.sh ] &amp;&amp; echo yes || echo no ‰∏§‰∏™Êñá‰ª∂ÊòØÂê¶Áõ∏Âêå Êï¥Êï∞ÊØîËæÉ123456-eq Áõ∏Á≠â-ne ‰∏çÁ≠â-gt Â§ß‰∫é-lt Â∞è‰∫é-ge Â§ß‰∫éÁ≠â‰∫é-le Â∞è‰∫éÁ≠â‰∫é 1[ 23 -ge 22 ] &amp;&amp; echo yes || echo no Êï¥Êï∞ÊØîËæÉ Â≠óÁ¨¶‰∏≤ÊØîËæÉ1234-z ‰∏∫Á©∫-n ‰∏ç‰∏∫Á©∫== Áõ∏Á≠â!= ‰∏çÁ≠â 12name=hhh[ -n "$name" ] &amp;&amp; echo yes || echo no ‰∏ç‰∏∫Á©∫ÔºåËæìÂá∫yes 123aa=22 ; bb=22[ "$aa"=="$bb" ] &amp;&amp; echo yes || echo no Â≠óÁ¨¶‰∏≤ÊØîËæÉÊòØÂê¶Áõ∏Á≠â[ "$aa" -eq "$bb" ] &amp;&amp; echo yes || echo no Êï∞ÂÄºÊï¥Êï∞ÊØîËæÉ ‰∏éÊàñÈùûÊù°‰ª∂123-a ‰∏é-o Êàñ! Èùû 12aa=11[ -n "$aa" -a "$aa" -gt 23 ] &amp;&amp; echo yes || echo no Â≠óÁ¨¶‰∏≤‰∏ç‰∏∫Á©∫ÔºåÊï∞ÂÄºÂ§ß‰∫é23ÔºåËæìÂá∫yes ifËØ≠Âè•ÂçïÂàÜÊîØ 12345678910if [ Êù°‰ª∂ ] Ôºõthen Á®ãÂ∫èfiÊàñËÄÖ Ôºå [] Á≠â‰∫é testif [ Êù°‰ª∂ ] then Á®ãÂ∫èfi Âà§Êñ≠ÂΩìÂâçÁî®Êà∑ Dropbox/commonShell/isZhouxiaowu.sh 123456789101112#!/bin/bash#Âà§Êñ≠ÊòØÂê¶zhouxiaowuÁî®Êà∑#Ëé∑ÂèñÂΩìÂâçÁöÑÁî®Êà∑Âêçu=$(env | grep USER= | cut -d "=" -f 2)echo $u#Âà§Êñ≠ÊòØÂê¶Á≠â‰∫ézhouxiaowuif [ "$u" == "zhouxiaowu" ] ; then echo "yes is zhouxiaowu!"fi Ëé∑ÂèñÁ£ÅÁõò‰ΩøÁî®ÈáèÔºåÂÅöÂëäË≠¶Dropbox/commonShell/diskWarning.sh 123456789#!/bin/bash#Ëé∑ÂèñÁ£ÅÁõòÁöÑ‰ΩøÁî®ÈáèÔºåawkËé∑ÂèñÁ¨¨5‰∏™ÂçïËØçÔºåcutÊåâ%Â≠óÁ¨¶ÂàÜÈöîÔºåÂèñÁ¨¨1‰∏™amount=$(df -h | grep disk1 | awk '&#123;print $5&#125;' | cut -d "%" -f 1)echo $amountif [ $amount -gt 90 ] ; then echo "Á£ÅÁõò‰ΩøÁî®ÈáèË∂ÖËøá90%"fi ÂèåÂàÜÊîØ 123456if [ Êù°‰ª∂ ] then ÊâßË°åËØ≠Âè• else ÊâßË°åËØ≠Âè•fi Âà§ËØªÊòØÂê¶ÁõÆÂΩïDropbox/commonShell/isDir.sh 12345678910111213#!/bin/bash# ËæìÂÖ•ËØªÂèñread -t 30 -p "Êñá‰ª∂ÂêçÔºö" dir# echo $dir# Âà§Êñ≠ÊòØÂê¶ÁõÆÂΩïif [ -d "$dir" ] then echo " is dir" else echo " is not dir"fi Âà§Êñ≠tomcatÊòØÂê¶ÂêØÂä® Dropbox/commonShell/isTomcatStarted.sh Â§öÂàÜÊîØ 123456789if [ Êù°‰ª∂1 ] then ÊâßË°åËØ≠Âè•elif [ Êù°‰ª∂2 ] then ÊâßË°åËØ≠Âè•else ÊâßË°åËØ≠Âè•fi 1echo $? ËæìÂá∫ËÑöÊú¨ÁöÑexit ËøîÂõû caseËØ≠Âè•12345678910case $ÂèòÈáè in "ÂÄº1") ÊâßË°åËØ≠Âè• ;; "ÂÄº2") ÊâßË°åËØ≠Âè• ;; *) ÈªòËÆ§ËØ≠Âè•esac forËØ≠Âè•1234for ÂèòÈáè in ÂÄº1 ÂÄº2 ÂÄº3 ... do ÊâßË°åËØ≠Âè• done 1234for(( i=0;i&lt;=100;i=i+1 )) do ÊâßË°åËØ≠Âè• done ÂÜôÂú®‰∏ÄË°å 1for i in ` seq 10000 `; do echo "hello sxt $i" &gt;&gt; test.txt;done ÊâπÈáèËß£ÂéãÊñá‰ª∂ Dropbox/commonShell/for_tar.sh 1234567891011121314#!/bin/bashcd /Users/zhouxiaowu/install/test_tarls *.tar.gz &gt; ls.logls *.tgz &gt;&gt; ls.logfor i in $( cat ls.log ) do echo "file is $i" tar -zxf $i &gt; /dev/null 2&gt;&amp;1 donerm ls.log Ê≥®ÊÑè i ‰∏çÈúÄË¶Å $ÔºåÂºïÁî®ÂèòÈáèÊâçÈúÄË¶ÅÔºåÂÆö‰πâÂíåËµãÂÄºÂèòÈáè‰∏çÈúÄË¶Å 1Âà∞100Ê±ÇÂíå 12345678910#!/bin/bashs=0for(( i=0;i&lt;=100;i=i+1 )) do s=$(( $s+$i )) doneecho $s whileËØ≠Âè•1234while [ Êù°‰ª∂ËØ≠Âè• ] do ÊâßË°åËØ≠Âè• done 1Âà∞100Ê±ÇÂíå 123456789101112#!/bin/bashi=1s=0while [ $i -le 100 ] do s=$(( $s+$i )) i=$(( $i+1 )) doneecho $s Ê≥®ÊÑèËµãÂÄº s=$(( $s+$i )) untilËØ≠Âè• Êù°‰ª∂‰∏çÊàêÁ´ãÊâßË°å 1234until [ Êù°‰ª∂ËØ≠Âè• ] do ÊâßË°åËØ≠Âè• done 1234567891011121314#!/bin/bash# ‰ªé1Âà∞100Ê±ÇÂíås=0i=1until [ $i -gt 100 ] do s=$(( $s+$i )) i=$(( $i+1 )) doneecho "the sum is $s" ÂèòÈáè1env Êü•ÁúãÁéØÂ¢ÉÂèòÈáè 123bashbashpstree Êü•Áúãpstree 1234#Á≥ªÁªü‰∏ãÁöÑÊâÄÊúâÂèòÈáèsetset -u Êä•ÈîôÊèêÁ§∫unset aa Âà†Èô§ÂèòÈáè 1234567# ‰∏çËÉΩÊúâÁ©∫Ê†º# Â≠óÊØçÂíå‰∏ãÂàíÁ∫øÂºÄÂ§¥ÔºåÂ≠óÊØçÊï∞Â≠ó‰∏ãÂàíÁ∫øÁªÑÊàê# Ëá™ÂÆö‰πâÂèòÈáèÂè™ÂØπÂΩìÂâçshellÁîüÊïàx=5# ÂèòÈáèË∞ÉÁî®echo $x PATHÁéØÂ¢ÉÂèòÈáè PS1ÁéØÂ¢ÉÂèòÈáè 12‚ûú ~ echo $PS1$&#123;ret_status&#125; %&#123;$fg[cyan]%&#125;%c%&#123;$reset_color%&#125; $(git_prompt_info) ÂèòÈáèÂè†Âä†1234x=123# ‰∏ÄËà¨Áî®ËøôÁßçx="$x"456x=$(x)789 $@,$0,$1,$2ÁöÑÂê´‰πâËß£Èáä1$? ÊúÄÂêéËøêË°åÁöÑÂëΩ‰ª§ÁöÑÁªìÊùü‰ª£Á†ÅÔºàËøîÂõûÂÄºÔºâÔºåÊ≠£Á°Æ‰∏∫0,‰∏çÁ°ÆÂÆöÈùû0 12345$$ Êü•ÁúãShellÊú¨Ë∫´ÁöÑPID$! Êü•ÁúãShellÂêéÂè∞ProcessÁöÑPID#!/bin/bashecho "pid is $$" 1234567$0 ShellÊú¨Ë∫´ÁöÑÊñá‰ª∂Âêç$1ÔΩû$n Ê∑ªÂä†Âà∞ShellÁöÑÂêÑÂèÇÊï∞ÂÄº„ÄÇ$1ÊòØÁ¨¨1ÂèÇÊï∞„ÄÅ$2ÊòØÁ¨¨2ÂèÇÊï∞‚Ä¶„ÄÇ$- ‰ΩøÁî®SetÂëΩ‰ª§ËÆæÂÆöÁöÑFlag‰∏ÄËßà$* ÊâÄÊúâÂèÇÊï∞ÂàóË°®„ÄÇÂ¶Ç"$*"Áî®„Äå"„ÄçÊã¨Ëµ∑Êù•ÁöÑÊÉÖÂÜµ„ÄÅ‰ª•"$1 $2 ‚Ä¶ $n"ÁöÑÂΩ¢ÂºèËæìÂá∫ÊâÄÊúâÂèÇÊï∞„ÄÇ$@ ÊâÄÊúâÂèÇÊï∞ÂàóË°®„ÄÇÂ¶Ç"$@"Áî®„Äå"„ÄçÊã¨Ëµ∑Êù•ÁöÑÊÉÖÂÜµ„ÄÅ‰ª•"$1" "$2" ‚Ä¶ "$n" ÁöÑÂΩ¢ÂºèËæìÂá∫ÊâÄÊúâÂèÇÊï∞„ÄÇ$# Ê∑ªÂä†Âà∞ShellÁöÑÂèÇÊï∞‰∏™Êï∞ 1234567891011#!/bin/bashfor i in "$*" do echo $i donefor y in "$@" do echo $y done 1234567‚ûú commonShell ./param3.sh 1 2 3 4 51 2 3 4 5 $*1 $@2345 1234567891011#!/bin/bashprintf "The complete list is %s\n" "$$"printf "The complete list is %s\n" "$!"printf "The complete list is %s\n" "$?"printf "The complete list is %s\n" "$*"printf "The complete list is %s\n" "$@"printf "The complete list is %s\n" "$#" ‰∏™Êï∞2printf "The complete list is %s\n" "$0" ËæìÂá∫Dropbox/commonShell/var.shprintf "The complete list is %s\n" "$1" ËæìÂá∫qqprintf "The complete list is %s\n" "$2" ËæìÂá∫123 12345678‚ûú ~ Dropbox/commonShell/var.sh qq 123The complete list is 1626The complete list isThe complete list is 0The complete list is qq 123 $*ËæìÂá∫The complete list is qq $@ËæìÂá∫The complete list is 123 ÁÇπÂè∑12345678. /lib/init/vars.sh. /lib/lsb/init-functions&lt;/span&gt;‰ª•ÂæÄÊâßË°åÊñá‰ª∂Êó∂ÈÉΩÊòØÁî®./file_nameÁöÑÂΩ¢ÂºèÔºåÊü•ÈòÖ‰∫ÜËµÑÊñôÂæóÁü•Ôºö1„ÄÅ Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÊâßË°åÊüê‰∏™Êñá‰ª∂Ôºå‰ΩÜÊòØÊ≠§Êñá‰ª∂‰∏çÂèØÊâßË°åÔºåÊ≠§Êó∂Êàë‰ª¨Ë¶ÅÁî®chmod u+x file_nameÊù•‰ΩøÊñá‰ª∂ÂÖ∑ÊúâÂèØÊâßË°åÊùÉÈôê2„ÄÅÂèØÊòØÊúâÊó∂Êàë‰ª¨‰∏çÊÉ≥Êõ¥ÊîπÊ≠§Êñá‰ª∂ÁöÑÊâßË°åÊùÉÈôêÔºå‰ΩÜÂèàÊÉ≥ÊâßË°åÊ≠§Êñá‰ª∂ÔºåÂèØ‰ª•ÈááÁî®(ÁÇπÂè∑--Á©∫Ê†º--Êñá‰ª∂Âêç)ÁöÑÂΩ¢ÂºèÊù•ÊâßË°å‰∏Ä‰∏™ËÑöÊú¨ÔºàÂè™ÊúârootÁî®Êà∑ÊâçÂèØ‰ª•Ëøô‰πàÂÅöÔºâ ËØ≠Á≥ªÂèòÈáèlocale12345678910localeLANG="zh_CN.UTF-8" ÂÆö‰πâÁ≥ªÁªü‰∏ªËØ≠Á≥ªLC_COLLATE="zh_CN.UTF-8"LC_CTYPE="zh_CN.UTF-8"LC_MESSAGES="zh_CN.UTF-8"LC_MONETARY="zh_CN.UTF-8"LC_NUMERIC="zh_CN.UTF-8"LC_TIME="zh_CN.UTF-8"LC_ALL= ÂÆö‰πâÊï¥‰ΩìËØ≠Á≥ª 12345echo $LANG Êü•ÁúãÁ≥ªÁªüÂΩìÂâçËØ≠Á≥ªlocal -a | more Êü•ÁúãlinuxÊîØÊåÅÁöÑÊâÄÊúâËØ≠Á≥ªzhcon Êèí‰ª∂ read123456789101112131415#!/bin/bash# -pÊèêÁ§∫ -tÊó∂Èó¥ÂÜÖËæìÂÖ• nameÂèòÈáèread -p "please input your name : " -t 30 nameecho $name# -s ÂÆâÂÖ®ËæìÂÖ•read -p "please input your passwd : " -s passwdecho -e "\n"echo $passwd# -n ËæìÂÖ•Â≠óÁ¨¶‰∏™Êï∞read -p "please input sex M/F : " -n 1 sexecho -e "\n"echo $sex Êï∞ÂÄºËøêÁÆó$(( $1+$2 )) ÂèåÂ∞èÊã¨Âè∑Ê≥®ÊÑè‰∏§ËæπÁïôÁ©∫Ê†º 12345678#!/bin/bashnum1=$1num2=$2#Êï∞ÂÄºËÆ°ÁÆósum=$(( $1 + $2 ))echo "sum is $sum" 1234echo $(( (11+3)*3/2 )) 21echo $(( 10%3 )) 1echo $(( 1&amp;&amp;0 )) 0echo $(( 1||0 )) 1 $[ËøêÁÆóÁ¨¶]` ‰∏≠Êã¨Âè∑1dd=$[$aa+$bb] $(expr $aa + $bb)1dd=$(expr $aa + $bb) +‰∏§‰æßÂøÖÈ°ªÊúâÁ©∫Ê†º declareÂèòÈáèÂ£∞Êòé12345678declare [+/-][ÈÄâÈ°π] ÂèòÈáèÂêç- ËÆæÂÆö+ ÂèñÊ∂àÂèòÈáèÁöÑÁ±ªÂûãÁÜüÊÇâÊÄß-a Êï∞ÁªÑ-i integer-x ÁéØÂ¢ÉÂèòÈáè-r Âè™ËØª-p ËæìÂá∫Á±ªÂûã declare -p cc ÂÆö‰πâÊï∞ÁªÑ 12345678movie[0]=aamovie[1]=bbecho $&#123;movie&#125; ËæìÂá∫aa,Á¨¨0‰∏™echo $&#123;movie[1]&#125; Á¨¨1‰∏™echo $&#123;movie[*]&#125; ÂÖ®ÈÉ®declare -a movie[2]=live ÁéØÂ¢ÉÂèòÈáè 123456declare -x test=123Âíåexport test Áõ∏‰ººdeclare -p Êü•ÁúãÂÖ®ÈÉ®ÂèòÈáèdeclare -xr test=456 Âè™ËØª ÁéØÂ¢ÉÂèòÈáèdeclare +r test ÊèêÁ§∫Âè™ËØª ÂèòÈáèÁΩÆÊç¢ÊñπÂºè ${y-Êñ∞ÂÄº}Â§ßÊã¨Âè∑ÔºåÈªòËÆ§ÂÄº12345678x=$&#123;y-Êñ∞ÂÄº&#125; yÊ≤°ÊúâËÆæÁΩÆÔºåx=Êñ∞ÂÄºÔºõyÂ≠òÂú®Ôºåy‰∏∫Á©∫ÂÄº,x‰∏∫Á©∫;ËÆæÁΩÆy,x$yx=$&#123;y-2&#125;echo $x ‰∏∫2y=""x=$&#123;y-2&#125;echo $x ‰∏∫Á©∫ ÂÖ∂ÂÆÉ1„ÄÅÊü•ÁúãÊâÄÊúâÂÆâË£ÖÁöÑËΩØ‰ª∂ÂåÖ 1rpm -qa 2„ÄÅÊü•ÁúãÁéØÂ¢ÉÂèòÈáè 1env 3„ÄÅMac Âà†Èô§gitÊñá‰ª∂Â§πÔºåÂà†Èô§svnÊñá‰ª∂Â§π 1234567cdÂà∞ËØ•Êñá‰ª∂Â§π//Âà†Èô§Êñá‰ª∂Â§π‰∏ãÁöÑÊâÄÊúâ .svn Êñá‰ª∂find . -name ".svn" | xargs rm -Rf//Âà†Èô§Êñá‰ª∂Â§π‰∏ãÁöÑÊâÄÊúâ .git Êñá‰ª∂find . -name ".git" | xargs rm -Rf Êõ¥Â§öËµÑÊñôÔºöhttps://app.yinxiang.com/Home.action#n=b0fcd794-072a-4fab-9ac6-012b7b0ad147&amp;ses=4&amp;sh=2&amp;sds=5&amp;]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jvmÂ†ÜÂèÇÊï∞Ë∞ÉÊï¥]]></title>
    <url>%2F2018%2F05%2F13%2Fjvm%E5%A0%86%E5%8F%82%E6%95%B0%E8%B0%83%E6%95%B4%2F</url>
    <content type="text"><![CDATA[ÂÅ∂ÁÑ∂ÂèëÁé∞Á∫ø‰∏äÈÄöËøáobeliskÂèëÂ∏ÉÁöÑÂ∫îÁî®ÈªòËÆ§Ê≤°ÊúâÈÖçÁΩÆÂ†ÜÂ§ßÂ∞èÁ≠âjvmÂèÇÊï∞ ‰∏ãÈù¢ÊòØÁ§æÂå∫ÁöÑ‰∏Ä‰∏™Á∫ø‰∏ädubboÂ∫îÁî®ÁöÑjvmÂèÇÊï∞Ôºö 123-XX:CICompilerCount=3 -XX:InitialHeapSize=130023424 -XX:+ManagementServer -XX:MaxHeapSize=2063597568 -XX:MaxNewSize=687865856 -XX:MinHeapDeltaBytes=524288 -XX:NewSize=42991616 -XX:OldSize=87031808 -XX:+PrintGC -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseParallelGCÊ≥®ÔºöËÄÉËôëÂÆâÂÖ®ÊÄßÔºåÈÉ®ÂàÜÊï∞ÊçÆÂà†Èô§ ÈááÁî®ÈªòËÆ§ÂÄºÔºåÊñ∞Áîü‰ª£Âè™Êúâ600Â§öMÔºåÂ†ÜÂå∫ÊÄªÂ§ßÂ∞è‰πüÂè™Êúâ2‰∏™G Á§æÂå∫ËøôËæπÁöÑÁ∫ø‰∏äÊú∫Âô®Âü∫Êú¨ÈÉΩÊòØÊ†áÈÖç4Ê†∏8GÔºå‰∏äÈù¢ÁöÑÈÖçÁΩÆÂ§™Êµ™Ë¥πÔºåÂ¶ÇÊûúÊ¥ªÂä®ÊúüÈó¥ÊúâËæÉÈ´òÂπ∂ÂèëÈáèÔºå‰º∞ËÆ°Êñ∞Áîü‰ª£‰ºö‰∏çË∂≥ÔºåÊå§ÂéãËÄÅÂπ¥‰ª£ÔºåÊåÅÁª≠gcÔºåÂæàÂÆπÊòìÈõ™Â¥©„ÄÇ Á∫ø‰∏äjvmÂèÇÊï∞Ë∞ÉÊï¥ 1-Xms5020m -Xmx5020m -Xmn2500m -XX:PermSize=96m -XX:MaxPermSize=256m -XX:ParallelGCThreads=4 -XX:+UseConcMarkSweepGC -XX:+UseCMSCompactAtFullCollection -XX:CMSMaxAbortablePrecleanTime=5000 -XX:+CMSClassUnloadingEnabled -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=80 ======================== Áî®‰∫Ü‰∏§Âè∞Á∫ø‰∏äÊú∫ÂÅöÊµãËØïÔºåÈÖçÁΩÆ‰∏ÄÊ†∑ 12192.168.16.116ÔºàÂèÇÊï∞Êú™Ë∞ÉÊï¥Ôºâ192.168.18.62 ÔºàÂèÇÊï∞Ë∞ÉÊï¥Ôºâ ÂèëÂ∏É‰∏äÁ∫øÂêéÔºåbeta‰∫Ü‰∏ÄÂ§©ÔºåÂØπÊØîÁªìÊûúÂ¶Ç‰∏ãÔºö 192.168.16.116ÔºàÊú™Ë∞ÉÊï¥ÂèÇÊï∞ÔºâÔºå‰∏ÄÂ§©ÂèëÁîü‰∫ÜYGC4000Â§öÊ¨°ÔºåÊï¥‰∏™gcÊó∂Èó¥26s 192.168.18.62 ÔºàÂèÇÊï∞Ë∞ÉÊï¥ÔºâÔºå‰∏ÄÂ§©YGCÂè™Êúâ300Â§öÊ¨°ÔºåÊï¥‰∏™gcÊó∂Èó¥Âè™Êúâ5s Â¶ÇÊûúÂπ∂ÂèëÈáèÂ§ßÁöÑÊÉÖÂÜµ‰∏ãÔºå‰º∞ËÆ°Ëøô‰∏™Â∑ÆÂºÇ‰ºöÊõ¥Â§ßÔºåÊîØÊåÅÁöÑÊúÄÂ§ßQPSÂ∫îËØ•‰ºöÊúâÂæàÂ§ßÊèêÂçáÔºåÂ¶ÇÊûúË¶ÅÂáÜÁ°ÆÊï∞ÊçÆÁöÑËØùÂèØ‰ª•ÊÄßËÉΩÂéãÊµãÂØπÊØî‰∏ã]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊúçÂä°Âô®ÂºÇÂ∏∏Ê°à‰æã]]></title>
    <url>%2F2018%2F05%2F13%2F%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BC%82%E5%B8%B8%E6%A1%88%E4%BE%8B%2F</url>
    <content type="text"><![CDATA[####1.ÊüêÂ∫îÁî®load&gt;7,sshÊÑüÂà∞ËæìÂÖ•ÂëΩ‰ª§Âêé,Ë¶ÅÁ≠âÂæÖ1„ÄÅ2Áßí ÊâçÂºÄÂßãÊâßË°å topÂëΩ‰ª§Êü•ÁúãcpuÂç†Áî®Áéá,Á∫¶70%,‰∏çËá≥‰∫éÂØºËá¥ssh‰∏≠ÂëΩ‰ª§ÂìçÂ∫îÂèòÊÖ¢ tsarÊü•ÁúãÊúÄËøëÁöÑÁΩëÁªúÊµÅÈáèÔºåÊ≠£Â∏∏ iostat 1ÔºåÂèëÁé∞(ËôöÊãüÊú∫)Á£ÅÁõòtpsËææÂà∞500+ÈùûÂ∏∏È´ò jstackËßÇÂØüjava‰∏≠‰∏Ä‰∏™Á∫øÁ®ãÈ¢ëÁπÅÊìç‰ΩúÁ£ÅÁõò lsofÂëΩ‰ª§ËßÇÂØüÊâìÂºÄÊñá‰ª∂ÔºåÂπ∂ÊéíÊü•‰ª£Á†ÅÂèëÁé∞ÈÖçÁΩÆÈ°πÊúâËØØÂØºËá¥Á£ÅÁõò‰∏äÂá∫Áé∞ÂæàÂ§öÂ∞èÁöÑÈõ∂Á¢éÊñá‰ª∂ÔºåÂºïÂèëÈ¢ëÁπÅÁöÑÈöèÊú∫ËÆøÈóÆÔºå‰øÆÊîπÈÖçÁΩÆÈ°πÂêéÈóÆÈ¢òËß£ÂÜ≥ÔøºÔøº ####2.Â∫îÁî®Load&gt;10ÔºåGCÊ≠£Â∏∏ÔºåÊ¥ªË∑ÉÁ∫øÁ®ãÊï∞ÂæàÂ§öÔºåCPU 100% ps -efLÔºå ÊòæÁ§∫ÊâÄÊúâÊ¥ªË∑ÉÁ∫øÁ®ãIDÂíåÂØπÂ∫îÊó∂Èó¥ Ê†πÊçÆÂØπÂ∫îÁ∫øÁ®ãSPIDÊâæÂá∫jstack‰∏≠ÁöÑÊâßË°åÊ†à ÂÆö‰ΩçÂà∞ÈóÆÈ¢ò‰ª£Á†ÅÔºåÂèëÁé∞‰∏Ä‰∏™Ê≤°ÂêåÊ≠•‰øùÊä§ÁöÑHashMapÈ¢ëÁπÅÂπ∂Âèëput/getÂØºËá¥Ê≠ªÂæ™ÁéØ 12Ê≥®ÊÑèÔºöÈÄöÂ∏∏cpu‰ΩøÁî®ÁéáËææÂà∞‰∫Ü100%Ôºå‰∏ÄËà¨ÊòØÊüê‰∫õÁ∫øÁ®ãÂú®ÊüêÁßçÊù°‰ª∂‰∏ãËøõÂÖ•Ê≠ªÂæ™ÁéØÔºåÈÄÄ‰∏çÂá∫Êù• ####3.ÂÆπÁÅæÊºî‰π†‰πãÂêéÊúçÂä°Êó†Ê≥ïÂêØÂä® df ‚Äìh ÂëΩ‰ª§ /home 100%Âç†Áî®ÔºåÊó•ÂøóÊñá‰ª∂Â∑®Â§ß Âà†ÊéâÁî±‰∫éÊñ≠ÁΩëÂºïËµ∑ÁöÑÂ§ßÈáèÈáçËøûÊó•ÂøóÔºåÈáçÂêØ ####4.ÔøºÊüêÂ∫îÁî®Êú∫Âô®loadÁãÇÈ£ô100+ÔºåÊä•Ë≠¶‰∏çÊñ≠ Êî∂ÈõÜÂêÑ‰∏™Á≥ªÁªüÊåáÊ†áÔºåÂèëÁé∞Èô§‰∫Üload‰πãÂ§ñÊ≤°ÊúâÂºÇÂ∏∏Ôºåload&gt;ËøõÁ®ãÊï∞ÔºåÂ∫îÁî®ÂìçÂ∫îÊ≠£Â∏∏ jstack‰∏≠RunnableÁä∂ÊÄÅÁ∫øÁ®ãÂæàÂ§ö‚Äúatjava.io.UnixFileSystem.getBooleanAttributes0(Native Method)‚Äù ps ‚ÄìTel ÊâìÂç∞ÊâÄÊúâÁ∫øÁ®ãÁä∂ÊÄÅÔºåÂèëÁé∞Â§ßÈáèÊÄ®Â¶áËøõÁ®ãÔºàÁä∂ÊÄÅDÔºåÊó¢Êó†Ê≥ï‰∏≠Êñ≠ÂèàÊó†Ê≥ïÁªßÁª≠Ôºâ Ê†πÊçÆÂÉµÂ∞∏ËøõÁ®ãIDÂÜçÊ¨°Êü•Êâæjstack‰∏≠ÂØπÂ∫î‰ª£Á†ÅÔºå‰∏∫blockedÁöÑÊñá‰ª∂ËÆøÈóÆÊ†à dfÂëΩ‰ª§hang‰Ωè ËÅîÁ≥ªPEÂêåÂ≠¶ÂæóÁü•NASÊïÖÈöú,‰øÆÂ§çÂêéÈáçÂêØOK ####5.JavaËøõÁ®ãÂÅ•Âú®ÔºåÂ∫îÁî®ËøêË°å‰∏ÄÊÆµÊó∂Èó¥Â§±ÂéªÂìçÂ∫î jstatÂêÑ‰∏™Âå∫ÂüüÂÜÖÂ≠òÊ≠£Â∏∏ÔºåÂ∫îÁî®ÊúçÂä°Âô®Á≥ªÁªüËµÑÊ∫êÊ≠£Â∏∏ Êü•ÁúãÂ∫îÁî®ÈªòËÆ§Êó•ÂøóÊñá‰ª∂ÂèëÁé∞‰∏ÄË°å‚ÄúWARN [common] ÊúçÂä°Âô® Â∑≤ÂÅúÊ≠¢ËøêË°å:12201‚Äù jstackÂèëÁé∞ÊúâÁ∫øÁ®ã‚ÄúJBoss Shutdown Hook‚ÄùÂÅ•Âú®ÔºåÊü•Êâæ‰ª£Á†ÅÂèëÁé∞Â±ÖÁÑ∂Êúâ‰∫åÊñπÂåÖ‰ª£Á†ÅÂú®ÊäõÂá∫ÂºÇÂ∏∏ÂêéË∞ÉÁî®system.exit(0) ÔøºÔøºÔøº]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javaÁ∫ø‰∏äÈóÆÈ¢òÊéíÊü•]]></title>
    <url>%2F2018%2F05%2F13%2Fjava%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%2F</url>
    <content type="text"><![CDATA[Â∏∏Áî®ÂëΩ‰ª§„Äê‰ºòÂÖà„ÄëtopÊü•ÁúãË¥üËΩΩÔºåÊâæÂà∞CPUËøáÈ´òÁöÑÁ®ãÂ∫èËøõÁ®ã „Äê‰ºòÂÖà„Äëtop -Hp [ËøõÁ®ãid]Êü•ÁúãËØ•ËøõÁ®ãÁöÑÊâÄÊúâÁ∫øÁ®ãÔºåÊâæÂà∞Âç†Áî®cpuËæÉÈ´òÁöÑÁ∫øÁ®ã „Äê‰ºòÂÖà„Äëjstack [ËøõÁ®ãid] &gt; js.txtÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ãÂ†ÜÊ†àÔºåÊ†πÊçÆÁ∫øÁ®ãidÔºàËΩ¨Êç¢‰∏∫16ËøõÂà∂ printf %x ÔºâÊâæÂà∞CPUËæÉÈ´òÁöÑÁ∫øÁ®ãÂ†ÜÊ†à jstat -gcutil [ËøõÁ®ãid] 1000ÊØèÈöî1000ÁßíÊâìÂç∞jvmÂÜÖÂ≠òGC‰ø°ÊÅØ jmap -histo [ËøõÁ®ãid] &gt; jmap.txtÊü•ÁúãÂΩìÂâçjvmÂÜÖÂ≠òÈáåÂØπË±°ÁöÑÂÆû‰æãÊï∞ÂíåÂÜÖÂ≠òÊï∞ „Äê‰ºòÂÖà„Äëjmap -dump:format=b,file=dump.bin [ËøõÁ®ãid]Êü•ÁúãÂΩìÂâçjvmÂÜÖÂ≠òÈáåÂØπË±°ÁöÑÂÆû‰æãÊï∞ÂíåÂÜÖÂ≠òÊï∞ Â†ÜÂÜÖÂ≠òdumpÊñá‰ª∂ÂàÜÊûê ÂëΩ‰ª§Ôºöjmap -dump:format=b,file=dump.bin [ËøõÁ®ãid] Â∑•ÂÖ∑ÔºöMAT FULL_GCÈóÆÈ¢òÂÆö‰Ωç top Êü•ÁúãË¥üËΩΩÔºåÊâæÂà∞CPUËøáÈ´òÁöÑÁ®ãÂ∫èËøõÁ®ã top -Hp [ËøõÁ®ãid] Êü•ÁúãËØ•ËøõÁ®ãÁöÑÊâÄÊúâÁ∫øÁ®ãÔºåÊâæÂà∞Âç†Áî®cpuËæÉÈ´òÁöÑÁ∫øÁ®ã jstack [ËøõÁ®ãid] &gt; js.txt ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ãÂ†ÜÊ†àÔºåÊ†πÊçÆÁ∫øÁ®ãidÔºàËΩ¨Êç¢‰∏∫16ËøõÂà∂ printf %x ÔºâÊâæÂà∞CPUËæÉÈ´òÁöÑÁ∫øÁ®ãÂ†ÜÊ†à ‰∏âÈÉ®Âü∫Êú¨ÂèØ‰ª•ÂÆö‰ΩçÂà∞Á®ãÂ∫èÁöÑ‰∏Ä‰∫õÈóÆÈ¢ò„ÄÇ ÂΩìÊó∂ÂèëÁé∞ÔºåÂç†Áî®cpuËæÉÈ´òÁöÑÁ∫øÁ®ãÔºåÂü∫Êú¨ÈÉΩÊòØGCÁ∫øÁ®ã 4„ÄÅjstat -gcutil [ËøõÁ®ãid] 1000 ÊØèÈöî1000ÁßíÊâìÂç∞jvmÂÜÖÂ≠òGC‰ø°ÊÅØÔºå S0 Âπ¥ËΩª‰ª£‰∏≠Á¨¨‰∏Ä‰∏™survivorÔºàÂπ∏Â≠òÂå∫ÔºâÂ∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî S1 Âπ¥ËΩª‰ª£‰∏≠Á¨¨‰∫å‰∏™survivorÔºàÂπ∏Â≠òÂå∫ÔºâÂ∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî E Âπ¥ËΩª‰ª£‰∏≠EdenÔºà‰ºäÁî∏Âõ≠ÔºâÂ∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî O old‰ª£Â∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî P perm‰ª£Â∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî YGC ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂Âπ¥ËΩª‰ª£‰∏≠gcÊ¨°Êï∞ YGCT ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂Âπ¥ËΩª‰ª£‰∏≠gcÊâÄÁî®Êó∂Èó¥(s) FGC ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂old‰ª£(ÂÖ®gc)gcÊ¨°Êï∞ FGCT ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂old‰ª£(ÂÖ®gc)gcÊâÄÁî®Êó∂Èó¥(s) GCT ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂gcÁî®ÁöÑÊÄªÊó∂Èó¥(s) jmap -histo [ËøõÁ®ãid] &gt; jmap.txt Êü•ÁúãÂΩìÂâçjvmÂÜÖÂ≠òÈáåÂØπË±°ÁöÑÂÆû‰æãÊï∞ÂíåÂÜÖÂ≠òÊï∞ 6„ÄÅÁúãGCÊó•Âøó ÂêØÂä®ËÑöÊú¨ÈáåÊ∑ªÂä†gclogÈÖçÁΩÆ -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintHeapAtGC -Xloggc:gc.log Á≠õÈÄâFull GC log Â†ÜÂÜÖÂ≠òdumpÊñá‰ª∂ÂàÜÊûê ÂëΩ‰ª§Ôºöjmap -dump:format=b,file=aa.bin 1232134 Â∑•ÂÖ∑ÔºöMAT]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â∏∏Áî®ËÑöÊú¨]]></title>
    <url>%2F2018%2F05%2F13%2F%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC%2F</url>
    <content type="text"><![CDATA[PSÔºö Êú¨‰ªìÂ∫ìÁöÑËÑöÊú¨ÔºàÂ¶ÇJavaÁõ∏ÂÖ≥ËÑöÊú¨ÔºâÂú®ÈòøÈáåÁ≠âÂÖ¨Âè∏ÔºàÂ¶ÇÈöèË∫´‰∫ëÔºåËßÅawesome-scripts‰ªìÂ∫ìËØ¥ÊòéÔºâÁöÑÁ∫ø‰∏äÁîü‰∫ßÁéØÂ¢ÉÈÉ®ÁΩ≤‰ΩøÁî®„ÄÇÂ¶ÇÊûú‰Ω†ÁöÑÂÖ¨Âè∏ÊúâÈÉ®ÁΩ≤‰ΩøÁî®ÔºåÊ¨¢Ëøé‰ΩøÁî®ÈÄöËøáÊèê‰∫§IssueÂëäÁü•ÔºåÊñπ‰æø‰∫íÁõ∏‰∫§ÊµÅÂèçÈ¶àÔΩû :cupid: :beginner: Âø´ÈÄü‰∏ãËΩΩ&amp;‰ΩøÁî®1source &lt;(curl -fsSL https://raw.githubusercontent.com/oldratlee/useful-scripts/master/test-cases/self-installer.sh) Êõ¥Â§ö‰∏ãËΩΩ&amp;‰ΩøÁî®ÊñπÂºèÔºåÂèÇËßÅ‰∏ãËΩΩ‰ΩøÁî®„ÄÇ :books: ‰ΩøÁî®ÊñáÊ°£:coffee: JavaÁõ∏ÂÖ≥ËÑöÊú¨ show-busy-java-threads Áî®‰∫éÂø´ÈÄüÊéíÊü•JavaÁöÑCPUÊÄßËÉΩÈóÆÈ¢ò(top usÂÄºËøáÈ´ò)ÔºåËá™Âä®Êü•Âá∫ËøêË°åÁöÑJavaËøõÁ®ã‰∏≠Ê∂àËÄóCPUÂ§öÁöÑÁ∫øÁ®ãÔºåÂπ∂ÊâìÂç∞Âá∫ÂÖ∂Á∫øÁ®ãÊ†àÔºå‰ªéËÄåÁ°ÆÂÆöÂØºËá¥ÊÄßËÉΩÈóÆÈ¢òÁöÑÊñπÊ≥ïË∞ÉÁî®„ÄÇ show-duplicate-java-classes ÊâæÂá∫jarÊñá‰ª∂ÂíåclassÁõÆÂΩï‰∏≠ÁöÑÈáçÂ§çÁ±ª„ÄÇÁî®‰∫éÊéíÊü•JavaÁ±ªÂÜ≤Á™ÅÈóÆÈ¢ò„ÄÇ find-in-jars Âú®ÁõÆÂΩï‰∏ãÊâÄÊúâjarÊñá‰ª∂ÈáåÔºåÊü•ÊâæÁ±ªÊàñËµÑÊ∫êÊñá‰ª∂„ÄÇ :shell: ShellÁõ∏ÂÖ≥ËÑöÊú¨Shell‰ΩøÁî®Âä†Âº∫Ôºö c ÂéüÊ†∑ÂëΩ‰ª§Ë°åËæìÂá∫ÔºåÂπ∂Êã∑Ë¥ùÊ†áÂáÜËæìÂá∫Âà∞Á≥ªÁªüÂâ™Ë¥¥ÊùøÔºåÁúÅÂéªCTRL+CÊìç‰ΩúÔºå‰ºòÂåñÂëΩ‰ª§Ë°å‰∏éÂÖ∂ÂÆÉÂ∫îÁî®‰πãÈó¥ÁöÑÊìç‰ΩúÊµÅ„ÄÇ coat ÂΩ©Ëâ≤catÂá∫Êñá‰ª∂Ë°åÔºåÊñπ‰æø‰∫∫ÁúºÂå∫ÂàÜ‰∏çÂêåÁöÑË°å„ÄÇ a2l ÊåâË°åÂΩ©Ëâ≤ËæìÂá∫ÂèÇÊï∞ÔºåÊñπ‰æø‰∫∫ÁúºÊü•Áúã„ÄÇ ap and rp ÊâπÈáèËΩ¨Êç¢Êñá‰ª∂Ë∑ØÂæÑ‰∏∫ÁªùÂØπË∑ØÂæÑ/Áõ∏ÂØπË∑ØÂæÑÔºå‰ºöËá™Âä®Ë∑üË∏™ÈìæÊé•Âπ∂ËßÑËåÉÂåñË∑ØÂæÑ„ÄÇ tcp-connection-state-counter ÁªüËÆ°ÂêÑ‰∏™TCPËøûÊé•Áä∂ÊÄÅÁöÑ‰∏™Êï∞„ÄÇÁî®‰∫éÊñπ‰æøÊéíÊü•Á≥ªÁªüËøûÊé•Ë¥üËç∑ÈóÆÈ¢ò„ÄÇ xpl and xpf Âú®ÂëΩ‰ª§Ë°å‰∏≠Âø´ÈÄüÂÆåÊàê Âú®Êñá‰ª∂ÊµèËßàÂô®‰∏≠ ÊâìÂºÄ/ÈÄâ‰∏≠ ÊåáÂÆöÁöÑÊñá‰ª∂ÊàñÊñá‰ª∂Â§πÁöÑÊìç‰ΩúÔºå‰ºòÂåñÂëΩ‰ª§Ë°å‰∏éÂÖ∂ÂÆÉÂ∫îÁî®‰πãÈó¥ÁöÑÊìç‰ΩúÊµÅ„ÄÇ ShellÂºÄÂèë/ÊµãËØïÂä†Âº∫Ôºö echo-args ËæìÂá∫ËÑöÊú¨Êî∂Âà∞ÁöÑÂèÇÊï∞ÔºåÂú®ÊéßÂà∂Âè∞ËøêË°åÊó∂ÔºåÊääÂèÇÊï∞ÂÄºÊã¨Ëµ∑ÁöÑÊã¨Âè∑ÊòæÁ§∫Êàê Á∫¢Ëâ≤ÔºåÊñπ‰æø‰∫∫ÁúºÊü•Áúã„ÄÇÁî®‰∫éË∞ÉËØïËÑöÊú¨ÂèÇÊï∞ËæìÂÖ•„ÄÇ console-text-color-themes.sh ÊòæÁ§∫TerminatorÁöÑÂÖ®ÈÉ®ÊñáÂ≠óÂΩ©Ëâ≤ÁªÑÂêàÁöÑÊïàÊûúÂèäÂÖ∂ÊâìÂç∞ÊñπÂºèÔºåÁî®‰∫éÂºÄÂèëShellÁöÑÂΩ©Ëâ≤ËæìÂá∫„ÄÇ parseOpts.sh ÂëΩ‰ª§Ë°åÈÄâÈ°πËß£ÊûêÂ∫ìÔºåÂä†Âº∫ÊîØÊåÅÈÄâÈ°πÊúâÂ§ö‰∏™ÂÄºÔºàÂç≥Êï∞ÁªÑÔºâ„ÄÇ :watch: VCSÁõ∏ÂÖ≥ËÑöÊú¨ÁõÆÂâçVCSÁöÑËÑöÊú¨ÈÉΩÊòØsvnÂàÜÊîØÁõ∏ÂÖ≥ÁöÑÊìç‰Ωú„ÄÇ‰ΩøÁî®Êõ¥Áé∞‰ª£ÁöÑGitÂêßÔºÅ :boom: Âõ†‰∏∫‰∏çÊé®Ëçê‰ΩøÁî®svnÔºåËøôÈáå‰∏çÂÜçÂàóÂá∫ÊúâÂì™‰∫õËÑöÊú¨‰∫ÜÔºåÂ¶ÇÊûú‰Ω†ÊúâÂÖ¥Ë∂£ÂèØ‰ª•ÁÇπ‰∏äÈù¢ÈìæÊé•ÂéªÁúã„ÄÇ]]></content>
      <categories>
        <category>shellËÑöÊú¨</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[anatomy]]></title>
    <url>%2F2018%2F05%2F13%2Fanatomy%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªãanatomy ÊòØÈòøÈáåÂêåÂ≠¶ÂºÄÂèëÁöÑ‰∏ÄÊ¨æÁî®‰∫éJVMËøõÁ®ãÊâßË°åËøáÁ®ã‰∏≠ÁöÑÂºÇÂ∏∏ËØäÊñ≠Â∑•ÂÖ∑ÔºåÂèØ‰ª•Âú®‰∏ç‰∏≠Êñ≠Á®ãÂ∫èÊâßË°åÁöÑÊÉÖÂÜµ‰∏ãËΩªÊùæÂÆåÊàêÈóÆÈ¢òÊéíÊü•Â∑•‰Ωú„ÄÇ Á∫ØJavaÂÆûÁé∞ÁöÑÂºÄÊ∫êÈ°πÁõÆ ÂÆâË£Ö‰ΩøÁî®‰æøÊç∑ ÊñπÊ≥ïÁ∫ßÈóÆÈ¢òËØäÊñ≠ GroovyË°®ËææÂºèÂ±ïÂºÄÂèòÂØπË±°ÔºåÊñπ‰æø‰Ω†ËßÇÂØüÂÖ•ÂèÇ„ÄÅÂá∫ÂèÇ„ÄÅÂºÇÂ∏∏„ÄÅÂΩìÂâçÂØπË±°ÁöÑÂêÑÁßçÂ±ûÊÄßÁªÜËäÇ Êé•‰∏ãÊù•ÁªìÂêàÁ∫ø‰∏äÂ∫îÁî®ÔºåÂàó‰∏æÂ∏∏Áî®ÁöÑÂá†‰∏™ÊéíÊü•ÈóÆÈ¢òÂëΩ‰ª§Â¶Ç‰Ωï‰ΩøÁî®1„ÄÅÂÆâË£ÖÔºö 1curl -sLk http://ompc.oss.aliyuncs.com/greys/install.sh|sh 2„ÄÅÂêØÂä® 123greys.sh &lt;PID&gt;Ê≥®ÔºöPIDÔºöÁõÆÊ†áJavaËøõÁ®ãID 3„ÄÅhelp 1234567help Ê≥®ÔºöÊâÄÊúâÂëΩ‰ª§help watchÊ≥®ÔºöhelpÂëΩ‰ª§ÂêåÊó∂‰πüÊîØÊåÅÂØπÂÖ∂‰ªñÂëΩ‰ª§ÁöÑ‰∏Ä‰∏™Ëß£ÈáäËØ¥ÊòéÔºåÊØîÂ¶ÇÊàë‰ª¨ÈîÆÂÖ•help watchÔºåÂåÖÂê´ÔºàÁî®ÈÄîËØ¥Êòé„ÄÅÂèÇÊï∞ÂàóË°®„ÄÅÂÆûÈôÖ‰æãÂ≠êÔºâ 4„ÄÅsc ÊêúÁ¥¢ÊâÄÊúâÂ∑≤ÁªèÂä†ËΩΩÂà∞JVM‰∏≠ÁöÑClass‰ø°ÊÅØ„ÄÇ 1sc -d *RecommendManagerImpl ‰ΩøÁî®Âú∫ÊôØÔºö ‰∏ªË¶ÅÊòØÁî®‰∫éÊéíÊü•‰∏Ä‰∏™Â∫îÁî®ÂèØËÉΩÂ≠òÂú®Âêå‰∏Ä‰∏™jarÂåÖÁöÑÂ§ö‰∏™ÁâàÊú¨ÔºåËÄå‰∏çÂêåÁâàÊú¨ÁöÑÁ±ªÁöÑÊñπÊ≥ïÂèØËÉΩ‰ºöÊúâÂÆûÁé∞‰∏äÁöÑÂ∑ÆÂºÇÔºåÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÁ°ÆËÆ§JVM‰∏≠Âä†ËΩΩÁöÑÊòØÂì™‰∏Ä‰∏™jar‰∏ãÁöÑÁ±ª„ÄÇ 5„ÄÅmonitor ÊñπÊ≥ïÂ±ÇÈù¢ÁöÑÊÄßËÉΩÁõëÊéßÔºåÈùûÂÆûÊó∂ËøîÂõûÁöÑÂëΩ‰ª§ÔºåÂàôÊòØ‰∏çÊñ≠ÁöÑÁ≠âÂæÖÁõÆÊ†áJavaËøõÁ®ãËøîÂõû‰ø°ÊÅØÔºåÁõ¥Âà∞Áî®Êà∑ËæìÂÖ•Ctrl+D‰∏∫Ê≠¢ 123monitor -c 5 *TimelineReadServiceImpl getEditorRecPostÊ≥®Ôºö-c : ÁªüËÆ°Âë®ÊúüÔºåÈªòËÆ§ÂÄº‰∏∫120Áßí ‰ΩøÁî®Âú∫ÊôØÔºö Á∫ø‰∏äÂèçÈ¶àÊüê‰∏™Êé•Âè£Á™ÅÁÑ∂ÂìçÂ∫îËæÉÊÖ¢Ôºå‰ΩÜÂèàÁº∫‰πèÂÖ®ÈìæË∑ØÁª¥Â∫¶ËäÇÁÇπÁöÑÁõëÊéßÔºåÂèØ‰ª•ÈÄöËøáËØ•ÂëΩ‰ª§ËÉΩÂÆö‰ΩçÂà∞ÂÖ∑‰ΩìÂì™‰∏™ÊñπÊ≥ïËÄóÊó∂ËæÉÈïøÔºåÊúâÊïàÁº©Â∞èÊéíÊü•ËåÉÂõ¥„ÄÇ 6„ÄÅtrace ÁªüËÆ°Êï¥‰∏™Ë∞ÉÁî®ÈìæË∑Ø‰∏äÁöÑÊâÄÊúâÊÄßËÉΩÂºÄÈîÄÂíåËøΩË∏™Ë∞ÉÁî®ÈìæË∑Ø„ÄÇ 1trace -n 2 *TimelineReadServiceImpl queryRecPageTimeLine ‰ΩøÁî®Âú∫ÊôØÔºö ÂÆö‰ΩçÊü•ÊâæÊüê‰∏ÄÊé•Âè£ÂìçÂ∫îËæÉÊÖ¢Ôºå‰∏ªË¶ÅÊòØÊçüËÄóÂú®Âì™‰∏Ä‰∏™ÁéØËäÇ„ÄÇ Âè¶Â§ñ‰πüÂèØ‰ª•ÂÅö‰∏∫ÊÄßËÉΩ‰ºòÂåñÁöÑÂèÇËÄÉÊ†áÂáÜÔºå‰∫ÜËß£‰∏Ä‰∏™Êé•Âè£‰∏ãÈù¢ÊØè‰∏™ÁéØËäÇÁöÑÊ∂àËÄóÊó∂Èó¥Ôºå‰ªéËÄåÂà§Êñ≠ÊòØÂê¶ÂêàÁêÜÔºåÊúâÊ≤°Êúâ‰ºòÂåñÁöÑÁ©∫Èó¥ 7„ÄÅwatch ËßÇÂØüÂà∞ÊåáÂÆöÊñπÊ≥ïÁöÑË∞ÉÁî®ÊÉÖÂÜµ ËÉΩËßÇÂØüÂà∞ÁöÑËåÉÂõ¥ÔºöÂÖ•ÂèÇ„ÄÅËøîÂõûÂÄº„ÄÅÊäõÂá∫ÂºÇÂ∏∏ÔºåÈÄöËøáÁºñÂÜôgroovyË°®ËææÂºèËøõË°åÂØπÂ∫îÂèòÈáèÁöÑÊü•Áúã„ÄÇËØ¶ÁªÜ‰ΩøÁî®ÊâãÂÜåÂèØ‰ª•ÈÄöËøáÂëΩ‰ª§help watch 1234567891011watch -b *TimelineReadServiceImpl queryRecPageTimeLine params[0]Ê≥®ÔºöÊâìÂç∞ÂÆåÊï¥ÁöÑÂÖ•ÂèÇ‰ø°ÊÅØwatch -b *TimelineReadServiceImpl queryRecPageTimeLine params[0] 'params[0].uid&gt;2894731' Ê≥®ÔºöÂ∏¶‰∏ägroovyË°®ËææÂºèÔºåuid&gt;2894731watch -s *TimelineReadServiceImpl queryRecPageTimeLine params[0]+returnObj 'params[0].uid==3680667'Ê≥®ÔºöÂΩìËØ∑Ê±ÇÁöÑuid‰∏∫3680667Êó∂ÔºåÊâìÂç∞ÂÖ•ÂèÇÂíåËøîÂõûÁªìÊûú 8„ÄÅ jvm Êü•ÁúãÂΩìÂâçJVMÁöÑ‰ø°ÊÅØÔºåÊó†ÂèÇÊï∞ ÂèÇËÄÉËµÑÊñôhttps://github.com/oldmanpushcart/greys-anatomy/wiki/Commands#help]]></content>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javaÊúçÂä°Âô®loadÈ£ôÈ´òÊéíÊü•ÊÄùË∑Ø]]></title>
    <url>%2F2018%2F05%2F13%2Fjava%E6%9C%8D%E5%8A%A1%E5%99%A8load%E9%A3%9A%E9%AB%98%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF%2F</url>
    <content type="text"><![CDATA[Load ÊòØÊåáÂØπËÆ°ÁÆóÊú∫Âπ≤Ê¥ªÂ§öÂ∞ëÁöÑÂ∫¶ÈáèÔºàWikiPediaÔºöthe system load is a measure of the amount of work that a computer system is doingÔºâÔºåÁÆÄÂçïÁöÑËØ¥ÊòØËøõÁ®ãÈòüÂàóÁöÑÈïøÂ∫¶„ÄÇLoad Average Â∞±ÊòØ‰∏ÄÊÆµÊó∂Èó¥ (1 ÂàÜÈíü„ÄÅ5ÂàÜÈíü„ÄÅ15ÂàÜÈíü) ÂÜÖÂπ≥Âùá Load ÈÄöËøáuptimeÂëΩ‰ª§ÂèØ‰ª•Êü•ÁúãÂΩìÂâçÁöÑloadÔºåÂ¶ÇÊûúÂÄºÂæàÈ´ò„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµÊòØjavaÊüê‰∫õÁ∫øÁ®ãÈïøÊúüÂç†Áî®ËµÑÊ∫ê„ÄÅÊ≠ªÈîÅ„ÄÅÊ≠ªÂæ™ÁéØÁ≠âÂØºËá¥Êüê‰∏™ËøõÁ®ãÂç†Áî®ÁöÑCPUËµÑÊ∫êËøáÈ´ò„ÄÇÂ§ßËá¥ÂèØ‰ª•‰ªé‰ª•‰∏ãÂá†‰∏™ËßíÂ∫¶Êù•ÊéíÊü•Ôºö 1.È¶ñÂÖàÈÄöËøájpsÂëΩ‰ª§ÔºåÊü•ÁúãÂΩìÂâçËøõÁ®ãidÔºåÂ¶Çid‰∏∫ 28174 2.Êü•ÁúãËØ•ËøõÁ®ã‰∏ãÁöÑÁ∫øÁ®ãËµÑÊ∫ê‰ΩøÁî®ÊÉÖÂÜµ 1top -p 28174 ‚ÄìH 1234567891011121314151632694 root 20 0 3249m 2.0g 11m S 2 6.4 3:31.12 java28175 root 20 0 3249m 2.0g 11m S 0 6.4 0:00.06 java28176 root 20 0 3249m 2.0g 11m S 0 6.4 1:40.79 java28177 root 20 0 3249m 2.0g 11m S 0 6.4 1:41.12 java28178 root 20 0 3249m 2.0g 11m S 0 6.4 1:41.11 java28179 root 20 0 3249m 2.0g 11m S 0 6.4 1:41.33 java28180 root 20 0 3249m 2.0g 11m S 0 6.4 1:41.58 java28181 root 20 0 3249m 2.0g 11m S 0 6.4 1:40.36 java28182 root 20 0 3249m 2.0g 11m S 0 6.4 1:41.02 java28183 root 20 0 3249m 2.0g 11m S 0 6.4 1:40.96 java28184 root 20 0 3249m 2.0g 11m S 0 6.4 4:38.30 java28185 root 20 0 3249m 2.0g 11m S 0 6.4 0:00.46 java28186 root 20 0 3249m 2.0g 11m S 0 6.4 0:01.83 java28187 root 20 0 3249m 2.0g 11m S 0 6.4 0:00.00 java28189 root 20 0 3249m 2.0g 11m S 0 6.4 0:00.01 java28190 root 20 0 3249m 2.0g 11m S 0 6.4 0:49.01 java 3.ÊâìÂç∞JAVAËøõÁ®ã28174ÁöÑÂ†ÜÊ†à‰ø°ÊÅØ 1jstack 28174 &gt;&gt; stack.log 4.Â∞ÜcpuÊ∂àËÄóÈ´òÁöÑÁ∫øÁ®ãÁöÑpidÊç¢ÁÆó‰∏∫16ËøõÂà∂ 1printf 0x%x 32694 ËΩ¨Êç¢ÂêéÁöÑ16ËøõÂà∂‰∏∫ 0x7fb6 5.‰ªéÂàöÊâçÁöÑÊ†àÊó•Âøó‰∏≠Êü•ÊâæËØ•Á∫øÁ®ãÊ≠£Âú®ËøêË°åÁöÑÊñπÊ≥ï 1grep 0x7fb6 stack.log -a3 123456"MSXMLProcessorThread" prio=10 tid=0x00002b469923a800 [color=darkred]nid=0x7fb6[/color] sleeping[0x00002b46b0200000] java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at com.adventnet.management.xml.MSXmlProcessor.listen(MSXmlProcessor.java:279) at com.adventnet.management.xml.MSXmlProcessor.run(MSXmlProcessor.java:264) at java.lang.Thread.run(Thread.java:619) 6.Âè¶Â§ñ‰πüÂèØ‰ª•Êü•ÊâæÊ≠£Âú®ËøêË°åÁöÑÁ∫øÁ®ãÔºåÂèäÁ∫øÁ®ãÂ§Ñ‰∫éËøêË°åÁä∂ÊÄÅÁöÑ‰ΩçÁΩÆÔºå‰ªéËøô‰∫õÁ∫øÁ®ã‰∏≠Êù•Êü•ÊâæËµÑÊ∫êÊ∂àËÄóËøáÈ´òÁöÑ‰ª£Á†Å„ÄÇ 1grep RUNNABLE stack.log -a1 1less a.log |awk '&#123;FS="java.lang.Thread.State:";print $2&#125;'|sort |uniq -c |sort -nr]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javaÂêéÁ´ØÊû∂ÊûÑÂ∏àÊäÄÊúØÂõæË∞±]]></title>
    <url>%2F2018%2F05%2F08%2Fjava%E5%90%8E%E7%AB%AF%E6%9E%B6%E6%9E%84%E5%B8%88%E6%8A%80%E6%9C%AF%E5%9B%BE%E8%B0%B1%2F</url>
    <content type="text"><![CDATA[ÊúÄÂêéÊõ¥Êñ∞‰∫é20180502 [TOC] Êï∞ÊçÆÁªìÊûÑÈòüÂàó „ÄäjavaÈòüÂàó‚Äî‚ÄîqueueËØ¶ÁªÜÂàÜÊûê„Äã ÈùûÈòªÂ°ûÈòüÂàóÔºöConcurrentLinkedQueue(Êó†ÁïåÁ∫øÁ®ãÂÆâÂÖ®)ÔºåÈááÁî®CASÊú∫Âà∂ÔºàcompareAndSwapObjectÂéüÂ≠êÊìç‰ΩúÔºâ„ÄÇ ÈòªÂ°ûÈòüÂàóÔºöArrayBlockingQueue(ÊúâÁïå)„ÄÅLinkedBlockingQueueÔºàÊó†ÁïåÔºâ„ÄÅDelayQueue„ÄÅPriorityBlockingQueueÔºåÈááÁî®ÈîÅÊú∫Âà∂Ôºõ‰ΩøÁî® ReentrantLock ÈîÅ„ÄÇ „ÄäLinkedList„ÄÅConcurrentLinkedQueue„ÄÅLinkedBlockingQueueÂØπÊØîÂàÜÊûê„Äã ÈõÜÂêà „ÄäJava SetÈõÜÂêàÁöÑËØ¶Ëß£„Äã ÈìæË°®„ÄÅÊï∞ÁªÑ „ÄäJavaÈõÜÂêàËØ¶Ëß£‚Äì‰ªÄ‰πàÊòØList„Äã Â≠óÂÖ∏„ÄÅÂÖ≥ËÅîÊï∞ÁªÑ „ÄäJava map ËØ¶Ëß£ - Áî®Ê≥ï„ÄÅÈÅçÂéÜ„ÄÅÊéíÂ∫è„ÄÅÂ∏∏Áî®APIÁ≠â„Äã Ê†à „ÄäjavaÊï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ï‰πãÊ†àÔºàStackÔºâËÆæËÆ°‰∏éÂÆûÁé∞„Äã „ÄäJava Stack Á±ª„Äã „Ääjava stackÁöÑËØ¶ÁªÜÂÆûÁé∞ÂàÜÊûê„Äã Stack ÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ ÂÜÖÈÉ®‰ΩøÁî®Êï∞ÁªÑ‰øùÂ≠òÊï∞ÊçÆÔºå‰∏çÂ§üÊó∂ÁøªÂÄç„ÄÇ Ê†ë‰∫åÂèâÊ†ëÊØè‰∏™ËäÇÁÇπÊúÄÂ§öÊúâ‰∏§‰∏™Âè∂Â≠êËäÇÁÇπ„ÄÇ „Ää‰∫åÂèâÊ†ë„Äã ÂÆåÂÖ®‰∫åÂèâÊ†ë „ÄäÂÆåÂÖ®‰∫åÂèâÊ†ë„Äã Âè∂ËäÇÁÇπÂè™ËÉΩÂá∫Áé∞Âú®ÊúÄ‰∏ãÂ±ÇÂíåÊ¨°‰∏ãÂ±ÇÔºåÂπ∂‰∏îÊúÄ‰∏ãÈù¢‰∏ÄÂ±ÇÁöÑÁªìÁÇπÈÉΩÈõÜ‰∏≠Âú®ËØ•Â±ÇÊúÄÂ∑¶ËæπÁöÑËã•Âπ≤‰ΩçÁΩÆÁöÑ‰∫åÂèâÊ†ë„ÄÇ Âπ≥Ë°°‰∫åÂèâÊ†ëÂ∑¶Âè≥‰∏§‰∏™Â≠êÊ†ëÁöÑÈ´òÂ∫¶Â∑ÆÁöÑÁªùÂØπÂÄº‰∏çË∂ÖËøá1ÔºåÂπ∂‰∏îÂ∑¶Âè≥‰∏§‰∏™Â≠êÊ†ëÈÉΩÊòØ‰∏ÄÊ£µÂπ≥Ë°°‰∫åÂèâÊ†ë„ÄÇ „ÄäÊµÖË∞àÊï∞ÊçÆÁªìÊûÑ-Âπ≥Ë°°‰∫åÂèâÊ†ë„Äã „ÄäÊµÖË∞àÁÆóÊ≥ïÂíåÊï∞ÊçÆÁªìÊûÑ: ÂÖ´ Âπ≥Ë°°Êü•ÊâæÊ†ë‰πã2-3Ê†ë„Äã ‰∫åÂèâÊü•ÊâæÊ†ëÔºàBSTÔºâ‰∫åÂèâÊü•ÊâæÊ†ëÔºàBinary Search TreeÔºâÔºå‰πüÁß∞ÊúâÂ∫è‰∫åÂèâÊ†ëÔºàordered binary treeÔºâ,ÊéíÂ∫è‰∫åÂèâÊ†ëÔºàsorted binary treeÔºâ„ÄÇ „ÄäÊµÖË∞àÁÆóÊ≥ïÂíåÊï∞ÊçÆÁªìÊûÑ: ‰∏É ‰∫åÂèâÊü•ÊâæÊ†ë„Äã Á∫¢ÈªëÊ†ë „ÄäÊúÄÂÆπÊòìÊáÇÂæóÁ∫¢ÈªëÊ†ë„Äã Ê∑ªÂä†Èò∂ÊÆµÂêéÔºåÂ∑¶ÊóãÊàñËÄÖÂè≥Êóã‰ªéËÄåÂÜçÊ¨°ËææÂà∞Âπ≥Ë°°„ÄÇ „ÄäÊµÖË∞àÁÆóÊ≥ïÂíåÊï∞ÊçÆÁªìÊûÑ: ‰πù Âπ≥Ë°°Êü•ÊâæÊ†ë‰πãÁ∫¢ÈªëÊ†ë„Äã B-ÔºåB+ÔºåB*Ê†ëMySQLÊòØÂü∫‰∫éB+Ê†ëËÅöÈõÜÁ¥¢ÂºïÁªÑÁªáË°® „ÄäB-Ê†ëÔºåB+Ê†ëÔºåB*Ê†ëËØ¶Ëß£„Äã „ÄäB-Ê†ëÔºåB+Ê†ë‰∏éB*Ê†ëÁöÑ‰ºòÁº∫ÁÇπÊØîËæÉ„Äã B+ Ê†ëÁöÑÂè∂Â≠êËäÇÁÇπÈìæË°®ÁªìÊûÑÁõ∏ÊØî‰∫é B- Ê†ë‰æø‰∫éÊâ´Â∫ìÔºåÂíåËåÉÂõ¥Ê£ÄÁ¥¢„ÄÇLSM Ê†ë LSMÔºàLog-Structured Merge-TreesÔºâÂíå B+ Ê†ëÁõ∏ÊØîÔºåÊòØÁâ∫Áâ≤‰∫ÜÈÉ®ÂàÜËØªÁöÑÊÄßËÉΩÊù•Êç¢ÂèñÂÜôÁöÑÊÄßËÉΩ(ÈÄöËøáÊâπÈáèÂÜôÂÖ•)ÔºåÂÆûÁé∞ËØªÂÜô‰πãÈó¥ÁöÑ„ÄÇHbase„ÄÅLevelDB„ÄÅTairÔºàLong DBÔºâ„ÄÅnessDB ÈááÁî® LSM Ê†ëÁöÑÁªìÊûÑ„ÄÇLSMÂèØ‰ª•Âø´ÈÄüÂª∫Á´ãÁ¥¢Âºï„ÄÇ „ÄäLSMÊ†ë VS B+Ê†ë„Äã B+ Ê†ëËØªÊÄßËÉΩÂ•ΩÔºå‰ΩÜÁî±‰∫éÈúÄË¶ÅÊúâÂ∫èÁªìÊûÑÔºåÂΩìkeyÊØîËæÉÂàÜÊï£Êó∂ÔºåÁ£ÅÁõòÂØªÈÅìÈ¢ëÁπÅÔºåÈÄ†ÊàêÂÜôÊÄßËÉΩ„ÄÇ LSM ÊòØÂ∞Ü‰∏Ä‰∏™Â§ßÊ†ëÊãÜÂàÜÊàêNÊ£µÂ∞èÊ†ëÔºåÂÖàÂÜôÂà∞ÂÜÖÂ≠òÔºàÊó†ÂØªÈÅìÈóÆÈ¢òÔºåÊÄßËÉΩÈ´òÔºâÔºåÂú®ÂÜÖÂ≠ò‰∏≠ÊûÑÂª∫‰∏ÄÈ¢óÊúâÂ∫èÂ∞èÊ†ëÔºàÊúâÂ∫èÊ†ëÔºâÔºåÈöèÁùÄÂ∞èÊ†ëË∂äÊù•Ë∂äÂ§ßÔºåÂÜÖÂ≠òÁöÑÂ∞èÊ†ë‰ºöflushÂà∞Á£ÅÁõò‰∏ä„ÄÇÂΩìËØªÊó∂ÔºåÁî±‰∫é‰∏çÁü•ÈÅìÊï∞ÊçÆÂú®Âì™Ê£µÂ∞èÊ†ë‰∏äÔºåÂõ†Ê≠§ÂøÖÈ°ªÈÅçÂéÜÔºà‰∫åÂàÜÊü•ÊâæÔºâÊâÄÊúâÁöÑÂ∞èÊ†ëÔºå‰ΩÜÂú®ÊØèÈ¢óÂ∞èÊ†ëÂÜÖÈÉ®Êï∞ÊçÆÊòØÊúâÂ∫èÁöÑ„ÄÇ „ÄäLSMÊ†ëÔºàLog-Structured Merge TreeÔºâÂ≠òÂÇ®ÂºïÊìé„Äã ÊûÅÁ´ØÁöÑËØ¥ÔºåÂü∫‰∫éLSMÊ†ëÂÆûÁé∞ÁöÑHBaseÁöÑÂÜôÊÄßËÉΩÊØîMySQLÈ´ò‰∫Ü‰∏Ä‰∏™Êï∞ÈáèÁ∫ßÔºåËØªÊÄßËÉΩ‰Ωé‰∫Ü‰∏Ä‰∏™Êï∞ÈáèÁ∫ß„ÄÇ ‰ºòÂåñÊñπÂºèÔºöBloom filter Êõø‰ª£‰∫åÂàÜÊü•ÊâæÔºõcompact Â∞èÊï∞‰ΩçÂ§ßÊ†ëÔºåÊèêÈ´òÊü•ËØ¢ÊÄßËÉΩ„ÄÇ Hbase ‰∏≠ÔºåÂÜÖÂ≠ò‰∏≠ËææÂà∞‰∏ÄÂÆöÈòàÂÄºÂêéÔºåÊï¥‰ΩìflushÂà∞Á£ÅÁõò‰∏ä„ÄÅÂΩ¢Êàê‰∏Ä‰∏™Êñá‰ª∂ÔºàB+Êï∞ÔºâÔºåHDFS‰∏çÊîØÊåÅupdateÊìç‰ΩúÔºåÊâÄ‰ª•HbaseÂÅöÊï¥‰ΩìflushËÄå‰∏çÊòØmerge update„ÄÇflushÂà∞Á£ÅÁõò‰∏äÁöÑÂ∞èÊ†ëÔºåÂÆöÊúü‰ºöÂêàÂπ∂Êàê‰∏Ä‰∏™Â§ßÊ†ë„ÄÇ BitSetÁªèÂ∏∏Áî®‰∫éÂ§ßËßÑÊ®°Êï∞ÊçÆÁöÑÊéíÈáçÊ£ÄÊü•„ÄÇ „ÄäJava BitsetÁ±ª„Äã „ÄäJava BitSetÔºà‰ΩçÈõÜÔºâ„Äã Â∏∏Áî®ÁÆóÊ≥ï „ÄäÂ∏∏ËßÅÊéíÂ∫èÁÆóÊ≥ïÂèäÂØπÂ∫îÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÂíåÁ©∫Èó¥Â§çÊùÇÂ∫¶„Äã ÊéíÂ∫è„ÄÅÊü•ÊâæÁÆóÊ≥ï „ÄäÂ∏∏ËßÅÊéíÂ∫èÁÆóÊ≥ïÂèäÂØπÂ∫îÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÂíåÁ©∫Èó¥Â§çÊùÇÂ∫¶„Äã ÈÄâÊã©ÊéíÂ∫è „ÄäJava‰∏≠ÁöÑÁªèÂÖ∏ÁÆóÊ≥ï‰πãÈÄâÊã©ÊéíÂ∫èÔºàSelectionSortÔºâ„Äã ÊØè‰∏ÄË∂ü‰ªéÂæÖÊéíÂ∫èÁöÑËÆ∞ÂΩï‰∏≠ÈÄâÂá∫ÊúÄÂ∞èÁöÑÂÖÉÁ¥†ÔºåÈ°∫Â∫èÊîæÂú®Â∑≤ÊéíÂ•ΩÂ∫èÁöÑÂ∫èÂàóÊúÄÂêéÔºåÁõ¥Âà∞ÂÖ®ÈÉ®ËÆ∞ÂΩïÊéíÂ∫èÂÆåÊØï„ÄÇ ÂÜíÊ≥°ÊéíÂ∫è „ÄäÂÜíÊ≥°ÊéíÂ∫èÁöÑ2ÁßçÂÜôÊ≥ï„Äã Áõ∏ÈÇªÂÖÉÁ¥†ÂâçÂêé‰∫§Êç¢„ÄÅÊääÊúÄÂ§ßÁöÑÊéíÂà∞ÊúÄÂêé„ÄÇ Êó∂Èó¥Â§çÊùÇÂ∫¶ O(n¬≤) ÊèíÂÖ•ÊéíÂ∫è „ÄäÊéíÂ∫èÁÆóÊ≥ïÊÄªÁªì‰πãÊèíÂÖ•ÊéíÂ∫è„Äã Âø´ÈÄüÊéíÂ∫è „ÄäÂùêÂú®È©¨Ê°∂‰∏äÁúãÁÆóÊ≥ïÔºöÂø´ÈÄüÊéíÂ∫è„Äã ‰∏Ä‰æßÊØîÂè¶Â§ñ‰∏ÄÊ¨°ÈÉΩÂ§ßÊàñÂ∞è„ÄÇÂΩíÂπ∂ÊéíÂ∫è „ÄäÂõæËß£ÊéíÂ∫èÁÆóÊ≥ï(Âõõ)‰πãÂΩíÂπ∂ÊéíÂ∫è„Äã ÂàÜËÄåÊ≤ª‰πãÔºåÂàÜÊàêÂ∞è‰ªΩÊéíÂ∫èÔºåÂú®ÂêàÂπ∂(ÈáçÂª∫‰∏Ä‰∏™Êñ∞Á©∫Èó¥ËøõË°åÂ§çÂà∂)„ÄÇ Â∏åÂ∞îÊéíÂ∫èTODO Â†ÜÊéíÂ∫è „ÄäÂõæËß£ÊéíÂ∫èÁÆóÊ≥ï(‰∏â)‰πãÂ†ÜÊéíÂ∫è„Äã ÊéíÂ∫èËøáÁ®ãÂ∞±ÊòØÊûÑÂª∫ÊúÄÂ§ßÂ†ÜÁöÑËøáÁ®ãÔºåÊúÄÂ§ßÂ†ÜÔºöÊØè‰∏™ÁªìÁÇπÁöÑÂÄºÈÉΩÂ§ß‰∫éÊàñÁ≠â‰∫éÂÖ∂Â∑¶Âè≥Â≠©Â≠êÁªìÁÇπÁöÑÂÄºÔºåÂ†ÜÈ°∂ÂÖÉÁ¥†ÊòØÊúÄÂ§ßÂÄº„ÄÇ ËÆ°Êï∞ÊéíÂ∫è „ÄäËÆ°Êï∞ÊéíÂ∫èÂíåÊ°∂ÊéíÂ∫è„Äã ÂíåÊ°∂ÊéíÂ∫èËøáÁ®ãÊØîËæÉÂÉèÔºåÂ∑ÆÂà´Âú®‰∫éÊ°∂ÁöÑÊï∞Èáè„ÄÇ Ê°∂ÊéíÂ∫è „Ää„ÄêÂïäÂìàÔºÅÁÆóÊ≥ï„ÄëÊúÄÂø´ÊúÄÁÆÄÂçïÁöÑÊéíÂ∫è‚Äî‚ÄîÊ°∂ÊéíÂ∫è„Äã „ÄäÊéíÂ∫èÁÆóÊ≥ïÔºà‰∏âÔºâÔºöËÆ°Êï∞ÊéíÂ∫è‰∏éÊ°∂ÊéíÂ∫è„Äã Ê°∂ÊéíÂ∫èÂ∞Ü[0,1)Âå∫Èó¥ÂàíÂàÜ‰∏∫n‰∏™Áõ∏ÂêåÁöÑÂ§ßÂ∞èÁöÑÂ≠êÂå∫Èó¥ÔºåËøô‰∫õÂ≠êÂå∫Èó¥Ë¢´Áß∞‰∏∫Ê°∂„ÄÇ ÊØè‰∏™ÈÄöÂçïÁã¨ËøõË°åÊéíÂ∫èÔºåÁÑ∂ÂêéÂÜçÈÅçÂéÜÊØè‰∏™Ê°∂„ÄÇ Âü∫Êï∞ÊéíÂ∫èÊåâÁÖß‰∏™‰Ωç„ÄÅÂçÅ‰Ωç„ÄÅÁôæ‰Ωç„ÄÅ‚Ä¶‰æùÊ¨°Êù•Êéí„ÄÇ „ÄäÊéíÂ∫èÁÆóÊ≥ïÁ≥ªÂàóÔºöÂü∫Êï∞ÊéíÂ∫è„Äã „ÄäÂü∫Êï∞ÊéíÂ∫è„Äã ‰∫åÂàÜÊü•Êâæ „Ää‰∫åÂàÜÊü•Êâæ(javaÂÆûÁé∞)„Äã Ë¶ÅÊ±ÇÂæÖÊü•ÊâæÁöÑÂ∫èÂàóÊúâÂ∫è„ÄÇ Êó∂Èó¥Â§çÊùÇÂ∫¶ O(logN)„ÄÇ „ÄäjavaÂÆûÁé∞‰∫åÂàÜÊü•Êâæ-‰∏§ÁßçÊñπÂºè„Äã while + ÈÄíÂΩí„ÄÇJava ‰∏≠ÁöÑÊéíÂ∫èÂ∑•ÂÖ∑ „ÄäArrays.sortÂíåCollections.sortÂÆûÁé∞ÂéüÁêÜËß£Êûê„Äã Collections.sortÁÆóÊ≥ïË∞ÉÁî®ÁöÑÊòØÂêàÂπ∂ÊéíÂ∫è„ÄÇ Arrays.sort() ÈááÁî®‰∫Ü2ÁßçÊéíÂ∫èÁÆóÊ≥ï ‚Äì Âü∫Êú¨Á±ªÂûãÊï∞ÊçÆ‰ΩøÁî®Âø´ÈÄüÊéíÂ∫èÊ≥ïÔºåÂØπË±°Êï∞ÁªÑ‰ΩøÁî®ÂΩíÂπ∂ÊéíÂ∫è„ÄÇ Â∏ÉÈöÜËøáÊª§Âô®Â∏∏Áî®‰∫éÂ§ßÊï∞ÊçÆÁöÑÊéíÈáçÔºåÊØîÂ¶ÇemailÔºåurl Á≠â„ÄÇÊ†∏ÂøÉÂéüÁêÜÔºöÂ∞ÜÊØèÊù°Êï∞ÊçÆÈÄöËøáËÆ°ÁÆó‰∫ßÁîü‰∏Ä‰∏™ÊåáÁ∫πÔºà‰∏Ä‰∏™Â≠óËäÇÊàñÂ§ö‰∏™Â≠óËäÇÔºå‰ΩÜ‰∏ÄÂÆöÊØîÂéüÂßãÊï∞ÊçÆË¶ÅÂ∞ëÂæàÂ§öÔºâÔºåÂÖ∂‰∏≠ÊØè‰∏Ä‰ΩçÈÉΩÊòØÈÄöËøáÈöèÊú∫ËÆ°ÁÆóËé∑ÂæóÔºåÂú®Â∞ÜÊåáÁ∫πÊò†Â∞ÑÂà∞‰∏Ä‰∏™Â§ßÁöÑÊåâ‰ΩçÂ≠òÂÇ®ÁöÑÁ©∫Èó¥‰∏≠„ÄÇÊ≥®ÊÑèÔºö‰ºöÊúâ‰∏ÄÂÆöÁöÑÈîôËØØÁéá„ÄÇ‰ºòÁÇπÔºöÁ©∫Èó¥ÂíåÊó∂Èó¥ÊïàÁéáÈÉΩÂæàÈ´ò„ÄÇÁº∫ÁÇπÔºöÈöèÁùÄÂ≠òÂÖ•ÁöÑÂÖÉÁ¥†Êï∞ÈáèÂ¢ûÂä†ÔºåËØØÁÆóÁéáÈöè‰πãÂ¢ûÂä†„ÄÇ „ÄäÂ∏ÉÈöÜËøáÊª§Âô® ‚Äì Á©∫Èó¥ÊïàÁéáÂæàÈ´òÁöÑÊï∞ÊçÆÁªìÊûÑ„Äã „ÄäÂ§ßÈáèÊï∞ÊçÆÂéªÈáçÔºöBitmapÂíåÂ∏ÉÈöÜËøáÊª§Âô®(Bloom Filter)„Äã „ÄäÂü∫‰∫éRedisÁöÑÂ∏ÉÈöÜËøáÊª§Âô®ÁöÑÂÆûÁé∞„Äã Âü∫‰∫é Redis ÁöÑ Bitmap Êï∞ÊçÆÁªìÊûÑ„ÄÇ „ÄäÁΩëÁªúÁà¨Ëô´ÔºöURLÂéªÈáçÁ≠ñÁï•‰πãÂ∏ÉÈöÜËøáÊª§Âô®(BloomFilter)ÁöÑ‰ΩøÁî®„Äã ‰ΩøÁî®Java‰∏≠ÁöÑ BitSet Á±ª Âíå Âä†ÊùÉÂíåhashÁÆóÊ≥ï„ÄÇ Â≠óÁ¨¶‰∏≤ÊØîËæÉKMP ÁÆóÊ≥ïKMPÔºöKnuth-Morris-PrattÁÆóÊ≥ïÔºàÁÆÄÁß∞KMPÔºâÊ†∏ÂøÉÂéüÁêÜÊòØÂà©Áî®‰∏Ä‰∏™‚ÄúÈÉ®ÂàÜÂåπÈÖçË°®‚ÄùÔºåË∑≥ËøáÂ∑≤ÁªèÂåπÈÖçËøáÁöÑÂÖÉÁ¥†„ÄÇ „ÄäÂ≠óÁ¨¶‰∏≤ÂåπÈÖçÁöÑKMPÁÆóÊ≥ï„Äã Ê∑±Â∫¶‰ºòÂÖà„ÄÅÂπøÂ∫¶‰ºòÂÖà „ÄäÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢BFSÂíåÊ∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢DFS„Äã Ë¥™ÂøÉÁÆóÊ≥ï „ÄäÁÆóÊ≥ïÔºöË¥™Â©™ÁÆóÊ≥ïÂü∫Á°Ä„Äã „ÄäÂ∏∏ËßÅÁÆóÊ≥ïÂèäÈóÆÈ¢òÂú∫ÊôØ‚Äî‚ÄîË¥™ÂøÉÁÆóÊ≥ï„Äã ÂõûÊ∫ØÁÆóÊ≥ï „Ää ‰∫îÂ§ßÂ∏∏Áî®ÁÆóÊ≥ï‰πãÂõõÔºöÂõûÊ∫ØÊ≥ï„Äã Ââ™ÊûùÁÆóÊ≥ï „ÄäŒ±-Œ≤Ââ™ÊûùÁÆóÊ≥ï„Äã Âä®ÊÄÅËßÑÂàí „ÄäËØ¶Ëß£Âä®ÊÄÅËßÑÂàí‚Äî‚ÄîÈÇπÂçöËÆ≤Âä®ÊÄÅËßÑÂàí„Äã „ÄäÂä®ÊÄÅËßÑÂàíÁÆóÊ≥ïÁöÑ‰∏™‰∫∫ÁêÜËß£„Äã Êú¥Á¥†Ë¥ùÂè∂ÊñØ „ÄäÂ∏¶‰Ω†ÊêûÊáÇÊú¥Á¥†Ë¥ùÂè∂ÊñØÂàÜÁ±ªÁÆóÊ≥ï„Äã P(B|A)=P(A|B)P(B)/P(A) „ÄäË¥ùÂè∂ÊñØÊé®Êñ≠ÂèäÂÖ∂‰∫íËÅîÁΩëÂ∫îÁî®1„Äã „ÄäË¥ùÂè∂ÊñØÊé®Êñ≠ÂèäÂÖ∂‰∫íËÅîÁΩëÂ∫îÁî®2„Äã Êé®ËçêÁÆóÊ≥ï „ÄäÊé®ËçêÁÆóÊ≥ïÁªºËø∞„Äã „ÄäTOP 10 ÂºÄÊ∫êÁöÑÊé®ËçêÁ≥ªÁªüÁÆÄ‰ªã„Äã ÊúÄÂ∞èÁîüÊàêÊ†ëÁÆóÊ≥ï „ÄäÁÆóÊ≥ïÂØºËÆ∫‚ÄìÊúÄÂ∞èÁîüÊàêÊ†ëÔºàKruskalÂíåPrimÁÆóÊ≥ïÔºâ„Äã ÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ï „ÄäDijkstraÁÆóÊ≥ïËØ¶Ëß£„Äã Âπ∂ÂèëÂ§öÁ∫øÁ®ã „Ää40‰∏™JavaÂ§öÁ∫øÁ®ãÈóÆÈ¢òÊÄªÁªì„Äã Á∫øÁ®ãÂÆâÂÖ® „ÄäJavaÂπ∂ÂèëÁºñÁ®ã‚Äî‚ÄîÁ∫øÁ®ãÂÆâÂÖ®ÂèäËß£ÂÜ≥Êú∫Âà∂ÁÆÄ‰ªã„Äã ‰∏ÄËá¥ÊÄß„ÄÅ‰∫ãÂä°‰∫ãÂä° ACID ÁâπÊÄß „ÄäÊï∞ÊçÆÂ∫ì‰∫ãÂä°ACIDÁâπÊÄß„Äã ‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´ Êú™Êèê‰∫§ËØªÔºö‰∏Ä‰∏™‰∫ãÂä°ÂèØ‰ª•ËØªÂèñÂè¶‰∏Ä‰∏™Êú™Êèê‰∫§ÁöÑÊï∞ÊçÆÔºåÂÆπÊòìÂá∫Áé∞ËÑèËØªÁöÑÊÉÖÂÜµ„ÄÇ ËØªÊèê‰∫§Ôºö‰∏Ä‰∏™‰∫ãÂä°Á≠âÂè¶Â§ñ‰∏Ä‰∏™‰∫ãÂä°Êèê‰∫§‰πãÂêéÊâçÂèØ‰ª•ËØªÂèñÊï∞ÊçÆÔºå‰ΩÜ‰ºöÂá∫Áé∞‰∏çÂèØÈáçÂ§çËØªÁöÑÊÉÖÂÜµÔºàÂ§öÊ¨°ËØªÂèñÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºâÔºåËØªÂèñËøáÁ®ã‰∏≠Âá∫Áé∞UPDATEÊìç‰ΩúÔºå‰ºöÂ§ö„ÄÇÔºàÂ§ßÂ§öÊï∞Êï∞ÊçÆÂ∫ìÈªòËÆ§Á∫ßÂà´ÊòØRCÔºåÊØîÂ¶ÇSQL ServerÔºåOracleÔºâÔºåËØªÂèñÁöÑÊó∂ÂÄô‰∏çÂèØ‰ª•‰øÆÊîπ„ÄÇ ÂèØÈáçÂ§çËØªÔºö Âêå‰∏Ä‰∏™‰∫ãÂä°ÈáåÁ°Æ‰øùÊØèÊ¨°ËØªÂèñÁöÑÊó∂ÂÄôÔºåËé∑ÂæóÁöÑÊòØÂêåÊ†∑ÁöÑÊï∞ÊçÆÔºå‰ΩÜ‰∏ç‰øùÈöúÂéüÂßãÊï∞ÊçÆË¢´ÂÖ∂‰ªñ‰∫ãÂä°Êõ¥Êñ∞ÔºàÂπªËØªÔºâÔºåMysql InnoDB Â∞±ÊòØËøô‰∏™Á∫ßÂà´„ÄÇ Â∫èÂàóÂåñÔºöÊâÄÊúâ‰∫ãÁâ©‰∏≤Ë°åÂ§ÑÁêÜÔºàÁâ∫Áâ≤‰∫ÜÊïàÁéáÔºâ „ÄäÁêÜËß£‰∫ãÂä°ÁöÑ4ÁßçÈöîÁ¶ªÁ∫ßÂà´„Äã Êï∞ÊçÆÂ∫ì‰∫ãÂä°ÁöÑÂõõÂ§ßÁâπÊÄßÂèä‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ „ÄäMySQLÁöÑInnoDBÁöÑÂπªËØªÈóÆÈ¢ò „Äã ÂπªËØªÁöÑ‰æãÂ≠êÈùûÂ∏∏Ê∏ÖÊ•ö„ÄÇ ÈÄöËøá SELECT ‚Ä¶ FOR UPDATE Ëß£ÂÜ≥„ÄÇ „Ää‰∏ÄÁØáÊñáÁ´†Â∏¶‰Ω†ËØªÊáÇMySQLÂíåInnoDB„Äã ÂõæËß£ËÑèËØª„ÄÅ‰∏çÂèØÈáçÂ§çËØª„ÄÅÂπªËØªÈóÆÈ¢ò„ÄÇ MVCC „Ää„Äêmysql„ÄëÂÖ≥‰∫éinnodb‰∏≠MVCCÁöÑ‰∏Ä‰∫õÁêÜËß£„Äã innodb ‰∏≠ MVCC Áî®Âú® Repeatable-Read ÈöîÁ¶ªÁ∫ßÂà´„ÄÇ MVCC ‰ºö‰∫ßÁîüÂπªËØªÈóÆÈ¢òÔºàÊõ¥Êñ∞Êó∂ÂºÇÂ∏∏„ÄÇÔºâ „ÄäËΩªÊùæÁêÜËß£MYSQL MVCC ÂÆûÁé∞Êú∫Âà∂„Äã ÈÄöËøáÈöêËóèÁâàÊú¨ÂàóÊù•ÂÆûÁé∞ MVCC ÊéßÂà∂Ôºå‰∏ÄÂàóËÆ∞ÂΩïÂàõÂª∫Êó∂Èó¥„ÄÅ‰∏ÄÂàóËÆ∞ÂΩïÂà†Èô§Êó∂Èó¥ÔºåËøôÈáåÁöÑÊó∂Èó¥ ÊØèÊ¨°Âè™Êìç‰ΩúÊØîÂΩìÂâçÁâàÊú¨Â∞èÔºàÊàñÁ≠â‰∫éÔºâÁöÑ Ë°å„ÄÇ ÈîÅJava‰∏≠ÁöÑÈîÅÂíåÂêåÊ≠•Á±ª „ÄäJava‰∏≠ÁöÑÈîÅÂàÜÁ±ª„Äã ‰∏ªË¶ÅÂåÖÊã¨ synchronized„ÄÅReentrantLock„ÄÅÂíå ReadWriteLock„ÄÇ „ÄäJavaÂπ∂Âèë‰πãAQSËØ¶Ëß£„Äã „ÄäJava‰∏≠‰ø°Âè∑Èáè Semaphore„Äã ÊúâÊï∞ÈáèÊéßÂà∂ Áî≥ËØ∑Áî® acquireÔºåÁî≥ËØ∑‰∏çË¶ÅÂàôÈòªÂ°ûÔºõÈáäÊîæÁî® release„ÄÇ „ÄäjavaÂºÄÂèë‰∏≠ÁöÑMutex vs Semaphore„Äã ÁÆÄÂçïÁöÑËØ¥ Â∞±ÊòØMutexÊòØÊéíÂÆÉÁöÑÔºåÂè™Êúâ‰∏Ä‰∏™ÂèØ‰ª•Ëé∑ÂèñÂà∞ËµÑÊ∫êÔºå Semaphore‰πüÂÖ∑ÊúâÊéíÂÆÉÊÄßÔºå‰ΩÜÂèØ‰ª•ÂÆö‰πâÂ§ö‰∏™ÂèØ‰ª•Ëé∑ÂèñÁöÑËµÑÊ∫êÁöÑÂØπË±°„ÄÇ ÂÖ¨Âπ≥ÈîÅ &amp; ÈùûÂÖ¨Âπ≥ÈîÅÂÖ¨Âπ≥ÈîÅÁöÑ‰ΩúÁî®Â∞±ÊòØ‰∏•Ê†ºÊåâÁÖßÁ∫øÁ®ãÂêØÂä®ÁöÑÈ°∫Â∫èÊù•ÊâßË°åÁöÑÔºå‰∏çÂÖÅËÆ∏ÂÖ∂‰ªñÁ∫øÁ®ãÊèíÈòüÊâßË°åÁöÑÔºõËÄåÈùûÂÖ¨Âπ≥ÈîÅÊòØÂÖÅËÆ∏ÊèíÈòüÁöÑ„ÄÇ „ÄäÂÖ¨Âπ≥ÈîÅ‰∏éÈùûÂÖ¨Âπ≥ÈîÅ„Äã ÈªòËÆ§ÊÉÖÂÜµ‰∏ã ReentrantLock Âíå synchronized ÈÉΩÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇReentrantLock ÂèØ‰ª•ËÆæÁΩÆÊàêÂÖ¨Âπ≥ÈîÅ„ÄÇ ÊÇ≤ËßÇÈîÅÊÇ≤ËßÇÈîÅÂ¶ÇÊûú‰ΩøÁî®‰∏çÂΩìÔºàÈîÅÁöÑÊù°Êï∞ËøáÂ§öÔºâÔºå‰ºöÂºïËµ∑ÊúçÂä°Â§ßÈù¢ÁßØÁ≠âÂæÖ„ÄÇÊé®Ëçê‰ºòÂÖà‰ΩøÁî®‰πêËßÇÈîÅ+ÈáçËØï„ÄÇ „Ää„ÄêMySQL„ÄëÊÇ≤ËßÇÈîÅ&amp;‰πêËßÇÈîÅ„Äã ‰πêËßÇÈîÅÁöÑÊñπÂºèÔºöÁâàÊú¨Âè∑+ÈáçËØïÊñπÂºè ÊÇ≤ËßÇÈîÅÔºöÈÄöËøá select ‚Ä¶ for update ËøõË°åË°åÈîÅ(‰∏çÂèØËØª„ÄÅ‰∏çÂèØÂÜôÔºåshare ÈîÅÂèØËØª‰∏çÂèØÂÜô)„ÄÇ „ÄäMysqlÊü•ËØ¢ËØ≠Âè•‰ΩøÁî®select.. for updateÂØºËá¥ÁöÑÊï∞ÊçÆÂ∫ìÊ≠ªÈîÅÂàÜÊûê„Äã mysqlÁöÑinnodbÂ≠òÂÇ®ÂºïÊìéÂÆûÂä°ÈîÅËôΩÁÑ∂ÊòØÈîÅË°åÔºå‰ΩÜÂÆÉÂÜÖÈÉ®ÊòØÈîÅÁ¥¢ÂºïÁöÑ„ÄÇ ÈîÅÁõ∏ÂêåÊï∞ÊçÆÁöÑ‰∏çÂêåÁ¥¢ÂºïÊù°‰ª∂ÂèØËÉΩ‰ºöÂºïËµ∑Ê≠ªÈîÅ„ÄÇ „ÄäMysqlÂπ∂ÂèëÊó∂ÁªèÂÖ∏Â∏∏ËßÅÁöÑÊ≠ªÈîÅÂéüÂõ†ÂèäËß£ÂÜ≥ÊñπÊ≥ï„Äã ‰πêËßÇÈîÅ &amp; CAS „Ää‰πêËßÇÈîÅÁöÑ‰∏ÄÁßçÂÆûÁé∞ÊñπÂºè‚Äî‚ÄîCAS„Äã ÂíåMySQL‰πêËßÇÈîÅÊñπÂºèÁõ∏‰ººÔºåÂè™‰∏çËøáÊòØÈÄöËøáÂíåÂéüÂÄºËøõË°åÊØîËæÉ„ÄÇ ABA ÈóÆÈ¢òÁî±‰∫éÈ´òÂπ∂ÂèëÔºåÂú®CAS‰∏ãÔºåÊõ¥Êñ∞ÂêéÂèØËÉΩÊ≠§AÈùûÂΩºA„ÄÇÈÄöËøáÁâàÊú¨Âè∑ÂèØ‰ª•Ëß£ÂÜ≥ÔºåÁ±ª‰ºº‰∫é‰∏äÊñáMysql ‰∏≠ÊèêÂà∞ÁöÑÁöÑ‰πêËßÇÈîÅ„ÄÇ „ÄäJava CAS ÂíåABAÈóÆÈ¢ò„Äã „ÄäJava ‰∏≠ ABAÈóÆÈ¢òÂèäÈÅøÂÖç„Äã AtomicStampedReference Âíå AtomicStampedReference„ÄÇ CopyOnWriteÂÆπÂô®ÂèØ‰ª•ÂØπCopyOnWriteÂÆπÂô®ËøõË°åÂπ∂ÂèëÁöÑËØªÔºåËÄå‰∏çÈúÄË¶ÅÂä†ÈîÅ„ÄÇCopyOnWriteÂπ∂ÂèëÂÆπÂô®Áî®‰∫éËØªÂ§öÂÜôÂ∞ëÁöÑÂπ∂ÂèëÂú∫ÊôØ„ÄÇÊØîÂ¶ÇÁôΩÂêçÂçïÔºåÈªëÂêçÂçïÔºåÂïÜÂìÅÁ±ªÁõÆÁöÑËÆøÈóÆÂíåÊõ¥Êñ∞Âú∫ÊôØÔºå‰∏çÈÄÇÂêàÈúÄË¶ÅÊï∞ÊçÆÂº∫‰∏ÄËá¥ÊÄßÁöÑÂú∫ÊôØ„ÄÇ „ÄäJAVA‰∏≠ÂÜôÊó∂Â§çÂà∂(Copy-On-Write)MapÂÆûÁé∞„Äã ÂÆûÁé∞ËØªÂÜôÂàÜÁ¶ªÔºåËØªÂèñÂèëÁîüÂú®ÂéüÂßãÊï∞ÊçÆ‰∏äÔºåÂÜôÂÖ•ÂèëÁîüÂú®ÂâØÊú¨‰∏ä„ÄÇ ‰∏çÁî®Âä†ÈîÅÔºåÈÄöËøáÊúÄÁªà‰∏ÄËá¥ÂÆûÁé∞‰∏ÄËá¥ÊÄß„ÄÇ „ÄäËÅäËÅäÂπ∂Âèë-Java‰∏≠ÁöÑCopy-On-WriteÂÆπÂô®„Äã RingBuffer „ÄäÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÊó†ÈîÅRingBufferÁöÑÂÆûÁé∞„Äê‰∏Ä‰∏™ËØªÁ∫øÁ®ãÔºå‰∏Ä‰∏™ÂÜôÁ∫øÁ®ã„Äë„Äã ÂèØÈáçÂÖ•ÈîÅ &amp; ‰∏çÂèØÈáçÂÖ•ÈîÅ „ÄäÂèØÈáçÂÖ•ÈîÅÂíå‰∏çÂèØÈáçÂÖ•ÈîÅ„Äã ÈÄöËøáÁÆÄÂçï‰ª£Á†Å‰∏æ‰æãËØ¥ÊòéÂèØÈáçÂÖ•ÈîÅÂíå‰∏çÂèØÈáçÂÖ•ÈîÅ„ÄÇ ÂèØÈáçÂÖ•ÈîÅÊåáÂêå‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÂÜçÊ¨°Ëé∑Âæó‰πãÂâçÂ∑≤ÁªèËé∑ÂæóÁöÑÈîÅ„ÄÇ ÂèØÈáçÂÖ•ÈîÅÂèØ‰ª•Áî®Êà∑ÈÅøÂÖçÊ≠ªÈîÅ„ÄÇ Java‰∏≠ÁöÑÂèØÈáçÂÖ•ÈîÅÔºösynchronized Âíå java.util.concurrent.locks.ReentrantLock „ÄäReenTrantLockÂèØÈáçÂÖ•ÈîÅÔºàÂíåsynchronizedÁöÑÂå∫Âà´ÔºâÊÄªÁªì„Äã synchronized ‰ΩøÁî®Êñπ‰æøÔºåÁºñËØëÂô®Êù•Âä†ÈîÅÔºåÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇ ReenTrantLock ‰ΩøÁî®ÁÅµÊ¥ªÔºåÈîÅÁöÑÂÖ¨Âπ≥ÊÄßÂèØ‰ª•ÂÆöÂà∂„ÄÇ Áõ∏ÂêåÂä†ÈîÅÂú∫ÊôØ‰∏ãÔºåÊé®Ëçê‰ΩøÁî® synchronized„ÄÇ ‰∫íÊñ•ÈîÅ &amp; ÂÖ±‰∫´ÈîÅ‰∫íÊñ•ÈîÅÔºöÂêåÊó∂Âè™ËÉΩÊúâ‰∏Ä‰∏™Á∫øÁ®ãËé∑ÂæóÈîÅ„ÄÇÊØîÂ¶ÇÔºåReentrantLock ÊòØ‰∫íÊñ•ÈîÅÔºåReadWriteLock ‰∏≠ÁöÑÂÜôÈîÅÊòØ‰∫íÊñ•ÈîÅ„ÄÇÂÖ±‰∫´ÈîÅÔºöÂèØ‰ª•ÊúâÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂ÊàñÁöÑÈîÅ„ÄÇÊØîÂ¶ÇÔºåSemaphore„ÄÅCountDownLatch ÊòØÂÖ±‰∫´ÈîÅÔºåReadWriteLock ‰∏≠ÁöÑËØªÈîÅÊòØÂÖ±‰∫´ÈîÅ„ÄÇ „ÄäReadWriteLockÂú∫ÊôØÂ∫îÁî®„Äã Ê≠ªÈîÅ „Ää‚ÄúÊ≠ªÈîÅ‚ÄùÂõõ‰∏™ÂøÖË¶ÅÊù°‰ª∂ÁöÑÂêàÁêÜËß£Èáä„Äã ‰∫íÊñ•„ÄÅÊåÅÊúâ„ÄÅ‰∏çÂèØÂâ•Â§∫„ÄÅ‰∏çÂèØÂâ•Â§∫„ÄÇ JavaÂ¶Ç‰ΩïÊü•ÁúãÊ≠ªÈîÅÔºü JConsole ÂèØ‰ª•ËØÜÂà´Ê≠ªÈîÅ„ÄÇ javaÂ§öÁ∫øÁ®ãÁ≥ªÂàóÔºöÊ≠ªÈîÅÂèäÊ£ÄÊµã jstack ÂèØ‰ª•ÊòæÁ§∫Ê≠ªÈîÅ„ÄÇ Êìç‰ΩúÁ≥ªÁªüËÆ°ÁÆóÊú∫ÂéüÁêÜ „ÄäÊìç‰ΩúÁ≥ªÁªüÂü∫Á°ÄÁü•ËØÜ‚Äî‚ÄîÊìç‰ΩúÁ≥ªÁªüÁöÑÂéüÁêÜÔºåÁ±ªÂûãÂíåÁªìÊûÑ„Äã CPUÂ§öÁ∫ßÁºìÂ≠òÂÖ∏ÂûãÁöÑ CPU Êúâ‰∏âÁ∫ßÁºìÂ≠òÔºåË∑ùÁ¶ªÊ†∏ÂøÉË∂äËøëÔºåÈÄüÂ∫¶Ë∂äÂø´ÔºåÁ©∫Èó¥Ë∂äÂ∞è„ÄÇL1 ‰∏ÄËà¨ 32kÔºåL2 ‰∏ÄËà¨ 256kÔºåL3 ‰∏ÄËà¨12M„ÄÇÂÜÖÂ≠òÈÄüÂ∫¶ÈúÄË¶Å200‰∏™ CPU Âë®ÊúüÔºåCPU ÁºìÂ≠òÈúÄË¶Å1‰∏™CPUÂë®Êúü„ÄÇ „Ää‰ªéJavaËßÜËßíÁêÜËß£CPUÁºìÂ≠òÂíå‰º™ÂÖ±‰∫´„Äã ËøõÁ®ãTODO Á∫øÁ®ã „ÄäÁ∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂèäÁä∂ÊÄÅËΩ¨Êç¢ËØ¶Ëß£„Äã ÂçèÁ®ã „ÄäÁªàÁªìpythonÂçèÁ®ã‚Äî-‰ªéyieldÂà∞actorÊ®°ÂûãÁöÑÂÆûÁé∞„Äã Á∫øÁ®ãÁöÑË∞ÉÂ∫¶ÊòØÁî±Êìç‰ΩúÁ≥ªÁªüË¥üË¥£ÔºåÂçèÁ®ãË∞ÉÂ∫¶ÊòØÁ®ãÂ∫èËá™Ë°åË¥üË¥£ ‰∏éÁ∫øÁ®ãÁõ∏ÊØîÔºåÂçèÁ®ãÂáèÂ∞ë‰∫ÜÊó†Ë∞ìÁöÑÊìç‰ΩúÁ≥ªÁªüÂàáÊç¢. ÂÆûÈôÖ‰∏äÂΩìÈÅáÂà∞IOÊìç‰ΩúÊó∂ÂÅöÂàáÊç¢ÊâçÊõ¥ÊúâÊÑè‰πâÔºåÔºàÂõ†‰∏∫IOÊìç‰Ωú‰∏çÁî®Âç†Áî®CPUÔºâÔºåÂ¶ÇÊûúÊ≤°ÈÅáÂà∞IOÊìç‰ΩúÔºåÊåâÁÖßÊó∂Èó¥ÁâáÂàáÊç¢. Linux „ÄäLinux ÂëΩ‰ª§Â§ßÂÖ®„Äã ËÆæËÆ°Ê®°ÂºèËÆæËÆ°Ê®°ÂºèÁöÑÂÖ≠Â§ßÂéüÂàô „ÄäËÆæËÆ°Ê®°ÂºèÁöÑÂÖ≠Â§ßÂéüÂàô„Äã ÂºÄÈó≠ÂéüÂàôÔºöÂØπÊâ©Â±ïÂºÄÊîæ,ÂØπ‰øÆÊîπÂÖ≥Èó≠ÔºåÂ§ö‰ΩøÁî®ÊäΩË±°Á±ªÂíåÊé•Âè£„ÄÇ ÈáåÊ∞è‰ª£Êç¢ÂéüÂàôÔºöÂü∫Á±ªÂèØ‰ª•Ë¢´Â≠êÁ±ªÊõøÊç¢Ôºå‰ΩøÁî®ÊäΩË±°Á±ªÁªßÊâø,‰∏ç‰ΩøÁî®ÂÖ∑‰ΩìÁ±ªÁªßÊâø„ÄÇ ‰æùËµñÂÄíËΩ¨ÂéüÂàôÔºöË¶Å‰æùËµñ‰∫éÊäΩË±°,‰∏çË¶Å‰æùËµñ‰∫éÂÖ∑‰ΩìÔºåÈíàÂØπÊé•Âè£ÁºñÁ®ã,‰∏çÈíàÂØπÂÆûÁé∞ÁºñÁ®ã„ÄÇ Êé•Âè£ÈöîÁ¶ªÂéüÂàôÔºö‰ΩøÁî®Â§ö‰∏™ÈöîÁ¶ªÁöÑÊé•Âè£,ÊØî‰ΩøÁî®Âçï‰∏™Êé•Âè£Â•ΩÔºåÂª∫Á´ãÊúÄÂ∞èÁöÑÊé•Âè£„ÄÇ Ëø™Á±≥ÁâπÊ≥ïÂàôÔºö‰∏Ä‰∏™ËΩØ‰ª∂ÂÆû‰ΩìÂ∫îÂΩìÂ∞ΩÂèØËÉΩÂ∞ëÂú∞‰∏éÂÖ∂‰ªñÂÆû‰ΩìÂèëÁîüÁõ∏‰∫í‰ΩúÁî®ÔºåÈÄöËøá‰∏≠Èó¥Á±ªÂª∫Á´ãËÅîÁ≥ª„ÄÇ ÂêàÊàêÂ§çÁî®ÂéüÂàôÔºöÂ∞ΩÈáè‰ΩøÁî®ÂêàÊàê/ËÅöÂêà,ËÄå‰∏çÊòØ‰ΩøÁî®ÁªßÊâø„ÄÇ 23ÁßçÂ∏∏ËßÅËÆæËÆ°Ê®°Âºè „ÄäËÆæËÆ°Ê®°Âºè„Äã „Ää23ÁßçËÆæËÆ°Ê®°ÂºèÂÖ®Ëß£Êûê„Äã Â∫îÁî®Âú∫ÊôØ „ÄäÁªÜÊï∞JDKÈáåÁöÑËÆæËÆ°Ê®°Âºè„Äã ÁªìÊûÑÂûãÊ®°ÂºèÔºö ÈÄÇÈÖçÂô®ÔºöÁî®Êù•Êää‰∏Ä‰∏™Êé•Âè£ËΩ¨ÂåñÊàêÂè¶‰∏Ä‰∏™Êé•Âè£ÔºåÂ¶Ç java.util.Arrays#asList()„ÄÇ Ê°•Êé•Ê®°ÂºèÔºöËøô‰∏™Ê®°ÂºèÂ∞ÜÊäΩË±°ÂíåÊäΩË±°Êìç‰ΩúÁöÑÂÆûÁé∞ËøõË°å‰∫ÜËß£ËÄ¶ÔºåËøôÊ†∑‰ΩøÂæóÊäΩË±°ÂíåÂÆûÁé∞ÂèØ‰ª•Áã¨Á´ãÂú∞ÂèòÂåñÔºåÂ¶ÇJDBCÔºõ ÁªÑÂêàÊ®°ÂºèÔºö‰ΩøÂæóÂÆ¢Êà∑Á´ØÁúãÊù•Âçï‰∏™ÂØπË±°ÂíåÂØπË±°ÁöÑÁªÑÂêàÊòØÂêåÁ≠âÁöÑ„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÊüê‰∏™Á±ªÂûãÁöÑÊñπÊ≥ïÂêåÊó∂‰πüÊé•ÂèóËá™Ë∫´Á±ªÂûã‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂ¶Ç Map.putAllÔºåList.addAll„ÄÅSet.addAll„ÄÇ Ë£ÖÈ•∞ËÄÖÊ®°ÂºèÔºöÂä®ÊÄÅÁöÑÁªô‰∏Ä‰∏™ÂØπË±°ÈôÑÂä†È¢ùÂ§ñÁöÑÂäüËÉΩÔºåËøô‰πüÊòØÂ≠êÁ±ªÁöÑ‰∏ÄÁßçÊõø‰ª£ÊñπÂºèÔºåÂ¶Ç java.util.Collections#checkedList|Map|Set|SortedSet|SortedMap„ÄÇ ‰∫´ÂÖÉÊ®°ÂºèÔºö‰ΩøÁî®ÁºìÂ≠òÊù•Âä†ÈÄüÂ§ßÈáèÂ∞èÂØπË±°ÁöÑËÆøÈóÆÊó∂Èó¥ÔºåÂ¶Ç valueOf(int)„ÄÇ ‰ª£ÁêÜÊ®°ÂºèÔºö‰ª£ÁêÜÊ®°ÂºèÊòØÁî®‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂØπË±°Êù•‰ª£Êõø‰∏Ä‰∏™Â§çÊùÇÁöÑÊàñËÄÖÂàõÂª∫ËÄóÊó∂ÁöÑÂØπË±°ÔºåÂ¶Ç java.lang.reflect.Proxy ÂàõÂª∫Ê®°Âºè: ÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÔºöÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂçèËÆÆÊù•ÁîüÊàê‰∏ÄÁ≥ªÂàóÁöÑÁõ∏ÂÖ≥ÊàñËÄÖÁã¨Á´ãÁöÑÂØπË±°ÔºåËÄå‰∏çÁî®ÊåáÂÆöÂÖ∑‰ΩìÂØπË±°ÁöÑÁ±ªÂûãÔºåÂ¶Ç java.util.Calendar#getInstance()„ÄÇ Âª∫ÈÄ†Ê®°Âºè(Builder)ÔºöÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªÊù•ÊûÑÂª∫Âè¶‰∏Ä‰∏™Á±ªÁöÑÂÆû‰æãÔºå‰ª•ÁÆÄÂåñÂ§çÊùÇÂØπË±°ÁöÑÂàõÂª∫ÔºåÂ¶ÇÔºöjava.lang.StringBuilder#append()„ÄÇ Â∑•ÂéÇÊñπÊ≥ïÔºöÂ∞±ÊòØ ‰∏Ä‰∏™Ëøî* ÂõûÂÖ∑‰ΩìÂØπË±°ÁöÑÊñπÊ≥ïÔºåËÄå‰∏çÊòØÂ§ö‰∏™ÔºåÂ¶Ç java.lang.Object#toString()„ÄÅjava.lang.Class#newInstance()„ÄÇ ÂéüÂûãÊ®°ÂºèÔºö‰ΩøÂæóÁ±ªÁöÑÂÆû‰æãËÉΩÂ§üÁîüÊàêËá™Ë∫´ÁöÑÊã∑Ë¥ù„ÄÅÂ¶ÇÔºöjava.lang.Object#clone()„ÄÇ Âçï‰æãÊ®°ÂºèÔºöÂÖ®Â±ÄÂè™Êúâ‰∏Ä‰∏™ÂÆû‰æãÔºåÂ¶Ç java.lang.Runtime#getRuntime()„ÄÇ Ë°å‰∏∫Ê®°ÂºèÔºö Ë¥£‰ªªÈìæÊ®°ÂºèÔºöÈÄöËøáÊääËØ∑Ê±Ç‰ªé‰∏Ä‰∏™ÂØπË±°‰º†ÈÄíÂà∞ÈìæÊù°‰∏≠‰∏ã‰∏Ä‰∏™ÂØπË±°ÁöÑÊñπÂºèÔºåÁõ¥Âà∞ËØ∑Ê±ÇË¢´Â§ÑÁêÜÂÆåÊØïÔºå‰ª•ÂÆûÁé∞ÂØπË±°Èó¥ÁöÑËß£ËÄ¶„ÄÇÂ¶Ç javax.servlet.Filter#doFilter()„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÔºöÂ∞ÜÊìç‰ΩúÂ∞ÅË£ÖÂà∞ÂØπË±°ÂÜÖÔºå‰ª•‰æøÂ≠òÂÇ®Ôºå‰º†ÈÄíÂíåËøîÂõûÔºåÂ¶ÇÔºöjava.lang.Runnable„ÄÇ Ëß£ÈáäÂô®Ê®°ÂºèÔºöÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ËØ≠Ë®ÄÁöÑËØ≠Ê≥ïÔºåÁÑ∂ÂêéËß£ÊûêÁõ∏Â∫îËØ≠Ê≥ïÁöÑËØ≠Âè•ÔºåÂ¶ÇÔºåjava.text.FormatÔºåjava.text.Normalizer„ÄÇ Ëø≠‰ª£Âô®Ê®°ÂºèÔºöÊèê‰æõ‰∏Ä‰∏™‰∏ÄËá¥ÁöÑÊñπÊ≥ïÊù•È°∫Â∫èËÆøÈóÆÈõÜÂêà‰∏≠ÁöÑÂØπË±°ÔºåÂ¶Ç java.util.Iterator„ÄÇ ‰∏≠‰ªãËÄÖÊ®°ÂºèÔºöÈÄöËøá‰ΩøÁî®‰∏Ä‰∏™‰∏≠Èó¥ÂØπË±°Êù•ËøõË°åÊ∂àÊÅØÂàÜÂèë‰ª•ÂèäÂáèÂ∞ëÁ±ª‰πãÈó¥ÁöÑÁõ¥Êé•‰æùËµñÔºåjava.lang.reflect.Method#invoke()„ÄÇ Á©∫ÂØπË±°Ê®°ÂºèÔºöÂ¶Ç java.util.Collections#emptyList()„ÄÇ ËßÇÂØüËÄÖÊ®°ÂºèÔºöÂÆÉ‰ΩøÂæó‰∏Ä‰∏™ÂØπË±°ÂèØ‰ª•ÁÅµÊ¥ªÁöÑÂ∞ÜÊ∂àÊÅØÂèëÈÄÅÁªôÊÑüÂÖ¥Ë∂£ÁöÑÂØπË±°ÔºåÂ¶Ç java.util.EventListener„ÄÇ Ê®°ÊùøÊñπÊ≥ïÊ®°ÂºèÔºöËÆ©Â≠êÁ±ªÂèØ‰ª•ÈáçÂÜôÊñπÊ≥ïÁöÑ‰∏ÄÈÉ®ÂàÜÔºåËÄå‰∏çÊòØÊï¥‰∏™ÈáçÂÜôÔºåÂ¶Ç java.util.Collections#sort()„ÄÇ „ÄäSpring-Ê∂âÂèäÂà∞ÁöÑËÆæËÆ°Ê®°ÂºèÊ±áÊÄª„Äã „ÄäMybatis‰ΩøÁî®ÁöÑËÆæËÆ°Ê®°Âºè„Äã Âçï‰æãÊ®°Âºè „ÄäÂçï‰æãÊ®°ÂºèÁöÑ‰∏âÁßçÂÆûÁé∞ ‰ª•ÂèäÂêÑËá™ÁöÑ‰ºòÁº∫ÁÇπ„Äã „ÄäÂçï‰æãÊ®°ÂºèÔºçÔºçÂèçÂ∞ÑÔºçÔºçÈò≤Ê≠¢Â∫èÂàóÂåñÁ†¥ÂùèÂçï‰æãÊ®°Âºè„Äã ‰ΩøÁî®Êûö‰∏æÁ±ªÂûã„ÄÇ Ë¥£‰ªªÈìæÊ®°ÂºèTODO MVC „ÄäMVC Ê®°Âºè„Äã Ê®°Âûã(model)ÔºçËßÜÂõæ(view)ÔºçÊéßÂà∂Âô®(controller) IOC „ÄäÁêÜËß£ IOC„Äã „ÄäIOC ÁöÑÁêÜËß£‰∏éËß£Èáä„Äã Ê≠£ÂêëÊéßÂà∂Ôºö‰º†ÁªüÈÄöËøánewÁöÑÊñπÂºè„ÄÇÂèçÂêëÊéßÂà∂ÔºåÈÄöËøáÂÆπÂô®Ê≥®ÂÖ•ÂØπË±°„ÄÇ ‰ΩúÁî®ÔºöÁî®‰∫éÊ®°ÂùóËß£ËÄ¶„ÄÇ DIÔºöDependency InjectionÔºåÂç≥‰æùËµñÊ≥®ÂÖ•ÔºåÂè™ÂÖ≥ÂøÉËµÑÊ∫ê‰ΩøÁî®Ôºå‰∏çÂÖ≥ÂøÉËµÑÊ∫êÊù•Ê∫ê„ÄÇ AOP „ÄäËΩªÊùæÁêÜËß£AOP(Èù¢ÂêëÂàáÈù¢ÁºñÁ®ã)„Äã „ÄäSpring AOPËØ¶Ëß£„Äã „ÄäSpring AOPÁöÑÂÆûÁé∞ÂéüÁêÜ„Äã Spring AOP‰ΩøÁî®ÁöÑÂä®ÊÄÅ‰ª£ÁêÜÔºå‰∏ªË¶ÅÊúâ‰∏§ÁßçÊñπÂºèÔºöJDKÂä®ÊÄÅ‰ª£ÁêÜÂíåCGLIBÂä®ÊÄÅ‰ª£ÁêÜ„ÄÇ „ÄäSpring AOP ÂÆûÁé∞ÂéüÁêÜ‰∏é CGLIB Â∫îÁî®„Äã Spring AOP Ê°ÜÊû∂ÂØπ AOP ‰ª£ÁêÜÁ±ªÁöÑÂ§ÑÁêÜÂéüÂàôÊòØÔºöÂ¶ÇÊûúÁõÆÊ†áÂØπË±°ÁöÑÂÆûÁé∞Á±ªÂÆûÁé∞‰∫ÜÊé•Âè£ÔºåSpring AOP Â∞Ü‰ºöÈááÁî® JDK Âä®ÊÄÅ‰ª£ÁêÜÊù•ÁîüÊàê AOP ‰ª£ÁêÜÁ±ªÔºõÂ¶ÇÊûúÁõÆÊ†áÂØπË±°ÁöÑÂÆûÁé∞Á±ªÊ≤°ÊúâÂÆûÁé∞Êé•Âè£ÔºåSpring AOP Â∞Ü‰ºöÈááÁî® CGLIB Êù•ÁîüÊàê AOP ‰ª£ÁêÜÁ±ª UML „ÄäUMLÊïôÁ®ã„Äã ÂæÆÊúçÂä°ÊÄùÊÉ≥ „ÄäÂæÆÊúçÂä°Êû∂ÊûÑËÆæËÆ°„Äã „ÄäÂæÆÊúçÂä°Êû∂ÊûÑÊäÄÊúØÊ†àÈÄâÂûãÊâãÂÜå„Äã Â∫∑Â®ÅÂÆöÂæã „ÄäÂæÆÊúçÂä°Êû∂ÊûÑÁöÑÁêÜËÆ∫Âü∫Á°Ä - Â∫∑Â®ÅÂÆöÂæã„Äã ÂÆöÂæã‰∏ÄÔºöÁªÑÁªáÊ≤üÈÄöÊñπÂºè‰ºöÈÄöËøáÁ≥ªÁªüËÆæËÆ°Ë°®ËææÂá∫Êù•ÔºåÂ∞±ÊòØËØ¥Êû∂ÊûÑÁöÑÂ∏ÉÂ±ÄÂíåÁªÑÁªáÁªìÊûÑ‰ºöÊúâÁõ∏‰ºº„ÄÇ ÂÆöÂæã‰∫åÔºöÊó∂Èó¥ÂÜçÂ§ö‰∏Ä‰ª∂‰∫ãÊÉÖ‰πü‰∏çÂèØËÉΩÂÅöÁöÑÂÆåÁæéÔºå‰ΩÜÊÄªÊúâÊó∂Èó¥ÂÅöÂÆå‰∏Ä‰ª∂‰∫ãÊÉÖ„ÄÇ‰∏ÄÂè£Ê∞îÂêÉ‰∏çÊàêËÉñÂ≠êÔºåÂÖàÊêûÂÆöËÉΩÊêûÂÆöÁöÑ„ÄÇ ÂÆöÂæã‰∏âÔºöÁ∫øÂûãÁ≥ªÁªüÂíåÁ∫øÂûãÁªÑÁªáÊû∂ÊûÑÈó¥ÊúâÊΩúÂú®ÁöÑÂºÇË¥®ÂêåÊÄÅÁâπÊÄß„ÄÇÁßçÁìúÂæóÁìúÔºåÂÅöÁã¨Á´ãËá™Ê≤ªÁöÑÂ≠êÁ≥ªÁªüÂáèÂ∞ëÊ≤üÈÄöÊàêÊú¨„ÄÇ ÂÆöÂæãÂõõÔºöÂ§ßÁöÑÁ≥ªÁªüÁªÑÁªáÊÄªÊòØÊØîÂ∞èÁ≥ªÁªüÊõ¥ÂÄæÂêë‰∫éÂàÜËß£„ÄÇÂêà‰πÖÂøÖÂàÜÔºåÂàÜËÄåÊ≤ª‰πã„ÄÇ „ÄäÂæÆÊúçÂä°Êû∂ÊûÑÊ†∏‚ºº20ËÆ≤„Äã ËøêÁª¥ &amp; ÁªüËÆ° &amp; ÊäÄÊúØÊîØÊåÅÂ∏∏ËßÑÁõëÊéß „ÄäËÖæËÆØ‰∏öÂä°Á≥ªÁªüÁõëÊéßÁöÑ‰øÆÁÇº‰πãË∑Ø„Äã ÁõëÊéßÁöÑÊñπÂºèÔºö‰∏ªÂä®„ÄÅË¢´Âä®„ÄÅÊóÅË∑Ø(ÊØîÂ¶ÇËàÜÊÉÖÁõëÊéß) ÁõëÊéßÁ±ªÂûãÔºö Âü∫Á°ÄÁõëÊéß„ÄÅÊúçÂä°Á´ØÁõëÊéß„ÄÅÂÆ¢Êà∑Á´ØÁõëÊéß„ÄÅÁõëÊéß„ÄÅÁî®Êà∑Á´ØÁõëÊéß ÁõëÊéßÁöÑÁõÆÊ†áÔºöÂÖ®„ÄÅÂùó„ÄÅÂáÜ Ê†∏ÂøÉÊåáÊ†áÔºöËØ∑Ê±ÇÈáè„ÄÅÊàêÂäüÁéá„ÄÅËÄóÊó∂ „ÄäÂºÄÊ∫êËøòÊòØÂïÜÁî®ÔºüÂçÅÂ§ß‰∫ëËøêÁª¥ÁõëÊéßÂ∑•ÂÖ∑Ê®™ËØÑ„Äã Zabbix„ÄÅNagios„ÄÅGanglia„ÄÅZenoss„ÄÅOpen-falcon„ÄÅÁõëÊéßÂÆù„ÄÅ 360ÁΩëÁ´ôÊúçÂä°ÁõëÊéß„ÄÅÈòøÈáå‰∫ëÁõëÊéß„ÄÅÁôæÂ∫¶‰∫ëËßÇÊµã„ÄÅÂ∞èËúúËúÇÁΩëÁ´ôÁõëÊµãÁ≠â„ÄÇ „ÄäÁõëÊéßÊä•Ë≠¶Á≥ªÁªüÊê≠Âª∫Âèä‰∫åÊ¨°ÂºÄÂèëÁªèÈ™å„Äã ÂëΩ‰ª§Ë°åÁõëÊéßÂ∑•ÂÖ∑ „ÄäÂ∏∏Áî®ÂëΩ‰ª§Ë°åÁõëÊéßÂ∑•ÂÖ∑„Äã top„ÄÅsar„ÄÅtsar„ÄÅnload „Ää20‰∏™ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÁõëÊéß Linux Á≥ªÁªüÊÄßËÉΩ„Äã „ÄäJVMÊÄßËÉΩË∞É‰ºòÁõëÊéßÂ∑•ÂÖ∑jps„ÄÅjstack„ÄÅjmap„ÄÅjhat„ÄÅjstat„ÄÅhprof‰ΩøÁî®ËØ¶Ëß£„Äã APMAPM ‚Äî Application Performance Management „ÄäDapperÔºåÂ§ßËßÑÊ®°ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑË∑üË∏™Á≥ªÁªü„Äã CNCF OpenTracingÔºå‰∏≠ÊñáÁâà ‰∏ªË¶ÅÂºÄÊ∫êËΩØ‰ª∂ÔºåÊåâÂ≠óÊØçÊéíÂ∫è Apache SkyWalking CAT CNCF jaeger Pinpoint Zipkin „ÄäÂºÄÊ∫êAPMÊäÄÊúØÈÄâÂûã‰∏éÂÆûÊàò„Äã ‰∏ªË¶ÅÂü∫‰∫é GoogleÁöÑDapperÔºàÂ§ßËßÑÊ®°ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑË∑üË∏™Á≥ªÁªüÔºâ ÊÄùÊÉ≥„ÄÇ ÁªüËÆ°ÂàÜÊûê „ÄäÊµÅÈáèÁªüËÆ°ÁöÑÂü∫Á°ÄÔºöÂüãÁÇπ„Äã Â∏∏Áî®ÊåáÊ†áÔºöËÆøÈóÆ‰∏éËÆøÂÆ¢„ÄÅÂÅúÁïôÊó∂Èïø„ÄÅË∑≥Âá∫Áéá„ÄÅÈÄÄÂá∫Áéá„ÄÅËΩ¨ÂåñÁéá„ÄÅÂèÇ‰∏éÂ∫¶ „ÄäAPPÂüãÁÇπÂ∏∏Áî®ÁöÑÁªüËÆ°Â∑•ÂÖ∑„ÄÅÂüãÁÇπÁõÆÊ†áÂíåÂüãÁÇπÂÜÖÂÆπ„Äã Á¨¨‰∏âÊñπÁªüËÆ°ÔºöÂèãÁõü„ÄÅÁôæÂ∫¶ÁßªÂä®„ÄÅÈ≠îÊñπ„ÄÅApp Annie„ÄÅtalking data„ÄÅÁ•ûÁ≠ñÊï∞ÊçÆÁ≠â„ÄÇ „ÄäÁæéÂõ¢ÁÇπËØÑÂâçÁ´ØÊó†ÁóïÂüãÁÇπÂÆûË∑µ„Äã ÊâÄË∞ìÊó†Áóï„ÄÅÂç≥ÈÄöËøáÂèØËßÜÂåñÂ∑•ÂÖ∑ÈÖçÁΩÆÈááÈõÜËäÇÁÇπÔºåÂú®ÂâçÁ´ØËá™Âä®Ëß£ÊûêÈÖçÁΩÆÂπ∂‰∏äÊä•ÂüãÁÇπÊï∞ÊçÆÔºåËÄåÈùûÁ°¨ÁºñÁ†Å„ÄÇ ÊåÅÁª≠ÈõÜÊàê(CI/CD) „ÄäÊåÅÁª≠ÈõÜÊàêÊòØ‰ªÄ‰πàÔºü„Äã „Ää8‰∏™ÊµÅË°åÁöÑÊåÅÁª≠ÈõÜÊàêÂ∑•ÂÖ∑„Äã Jenkins „Ää‰ΩøÁî®JenkinsËøõË°åÊåÅÁª≠ÈõÜÊàê„Äã ÁéØÂ¢ÉÂàÜÁ¶ªÂºÄÂèë„ÄÅÊµãËØï„ÄÅÁîüÊàêÁéØÂ¢ÉÂàÜÁ¶ª„ÄÇ „ÄäÂºÄÂèëÁéØÂ¢É„ÄÅÁîü‰∫ßÁéØÂ¢É„ÄÅÊµãËØïÁéØÂ¢ÉÁöÑÂü∫Êú¨ÁêÜËß£ÂíåÂå∫„Äã Ëá™Âä®ÂåñËøêÁª¥Ansible „ÄäAnsible‰∏≠ÊñáÊùÉÂ®ÅÊåáÂçó„Äã „ÄäAnsibleÂü∫Á°ÄÈÖçÁΩÆÂíå‰ºÅ‰∏öÁ∫ßÈ°πÁõÆÂÆûÁî®Ê°à‰æã„Äã puppet „ÄäËá™Âä®ÂåñËøêÁª¥Â∑•ÂÖ∑‚Äî‚ÄîpuppetËØ¶Ëß£„Äã chef „ÄäChef ÁöÑÂÆâË£Ö‰∏é‰ΩøÁî®„Äã ÊµãËØïTDD ÁêÜËÆ∫ „ÄäÊ∑±Â∫¶Ëß£ËØª - TDDÔºàÊµãËØïÈ©±Âä®ÂºÄÂèëÔºâ„Äã Âü∫‰∫éÊµãËØïÁî®‰æãÁºñÁ†ÅÂäüËÉΩ‰ª£Á†ÅÔºåXPÔºàExtreme ProgrammingÔºâÁöÑÊ†∏ÂøÉÂÆûË∑µ. Â•ΩÂ§ÑÔºö‰∏ÄÊ¨°ÂÖ≥Ê≥®‰∏Ä‰∏™ÁÇπÔºåÈôç‰ΩéÊÄùÁª¥Ë¥üÊãÖÔºõËøéÊé•ÈúÄÊ±ÇÂèòÂåñÊàñÊîπÂñÑ‰ª£Á†ÅÁöÑËÆæËÆ°ÔºõÊèêÂâçÊæÑÊ∏ÖÈúÄÊ±ÇÔºõÂø´ÈÄüÂèçÈ¶àÔºõ ÂçïÂÖÉÊµãËØï „ÄäJavaÂçïÂÖÉÊµãËØï‰πãJUnitÁØá„Äã „ÄäJUnit 4 ‰∏é TestNG ÂØπÊØî„Äã TestNG Ë¶ÜÁõñ JUnit ÂäüËÉΩÔºåÈÄÇÁî®‰∫éÊõ¥Â§çÊùÇÁöÑÂú∫ÊôØ„ÄÇ „ÄäÂçïÂÖÉÊµãËØï‰∏ªË¶ÅÁöÑÊµãËØïÂäüËÉΩÁÇπ„Äã Ê®°ÂùóÊé•Âè£ÊµãËØï„ÄÅÂ±ÄÈÉ®Êï∞ÊçÆÁªìÊûÑÊµãËØï„ÄÅË∑ØÂæÑÊµãËØï „ÄÅÈîôËØØÂ§ÑÁêÜÊµãËØï„ÄÅËæπÁïåÊù°‰ª∂ÊµãËØï „ÄÇ ÂéãÂäõÊµãËØï „ÄäApache ab ÊµãËØï‰ΩøÁî®ÊåáÂçó„Äã „ÄäÂ§ßÂûãÁΩëÁ´ôÂéãÂäõÊµãËØïÂèä‰ºòÂåñÊñπÊ°à„Äã „Ää10Â§ß‰∏ªÊµÅÂéãÂäõ/Ë¥üËΩΩ/ÊÄßËÉΩÊµãËØïÂ∑•ÂÖ∑Êé®Ëçê„Äã „ÄäÁúüÂÆûÊµÅÈáèÂéãÊµãÂ∑•ÂÖ∑ tcpcopyÂ∫îÁî®ÊµÖÊûê„Äã „ÄänGrinder ÁÆÄÊòì‰ΩøÁî®ÊïôÁ®ã„Äã ÂÖ®ÈìæË∑ØÂéãÊµã „Ää‰∫¨‰∏ú618ÔºöÂçáÁ∫ßÂÖ®ÈìæË∑ØÂéãÊµãÊñπÊ°àÔºåÊâìÈÄ†ÂÜõÊºîÊú∫Âô®‰∫∫ForceBot„Äã „ÄäÈ•ø‰∫Ü‰πàÂÖ®ÈìæË∑ØÂéãÊµãÁöÑÊé¢Á¥¢‰∏éÂÆûË∑µ„Äã „ÄäÂõõÂ§ßËØ≠Ë®ÄÔºåÂÖ´Â§ßÊ°ÜÊû∂ÔΩúÊª¥Êª¥ÂÖ®ÈìæË∑ØÂéãÊµãËß£ÂÜ≥‰πãÈÅì„Äã „ÄäÂÖ®ÈìæË∑ØÂéãÊµãÁªèÈ™å„Äã A/B „ÄÅÁÅ∞Â∫¶„ÄÅËìùÁªøÊµãËØï „ÄäÊäÄÊúØÂπ≤Ë¥ß | AB ÊµãËØïÂíåÁÅ∞Â∫¶ÂèëÂ∏ÉÊé¢Á¥¢ÂèäÂÆûË∑µ„Äã „Äänginx Ê†πÊçÆIP ËøõË°åÁÅ∞Â∫¶ÂèëÂ∏É„Äã „ÄäËìùÁªøÈÉ®ÁΩ≤„ÄÅA/B ÊµãËØï‰ª•ÂèäÁÅ∞Â∫¶ÂèëÂ∏É„Äã ËôöÊãüÂåñ „ÄäVPSÁöÑ‰∏âÁßçËôöÊãüÊäÄÊúØOpenVZ„ÄÅXen„ÄÅKVM‰ºòÁº∫ÁÇπÊØîËæÉ„Äã KVM „ÄäKVMËØ¶Ëß£ÔºåÂ§™ËØ¶ÁªÜÂ§™Ê∑±ÂÖ•‰∫ÜÔºåÁªèÂÖ∏„Äã „Ää„ÄêÂõæÊñá„ÄëKVM ËôöÊãüÊú∫ÂÆâË£ÖËØ¶Ëß£„Äã Xen „ÄäXenËôöÊãüÂåñÂü∫Êú¨ÂéüÁêÜËØ¶Ëß£„Äã OpenVZ „ÄäÂºÄÊ∫êLinuxÂÆπÂô® OpenVZ Âø´ÈÄü‰∏äÊâãÊåáÂçó„Äã ÂÆπÂô®ÊäÄÊúØDocker „ÄäÂá†Âº†ÂõæÂ∏Æ‰Ω†ÁêÜËß£ docker Âü∫Êú¨ÂéüÁêÜÂèäÂø´ÈÄüÂÖ•Èó®„Äã „ÄäDocker Ê†∏ÂøÉÊäÄÊúØ‰∏éÂÆûÁé∞ÂéüÁêÜ„Äã „ÄäDocker ÊïôÁ®ã„Äã ‰∫ëÊäÄÊúØOpenStack „ÄäOpenStackÊûÑÊû∂Áü•ËØÜÊ¢≥ÁêÜ„Äã DevOps „Ää‰∏ÄÂàÜÈíüÂëäËØâ‰Ω†Á©∂Á´üDevOpsÊòØ‰ªÄ‰πàÈ¨ºÔºü„Äã „ÄäDevOpsËØ¶Ëß£„Äã ÊñáÊ°£ÁÆ°ÁêÜ Confluence-Êî∂Ë¥πÊñáÊ°£ÁÆ°ÁêÜÁ≥ªÁªü GitLab? Wiki ‰∏≠Èó¥‰ª∂Web ServerNginx „ÄäNgnixÁöÑÂü∫Êú¨Â≠¶‰π†-Â§öËøõÁ®ãÂíåApacheÁöÑÊØîËæÉ„Äã Nginx ÈÄöËøáÂºÇÊ≠•ÈùûÈòªÂ°ûÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊú∫Âà∂ÂÆûÁé∞È´òÂπ∂Âèë„ÄÇApache ÊØè‰∏™ËØ∑Ê±ÇÁã¨Âç†‰∏Ä‰∏™Á∫øÁ®ãÔºåÈùûÂ∏∏Ê∂àËÄóÁ≥ªÁªüËµÑÊ∫ê„ÄÇ ‰∫ã‰ª∂È©±Âä®ÈÄÇÂêà‰∫éIOÂØÜÈõÜÂûãÊúçÂä°(Nginx)ÔºåÂ§öËøõÁ®ãÊàñÁ∫øÁ®ãÈÄÇÂêà‰∫éCPUÂØÜÈõÜÂûãÊúçÂä°(Apache)ÔºåÊâÄ‰ª•NginxÈÄÇÂêàÂÅöÂèçÂêë‰ª£ÁêÜÔºåËÄåÈùûwebÊúçÂä°Âô®‰ΩøÁî®„ÄÇ „Äänginx‰∏éApacheÁöÑÂØπÊØî‰ª•Âèä‰ºòÁº∫ÁÇπ„Äã nginxÂè™ÈÄÇÂêàÈùôÊÄÅÂíåÂèçÂêë‰ª£ÁêÜÔºå‰∏çÈÄÇÂêàÂ§ÑÁêÜÂä®ÊÄÅËØ∑Ê±Ç„ÄÇ OpenResty ÂÆòÊñπÁΩëÁ´ô „ÄäÊµÖË∞à OpenResty„Äã ÈÄöËøá Lua Ê®°ÂùóÂèØ‰ª•Âú®Nginx‰∏äËøõË°åÂºÄÂèë„ÄÇ Apache Httpd ÂÆòÊñπÁΩëÁ´ô TomcatÊû∂ÊûÑÂéüÁêÜ „ÄäTOMCATÂéüÁêÜËØ¶Ëß£ÂèäËØ∑Ê±ÇËøáÁ®ã„Äã „ÄäTomcatÊúçÂä°Âô®ÂéüÁêÜËØ¶Ëß£„Äã „ÄäTomcat Á≥ªÁªüÊû∂ÊûÑ‰∏éËÆæËÆ°Ê®°Âºè,Á¨¨ 1 ÈÉ®ÂàÜ: Â∑•‰ΩúÂéüÁêÜ„Äã „ÄäÂõõÂº†ÂõæÂ∏¶‰Ω†‰∫ÜËß£TomcatÁ≥ªÁªüÊû∂ÊûÑ„Äã „ÄäJBoss vs. Tomcat: Choosing A Java Application Server„Äã Tomcat ÊòØËΩªÈáèÁ∫ßÁöÑ Serverlet ÂÆπÂô®ÔºåÊ≤°ÊúâÂÆûÁé∞ÂÖ®ÈÉ® JEE ÁâπÊÄßÔºàÊØîÂ¶ÇÊåÅ‰πÖÂåñÂíå‰∫ãÂä°Â§ÑÁêÜÔºâÔºå‰ΩÜÂèØ‰ª•ÈÄöËøáÂÖ∂‰ªñÁªÑ‰ª∂‰ª£ÊõøÔºåÊØîÂ¶ÇSrping„ÄÇ Jboss ÂÆûÁé∞ÂÖ®ÈÉ®‰∫ÜJEEÁâπÊÄßÔºåËΩØ‰ª∂ÂºÄÊ∫êÂÖçË¥π„ÄÅÊñáÊ°£Êî∂Ë¥π„ÄÇ Ë∞É‰ºòÊñπÊ°à „ÄäTomcat Ë∞É‰ºòÊñπÊ°à„Äã ÂêØÂä®NIOÊ®°ÂºèÔºàÊàñËÄÖAPRÔºâÔºõË∞ÉÊï¥Á∫øÁ®ãÊ±†ÔºõÁ¶ÅÁî®AJPËøûÊé•Âô®ÔºàNginx+tomcatÁöÑÊû∂ÊûÑÔºå‰∏çÈúÄË¶ÅAJPÔºâÔºõ „Äätomcat httpÂçèËÆÆ‰∏éajpÂçèËÆÆ„Äã „ÄäAJP‰∏éHTTPÊØîËæÉÂíåÂàÜÊûê„Äã AJP ÂçèËÆÆÔºà8009Á´ØÂè£ÔºâÁî®‰∫éÈôç‰ΩéÂíåÂâçÁ´ØServerÔºàÂ¶ÇApacheÔºåËÄå‰∏îÈúÄË¶ÅÊîØÊåÅAJPÂçèËÆÆÔºâÁöÑËøûÊé•Êï∞(ÂâçÁ´Ø)ÔºåÈÄöËøáÈïøËøûÊé•ÊèêÈ´òÊÄßËÉΩ„ÄÇ Âπ∂ÂèëÈ´òÊó∂ÔºåAJPÂçèËÆÆ‰ºò‰∫éHTTPÂçèËÆÆ„ÄÇ Jetty „ÄäJetty ÁöÑÂ∑•‰ΩúÂéüÁêÜ‰ª•Âèä‰∏é Tomcat ÁöÑÊØîËæÉ„Äã „ÄäjettyÂíåtomcat‰ºòÂäøÊØîËæÉ„Äã Êû∂ÊûÑÊØîËæÉ:JettyÁöÑÊû∂ÊûÑÊØîTomcatÁöÑÊõ¥‰∏∫ÁÆÄÂçï„ÄÇ ÊÄßËÉΩÊØîËæÉÔºöJettyÂíåTomcatÊÄßËÉΩÊñπÈù¢Â∑ÆÂºÇ‰∏çÂ§ßÔºåJettyÈªòËÆ§ÈááÁî®NIOÁªìÊùüÂú®Â§ÑÁêÜI/OËØ∑Ê±Ç‰∏äÊõ¥Âç†‰ºòÂäøÔºåTomcatÈªòËÆ§ÈááÁî®BIOÂ§ÑÁêÜI/OËØ∑Ê±ÇÔºåTomcatÈÄÇÂêàÂ§ÑÁêÜÂ∞ëÊï∞ÈùûÂ∏∏ÁπÅÂøôÁöÑÈìæÊé•ÔºåÂ§ÑÁêÜÈùôÊÄÅËµÑÊ∫êÊó∂ÊÄßËÉΩËæÉÂ∑Æ„ÄÇ ÂÖ∂‰ªñÊñπÈù¢ÔºöJettyÁöÑÂ∫îÁî®Êõ¥Âä†Âø´ÈÄüÔºå‰øÆÊîπÁÆÄÂçïÔºåÂØπÊñ∞ÁöÑServletËßÑËåÉÁöÑÊîØÊåÅËæÉÂ•Ω;Tomcat ÂØπJEEÂíåServlet ÊîØÊåÅÊõ¥Âä†ÂÖ®Èù¢„ÄÇ ÁºìÂ≠ò „ÄäÁºìÂ≠òÂ§±ÊïàÁ≠ñÁï•ÔºàFIFO „ÄÅLRU„ÄÅLFU‰∏âÁßçÁÆóÊ≥ïÁöÑÂå∫Âà´Ôºâ„Äã Êú¨Âú∞ÁºìÂ≠ò „ÄäHashMapÊú¨Âú∞ÁºìÂ≠ò„Äã „ÄäEhCacheÊú¨Âú∞ÁºìÂ≠ò„Äã Â†ÜÂÜÖ„ÄÅÂ†ÜÂ§ñ„ÄÅÁ£ÅÁõò‰∏âÁ∫ßÁºìÂ≠ò„ÄÇ ÂèØÊåâÁÖßÁºìÂ≠òÁ©∫Èó¥ÂÆπÈáèËøõË°åËÆæÁΩÆ„ÄÇ ÊåâÁÖßÊó∂Èó¥„ÄÅÊ¨°Êï∞Á≠âËøáÊúüÁ≠ñÁï•„ÄÇ „ÄäGuava Cache„Äã ÁÆÄÂçïËΩªÈáè„ÄÅÊó†Â†ÜÂ§ñ„ÄÅÁ£ÅÁõòÁºìÂ≠ò„ÄÇ „ÄäNginxÊú¨Âú∞ÁºìÂ≠ò„Äã „ÄäPagespeed‚ÄîÊáí‰∫∫Â∑•ÂÖ∑ÔºåÊúçÂä°Âô®Á´ØÂä†ÈÄü„Äã ÂÆ¢Êà∑Á´ØÁºìÂ≠ò „ÄäÊµèËßàÂô®Á´ØÁºìÂ≠ò„Äã ‰∏ªË¶ÅÊòØÂà©Áî® Cache-Control ÂèÇÊï∞„ÄÇ „ÄäH5 ÂíåÁßªÂä®Á´Ø WebView ÁºìÂ≠òÊú∫Âà∂Ëß£Êûê‰∏éÂÆûÊàò„Äã ÊúçÂä°Á´ØÁºìÂ≠òMemcached „ÄäMemcached ÊïôÁ®ã„Äã „ÄäÊ∑±ÂÖ•ÁêÜËß£MemcachedÂéüÁêÜ„Äã ÈááÁî®Â§öË∑ØÂ§çÁî®ÊäÄÊúØÊèêÈ´òÂπ∂ÂèëÊÄß„ÄÇ slabÂàÜÈÖçÁÆóÊ≥ïÔºö memcachedÁªôSlabÂàÜÈÖçÂÜÖÂ≠òÁ©∫Èó¥ÔºåÈªòËÆ§ÊòØ1MB„ÄÇÂàÜÈÖçÁªôSlab‰πãÂêé ÊääslabÁöÑÂàáÂàÜÊàêÂ§ßÂ∞èÁõ∏ÂêåÁöÑchunkÔºåChunkÊòØÁî®‰∫éÁºìÂ≠òËÆ∞ÂΩïÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåChunk ÁöÑÂ§ßÂ∞èÈªòËÆ§ÊåâÁÖß1.25ÂÄçÁöÑÈÄüÂ∫¶ÈÄíÂ¢û„ÄÇÂ•ΩÂ§ÑÊòØ‰∏ç‰ºöÈ¢ëÁπÅÁî≥ËØ∑ÂÜÖÂ≠òÔºåÊèêÈ´òIOÊïàÁéáÔºåÂùèÂ§ÑÊòØ‰ºöÊúâ‰∏ÄÂÆöÁöÑÂÜÖÂ≠òÊµ™Ë¥π„ÄÇ „ÄäMemcachedËΩØ‰ª∂Â∑•‰ΩúÂéüÁêÜ„Äã „ÄäMemcacheÊäÄÊúØÂàÜ‰∫´Ôºö‰ªãÁªç„ÄÅ‰ΩøÁî®„ÄÅÂ≠òÂÇ®„ÄÅÁÆóÊ≥ï„ÄÅ‰ºòÂåñ„ÄÅÂëΩ‰∏≠Áéá„Äã „Äämemcache ‰∏≠ add „ÄÅ set „ÄÅreplace ÁöÑÂå∫Âà´„Äã Âå∫Âà´Âú®‰∫éÂΩìkeyÂ≠òÂú®ËøòÊòØ‰∏çÂ≠òÂú®Êó∂ÔºåËøîÂõûÂÄºÊòØtrueÂíåfalseÁöÑ„ÄÇ „ÄämemcachedÂÖ®Èù¢ÂâñÊûê„Äã Redis „ÄäRedis ÊïôÁ®ã„Äã „ÄäredisÂ∫ïÂ±ÇÂéüÁêÜ„Äã ‰ΩøÁî® ziplist Â≠òÂÇ®ÈìæË°®ÔºåziplistÊòØ‰∏ÄÁßçÂéãÁº©ÈìæË°®ÔºåÂÆÉÁöÑÂ•ΩÂ§ÑÊòØÊõ¥ËÉΩËäÇÁúÅÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂõ†‰∏∫ÂÆÉÊâÄÂ≠òÂÇ®ÁöÑÂÜÖÂÆπÈÉΩÊòØÂú®ËøûÁª≠ÁöÑÂÜÖÂ≠òÂå∫ÂüüÂΩì‰∏≠ÁöÑ„ÄÇ ‰ΩøÁî® skiplist(Ë∑≥Ë∑ÉË°®)Êù•Â≠òÂÇ®ÊúâÂ∫èÈõÜÂêàÂØπË±°„ÄÅÊü•Êâæ‰∏äÂÖà‰ªéÈ´òLevelÊü•Ëµ∑„ÄÅÊó∂Èó¥Â§çÊùÇÂ∫¶ÂíåÁ∫¢ÈªëÊ†ëÁõ∏ÂΩìÔºåÂÆûÁé∞ÂÆπÊòìÔºåÊó†ÈîÅ„ÄÅÂπ∂ÂèëÊÄßÂ•Ω„ÄÇ „ÄäRedisÊåÅ‰πÖÂåñÊñπÂºè„Äã RDBÊñπÂºèÔºöÂÆöÊúüÂ§á‰ªΩÂø´ÁÖßÔºåÂ∏∏Áî®‰∫éÁÅæÈöæÊÅ¢Â§ç„ÄÇ‰ºòÁÇπÔºöÈÄöËøáforkÂá∫ÁöÑËøõÁ®ãËøõË°åÂ§á‰ªΩÔºå‰∏çÂΩ±Âìç‰∏ªËøõÁ®ã„ÄÅRDB Âú®ÊÅ¢Â§çÂ§ßÊï∞ÊçÆÈõÜÊó∂ÁöÑÈÄüÂ∫¶ÊØî AOF ÁöÑÊÅ¢Â§çÈÄüÂ∫¶Ë¶ÅÂø´„ÄÇÁº∫ÁÇπÔºö‰ºö‰∏¢Êï∞ÊçÆ„ÄÇ AOFÊñπÂºèÔºö‰øùÂ≠òÊìç‰ΩúÊó•ÂøóÊñπÂºè„ÄÇ‰ºòÁÇπÔºöÊÅ¢Â§çÊó∂Êï∞ÊçÆ‰∏¢Â§±Â∞ëÔºåÁº∫ÁÇπÔºöÊñá‰ª∂Â§ßÔºåÂõûÂ§çÊÖ¢„ÄÇ ‰πüÂèØ‰ª•‰∏§ËÄÖÁªìÂêà‰ΩøÁî®„ÄÇ „ÄäÂàÜÂ∏ÉÂºèÁºìÂ≠ò‚ÄìÂ∫èÂàó3‚ÄìÂéüÂ≠êÊìç‰Ωú‰∏éCAS‰πêËßÇÈîÅ„Äã Êû∂ÊûÑ „ÄäRedisÂçïÁ∫øÁ®ãÊû∂ÊûÑ„Äã ÂõûÊî∂Á≠ñÁï• „ÄäredisÁöÑÂõûÊî∂Á≠ñÁï•„Äã Tair ÂÆòÊñπÁΩëÁ´ô „ÄäTairÂíåRedisÁöÑÂØπÊØî„Äã ÁâπÁÇπÔºöÂèØ‰ª•ÈÖçÁΩÆÂ§á‰ªΩËäÇÁÇπÊï∞ÁõÆÔºåÈÄöËøáÂºÇÊ≠•ÂêåÊ≠•Âà∞Â§á‰ªΩËäÇÁÇπ ‰∏ÄËá¥ÊÄßHashÁÆóÊ≥ï„ÄÇ Êû∂ÊûÑÔºöÂíåHadoop ÁöÑËÆæËÆ°ÊÄùÊÉ≥Á±ª‰ººÔºåÊúâConfigserverÔºåDataServerÔºåConfigserver ÈÄöËøáÂøÉË∑≥Êù•Ê£ÄÊµãÔºåConfigserver‰πüÊúâ‰∏ªÂ§áÂÖ≥Á≥ª„ÄÇ Âá†ÁßçÂ≠òÂÇ®ÂºïÊìé: MDBÔºåÂÆåÂÖ®ÂÜÖÂ≠òÊÄßÔºåÂèØ‰ª•Áî®Êù•Â≠òÂÇ®SessionÁ≠âÊï∞ÊçÆ„ÄÇ RdbÔºàÁ±ª‰ºº‰∫éRedisÔºâÔºåËΩªÈáèÂåñÔºåÂéªÈô§‰∫Üaof‰πãÁ±ªÁöÑÊìç‰ΩúÔºåÊîØÊåÅRestfullÊìç‰Ωú LDBÔºàLevelDBÂ≠òÂÇ®ÂºïÊìéÔºâÔºåÊåÅ‰πÖÂåñÂ≠òÂÇ®ÔºåLDB ‰Ωú‰∏∫rdbÁöÑÊåÅ‰πÖÂåñÔºågoogleÂÆûÁé∞ÔºåÊØîËæÉÈ´òÊïàÔºåÁêÜËÆ∫Âü∫Á°ÄÊòØLSM(Log-Structured-Merge Tree)ÁÆóÊ≥ïÔºåÁé∞Âú®ÂÜÖÂ≠ò‰∏≠‰øÆÊîπÊï∞ÊçÆÔºåËææÂà∞‰∏ÄÂÆöÈáèÊó∂ÔºàÂíåÂÜÖÂ≠òÊ±áÊÄªÁöÑÊóßÊï∞ÊçÆ‰∏ÄÂêåÂÜôÂÖ•Á£ÅÁõòÔºâÂÜçÂÜôÂÖ•Á£ÅÁõòÔºåÂ≠òÂÇ®Êõ¥Âä†È´òÊïàÔºåÂéøÊØîÂñªHashÁÆóÊ≥ï„ÄÇ TairÈááÁî®ÂÖ±‰∫´ÂÜÖÂ≠òÊù•Â≠òÂÇ®Êï∞ÊçÆÔºåÂ¶ÇÊûúÊúçÂä°ÊåÇÊéâÔºàÈùûÊúçÂä°Âô®ÔºâÔºåÈáçÂêØÊúçÂä°‰πãÂêéÔºåÊï∞ÊçÆ‰∫¶ÁÑ∂ËøòÂú®„ÄÇ Ê∂àÊÅØÈòüÂàó „ÄäÊ∂àÊÅØÈòüÂàó-Êé®/ÊãâÊ®°ÂºèÂ≠¶‰π† &amp; ActiveMQÂèäJMSÂ≠¶‰π†„Äã RabbitMQ Ê∂àË¥πËÄÖÈªòËÆ§ÊòØÊé®Ê®°ÂºèÔºà‰πüÊîØÊåÅÊãâÊ®°ÂºèÔºâ„ÄÇ Kafka ÈªòËÆ§ÊòØÊãâÊ®°Âºè„ÄÇ PushÊñπÂºèÔºö‰ºòÁÇπÊòØÂèØ‰ª•Â∞ΩÂèØËÉΩÂø´Âú∞Â∞ÜÊ∂àÊÅØÂèëÈÄÅÁªôÊ∂àË¥πËÄÖÔºåÁº∫ÁÇπÊòØÂ¶ÇÊûúÊ∂àË¥πËÄÖÂ§ÑÁêÜËÉΩÂäõË∑ü‰∏ç‰∏äÔºåÊ∂àË¥πËÄÖÁöÑÁºìÂÜ≤Âå∫ÂèØËÉΩ‰ºöÊ∫¢Âá∫„ÄÇ PullÊñπÂºèÔºö‰ºòÁÇπÊòØÊ∂àË¥πÁ´ØÂèØ‰ª•ÊåâÂ§ÑÁêÜËÉΩÂäõËøõË°åÊãâÂéªÔºåÁº∫ÁÇπÊòØ‰ºöÂ¢ûÂä†Ê∂àÊÅØÂª∂Ëøü„ÄÇ „ÄäKafka„ÄÅRabbitMQ„ÄÅRocketMQÁ≠âÊ∂àÊÅØ‰∏≠Èó¥‰ª∂ÁöÑÂØπÊØî ‚Äî‚Äî Ê∂àÊÅØÂèëÈÄÅÊÄßËÉΩÂíåÂå∫Âà´„Äã Ê∂àÊÅØÊÄªÁ∫øÊ∂àÊÅØÊÄªÁ∫øÁõ∏ÂΩì‰∫éÂú®Ê∂àÊÅØÈòüÂàó‰πã‰∏äÂÅö‰∫Ü‰∏ÄÂ±ÇÂ∞ÅË£ÖÔºåÁªü‰∏ÄÂÖ•Âè£ÔºåÁªü‰∏ÄÁÆ°Êéß„ÄÅÁÆÄÂåñÊé•ÂÖ•ÊàêÊú¨„ÄÇ „ÄäÊ∂àÊÅØÊÄªÁ∫øVSÊ∂àÊÅØÈòüÂàó„Äã Ê∂àÊÅØÁöÑÈ°∫Â∫è „ÄäÂ¶Ç‰Ωï‰øùËØÅÊ∂àË¥πËÄÖÊé•Êî∂Ê∂àÊÅØÁöÑÈ°∫Â∫è„Äã RabbitMQÊîØÊåÅ‰∫ãÂä°ÔºåÊé®ÊãâÊ®°ÂºèÈÉΩÊòØÊîØÊåÅ„ÄÅÈÄÇÂêàÈúÄË¶ÅÂèØÈù†ÊÄßÊ∂àÊÅØ‰º†ËæìÁöÑÂú∫ÊôØ„ÄÇ „ÄäRabbitMQÁöÑÂ∫îÁî®Âú∫ÊôØ‰ª•ÂèäÂü∫Êú¨ÂéüÁêÜ‰ªãÁªç„Äã „ÄäÊ∂àÊÅØÈòüÂàó‰πã RabbitMQ„Äã „ÄäRabbitMQ‰πãÊ∂àÊÅØÁ°ÆËÆ§Êú∫Âà∂Ôºà‰∫ãÂä°+ConfirmÔºâ„Äã RocketMQJavaÂÆûÁé∞ÔºåÊé®ÊãâÊ®°ÂºèÈÉΩÊòØÊîØÊåÅÔºåÂêûÂêêÈáèÈÄä‰∫éKafka„ÄÇÂèØ‰ª•‰øùËØÅÊ∂àÊÅØÈ°∫Â∫è„ÄÇ „ÄäRocketMQ ÂÆûÊàò‰πãÂø´ÈÄüÂÖ•Èó®„Äã ActiveMQÁ∫ØJavaÂÆûÁé∞ÔºåÂÖºÂÆπJMSÔºåÂèØ‰ª•ÂÜÖÂµå‰∫éJavaÂ∫îÁî®‰∏≠„ÄÇ „ÄäActiveMQÊ∂àÊÅØÈòüÂàó‰ªãÁªç„Äã KafkaÈ´òÂêûÂêêÈáè„ÄÅÈááÁî®ÊãâÊ®°Âºè„ÄÇÈÄÇÂêàÈ´òIOÂú∫ÊôØÔºåÊØîÂ¶ÇÊó•ÂøóÂêåÊ≠•„ÄÇ ÂÆòÊñπÁΩëÁ´ô „ÄäÂêÑÊ∂àÊÅØÈòüÂàóÂØπÊØîÔºåKafkaÊ∑±Â∫¶Ëß£ÊûêÔºå‰ºó‰∫∫Êé®ËçêÔºåÁ≤æÂΩ©Â•ΩÊñáÔºÅ„Äã „ÄäKafkaÂàÜÂå∫Êú∫Âà∂‰ªãÁªç‰∏éÁ§∫‰æã„Äã Redis Ê∂àÊÅØÊé®ÈÄÅÁîü‰∫ßËÄÖ„ÄÅÊ∂àË¥πËÄÖÊ®°ÂºèÂÆåÂÖ®ÊòØÂÆ¢Êà∑Á´ØË°å‰∏∫Ôºålist Âíå ÊãâÊ®°ÂºèÂÆûÁé∞ÔºåÈòªÂ°ûÁ≠âÂæÖÈááÁî® blpop Êåá‰ª§„ÄÇ „ÄäRedisÂ≠¶‰π†Á¨îËÆ∞‰πãÂçÅÔºöRedisÁî®‰ΩúÊ∂àÊÅØÈòüÂàó„Äã ZeroMQ TODO ÂÆöÊó∂Ë∞ÉÂ∫¶ÂçïÊú∫ÂÆöÊó∂Ë∞ÉÂ∫¶ „ÄälinuxÂÆöÊó∂‰ªªÂä°cronÈÖçÁΩÆ„Äã „ÄäLinux cronËøêË°åÂéüÁêÜ„Äã fork ËøõÁ®ã + sleep ËΩÆËØ¢ „ÄäQuartz‰ΩøÁî®ÊÄªÁªì„Äã „ÄäQuartzÊ∫êÁ†ÅËß£Êûê ‚Äî- Ëß¶ÂèëÂô®ÊåâÊó∂ÂêØÂä®ÂéüÁêÜ„Äã „ÄäquartzÂéüÁêÜÊè≠ÁßòÂíåÊ∫êÁ†ÅËß£ËØª„Äã ÂÆöÊó∂Ë∞ÉÂ∫¶Âú® QuartzSchedulerThread ‰ª£Á†Å‰∏≠Ôºåwhile()Êó†ÈôêÂæ™ÁéØÔºåÊØèÊ¨°Âæ™ÁéØÂèñÂá∫Êó∂Èó¥Â∞ÜÂà∞ÁöÑtriggerÔºåËß¶ÂèëÂØπÂ∫îÁöÑjobÔºåÁõ¥Âà∞Ë∞ÉÂ∫¶Âô®Á∫øÁ®ãË¢´ÂÖ≥Èó≠„ÄÇ ÂàÜÂ∏ÉÂºèÂÆöÊó∂Ë∞ÉÂ∫¶ „ÄäËøô‰∫õ‰ºòÁßÄÁöÑÂõΩ‰∫ßÂàÜÂ∏ÉÂºè‰ªªÂä°Ë∞ÉÂ∫¶Á≥ªÁªüÔºå‰Ω†Áî®ËøáÂá†‰∏™Ôºü„Äã opencron„ÄÅLTS„ÄÅXXL-JOB„ÄÅElastic-Job„ÄÅUncode-Schedule„ÄÅAntares „ÄäQuartz‰ªªÂä°Ë∞ÉÂ∫¶ÁöÑÂü∫Êú¨ÂÆûÁé∞ÂéüÁêÜ„Äã QuartzÈõÜÁæ§‰∏≠ÔºåÁã¨Á´ãÁöÑQuartzËäÇÁÇπÂπ∂‰∏ç‰∏éÂè¶‰∏ÄÂÖ∂ÁöÑËäÇÁÇπÊàñÊòØÁÆ°ÁêÜËäÇÁÇπÈÄö‰ø°ÔºåËÄåÊòØÈÄöËøáÁõ∏ÂêåÁöÑÊï∞ÊçÆÂ∫ìË°®Êù•ÊÑüÁü•Âà∞Âè¶‰∏ÄQuartzÂ∫îÁî®ÁöÑ RPC „Ää‰ªéÈõ∂ÂºÄÂßãÂÆûÁé∞RPCÊ°ÜÊû∂ - RPCÂéüÁêÜÂèäÂÆûÁé∞„Äã Ê†∏ÂøÉËßíËâ≤ÔºöServer: Êö¥Èú≤ÊúçÂä°ÁöÑÊúçÂä°Êèê‰æõÊñπ„ÄÅClient: Ë∞ÉÁî®ËøúÁ®ãÊúçÂä°ÁöÑÊúçÂä°Ê∂àË¥πÊñπ„ÄÅRegistry: ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞ÁöÑÊ≥®ÂÜå‰∏≠ÂøÉ„ÄÇ „ÄäÂàÜÂ∏ÉÂºèRPCÊ°ÜÊû∂ÊÄßËÉΩÂ§ßÊØîÊãº dubbo„ÄÅmotan„ÄÅrpcx„ÄÅgRPC„ÄÅthriftÁöÑÊÄßËÉΩÊØîËæÉ„Äã Dubbo ÂÆòÊñπÁΩëÁ´ô dubboÂÆûÁé∞ÂéüÁêÜÁÆÄÂçï‰ªãÁªç SPI TODO Thrift ÂÆòÊñπÁΩëÁ´ô „ÄäThrift RPCËØ¶Ëß£„Äã ÊîØÊåÅÂ§öËØ≠Ë®ÄÔºåÈÄöËøá‰∏≠Èó¥ËØ≠Ë®ÄÂÆö‰πâÊé•Âè£„ÄÇ gRPCÊúçÂä°Á´ØÂèØ‰ª•ËÆ§ËØÅÂä†ÂØÜÔºåÂú®Â§ñÁΩëÁéØÂ¢É‰∏ãÔºåÂèØ‰ª•‰øùËØÅÊï∞ÊçÆÂÆâÂÖ®„ÄÇ ÂÆòÊñπÁΩëÁ´ô „Ää‰Ω†Â∫îËØ•Áü•ÈÅìÁöÑRPCÂéüÁêÜ„Äã Êï∞ÊçÆÂ∫ì‰∏≠Èó¥‰ª∂Sharding Jdbc ÂÆòÁΩë Êó•ÂøóÁ≥ªÁªüÊó•ÂøóÊêúÈõÜ „Ää‰ªéÈõ∂ÂºÄÂßãÊê≠Âª∫‰∏Ä‰∏™ELKBÊó•ÂøóÊî∂ÈõÜÁ≥ªÁªü„Äã „ÄäÁî®ELKÊê≠Âª∫ÁÆÄÂçïÁöÑÊó•ÂøóÊî∂ÈõÜÂàÜÊûêÁ≥ªÁªü„Äã „ÄäÊó•ÂøóÊî∂ÈõÜÁ≥ªÁªü-Êé¢Á©∂„Äã ÈÖçÁΩÆ‰∏≠ÂøÉ Apollo - Êê∫Á®ãÂºÄÊ∫êÁöÑÈÖçÁΩÆ‰∏≠ÂøÉÂ∫îÁî® Spring Boot Âíå Spring Cloud ÊîØÊåÅÊé®„ÄÅÊãâÊ®°ÂºèÊõ¥Êñ∞ÈÖçÁΩÆ ÊîØÊåÅÂ§öÁßçËØ≠Ë®Ä „ÄäÂü∫‰∫ézookeeperÂÆûÁé∞Áªü‰∏ÄÈÖçÁΩÆÁÆ°ÁêÜ„Äã „Ää Spring Cloud Config ÂàÜÂ∏ÉÂºèÈÖçÁΩÆ‰∏≠ÂøÉ‰ΩøÁî®ÊïôÁ®ã„Äã servlet 3.0 ÂºÇÊ≠•ÁâπÊÄßÂèØÁî®‰∫éÈÖçÁΩÆ‰∏≠ÂøÉÁöÑÂÆ¢Êà∑Á´Ø „Ääservlet3.0 Êñ∞ÁâπÊÄß‚Äî‚ÄîÂºÇÊ≠•Â§ÑÁêÜ„Äã API ÁΩëÂÖ≥‰∏ªË¶ÅËÅåË¥£ÔºöËØ∑Ê±ÇËΩ¨Âèë„ÄÅÂÆâÂÖ®ËÆ§ËØÅ„ÄÅÂçèËÆÆËΩ¨Êç¢„ÄÅÂÆπÁÅæ„ÄÇ „ÄäAPIÁΩëÂÖ≥ÈÇ£‰∫õÂÑø„Äã „ÄäË∞àAPIÁΩëÂÖ≥ÁöÑËÉåÊôØ„ÄÅÊû∂ÊûÑ‰ª•ÂèäËêΩÂú∞ÊñπÊ°à„Äã „Ää‰ΩøÁî®ZuulÊûÑÂª∫API Gateway„Äã „ÄäHTTP APIÁΩëÂÖ≥ÈÄâÊã©‰πã‰∏ÄKong‰ªãÁªç„Äã ÁΩëÁªúÂçèËÆÆOSI ‰∏ÉÂ±ÇÂçèËÆÆ „ÄäOSI‰∏ÉÂ±ÇÂçèËÆÆÊ®°Âûã„ÄÅTCP/IPÂõõÂ±ÇÊ®°ÂûãÂ≠¶‰π†Á¨îËÆ∞„Äã TCP/IP „ÄäÊ∑±ÂÖ•ÊµÖÂá∫ TCP/IP ÂçèËÆÆ„Äã „ÄäTCPÂçèËÆÆ‰∏≠ÁöÑ‰∏âÊ¨°Êè°ÊâãÂíåÂõõÊ¨°Êå•Êâã„Äã HTTP „ÄähttpÂçèËÆÆËØ¶Ëß£(Ë∂ÖËØ¶ÁªÜ)„Äã HTTP2.0 „ÄäHTTP 2.0 ÂéüÁêÜËØ¶ÁªÜÂàÜÊûê„Äã „ÄäHTTP2.0ÁöÑÂü∫Êú¨Âçï‰Ωç‰∏∫‰∫åËøõÂà∂Â∏ß„Äã Âà©Áî®‰∫åËøõÂà∂Â∏ßË¥üË¥£‰º†Ëæì„ÄÇ Â§öË∑ØÂ§çÁî®„ÄÇ HTTPS „ÄähttpsÂéüÁêÜÈÄö‰øó‰∫ÜËß£„Äã ‰ΩøÁî®ÈùûÂØπÁß∞Âä†ÂØÜÂçèÂïÜÂä†ÂØÜÁÆóÊ≥ï ‰ΩøÁî®ÂØπÁß∞Âä†ÂØÜÊñπÂºè‰º†ËæìÊï∞ÊçÆ ‰ΩøÁî®Á¨¨‰∏âÊñπÊú∫ÊûÑÁ≠æÂèëÁöÑËØÅ‰π¶ÔºåÊù•Âä†ÂØÜÂÖ¨Èí•ÔºåÁî®‰∫éÂÖ¨Èí•ÁöÑÂÆâÂÖ®‰º†Ëæì„ÄÅÈò≤Ê≠¢Ë¢´‰∏≠Èó¥‰∫∫‰∏≤Êîπ„ÄÇ „ÄäÂÖ´Â§ßÂÖçË¥πSSLËØÅ‰π¶-Áªô‰Ω†ÁöÑÁΩëÁ´ôÂÖçË¥πÊ∑ªÂä†HttpsÂÆâÂÖ®Âä†ÂØÜ„Äã ÁΩëÁªúÊ®°Âûã „Ääweb‰ºòÂåñÂøÖÈ°ª‰∫ÜËß£ÁöÑÂéüÁêÜ‰πãI/oÁöÑ‰∫îÁßçÊ®°ÂûãÂíåwebÁöÑ‰∏âÁßçÂ∑•‰ΩúÊ®°Âºè„Äã ‰∫îÁßçI/OÊ®°ÂûãÔºöÈòªÂ°ûI/OÔºåÈùûÈòªÂ°ûI/OÔºåI/OÂ§çÁî®„ÄÅ‰∫ã‰ª∂(‰ø°Âè∑)È©±Âä®I/O„ÄÅÂºÇÊ≠•I/OÔºåÂâçÂõõÁßçI/OÂ±û‰∫éÂêåÊ≠•Êìç‰ΩúÔºåI/OÁöÑÁ¨¨‰∏ÄÈò∂ÊÆµ‰∏çÂêå„ÄÅÁ¨¨‰∫åÈò∂ÊÆµÁõ∏ÂêåÔºåÊúÄÂêéÁöÑ‰∏ÄÁßçÂàôÂ±û‰∫éÂºÇÊ≠•Êìç‰Ωú„ÄÇ ‰∏âÁßç Web Server Â∑•‰ΩúÊñπÂºèÔºöPrefork(Â§öËøõÁ®ã)„ÄÅWorkerÊñπÂºè(Á∫øÁ®ãÊñπÂºè)„ÄÅEventÊñπÂºè„ÄÇ „Ääselect„ÄÅpoll„ÄÅepoll‰πãÈó¥ÁöÑÂå∫Âà´ÊÄªÁªì„Äã selectÔºåpollÔºåepollÊú¨Ë¥®‰∏äÈÉΩÊòØÂêåÊ≠•I/OÔºåÂõ†‰∏∫‰ªñ‰ª¨ÈÉΩÈúÄË¶ÅÂú®ËØªÂÜô‰∫ã‰ª∂Â∞±Áª™ÂêéËá™Â∑±Ë¥üË¥£ËøõË°åËØªÂÜôÔºå‰πüÂ∞±ÊòØËØ¥Ëøô‰∏™ËØªÂÜôËøáÁ®ãÊòØÈòªÂ°ûÁöÑ„ÄÇ select ÊúâÊâìÂºÄÊñá‰ª∂ÊèèËø∞Á¨¶Êï∞ÈáèÈôêÂà∂ÔºåÈªòËÆ§1024Ôºà2048 for x64ÔºâÔºå100‰∏áÂπ∂ÂèëÔºåÂ∞±Ë¶ÅÁî®1000‰∏™ËøõÁ®ã„ÄÅÂàáÊç¢ÂºÄÈîÄÂ§ßÔºõpollÈááÁî®ÈìæË°®ÁªìÊûÑÔºåÊ≤°ÊúâÊï∞ÈáèÈôêÂà∂„ÄÇ selectÔºåpoll ‚ÄúÈÜíÁùÄ‚ÄùÁöÑÊó∂ÂÄôË¶ÅÈÅçÂéÜÊï¥‰∏™fdÈõÜÂêàÔºåËÄåepollÂú®‚ÄúÈÜíÁùÄ‚ÄùÁöÑÊó∂ÂÄôÂè™Ë¶ÅÂà§Êñ≠‰∏Ä‰∏ãÂ∞±Áª™ÈìæË°®ÊòØÂê¶‰∏∫Á©∫Â∞±Ë°å‰∫ÜÔºåÈÄöËøáÂõûË∞ÉÊú∫Âà∂ËäÇÁúÅÂ§ßÈáèCPUÊó∂Èó¥ÔºõselectÔºåpollÊØèÊ¨°Ë∞ÉÁî®ÈÉΩË¶ÅÊääfdÈõÜÂêà‰ªéÁî®Êà∑ÊÄÅÂæÄÂÜÖÊ†∏ÊÄÅÊã∑Ë¥ù‰∏ÄÊ¨°ÔºåËÄåepollÂè™Ë¶Å‰∏ÄÊ¨°Êã∑Ë¥ù„ÄÇ poll‰ºöÈöèÁùÄÂπ∂ÂèëÂ¢ûÂä†ÔºåÊÄßËÉΩÈÄêÊ∏ê‰∏ãÈôçÔºåepollÈááÁî®Á∫¢ÈªëÊ†ëÁªìÊûÑÔºåÊÄßËÉΩÁ®≥ÂÆöÔºå‰∏ç‰ºöÈöèÁùÄËøûÊé•Êï∞Â¢ûÂä†ËÄåÈôç‰Ωé„ÄÇ „ÄäselectÔºåpollÔºåepollÊØîËæÉ „Äã Âú®ËøûÊé•Êï∞Â∞ëÂπ∂‰∏îËøûÊé•ÈÉΩÂçÅÂàÜÊ¥ªË∑ÉÁöÑÊÉÖÂÜµ‰∏ãÔºåselectÂíåpollÁöÑÊÄßËÉΩÂèØËÉΩÊØîepollÂ•ΩÔºåÊØïÁ´üepollÁöÑÈÄöÁü•Êú∫Âà∂ÈúÄË¶ÅÂæàÂ§öÂáΩÊï∞ÂõûË∞É„ÄÇ „ÄäÊ∑±ÂÖ•ÁêÜËß£Java NIO„Äã NIO ÊòØ‰∏ÄÁßçÂêåÊ≠•ÈùûÈòªÂ°ûÁöÑ IO Ê®°Âûã„ÄÇÂêåÊ≠•ÊòØÊåáÁ∫øÁ®ã‰∏çÊñ≠ËΩÆËØ¢ IO ‰∫ã‰ª∂ÊòØÂê¶Â∞±Áª™ÔºåÈùûÈòªÂ°ûÊòØÊåáÁ∫øÁ®ãÂú®Á≠âÂæÖ IO ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÂêåÊó∂ÂÅöÂÖ∂‰ªñ‰ªªÂä° „ÄäBIO‰∏éNIO„ÄÅAIOÁöÑÂå∫Âà´„Äã „Ää‰∏§ÁßçÈ´òÊïàÁöÑÊúçÂä°Âô®ËÆæËÆ°Ê®°ÂûãÔºöReactorÂíåProactorÊ®°Âûã„Äã Epoll „Ääepoll‰ΩøÁî®ËØ¶Ëß£ÔºàÁ≤æÈ´ìÔºâ„Äã Java NIO „ÄäÊ∑±ÂÖ•ÁêÜËß£Java NIO„Äã „ÄäJava NIOÁºñÂÜôSocketÊúçÂä°Âô®ÁöÑ‰∏Ä‰∏™‰æãÂ≠ê„Äã kqueue „ÄäkqueueÁî®Ê≥ïÁÆÄ‰ªã„Äã ËøûÊé•ÂíåÁü≠ËøûÊé• „ÄäTCP/IPÁ≥ªÂàó‚Äî‚ÄîÈïøËøûÊé•‰∏éÁü≠ËøûÊé•ÁöÑÂå∫Âà´„Äã Ê°ÜÊû∂ „ÄäNettyÂéüÁêÜÂâñÊûê„Äã Reactor Ê®°Âºè‰ªãÁªç„ÄÇ Netty ÊòØ Reactor Ê®°ÂºèÁöÑ‰∏ÄÁßçÂÆûÁé∞„ÄÇ Èõ∂Êã∑Ë¥ùÔºàZero-copyÔºâ „ÄäÂØπ‰∫é Netty ByteBuf ÁöÑÈõ∂Êã∑Ë¥ù(Zero Copy) ÁöÑÁêÜËß£„Äã Â§ö‰∏™Áâ©ÁêÜÂàÜÁ¶ªÁöÑbufferÔºåÈÄöËøáÈÄªËæë‰∏äÂêàÂπ∂Êàê‰∏∫‰∏Ä‰∏™Ôºå‰ªéËÄåÈÅøÂÖç‰∫ÜÊï∞ÊçÆÂú®ÂÜÖÂ≠ò‰πãÈó¥ÁöÑÊã∑Ë¥ù„ÄÇ Â∫èÂàóÂåñ(‰∫åËøõÂà∂ÂçèËÆÆ)Hessian „ÄäHessianÂéüÁêÜÂàÜÊûê„ÄãBinary-RPC;‰∏ç‰ªÖ‰ªÖÊòØÂ∫èÂàóÂåñ Protobuf „ÄäProtobufÂçèËÆÆÁöÑJavaÂ∫îÁî®‰æãÂ≠ê„ÄãGoolgeÂá∫ÂìÅ„ÄÅÂç†Áî®Á©∫Èó¥ÂíåÊïàÁéáÂÆåËÉúÂÖ∂‰ªñÂ∫èÂàóÂåñÁ±ªÂ∫ìÔºåÂ¶ÇHessianÔºõÈúÄË¶ÅÁºñÂÜô .proto Êñá‰ª∂„ÄÇ „ÄäProtocol BuffersÂ∫èÂàóÂåñÂçèËÆÆÂèäÂ∫îÁî®„Äã * ÂÖ≥‰∫éÂçèËÆÆÁöÑËß£ÈáäÔºõÁº∫ÁÇπÔºöÂèØËØªÊÄßÂ∑Æ; „ÄäÁÆÄÂçïÁöÑ‰ΩøÁî® protobuf Âíå protostuff„Äã protostuff ÁöÑÂ•ΩÂ§ÑÊòØ‰∏çÁî®ÂÜô .proto Êñá‰ª∂ÔºåJava ÂØπË±°Áõ¥Êé•Â∞±ÂèØ‰ª•Â∫èÂàóÂåñ„ÄÇ Êï∞ÊçÆÂ∫ìÂü∫Á°ÄÁêÜËÆ∫Êï∞ÊçÆÂ∫ìËÆæËÆ°ÁöÑ‰∏âÂ§ßËåÉÂºè „ÄäÊï∞ÊçÆÂ∫ìÁöÑ‰∏âÂ§ßËåÉÂºè‰ª•Âèä‰∫îÂ§ßÁ∫¶Êùü„Äã Á¨¨‰∏ÄËåÉÂºèÔºöÊï∞ÊçÆË°®‰∏≠ÁöÑÊØè‰∏ÄÂàóÔºàÊØè‰∏™Â≠óÊÆµÔºâÂøÖÈ°ªÊòØ‰∏çÂèØÊãÜÂàÜÁöÑÊúÄÂ∞èÂçïÂÖÉÔºå‰πüÂ∞±ÊòØÁ°Æ‰øùÊØè‰∏ÄÂàóÁöÑÂéüÂ≠êÊÄßÔºõ Á¨¨‰∫åËåÉÂºèÔºà2NFÔºâÔºöÊª°Ë∂≥1NFÂêéÔºåË¶ÅÊ±ÇË°®‰∏≠ÁöÑÊâÄÊúâÂàóÔºåÈÉΩÂøÖÈ°ª‰æùËµñ‰∫é‰∏ªÈîÆÔºåËÄå‰∏çËÉΩÊúâ‰ªª‰Ωï‰∏ÄÂàó‰∏é‰∏ªÈîÆÊ≤°ÊúâÂÖ≥Á≥ªÔºå‰πüÂ∞±ÊòØËØ¥‰∏Ä‰∏™Ë°®Âè™ÊèèËø∞‰∏Ä‰ª∂‰∫ãÊÉÖÔºõ Á¨¨‰∏âËåÉÂºèÔºöÂøÖÈ°ªÂÖàÊª°Ë∂≥Á¨¨‰∫åËåÉÂºèÔºà2NFÔºâÔºåË¶ÅÊ±ÇÔºöË°®‰∏≠ÁöÑÊØè‰∏ÄÂàóÂè™‰∏é‰∏ªÈîÆÁõ¥Êé•Áõ∏ÂÖ≥ËÄå‰∏çÊòØÈó¥Êé•Áõ∏ÂÖ≥ÔºåÔºàË°®‰∏≠ÁöÑÊØè‰∏ÄÂàóÂè™ËÉΩ‰æùËµñ‰∫é‰∏ªÈîÆÔºâÔºõ MySQLÂéüÁêÜ „ÄäMySQLÁöÑInnoDBÁ¥¢ÂºïÂéüÁêÜËØ¶Ëß£„Äã „ÄäMySQLÂ≠òÂÇ®ÂºïÊìéÔºçÔºçMyISAM‰∏éInnoDBÂå∫Âà´„Äã ‰∏§ÁßçÁ±ªÂûãÊúÄ‰∏ªË¶ÅÁöÑÂ∑ÆÂà´Â∞±ÊòØInnodb ÊîØÊåÅ‰∫ãÂä°Â§ÑÁêÜ‰∏éÂ§ñÈîÆÂíåË°åÁ∫ßÈîÅ „ÄämyisamÂíåinnodbÁ¥¢ÂºïÂÆûÁé∞ÁöÑ‰∏çÂêå„Äã InnoDB „Ää‰∏ÄÁØáÊñáÁ´†Â∏¶‰Ω†ËØªÊáÇMysqlÂíåInnoDB„Äã ‰ºòÂåñ „ÄäMySQL36Êù°ÂÜõËßÑ„Äã „ÄäMYSQLÊÄßËÉΩ‰ºòÂåñÁöÑÊúÄ‰Ω≥20+Êù°ÁªèÈ™å„Äã „ÄäSQL‰ºòÂåñ‰πãÈÅì„Äã „ÄämysqlÊï∞ÊçÆÂ∫ìÊ≠ªÈîÅÁöÑ‰∫ßÁîüÂéüÂõ†ÂèäËß£ÂÜ≥ÂäûÊ≥ï„Äã „ÄäÂØºËá¥Á¥¢ÂºïÂ§±ÊïàÁöÑÂèØËÉΩÊÉÖÂÜµ„Äã „Ää MYSQLÂàÜÈ°µlimitÈÄüÂ∫¶Â§™ÊÖ¢‰ºòÂåñÊñπÊ≥ï„Äã ÂéüÂàô‰∏äÂ∞±ÊòØÁº©Â∞èÊâ´ÊèèËåÉÂõ¥„ÄÇ Á¥¢ÂºïËÅöÈõÜÁ¥¢Âºï, ÈùûËÅöÈõÜÁ¥¢Âºï „ÄäMySQL ËÅöÈõÜÁ¥¢Âºï/ÈùûËÅöÈõÜÁ¥¢ÂºïÁÆÄËø∞„Äã „ÄäMyISAMÂíåInnoDBÁöÑÁ¥¢ÂºïÂÆûÁé∞„Äã MyISAM ÊòØÈùûËÅöÈõÜÔºåInnoDB ÊòØËÅöÈõÜ Â§çÂêàÁ¥¢Âºï „ÄäÂ§çÂêàÁ¥¢ÂºïÁöÑ‰ºòÁÇπÂíåÊ≥®ÊÑè‰∫ãÈ°π„Äã Ëá™ÈÄÇÂ∫îÂìàÂ∏åÁ¥¢Âºï(AHI) „ÄäInnoDBÂ≠òÂÇ®ÂºïÊìé‚Äî‚ÄîËá™ÈÄÇÂ∫îÂìàÂ∏åÁ¥¢Âºï„Äã explain „ÄäMySQL ÊÄßËÉΩ‰ºòÂåñÁ•ûÂô® Explain ‰ΩøÁî®ÂàÜÊûê„Äã NoSQLMongoDB MongoDB ÊïôÁ®ã „ÄäMongodbÁõ∏ÂØπ‰∫éÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁöÑ‰ºòÁº∫ÁÇπ„Äã ‰ºòÁÇπÔºöÂº±‰∏ÄËá¥ÊÄßÔºàÊúÄÁªà‰∏ÄËá¥ÔºâÔºåÊõ¥ËÉΩ‰øùËØÅÁî®Êà∑ÁöÑËÆøÈóÆÈÄüÂ∫¶ÔºõÂÜÖÁΩÆGridFSÔºåÊîØÊåÅÂ§ßÂÆπÈáèÁöÑÂ≠òÂÇ®ÔºõSchema-less Êï∞ÊçÆÂ∫ìÔºå‰∏çÁî®È¢ÑÂÖàÂÆö‰πâÁªìÊûÑÔºõÂÜÖÁΩÆShardingÔºõÁõ∏ÊØî‰∫éÂÖ∂‰ªñNoSQLÔºåÁ¨¨‰∏âÊñπÊîØÊåÅ‰∏∞ÂØåÔºõÊÄßËÉΩ‰ºòË∂äÔºõ Áº∫ÁÇπÔºömongodb‰∏çÊîØÊåÅ‰∫ãÂä°Êìç‰ΩúÔºõmongodbÂç†Áî®Á©∫Èó¥ËøáÂ§ßÔºõMongoDBÊ≤°ÊúâÂ¶ÇMySQLÈÇ£Ê†∑ÊàêÁÜüÁöÑÁª¥Êä§Â∑•ÂÖ∑ÔºåËøôÂØπ‰∫éÂºÄÂèëÂíåITËøêËê•ÈÉΩÊòØ‰∏™ÂÄºÂæóÊ≥®ÊÑèÁöÑÂú∞ÊñπÔºõ Hbase „ÄäÁÆÄÊòé HBase ÂÖ•Èó®ÊïôÁ®ãÔºàÂºÄÁØáÔºâ„Äã „ÄäÊ∑±ÂÖ•Â≠¶‰π†HBaseÊû∂ÊûÑÂéüÁêÜ„Äã „Ää‰º†ÁªüÁöÑË°åÂ≠òÂÇ®ÂíåÔºàHBaseÔºâÂàóÂ≠òÂÇ®ÁöÑÂå∫Âà´„Äã „ÄäHbase‰∏é‰º†ÁªüÊï∞ÊçÆÂ∫ìÁöÑÂå∫Âà´„Äã Á©∫Êï∞ÊçÆ‰∏çÂ≠òÂÇ®ÔºåËäÇÁúÅÁ©∫Èó¥Ôºå‰∏îÈÄÇÁî®‰∫éÂπ∂Âèë„ÄÇ „ÄäHBase RowkeyËÆæËÆ°„Äã rowkey ÊåâÁÖßÂ≠óÂÖ∏È°∫Â∫èÊéíÂàóÔºå‰æø‰∫éÊâπÈáèÊâ´Êèè„ÄÇ ÈÄöËøáÊï£ÂàóÂèØ‰ª•ÈÅøÂÖçÁÉ≠ÁÇπ„ÄÇ ÊêúÁ¥¢ÂºïÊìéÊêúÁ¥¢ÂºïÊìéÂéüÁêÜ „ÄäÂÄíÊéíÁ¥¢Âºï‚ÄìÊêúÁ¥¢ÂºïÊìéÂÖ•Èó®„Äã Lucene „ÄäLuceneÂÖ•Èó®ÁÆÄ‰ªã„Äã Elasticsearch „ÄäElasticsearchÂ≠¶‰π†ÔºåËØ∑ÂÖàÁúãËøô‰∏ÄÁØáÔºÅ„Äã „ÄäElasticsearchÁ¥¢ÂºïÂéüÁêÜ„Äã Solr „Ää Apache SolrÂÖ•Èó®ÊïôÁ®ã„Äã „Ääelasticsearch‰∏ésolrÊØîËæÉ„Äã sphinx „ÄäSphinx ÁöÑ‰ªãÁªçÂíåÂéüÁêÜÊé¢Á¥¢„Äã ÊÄßËÉΩÊÄßËÉΩ‰ºòÂåñÊñπÊ≥ïËÆ∫ „Ää15Â§©ÁöÑÊÄßËÉΩ‰ºòÂåñÂ∑•‰ΩúÔºå5ÊñπÈù¢ÁöÑË∞É‰ºòÁªèÈ™å„Äã ‰ª£Á†ÅÂ±ÇÈù¢„ÄÅ‰∏öÂä°Â±ÇÈù¢„ÄÅÊï∞ÊçÆÂ∫ìÂ±ÇÈù¢„ÄÅÊúçÂä°Âô®Â±ÇÈù¢„ÄÅÂâçÁ´Ø‰ºòÂåñ„ÄÇ „ÄäÁ≥ªÁªüÊÄßËÉΩ‰ºòÂåñÁöÑÂá†‰∏™ÊñπÈù¢„Äã ÂÆπÈáèËØÑ‰º∞ „ÄäËÅîÁΩëÊÄßËÉΩ‰∏éÂÆπÈáèËØÑ‰º∞ÁöÑÊñπÊ≥ïËÆ∫ÂíåÂÖ∏ÂûãÊ°à‰æã„Äã „Ää‰∫íËÅîÁΩëÊû∂ÊûÑÔºåÂ¶Ç‰ΩïËøõË°åÂÆπÈáèËÆæËÆ°Ôºü„Äã ËØÑ‰º∞ÊÄªËÆøÈóÆÈáè„ÄÅËØÑ‰º∞Âπ≥ÂùáËÆøÈóÆÈáèQPS„ÄÅËØÑ‰º∞È´òÂ≥∞QPS„ÄÅËØÑ‰º∞Á≥ªÁªü„ÄÅÂçïÊú∫ÊûÅÈôêQPS CDN ÁΩëÁªú „ÄäCDNÂä†ÈÄüÂéüÁêÜ„Äã „ÄäÂõΩÂÜÖÊúâÂì™‰∫õÊØîËæÉÂ•ΩÁöÑ CDNÔºü„Äã ËøûÊé•Ê±† „Ää‰∏ªÊµÅJavaÊï∞ÊçÆÂ∫ìËøûÊé•Ê±†ÊØîËæÉ‰∏éÂºÄÂèëÈÖçÁΩÆÂÆûÊàò„Äã ÊÄßËÉΩË∞É‰ºò „Ää‰πùÂ§ßJavaÊÄßËÉΩË∞ÉËØïÂ∑•ÂÖ∑ÔºåÂøÖÂ§áËá≥Â∞ë‰∏ÄÊ¨æ„Äã Â§ßÊï∞ÊçÆÊµÅÂºèËÆ°ÁÆóStorm ÂÆòÊñπÁΩëÁ´ô „ÄäÊúÄËØ¶ÁªÜÁöÑStormÂÖ•Èó®ÊïôÁ®ã„Äã Flink „ÄäFlink‰πã‰∏Ä FlinkÂü∫Êú¨ÂéüÁêÜ‰ªãÁªç„Äã Kafka Stream „ÄäKafka StreamË∞ÉÁ†îÔºö‰∏ÄÁßçËΩªÈáèÁ∫ßÊµÅËÆ°ÁÆóÊ®°Âºè„Äã Â∫îÁî®Âú∫ÊôØ‰æãÂ¶ÇÔºö ÂπøÂëäÁõ∏ÂÖ≥ÂÆûÊó∂ÁªüËÆ°Ôºõ Êé®ËçêÁ≥ªÁªüÁî®Êà∑ÁîªÂÉèÊ†áÁ≠æÂÆûÊó∂Êõ¥Êñ∞Ôºõ Á∫ø‰∏äÊúçÂä°ÂÅ•Â∫∑Áä∂ÂÜµÂÆûÊó∂ÁõëÊµãÔºõ ÂÆûÊó∂Ê¶úÂçïÔºõ ÂÆûÊó∂Êï∞ÊçÆÁªüËÆ°„ÄÇ Hadoop „ÄäÁî®ÈÄö‰øóÊòìÊáÇÁöÑËØùËØ¥‰∏ãhadoopÊòØ‰ªÄ‰πà,ËÉΩÂÅö‰ªÄ‰πà„Äã „ÄäÂè≤‰∏äÊúÄËØ¶ÁªÜÁöÑHadoopÁéØÂ¢ÉÊê≠Âª∫„Äã HDFS „Ää„ÄêHadoopÂ≠¶‰π†„ÄëHDFSÂü∫Êú¨ÂéüÁêÜ„Äã MapReduce „ÄäÁî®ÈÄö‰øóÊòìÊáÇÁöÑÂ§ßÁôΩËØùËÆ≤Ëß£Map/ReduceÂéüÁêÜ„Äã „Ää ÁÆÄÂçïÁöÑmap-reduceÁöÑjava‰æãÂ≠ê„Äã Yarn „ÄäÂàùÊ≠•ÊéåÊè°YarnÁöÑÊû∂ÊûÑÂèäÂéüÁêÜ„Äã Spark „ÄäSpark(‰∏Ä): Âü∫Êú¨Êû∂ÊûÑÂèäÂéüÁêÜ„Äã ÂÆâÂÖ®web ÂÆâÂÖ®XSS „ÄäxssÊîªÂáªÂéüÁêÜ‰∏éËß£ÂÜ≥ÊñπÊ≥ï„ÄãCSRF „ÄäCSRFÂéüÁêÜÂèäÈò≤ËåÉ„Äã SQL Ê≥®ÂÖ• „ÄäSQLÊ≥®ÂÖ•„Äã Hash Dos „ÄäÈÇ™ÊÅ∂ÁöÑJAVA HASH DOSÊîªÂáª„Äã Âà©Áî®JsonObjet ‰∏ä‰º†Â§ßJsonÔºåJsonObject Â∫ïÂ±Ç‰ΩøÁî®HashMapÔºõ‰∏çÂêåÁöÑÊï∞ÊçÆ‰∫ßÁîüÁõ∏ÂêåÁöÑhashÂÄºÔºå‰ΩøÂæóÊûÑÂª∫HashÈÄüÂ∫¶ÂèòÊÖ¢ÔºåËÄóÂ∞ΩCPU„ÄÇ „Ää‰∏ÄÁßçÈ´òÁ∫ßÁöÑDoSÊîªÂáª-HashÁ¢∞ÊíûÊîªÂáª„Äã „ÄäÂÖ≥‰∫éHash Collision DoSÊºèÊ¥ûÔºöËß£Êûê‰∏éËß£ÂÜ≥ÊñπÊ°à„Äã ËÑöÊú¨Ê≥®ÂÖ• „Ää‰∏ä‰º†Êñá‰ª∂ÊºèÊ¥ûÂéüÁêÜÂèäÈò≤ËåÉ„Äã ÊºèÊ¥ûÊâ´ÊèèÂ∑•ÂÖ∑ „ÄäDVWA„Äã W3af OpenVASËØ¶Ëß£ È™åËØÅÁ†Å „ÄäÈ™åËØÅÁ†ÅÂéüÁêÜÂàÜÊûêÂèäÂÆûÁé∞„Äã „ÄäËØ¶Ëß£ÊªëÂä®È™åËØÅÁ†ÅÁöÑÂÆûÁé∞ÂéüÁêÜ„Äã ÊªëÂä®È™åËØÅÁ†ÅÊòØÊ†πÊçÆ‰∫∫Âú®ÊªëÂä®ÊªëÂùóÁöÑÂìçÂ∫îÊó∂Èó¥ÔºåÊãñÊãΩÈÄüÂ∫¶ÔºåÊó∂Èó¥Ôºå‰ΩçÁΩÆÔºåËΩ®ËøπÔºåÈáçËØïÊ¨°Êï∞Á≠âÊù•ËØÑ‰º∞È£éÈô©„ÄÇ „ÄäÊ∑òÂÆùÊªëÂä®È™åËØÅÁ†ÅÁ†îÁ©∂„Äã DDoS Èò≤ËåÉ „ÄäÂ≠¶‰π†ÊâãÂÜåÔºöDDoSÁöÑÊîªÂáªÊñπÂºèÂèäÈò≤Âæ°ÊâãÊÆµ„Äã „ÄäÂÖçË¥πDDoSÊîªÂáªÊµãËØïÂ∑•ÂÖ∑Â§ßÂêàÈõÜ„Äã Áî®Êà∑ÈöêÁßÅ‰ø°ÊÅØ‰øùÊä§ Áî®Êà∑ÂØÜÁ†ÅÈùûÊòéÊñá‰øùÂ≠òÔºåÂä†Âä®ÊÄÅslat„ÄÇ Ë∫´‰ªΩËØÅÂè∑ÔºåÊâãÊú∫Âè∑Â¶ÇÊûúË¶ÅÊòæÁ§∫ÔºåÁî® ‚Äú*‚Äù Êõø‰ª£ÈÉ®ÂàÜÂ≠óÁ¨¶„ÄÇ ËÅîÁ≥ªÊñπÂºèÂú®ÁöÑÊòæÁ§∫‰∏éÂê¶Áî±Áî®Êà∑Ëá™Â∑±ÊéßÂà∂„ÄÇ TODO „Ää‰∏™‰∫∫ÈöêÁßÅÂåÖÊã¨Âì™‰∫õ„Äã „ÄäÂú®‰∫íËÅîÁΩë‰∏äÔºåÈöêÁßÅÁöÑËåÉÂõ¥ÂåÖÊã¨Âì™‰∫õÔºü„Äã „ÄäÁî®Êà∑ÂØÜÁ†Å‰øùÂ≠ò„Äã Â∫èÂàóÂåñÊºèÊ¥û „ÄäLib‰πãËøáÔºüJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÈÄöÁî®Âà©Áî®ÂàÜÊûê„Äã Âä†ÂØÜËß£ÂØÜÂØπÁß∞Âä†ÂØÜ „ÄäÂ∏∏ËßÅÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ï„Äã DES„ÄÅ3DES„ÄÅBlowfish„ÄÅAES DES ÈááÁî® 56‰ΩçÁßòÈí•ÔºåBlowfish ÈááÁî®1Âà∞448‰ΩçÂèòÈïøÁßòÈí•ÔºåAES 128Ôºå192Âíå256‰ΩçÈïøÂ∫¶ÁöÑÁßòÈí•„ÄÇ DES ÁßòÈí•Â§™Áü≠ÔºàÂè™Êúâ56‰ΩçÔºâÁÆóÊ≥ïÁõÆÂâçÂ∑≤ÁªèË¢´ AES Âèñ‰ª£ÔºåÂπ∂‰∏î AES ÊúâÁ°¨‰ª∂Âä†ÈÄüÔºåÊÄßËÉΩÂæàÂ•Ω„ÄÇ ÂìàÂ∏åÁÆóÊ≥ï „ÄäÂ∏∏Áî®ÁöÑÂìàÂ∏åÁÆóÊ≥ï„Äã MD5 Âíå SHA-1 Â∑≤Áªè‰∏çÂÜçÂÆâÂÖ®ÔºåÂ∑≤Ë¢´ÂºÉÁî®„ÄÇ ÁõÆÂâç SHA-256 ÊòØÊØîËæÉÂÆâÂÖ®ÁöÑ„ÄÇ „ÄäÂü∫‰∫éHashÊëòË¶ÅÁ≠æÂêçÁöÑÂÖ¨ÁΩëURLÁ≠æÂêçÈ™åËØÅËÆæËÆ°ÊñπÊ°à„Äã ÈùûÂØπÁß∞Âä†ÂØÜ „ÄäÂ∏∏ËßÅÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ï„Äã RSA„ÄÅDSA„ÄÅECDSA(Ëû∫ÊóãÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ï) Âíå RSA ‰∏çÂêåÁöÑÊòØ DSA ‰ªÖËÉΩÁî®‰∫éÊï∞Â≠óÁ≠æÂêçÔºå‰∏çËÉΩËøõË°åÊï∞ÊçÆÂä†ÂØÜËß£ÂØÜÔºåÂÖ∂ÂÆâÂÖ®ÊÄßÂíåRSAÁõ∏ÂΩìÔºå‰ΩÜÂÖ∂ÊÄßËÉΩË¶ÅÊØîRSAÂø´„ÄÇ 256‰ΩçÁöÑECCÁßòÈí•ÁöÑÂÆâÂÖ®ÊÄßÁ≠âÂêå‰∫é3072‰ΩçÁöÑRSAÁßòÈí•„ÄÇ „ÄäÂå∫ÂùóÈìæÁöÑÂä†ÂØÜÊäÄÊúØ„Äã ÊúçÂä°Âô®ÂÆâÂÖ® „ÄäLinuxÂº∫ÂåñËÆ∫Ôºö15Ê≠•ÊâìÈÄ†‰∏Ä‰∏™ÂÆâÂÖ®ÁöÑLinuxÊúçÂä°Âô®„Äã Êï∞ÊçÆÂÆâÂÖ®Êï∞ÊçÆÂ§á‰ªΩTODO ÁΩëÁªúÈöîÁ¶ªÂÜÖÂ§ñÁΩëÂàÜÁ¶ªTODO ÁôªÂΩïË∑≥ÊùøÊú∫Âú®ÂÜÖÂ§ñÁéØÂ¢É‰∏≠ÈÄöËøáË∑≥ÊùøÊú∫ÁôªÂΩïÂà∞Á∫ø‰∏ä‰∏ªÊú∫„ÄÇ „ÄäÊê≠Âª∫ÁÆÄÊòìÂ†°ÂûíÊú∫„Äã ÊéàÊùÉ„ÄÅËÆ§ËØÅRBAC „ÄäÂü∫‰∫éÁªÑÁªáËßíËâ≤ÁöÑÊùÉÈôêËÆæËÆ°„Äã „ÄäÊùÉÈôêÁ≥ªÁªü‰∏éRBACÊ®°ÂûãÊ¶ÇËø∞„Äã „ÄäSpringÊï¥ÂêàShiroÂÅöÊùÉÈôêÊéßÂà∂Ê®°ÂùóËØ¶ÁªÜÊ°à‰æãÂàÜÊûê„Äã OAuth2.0 „ÄäÁêÜËß£OAuth 2.0„Äã ÂèåÂõ†Á¥†ËÆ§ËØÅÔºà2FAÔºâ2FA - Two-factor authenticationÔºåÁî®‰∫éÂä†Âº∫ÁôªÂΩïÈ™åËØÅ Â∏∏Áî®ÂÅöÊ≥ïÊòØ ÁôªÂΩïÂØÜÁ†Å + ÊâãÊú∫È™åËØÅÁ†ÅÔºàÊàñËÄÖ‰ª§ÁâåKeyÔºåÁ±ª‰ºº‰∫é‰∏éÁΩëÈì∂ÁöÑ USB keyÔºâ „Äê„ÄäÂèåÂõ†Á¥†ËÆ§ËØÅÔºà2FAÔºâÊïôÁ®ã„Äã„Äë(http://www.ruanyifeng.com/blog/2017/11/2fa-tutorial.html) ÂçïÁÇπÁôªÂΩï(SSO) „ÄäÂçïÁÇπÁôªÂΩïÂéüÁêÜ‰∏éÁÆÄÂçïÂÆûÁé∞„Äã CASÂçïÁÇπÁôªÂΩïÊ°ÜÊû∂ Â∏∏Áî®ÂºÄÊ∫êÊ°ÜÊû∂ÂºÄÊ∫êÂçèËÆÆ „ÄäÂºÄÊ∫êÂçèËÆÆÁöÑÈÄâÊã©„Äã Â¶Ç‰ΩïÈÄâÊã©‰∏Ä‰∏™ÂºÄÊ∫êËΩØ‰ª∂ÂçèËÆÆ Êó•ÂøóÊ°ÜÊû∂Log4j„ÄÅLog4j2 „Äälog4j ËØ¶ÁªÜËÆ≤Ëß£„Äã „Äälog4j2 ÂÆûÈôÖ‰ΩøÁî®ËØ¶Ëß£„Äã „ÄäLog4j1,Logback‰ª•ÂèäLog4j2ÊÄßËÉΩÊµãËØïÂØπÊØî„Äã Log4J ÂºÇÊ≠•Êó•ÂøóÊÄßËÉΩ‰ºòÂºÇ„ÄÇ Logback „ÄäÊúÄÂÖ®LogBack ËØ¶Ëß£„ÄÅÂê´javaÊ°à‰æãÂíåÈÖçÁΩÆËØ¥Êòé„Äã ORM „ÄäORMÊ°ÜÊû∂‰ΩøÁî®‰ºòÁº∫ÁÇπ„Äã ‰∏ªË¶ÅÁõÆÁöÑÊòØ‰∏∫‰∫ÜÊèêÈ´òÂºÄÂèëÊïàÁéá„ÄÇ MyBatisÔºö „ÄämybatisÁºìÂ≠òÊú∫Âà∂ËØ¶Ëß£„Äã ‰∏ÄÁ∫ßÁºìÂ≠òÊòØSqlSessionÁ∫ßÂà´ÁöÑÁºìÂ≠òÔºåÁºìÂ≠òÁöÑÊï∞ÊçÆÂè™Âú®SqlSessionÂÜÖÊúâÊïà ‰∫åÁ∫ßÁºìÂ≠òÊòØmapperÁ∫ßÂà´ÁöÑÁºìÂ≠òÔºåÂêå‰∏Ä‰∏™namespaceÂÖ¨Áî®Ëøô‰∏Ä‰∏™ÁºìÂ≠òÔºåÊâÄ‰ª•ÂØπSqlSessionÊòØÂÖ±‰∫´ÁöÑÔºõ‰ΩøÁî® LRU Êú∫Âà∂Ê∏ÖÁêÜÁºìÂ≠òÔºåÈÄöËøá cacheEnabled ÂèÇÊï∞ÂºÄÂêØ„ÄÇ „ÄäMyBatisÂ≠¶‰π†‰πã‰ª£Á†ÅÁîüÊàêÂô®Generator„Äã ÁΩëÁªúÊ°ÜÊû∂TODO Web Ê°ÜÊû∂Spring ÂÆ∂ÊóèSpring Spring ÁÆÄÊòéÊïôÁ®ã Spring Boot ÂÆòÊñπÁΩëÁ´ô „ÄäSpring BootÂü∫Á°ÄÊïôÁ®ã„Äã Spring Cloud Spring Boot ‰∏≠ÊñáÁ¥¢ÂºïÁ´ô Spring Cloud ‰∏≠ÊñáÊñáÊ°£ „ÄäSpring CloudÂü∫Á°ÄÊïôÁ®ã„Äã Â∑•ÂÖ∑Ê°ÜÊû∂ „ÄäApache Commons Â∑•ÂÖ∑Á±ª‰ªãÁªçÂèäÁÆÄÂçï‰ΩøÁî®„Äã „ÄäGoogle guava ‰∏≠ÊñáÊïôÁ®ã„Äã ÂàÜÂ∏ÉÂºèËÆæËÆ°Êâ©Â±ïÊÄßËÆæËÆ° „ÄäÊû∂ÊûÑÂ∏à‰∏çÂèØ‰∏çÁü•ÁöÑÂçÅÂ§ßÂèØÊâ©Â±ïÊû∂ÊûÑ„Äã ÊÄªÁªì‰∏ãÊù•ÔºåÈÄöÁî®ÁöÑÂ•óË∑ØÂ∞±ÊòØÂàÜÂ∏É„ÄÅÁºìÂ≠òÂèäÂºÇÊ≠•Â§ÑÁêÜ„ÄÇ „ÄäÂèØÊâ©Â±ïÊÄßËÆæËÆ°‰πãÊï∞ÊçÆÂàáÂàÜ„Äã Ê∞¥Âπ≥ÂàáÂàÜ+ÂûÇÁõ¥ÂàáÂàÜ Âà©Áî®‰∏≠Èó¥‰ª∂ËøõË°åÂàÜÁâáÂ¶ÇÔºåMySQL Proxy„ÄÇ Âà©Áî®ÂàÜÁâáÁ≠ñÁï•ËøõË°åÂàáÂàÜÔºåÂ¶ÇÊåâÁÖßIDÂèñÊ®°„ÄÇ „ÄäËØ¥ËØ¥Â¶Ç‰ΩïÂÆûÁé∞ÂèØÊâ©Â±ïÊÄßÁöÑÂ§ßÂûãÁΩëÁ´ôÊû∂ÊûÑ„Äã ÂàÜÂ∏ÉÂºèÊúçÂä°+Ê∂àÊÅØÈòüÂàó„ÄÇ „ÄäÂ§ßÂûãÁΩëÁ´ôÊäÄÊúØÊû∂ÊûÑÔºà‰∏ÉÔºâ‚ÄìÁΩëÁ´ôÁöÑÂèØÊâ©Â±ïÊÄßÊû∂ÊûÑ„Äã Á®≥ÂÆöÊÄß &amp; È´òÂèØÁî® „ÄäÁ≥ªÁªüËÆæËÆ°ÔºöÂÖ≥‰∫éÈ´òÂèØÁî®Á≥ªÁªüÁöÑ‰∏Ä‰∫õÊäÄÊúØÊñπÊ°à„Äã ÂèØÊâ©Â±ïÔºöÊ∞¥Âπ≥Êâ©Â±ï„ÄÅÂûÇÁõ¥Êâ©Â±ï„ÄÇ ÈÄöËøáÂÜó‰ΩôÈÉ®ÁΩ≤ÔºåÈÅøÂÖçÂçïÁÇπÊïÖÈöú„ÄÇ ÈöîÁ¶ªÔºöÈÅøÂÖçÂçï‰∏Ä‰∏öÂä°Âç†Áî®ÂÖ®ÈÉ®ËµÑÊ∫ê„ÄÇÈÅøÂÖç‰∏öÂä°‰πãÈó¥ÁöÑÁõ∏‰∫íÂΩ±Âìç 2. Êú∫ÊàøÈöîÁ¶ªÈÅøÂÖçÂçïÁÇπÊïÖÈöú„ÄÇ Ëß£ËÄ¶ÔºöÈôç‰ΩéÁª¥Êä§ÊàêÊú¨ÔºåÈôç‰ΩéËÄ¶ÂêàÈ£éÈô©„ÄÇÂáèÂ∞ë‰æùËµñÔºåÂáèÂ∞ëÁõ∏‰∫íÈó¥ÁöÑÂΩ±Âìç„ÄÇ ÈôêÊµÅÔºöÊªëÂä®Á™óÂè£ËÆ°Êï∞Ê≥ï„ÄÅÊºèÊ°∂ÁÆóÊ≥ï„ÄÅ‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÁ≠âÁÆóÊ≥ï„ÄÇÈÅáÂà∞Á™ÅÂèëÊµÅÈáèÊó∂Ôºå‰øùËØÅÁ≥ªÁªüÁ®≥ÂÆö„ÄÇ ÈôçÁ∫ßÔºöÁ¥ßÊÄ•ÊÉÖÂÜµ‰∏ãÈáäÊîæÈùûÊ†∏ÂøÉÂäüËÉΩÁöÑËµÑÊ∫ê„ÄÇÁâ∫Áâ≤ÈùûÊ†∏ÂøÉ‰∏öÂä°Ôºå‰øùËØÅÊ†∏ÂøÉ‰∏öÂä°ÁöÑÈ´òÂèØÁî®„ÄÇ ÁÜîÊñ≠ÔºöÂºÇÂ∏∏ÊÉÖÂÜµË∂ÖÂá∫ÈòàÂÄºËøõÂÖ•ÁÜîÊñ≠Áä∂ÊÄÅÔºåÂø´ÈÄüÂ§±Ë¥•„ÄÇÂáèÂ∞ë‰∏çÁ®≥ÂÆöÁöÑÂ§ñÈÉ®‰æùËµñÂØπÊ†∏ÂøÉÊúçÂä°ÁöÑÂΩ±Âìç„ÄÇ Ëá™Âä®ÂåñÊµãËØïÔºöÈÄöËøáÂÆåÂñÑÁöÑÊµãËØïÔºåÂáèÂ∞ëÂèëÂ∏ÉÂºïËµ∑ÁöÑÊïÖÈöú„ÄÇ ÁÅ∞Â∫¶ÂèëÂ∏ÉÔºöÁÅ∞Â∫¶ÂèëÂ∏ÉÊòØÈÄüÂ∫¶‰∏éÂÆâÂÖ®ÊÄß‰Ωú‰∏∫Â¶•ÂçèÔºåËÉΩÂ§üÊúâÊïàÂáèÂ∞ëÂèëÂ∏ÉÊïÖÈöú„ÄÇ „ÄäÂÖ≥‰∫éÈ´òÂèØÁî®ÁöÑÁ≥ªÁªü„Äã ËÆæËÆ°ÂéüÂàôÔºöÊï∞ÊçÆ‰∏ç‰∏¢(ÊåÅ‰πÖÂåñ)ÔºõÊúçÂä°È´òÂèØÁî®(ÊúçÂä°ÂâØÊú¨)ÔºõÁªùÂØπÁöÑ100%È´òÂèØÁî®ÂæàÈöæÔºåÁõÆÊ†áÊòØÂÅöÂà∞Â∞ΩÂèØËÉΩÂ§öÁöÑ9ÔºåÂ¶Ç99.999%ÔºàÂÖ®Âπ¥Á¥ØËÆ°Âè™Êúâ5ÂàÜÈíüÔºâ„ÄÇ Á°¨‰ª∂Ë¥üËΩΩÂùáË°° „ÄäËΩ¨ÔºÅÔºÅË¥üËΩΩÂùáË°°Âô®ÊäÄÊúØNginxÂíåF5ÁöÑ‰ºòÁº∫ÁÇπÂØπÊØî„Äã ‰∏ªË¶ÅÊòØÂíåF5ÂØπÊØî„ÄÇ „ÄäËΩØ/Á°¨‰ª∂Ë¥üËΩΩÂùáË°°‰∫ßÂìÅ ‰Ω†Áü•Â§öÂ∞ëÔºü„Äã ËΩØ‰ª∂Ë¥üËΩΩÂùáË°° „ÄäÂá†ÁßçË¥üËΩΩÂùáË°°ÁÆóÊ≥ï„Äã ËΩÆÂØª„ÄÅÊùÉÈáç„ÄÅË¥üËΩΩ„ÄÅÊúÄÂ∞ëËøûÊé•„ÄÅQoS „ÄäDNSË¥üËΩΩÂùáË°°„Äã ÈÖçÁΩÆÁÆÄÂçïÔºåÊõ¥Êñ∞ÈÄüÂ∫¶ÊÖ¢„ÄÇ „ÄäNginxË¥üËΩΩÂùáË°°„Äã ÁÆÄÂçïËΩªÈáè„ÄÅÂ≠¶‰π†ÊàêÊú¨‰ΩéÔºõ‰∏ªË¶ÅÈÄÇÁî®‰∫éwebÂ∫îÁî®„ÄÇ „ÄäÂÄüÂä©LVS+KeepalivedÂÆûÁé∞Ë¥üËΩΩÂùáË°° „Äã ÈÖçÁΩÆÊØîËæÉË¥üËΩΩ„ÄÅÂè™ÊîØÊåÅÂà∞4Â±ÇÔºåÊÄßËÉΩËæÉÈ´ò„ÄÇ „ÄäHAProxyÁî®Ê≥ïËØ¶Ëß£ ÂÖ®ÁΩëÊúÄËØ¶ÁªÜ‰∏≠ÊñáÊñáÊ°£„Äã ÊîØÊåÅÂà∞‰∏ÉÂ±ÇÔºàÊØîÂ¶ÇHTTPÔºâ„ÄÅÂäüËÉΩÊØîËæÉÂÖ®Èù¢ÔºåÊÄßËÉΩ‰πü‰∏çÈîô„ÄÇ „ÄäHaproxy+Keepalived+MySQLÂÆûÁé∞ËØªÂùáË°°Ë¥üËΩΩ„Äã ‰∏ªË¶ÅÊòØÁî®Êà∑ËØªËØ∑Ê±ÇÁöÑË¥üËΩΩÂùáË°°„ÄÇ „Äärabbitmq+haproxy+keepalivedÂÆûÁé∞È´òÂèØÁî®ÈõÜÁæ§Êê≠Âª∫„Äã ÈôêÊµÅ „ÄäË∞àË∞àÈ´òÂπ∂ÂèëÁ≥ªÁªüÁöÑÈôêÊµÅ„Äã ËÆ°Êï∞Âô®ÔºöÈÄöËøáÊªëÂä®Á™óÂè£ËÆ°Êï∞Âô®ÔºåÊéßÂà∂Âçï‰ΩçÊó∂Èó¥ÂÜÖÁöÑËØ∑Ê±ÇÊ¨°Êï∞ÔºåÁÆÄÂçïÁ≤óÊö¥„ÄÇ ÊºèÊ°∂ÁÆóÊ≥ïÔºöÂõ∫ÂÆöÂÆπÈáèÁöÑÊºèÊ°∂ÔºåÊºèÊ°∂Êª°‰∫ÜÂ∞±‰∏¢ÂºÉËØ∑Ê±ÇÔºåÊØîËæÉÂ∏∏Áî®„ÄÇ ‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÔºöÂõ∫ÂÆöÂÆπÈáèÁöÑ‰ª§ÁâåÊ°∂ÔºåÊåâÁÖß‰∏ÄÂÆöÈÄüÁéáÊ∑ªÂä†‰ª§ÁâåÔºåÂ§ÑÁêÜËØ∑Ê±ÇÂâçÈúÄË¶ÅÊãøÂà∞‰ª§ÁâåÔºåÊãø‰∏çÂà∞‰ª§ÁâåÂàô‰∏¢ÂºÉËØ∑Ê±ÇÔºåÊàñËøõÂÖ•‰∏¢ÈòüÂàóÔºåÂèØ‰ª•ÈÄöËøáÊéßÂà∂Ê∑ªÂä†‰ª§ÁâåÁöÑÈÄüÁéáÔºåÊù•ÊéßÂà∂Êï¥‰ΩìÈÄüÂ∫¶„ÄÇGuava ‰∏≠ÁöÑ RateLimiter ÊòØ‰ª§ÁâåÊ°∂ÁöÑÂÆûÁé∞„ÄÇ Nginx ÈôêÊµÅÔºöÈÄöËøá limit_req Á≠âÊ®°ÂùóÈôêÂà∂Âπ∂ÂèëËøûÊé•Êï∞„ÄÇ Â∫îÁî®Â±ÇÂÆπÁÅæ „ÄäÈò≤Èõ™Â¥©Âà©Âô®ÔºöÁÜîÊñ≠Âô® Hystrix ÁöÑÂéüÁêÜ‰∏é‰ΩøÁî®„Äã Èõ™Â¥©ÊïàÂ∫îÂéüÂõ†ÔºöÁ°¨‰ª∂ÊïÖÈöú„ÄÅÁ°¨‰ª∂ÊïÖÈöú„ÄÅÁ®ãÂ∫èBug„ÄÅÈáçËØïÂä†Â§ßÊµÅÈáè„ÄÅÁî®Êà∑Â§ßÈáèËØ∑Ê±Ç„ÄÇ Èõ™Â¥©ÁöÑÂØπÁ≠ñÔºöÈôêÊµÅ„ÄÅÊîπËøõÁºìÂ≠òÊ®°Âºè(ÁºìÂ≠òÈ¢ÑÂä†ËΩΩ„ÄÅÂêåÊ≠•Ë∞ÉÁî®ÊîπÂºÇÊ≠•)„ÄÅËá™Âä®Êâ©ÂÆπ„ÄÅÈôçÁ∫ß„ÄÇ HystrixËÆæËÆ°ÂéüÂàôÔºö ËµÑÊ∫êÈöîÁ¶ªÔºöHystrixÈÄöËøáÂ∞ÜÊØè‰∏™‰æùËµñÊúçÂä°ÂàÜÈÖçÁã¨Á´ãÁöÑÁ∫øÁ®ãÊ±†ËøõË°åËµÑÊ∫êÈöîÁ¶ª, ‰ªéËÄåÈÅøÂÖçÊúçÂä°Èõ™Â¥©„ÄÇ ÁÜîÊñ≠ÂºÄÂÖ≥ÔºöÊúçÂä°ÁöÑÂÅ•Â∫∑Áä∂ÂÜµ = ËØ∑Ê±ÇÂ§±Ë¥•Êï∞ / ËØ∑Ê±ÇÊÄªÊï∞ÔºåÈÄöËøáÈòàÂÄºËÆæÂÆöÂíåÊªëÂä®Á™óÂè£ÊéßÂà∂ÂºÄÂÖ≥„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÔºöÈÄöËøáÁªßÊâø HystrixCommand Êù•ÂåÖË£ÖÊúçÂä°Ë∞ÉÁî®ÈÄªËæë„ÄÇ „ÄäÁºìÂ≠òÁ©øÈÄèÔºåÁºìÂ≠òÂáªÁ©øÔºåÁºìÂ≠òÈõ™Â¥©Ëß£ÂÜ≥ÊñπÊ°àÂàÜÊûê„Äã „ÄäÁºìÂ≠òÂáªÁ©ø„ÄÅÂ§±Êïà‰ª•ÂèäÁÉ≠ÁÇπkeyÈóÆÈ¢ò„Äã ‰∏ªË¶ÅÁ≠ñÁï•ÔºöÂ§±ÊïàÁû¨Èó¥ÔºöÂçïÊú∫‰ΩøÁî®ÈîÅÔºõ‰ΩøÁî®ÂàÜÂ∏ÉÂºèÈîÅÔºõ‰∏çËøáÊúüÔºõ ÁÉ≠ÁÇπÊï∞ÊçÆÔºöÁÉ≠ÁÇπÊï∞ÊçÆÂçïÁã¨Â≠òÂÇ®Ôºõ‰ΩøÁî®Êú¨Âú∞ÁºìÂ≠òÔºõÂàÜÊàêÂ§ö‰∏™Â≠êkeyÔºõ Ë∑®Êú∫ÊàøÂÆπÁÅæ „Ää‚ÄúÂºÇÂú∞Â§öÊ¥ª‚ÄùÂ§öÊú∫ÊàøÈÉ®ÁΩ≤ÁªèÈ™åË∞à„Äã ÈÄöËøáËá™Á†î‰∏≠Èó¥‰ª∂ËøõË°åÊï∞ÊçÆÂêåÊ≠•„ÄÇ „ÄäÂºÇÂú∞Â§öÊ¥ªÔºàÂºÇÂú∞ÂèåÊ¥ªÔºâÂÆûË∑µÁªèÈ™å„Äã Ê≥®ÊÑèÂª∂ËøüÈóÆÈ¢òÔºåÂ§öÊ¨°Ë∑®Êú∫ÊàøË∞ÉÁî®‰ºöÂ∞ÜÂª∂Êó∂ÊîæÂ§ßÊï∞ÂÄç„ÄÇ Âª∫ÊàøÈó¥‰∏ìÁ∫øÂæàÂ§ßÊ¶ÇÁéá‰ºöÂá∫Áé∞ÈóÆÈ¢òÔºåÂÅöÂ•ΩËøêÁª¥ÂíåÁ®ãÂ∫èÂ±ÇÈù¢ÁöÑÂÆπÈîô„ÄÇ ‰∏çËÉΩ‰æùËµñ‰∫éÁ®ãÂ∫èÁ´ØÊï∞ÊçÆÂèåÂÜôÔºåË¶ÅÊúâËá™Âä®ÂêåÊ≠•ÊñπÊ°à„ÄÇ Êï∞ÊçÆÊ∞∏‰∏çÂú®È´òÂª∂ËøüÂíåËæÉÂ∑ÆÁΩëÁªúË¥®Èáè‰∏ãÔºåËÄÉËôëÂêåÊ≠•Ë¥®ÈáèÈóÆÈ¢ò„ÄÇ Ê†∏ÂøÉ‰∏öÂä°ÂíåÊ¨°Ë¶Å‰∏öÂä°ÂàÜËÄåÊ≤ª‰πãÔºåÁîöËá≥Âè™ËÄÉËôëÊ†∏ÂøÉ‰∏öÂä°„ÄÇ ÂºÇÂú∞Â§öÊ¥ªÁõëÊéßÈÉ®ÁΩ≤„ÄÅÊµãËØï‰πüË¶ÅË∑ü‰∏ä„ÄÇ ‰∏öÂä°ÂÖÅËÆ∏ÁöÑÊÉÖÂÜµ‰∏ãËÄÉËôëÁî®Êà∑ÂàÜÂå∫ÔºåÂ∞§ÂÖ∂ÊòØÊ∏∏Êàè„ÄÅÈÇÆÁÆ±‰∏öÂä°„ÄÇ ÊéßÂà∂Ë∑®Êú∫ÊàøÊ∂àÊÅØ‰ΩìÂ§ßÂ∞èÔºåË∂äÂ∞èË∂äÂ•Ω„ÄÇ ËÄÉËôë‰ΩøÁî®dockerÂÆπÂô®ËôöÊãüÂåñÊäÄÊúØÔºåÊèêÈ´òÂä®ÊÄÅË∞ÉÂ∫¶ËÉΩÂäõ„ÄÇ ÂÆπÁÅæÊäÄÊúØÂèäÂª∫ËÆæÁªèÈ™å‰ªãÁªç ÂÆπÁÅæÊºîÁªÉÊµÅÁ®ã „Ää‰æùËµñÊ≤ªÁêÜ„ÄÅÁÅ∞Â∫¶ÂèëÂ∏É„ÄÅÊïÖÈöúÊºîÁªÉÔºåÈòøÈáåÁîµÂïÜÊïÖÈöúÊºîÁªÉÁ≥ªÁªüÁöÑËÆæËÆ°‰∏éÂÆûÊàòÁªèÈ™å„Äã Â∏∏ËßÅÊïÖÈöúÁîªÂÉè Ê°à‰æãÔºöÈ¢ÑÊ°àÊúâÊïàÊÄß„ÄÅÈ¢ÑÊ°àÊúâÊïàÊÄß„ÄÅÊïÖÈöúÂ§çÁé∞„ÄÅÊû∂ÊûÑÂÆπÁÅæÊµãËØï„ÄÅÂèÇÊï∞Ë∞É‰ºò„ÄÅÂèÇÊï∞Ë∞É‰ºò„ÄÅÊïÖÈöúÁ™ÅË¢≠„ÄÅËÅîÂêàÊºîÁªÉ„ÄÇ Âπ≥ÊªëÂêØÂä® Âπ≥ÊªëÈáçÂêØÂ∫îÁî®ÊÄùË∑Ø1.Á´ØÊµÅÈáèÔºàÂ¶ÇvipÂ±ÇÔºâ„ÄÅ2. flush Êï∞ÊçÆ(Â¶ÇÊûúÊúâ)„ÄÅ3, ÈáçÂêØÂ∫îÁî® „ÄäJVMÂÆâÂÖ®ÈÄÄÂá∫ÔºàÂ¶Ç‰Ωï‰ºòÈõÖÁöÑÂÖ≥Èó≠javaÊúçÂä°Ôºâ„ÄãÊé®ËçêÊé®Âá∫ÊñπÂºèÔºöSystem.exitÔºåKill SIGTERMÔºõ‰∏çÊé®Ëçê kill-9ÔºõÁî® Runtime.addShutdownHook Ê≥®ÂÜåÈí©Â≠ê„ÄÇ „ÄäÂ∏∏ËßÅJavaÂ∫îÁî®Â¶Ç‰Ωï‰ºòÈõÖÂÖ≥Èó≠„ÄãJava„ÄÅSrping„ÄÅDubbo ‰ºòÈõÖÂÖ≥Èó≠ÊñπÂºè„ÄÇ Êï∞ÊçÆÂ∫ìÊâ©Â±ïËØªÂÜôÂàÜÁ¶ªÊ®°Âºè „ÄäMysql‰∏ª‰ªéÊñπÊ°àÁöÑÂÆûÁé∞„Äã „ÄäÊê≠Âª∫MySQL‰∏ª‰ªéÂ§çÂà∂ÁªèÂÖ∏Êû∂ÊûÑ„Äã „ÄäHaproxy+Â§öÂè∞MySQL‰ªéÊúçÂä°Âô®(Slave) ÂÆûÁé∞Ë¥üËΩΩÂùáË°°„Äã „ÄäDRBD+Heartbeat+MysqlÈ´òÂèØÁî®ËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑ„Äã DRDB ËøõË°åÁ£ÅÁõòÂ§çÂà∂ÔºåÈÅøÂÖçÂçïÁÇπÈóÆÈ¢ò„ÄÇ „ÄäMySQL Cluster ÊñπÂºè„Äã ÂàÜÁâáÊ®°Âºè „ÄäÂàÜÂ∫ìÂàÜË°®ÈúÄË¶ÅËÄÉËôëÁöÑÈóÆÈ¢òÂèäÊñπÊ°à„Äã ‰∏≠Èó¥‰ª∂Ôºö ËΩªÈáèÁ∫ßÔºösharding-jdbc„ÄÅTShardingÔºõÈáçÈáèÁ∫ßÔºöAtlas„ÄÅMyCAT„ÄÅVitessÁ≠â„ÄÇ ÈóÆÈ¢òÔºö‰∫ãÂä°„ÄÅJoin„ÄÅËøÅÁßª„ÄÅÊâ©ÂÆπ„ÄÅID„ÄÅÂàÜÈ°µÁ≠â„ÄÇ ‰∫ãÂä°Ë°•ÂÅøÔºöÂØπÊï∞ÊçÆËøõË°åÂØπÂ∏êÊ£ÄÊü•;Âü∫‰∫éÊó•ÂøóËøõË°åÊØîÂØπ;ÂÆöÊúüÂêåÊ†áÂáÜÊï∞ÊçÆÊù•Ê∫êËøõË°åÂêåÊ≠•Á≠â„ÄÇ ÂàÜÂ∫ìÁ≠ñÁï•ÔºöÊï∞ÂÄºËåÉÂõ¥ÔºõÂèñÊ®°ÔºõÊó•ÊúüÁ≠â„ÄÇ ÂàÜÂ∫ìÊï∞ÈáèÔºöÈÄöÂ∏∏ MySQL ÂçïÂ∫ì 5ÂçÉ‰∏áÊù°„ÄÅOracle ÂçïÂ∫ì‰∏Ä‰∫øÊù°ÈúÄË¶ÅÂàÜÂ∫ì„ÄÇ „ÄäMySqlÂàÜË°®ÂíåË°®ÂàÜÂå∫ËØ¶Ëß£„Äã ÂàÜÂå∫ÔºöÊòØMySQLÂÜÖÈÉ®Êú∫Âà∂ÔºåÂØπÂÆ¢Êà∑Á´ØÈÄèÊòéÔºåÊï∞ÊçÆÂ≠òÂÇ®Âú®‰∏çÂêåÊñá‰ª∂‰∏≠ÔºåË°®Èù¢‰∏äÁúãÊòØÂêå‰∏Ä‰∏™Ë°®„ÄÇ ÂàÜË°®ÔºöÁâ©ÁêÜ‰∏äÂàõÂª∫‰∏çÂêåÁöÑË°®„ÄÅÂÆ¢Êà∑Á´ØÈúÄË¶ÅÁÆ°ÁêÜÂàÜË°®Ë∑ØÁî±„ÄÇ ÊúçÂä°Ê≤ªÁêÜÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞ „ÄäÊ∞∏‰∏çÂ§±ËÅîÔºÅÂ¶Ç‰ΩïÂÆûÁé∞ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÁöÑÊúçÂä°ÂèëÁé∞Ôºü„Äã ÂÆ¢Êà∑Á´ØÊúçÂä°ÂèëÁé∞Ê®°ÂºèÔºöÂÆ¢Êà∑Á´ØÁõ¥Êé•Êü•ËØ¢Ê≥®ÂÜåË°®ÔºåÂêåÊó∂Ëá™Â∑±Ë¥üË¥£Ë¥üËΩΩÂùáË°°„ÄÇEureka ÈááÁî®ËøôÁßçÊñπÂºè„ÄÇ ÊúçÂä°Âô®Á´ØÊúçÂä°ÂèëÁé∞Ê®°ÂºèÔºöÂÆ¢Êà∑Á´ØÈÄöËøáË¥üËΩΩÂùáË°°Êü•ËØ¢ÊúçÂä°ÂÆû‰æã„ÄÇ „ÄäSpringCloudÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÊØîËæÉ:Consul vs Zookeeper vs Etcd vs Eureka„Äã CAPÊîØÊåÅÔºöConsulÔºàCAÔºâ„ÄÅzookeeperÔºàcpÔºâ„ÄÅetcdÔºàcpÔºâ „ÄÅeuerkaÔºàapÔºâ ‰ΩúËÄÖËÆ§‰∏∫ÁõÆÂâç Consul ÂØπ Spring cloud ÁöÑÊîØÊåÅÊØîËæÉÂ•Ω„ÄÇ „ÄäÂü∫‰∫éZookeeperÁöÑÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞„Äã ‰ºòÁÇπÔºöAPIÁÆÄÂçï„ÄÅPinterestÔºåAirbnb Âú®Áî®„ÄÅÂ§öËØ≠Ë®Ä„ÄÅÈÄöËøáwatcherÊú∫Âà∂Êù•ÂÆûÁé∞ÈÖçÁΩÆPUSHÔºåËÉΩÂø´ÈÄüÂìçÂ∫îÈÖçÁΩÆÂèòÂåñ„ÄÇ ÊúçÂä°Ë∑ØÁî±ÊéßÂà∂ „ÄäÂàÜÂ∏ÉÂºèÊúçÂä°Ê°ÜÊû∂Â≠¶‰π†Á¨îËÆ∞4 ÊúçÂä°Ë∑ØÁî±„Äã ÂéüÂàôÔºöÈÄèÊòéÂåñË∑ØÁî± Ë¥üËΩΩÂùáË°°Á≠ñÁï•ÔºöÈöèÊú∫„ÄÅËΩÆËØ¢„ÄÅÊúçÂä°Ë∞ÉÁî®Âª∂Ëøü„ÄÅ‰∏ÄËá¥ÊÄßÂìàÂ∏å„ÄÅÁ≤òÊªûËøûÊé• Êú¨Âú∞Ë∑ØÁî±ÊúâÈôêÁ≠ñÁï•Ôºöinjvm(‰ºòÂÖàË∞ÉÁî®jvmÂÜÖÈÉ®ÁöÑÊúçÂä°)Ôºåinnative(‰ºòÂÖà‰ΩøÁî®Áõ∏ÂêåÁâ©ÁêÜÊú∫ÁöÑÊúçÂä°),ÂéüÂàô‰∏äÊâæË∑ùÁ¶ªÊúÄËøëÁöÑÊúçÂä°„ÄÇ ÈÖçÁΩÆÊñπÂºèÔºöÁªü‰∏ÄÊ≥®ÂÜåË°®ÔºõÊú¨Âú∞ÈÖçÁΩÆÔºõÂä®ÊÄÅ‰∏ãÂèë„ÄÇ ÂàÜÂ∏ÉÂºè‰∏ÄËá¥CAP ‰∏é BASE ÁêÜËÆ∫ „Ää‰ªéÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßË∞àÂà∞CAPÁêÜËÆ∫„ÄÅBASEÁêÜËÆ∫„Äã ‰∏ÄËá¥ÊÄßÂàÜÁ±ªÔºöÂº∫‰∏ÄËá¥(Á´ãÂç≥‰∏ÄËá¥)ÔºõÂº±‰∏ÄËá¥(ÂèØÂú®Âçï‰ΩçÊó∂Èó¥ÂÜÖÂÆûÁé∞‰∏ÄËá¥ÔºåÊØîÂ¶ÇÁßíÁ∫ß)ÔºõÊúÄÁªà‰∏ÄËá¥(Âº±‰∏ÄËá¥ÁöÑ‰∏ÄÁßçÔºå‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÊúÄÁªà‰∏ÄËá¥) CAPÔºö‰∏ÄËá¥ÊÄß„ÄÅÂèØÁî®ÊÄß„ÄÅÂàÜÂå∫ÂÆπÈîôÊÄß(ÁΩëÁªúÊïÖÈöúÂºïËµ∑) BASEÔºöBasically AvailableÔºàÂü∫Êú¨ÂèØÁî®Ôºâ„ÄÅSoft stateÔºàËΩØÁä∂ÊÄÅÔºâÂíåEventually consistentÔºàÊúÄÁªà‰∏ÄËá¥ÊÄßÔºâ BASEÁêÜËÆ∫ÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÔºöÂç≥‰ΩøÊó†Ê≥ïÂÅöÂà∞Âº∫‰∏ÄËá¥ÊÄßÔºå‰ΩÜÊØè‰∏™Â∫îÁî®ÈÉΩÂèØ‰ª•Ê†πÊçÆËá™Ë∫´‰∏öÂä°ÁâπÁÇπÔºåÈááÁî®ÈÄÇÂΩìÁöÑÊñπÂºèÊù•‰ΩøÁ≥ªÁªüËææÂà∞ÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇ ÂàÜÂ∏ÉÂºèÈîÅ „ÄäÂàÜÂ∏ÉÂºèÈîÅÁöÑÂá†ÁßçÂÆûÁé∞ÊñπÂºè„Äã Âü∫‰∫éÊï∞ÊçÆÂ∫ìÁöÑÂàÜÂ∏ÉÂºèÈîÅÔºö‰ºòÁÇπÔºöÊìç‰ΩúÁÆÄÂçï„ÄÅÂÆπÊòìÁêÜËß£„ÄÇÁº∫ÁÇπÔºöÂ≠òÂú®ÂçïÁÇπÈóÆÈ¢ò„ÄÅÊï∞ÊçÆÂ∫ìÊÄßËÉΩÂ§üÂºÄÈîÄËæÉÂ§ß„ÄÅ‰∏çÂèØÈáçÂÖ•Ôºõ Âü∫‰∫éÁºìÂ≠òÁöÑÂàÜÂ∏ÉÂºèÈîÅÔºö‰ºòÁÇπÔºöÈùûÈòªÂ°û„ÄÅÊÄßËÉΩÂ•Ω„ÄÇÁº∫ÁÇπÔºöÊìç‰Ωú‰∏çÂ•ΩÂÆπÊòìÈÄ†ÊàêÈîÅÊó†Ê≥ïÈáäÊîæÁöÑÊÉÖÂÜµ„ÄÇ Zookeeper ÂàÜÂ∏ÉÂºèÈîÅÔºöÈÄöËøáÊúâÂ∫è‰∏¥Êó∂ËäÇÁÇπÂÆûÁé∞ÈîÅÊú∫Âà∂ÔºåËá™Â∑±ÂØπÂ∫îÁöÑËäÇÁÇπÈúÄË¶ÅÊúÄÂ∞èÔºåÂàôË¢´ËÆ§‰∏∫ÊòØËé∑Âæó‰∫ÜÈîÅ„ÄÇ‰ºòÁÇπÔºöÈõÜÁæ§ÂèØ‰ª•ÈÄèÊòéËß£ÂÜ≥ÂçïÁÇπÈóÆÈ¢òÔºåÈÅøÂÖçÈîÅ‰∏çË¢´ÈáäÊîæÈóÆÈ¢òÔºåÂêåÊó∂ÈîÅÂèØ‰ª•ÈáçÂÖ•„ÄÇÁº∫ÁÇπÔºöÊÄßËÉΩ‰∏çÂ¶ÇÁºìÂ≠òÊñπÂºèÔºåÂêûÂêêÈáè‰ºöÈöèÁùÄzkÈõÜÁæ§ËßÑÊ®°ÂèòÂ§ßËÄå‰∏ãÈôç„ÄÇ „ÄäÂü∫‰∫éZookeeperÁöÑÂàÜÂ∏ÉÂºèÈîÅ„Äã Ê∏ÖÊ•öÁöÑÂéüÁêÜÊèèËø∞ + Java ‰ª£Á†ÅÁ§∫‰æã„ÄÇ „ÄäjedisLock‚ÄîredisÂàÜÂ∏ÉÂºèÈîÅÂÆûÁé∞„Äã Âü∫‰∫é setnx(set if ont exists)ÔºåÊúâÂàôËøîÂõûfalseÔºåÂê¶ÂàôËøîÂõûtrue„ÄÇÂπ∂ÊîØÊåÅËøáÊúüÊó∂Èó¥„ÄÇ „ÄäMemcached Âíå Redis ÂàÜÂ∏ÉÂºèÈîÅÊñπÊ°à„Äã Âà©Áî® memcached ÁöÑ addÔºàÊúâÂà´‰∫ésetÔºâÊìç‰ΩúÔºåÂΩìkeyÂ≠òÂú®Êó∂ÔºåËøîÂõûfalse„ÄÇ ÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ïPAXOS „ÄäÂàÜÂ∏ÉÂºèÁ≥ªÂàóÊñáÁ´†‚Äî‚ÄîPaxosÁÆóÊ≥ïÂéüÁêÜ‰∏éÊé®ÂØº„Äã „ÄäPaxos‚Äì&gt;Fast Paxos‚Äì&gt;ZookeeperÂàÜÊûê„Äã „Ää„ÄêÂàÜÂ∏ÉÂºè„ÄëZookeeper‰∏éPaxos„Äã Zab „ÄäZabÔºöZookeeper ‰∏≠ÁöÑÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÂçèËÆÆ‰ªãÁªç„Äã Raft „ÄäRaft ‰∏∫‰ªÄ‰πàÊòØÊõ¥ÊòìÁêÜËß£ÁöÑÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ï„Äã ‰∏âÁßçËßíËâ≤ÔºöLeaderÔºàÈ¢ÜË¢ñÔºâ„ÄÅFollowerÔºàÁæ§‰ºóÔºâ„ÄÅCandidateÔºàÂÄôÈÄâ‰∫∫Ôºâ ÈÄöËøáÈöèÊú∫Á≠âÂæÖÁöÑÊñπÂºèÂèëÂá∫ÊäïÁ•®ÔºåÂæóÁ•®Â§öÁöÑËé∑ËÉú„ÄÇ Gossip „ÄäGossipÁÆóÊ≥ï„Äã ‰∏§Èò∂ÊÆµÊèê‰∫§„ÄÅÂ§öÈò∂ÊÆµÊèê‰∫§ „ÄäÂÖ≥‰∫éÂàÜÂ∏ÉÂºè‰∫ãÂä°„ÄÅ‰∏§Èò∂ÊÆµÊèê‰∫§ÂçèËÆÆ„ÄÅ‰∏âÈò∂Êèê‰∫§ÂçèËÆÆ„Äã ÂπÇÁ≠â „ÄäÂàÜÂ∏ÉÂºèÁ≥ªÁªü‚ÄîÂπÇÁ≠âÊÄßËÆæËÆ°„Äã ÂπÇÁ≠âÁâπÊÄßÁöÑ‰ΩúÁî®ÔºöËØ•ËµÑÊ∫êÂÖ∑Â§áÂπÇÁ≠âÊÄßÔºåËØ∑Ê±ÇÊñπÊó†ÈúÄÊãÖÂøÉÈáçÂ§çË∞ÉÁî®‰ºö‰∫ßÁîüÈîôËØØ„ÄÇ Â∏∏ËßÅ‰øùËØÅÂπÇÁ≠âÁöÑÊâãÊÆµÔºöMVCCÔºàÁ±ª‰ºº‰∫é‰πêËßÇÈîÅÔºâ„ÄÅÂéªÈáçË°®(ÂîØ‰∏ÄÁ¥¢Âºï)„ÄÅÊÇ≤ËßÇÈîÅ„ÄÅ‰∏ÄÊ¨°ÊÄßtoken„ÄÅÂ∫èÂàóÂè∑ÊñπÂºè„ÄÇ ÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊñπÊ°à „ÄäÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∫ãÂä°‰∏ÄËá¥ÊÄßËß£ÂÜ≥ÊñπÊ°à„Äã „Ää‰øùËØÅÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÁöÑ6ÁßçÊñπÊ°à„Äã ÂàÜÂ∏ÉÂºè Leader ËäÇÁÇπÈÄâ‰∏æ „ÄäÂà©Áî®zookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèleaderËäÇÁÇπÈÄâ‰∏æ„Äã TCC(Try/Confirm/Cancel) ÊüîÊÄß‰∫ãÂä° „Ää‰º†Áªü‰∫ãÂä°‰∏éÊüîÊÄß‰∫ãÂä°„Äã Âü∫‰∫éBASEÁêÜËÆ∫ÔºöÂü∫Êú¨ÂèØÁî®„ÄÅÊüîÊÄßÁä∂ÊÄÅ„ÄÅÊúÄÁªà‰∏ÄËá¥„ÄÇ Ëß£ÂÜ≥ÊñπÊ°àÔºöËÆ∞ÂΩïÊó•Âøó+Ë°•ÂÅøÔºàÊ≠£ÂêëË°•ÂÖÖÊàñËÄÖÂõûÊªöÔºâ„ÄÅÊ∂àÊÅØÈáçËØï(Ë¶ÅÊ±ÇÁ®ãÂ∫èË¶ÅÂπÇÁ≠â)Ôºõ‚ÄúÊó†ÈîÅËÆæËÆ°‚Äù„ÄÅÈááÁî®‰πêËßÇÈîÅÊú∫Âà∂„ÄÇ ÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªü ËØ¥ËØ¥ÂàÜÂ∏ÉÂºèÊñá‰ª∂Â≠òÂÇ®Á≥ªÁªü-Âü∫Êú¨Êû∂ÊûÑ Ôºü „ÄäÂêÑÁßçÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªüÁöÑÊØîËæÉ„Äã Ôºü HDFSÔºöÂ§ßÊâπÈáèÊï∞ÊçÆËØªÂÜôÔºåÁî®‰∫éÈ´òÂêûÂêêÈáèÁöÑÂú∫ÊôØÔºå‰∏çÈÄÇÂêàÂ∞èÊñá‰ª∂„ÄÇ FastDFSÔºöËΩªÈáèÁ∫ß„ÄÅÈÄÇÂêàÂ∞èÊñá‰ª∂„ÄÇ ÂîØ‰∏ÄID ÁîüÊàêÂÖ®Â±ÄÂîØ‰∏ÄID „ÄäÈ´òÂπ∂ÂèëÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁîüÊàêÂÖ®Â±ÄÂîØ‰∏ÄIdÊ±áÊÄª„Äã Twitter ÊñπÊ°àÔºàSnowflake ÁÆóÊ≥ïÔºâÔºö41‰ΩçÊó∂Èó¥Êà≥+10‰ΩçÊú∫Âô®Ê†áËØÜÔºàÊØîÂ¶ÇIPÔºåÊúçÂä°Âô®ÂêçÁß∞Á≠âÔºâ+12‰ΩçÂ∫èÂàóÂè∑(Êú¨Âú∞ËÆ°Êï∞Âô®) Flicker ÊñπÊ°àÔºöMySQLËá™Â¢ûID + ‚ÄúREPLACE INTO XXX:SELECT LAST_INSERT_ID();‚Äù UUIDÔºöÁº∫ÁÇπÔºåÊó†Â∫èÔºåÂ≠óÁ¨¶‰∏≤ËøáÈïøÔºåÂç†Áî®Á©∫Èó¥ÔºåÂΩ±ÂìçÊ£ÄÁ¥¢ÊÄßËÉΩ„ÄÇ MongoDB ÊñπÊ°àÔºöÂà©Áî® ObjectId„ÄÇÁº∫ÁÇπÔºö‰∏çËÉΩËá™Â¢û„ÄÇ „ÄäTDDL Âú®ÂàÜÂ∏ÉÂºè‰∏ãÁöÑSEQUENCEÂéüÁêÜ„Äã Âú®Êï∞ÊçÆÂ∫ì‰∏≠ÂàõÂª∫ sequence Ë°®ÔºåÁî®‰∫éËÆ∞ÂΩïÔºåÂΩìÂâçÂ∑≤Ë¢´Âç†Áî®ÁöÑidÊúÄÂ§ßÂÄº„ÄÇ ÊØèÂè∞ÂÆ¢Êà∑Á´Ø‰∏ªÊú∫Âèñ‰∏Ä‰∏™idÂå∫Èó¥ÔºàÊØîÂ¶Ç 1000~2000ÔºâÁºìÂ≠òÂú®Êú¨Âú∞ÔºåÂπ∂Êõ¥Êñ∞ sequence Ë°®‰∏≠ÁöÑidÊúÄÂ§ßÂÄºËÆ∞ÂΩï„ÄÇ ÂÆ¢Êà∑Á´Ø‰∏ªÊú∫‰πãÈó¥Âèñ‰∏çÂêåÁöÑidÂå∫Èó¥ÔºåÁî®ÂÆåÂÜçÂèñÔºå‰ΩøÁî®‰πêËßÇÈîÅÊú∫Âà∂ÊéßÂà∂Âπ∂Âèë„ÄÇ ‰∏ÄËá¥ÊÄßHashÁÆóÊ≥ï „Ää‰∏ÄËá¥ÊÄßÂìàÂ∏åÁÆóÊ≥ï„Äã ËÆæËÆ°ÊÄùÊÉ≥ &amp; ÂºÄÂèëÊ®°ÂºèDDD(Domain-driven Design - È¢ÜÂüüÈ©±Âä®ËÆæËÆ°) „ÄäÊµÖË∞àÊàëÂØπDDDÈ¢ÜÂüüÈ©±Âä®ËÆæËÆ°ÁöÑÁêÜËß£„Äã Ê¶ÇÂøµÔºöDDD ‰∏ªË¶ÅÂØπ‰º†ÁªüËΩØ‰ª∂ÂºÄÂèëÊµÅÁ®ã(ÂàÜÊûê-ËÆæËÆ°-ÁºñÁ†Å)‰∏≠ÂêÑÈò∂ÊÆµÁöÑÂâ≤Ë£ÇÈóÆÈ¢òËÄåÊèêÂá∫ÔºåÈÅøÂÖçÁî±‰∫é‰∏ÄÂºÄÂßãÂàÜÊûê‰∏çÊòéÊàñÂú®ËΩØ‰ª∂ÂºÄÂèëËøáÁ®ã‰∏≠ÁöÑ‰ø°ÊÅØÊµÅËΩ¨‰∏ç‰∏ÄËá¥ËÄåÈÄ†ÊàêËΩØ‰ª∂Êó†Ê≥ï‰∫§‰ªòÔºàÂíåÈúÄÊ±ÇÊñπËÆæÊÉ≥‰∏ç‰∏ÄËá¥ÔºâÁöÑÈóÆÈ¢ò„ÄÇDDD Âº∫Ë∞É‰∏ÄÂàá‰ª•È¢ÜÂüüÔºàDomainÔºâ‰∏∫‰∏≠ÂøÉÔºåÂº∫Ë∞ÉÈ¢ÜÂüü‰∏ìÂÆ∂ÔºàDomain ExpertÔºâÁöÑ‰ΩúÁî®ÔºåÂº∫Ë∞ÉÂÖàÂÆö‰πâÂ•ΩÈ¢ÜÂüüÊ®°Âûã‰πãÂêéÂú®ËøõË°åÂºÄÂèëÔºåÂπ∂‰∏îÈ¢ÜÂüüÊ®°ÂûãÂèØ‰ª•ÊåáÂØºÂºÄÂèëÔºàÊâÄË∞ìÁöÑÈ©±Âä®Ôºâ„ÄÇ ËøáÁ®ãÔºöÁêÜËß£È¢ÜÂüü„ÄÅÊãÜÂàÜÈ¢ÜÂüü„ÄÅÁªÜÂåñÈ¢ÜÂüüÔºåÊ®°ÂûãÁöÑÂáÜÁ°ÆÊÄßÂèñÂÜ≥‰∫éÊ®°ÂûãÁöÑÁêÜËß£Ê∑±Â∫¶„ÄÇ ËÆæËÆ°ÔºöDDD ‰∏≠ÊèêÂá∫‰∫ÜÂª∫Ê®°Â∑•ÂÖ∑ÔºåÊØîÂ¶ÇËÅöÂêà„ÄÅÂÆû‰Ωì„ÄÅÂÄºÂØπË±°„ÄÅÂ∑•ÂéÇ„ÄÅ‰ªìÂÇ®„ÄÅÈ¢ÜÂüüÊúçÂä°„ÄÅÈ¢ÜÂüü‰∫ã‰ª∂Êù•Â∏ÆÂä©È¢ÜÂüüÂª∫Ê®°„ÄÇ „ÄäÈ¢ÜÂüüÈ©±Âä®ËÆæËÆ°ÁöÑÂü∫Á°ÄÁü•ËØÜÊÄªÁªì„Äã È¢ÜÂüüÔºàDoaminÔºâÊú¨Ë¥®‰∏äÂ∞±ÊòØÈóÆÈ¢òÂüüÔºåÊØîÂ¶Ç‰∏Ä‰∏™ÁîµÂïÜÁ≥ªÁªüÔºå‰∏Ä‰∏™ËÆ∫ÂùõÁ≥ªÁªüÁ≠â„ÄÇ ÁïåÈôê‰∏ä‰∏ãÊñáÔºàBounded ContextÔºâÔºöÈòêËø∞Â≠êÂüü‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºåÂèØ‰ª•ÁÆÄÂçïÁêÜËß£Êàê‰∏Ä‰∏™Â≠êÁ≥ªÁªüÊàñÁªÑ‰ª∂Ê®°Âùó„ÄÇ È¢ÜÂüüÊ®°ÂûãÔºàDomain ModelÔºâÔºöDDDÁöÑÊ†∏ÂøÉÊòØÂª∫Á´ãÔºàÁî®ÈÄöÁî®ÊèèËø∞ËØ≠Ë®Ä„ÄÅÂ∑•ÂÖ∑‚ÄîÈ¢ÜÂüüÈÄöÁî®ËØ≠Ë®ÄÔºâÊ≠£Á°ÆÁöÑÈ¢ÜÂüüÊ®°ÂûãÔºõÂèçÂ∫î‰∏öÂä°ÈúÄÊ±ÇÁöÑÊú¨Ë¥®ÔºåÂåÖÊã¨ÂÆû‰ΩìÂíåËøáÁ®ãÔºõÂÖ∂Ë¥ØÁ©øËΩØ‰ª∂ÂàÜÊûê„ÄÅËÆæËÆ°„ÄÅÂºÄÂèë ÁöÑÊï¥‰∏™ËøáÁ®ãÔºõÂ∏∏Áî®Ë°®ËææÈ¢ÜÂüüÊ®°ÂûãÁöÑÊñπÂºèÔºöÂõæ„ÄÅ‰ª£Á†ÅÊàñÊñáÂ≠óÔºõ È¢ÜÂüüÈÄöÁî®ËØ≠Ë®ÄÔºöÈ¢ÜÂüü‰∏ìÂÆ∂„ÄÅÂºÄÂèëËÆæËÆ°‰∫∫ÂëòÈÉΩËÉΩÁ´ãÂç≥ÁöÑËØ≠Ë®ÄÊàñÂ∑•ÂÖ∑„ÄÇ ÁªèÂÖ∏ÂàÜÂ±ÇÊû∂ÊûÑÔºöÁî®Êà∑ÁïåÈù¢/Â±ïÁ§∫Â±Ç„ÄÅÂ∫îÁî®Â±Ç„ÄÅÈ¢ÜÂüüÂ±Ç„ÄÅÂü∫Á°ÄËÆæÊñΩÂ±ÇÔºåÊòØÂõõÂ±ÇÊû∂ÊûÑÊ®°Âºè„ÄÇ ‰ΩøÁî®ÁöÑÊ®°ÂºèÔºö ÂÖ≥ËÅîÂ∞ΩÈáèÂ∞ëÔºåÂ∞ΩÈáèÂçïÈ°πÔºåÂ∞ΩÈáèÈôç‰ΩéÊï¥‰ΩìÂ§çÊùÇÂ∫¶„ÄÇ ÂÆû‰ΩìÔºàEntityÔºâÔºöÈ¢ÜÂüü‰∏≠ÁöÑÂîØ‰∏ÄÊ†áÁ§∫Ôºå‰∏Ä‰∏™ÂÆû‰ΩìÁöÑÂ±ûÊÄßÂ∞ΩÈáèÂ∞ëÔºåÂ∞ëÂàôÊ∏ÖÊô∞„ÄÇ ÂÄºÂØπË±°ÔºàValue ObjectÔºâÔºöÊ≤°ÊúâÂîØ‰∏ÄÊ†áËØÜÔºå‰∏îÂ±ûÊÄßÂÄº‰∏çÂèØÂèòÔºåÂ∞è‰∫åÁÆÄÂçïÁöÑÂØπË±°ÔºåÊØîÂ¶ÇDate„ÄÇ È¢ÜÂüüÊúçÂä°ÔºàDomain ServiceÔºâÔºö ÂçèË∞ÉÂ§ö‰∏™È¢ÜÂüüÂØπË±°ÔºåÂè™ÊúâÊñπÊ≥ïÊ≤°ÊúâÁä∂ÊÄÅ(‰∏çÂ≠òÊï∞ÊçÆ)ÔºõÂèØ‰ª•ÂàÜ‰∏∫Â∫îÁî®Â±ÇÊúçÂä°ÔºåÈ¢ÜÂüüÂ±ÇÊúçÂä°„ÄÅÂü∫Á°ÄÂ±ÇÊúçÂä°„ÄÇ ËÅöÂêàÂèäËÅöÂêàÊ†πÔºàAggregateÔºåAggregate RootÔºâÔºöËÅöÂêàÂÆö‰πâ‰∫Ü‰∏ÄÁªÑÂÖ∑ÊúâÂÜÖËÅöÂÖ≥Á≥ªÁöÑÁõ∏ÂÖ≥ÂØπË±°ÁöÑÈõÜÂêàÔºõËÅöÂêàÊ†πÊòØÂØπËÅöÂêàÂºïÁî®ÁöÑÂîØ‰∏ÄÂÖÉÁ¥†ÔºõÂΩì‰øÆÊîπ‰∏Ä‰∏™ËÅöÂêàÊó∂ÔºåÂøÖÈ°ªÂú®‰∫ãÂä°Á∫ßÂà´ÔºõÂ§ßÈÉ®ÂàÜÈ¢ÜÂüüÊ®°Âûã‰∏≠ÔºåÊúâ70%ÁöÑËÅöÂêàÈÄöÂ∏∏Âè™Êúâ‰∏Ä‰∏™ÂÆû‰ΩìÔºå30%Âè™Êúâ2~3‰∏™ÂÆû‰ΩìÔºõÂ¶ÇÊûú‰∏Ä‰∏™ËÅöÂêàÂè™Êúâ‰∏Ä‰∏™ÂÆû‰ΩìÔºåÈÇ£‰πàËøô‰∏™ÂÆû‰ΩìÂ∞±ÊòØËÅöÂêàÊ†πÔºõÂ¶ÇÊûúÊúâÂ§ö‰∏™ÂÆû‰ΩìÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•ÊÄùËÄÉËÅöÂêàÂÜÖÂì™‰∏™ÂØπË±°ÊúâÁã¨Á´ãÂ≠òÂú®ÁöÑÊÑè‰πâÂπ∂‰∏îÂèØ‰ª•ÂíåÂ§ñÈÉ®Áõ¥Êé•ËøõË°å‰∫§‰∫íÔºõ Â∑•ÂéÇÔºàFactoryÔºâÔºöÁ±ª‰ºº‰∫éËÆæËÆ°Ê®°Âºè‰∏≠ÁöÑÂ∑•ÂéÇÊ®°Âºè„ÄÇ ‰ªìÂÇ®ÔºàRepositoryÔºâÔºöÊåÅ‰πÖÂåñÂà∞DBÔºåÁÆ°ÁêÜÂØπË±°Ôºå‰∏îÂè™ÂØπËÅöÂêàËÆæËÆ°‰ªìÂÇ®„ÄÇ „ÄäÈ¢ÜÂüüÈ©±Âä®ËÆæËÆ°(DDD)ÂÆûÁé∞‰πãË∑Ø„Äã ËÅöÂêàÔºöÊØîÂ¶Ç‰∏ÄËæÜÊ±ΩËΩ¶ÔºàCarÔºâÂåÖÂê´‰∫ÜÂºïÊìéÔºàEngineÔºâ„ÄÅËΩ¶ËΩÆÔºàWheelÔºâÂíåÊ≤πÁÆ±ÔºàTankÔºâÁ≠âÁªÑ‰ª∂ÔºåÁº∫‰∏Ä‰∏çÂèØ„ÄÇ „ÄäÈ¢ÜÂüüÈ©±Âä®ËÆæËÆ°Á≥ªÂàóÔºà2ÔºâÊµÖÊûêVO„ÄÅDTO„ÄÅDO„ÄÅPOÁöÑÊ¶ÇÂøµ„ÄÅÂå∫Âà´ÂíåÁî®Â§Ñ„Äã ÂëΩ‰ª§Êü•ËØ¢ËÅåË¥£ÂàÜÁ¶ª(CQRS)CQRS ‚Äî Command Query Responsibility Seperation „ÄäÈ¢ÜÂüüÈ©±Âä®ËÆæËÆ°Á≥ªÂàó (ÂÖ≠)ÔºöCQRS„Äã Ê†∏ÂøÉÊÄùÊÉ≥ÔºöËØªÂÜôÂàÜÁ¶ªÔºàÊü•ËØ¢ÂíåÊõ¥Êñ∞Âú®‰∏çÂêåÁöÑÊñπÊ≥ï‰∏≠ÔºâÔºå‰∏çÂêåÁöÑÊµÅÁ®ãÂè™ÊòØ‰∏çÂêåÁöÑËÆæËÆ°ÊñπÂºèÔºåCQ‰ª£Á†ÅÂàÜÁ¶ªÔºåÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏≠‰ºöÊúâÊòéÊòæ‰ΩìÁé∞ÔºàÊúâÂÜó‰ΩôÊï∞ÊçÆÁöÑÊÉÖÂÜµ‰∏ãÔºâÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÈ´òÊÄßËÉΩ„ÄÇ „ÄäDDD CQRSÊû∂ÊûÑÂíå‰º†ÁªüÊû∂ÊûÑÁöÑ‰ºòÁº∫ÁÇπÊØîËæÉ„Äã ÊúÄÁªà‰∏ÄËá¥ÁöÑËÆæËÆ°ÁêÜÂøµÔºõ‰æùËµñ‰∫éÈ´òÂèØÁî®Ê∂àÊÅØ‰∏≠Èó¥‰ª∂„ÄÇ „ÄäCQRSÊû∂ÊûÑÁÆÄ‰ªã„Äã ‰∏Ä‰∏™ÂÆûÁé∞ CQRS ÁöÑÊäΩË±°Ê°à‰æã„ÄÇ „ÄäÊ∑±Â∫¶ÈïøÊñáÔºöÊàëÂØπCQRS/EventSourcingÊû∂ÊûÑÁöÑÊÄùËÄÉ„Äã CQRS Ê®°ÂºèÂàÜÊûê + 12306 Êä¢Á•®Ê°à‰æã Ë¥´Ë°ÄÔºåÂÖÖË°ÄÊ®°Âûã „ÄäË¥´Ë°ÄÔºåÂÖÖË°ÄÊ®°ÂûãÁöÑËß£Èáä‰ª•Âèä‰∏Ä‰∫õÁªèÈ™å„Äã Â§±Ë°ÄÊ®°ÂûãÔºöËÄÅÂ≠êÂíåÂÑøÂ≠êÂàÜÂà´ÂÆö‰πâÔºåÁõ∏‰∫í‰∏çÁü•ÈÅìÔºå‰∫åËÄÖÂÆû‰ΩìÂÆö‰πâ‰∏≠ÂÆåÂÖ®Ê≤°Êúâ‰∏öÂä°ÈÄªËæëÔºåÈÄöËøáÂ§ñÈÉ®ServiceËøõË°åÂÖ≥ËÅî„ÄÇ Ë¥´Ë°ÄÊ®°ÂûãÔºöËÄÅÂ≠êÁü•ÈÅìÂÑøÂ≠êÔºåÂÑøÂ≠ê‰πüÁü•ÈÅìËÄÅÂ≠êÔºõÈÉ®ÂàÜ‰∏öÂä°ÈÄªËæëÊîæÂà∞ÂÆû‰Ωì‰∏≠Ôºõ‰ºòÁÇπÔºöÂêÑÂ±ÇÂçïÈ°π‰æùËµñÔºåÁªìÊûÑÊ∏ÖÊ•öÔºåÊòì‰∫éÁª¥Êä§ÔºõÁº∫ÁÇπÔºö‰∏çÁ¨¶ÂêàOOÊÄùÊÉ≥ÔºåÁõ∏ÊØî‰∫éÂÖÖË°ÄÊ®°ÂºèÔºåServiceÂ±ÇËæÉ‰∏∫ÂéöÈáçÔºõ ÂÖÖË°ÄÊ®°ÂûãÔºöÂíåË¥´Ë°ÄÊ®°ÂûãÁ±ª‰ººÔºåÂå∫Âà´Âú®‰∫éÂ¶Ç‰ΩïÂàíÂàÜ‰∏öÂä°ÈÄªËæë„ÄÇ‰ºòÁÇπÔºöServiceÂ±ÇÊØîËæÉËñÑÔºåÂè™ÂÖÖÂΩìFacadeÁöÑËßíËâ≤Ôºå‰∏çÂíåDAOÊâì‰∫§ÈÅì„ÄÅÂ§çÂêàOOÊÄùÊÉ≥ÔºõÁº∫ÁÇπÔºöÈùûÂçïÈ°π‰æùËµñÔºåDOÂíåDAO‰πãÈó¥ÂèåÂêë‰æùËµñ„ÄÅÂíåServiceÂ±ÇÁöÑÈÄªËæëÂàíÂàÜÂÆπÊòìÈÄ†ÊàêÊ∑∑‰π±„ÄÇ ËÇøËÉÄÊ®°ÂºèÔºöÊòØ‰∏ÄÁßçÊûÅÁ´ØÊÉÖÂÜµÔºåÂèñÊ∂àServiceÂ±Ç„ÄÅÂÖ®ÈÉ®‰∏öÂä°ÈÄªËæëÊîæÂú®DO‰∏≠Ôºõ‰ºòÁÇπÔºöÁ¨¶ÂêàOOÊÄùÊÉ≥„ÄÅÁÆÄÂåñ‰∫ÜÂàÜÂ±ÇÔºõÁº∫ÁÇπÔºöÊö¥Èú≤‰ø°ÊÅØËøáÂ§ö„ÄÅÂæàÂ§öÈùûDOÈÄªËæë‰πü‰ºöÂº∫Ë°åÂπ∂ÂÖ•DO„ÄÇËøôÁßçÊ®°ÂºèÂ∫îËØ•ÈÅøÂÖç„ÄÇ ‰ΩúËÄÖ‰∏ªÂº†‰ΩøÁî®Ë¥´Ë°ÄÊ®°Âºè„ÄÇ Actor Ê®°ÂºèTODO ÂìçÂ∫îÂºèÁºñÁ®ãReactorTODO RxJavaTODO Vert.xTODO DODAF2.0 „ÄäDODAF2.0ÊñπÊ≥ïËÆ∫„Äã „ÄäDODAF2.0‰πãËÉΩÂäõËßÜËßíÂ¶Ç‰ΩïËêΩÂú∞„Äã ServerlessTODO Service MeshTODO „Ää‰ªÄ‰πàÊòØService MeshÔºü„Äã È°πÁõÆÁÆ°ÁêÜÊû∂ÊûÑËØÑÂÆ° „ÄäÊû∂ÊûÑËÆæËÆ°‰πãÂ¶Ç‰ΩïËØÑÂÆ°Êû∂ÊûÑËÆæËÆ°ËØ¥Êòé‰π¶„Äã „Ää‰∫∫‰∫∫ÈÉΩÊòØÊû∂ÊûÑÂ∏àÔºöÈùûÂäüËÉΩÊÄßÈúÄÊ±Ç„Äã ÈáçÊûÑ „ÄäÊû∂ÊûÑ‰πãÈáçÊûÑÁöÑ12Êù°ÂÜõËßÑ„Äã ‰ª£Á†ÅËßÑËåÉTODO ‰ª£Á†Å ReviewÂà∂Â∫¶ËøòÊòØÂà∂Â∫¶!Âè¶Â§ñÔºåÊØè‰∏™ÂÖ¨Âè∏ÈúÄË¶ÅÊ†πÊçÆËá™Â∑±ÁöÑÈúÄÊ±ÇÂíåÁõÆÊ†áÂà∂ÂÆöËá™Â∑±ÁöÑ check list „Ää‰∏∫‰ªÄ‰πà‰Ω†ÂÅö‰∏çÂ•Ω Code ReviewÔºü„Äã ‰ª£Á†Å review ÂÅöÁöÑÂ•ΩÔºåÂú®‰∫éÂà∂Â∫¶Âª∫ËÆæ„ÄÇ „Ää‰ªéÈõ∂ÂºÄÂßãCode Review„Äã „ÄäCode Review Checklist„Äã „ÄäJava Code Review Checklist„Äã „ÄäÂ¶Ç‰ΩïÁî® gitlab ÂÅö code review„Äã RUP „ÄäËøêÁî®RUP 4+1ËßÜÂõæÊñπÊ≥ïËøõË°åËΩØ‰ª∂Êû∂ÊûÑËÆæËÆ°„Äã ÁúãÊùøÁÆ°ÁêÜ „ÄäËØ¥ËØ¥ÁúãÊùøÂú®È°πÁõÆ‰∏≠ÁöÑÂ∫îÁî®„Äã SCRUMSCRUM - ‰∫âÁêÉ 3‰∏™ËßíËâ≤:Product Owner(PO) ‰∫ßÂìÅË¥üË¥£‰∫∫;Scrum MasterÔºàSMÔºâÔºåÊé®Âä®ScrumÊâßË°å;Team ÂºÄÂèëÂõ¢Èòü„ÄÇ 3‰∏™Â∑•‰ª∂ÔºöProduct Backlog ‰∫ßÂìÅTODOLISTÔºåÂê´‰ºòÂÖàÁ∫ß;Sprint Backlog ÂäüËÉΩÂºÄÂèë TODO LISTÔºõÁáÉÂ∞ΩÂõæÔºõ ‰∫î‰∏™‰ª∑ÂÄºËßÇÔºö‰∏ìÊ≥®„ÄÅÂãáÊ∞î„ÄÅÂÖ¨ÂºÄ„ÄÅÊâøËØ∫„ÄÅÂ∞äÈáç„ÄÇ „ÄäÊïèÊç∑È°πÁõÆÁÆ°ÁêÜÊµÅÁ®ã-ScrumÊ°ÜÊû∂ÊúÄÂÖ®ÊÄªÁªìÔºÅ„Äã „ÄäÊïèÊç∑ÂÖ∂ÂÆûÂæàÁÆÄÂçï3‚ÄîÊïèÊç∑ÊñπÊ≥ï‰πãscrum„Äã ÊïèÊç∑ÂºÄÂèëTODO ÊûÅÈôêÁºñÁ®ãÔºàXPÔºâXP - eXtreme Programming „Ää‰∏ªÊµÅÊïèÊç∑ÂºÄÂèëÊñπÊ≥ïÔºöÊûÅÈôêÁºñÁ®ãXP„Äã ÊòØ‰∏ÄÁßçÊåáÂØºÂºÄÂèë‰∫∫ÂëòÁöÑÊñπÊ≥ïËÆ∫„ÄÇ 4Â§ß‰ª∑ÂÄºÔºö Ê≤üÈÄöÔºöÈºìÂä±Âè£Â§¥Ê≤üÈÄöÔºåÊèêÈ´òÊïàÁéá„ÄÇ ÁÆÄÂçïÔºöÂ§üÁî®Â∞±Â•Ω„ÄÇ ÂèçÈ¶àÔºöÂèäÊó∂ÂèçÈ¶à„ÄÅÈÄöÁü•Áõ∏ÂÖ≥‰∫∫„ÄÇ ÂãáÊ∞îÔºöÊèêÂÄ°Êã•Êä±ÂèòÂåñÔºåÊï¢‰∫éÈáçÊûÑ„ÄÇ 5‰∏™ÂéüÂàôÔºöÂø´ÈÄüÂèçÈ¶à„ÄÅÁÆÄÂçïÊÄßÂÅáËÆæ„ÄÅÈÄêÊ≠•‰øÆÊîπ„ÄÅÊèêÂÄ°Êõ¥ÊîπÔºàÂ∞èÊ≠•Âø´Ë∑ëÔºâ„ÄÅ‰ºòË¥®Â∑•‰ΩúÔºà‰øùËØÅË¥®ÈáèÁöÑÂâçÊèê‰∏ã‰øùËØÅÂ∞èÊ≠•Âø´Ë∑ëÔºâ„ÄÇ 5‰∏™Â∑•‰ΩúÔºöÈò∂ÊÆµÊÄßÂÜ≤Âà∫ÔºõÂÜ≤Âà∫ËÆ°Âàí‰ºöËÆÆÔºõÊØèÊó•Á´ôÁ´ã‰ºöËÆÆÔºõÂÜ≤Âà∫ÂêéreviewÔºõÂõûÈ°æ‰ºöËÆÆ„ÄÇ ÁªìÂØπÁºñÁ®ãËæπÂÜôÁ†ÅÔºåËæπreview„ÄÇËÉΩÂ§üÂ¢ûÂº∫‰ª£Á†ÅË¥®Èáè„ÄÅÂáèÂ∞ëbug„ÄÇ „ÄäÁªìÂØπÁºñÁ®ã„Äã FMEAÁÆ°ÁêÜÊ®°ÂºèTODO ÈÄöÁî®‰∏öÂä°ÊúØËØ≠TODO ÊäÄÊúØË∂ãÂäøTODO ÊîøÁ≠ñ„ÄÅÊ≥ïËßÑTODO Ê≥ïÂæã‰∏•Ê†ºÈÅµÂÆàÂàëÊ≥ï253Ê≥ïÊù°ÊàëÂõΩÂàëÊ≥ïÁ¨¨253Êù°‰πã‰∏ÄËßÑÂÆöÔºö ÂõΩÂÆ∂Êú∫ÂÖ≥ÊàñËÄÖÈáëËûç„ÄÅÁîµ‰ø°„ÄÅ‰∫§ÈÄö„ÄÅÊïôËÇ≤„ÄÅÂåªÁñóÁ≠âÂçï‰ΩçÁöÑÂ∑•‰Ωú‰∫∫ÂëòÔºåËøùÂèçÂõΩÂÆ∂ËßÑÂÆöÔºåÂ∞ÜÊú¨Âçï‰ΩçÂú®Â±•Ë°åËÅåË¥£ÊàñËÄÖÊèê‰æõÊúçÂä°ËøáÁ®ã‰∏≠Ëé∑ÂæóÁöÑÂÖ¨Ê∞ë‰∏™‰∫∫‰ø°ÊÅØÔºåÂá∫ÂîÆÊàñËÄÖÈùûÊ≥ïÊèê‰æõÁªô‰ªñ‰∫∫ÔºåÊÉÖËäÇ‰∏•ÈáçÁöÑÔºåÂ§Ñ3Âπ¥‰ª•‰∏ãÊúâÊúüÂæíÂàëÊàñËÄÖÊãòÂΩπÔºåÂπ∂Â§ÑÊàñËÄÖÂçïÂ§ÑÁΩöÈáë„ÄÇ Á™ÉÂèñÊàñËÄÖ‰ª•ÂÖ∂‰ªñÊñπÊ≥ïÈùûÊ≥ïËé∑Âèñ‰∏äËø∞‰ø°ÊÅØÔºåÊÉÖËäÇ‰∏•ÈáçÁöÑÔºå‰æùÁÖßÂâçÊ¨æÁöÑËßÑÂÆöÂ§ÑÁΩö„ÄÇ Âçï‰ΩçÁäØÂâç‰∏§Ê¨æÁΩ™ÁöÑÔºåÂØπÂçï‰ΩçÂà§Â§ÑÁΩöÈáëÔºåÂπ∂ÂØπÂÖ∂Áõ¥Êé•Ë¥üË¥£ÁöÑ‰∏ªÁÆ°‰∫∫ÂëòÂíåÂÖ∂‰ªñÁõ¥Êé•Ë¥£‰ªª‰∫∫ÂëòÔºå‰æùÁÖßÂêÑËØ•Ê¨æÁöÑËßÑÂÆöÂ§ÑÁΩö„ÄÇ ÊúÄÈ´ò‰∫∫Ê∞ëÊ≥ïÈô¢„ÄÅÊúÄÈ´ò‰∫∫Ê∞ëÊ£ÄÂØüÈô¢ÂÖ≥‰∫éÊâßË°å„Ää‰∏≠Âçé‰∫∫Ê∞ëÂÖ±ÂíåÂõΩÂàëÊ≥ï„ÄãÁ°ÆÂÆöÁΩ™ÂêçÁöÑË°•ÂÖÖËßÑÂÆöÔºàÂõõÔºâËßÑÂÆöÔºöËß¶ÁäØÂàëÊ≥ïÁ¨¨253Êù°‰πã‰∏ÄÁ¨¨1Ê¨æ‰πãËßÑÂÆöÔºåÊûÑÊàê‚ÄúÂá∫ÂîÆ„ÄÅÈùûÊ≥ïÊèê‰æõÂÖ¨Ê∞ë‰∏™‰∫∫‰ø°ÊÅØÁΩ™‚ÄùÔºõËß¶ÁäØÂàëÊ≥ïÁ¨¨253Êù°‰πã‰∏ÄÁ¨¨2Ê¨æ‰πãËßÑÂÆöÔºåÊûÑÊàê‚ÄúÈùûÊ≥ïËé∑ÂèñÂÖ¨Ê∞ë‰∏™‰∫∫‰ø°ÊÅØÁΩ™‚Äù „ÄäÈùûÊ≥ïËé∑ÂèñÂÖ¨Ê∞ë‰∏™‰∫∫‰ø°ÊÅØÁΩ™„Äã Êû∂ÊûÑÂ∏àÁ¥†Ë¥® „ÄäÊû∂ÊûÑÂ∏àÁîªÂÉè„Äã ‰∏öÂä°ÁêÜËß£ÂíåÊäΩË±°ËÉΩÂäõ NBÁöÑ‰ª£Á†ÅËÉΩÂäõ ÂÖ®Èù¢Ôºö1. Âú®Èù¢ÂØπ‰∏öÂä°ÈóÆÈ¢ò‰∏äÔºåÊû∂ÊûÑÂ∏àËÑëÊµ∑ÈáåÊòØÂê¶‰ºöÊµÆÁé∞Âá∫Â§öÁßçÊäÄÊúØÊñπÊ°àÔºõ2. Âú®ÂÅöÁ≥ªÁªüËÆæËÆ°Êó∂ÊòØÂê¶ËÄÉËôëÂà∞‰∫ÜË∂≥Â§üÂ§öÁöÑÊñπÊñπÈù¢Èù¢Ôºõ3. Âú®ÂÅöÁ≥ªÁªüËÆæËÆ°Êó∂ÊòØÂê¶ËÄÉËôëÂà∞‰∫ÜË∂≥Â§üÂ§öÁöÑÊñπÊñπÈù¢Èù¢Ôºõ ÂÖ®Â±ÄÔºöÊòØÂê¶ËÄÉËôëÂà∞‰∫ÜÂØπ‰∏ä‰∏ãÊ∏∏ÁöÑÁ≥ªÁªüÁöÑÂΩ±Âìç„ÄÇ ÊùÉË°°ÔºöÊùÉË°°ÊäïÂÖ•‰∫ßÂá∫ÊØîÔºõ‰ºòÂÖàÁ∫ßÂíåËäÇÂ•èÊéßÂà∂Ôºõ „ÄäÂÖ≥‰∫éÊû∂ÊûÑ‰ºòÂåñÂíåËÆæËÆ°ÔºåÊû∂ÊûÑÂ∏àÂøÖÈ°ªÁü•ÈÅìÁöÑ‰∫ãÊÉÖ„Äã Ë¶ÅÂéªËÄÉËôëÁöÑÁªÜËäÇÔºöÊ®°ÂùóÂåñ„ÄÅËΩªËÄ¶Âêà„ÄÅÊó†ÂÖ±‰∫´Êû∂ÊûÑÔºõÂáèÂ∞ëÂêÑ‰∏™ÁªÑ‰ª∂‰πãÂâçÁöÑ‰æùÊáí„ÄÅÊ≥®ÊÑèÊúçÂä°‰πãÈó¥‰æùÊáíÊâÄÊúâÈÄ†ÊàêÁöÑÈìæÂºèÂ§±Ë¥•ÂèäÂΩ±ÂìçÁ≠â„ÄÇ Âü∫Á°ÄËÆæÊñΩ„ÄÅÈÖçÁΩÆ„ÄÅÊµãËØï„ÄÅÂºÄÂèë„ÄÅËøêÁª¥ÁªºÂêàËÄÉËôë„ÄÇ ËÄÉËôë‰∫∫„ÄÅÂõ¢Èòü„ÄÅÂíåÁªÑÁªáÁöÑÂΩ±Âìç„ÄÇ „ÄäÂ¶Ç‰ΩïÊâçËÉΩÁúüÊ≠£ÁöÑÊèêÈ´òËá™Â∑±ÔºåÊàê‰∏∫‰∏ÄÂêçÂá∫Ëâ≤ÁöÑÊû∂ÊûÑÂ∏àÔºü„Äã „ÄäÊû∂ÊûÑÂ∏àÁöÑÂøÖÂ§áÁ¥†Ë¥®ÂíåÊàêÈïøÈÄîÂæÑ„Äã Á¥†Ë¥®Ôºö‰∏öÂä°ÁêÜËß£„ÄÅÊäÄÊúØÂπøÂ∫¶„ÄÅÊäÄÊúØÊ∑±Â∫¶„ÄÅ‰∏∞ÂØåÁªèÈ™å„ÄÅÊ≤üÈÄöËÉΩÂäõ„ÄÅÂä®ÊâãËÉΩÂäõ„ÄÅÁæéÂ≠¶Á¥†ÂÖª„ÄÇ ÊàêÈïøË∑ØÂæÑÔºö2Âπ¥ÁßØÁ¥ØÁü•ËØÜ„ÄÅ4Âπ¥ÁßØÁ¥ØÊäÄËÉΩÂíåÁªÑÂÜÖÂΩ±ÂìçÂäõ„ÄÅ7Âπ¥ÁßØÁ¥ØÈÉ®Èó®ÂÜÖÂΩ±ÂìçÂäõ„ÄÅ7Âπ¥‰ª•‰∏äÁßØÁ¥ØË∑®ÈÉ®Èó®ÂΩ±ÂìçÂäõ„ÄÇ „ÄäÊû∂ÊûÑËÆæËÆ°Â∏à‚Äî‰Ω†Âú®Âì™Â±ÇÊ•ºÔºü„Äã Á¨¨‰∏ÄÂ±ÇÁöÑÊû∂ÊûÑÂ∏àÁúãÂà∞ÁöÑÂè™ÊòØ‰∫ßÂìÅÊú¨Ë∫´ Á¨¨‰∫åÂ±ÇÁöÑÊû∂ÊûÑÂ∏à‰∏ç‰ªÖÁúãÂà∞Ëá™Â∑±ÁöÑ‰∫ßÂìÅÔºåËøòÁúãÂà∞‰∫ÜÊï¥‰ΩìÁöÑÊñπÊ°à Á¨¨‰∏âÂ±ÇÁöÑÊû∂ÊûÑÂ∏àÁúãÂà∞ÁöÑÊòØÂïÜ‰∏ö‰ª∑ÂÄº Âõ¢ÈòüÁÆ°ÁêÜTODO ÊãõËÅòËµÑËÆØË°å‰∏öËµÑËÆØ 36kr Techweb ÂÖ¨‰ºóÂè∑ÂàóË°®TODO ÂçöÂÆ¢Âõ¢ÈòüÂçöÂÆ¢ ÈòøÈáå‰∏≠Èó¥‰ª∂ÂçöÂÆ¢ ÁæéÂõ¢ÁÇπËØÑÊäÄÊúØÂõ¢ÈòüÂçöÂÆ¢ ‰∏™‰∫∫ÂçöÂÆ¢ ÈòÆ‰∏ÄÂ≥∞ÁöÑÁΩëÁªúÊó•Âøó ÈÖ∑Â£≥ - COOLSHELL-ÈôàÁöì hellojava-ÈòøÈáåÊØïÁéÑ Cm‚Äôs Blog Á®ãÂ∫èÁåøDD-ÁøüÊ∞∏Ë∂Ö-„ÄäSpring CloudÂæÆÊúçÂä°ÂÆûÊàò„Äã‰ΩúËÄÖ ÁªºÂêàÈó®Êà∑„ÄÅÁ§æÂå∫ÂõΩÂÜÖÔºö CSDN ËÄÅÁâåÊäÄÊúØÁ§æÂå∫„ÄÅ‰∏çÂøÖËß£Èáä„ÄÇ 51cto.com ITeye ÂÅè Java ÊñπÂêë ÂçöÂÆ¢Âõ≠ ChinaUnix ÂÅè Linux ÊñπÂêë ÂºÄÊ∫ê‰∏≠ÂõΩÁ§æÂå∫ Ê∑±Â∫¶ÂºÄÊ∫ê ‰ºØ‰πêÂú®Á∫ø Ê∂µÁõñ ITËÅåÂú∫„ÄÅWebÂâçÁ´Ø„ÄÅÂêéÁ´Ø„ÄÅÁßªÂä®Á´Ø„ÄÅÊï∞ÊçÆÂ∫ìÁ≠âÊñπÈù¢ÂÜÖÂÆπÔºåÂÅèÊäÄÊúØÁ´Ø„ÄÇ ITPUB ËÖæËÆØ‰∫ë‚Äî ‰∫ë+Á§æÂå∫ ÈòøÈáå‰∫ë‚Äî ‰∫ëÊ†ñÁ§æÂå∫ IBM DeveloperWorks ÂºÄÂèëËÄÖÂ§¥Êù° LinkedKeeper ÂõΩÂ§ñÔºö DZone Reddit ÈóÆÁ≠î„ÄÅËÆ®ËÆ∫Á±ªÁ§æÂå∫ segmentfault ÈóÆÁ≠î+‰∏ìÊ†è Áü•‰πé stackoverflow Ë°å‰∏öÊï∞ÊçÆÂàÜÊûê ËâæÁëûÁΩë QUEST MOBILE ÂõΩÂÆ∂Êï∞ÊçÆ ‰∏ìÈ°πÁΩëÁ´ô ÊµãËØï: È¢ÜÊµãÂõΩÈôÖ ÊµãËØïÁ™ù TesterHome ËøêÁª¥: * [ËøêÁª¥Ê¥æ](http://www.yunweipai.com/) * [Abcdocker](https://www.abcdocker.com/) Java: ImportNew ‰∏ìÊ≥®‰∫é Java ÊäÄÊúØÂàÜ‰∫´ HowToDoInJava Ëã±ÊñáÂçöÂÆ¢ ÂÆâÂÖ® Á∫¢ÈªëËÅîÁõü FreeBuf Â§ßÊï∞ÊçÆ ‰∏≠ÂõΩÂ§ßÊï∞ÊçÆ ÂÖ∂‰ªñ‰∏ìÈ¢òÁΩëÁ´ôÔºö DockerInfo ‰∏ìÊ≥®‰∫é Docker Â∫îÁî®ÂèäÂí®ËØ¢„ÄÅÊïôÁ®ãÁöÑÁΩëÁ´ô„ÄÇ LinuxÂÖ¨Á§æ Linux ‰∏ªÈ¢òÁ§æÂå∫ ÂÖ∂‰ªñÁ±ª Á®ãÂ∫èÂëòÊäÄËÉΩÂõæË∞± Êé®ËçêÂèÇËÄÉ‰π¶Âú®Á∫øÁîµÂ≠ê‰π¶ „ÄäÊ∑±ÂÖ•ÁêÜËß£Spring Cloud‰∏éÂæÆÊúçÂä°ÊûÑÂª∫„Äã „ÄäÈòøÈáåÊäÄÊúØÂèÇËÄÉÂõæÂÜå-Á†îÂèëÁØá„Äã „ÄäÈòøÈáåÊäÄÊúØÂèÇËÄÉÂõæÂÜå-ÁÆóÊ≥ïÁØá„Äã „Ää2018ÁæéÂõ¢ÁÇπËØÑÊäÄÊúØÂπ¥Ë¥ßÔºàÂêàËæëÔºâ„Äã70M InfoQ„ÄäÊû∂ÊûÑÂ∏à„ÄãÊúàÂàä „ÄäÊû∂ÊûÑÂ∏à‰πãË∑Ø„Äã Á∫∏Ë¥®‰π¶ÂºÄÂèëÊñπÈù¢ „ÄäÈòøÈáåÂ∑¥Â∑¥JavaÂºÄÂèëÊâãÂÜå„Äã‰∫¨‰∏ú Ê∑òÂÆù Êû∂ÊûÑÊñπÈù¢ „ÄäËΩØ‰ª∂Êû∂ÊûÑÂ∏àÁöÑ12È°π‰øÆÁÇºÔºöÊäÄÊúØÊäÄËÉΩÁØá„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäÊû∂ÊûÑ‰πãÁæé„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäÂàÜÂ∏ÉÂºèÊúçÂä°Êû∂ÊûÑ„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäËÅäËÅäÊû∂ÊûÑ„Äã ‰∫¨‰∏ú Ê∑òÂÆù „Ää‰∫ëÂéüÁîüÂ∫îÁî®Êû∂ÊûÑÂÆûË∑µ„Äã‰∫¨‰∏ú Ê∑òÂÆù „Ää‰∫øÁ∫ßÊµÅÈáèÁΩëÁ´ôÊû∂ÊûÑÊ†∏ÂøÉÊäÄÊúØ„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäÊ∑òÂÆùÊäÄÊúØËøôÂçÅÂπ¥„Äã‰∫¨‰∏ú Ê∑òÂÆù „Ää‰ºÅ‰∏öITÊû∂ÊûÑËΩ¨Âûã‰πãÈÅì-‰∏≠Âè∞ÊàòÁï•ÊÄùÊÉ≥‰∏éÊû∂ÊûÑÂÆûÊàò„Äã ‰∫¨‰∏ú Ê∑òÂÆù ÊäÄÊúØÁÆ°ÁêÜÊñπÈù¢ „ÄäCTOËØ¥„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäÊäÄÊúØÁÆ°ÁêÜ‰πãÂ∑Ö„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäÁΩëÊòì‰∏ÄÂçÉÈõ∂‰∏ÄÂ§úÔºö‰∫íËÅîÁΩë‰∫ßÂìÅÈ°πÁõÆÁÆ°ÁêÜÂÆûÊàò„Äã‰∫¨‰∏ú Ê∑òÂÆù Âü∫Á°ÄÁêÜËÆ∫ „ÄäÊï∞Â≠¶‰πãÁæé„Äã‰∫¨‰∏ú Ê∑òÂÆù „ÄäÁºñÁ®ãÁè†Áéë„Äã‰∫¨‰∏ú Ê∑òÂÆù Â∑•ÂÖ∑ÊñπÈù¢TODO Â§ßÊï∞ÊçÆÊñπÈù¢ÊäÄÊúØËµÑÊ∫êÂºÄÊ∫êËµÑÊ∫ê github Apache ËΩØ‰ª∂Âü∫Èáë‰ºö ÊâãÂÜå„ÄÅÊñáÊ°£„ÄÅÊïôÁ®ãÂõΩÂÜÖÔºö W3Cschool Runoob.com HTML „ÄÅ CSS„ÄÅXML„ÄÅJava„ÄÅPython„ÄÅPHP„ÄÅËÆæËÆ°Ê®°ÂºèÁ≠âÂÖ•Èó®ÊâãÂÜå„ÄÇ Love2.io ÂæàÂ§öÂæàÂ§ö‰∏≠ÊñáÂú®Á∫øÁîµÂ≠ê‰π¶ÔºåÊòØ‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑÂºÄÊ∫êÊäÄÊúØÊñáÊ°£ÂàÜ‰∫´Âπ≥Âè∞„ÄÇ gitbook.cn ‰ªòË¥πÁîµÂ≠ê‰π¶„ÄÇ ApacheCN AI„ÄÅÂ§ßÊï∞ÊçÆÊñπÈù¢Á≥ªÂàó‰∏≠ÊñáÊñáÊ°£„ÄÇ ÂõΩÂ§ñÔºö Quick Code ÂÖçË¥πÂú®Á∫øÊäÄÊúØÊïôÁ®ã„ÄÇ gitbook.com ÊúâÈÉ®ÂàÜ‰∏≠ÊñáÁîµÂ≠ê‰π¶„ÄÇ Cheatography Cheat Sheets Â§ßÂÖ®ÔºåÂçïÈ°µÊñáÊ°£ÁΩëÁ´ô„ÄÇ Âú®Á∫øËØæÂ†Ç Â≠¶ÂæíÊó†Âøß ÊûÅÂÆ¢Êó∂Èó¥ segmentfault ÊñØËææÂÖãÂ≠¶Èô¢ ÁâõÂÆ¢ÁΩë ÊûÅÂÆ¢Â≠¶Èô¢ 51CTOÂ≠¶Èô¢ ‰ºöËÆÆ„ÄÅÊ¥ªÂä® QCon ArchSummit GITCÂÖ®ÁêÉ‰∫íËÅîÁΩëÊäÄÊúØÂ§ß‰ºö Ê¥ªÂä®ÂèëÂ∏ÉÂπ≥Âè∞: Ê¥ªÂä®Ë°å Â∏∏Áî®APP ÊûÅÂÆ¢Êó∂Èó¥ ÂæóÂà∞ ÊâæÂ∑•‰Ωú BossÁõ¥ËÅò ÊãâÂãæÁΩë ÁåéËÅò 100Offer Â∑•ÂÖ∑ ÊûÅÂÆ¢ÊêúÁ¥¢ ÊäÄÊúØÊñáÁ´†ÊêúÁ¥¢ÂºïÊìé„ÄÇ ‰ª£Á†ÅÊâòÁÆ° Coding Á†Å‰∫ë Êñá‰ª∂ÊúçÂä° ‰∏ÉÁâõ ÂèàÊãç‰∫ë ÁªºÂêà‰∫ëÊúçÂä°ÂïÜ ÈòøÈáå‰∫ë ËÖæËÆØ‰∫ë ÁôæÂ∫¶‰∫ë Êñ∞Êµ™‰∫ë ÈáëÂ±±‰∫ë ‰∫öÈ©¨ÈÄä‰∫ë(AWS) Ë∞∑Ê≠å‰∫ë ÂæÆËΩØ‰∫ë VPS Linode]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>javaÊû∂ÊûÑ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LinkedBlockingQueue]]></title>
    <url>%2F2018%2F05%2F08%2FLinkedBlockingQueue%2F</url>
    <content type="text"><![CDATA[ÈîÅÂàÜÁ¶ªtakeÂíåputÂàÜÂà´‰∏§‰∏™ReentrantLockÈîÅ 1234567891011/** Lock held by take, poll, etc */private final ReentrantLock takeLock = new ReentrantLock();/** Wait queue for waiting takes */private final Condition notEmpty = takeLock.newCondition();/** Lock held by put, offer, etc */private final ReentrantLock putLock = new ReentrantLock();/** Wait queue for waiting puts */private final Condition notFull = putLock.newCondition();]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>javaÂπ∂ÂèëÂåÖ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javaÂπ∂ÂèëÂåÖÁõÆÂΩï]]></title>
    <url>%2F2018%2F05%2F08%2Fjava%E5%B9%B6%E5%8F%91%E5%8C%85%E7%9B%AE%E5%BD%95%2F</url>
    <content type="text"><![CDATA[ÂéüÂ≠êÁ±ªÈîÅÂ∑•ÂÖ∑Á±ªCyclicBarrier1234567891011121314151617181920212223242526272829303132public class StartGame implements Runnable&#123; private String player; private CyclicBarrier barrier; public StartGame(String player, CyclicBarrier barrier) &#123; this.player = player; this.barrier = barrier; &#125; @Override public void run() &#123; try &#123; System.out.println(this.getPlayer()+" ÂºÄÂßãÂåπÈÖçÁé©ÂÆ∂..."); findOtherPlayer(); barrier.await(); System.out.println(this.getPlayer()+" ËøõË°åÈÄâÊã©ËßíËâ≤..."); choiceRole(); System.out.println(this.getPlayer()+" ËßíËâ≤ÈÄâÊã©ÂÆåÊØïÁ≠âÂæÖÂÖ∂‰ªñÁé©ÂÆ∂..."); barrier.await(); System.out.println(this.getPlayer()+" ÂºÄÂßãÊ∏∏Êàè,ËøõË°åÊ∏∏ÊàèÂä†ËΩΩ..."); loading(); System.out.println(this.getPlayer()+" Ê∏∏ÊàèÂä†ËΩΩÂÆåÊØïÁ≠âÂæÖÂÖ∂‰ªñÁé©ÂÆ∂Âä†ËΩΩÂÆåÊàê..."); barrier.await(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; 123456789101112131415161718public class GameMain &#123; public static void main(String[] args) &#123; CyclicBarrier barrier = new CyclicBarrier(5); for(int i=0;i&lt;5;i++)&#123; Thread player1 = new Thread(new StartGame(String.valueOf(i+1),barrier)); player1.start(); &#125; try &#123; System.in.read(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; ÈõÜÂêàÁ±ªConcurrentHashMapLinkedBlockingQueuehttps://zhouxiaowu.coding.me/2018/05/08/LinkedBlockingQueue/ ÈîÅ‰ºòÂåñ „Äêok„ÄëÊ≠ªÈîÅÈáçÁé∞‰∏éÊéíÊü• ThreadLocal‰∏Ä.‰ªÄ‰πàÊòØThreadLocal?ThreadLocal ÊòØÂú® java.lang.ÂåÖ‰∏ãÁöÑ Âú®jdk1.2ÈáåÂºïÂÖ•ËøõÊù• ‰∏ªË¶ÅÊòØÁªôÊØè‰∏™Á∫øÁ®ãÂàÜÈÖçËØ•Á∫øÁ®ãÊú¨Ë∫´ÁöÑÊú¨Âú∞ÂèòÈáè ËØ•ÂèòÈáèÊòØËØ•Á∫øÁ®ãÁã¨ÊúâÁöÑ Âà´ÁöÑÁ∫øÁ®ãÊòØËÆøÈóÆ‰∏ç‰∫ÜÁöÑ„ÄÇ ‰∫å. ThreadLocalÁöÑÂÆûÁé∞ÂéüÁêÜÔºöÊúÄÂÖ≥ÈîÆÁöÑÊòØÂú®ThreadÁ±ªÈáåÊúâ‰∏Ä‰∏™ThreadLocal.ThreadLocalMap threadLocalsÁöÑÂ±ûÊÄßÔºå‰πüÂ∞±ÊòØËØ¥ ‰∏Ä‰∏™Á∫øÁ®ãÂØπË±°ÁîüÊàêÁöÑÊó∂ÂÄô‰ºöÊúâ‰∏Ä‰∏™ÂØπÂ∫îÁßÅÊúâÂ±ûÊÄß threadLocals ÁîüÊàê Ëøô‰∏™Â±ûÊÄßÊòØ‰∏Ä‰∏™ ThreadLocalMap ‰πüÂ∞±ÊòØMAP ÔºåÁúãThreadLocalÁ±ªÁöÑgetÊñπÊ≥ïÔºö 12345678910public T get() &#123; Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) &#123; ThreadLocalMap.Entry e = map.getEntry(this); if (e != null) return (T)e.value; &#125; return setInitialValue(); &#125; ÈÄöËøá‰º†ÂÖ•ÂΩìÂâçÁ∫øÁ®ãÂØπË±°t‰ºöÂèñÂæóÂΩìÂâçÁ∫øÁ®ãÁöÑ ThreadLocalMap Ëøô‰∏™ThreadLocalMap keyÊòØThreadLocalÂØπË±° ÂÄºÊòØÊàë‰ª¨‰º†ÂÖ•ÁöÑÂÄºOBJ,ÈÄöËøá‰º†ÂÖ•ÂΩìÂâçÁöÑThreadLocalÁöÑÂØπË±°tlÔºà‰ª£Á†ÅÈáåÁöÑthisÔºâ‰ºöÂèñÂæóËØ•keyÂØπÂ∫îÁöÑvalueÂ∞±ÊòØÊàë‰ª¨setÂ∞±ÂéªÁöÑÂØπË±° ‰ªéËÄåÂÆûÁé∞‰∏Ä‰∏™Á∫øÁ®ã ÊúâËá™Â∑±ÁöÑÁã¨ÊúâÁöÑThreadLocalMap ‰∏Ä‰∏™ThreadLocalÂèØ‰ª•ÂèñÂõûËá™Â∑±‰Ωú‰∏∫keyÂØπÂ∫îvalue(OBJ) „ÄÇThreadLocalMap ÂèØ‰ª•Â§ö‰∏™key=&gt;value(‰∏Ä‰∏™Á∫øÁ®ãÂÆû‰æãÂåñÂ§ö‰∏™ThreadLocal)„ÄÇÈÉΩÊòØÈÄöËøá‰º†ÈÄíÂΩìÂâçÁöÑThreadÂØπË±°ÂíåÂΩìÂâçÁöÑThreadLocalÂØπË±°ÂÆûÁé∞ÂèñÂæóÂîØ‰∏ÄÁöÑÂÄºÁöÑ„ÄÇ ÂÖ∑‰ΩìÂ¶Ç‰ΩïÂÆûÁé∞ËØ∑ÁúãÊ∫ê‰ª£Á†ÅÔºàThreadLocalÁ±ª ThreadÁ±ª ThreadLocalÁ±ªÈáåÁöÑÂÜÖÈÉ®Á±ªThreadLocalMapÔºâÁöÑÂêÑ‰∏™ÊñπÊ≥ï Â∞§ÂÖ∂ÊòØThreadLocalÁ±ª ÁöÑget() set() remove() Á≠âÊñπÊ≥ï„ÄÇ ‰∏â.‰ΩøÁî®Âú∫ÊôØÔºöÂü∫Êú¨‰∏äÈúÄË¶ÅÂú®‰∏Ä‰∏™Á∫øÁ®ãÈáå‰øùÂ≠ò‰∏ä‰∏ãÊñá‰ø°ÊÅØÁöÑ ÈúÄË¶Å‰∏ä‰∏ãÊñáÂàáÊç¢ÁöÑ ÊØîÂ¶Çsession cookieÁ≠âÈÉΩÂèØ‰ª•Áî®Ëøô‰∏™ spring Á≠âÊ°ÜÊû∂‰πüÂπøÊ≥õ‰ΩøÁî®‰∫ÜËØ•ÊäÄÊúØ„ÄÇ Âõõ.Ê≥®ÊÑè‰∫ãÈ°πÔºö Âú®‰ΩøÁî®ThreadLocalÁöÑÊó∂ÂÄôsetÂÆåÂêéÁ∫øÁ®ãÊâßË°åÂÆåÈúÄË¶ÅÊòæÊÄßË∞ÉÁî®removeÊñπÊ≥ïÊ∏ÖÈô§ ‰∏çÁÑ∂Âú®ÊúâÁ∫øÁ®ãÊ±†Ê®°ÂºèÁöÑWEBÊúçÂä°Âô®‰∏ãtomcat‰ºöÂá∫Áé∞ ÂÜÖÂ≠òÊ∫¢Âá∫ÂíåÁî®Êà∑‰∏ä‰∏ãÈîô‰π±ÔºàÊØîÂ¶ÇAÁî®Êà∑ÊãøÂà∞‰∫ÜBÁî®Êà∑ÁöÑSESSIONÔºâËôΩÁÑ∂Âêå‰∏Ä‰∏™Á∫øÁ®ãÂú®ÊâßË°åÂà∞SETÁöÑÊó∂ÂÄô‰ºöË¶ÜÁõñ‰πãÂâç‰øùÁïôÁöÑÂÄº‰ΩÜÊòØ‰Ω†Êó†Ê≥ïÊéßÂà∂ÂÖ∂‰ªñ‰∫∫ÊòØÂê¶Âú®SET‰πãÂâçÊúâË∞ÉÁî®‰∫Ü„ÄÇÊâÄ‰ª•‰∏ÄÂÆöË¶ÅÂú®Á∫øÁ®ãÊâßË°åÂêéremove. PS:webxÁöÑfilterÂíåinvokeÈÉΩÊòØÈÄíÂΩíË∞ÉÁî®ÁöÑ Á¨¨‰∏Ä‰∏™filterÈÉΩÊòØÊúÄÂÖàÊâßË°åÊúÄÂêéÊî∂Â∞æÁöÑ invoke‰πüÁ±ª‰ºº„ÄÇ 123456789101112131415161718192021public final class MyContext &#123; /** * ÁªëÂÆöÁ∫øÁ®ã */ private static final ThreadLocal&lt;EventContext&gt; LOCAL_CONTEXT = ThreadLocal.withInitial(() -&gt; new EventContext()); private MyContext() &#123; &#125; public static EventContext getContext() &#123; return LOCAL_CONTEXT.get(); &#125; public static void setContext(EventContext context) &#123; LOCAL_CONTEXT.set(context); &#125; //ÊúÄÂêéfilterË∞ÉÁî® public static void clearContext() &#123; LOCAL_CONTEXT.remove(); &#125; ‰ΩøÁî®Á§∫‰æãÊúÄËøëÂú®Êàë‰ª¨ÁöÑwebÈ°πÁõÆ‰∏≠servletÈúÄË¶ÅÈ¢ëÁπÅÂàõÂª∫SimpleDateFormatËøô‰∏™ÂØπË±°ÔºåËøõË°åÊó•ÊúüÊ†ºÂºèÂåñ„ÄÇÂõ†‰∏∫ÂàõÂª∫Ëøô‰∏™ÂØπË±°Êú¨Ë∫´ÂæàË¥πÊó∂ÁöÑÔºåËÄå‰∏îÊàë‰ª¨‰πüÁü•ÈÅìSimpleDateFormatÊú¨Ë∫´‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºå‰πü‰∏çËÉΩÁºìÂ≠ò‰∏Ä‰∏™ÂÖ±‰∫´ÁöÑSimpleDateFormatÂÆû‰æãÔºå‰∏∫Ê≠§Êàë‰ª¨ÊÉ≥Âà∞‰ΩøÁî®ThreadLocalÊù•ÁªôÊØè‰∏™Á∫øÁ®ãÁºìÂ≠ò‰∏Ä‰∏™SimpleDateFormatÂÆû‰æãÔºåÊèêÈ´òÊÄßËÉΩ„ÄÇÂêåÊó∂Âõ†‰∏∫ÊØè‰∏™Servlet‰ºöÁî®Âà∞‰∏çÂêåpatternÁöÑÊó∂Èó¥Ê†ºÂºèÂåñÁ±ªÔºåÊâÄ‰ª•Êàë‰ª¨ÂØπÂ∫îÊØè‰∏ÄÁßçpatternÁîüÊàê‰∫Ü‰∏Ä‰∏™ThreadLocalÂÆû‰æã„ÄÇ 12345678910111213141516171819202122232425262728public class DateFormatFactory &#123;private static final Map&lt;DatePattern, ThreadLocal&lt;DateFormat&gt;&gt; pattern2ThreadLocal;static &#123; DatePattern[] patterns = DatePattern.values(); int len = patterns.length; pattern2ThreadLocal = new HashMap&lt;DatePattern, ThreadLocal&lt;DateFormat&gt;&gt;(len); for (int i = 0; i &lt; len; i++) &#123; DatePattern datePattern = patterns[i]; final String pattern = datePattern.pattern; pattern2ThreadLocal.put(datePattern, new ThreadLocal&lt;DateFormat&gt;() &#123; @Override protected DateFormat initialValue() &#123; return new SimpleDateFormat(pattern); &#125; &#125;); &#125;&#125;//Ëé∑ÂèñDateFormatpublic static DateFormat getDateFormat(DatePattern pattern) &#123; ThreadLocal&lt;DateFormat&gt; threadDateFormat = pattern2ThreadLocal.get(pattern); //‰∏çÈúÄË¶ÅÂà§Êñ≠threadDateFormatÊòØÂê¶‰∏∫Á©∫ return threadDateFormat.get();&#125; 1234567891011public enum DatePattern &#123;TimePattern("yyyy-MM-dd HH:mm:ss"),DatePattern("yyyy-MM-dd"),public String pattern;private DatePattern(String pattern) &#123; this.pattern = pattern;&#125;]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>javaÂπ∂ÂèëÂåÖ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂàÜÂ∏ÉÂºèÈîÅÈ°πÁõÆÊ±áÊÄª]]></title>
    <url>%2F2018%2F05%2F06%2F%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E9%A1%B9%E7%9B%AE%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[Âü∫‰∫édubboÁöÑÂàÜÂ∏ÉÂºèÂ∑•Á®ãÂºÄÂèëËßÑËåÉÂÆû‰æãÂ∑•Á®ãÔºåÂàÜÂ∏ÉÂºèË∑üË∏™„ÄÅIDÁîüÊàê„ÄÅÂàÜÂ∏ÉÂºè‰∫ãÂä°„ÄÅÂàÜÂ∏ÉÂºèÊ≤ªÁêÜ„ÄÅÂàÜË°®ÂàÜÂ∫ì„ÄÅÂàÜÂ∏ÉÂºèÈîÅ„ÄÅÈÄâ‰∏æ„ÄÅAPIÊñáÊ°£ÁîüÊàêÂô®‚Ä¶ https://github.com/Frankenjoy123/j360-dubbo-app-all ÂêÑÁßçÈîÅÊ±áÊÄªÔºå‰πêËßÇÈîÅ„ÄÅÊÇ≤ËßÇÈîÅ„ÄÅÂàÜÂ∏ÉÂºèÈîÅ„ÄÅ‰∫íÊñ•ÈîÅ„ÄÅËØªÂÜôÈîÅ„ÄÅÂàÜÊÆµÈîÅ„ÄÅÁ±ªÈîÅÁ≠âÔºåÂæà‰∏çÈîôÁöÑÊÄªÁªì https://github.com/Frankenjoy123/Lock-Learning Ê±áÊÄªjavaÁîüÊÄÅÂúàÂ∏∏Áî®ÊäÄÊúØÊ°ÜÊû∂„ÄÅÂºÄÊ∫ê‰∏≠Èó¥‰ª∂ÔºåÁ≥ªÁªüÊû∂ÊûÑ„ÄÅÈ°πÁõÆÁÆ°ÁêÜ„ÄÅÁªèÂÖ∏Êû∂ÊûÑÊ°à‰æã„ÄÅÊï∞ÊçÆÂ∫ì„ÄÅÂ∏∏Áî®‰∏âÊñπÂ∫ì„ÄÅÁ∫ø‰∏äËøêÁª¥Á≠âÁü•ËØÜ https://github.com/aalansehaiyang/technology-talk]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
      <tags>
        <tag>ÂàÜÂ∏ÉÂºèÈîÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî®zookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ‰∫å]]></title>
    <url>%2F2018%2F05%2F06%2F%E4%BD%BF%E7%94%A8zookeeper%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81(%E4%BA%8C)%2F</url>
    <content type="text"><![CDATA[Êé®Ëçê‰∏Ä‰∏™Â∑•ÂÖ∑Âü∫‰∫éredisÂíåzookeeperÂàÜÂ∏ÉÂºèÂ∑•ÂÖ∑ÈõÜ-ÂåÖÊã¨:ÂàÜÂ∏ÉÂºèÈîÅÂÆûÁé∞,ÂàÜÂ∏ÉÂºèÈÄüÁéáÈôêÂà∂Âô®,ÂàÜÂ∏ÉÂºèIDÁîüÊàêÂô®Á≠â.https://github.com/yujiasun/Distributed-Kit/blob/master/README.md 1.ÂàÜÂ∏ÉÂºèÈîÅÁöÑÁî±Êù•Âú®Á®ãÂ∫èÂºÄÂèëËøáÁ®ã‰∏≠‰∏çÂæó‰∏çËÄÉËôëÁöÑÂ∞±ÊòØÂπ∂ÂèëÈóÆÈ¢ò„ÄÇÂú®java‰∏≠ÂØπ‰∫éÂêå‰∏Ä‰∏™jvmËÄåË®ÄÔºåjdkÂ∑≤ÁªèÊèê‰æõ‰∫ÜlockÂíåÂêåÊ≠•Á≠â„ÄÇ‰ΩÜÊòØÂú®ÂàÜÂ∏ÉÂºèÊÉÖÂÜµ‰∏ãÔºåÂæÄÂæÄÂ≠òÂú®Â§ö‰∏™ËøõÁ®ãÂØπ‰∏Ä‰∫õËµÑÊ∫ê‰∫ßÁîüÁ´û‰∫âÂÖ≥Á≥ªÔºåËÄåËøô‰∫õËøõÁ®ãÂæÄÂæÄÂú®‰∏çÂêåÁöÑÊú∫Âô®‰∏äÔºåËøô‰∏™Êó∂ÂÄôjdk‰∏≠Êèê‰æõÁöÑÂ∑≤Áªè‰∏çËÉΩÊª°Ë∂≥„ÄÇÂàÜÂ∏ÉÂºèÈîÅÈ°æÊòéÊÄùËÆÆÂ∞±ÊòØÂèØ‰ª•Êª°Ë∂≥ÂàÜÂ∏ÉÂºèÊÉÖÂÜµ‰∏ãÁöÑÂπ∂ÂèëÈîÅ„ÄÇ ‰∏ãÈù¢Êàë‰ª¨ËÆ≤Ëß£ÊÄé‰πàÂà©Áî®zkÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ„ÄÇ 2.ÂÆûÁé∞ÊÄùË∑ØÔºö2.1 zkÁÆÄÂçï‰ªãÁªçÔºöZooKeeperÊòØApacheËΩØ‰ª∂Âü∫Èáë‰ºöÁöÑ‰∏Ä‰∏™ËΩØ‰ª∂È°πÁõÆÔºå‰ªñ‰∏∫Â§ßÂûãÂàÜÂ∏ÉÂºèËÆ°ÁÆóÊèê‰æõÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºèÈÖçÁΩÆÊúçÂä°„ÄÅÂêåÊ≠•ÊúçÂä°ÂíåÂëΩÂêçÊ≥®ÂÜå„ÄÇÂú® ZooKeeper ‰∏≠ÔºåËäÇÁÇπÁ±ªÂûãÂèØ‰ª•ÂàÜ‰∏∫ÊåÅ‰πÖËäÇÁÇπÔºàPERSISTENT Ôºâ„ÄÅ‰∏¥Êó∂ËäÇÁÇπÔºàEPHEMERALÔºâÔºå‰ª•ÂèäÊó∂Â∫èËäÇÁÇπÔºàSEQUENTIAL ÔºâÔºåÂÖ∑‰ΩìÂú®ËäÇÁÇπÂàõÂª∫ËøáÁ®ã‰∏≠Ôºå‰∏ÄËà¨ÊòØÁªÑÂêà‰ΩøÁî®ÔºåÂèØ‰ª•ÁîüÊàê 4 ÁßçËäÇÁÇπÁ±ªÂûãÔºöÊåÅ‰πÖËäÇÁÇπÔºàPERSISTENTÔºâÔºåÊåÅ‰πÖÈ°∫Â∫èËäÇÁÇπÔºàPERSISTENT_SEQUENTIALÔºâÔºå‰∏¥Êó∂ËäÇÁÇπÔºàEPHEMERALÔºâÔºå‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÔºàEPHEMERAL_SEQUENTIALÔºâÔºõÂÖ∑‰ΩìËäÇÁÇπÂê´‰πâÔºåË∞∑Ê≠å‰πã„ÄÇ 2.2 Âà©Áî®zkÂÆûÁé∞ÔºöÂΩìÂæàÂ§öËøõÁ®ãÈúÄË¶ÅËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøázkÊù•ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ„ÄÇ‰∏ªË¶ÅÊ≠•È™§ÊòØÔºö1.Âª∫Á´ã‰∏Ä‰∏™ËäÇÁÇπÔºåÂÅáÂ¶ÇÂêç‰∏∫Ôºölock „ÄÇËäÇÁÇπÁ±ªÂûã‰∏∫ÊåÅ‰πÖËäÇÁÇπÔºàPERSISTENTÔºâ2.ÊØèÂΩìËøõÁ®ãÈúÄË¶ÅËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÊó∂Ôºå‰ºöË∞ÉÁî®ÂàÜÂ∏ÉÂºèÈîÅÁöÑlock()ÊàñtryLock()ÊñπÊ≥ïËé∑ÂæóÈîÅÔºåËøô‰∏™Êó∂ÂÄô‰ºöÂú®Á¨¨‰∏ÄÊ≠•ÂàõÂª∫ÁöÑlockËäÇÁÇπ‰∏ãÂª∫Á´ãÁõ∏Â∫îÁöÑÈ°∫Â∫èÂ≠êËäÇÁÇπÔºåËäÇÁÇπÁ±ªÂûã‰∏∫‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÔºàEPHEMERAL_SEQUENTIALÔºâÔºåÈÄöËøáÁªÑÊàêÁâπÂÆöÁöÑÂêçÂ≠óname+lock+È°∫Â∫èÂè∑„ÄÇ3.Âú®Âª∫Á´ãÂ≠êËäÇÁÇπÂêéÔºåÂØπlock‰∏ãÈù¢ÁöÑÊâÄÊúâ‰ª•nameÂºÄÂ§¥ÁöÑÂ≠êËäÇÁÇπËøõË°åÊéíÂ∫èÔºåÂà§Êñ≠ÂàöÂàöÂª∫Á´ãÁöÑÂ≠êËäÇÁÇπÈ°∫Â∫èÂè∑ÊòØÂê¶ÊòØÊúÄÂ∞èÁöÑËäÇÁÇπÔºåÂÅáÂ¶ÇÊòØÊúÄÂ∞èËäÇÁÇπÔºåÂàôËé∑ÂæóËØ•ÈîÅÂØπËµÑÊ∫êËøõË°åËÆøÈóÆ„ÄÇ4.ÂÅáÂ¶Ç‰∏çÊòØËØ•ËäÇÁÇπÔºåÂ∞±Ëé∑ÂæóËØ•ËäÇÁÇπÁöÑ‰∏ä‰∏ÄÈ°∫Â∫èËäÇÁÇπÔºåÂπ∂ÁªôËØ•ËäÇÁÇπÊòØÂê¶Â≠òÂú®Ê≥®ÂÜåÁõëÂê¨‰∫ã‰ª∂„ÄÇÂêåÊó∂Âú®ËøôÈáåÈòªÂ°û„ÄÇÁ≠âÂæÖÁõëÂê¨‰∫ã‰ª∂ÁöÑÂèëÁîüÔºåËé∑ÂæóÈîÅÊéßÂà∂ÊùÉ„ÄÇ5.ÂΩìË∞ÉÁî®ÂÆåÂÖ±‰∫´ËµÑÊ∫êÂêéÔºåË∞ÉÁî®unlockÔºàÔºâÊñπÊ≥ïÔºåÂÖ≥Èó≠zkÔºåËøõËÄåÂèØ‰ª•ÂºïÂèëÁõëÂê¨‰∫ã‰ª∂ÔºåÈáäÊîæËØ•ÈîÅ„ÄÇÂÆûÁé∞ÁöÑÂàÜÂ∏ÉÂºèÈîÅÊòØ‰∏•Ê†ºÁöÑÊåâÁÖßÈ°∫Â∫èËÆøÈóÆÁöÑÂπ∂ÂèëÈîÅ„ÄÇ 3.‰ª£Á†ÅÂÆûÁé∞Ôºö‰∏ãÈù¢Â∞ÜËÆ≤Ëß£‰ΩøÁî®javaÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÔºö1.Âª∫Á´ãÁ±ªDistributedLockÔºåÂÆûÁé∞java.util.concurrent.locks.Lock;Âíåorg.apache.zookeeper.WatcherÊé•Âè£2.ÂÆûÁé∞lock‰∏ãÈù¢ÁöÑÊñπÊ≥ïÔºö‰∏ªË¶ÅÂåÖÊã¨lockÔºåtryLockÔºåunlockÁ≠â3.ÂÆûÁé∞watcherÊé•Âè£‰∏ãÁöÑprocessÊñπÊ≥ï„ÄÇ4.Âú®ÊûÑÈÄ†Âô®‰∏≠ÂØπzkËøõË°åÂàùÂßãÂåñ„ÄÇ5.ËØ¶ÁªÜËßÅ‰ª£Á†ÅÊ≥®Èáä 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170package cn.wpeace.zktest;import java.io.IOException;import java.util.ArrayList;import java.util.Collections;import java.util.List;import java.util.concurrent.CountDownLatch;import java.util.concurrent.TimeUnit;import java.util.concurrent.locks.Condition;import java.util.concurrent.locks.Lock;import org.apache.zookeeper.CreateMode;import org.apache.zookeeper.KeeperException;import org.apache.zookeeper.WatchedEvent;import org.apache.zookeeper.Watcher;import org.apache.zookeeper.ZooDefs;import org.apache.zookeeper.ZooKeeper;import org.apache.zookeeper.Watcher.Event.KeeperState;import org.apache.zookeeper.data.Stat;/** * @author peace * */public class DistributedLock implements Lock, Watcher&#123; private ZooKeeper zk; private String root = "/locks";//Ê†π private String lockName;//Á´û‰∫âËµÑÊ∫êÁöÑÊ†áÂøó private String waitNode;//Á≠âÂæÖÂâç‰∏Ä‰∏™ÈîÅ private String myZnode;//ÂΩìÂâçÈîÅ private CountDownLatch latch;//ËÆ°Êï∞Âô® private CountDownLatch connectedSignal=new CountDownLatch(1); private int sessionTimeout = 30000; /** * ÂàõÂª∫ÂàÜÂ∏ÉÂºèÈîÅ,‰ΩøÁî®ÂâçËØ∑Á°ÆËÆ§configÈÖçÁΩÆÁöÑzookeeperÊúçÂä°ÂèØÁî® * @param config 192.168.1.127:2181 * @param lockName Á´û‰∫âËµÑÊ∫êÊ†áÂøó,lockName‰∏≠‰∏çËÉΩÂåÖÂê´ÂçïËØç_lock_ */ public DistributedLock(String config, String lockName)&#123; this.lockName = lockName; // ÂàõÂª∫‰∏Ä‰∏™‰∏éÊúçÂä°Âô®ÁöÑËøûÊé• try &#123; zk = new ZooKeeper(config, sessionTimeout, this); connectedSignal.await(); Stat stat = zk.exists(root, false);//Ê≠§Âéª‰∏çÊâßË°å Watcher if(stat == null)&#123; // ÂàõÂª∫Ê†πËäÇÁÇπ zk.create(root, new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT); &#125; &#125; catch (IOException e) &#123; throw new LockException(e); &#125; catch (KeeperException e) &#123; throw new LockException(e); &#125; catch (InterruptedException e) &#123; throw new LockException(e); &#125; &#125; /** * zookeeperËäÇÁÇπÁöÑÁõëËßÜÂô® */ public void process(WatchedEvent event) &#123; //Âª∫Á´ãËøûÊé•Áî® if(event.getState()==KeeperState.SyncConnected)&#123; connectedSignal.countDown(); return; &#125; //ÂÖ∂‰ªñÁ∫øÁ®ãÊîæÂºÉÈîÅÁöÑÊ†áÂøó if(this.latch != null) &#123; this.latch.countDown(); &#125; &#125; public void lock() &#123; try &#123; if(this.tryLock())&#123; System.out.println("Thread " + Thread.currentThread().getId() + " " +myZnode + " get lock true"); return; &#125; else&#123; waitForLock(waitNode, sessionTimeout);//Á≠âÂæÖÈîÅ &#125; &#125; catch (KeeperException e) &#123; throw new LockException(e); &#125; catch (InterruptedException e) &#123; throw new LockException(e); &#125; &#125; public boolean tryLock() &#123; try &#123; String splitStr = "_lock_"; if(lockName.contains(splitStr)) throw new LockException("lockName can not contains \\u000B"); //ÂàõÂª∫‰∏¥Êó∂Â≠êËäÇÁÇπ myZnode = zk.create(root + "/" + lockName + splitStr, new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL_SEQUENTIAL); System.out.println(myZnode + " is created "); //ÂèñÂá∫ÊâÄÊúâÂ≠êËäÇÁÇπ List&lt;String&gt; subNodes = zk.getChildren(root, false); //ÂèñÂá∫ÊâÄÊúâlockNameÁöÑÈîÅ List&lt;String&gt; lockObjNodes = new ArrayList&lt;String&gt;(); for (String node : subNodes) &#123; String _node = node.split(splitStr)[0]; if(_node.equals(lockName))&#123; lockObjNodes.add(node); &#125; &#125; Collections.sort(lockObjNodes); if(myZnode.equals(root+"/"+lockObjNodes.get(0)))&#123; //Â¶ÇÊûúÊòØÊúÄÂ∞èÁöÑËäÇÁÇπ,ÂàôË°®Á§∫ÂèñÂæóÈîÅ System.out.println(myZnode + "==" + lockObjNodes.get(0)); return true; &#125; //Â¶ÇÊûú‰∏çÊòØÊúÄÂ∞èÁöÑËäÇÁÇπÔºåÊâæÂà∞ÊØîËá™Â∑±Â∞è1ÁöÑËäÇÁÇπ String subMyZnode = myZnode.substring(myZnode.lastIndexOf("/") + 1); waitNode = lockObjNodes.get(Collections.binarySearch(lockObjNodes, subMyZnode) - 1);//ÊâæÂà∞Ââç‰∏Ä‰∏™Â≠êËäÇÁÇπ &#125; catch (KeeperException e) &#123; throw new LockException(e); &#125; catch (InterruptedException e) &#123; throw new LockException(e); &#125; return false; &#125; public boolean tryLock(long time, TimeUnit unit) &#123; try &#123; if(this.tryLock())&#123; return true; &#125; return waitForLock(waitNode,time); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return false; &#125; private boolean waitForLock(String lower, long waitTime) throws InterruptedException, KeeperException &#123; Stat stat = zk.exists(root + "/" + lower,true);//ÂêåÊó∂Ê≥®ÂÜåÁõëÂê¨„ÄÇ //Âà§Êñ≠ÊØîËá™Â∑±Â∞è‰∏Ä‰∏™Êï∞ÁöÑËäÇÁÇπÊòØÂê¶Â≠òÂú®,Â¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÊó†ÈúÄÁ≠âÂæÖÈîÅ,ÂêåÊó∂Ê≥®ÂÜåÁõëÂê¨ if(stat != null)&#123; System.out.println("Thread " + Thread.currentThread().getId() + " waiting for " + root + "/" + lower); this.latch = new CountDownLatch(1); this.latch.await(waitTime, TimeUnit.MILLISECONDS);//Á≠âÂæÖÔºåËøôÈáåÂ∫îËØ•‰∏ÄÁõ¥Á≠âÂæÖÂÖ∂‰ªñÁ∫øÁ®ãÈáäÊîæÈîÅ this.latch = null; &#125; return true; &#125; public void unlock() &#123; try &#123; System.out.println("unlock " + myZnode); zk.delete(myZnode,-1); myZnode = null; zk.close(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; catch (KeeperException e) &#123; e.printStackTrace(); &#125; &#125; public void lockInterruptibly() throws InterruptedException &#123; this.lock(); &#125; public Condition newCondition() &#123; return null; &#125; public class LockException extends RuntimeException &#123; private static final long serialVersionUID = 1L; public LockException(String e)&#123; super(e); &#125; public LockException(Exception e)&#123; super(e); &#125; &#125;&#125; 4.ÊµãËØïÔºö1.‰∏ãËΩΩÊàëÁöÑÂ∑•Á®ã‰ª£Á†ÅÔºöÁÇπÂáª‰∏ãËΩΩ2.ÊàñËÄÖÁõ¥Êé•‰ΩøÁî®ËØ•Á±ªÔºö DistributedLock lock = new DistributedLock(‚Äú192.168.1.127:2181‚Äù,‚Äùlock‚Äù); lock.lock(); //ÂÖ±‰∫´ËµÑÊ∫ê if(lock != null) lock.unlock();123453.ÊâßË°åÊ≠•È™§Ôºö1.ÂêØÂä®zk:zkServer.sh start2.ÂêØÂä®ÊµãËØï‰ª£Á†Å3.ÊâßË°åÁªìÊûúÔºö0506]]></content>
      <categories>
        <category>zookeeper</category>
      </categories>
      <tags>
        <tag>ÂàÜÂ∏ÉÂºèÈîÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî®zookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ‰∏Ä]]></title>
    <url>%2F2018%2F05%2F06%2F%E4%BD%BF%E7%94%A8zookeeper%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81(%E4%B8%80)%2F</url>
    <content type="text"><![CDATA[‰∏Ä„ÄÅÂàÜÂ∏ÉÂºèÈîÅ‰ªãÁªç‚Äã ÂàÜÂ∏ÉÂºèÈîÅ‰∏ªË¶ÅÁî®‰∫éÂú®ÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏≠‰øùÊä§Ë∑®ËøõÁ®ã„ÄÅË∑®‰∏ªÊú∫„ÄÅË∑®ÁΩëÁªúÁöÑÂÖ±‰∫´ËµÑÊ∫êÂÆûÁé∞‰∫íÊñ•ËÆøÈóÆÔºå‰ª•ËææÂà∞‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ ‰∫å„ÄÅÊû∂ÊûÑ‰ªãÁªç‚Äã Âú®‰ªãÁªç‰ΩøÁî®ZookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ‰πãÂâçÔºåÈ¶ñÂÖàÁúãÂΩìÂâçÁöÑÁ≥ªÁªüÊû∂ÊûÑÂõæ ‚Äã ‚Äã Ëß£ÈáäÔºö Â∑¶ËæπÁöÑÊï¥‰∏™Âå∫ÂüüË°®Á§∫‰∏Ä‰∏™ZookeeperÈõÜÁæ§ÔºålockerÊòØZookeeperÁöÑ‰∏Ä‰∏™ÊåÅ‰πÖËäÇÁÇπÔºånode_1„ÄÅnode_2„ÄÅnode_3ÊòØlockerËøô‰∏™ÊåÅ‰πÖËäÇÁÇπ‰∏ãÈù¢ÁöÑ‰∏¥Êó∂È°∫Â∫èËäÇÁÇπ„ÄÇclient_1„ÄÅclient_2„ÄÅclient_nË°®Á§∫Â§ö‰∏™ÂÆ¢Êà∑Á´ØÔºåServiceË°®Á§∫ÈúÄË¶Å‰∫íÊñ•ËÆøÈóÆÁöÑÂÖ±‰∫´ËµÑÊ∫ê„ÄÇ ‰∏â„ÄÅÂàÜÂ∏ÉÂºèÈîÅËé∑ÂèñÊÄùË∑Ø‚Äã 1ÔºéËé∑ÂèñÂàÜÂ∏ÉÂºèÈîÅÁöÑÊÄª‰ΩìÊÄùË∑Ø ‚Äã Âú®Ëé∑ÂèñÂàÜÂ∏ÉÂºèÈîÅÁöÑÊó∂ÂÄôÂú®lockerËäÇÁÇπ‰∏ãÂàõÂª∫‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÔºåÈáäÊîæÈîÅÁöÑÊó∂ÂÄôÂà†Èô§ËØ•‰∏¥Êó∂ËäÇÁÇπ„ÄÇÂÆ¢Êà∑Á´ØË∞ÉÁî®createNodeÊñπÊ≥ïÂú®locker‰∏ãÂàõÂª∫‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÔºå ÁÑ∂ÂêéË∞ÉÁî®getChildren(‚Äúlocker‚Äù)Êù•Ëé∑Âèñlocker‰∏ãÈù¢ÁöÑÊâÄÊúâÂ≠êËäÇÁÇπÔºåÊ≥®ÊÑèÊ≠§Êó∂‰∏çÁî®ËÆæÁΩÆ‰ªª‰ΩïWatcher„ÄÇÂÆ¢Êà∑Á´ØËé∑ÂèñÂà∞ÊâÄÊúâÁöÑÂ≠êËäÇÁÇπpath‰πãÂêéÔºåÂ¶ÇÊûúÂèëÁé∞Ëá™Â∑±Âú®‰πã ÂâçÂàõÂª∫ÁöÑÂ≠êËäÇÁÇπÂ∫èÂè∑ÊúÄÂ∞èÔºåÈÇ£‰πàÂ∞±ËÆ§‰∏∫ËØ•ÂÆ¢Êà∑Á´ØËé∑ÂèñÂà∞‰∫ÜÈîÅ„ÄÇÂ¶ÇÊûúÂèëÁé∞Ëá™Â∑±ÂàõÂª∫ÁöÑËäÇÁÇπÂπ∂ÈùûlockerÊâÄÊúâÂ≠êËäÇÁÇπ‰∏≠ÊúÄÂ∞èÁöÑÔºåËØ¥ÊòéËá™Â∑±ËøòÊ≤°ÊúâËé∑ÂèñÂà∞ÈîÅÔºå Ê≠§Êó∂ÂÆ¢Êà∑Á´ØÈúÄË¶ÅÊâæÂà∞ÊØîËá™Â∑±Â∞èÁöÑÈÇ£‰∏™ËäÇÁÇπÔºåÁÑ∂ÂêéÂØπÂÖ∂Ë∞ÉÁî®exist()ÊñπÊ≥ïÔºåÂêåÊó∂ÂØπÂÖ∂Ê≥®ÂÜå‰∫ã‰ª∂ÁõëÂê¨Âô®„ÄÇ‰πãÂêéÔºåËÆ©Ëøô‰∏™Ë¢´ÂÖ≥Ê≥®ÁöÑËäÇÁÇπÂà†Èô§ÔºåÂàôÂÆ¢Êà∑Á´ØÁöÑWatcher‰ºö Êî∂Âà∞Áõ∏Â∫îÈÄöÁü•ÔºåÊ≠§Êó∂ÂÜçÊ¨°Âà§Êñ≠Ëá™Â∑±ÂàõÂª∫ÁöÑËäÇÁÇπÊòØÂê¶ÊòØlockerÂ≠êËäÇÁÇπ‰∏≠Â∫èÂè∑ÊúÄÂ∞èÁöÑÔºåÂ¶ÇÁöãÊòØÂàôËé∑ÂèñÂà∞‰∫ÜÈîÅÔºåÂ¶ÇÊûú‰∏çÊòØÂàôÈáçÂ§ç‰ª•‰∏äÊ≠•È™§ÁªßÁª≠Ëé∑ÂèñÂà∞ÊØîËá™Â∑±Â∞èÁöÑ‰∏Ä‰∏™ ËäÇÁÇπÂπ∂Ê≥®ÂÜåÁõëÂê¨„ÄÇÂΩìÂâçËøô‰∏™ËøáÁ®ã‰∏≠ËøòÈúÄË¶ÅËÆ∏Â§öÁöÑÈÄªËæëÂà§Êñ≠„ÄÇ 2ÔºéËé∑ÂèñÂàÜÂ∏ÉÂºèÈîÅÁöÑÊ†∏ÂøÉÁÆóÊ≥ïÊµÅÁ®ã ‚Äã ‰∏ãÈù¢Âêå‰∏™‰∏Ä‰∏™ÊµÅÁ®ãÂõæÊù•ÂàÜÊûêËé∑ÂèñÂàÜÂ∏ÉÂºèÈîÅÁöÑÂÆåÊï¥ÁÆóÊ≥ïÔºåÂ¶Ç‰∏ãÔºö‚Äã ‚Äã https://img-blog.csdn.net/20160716210945194?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center ‚Äã Ëß£ÈáäÔºöÂÆ¢Êà∑Á´ØAË¶ÅËé∑ÂèñÂàÜÂ∏ÉÂºèÈîÅÁöÑÊó∂ÂÄôÈ¶ñÂÖàÂà∞locker‰∏ãÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÔºànode_nÔºâÔºåÁÑ∂ÂêéÁ´ãÂç≥Ëé∑Âèñlocker‰∏ãÁöÑÊâÄÊúâÔºà‰∏ÄÁ∫ßÔºâÂ≠êËäÇÁÇπ„ÄÇ Ê≠§Êó∂Âõ†‰∏∫‰ºöÊúâÂ§ö‰∏™ÂÆ¢Êà∑Á´ØÂêå‰∏ÄÊó∂Èó¥‰∫âÂèñÈîÅÔºåÂõ†Ê≠§locker‰∏ãÁöÑÂ≠êËäÇÁÇπÊï∞ÈáèÂ∞±‰ºöÂ§ß‰∫é1„ÄÇÂØπ‰∫éÈ°∫Â∫èËäÇÁÇπÔºåÁâπÁÇπÊòØËäÇÁÇπÂêçÁß∞ÂêéÈù¢Ëá™Âä®Êúâ‰∏Ä‰∏™Êï∞Â≠óÁºñÂè∑Ôºå ÂÖàÂàõÂª∫ÁöÑËäÇÁÇπÊï∞Â≠óÁºñÂè∑Â∞è‰∫éÂêéÂàõÂª∫ÁöÑÔºåÂõ†Ê≠§ÂèØ‰ª•Â∞ÜÂ≠êËäÇÁÇπÊåâÁÖßËäÇÁÇπÂêçÁß∞ÂêéÁºÄÁöÑÊï∞Â≠óÈ°∫Â∫è‰ªéÂ∞èÂà∞Â§ßÊéíÂ∫èÔºåËøôÊ†∑ÊéíÂú®Á¨¨‰∏Ä‰ΩçÁöÑÂ∞±ÊòØÊúÄÂÖàÂàõÂª∫ÁöÑÈ°∫Â∫èËäÇÁÇπÔºå Ê≠§Êó∂ÂÆÉÂ∞±‰ª£Ë°®‰∫ÜÊúÄÂÖà‰∫âÂèñÂà∞ÈîÅÁöÑÂÆ¢Êà∑Á´ØÔºÅÊ≠§Êó∂Âà§Êñ≠ÊúÄÂ∞èÁöÑËøô‰∏™ËäÇÁÇπÊòØÂê¶‰∏∫ÂÆ¢Êà∑Á´ØA‰πãÂâçÂàõÂª∫Âá∫Êù•ÁöÑnode_nÔºåÂ¶ÇÊûúÊòØÂàôË°®Á§∫ÂÆ¢Êà∑Á´ØAËé∑ÂèñÂà∞‰∫ÜÈîÅÔºå Â¶ÇÊûú‰∏çÊòØÂàôË°®Á§∫ÈîÅÂ∑≤ÁªèË¢´ÂÖ∂ÂÆÉÂÆ¢Êà∑Á´ØËé∑ÂèñÔºåÂõ†Ê≠§ÂÆ¢Êà∑Á´ØAË¶ÅÁ≠âÂæÖÂÆÉÈáäÊîæÈîÅÔºå‰πüÂ∞±ÊòØÁ≠âÂæÖËé∑ÂèñÂà∞ÈîÅÁöÑÈÇ£‰∏™ÂÆ¢Êà∑Á´ØBÊääËá™Â∑±ÂàõÂª∫ÁöÑÈÇ£‰∏™ËäÇÁÇπÂà†Èô§„ÄÇ Ê≠§Êó∂Â∞±ÈÄöËøáÁõëÂê¨ÊØînode_nÊ¨°Â∞èÁöÑÈÇ£‰∏™È°∫Â∫èËäÇÁÇπÁöÑÂà†Èô§‰∫ã‰ª∂Êù•Áü•ÈÅìÂÆ¢Êà∑Á´ØBÊòØÂê¶Â∑≤ÁªèÈáäÊîæ‰∫ÜÈîÅÔºåÂ¶ÇÊûúÊòØÔºåÊ≠§Êó∂ÂÆ¢Êà∑Á´ØAÂÜçÊ¨°Ëé∑Âèñlocker‰∏ãÁöÑÊâÄÊúâÂ≠êËäÇÁÇπÔºå ÂÜçÊ¨°‰∏éËá™Â∑±ÂàõÂª∫ÁöÑnode_nËäÇÁÇπÂØπÊØîÔºåÁõ¥Âà∞Ëá™Â∑±ÂàõÂª∫ÁöÑnode_nÊòØlockerÁöÑÊâÄÊúâÂ≠êËäÇÁÇπ‰∏≠È°∫Â∫èÂè∑ÊúÄÂ∞èÁöÑÔºåÊ≠§Êó∂Ë°®Á§∫ÂÆ¢Êà∑Á´ØAËé∑ÂèñÂà∞‰∫ÜÈîÅÔºÅ Âõõ„ÄÅÂü∫‰∫éZookeeperÁöÑÂàÜÂ∏ÉÂºèÈîÅÁöÑ‰ª£Á†ÅÂÆûÁé∞1ÔºéÂÆö‰πâÂàÜÂ∏ÉÂºèÈîÅÊé•Âè£‚Äã ÂÆö‰πâÁöÑÂàÜÂ∏ÉÂºèÈîÅÊé•Âè£Â¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839public interface DistributedLock &#123; /**Ëé∑ÂèñÈîÅÔºåÂ¶ÇÊûúÊ≤°ÊúâÂæóÂà∞Â∞±Á≠âÂæÖ*/ public void acquire() throws Exception; /** * Ëé∑ÂèñÈîÅÔºåÁõ¥Âà∞Ë∂ÖÊó∂ * @param timeË∂ÖÊó∂Êó∂Èó¥ * @param unit timeÂèÇÊï∞ÁöÑÂçï‰Ωç * @returnÊòØÂê¶Ëé∑ÂèñÂà∞ÈîÅ * @throws Exception */ public boolean acquire (long time, TimeUnit unit) throws Exception; /** * ÈáäÊîæÈîÅ * @throws Exception */ public void release() throws Exception;&#125; ‚Äã 2ÔºéÂÆö‰πâ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰∫íÊñ•ÈîÅ‚Äã ÂÆö‰πâ‰∏Ä‰∏™‰∫íÊñ•ÈîÅÁ±ªÔºåÂÆûÁé∞‰ª•‰∏äÂÆö‰πâÁöÑÈîÅÊé•Âè£ÔºåÂêåÊó∂ÁªßÊâø‰∏Ä‰∏™Âü∫Á±ªBaseDistributedLockÔºåËØ•Âü∫Á±ª‰∏ªË¶ÅÁî®‰∫é‰∏éZookeeper‰∫§‰∫íÔºå ‚Äã ÂåÖÂê´‰∏Ä‰∏™Â∞ùËØïËé∑ÂèñÈîÅÁöÑÊñπÊ≥ïÂíå‰∏Ä‰∏™ÈáäÊîæÈîÅ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117/**ÈîÅÊé•Âè£ÁöÑÂÖ∑‰ΩìÂÆûÁé∞Ôºå‰∏ªË¶ÅÂÄüÂä©‰∫éÁªßÊâøÁöÑÁà∂Á±ªBaseDistributedLockÊù•ÂÆûÁé∞ÁöÑÊé•Âè£ÊñπÊ≥ï * ËØ•Áà∂Á±ªÊòØÂü∫‰∫éZookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÁöÑÂÖ∑‰ΩìÁªÜËäÇÂÆûÁé∞*/public class SimpleDistributedLockMutex extends BaseDistributedLock implements DistributedLock &#123; /*Áî®‰∫é‰øùÂ≠òZookeeper‰∏≠ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÁöÑËäÇÁÇπÔºåÂ¶ÇÂêçÁß∞‰∏∫lockerÔºö/lockerÔºå *ËØ•ËäÇÁÇπÂ∫îËØ•ÊòØÊåÅ‰πÖËäÇÁÇπÔºåÂú®ËØ•ËäÇÁÇπ‰∏ãÈù¢ÂàõÂª∫‰∏¥Êó∂È°∫Â∫èËäÇÁÇπÊù•ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ */ private final String basePath; /*ÈîÅÂêçÁß∞ÂâçÁºÄÔºålocker‰∏ãÂàõÂª∫ÁöÑÈ°∫Â∫èËäÇÁÇπ‰æãÂ¶ÇÈÉΩ‰ª•lock-ÂºÄÂ§¥ÔºåËøôÊ†∑‰æø‰∫éËøáÊª§Êó†ÂÖ≥ËäÇÁÇπ *ËøôÊ†∑ÂàõÂª∫ÂêéÁöÑËäÇÁÇπÁ±ª‰ººÔºölock-00000001Ôºålock-000000002*/ private staticfinal String LOCK_NAME ="lock-"; /*Áî®‰∫é‰øùÂ≠òÊüê‰∏™ÂÆ¢Êà∑Á´ØÂú®locker‰∏ãÈù¢ÂàõÂª∫ÊàêÂäüÁöÑÈ°∫Â∫èËäÇÁÇπÔºåÁî®‰∫éÂêéÁª≠Áõ∏ÂÖ≥Êìç‰Ωú‰ΩøÁî®ÔºàÂ¶ÇÂà§Êñ≠Ôºâ*/ private String ourLockPath; /** * Áî®‰∫éËé∑ÂèñÈîÅËµÑÊ∫êÔºåÈÄöËøáÁà∂Á±ªÁöÑËé∑ÂèñÈîÅÊñπÊ≥ïÊù•Ëé∑ÂèñÈîÅ * @param timeËé∑ÂèñÈîÅÁöÑË∂ÖÊó∂Êó∂Èó¥ * @param unit timeÁöÑÊó∂Èó¥Âçï‰Ωç * @returnÊòØÂê¶Ëé∑ÂèñÂà∞ÈîÅ * @throws Exception */ private boolean internalLock (long time, TimeUnit unit) throws Exception &#123; //Â¶ÇÊûúourLockPath‰∏ç‰∏∫Á©∫ÂàôËÆ§‰∏∫Ëé∑ÂèñÂà∞‰∫ÜÈîÅÔºåÂÖ∑‰ΩìÂÆûÁé∞ÁªÜËäÇËßÅattemptLockÁöÑÂÆûÁé∞ ourLockPath = attemptLock(time, unit); return ourLockPath !=null; &#125; /** * ‰º†ÂÖ•ZookeeperÂÆ¢Êà∑Á´ØËøûÊé•ÂØπË±°ÔºåÂíåbasePath * @param client ZookeeperÂÆ¢Êà∑Á´ØËøûÊé•ÂØπË±° * @param basePath basePathÊòØ‰∏Ä‰∏™ÊåÅ‰πÖËäÇÁÇπ */ public SimpleDistributedLockMutex(ZkClientExt client, String basePath)&#123; /*Ë∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂú®Zookeeper‰∏≠ÂàõÂª∫basePathËäÇÁÇπÔºåÂπ∂‰∏î‰∏∫basePathËäÇÁÇπÂ≠êËäÇÁÇπËÆæÁΩÆÂâçÁºÄ *ÂêåÊó∂‰øùÂ≠òbasePathÁöÑÂºïÁî®ÁªôÂΩìÂâçÁ±ªÂ±ûÊÄß*/ super(client,basePath,LOCK_NAME); this.basePath = basePath; &#125; /**Ëé∑ÂèñÈîÅÔºåÁõ¥Âà∞Ë∂ÖÊó∂ÔºåË∂ÖÊó∂ÂêéÊäõÂá∫ÂºÇÂ∏∏*/ public void acquire() throws Exception &#123; //-1Ë°®Á§∫‰∏çËÆæÁΩÆË∂ÖÊó∂Êó∂Èó¥ÔºåË∂ÖÊó∂Áî±ZookeeperÂÜ≥ÂÆö if (!internalLock(-1,null))&#123; throw new IOException("ËøûÊé•‰∏¢Â§±!Âú®Ë∑ØÂæÑ:'"+basePath+"'‰∏ã‰∏çËÉΩËé∑ÂèñÈîÅ!"); &#125; &#125; /** * Ëé∑ÂèñÈîÅÔºåÂ∏¶ÊúâË∂ÖÊó∂Êó∂Èó¥ */ public boolean acquire(long time, TimeUnit unit) throws Exception &#123; return internalLock(time, unit); &#125; /**ÈáäÊîæÈîÅ*/ public void release()throws Exception &#123; releaseLock(ourLockPath); &#125;&#125; ‚Äã 3. ÂàÜÂ∏ÉÂºèÈîÅÁöÑÂÆûÁé∞ÁªÜËäÇËé∑ÂèñÂàÜÂ∏ÉÂºèÈîÅÁöÑÈáçÁÇπÈÄªËæëÂú®‰∫éBaseDistributedLockÔºåÂÆûÁé∞‰∫ÜÂü∫‰∫éZookeeperÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÁöÑÁªÜËäÇ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189public class BaseDistributedLock &#123; private final ZkClientExt client; private final String path; private final String basePath; private final String lockName; private static final Integer MAX_RETRY_COUNT = 10; public BaseDistributedLock(ZkClientExt client, String path, String lockName)&#123; this.client = client; this.basePath = path; this.path = path.concat("/").concat(lockName); this.lockName = lockName; &#125; private void deleteOurPath(String ourPath) throws Exception&#123; client.delete(ourPath); &#125; private String createLockNode(ZkClient client, String path) throws Exception&#123; return client.createEphemeralSequential(path, null); &#125; /** * Ëé∑ÂèñÈîÅÁöÑÊ†∏ÂøÉÊñπÊ≥ï * @param startMillis * @param millisToWait * @param ourPath * @return * @throws Exception */ private boolean waitToLock(long startMillis, Long millisToWait, String ourPath) throws Exception&#123; boolean haveTheLock = false; boolean doDelete = false; try&#123; while ( !haveTheLock ) &#123; //ËØ•ÊñπÊ≥ïÂÆûÁé∞Ëé∑ÂèñlockerËäÇÁÇπ‰∏ãÁöÑÊâÄÊúâÈ°∫Â∫èËäÇÁÇπÔºåÂπ∂‰∏î‰ªéÂ∞èÂà∞Â§ßÊéíÂ∫è List&lt;String&gt; children = getSortedChildren(); String sequenceNodeName = ourPath.substring(basePath.length()+1); //ËÆ°ÁÆóÂàöÊâçÂÆ¢Êà∑Á´ØÂàõÂª∫ÁöÑÈ°∫Â∫èËäÇÁÇπÂú®lockerÁöÑÊâÄÊúâÂ≠êËäÇÁÇπ‰∏≠ÊéíÂ∫è‰ΩçÁΩÆÔºåÂ¶ÇÊûúÊòØÊéíÂ∫è‰∏∫0ÔºåÂàôË°®Á§∫Ëé∑ÂèñÂà∞‰∫ÜÈîÅ int ourIndex = children.indexOf(sequenceNodeName); /*Â¶ÇÊûúÂú®getSortedChildren‰∏≠Ê≤°ÊúâÊâæÂà∞‰πãÂâçÂàõÂª∫ÁöÑ[‰∏¥Êó∂]È°∫Â∫èËäÇÁÇπÔºåËøôË°®Á§∫ÂèØËÉΩÁî±‰∫éÁΩëÁªúÈó™Êñ≠ËÄåÂØºËá¥ *ZookeeperËÆ§‰∏∫ËøûÊé•Êñ≠ÂºÄËÄåÂà†Èô§‰∫ÜÊàë‰ª¨ÂàõÂª∫ÁöÑËäÇÁÇπÔºåÊ≠§Êó∂ÈúÄË¶ÅÊäõÂá∫ÂºÇÂ∏∏ÔºåËÆ©‰∏ä‰∏ÄÁ∫ßÂéªÂ§ÑÁêÜ *‰∏ä‰∏ÄÁ∫ßÁöÑÂÅöÊ≥ïÊòØÊçïËé∑ËØ•ÂºÇÂ∏∏ÔºåÂπ∂‰∏îÊâßË°åÈáçËØïÊåáÂÆöÁöÑÊ¨°Êï∞ ËßÅÂêéÈù¢ÁöÑ attemptLockÊñπÊ≥ï */ if ( ourIndex&lt;0 )&#123; throw new ZkNoNodeException("ËäÇÁÇπÊ≤°ÊúâÊâæÂà∞: " + sequenceNodeName); &#125; //Â¶ÇÊûúÂΩìÂâçÂÆ¢Êà∑Á´ØÂàõÂª∫ÁöÑËäÇÁÇπÂú®lockerÂ≠êËäÇÁÇπÂàóË°®‰∏≠‰ΩçÁΩÆÂ§ß‰∫é0ÔºåË°®Á§∫ÂÖ∂ÂÆÉÂÆ¢Êà∑Á´ØÂ∑≤ÁªèËé∑Âèñ‰∫ÜÈîÅ //Ê≠§Êó∂ÂΩìÂâçÂÆ¢Êà∑Á´ØÈúÄË¶ÅÁ≠âÂæÖÂÖ∂ÂÆÉÂÆ¢Êà∑Á´ØÈáäÊîæÈîÅÔºå boolean isGetTheLock = ourIndex == 0; //Â¶Ç‰ΩïÂà§Êñ≠ÂÖ∂ÂÆÉÂÆ¢Êà∑Á´ØÊòØÂê¶Â∑≤ÁªèÈáäÊîæ‰∫ÜÈîÅÔºü‰ªéÂ≠êËäÇÁÇπÂàóË°®‰∏≠Ëé∑ÂèñÂà∞ÊØîËá™Â∑±Ê¨°Â∞èÁöÑÂì™‰∏™ËäÇÁÇπÔºåÂπ∂ÂØπÂÖ∂Âª∫Á´ãÁõëÂê¨ String pathToWatch = isGetTheLock ? null : children.get(ourIndex - 1); if ( isGetTheLock )&#123; haveTheLock = true; &#125;else&#123; //Â¶ÇÊûúÊ¨°Â∞èÁöÑËäÇÁÇπË¢´Âà†Èô§‰∫ÜÔºåÂàôË°®Á§∫ÂΩìÂâçÂÆ¢Êà∑Á´ØÁöÑËäÇÁÇπÂ∫îËØ•ÊòØÊúÄÂ∞èÁöÑ‰∫ÜÔºåÊâÄ‰ª•‰ΩøÁî®CountDownLatchÊù•ÂÆûÁé∞Á≠âÂæÖ String previousSequencePath = basePath .concat( "/" ) .concat( pathToWatch ); final CountDownLatch latch = new CountDownLatch(1); final IZkDataListener previousListener = new IZkDataListener() &#123; //Ê¨°Â∞èËäÇÁÇπÂà†Èô§‰∫ã‰ª∂ÂèëÁîüÊó∂ÔºåËÆ©countDownLatchÁªìÊùüÁ≠âÂæÖ //Ê≠§Êó∂ËøòÈúÄË¶ÅÈáçÊñ∞ËÆ©Á®ãÂ∫èÂõûÂà∞whileÔºåÈáçÊñ∞Âà§Êñ≠‰∏ÄÊ¨°ÔºÅ public void handleDataDeleted(String dataPath) throws Exception &#123; latch.countDown(); &#125; public void handleDataChange(String dataPath, Object data) throws Exception &#123; // ignore &#125; &#125;; try&#123; //Â¶ÇÊûúËäÇÁÇπ‰∏çÂ≠òÂú®‰ºöÂá∫Áé∞ÂºÇÂ∏∏ client.subscribeDataChanges(previousSequencePath, previousListener); if ( millisToWait != null )&#123; millisToWait -= (System.currentTimeMillis() - startMillis); startMillis = System.currentTimeMillis(); if ( millisToWait &lt;= 0 )&#123; doDelete = true; // timed out - delete our node break; &#125; latch.await(millisToWait, TimeUnit.MICROSECONDS); &#125;else&#123; latch.await(); &#125; &#125;catch ( ZkNoNodeException e )&#123; //ignore &#125;finally&#123; client.unsubscribeDataChanges(previousSequencePath, previousListener); &#125; &#125; &#125; &#125;catch ( Exception e )&#123; //ÂèëÁîüÂºÇÂ∏∏ÈúÄË¶ÅÂà†Èô§ËäÇÁÇπ doDelete = true; throw e; &#125;finally&#123; //Â¶ÇÊûúÈúÄË¶ÅÂà†Èô§ËäÇÁÇπ if ( doDelete )&#123; deleteOurPath(ourPath); &#125; &#125; return haveTheLock; &#125; private String getLockNodeNumber(String str, String lockName) &#123; int index = str.lastIndexOf(lockName); if ( index &gt;= 0 )&#123; index += lockName.length(); return index &lt;= str.length() ? str.substring(index) : ""; &#125; return str; &#125; private List&lt;String&gt; getSortedChildren() throws Exception &#123; try&#123; List&lt;String&gt; children = client.getChildren(basePath); Collections.sort( children, new Comparator&lt;String&gt;()&#123; public int compare(String lhs, String rhs)&#123; return getLockNodeNumber(lhs, lockName).compareTo(getLockNodeNumber(rhs, lockName)); &#125; &#125; ); return children; &#125;catch(ZkNoNodeException e)&#123; client.createPersistent(basePath, true); return getSortedChildren(); &#125; &#125; protected void releaseLock(String lockPath) throws Exception&#123; deleteOurPath(lockPath); &#125; protected String attemptLock(long time, TimeUnit unit) throws Exception&#123; final long startMillis = System.currentTimeMillis(); final Long millisToWait = (unit != null) ? unit.toMillis(time) : null; String ourPath = null; boolean hasTheLock = false; boolean isDone = false; int retryCount = 0; //ÁΩëÁªúÈó™Êñ≠ÈúÄË¶ÅÈáçËØï‰∏ÄËØï while ( !isDone )&#123; isDone = true; try&#123; //createLockNodeÁî®‰∫éÂú®lockerÔºàbasePathÊåÅ‰πÖËäÇÁÇπÔºâ‰∏ãÂàõÂª∫ÂÆ¢Êà∑Á´ØË¶ÅËé∑ÂèñÈîÅÁöÑ[‰∏¥Êó∂]È°∫Â∫èËäÇÁÇπ ourPath = createLockNode(client, path); /** * ËØ•ÊñπÊ≥ïÁî®‰∫éÂà§Êñ≠Ëá™Â∑±ÊòØÂê¶Ëé∑ÂèñÂà∞‰∫ÜÈîÅÔºåÂç≥Ëá™Â∑±ÂàõÂª∫ÁöÑÈ°∫Â∫èËäÇÁÇπÂú®lockerÁöÑÊâÄÊúâÂ≠êËäÇÁÇπ‰∏≠ÊòØÂê¶ÊúÄÂ∞è * Â¶ÇÊûúÊ≤°ÊúâËé∑ÂèñÂà∞ÈîÅÔºåÂàôÁ≠âÂæÖÂÖ∂ÂÆÉÂÆ¢Êà∑Á´ØÈîÅÁöÑÈáäÊîæÔºåÂπ∂‰∏îÁ®çÂêéÈáçËØïÁõ¥Âà∞Ëé∑ÂèñÂà∞ÈîÅÊàñËÄÖË∂ÖÊó∂ */ hasTheLock = waitToLock(startMillis, millisToWait, ourPath); &#125;catch ( ZkNoNodeException e )&#123; if ( retryCount++ &lt; MAX_RETRY_COUNT )&#123; isDone = false; &#125;else&#123; throw e; &#125; &#125; &#125; if ( hasTheLock )&#123; return ourPath; &#125; return nullÔºõÔΩù]]></content>
      <categories>
        <category>zookeeper</category>
      </categories>
      <tags>
        <tag>ÂàÜÂ∏ÉÂºèÈîÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî®redisÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÂÆûË∑µ]]></title>
    <url>%2F2018%2F05%2F06%2F%E4%BD%BF%E7%94%A8redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[ÂàÜÂ∏ÉÂºèÈîÅÂú®Â§öÂÆû‰æãÈÉ®ÁΩ≤,ÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁªèÂ∏∏‰ºö‰ΩøÁî®Âà∞,ËøôÊòØÂõ†‰∏∫Âü∫‰∫éjvmÁöÑÈîÅÊó†Ê≥ïÊª°Ë∂≥Â§öÂÆû‰æã‰∏≠ÈîÅÁöÑÈúÄÊ±Ç,Êú¨ÁØáÂ∞ÜËÆ≤‰∏ãredisÂ¶Ç‰ΩïÈÄöËøáLuaËÑöÊú¨ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅ,‰∏çÂêå‰∫éÁΩë‰∏äÁöÑredission,ÂÆåÂÖ®ÊòØÊâãÂä®ÂÆûÁé∞ÁöÑ Êàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏™Êó†ÈîÅÁöÑÊÉÖÂÜµ‰∏ã‰ºöÂØºËá¥‰ªÄ‰πàÈóÆÈ¢ò: ËøôÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÊõ¥Êñ∞Áî®Êà∑Âπ¥ÈæÑÁöÑÂäüËÉΩ,ÂêÑÂ±Ç‰ª£Á†ÅÂ¶Ç‰∏ã,ËÆøÈóÆcontrollerÂ±Ç,‰∏Ä‰∏™Êõ¥Êñ∞,‰∏Ä‰∏™Êü•ËØ¢ ËøôÊòØserviceÂ±Ç,Êàë‰ª¨‰ΩøÁî®contdownlatchÂèë‰ª§Êû™Êù•Ê®°ÊãüÁ∫øÁ®ãÂêåÊó∂Âπ∂ÂèëÁöÑÊÉÖÂÜµ,Âèë‰ª§Êû™ËÆæ‰∏∫32,Âç≥32‰∏™Á∫øÁ®ãÂêåÊó∂ÂéªËØ∑Ê±Ç‰øÆÊîπÂπ¥ÈæÑ, ËøôÈáå‰ΩøÁî®Á∫øÁ®ãÊ±†Êù•Êèê‰∫§Â§öÁ∫øÁ®ã‰ªªÂä°,Áúã‰ª£Á†ÅÁü•ÈÅì,ËøôÈáåÊàë‰ª¨Â∑≤ÁªèÊúâ‰∫ÜÂà§Êñ≠Âπ¥ÈæÑÁöÑÊìç‰Ωú,ÂΩìÊü•ËØ¢Áî®Êà∑Êü•ËØ¢Â§ß‰∫é0Êó∂,ÊâçÂéªË∞ÉÊõ¥Êñ∞Áî®Êà∑Âπ¥ÈæÑ-1ÁöÑÊñπÊ≥ï,Á≠â‰∏ãÁúãÁúãÊúâÊ≤°ÊúâÁî® ËøôÈáåÊòØsql,ÂèØ‰ª•ÁúãÂà∞‰∏§‰∏™sql,‰∏Ä‰∏™Êü•ËØ¢Áî®Êà∑Âπ¥ÈæÑ,‰∏Ä‰∏™‰ºöÊâßË°åÁî®Êà∑Âπ¥ÈæÑÊØèÊ¨°Âáè1 , ËøôÈáåÊòØÁî®Êà∑Êï∞ÊçÆ,Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞,Áî®Êà∑UID‰∏∫UR12324ÁöÑÁî®Êà∑,‰ªñÁöÑÂπ¥ÈæÑÊòØ30,Êé•ÁùÄÊàë‰ª¨Êù•Ë∞É32‰∏™Á∫øÁ®ãÊù•Êìç‰ΩúÂáè‰ªñÂπ¥ÈæÑ Êàë‰ª¨ËØ∑Ê±Ç‰∏ãËøô‰∏™ÊñπÊ≥ï ÁÑ∂ÂêéÁúãÁúãÁªìÊûú: ÂèØ‰ª•ÁúãÂà∞Â∫ì‰∏≠Âπ¥ÈæÑÂ∑≤Ë¢´Âáè‰∏∫-2,Âú®Êú™Âä†ÈîÅÁöÑÊÉÖÂÜµ‰∏ã,Êü•ËØ¢ËæÉÈ™åÂπ∂Ê≤°Êúâ‰ªÄ‰πà‰ΩúÁî®,Ê≠§Êó∂Â¶ÇÊûúÂä†‰∏™synchronizedÊàñlockÈîÅËÇØÂÆöËÉΩÈÅøÂÖçËøôÁßçÊÉÖÂÜµ,‰ΩÜÊàë‰ª¨Êú¨ÊñáËÆ®ËÆ∫ÁöÑÊòØÂ§öÂÆû‰æãÊàñÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏≠,Ê≠§Âä†ÈîÅÊñπÂºè‰ªçÁÑ∂‰ºö‰∫ßÁîüÈóÆÈ¢ò,ÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•ËØï‰∏ãÊòØ‰∏çÊòØ ‰∏ãÈù¢Êàë‰ª¨ÂºÄÂßãÂÆûÁé∞‰∏Ä‰∏™redisÂàÜÂ∏ÉÂºèÈîÅ,Êù•ÈÅøÂÖçËøôÁßçÊÉÖÂÜµÂèëÁîü,ÂÖàËØ¥ËØ¥ÂÆûÁé∞ÊÄùË∑Ø: 1,Á∫øÁ®ãËØ∑Ê±ÇËÆøÈóÆÂâçÂÖàË∞ÉÁî®Âä†ÈîÅÁöÑÊñπÊ≥ï,Âä†ÈîÅÂ∞±ÂéªÈáåÁîüÊàê‰∏Ä‰∏™ÈöèÊú∫Êï∞ÂêåÊó∂‰øùÂ≠òÂú®Á∫øÁ®ãÊú¨Âú∞ÂèòÈáèÂíåredisÁöÑÊüêkey‰∏≠,Ê≠§keyËÆæÊúâÊïàÊúü‰∏∫200ms,ÂÖ∑‰ΩìÂÄºÊ†πÊçÆ‰∏öÂä°ÊâßË°åÊó∂Èó¥Ëá™Ë°åË∞ÉÊï¥,Âä†ÈîÅÊàêÂäü; 2.ÂÖ∂ÂÆÉÁ∫øÁ®ãËØïÁùÄËÆøÈóÆÊãøÂá∫ÂÆÉÊú¨Âú∞ÂèòÈáè‰∏éredis‰∏≠ÊüêkeyËøõË°åÊØîËæÉ,Â¶ÇÊûú‰∏ç‰∏ÄËá¥,ÂàôËØ¥ÊòéÊúâÈîÅ,Ê≠§Á∫øÁ®ã‰ºëÁú†‰∏ÄÊÆµÊó∂Èó¥,ÂÜçËØïÁùÄÂä†ÈîÅ; 3.Âä†ÈîÅÊàêÂäüÁöÑÁ∫øÁ®ãÂú®Êìç‰ΩúÁªìÊùüÂêéÂà†ÊéâÂÆÉÊåÅÊúâÈîÅ(Áî®luaÂÆûÁé∞,‰øùËØÅÂéüÂ≠êÊÄß,Âú®ÂÆÉÊØîÂØπÂíåÂà†Èô§ÈîÅÁöÑËøáÁ®ã‰∏≠,ÂÖ∂ÂÆÉÁ∫øÁ®ã‰∏ç‰ºöÂä†ÈîÅÊàêÂäü),ËÆ©ÂÖ∂ÂÆÉÁ∫øÁ®ãÂÜçÊ¨°Âä†ÈîÅ‰ª•ÊâßË°å‰ªªÂä°; ËØ¥Êòé:ÈîÅÁöÑÊó∂Èó¥‰∏∫200msÂèØÈ¢ÑÈò≤Á∫øÁ®ãÊåÇÊéâ‰πãÂêéÊ≠ªÈîÅ,200msÂêé‰ºöËá™Âä®ÈáäÊîæ ‰∏ãÈù¢ÁúãÁúãÊàë‰ª¨ÂÜôÁöÑÈîÅ‰ª£Á†Å: ÁâáÊÆµ1:‰ΩøÁî®redislock ÂÆûÁé∞lockÊù•Â§çÂÜôÂÆÉÁöÑÊñπÊ≥ï ÁâáÊÆµ2:ËØïÁùÄÂä†ÈîÅÁöÑÊñπÊ≥ï ÁâáÊÆµ3:Ëß£ÈîÅÊñπÊ≥ï,Ê≠§Â§ÑÈ¶ñÂÖà‰ªéÁ∫øÁ®ãÊú¨Âú∞ÂèòÈáèËé∑ÂèñÂÆÉÁöÑÈöèÊú∫Êï∞,ÁÑ∂ÂêéË∞ÉÁî®luaËÑöÊú¨,‰∏éredis‰∏≠keyÁõ∏ÊØîËæÉ,Â¶ÇÊûúÁõ∏ÂêåÂàôÂà†Èô§,Âê¶ÂàôËøîÂõû0; Ê≠§‰∏∫luaËÑöÊú¨ÊñπÊ≥ï,Áî®Ê≠§ÊñπÊ≥ïÂèØ‰ª•‰øùËØÅÂà§Êñ≠ÂíåÂà†Èô§ÁöÑÂéüÂ≠êÊÄß,Âú®Ê≠§ËøáÁ®ã‰∏≠Ê≤°ÊúâÁ∫øÁ®ãÂèØ‰ª•Êìç‰ΩúÊ≠§key Âà∞Ê≠§‰∏∫Ê≠¢,Êàë‰ª¨ÈîÅÂü∫Êú¨ÂÜôÂÆå,Êù•ÊµãËØï‰∏ãÊúâÊ≤°ÊúâÁî®: Êàë‰ª¨Âú®Ê≠§ÊñπÊ≥ïÂâçÂêéÂàÜÂà´Âä†ÂÖ•Âä†ÈîÅÂíåËß£ÈîÅÊñπÊ≥ï,‰ΩøÁî®ÊñπÂºèÂíålockÈîÅ‰∏ÄÊ†∑, Êàë‰ª¨ÈáçÊñ∞ÊääÂπ¥ÈæÑÊÅ¢Â§çÂà∞30ÂêéÊù•ÊµãËØï‰∏Ä‰∏ãÂêß ÂÖàÁúãÁúãÊó•Âøó ËøôÈáåÂèØ‰ª•ÁúãÂà∞ÂêÑ‰∏™Á∫øÁ®ã‰∫âÂ§∫ÈîÅÁöÑÊÉÖÂÜµ,ÂÜçÁúãÁúãÊâßË°åÁªìÊûú ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ËôΩÁÑ∂ÊòØ32‰∏™Á∫øÁ®ãÂπ∂ÂèëÊâßË°å,‰ΩÜÊ≠§ÂÄºÂπ∂‰∏ç‰ºöÂèò‰∏∫Ë¥üÊï∞,Âä†ÈîÅÊàêÂäü. Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÊúÄÂêé2‰∏™Á∫øÁ®ãÂπ∂Ê≤°ÊúâÊâßË°åÊñπÊ≥ï Ê≠§Êó∂ËØ¥ÊòéÂä†ÈîÅÊàêÂäü,Â§ßÂÆ∂ÂèØ‰ª•Âú®ÂàÜÂ∏ÉÂºèÁéØÂ¢É‰∏≠ÊµãËØïÊõ¥ÊòéÊòæ,ÊúâÂÖ≥ÊûÅÁ´ØÊÉÖÂÜµ‰∏ãËß£ÈîÅÂ§±Ë¥•ÂêéÂ∫îËØ•ÂÅö‰ªÄ‰πà‰πüÂèØ‰ª•Áî±Êàë‰ª¨Ëá™Â∑±ÂÜ≥ÂÆö,ÊØîredissionË¶ÅÁÅµÊ¥ª,Â∏¶ÈîÅÁöÑredisÊúÄÂ•ΩÊòØÂçïÂÆû‰æã,Âú®ÈõÜÁæ§‰∏≠ÂèØËÉΩ‰ºöÂá∫ÈóÆÈ¢ò,ÊúâÊú∫‰ºöÊàë‰ª¨ÂÜçÁî®zkÂÆûÁé∞‰∏ã.]]></content>
      <categories>
        <category>ÁºìÂ≠ò</category>
        <category>redis</category>
      </categories>
      <tags>
        <tag>ÂàÜÂ∏ÉÂºèÈîÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RateLimit‰ΩøÁî®guavaÊù•ÂÅöÊé•Âè£ÈôêÊµÅ]]></title>
    <url>%2F2018%2F04%2F25%2FRateLimit-%E4%BD%BF%E7%94%A8guava%E6%9D%A5%E5%81%9A%E6%8E%A5%E5%8F%A3%E9%99%90%E6%B5%81%2F</url>
    <content type="text"><![CDATA[‰∏Ä„ÄÅÈóÆÈ¢òÊèèËø∞ ÊüêÂ§©AÂêõÁ™ÅÁÑ∂ÂèëÁé∞Ëá™Â∑±ÁöÑÊé•Âè£ËØ∑Ê±ÇÈáèÁ™ÅÁÑ∂Ê∂®Âà∞‰πãÂâçÁöÑ10ÂÄçÔºåÊ≤°Â§ö‰πÖËØ•Êé•Âè£Âá†‰πé‰∏çÂèØ‰ΩøÁî®ÔºåÂπ∂ÂºïÂèëËøûÈîÅÂèçÂ∫îÂØºËá¥Êï¥‰∏™Á≥ªÁªüÂ¥©Ê∫É„ÄÇÂ¶Ç‰ΩïÂ∫îÂØπËøôÁßçÊÉÖÂÜµÂë¢ÔºüÁîüÊ¥ªÁªô‰∫ÜÊàë‰ª¨Á≠îÊ°àÔºöÊØîÂ¶ÇËÄÅÂºèÁîµÈó∏ÈÉΩÂÆâË£Ö‰∫Ü‰øùÈô©‰∏ùÔºå‰∏ÄÊó¶Êúâ‰∫∫‰ΩøÁî®Ë∂ÖÂ§ßÂäüÁéáÁöÑËÆæÂ§áÔºå‰øùÈô©‰∏ùÂ∞±‰ºöÁÉßÊñ≠‰ª•‰øùÊä§ÂêÑ‰∏™ÁîµÂô®‰∏çË¢´Âº∫ÁîµÊµÅÁªôÁÉßÂùè„ÄÇÂêåÁêÜÊàë‰ª¨ÁöÑÊé•Âè£‰πüÈúÄË¶ÅÂÆâË£Ö‰∏ä‚Äú‰øùÈô©‰∏ù‚ÄùÔºå‰ª•Èò≤Ê≠¢ÈùûÈ¢ÑÊúüÁöÑËØ∑Ê±ÇÂØπÁ≥ªÁªüÂéãÂäõËøáÂ§ßËÄåÂºïËµ∑ÁöÑÁ≥ªÁªüÁò´Áó™ÔºåÂΩìÊµÅÈáèËøáÂ§ßÊó∂ÔºåÂèØ‰ª•ÈááÂèñÊãíÁªùÊàñËÄÖÂºïÊµÅÁ≠âÊú∫Âà∂„ÄÇ ‰∫å„ÄÅÂ∏∏Áî®ÁöÑÈôêÊµÅÁÆóÊ≥ï‚Äã Â∏∏Áî®ÁöÑÈôêÊµÅÁÆóÊ≥ïÊúâ‰∏§ÁßçÔºöÊºèÊ°∂ÁÆóÊ≥ïÂíå‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÔºåËøôÁØáÂçöÊñá‰ªãÁªçÂæóÊØîËæÉÊ∏ÖÊô∞ÔºàËøáËΩΩ‰øùÊä§ÁÆóÊ≥ïÊµÖÊûêÔºâ„ÄÇ ‚Äã ÊºèÊ°∂ÁÆóÊ≥ïÊÄùË∑ØÂæàÁÆÄÂçïÔºåËØ∑Ê±ÇÂÖàËøõÂÖ•Âà∞ÊºèÊ°∂ÈáåÔºåÊºèÊ°∂‰ª•‰∏ÄÂÆöÁöÑÈÄüÂ∫¶Âá∫Ê∞¥ÔºåÂΩìÊ∞¥ËØ∑Ê±ÇËøáÂ§ß‰ºöÁõ¥Êé•Ê∫¢Âá∫ÔºåÂèØ‰ª•ÁúãÂá∫ÊºèÊ°∂ÁÆóÊ≥ïËÉΩÂº∫Ë°åÈôêÂà∂Êï∞ÊçÆÁöÑ‰º†ËæìÈÄüÁéá„ÄÇ Âõæ1 ÊºèÊ°∂ÁÆóÊ≥ïÁ§∫ÊÑèÂõæ ‚Äã ÂØπ‰∫éÂæàÂ§öÂ∫îÁî®Âú∫ÊôØÊù•ËØ¥ÔºåÈô§‰∫ÜË¶ÅÊ±ÇËÉΩÂ§üÈôêÂà∂Êï∞ÊçÆÁöÑÂπ≥Âùá‰º†ËæìÈÄüÁéáÂ§ñÔºåËøòË¶ÅÊ±ÇÂÖÅËÆ∏ÊüêÁßçÁ®ãÂ∫¶ÁöÑÁ™ÅÂèë‰º†Ëæì„ÄÇËøôÊó∂ÂÄôÊºèÊ°∂ÁÆóÊ≥ïÂèØËÉΩÂ∞±‰∏çÂêàÈÄÇ‰∫ÜÔºå‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÊõ¥‰∏∫ÈÄÇÂêà„ÄÇÂ¶ÇÂõæ2ÊâÄÁ§∫Ôºå‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÁöÑÂéüÁêÜÊòØÁ≥ªÁªü‰ºö‰ª•‰∏Ä‰∏™ÊÅíÂÆöÁöÑÈÄüÂ∫¶ÂæÄÊ°∂ÈáåÊîæÂÖ•‰ª§ÁâåÔºåËÄåÂ¶ÇÊûúËØ∑Ê±ÇÈúÄË¶ÅË¢´Â§ÑÁêÜÔºåÂàôÈúÄË¶ÅÂÖà‰ªéÊ°∂ÈáåËé∑Âèñ‰∏Ä‰∏™‰ª§ÁâåÔºåÂΩìÊ°∂ÈáåÊ≤°Êúâ‰ª§ÁâåÂèØÂèñÊó∂ÔºåÂàôÊãíÁªùÊúçÂä°„ÄÇ Âõæ2 ‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÁ§∫ÊÑèÂõæ ‰∏â„ÄÅÈôêÊµÅÂ∑•ÂÖ∑Á±ªRateLimiter googleÂºÄÊ∫êÂ∑•ÂÖ∑ÂåÖguavaÊèê‰æõ‰∫ÜÈôêÊµÅÂ∑•ÂÖ∑Á±ªRateLimiterÔºåËØ•Á±ªÂü∫‰∫é‚Äú‰ª§ÁâåÊ°∂ÁÆóÊ≥ï‚ÄùÔºåÈùûÂ∏∏Êñπ‰æø‰ΩøÁî®„ÄÇËØ•Á±ªÁöÑÊé•Âè£ÊèèËø∞ËØ∑ÂèÇËÄÉÔºöRateLimiterÊé•Âè£ÊèèËø∞ÔºåÂÖ∑‰ΩìÁöÑ‰ΩøÁî®ËØ∑ÂèÇËÄÉÔºöRateLimiter‰ΩøÁî®ÂÆûË∑µ„ÄÇ RateLimiter ‰ΩøÁî®Demo 1234567891011121314151617181920212223242526272829303132333435363738package ratelimite;import com.google.common.util.concurrent.RateLimiter;public class RateLimiterDemo &#123; public static void main(String[] args) &#123; testNoRateLimiter(); testWithRateLimiter(); &#125; public static void testNoRateLimiter() &#123; Long start = System.currentTimeMillis(); for (int i = 0; i &lt; 10; i++) &#123; System.out.println("call execute.." + i); &#125; Long end = System.currentTimeMillis(); System.out.println(end - start); &#125; public static void testWithRateLimiter() &#123; Long start = System.currentTimeMillis(); RateLimiter limiter = RateLimiter.create(10.0); // ÊØèÁßí‰∏çË∂ÖËøá10‰∏™‰ªªÂä°Ë¢´Êèê‰∫§ for (int i = 0; i &lt; 10; i++) &#123; limiter.acquire(); // ËØ∑Ê±ÇRateLimiter, Ë∂ÖËøápermits‰ºöË¢´ÈòªÂ°û System.out.println("call execute.." + i); &#125; Long end = System.currentTimeMillis(); System.out.println(end - start); &#125;&#125; Âõõ GuavaÂπ∂ÂèëÔºöListenableFuture‰∏éRateLimiterÁ§∫‰æãÊ¶ÇÂøµ ‚Äã ListenableFutureÈ°æÂêçÊÄù‰πâÂ∞±ÊòØÂèØ‰ª•ÁõëÂê¨ÁöÑFutureÔºåÂÆÉÊòØÂØπjavaÂéüÁîüFutureÁöÑÊâ©Â±ïÂ¢ûÂº∫„ÄÇÊàë‰ª¨Áü•ÈÅìFutureË°®Á§∫‰∏Ä‰∏™ÂºÇÊ≠•ËÆ°ÁÆó‰ªªÂä°ÔºåÂΩì‰ªªÂä°ÂÆåÊàêÊó∂ÂèØ‰ª•ÂæóÂà∞ËÆ°ÁÆóÁªìÊûú„ÄÇÂ¶ÇÊûúÊàë‰ª¨Â∏åÊúõ‰∏ÄÊó¶ËÆ°ÁÆóÂÆåÊàêÂ∞±ÊãøÂà∞ÁªìÊûúÂ±ïÁ§∫ÁªôÁî®Êà∑ÊàñËÄÖÂÅöÂè¶Â§ñÁöÑËÆ°ÁÆóÔºåÂ∞±ÂøÖÈ°ª‰ΩøÁî®Âè¶‰∏Ä‰∏™Á∫øÁ®ã‰∏çÊñ≠ÁöÑÊü•ËØ¢ËÆ°ÁÆóÁä∂ÊÄÅ„ÄÇËøôÊ†∑ÂÅöÔºå‰ª£Á†ÅÂ§çÊùÇÔºåËÄå‰∏îÊïàÁéá‰Ωé‰∏ã„ÄÇ‰ΩøÁî®ListenableFuture GuavaÂ∏ÆÊàë‰ª¨Ê£ÄÊµãFutureÊòØÂê¶ÂÆåÊàê‰∫ÜÔºåÂ¶ÇÊûúÂÆåÊàêÂ∞±Ëá™Âä®Ë∞ÉÁî®ÂõûË∞ÉÂáΩÊï∞ÔºåËøôÊ†∑ÂèØ‰ª•ÂáèÂ∞ëÂπ∂ÂèëÁ®ãÂ∫èÁöÑÂ§çÊùÇÂ∫¶„ÄÇ ‚Äã Êé®Ëçê‰ΩøÁî®Á¨¨‰∫åÁßçÊñπÊ≥ïÔºåÂõ†‰∏∫Á¨¨‰∫åÁßçÊñπÊ≥ïÂèØ‰ª•Áõ¥Êé•ÂæóÂà∞FutureÁöÑËøîÂõûÂÄºÔºåÊàñËÄÖÂ§ÑÁêÜÈîôËØØÊÉÖÂÜµ„ÄÇÊú¨Ë¥®‰∏äÁ¨¨‰∫åÁßçÊñπÊ≥ïÊòØÈÄöËøáË∞ÉÂä®Á¨¨‰∏ÄÁßçÊñπÊ≥ïÂÆûÁé∞ÁöÑÔºåÂÅö‰∫ÜËøõ‰∏ÄÊ≠•ÁöÑÂ∞ÅË£Ö„ÄÇ Âè¶Â§ñListenableFutureËøòÊúâÂÖ∂‰ªñÂá†ÁßçÂÜÖÁΩÆÂÆûÁé∞Ôºö SettableFutureÔºö‰∏çÈúÄË¶ÅÂÆûÁé∞‰∏Ä‰∏™ÊñπÊ≥ïÊù•ËÆ°ÁÆóËøîÂõûÂÄºÔºåËÄåÂè™ÈúÄË¶ÅËøîÂõû‰∏Ä‰∏™Âõ∫ÂÆöÂÄºÊù•ÂÅö‰∏∫ËøîÂõûÂÄºÔºåÂèØ‰ª•ÈÄöËøáÁ®ãÂ∫èËÆæÁΩÆÊ≠§FutureÁöÑËøîÂõûÂÄºÊàñËÄÖÂºÇÂ∏∏‰ø°ÊÅØ CheckedFutureÔºö ËøôÊòØ‰∏Ä‰∏™ÁªßÊâøËá™ListenableFutureÊé•Âè£Ôºå‰ªñÊèê‰æõ‰∫ÜcheckedGet()ÊñπÊ≥ïÔºåÊ≠§ÊñπÊ≥ïÂú®FutureÊâßË°åÂèëÁîüÂºÇÂ∏∏Êó∂ÔºåÂèØ‰ª•ÊäõÂá∫ÊåáÂÆöÁ±ªÂûãÁöÑÂºÇÂ∏∏„ÄÇ ‚Äã RateLimiterÁ±ª‰ºº‰∫éJDKÁöÑ‰ø°Âè∑ÈáèSemphoreÔºå‰ªñÁî®Êù•ÈôêÂà∂ÂØπËµÑÊ∫êÂπ∂ÂèëËÆøÈóÆÁöÑÁ∫øÁ®ãÊï∞ÔºåÊú¨Êñá‰ªãÁªçRateLimiter‰ΩøÁî® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191import java.util.concurrent.Callable;import java.util.concurrent.ExecutionException;import java.util.concurrent.Executors;import java.util.concurrent.TimeUnit;import com.google.common.util.concurrent.FutureCallback;import com.google.common.util.concurrent.Futures;import com.google.common.util.concurrent.ListenableFuture;import com.google.common.util.concurrent.ListeningExecutorService;import com.google.common.util.concurrent.MoreExecutors;import com.google.common.util.concurrent.RateLimiter;public class ListenableFutureDemo &#123; public static void main(String[] args) &#123; testRateLimiter(); testListenableFuture(); &#125; /** * RateLimiterÁ±ª‰ºº‰∫éJDKÁöÑ‰ø°Âè∑ÈáèSemphoreÔºå‰ªñÁî®Êù•ÈôêÂà∂ÂØπËµÑÊ∫êÂπ∂ÂèëËÆøÈóÆÁöÑÁ∫øÁ®ãÊï∞ */ public static void testRateLimiter() &#123; ListeningExecutorService executorService = MoreExecutors .listeningDecorator(Executors.newCachedThreadPool()); RateLimiter limiter = RateLimiter.create(5.0); // ÊØèÁßí‰∏çË∂ÖËøá4‰∏™‰ªªÂä°Ë¢´Êèê‰∫§ for (int i = 0; i &lt; 10; i++) &#123; limiter.acquire(); // ËØ∑Ê±ÇRateLimiter, Ë∂ÖËøápermits‰ºöË¢´ÈòªÂ°û final ListenableFuture&lt;Integer&gt; listenableFuture = executorService .submit(new Task("is "+ i)); &#125; &#125; public static void testListenableFuture() &#123; ListeningExecutorService executorService = MoreExecutors .listeningDecorator(Executors.newCachedThreadPool()); final ListenableFuture&lt;Integer&gt; listenableFuture = executorService .submit(new Task("testListenableFuture")); //ÂêåÊ≠•Ëé∑ÂèñË∞ÉÁî®ÁªìÊûú try &#123; System.out.println(listenableFuture.get()); &#125; catch (InterruptedException e1) &#123; e1.printStackTrace(); &#125; catch (ExecutionException e1) &#123; e1.printStackTrace(); &#125; //Á¨¨‰∏ÄÁßçÊñπÂºè listenableFuture.addListener(new Runnable() &#123; @Override public void run() &#123; try &#123; System.out.println("get listenable future's result " + listenableFuture.get()); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; catch (ExecutionException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, executorService); //Á¨¨‰∫åÁßçÊñπÂºè Futures.addCallback(listenableFuture, new FutureCallback&lt;Integer&gt;() &#123; @Override public void onSuccess(Integer result) &#123; System.out .println("get listenable future's result with callback " + result); &#125; @Override public void onFailure(Throwable t) &#123; t.printStackTrace(); &#125; &#125;); &#125;&#125;class Task implements Callable&lt;Integer&gt; &#123; String str; public Task(String str)&#123; this.str = str; &#125; @Override public Integer call() throws Exception &#123; System.out.println("call execute.." + str); TimeUnit.SECONDS.sleep(1); return 7; &#125;&#125;]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>ÈôêÊµÅ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React16 ‰ªéÈõ∂ÊâìÈÄ†ÁîµÂïÜÂêéÂè∞ÁÆ°ÁêÜÁ≥ªÁªü]]></title>
    <url>%2F2018%2F04%2F21%2FReact16-%E4%BB%8E%E9%9B%B6%E6%89%93%E9%80%A0%E7%94%B5%E5%95%86%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%2F</url>
    <content type="text"><![CDATA[Âü∫Á°ÄÁü•ËØÜ dns-prefetch ÊèêÂâçfetch charles ÊäìÂåÖ WebStorage sessionStorage 12window.sessionStorage.setItem('test',123)window.sessionStorage.getItem('test') localStorage 1window.localStorage È°πÁõÆÂàùÂßãÂåñnode v8.11.3 yarn 1.2.1 12mkdir admin-v2-feyarn init webpack1yarn add webpack@3.10.0 --dev 1yarn add webpack-dev-server 2.9.7 webpack.config.js 123456789const path = require('path');module.exports = &#123; entry: './src/app.js', output: &#123; path: path.resolve(__dirname, './dist'), filename: 'app.js' &#125;&#125;; ÊâßË°å 1./node_modules/.bin/webpack HtmlWebpackPlugin 1yarn add html-webpack-plugin@2.30.1 --dev https://webpack.docschina.org/plugins/html-webpack-plugin/#src/components/Sidebar/Sidebar.jsx 1234567891011var HtmlWebpackPlugin = require('html-webpack-plugin');var path = require('path');module.exports = &#123; entry: 'index.js', output: &#123; path: path.resolve(__dirname, './dist'), filename: 'index_bundle.js' &#125;, plugins: [new HtmlWebpackPlugin()]&#125;; babelÂ§ÑÁêÜ 12yarn add babel-core@6.26.0 --devyarn add babel-preset-env@1.6.1 babel-loader@7.1.2 --dev 1yarn add babel-preset-react@6.24.1 --dev cssÂ§ÑÁêÜ 1yarn add react@16.2.0 react-dom@16.2.0 1yarn add style-loader@0.19.1 css-loader@0.28.8 --dev index.cssÊñá‰ª∂Áã¨Á´ã https://webpack.docschina.org/plugins/extract-text-webpack-plugin/#src/components/Sidebar/Sidebar.jsx 1yarn add extract-text-webpack-plugin@3.0.2 --dev sassÂ§ÑÁêÜ 12yarn add sass-loader@6.0.6 --devyarn add node-sass@4.7.2 --dev ÊèêÂèñsassÊñá‰ª∂ https://webpack.docschina.org/plugins/extract-text-webpack-plugin/#%E6%8F%90%E5%8F%96-sass-%E6%88%96-less ÂõæÁâáÂ§ÑÁêÜ 1yarn add file-loader@1.1.6 url-loader@0.6.2 --dev Â≠ó‰ΩìÂ∫ì http://fontawesome.dashgame.com/ 1yarn add font-awesome webpack-dev server 1yarn add webpack-dev-server@2.9.7 --dev 12345678910output: &#123; path: path.resolve(__dirname, './dist'), publicPath: '/dist', filename: 'js/app.js'&#125;, // webpack-dev server devServer: &#123; &#125; 1./node_modules/.bin/webpack-dev-server package.jsonÈÖçÁΩÆËÑöÊú¨ 1234"scripts" : &#123; "dev" : "node_modules/.bin/webpack-dev-server", "dist" : "node_modules/.bin/webpack"&#125; react-router1yarn add react-router-dom@4.2.2 ÂèÇÊï∞ÂåπÈÖçÔºå/a/:id 123456789ReactDOM.render( &lt;Router&gt; &lt;Wrapper&gt; &lt;Route path="/a/:id" component=&#123;ComponentA&#125;/&gt; &lt;Route path="/b" component=&#123;ComponentB&#125;/&gt; &lt;/Wrapper&gt; &lt;/Router&gt; , document.getElementById('app')); ËØªÂèñÂèÇÊï∞ 1this.props.match.params.id bootcdnhttps://www.bootcdn.cn/]]></content>
      <categories>
        <category>ÂâçÁ´Ø</category>
        <category>react</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[hiveÂ∏∏Áî®HIVE QL]]></title>
    <url>%2F2018%2F04%2F13%2Fhive%E5%B8%B8%E7%94%A8HIVE-QL%2F</url>
    <content type="text"><![CDATA[hiveÂàõÂª∫Êï∞ÊçÆÂ∫ì 1CREATE DATABASE|SCHEMA [IF NOT EXISTS] &lt;database name&gt;;1 hiveÂàõÂª∫Ë°® hiveÈáå‰∏ÄËà¨Êúâ‰∏§ÁßçË°®ÁöÑÁªìÊûÑÔºåË°®ÂíåÂ§ñÈÉ®Ë°®Ôºå‰ª•‰∏ãÂàÜÂà´ÊòØ‰∏§ÁßçË°®ÁöÑÂàõÂª∫‰ª£Á†ÅÔºö 1234CREATE TABLE phone_info(id int,name String,storage String,price double)ROW FORMAT DELIMITED //‰ª£Ë°®‰∏ÄË°åÊòØ‰∏ÄÊù°ËÆ∞ÂΩïFIELDS TERMINATED BY '\t'//ÂàóÊòØÊåâÁÖßtableÈîÆÂàÜÂºÄSTORED AS TEXTFILE[SEQUENCEFILE];//‰∫åÁßçÊúÄÂ∏∏ËßÅÁöÑÂ≠òÂÇ®Ê†ºÂºèÔºå‰∏ÄËà¨ÂèØ‰ª•‰∏çÂÜô1234 12345CREATE EXTERNAL TABLE phone_external(id int,name String,price double)ROW FORMAT DELIMITEDFIELDS TERMINATED BY '\t'STORED AS TEXTFILELOCATION '&lt;/xudong/phone.txt&gt;';//ËøôÈáåÂ°´ÂÜôÂ§ñÈÉ®Ë°®Êï∞ÊçÆÁöÑhdfsÂú∞ÂùÄ12345 hiveË°®‰∏≠ÂØºÂÖ•Êï∞ÊçÆ hiveË°®‰∏≠ÂØºÂÖ•Êï∞ÊçÆÊúâÂõõÁßçÂ∏∏ËßÅÁöÑÊñπÂºèÔºöÔºà1Ôºâ‰ªéÊú¨Âú∞Êñá‰ª∂Á≥ªÁªü‰∏≠ÂØºÂÖ•Âà∞hiveË°®ÂÅáËÆæÊú¨Âú∞Êñá‰ª∂Á≥ªÁªü‰∏≠Êñá‰ª∂Â≠òÂú®ÁöÑÁõÆÂΩï‰∏∫/home/xudong 1load data local inpath '/home/xudong/xxx.txt' into table phone_info;1 Ôºà2Ôºâ‰ªéhdfs‰∏äÂØºÂÖ•Êï∞ÊçÆÂà∞hiveË°®ÂÅáËÆæhdfs‰∏äÁöÑÁõÆÂΩï‰∏∫/user/xudong/data 1load data inpath '/user/xudong/data/xxx.txt' into table phone_info;1 Ê≥®ÔºöÂíåÊú¨Âú∞Êñá‰ª∂ÂØºÂÖ•‰∏çÂêåÊòØÊ≤°ÊúâlocalÂÖ≥ÈîÆÂ≠óÔºà3Ôºâ‰ªéÂà´ÁöÑË°®‰∏≠Êü•ËØ¢Âá∫Áõ∏Â∫îÁöÑÊï∞ÊçÆÂπ∂ÂØºÂÖ•hiveË°®‰∏≠ 1INSERT INTO phone_info_like SELECT * FROM phone_info;1 Ôºà4ÔºâÂú®ÂàõÂª∫Ë°®ÁöÑÊó∂ÂÄôÈÄöËøáÂà´ÁöÑË°®Êü•ËØ¢Âá∫Áõ∏Â∫îÁöÑËÆ∞ÂΩïÂπ∂ÊèíÂÖ•Âà∞ÊâÄÂàõÂª∫ÁöÑË°®‰∏≠„ÄÇ 1234CREATE TABLE temp_infoASSELECT id phone_idÔºåname phone_name,price FROM phone_infoSORT BY phone_id;1234 hiveÂà†Èô§Ë°® 1DROP TABLE IF EXISTS phone_info;1 hiveÂàõÂª∫‰∏¥Êó∂Ë°®Â≠òÂÇ®‰∏≠Èó¥ÁªìÊûú 12345CREATE TABLE temp_infoASSELECT id phone_idÔºåname phone_name,price FROM phone_infoSORT BY phone_id;12345 hiveÁÆÄÂçïÁöÑÊü•ËØ¢ËØ≠Âè• 1234SELECT * FROM temp_info;SELECT id phone_id,name phone_name FROM phone_info;SELECT a.ip,a.name,b.username FROM phone_info a INNER JOIN user b on (a.ip=b.ip);1234 hiveÊâπÈáèÊèíÂÖ•Êï∞ÊçÆÂà∞Ë°® 1234CREATE TABLE phone_info_like LIKE phone_info;//Â§çÂà∂Ë°®ÁöÑÁªìÊûÑINSERT INTO phone_info_like SELECT * FROM phone_info;INSERT OVERWRITE phoen_info_like SELECT * FROM phone_info;//intoÊòØËøΩÂä†Êï∞ÊçÆÔºåoverwriteÊòØË¶ÜÁõñ‰ª•ÂèäÂ≠òÂú®ÁöÑÊï∞ÊçÆÔºåÂ±û‰∫éÈáçÂ§çÊÄßÊ†°È™å1234 hiveÂàÜÂå∫Ë°® 12345678CREATE TABLE part_table(id int,name String,ip String,city String,date String)PARTITIONED BY (part_flag String)//ËøôÈáåÁöÑÂàÜÂå∫Â≠óÊÆµÂèØ‰ª•ÊòØË°®‰∏≠Â≠óÊÆµ‰πüÂèØ‰ª•ÊòØÊåáÂÆöÁöÑÂ≠óÊÆµROW FORMAT DELIMITED FIELDS TERMINATED BY ',';load data local inpath '/home/xudong/test.txt' into table part_table partition(part_flag='part1');load data local inpath '/home/xudong/test1.txt' into table part_table partition(part_flag='part2');select * from part_table where part_flag='part1';]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[hiveÊï∞ÊçÆÂéªÈáç]]></title>
    <url>%2F2018%2F04%2F11%2Fhive%E6%95%B0%E6%8D%AE%E5%8E%BB%E9%87%8D%2F</url>
    <content type="text"><![CDATA[distinct‰ºöÊï¥Êù°Êï∞ÊçÆÂéªÈáçÔºåÊúâ‰∏ÄÈ°πÊòØ‰∏çÂêåÁöÑÊï¥Êù°Êï∞ÊçÆÂ∞±ÁÆó‰∏çÂêåÁöÑÔºå‰∏ç‰ºöÂéªÊéâÔºåÊåâÁÖßÊüê‰∏Ä‰∏™Â≠óÊÆµÂéªÈáçÈúÄË¶ÅÂ¶Ç‰∏ãÊñπÊ≥ï hiveÊï∞ÊçÆÂéªÈáçÔºåÂπ∂Ê†πÊçÆÈúÄÊ±ÇÂèñÂÖ∂‰∏≠‰∏ÄÊù° Êï∞ÊçÆÊ°à‰æãÔºö name adx tran_id cost tsck 5 125.168.10.0 33.00 1407234660ck 5 187.18.99.00 33.32 1407234661ck 5 125.168.10.0 33.24 1407234661Âè™ÈúÄË¶ÅÂâç‰∏§Ë°åÁöÑËÆ∞ÂΩïÔºåÂõ†‰∏∫Á¨¨‰∏âË°åÁöÑtran_idÂíåÁ¨¨‰∏ÄË°åÁöÑÈáçÂ§ç‰∫ÜÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ∞ÜÊúÄÂêéÈù¢‰∏ÄË°åÈáçÂ§çÁöÑÂéªÊéâ„ÄÇ ÊñπÊ°à‰∏ÄÔºö12345selectt1.tran_id,[t2.name](http://t2.name/),t2.costfrom (selectdistinct tran_id from table) t1join table t2 ont1.tran_id=t2.tran_id ÂàÜÊûêÔºöÂ¶ÇÊûú‰ΩøÁî®distinctÁöÑËØùÔºåÈúÄË¶ÅÊäätran_idÊîæÂú®Á¨¨‰∏ÄÂàóÔºåÊü•Âá∫Êù•ÁöÑÊï∞ÊçÆÂæà‰∏çÂèãÂ•Ω„ÄÇ ÊñπÊ°à‰∫åÔºö123456789select* from(‚Äã select *,row_number() over (partition by tran_id order by timestamp asc) num from table ) twheret.num=1; ÂàÜÊûêÔºö row_number() over (partition by tran_idorder by timestamp desc) num Âèñnum=1 ÁöÑÊÑèÊÄùÊòØÂÖàÊ†πÊçÆtran_idËøõË°åÂàÜÁªÑÔºåÂπ∂Âú®ÂàÜÁªÑÂÜÖÈÉ®Êåâtimestamp ÈôçÂ∫èÊéíÂ∫èÔºårow_number()ÂáΩÊï∞ËÆ°ÁÆóÁöÑÂÄºÂ∞±Ë°®Á§∫Êüê‰∏™tran_idÁªÑÂÜÖÈÉ®ÊéíÂ∫èÂêéÁöÑÈ°∫Â∫èÁºñÂè∑ÔºàËØ•ÁºñÂè∑Âú®‰∏Ä‰∏™ÁªÑÂÜÖÊòØËøûÁª≠Âπ∂‰∏îÂîØ‰∏ÄÁöÑ) „ÄÇÊâÄ‰ª•ÊúÄÂêéÁõ¥Êé•ÂéªÊØè‰∏™ÂàÜÁªÑÂÜÖÁöÑÁ¨¨‰∏Ä‰∏™Ôºànum=1ÔºâÂç≥ÂèØ„ÄÇ PSÔºö ROW_NUMBER() OVERÂáΩÊï∞ÁöÑÂü∫Êú¨Áî®Ê≥ïËØ≠Ê≥ïÔºöROW_NUMBER() OVER(PARTITION BY COLUMN ORDER BY COLUMN)ÁÆÄÂçïÁöÑËØ¥row_number()‰ªé1ÂºÄÂßãÔºå‰∏∫ÊØè‰∏Ä‰∏™ÂàÜÁªÑËÆ∞ÂΩïËøîÂõû‰∏Ä‰∏™Êï∞Â≠óÔºåËøôÈáåÁöÑROW_NUMBER() OVER (ORDER BY xlh DESC) ÊòØÂÖàÊääxlhÂàóÈôçÂ∫èÔºåÂÜç‰∏∫ÈôçÂ∫è‰ª•ÂêéÁöÑÊØèÊù°xlhËÆ∞ÂΩïËøîÂõû‰∏Ä‰∏™Â∫èÂè∑„ÄÇÁ§∫‰æãÔºöxlh row_num1700 11500 21085 3710 4row_number() OVER (PARTITION BY COL1 ORDERBY COL2) Ë°®Á§∫Ê†πÊçÆCOL1ÂàÜÁªÑÔºåÂú®ÂàÜÁªÑÂÜÖÈÉ®Ê†πÊçÆ COL2ÊéíÂ∫èÔºåËÄåÊ≠§ÂáΩÊï∞ËÆ°ÁÆóÁöÑÂÄºÂ∞±Ë°®Á§∫ÊØèÁªÑÂÜÖÈÉ®ÊéíÂ∫èÂêéÁöÑÈ°∫Â∫èÁºñÂè∑ÔºàËØ•ÁºñÂè∑Âú®ÁªÑÂÜÖÊòØËøûÁª≠Âπ∂‰∏îÂîØ‰∏ÄÁöÑ) „ÄÇ ÂÆû‰æãÔºö Êï∞ÊçÆÊòæÁ§∫‰∏∫empid deptid salary 1 10 5500.002 10 4500.003 20 1900.004 20 4800.005 40 6500.006 40 14500.007 40 44500.008 50 6500.009 50 7500.00ÈúÄÊ±ÇÔºöÊ†πÊçÆÈÉ®Èó®ÂàÜÁªÑÔºåÊòæÁ§∫ÊØè‰∏™ÈÉ®Èó®ÁöÑÂ∑•ËµÑÁ≠âÁ∫ßÈ¢ÑÊúüÁªìÊûúÔºöempid deptid salary rank 1 10 5500.00 12 10 4500.00 24 20 4800.00 13 20 1900.00 27 40 44500.00 16 40 14500.00 25 40 6500.00 39 50 7500.00 18 50 6500.00 2SQLËÑöÊú¨Ôºö1SELECT *, Row_Number() OVER (partition by deptidORDER BY salary desc) rank FROM employee]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Spark Pandas UDFs]]></title>
    <url>%2F2018%2F04%2F11%2FSpark-Pandas-UDFs%2F</url>
    <content type="text"><![CDATA[ÈÖçÁΩÆÊâÄÊúâËøêË°åËäÇÁÇπÂÆâË£Ö pyarrow ÔºåÈúÄË¶Å &gt;= 0.8 ‰∏∫‰ªÄ‰πà‰ºöÊúâ pandas UDFÂú®ËøáÂéªÁöÑÂá†Âπ¥‰∏≠Ôºåpython Ê≠£Âú®Êàê‰∏∫Êï∞ÊçÆÂàÜÊûêÂ∏àÁöÑÈªòËÆ§ËØ≠Ë®Ä„ÄÇ‰∏Ä‰∫õÁ±ª‰ºº pandas,numpy,statsmodel,scikit-learn Ë¢´Â§ßÈáè‰ΩøÁî®ÔºåÈÄêÊ∏êÊàê‰∏∫‰∏ªÊµÅÁöÑÂ∑•ÂÖ∑ÂåÖ„ÄÇÂêåÊó∂Ôºåspark ‰πüÊàê‰∏∫‰∫ÜÂ§ßÊï∞ÊçÆÂ§ÑÁêÜÁöÑÊ†áÂáÜÔºå‰∏∫‰∫ÜËÆ©Êï∞ÊçÆÂàÜÊûêÂ∏àËÉΩÂ§ü‰ΩøÁî® spark ÔºåSparkÂú® 0.7 ÁâàÊú¨Â¢ûÂä†‰∫Ü python apiÔºå‰πüÊîØÊåÅ‰∫Ü udf (user-defined functions)„ÄÇ Ëøô‰∫õ udf ÂØπÊØèÊù°ËÆ∞ÂΩïÈÉΩ‰ºöÊìç‰Ωú‰∏ÄÊ¨°ÔºåÂêåÊó∂Êï∞ÊçÆÈúÄË¶ÅÂú® JVM Âíå Python ‰∏≠‰º†ËæìÔºåÂõ†Ê≠§Êúâ‰∫ÜÈ¢ùÂ§ñÁöÑÂ∫èÂàóÂåñÂíåË∞ÉÁî®ÂºÄÈîÄ„ÄÇÂõ†Ê≠§ÂæàÂ§öÊï∞ÊçÆ pipelines Áî® Java Âíå Scala ‰∏≠ÂÆö‰πâ UDFÔºåÁÑ∂ÂêéÂú® python ‰∏≠Ë∞ÉÁî®ÂÆÉ‰ª¨„ÄÇ Pandas Udf ÊûÑÂª∫Âú® Apache Arrow ‰πã‰∏äÔºåÂ∏¶Êù•‰∫Ü‰ΩéÂºÄÈîÄÔºåÈ´òÊÄßËÉΩÁöÑUDF„ÄÇ ÊØè‰∏™Á≥ªÁªüÈÉΩÊúâËá™Â∑±ÁöÑÂ≠òÂÇ®Ê†ºÂºèÔºå70%-80%ÁöÑÊó∂Èó¥Ëä±Ë¥πÂú®Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ‰∏ä Apache Arrow ‰∏Ä‰∏™Ë∑®Âπ≥Âè∞ÁöÑÊï∞ÊçÆÂ±ÇÔºåÁî®Êù•Âä†ÈÄüÂ§ßÊï∞ÊçÆÂàÜÊûêÈÄüÂ∫¶„ÄÇ Âú®ÂÜÖÂ≠ò‰∏≠‰ª•ÂàóÂºèÂ≠òÂÇ®„ÄÇ ‰∏Ä‰∫õÈôêÂà∂ ‰∏çÊîØÊåÅÊâÄÊúâÁöÑ sparkSQL Êï∞ÊçÆÁ±ªÂûãÔºåÂåÖÊã¨ BinaryTypeÔºåMapType, ArrayTypeÔºåTimestampType ÂíåÂµåÂ•óÁöÑ StructType„ÄÇ pandas udf Âíå udf ‰∏çËÉΩÊ∑∑Áî®„ÄÇ ‰ΩøÁî®ÊñπÂºè1. spark df &amp; pandas dfspark df ‰∏é pandas df Áõ∏‰∫íËΩ¨ÂåñÊÄßËÉΩ‰ºòÂåñÔºåÈúÄË¶ÅÂºÄÂêØÈÖçÁΩÆÔºåÈªòËÆ§‰∏∫ÂÖ≥Èó≠„ÄÇ ÈÖçÁΩÆÈ°πÔºö 1spark.sql.execution.arrow.enabled true Áõ∏‰∫íËΩ¨Âåñ 123456789import numpy as npimport pandas as pd//ÂàùÂßãÂåñ pandas DFpdf = pd.DataFrame(np.random.rand(100000, 3))// pdf -&gt; sdf%time df = spark.createDataFrame(pdf)// sdf -&gt; pdf%time result_pdf = df.select("*").toPandas() ÊÄßËÉΩÂØπÊØîÔºö execution.arrow.enabled pdf -&gt; sdf sdf -&gt; pdf false 4980ms 722ms true 72ms 79ms tips: Âç≥‰æøÊòØÊèêÈ´ò‰∫ÜËΩ¨ÂåñÁöÑÈÄüÂ∫¶Ôºåpandas df ‰æùÊóßÊòØÂçïÊú∫Âú® driver ‰∏≠ÊâßË°åÁöÑÔºå‰∏çÂ∫îËØ•ËøîÂõûÂ§ßÈáèÁöÑÊï∞ÊçÆ„ÄÇ 2. pandas UDFs(Vectorized UDFs)pandas udf ÁöÑÂÖ•ÂèÇÂíåËøîÂõûÂÄºÁ±ªÂûãÈÉΩ‰∏∫ pandas.Series Ê≥®ÂÜå udfÊñπÊ≥ï1Ôºö 123456789from pyspark.sql.functions import pandas_udfdef plus_one(a): return a + 1//df_udfplus_one_pd_udf = pandas_udf(plus_one, returnType=LongType())//sql udfspark.udf.register('plus_one',plus_one_pd_udf) ÊñπÊ≥ï2Ôºö 12345678910from pyspark.sql.functions import pandas_udf//ÈªòËÆ§‰∏∫ PandasUDFType.SCALAR Á±ªÂûã@pandas_udf('long')def plus_one(a): return a + 1spark.udf.register('plus_one',plus_one)spark.udf.registerÂèØ‰ª•Êé•Âèó‰∏Ä‰∏™ SQL_BATCHED_UDF Êàñ SQL_SCALAR_PANDAS_UDF ÊñπÊ≥ï„ÄÇ ‰ΩøÁî® pandas udf ÂêéÔºåÁâ©ÁêÜÊâßË°åËÆ°Âàí‰ºö‰ªé BatchEvalPython Âèò‰∏∫ ArrowEvalPythonÔºåÂèØ‰ª•‰ΩøÁî® explain() Ê£ÄÊü• pandas udf ÊòØÂê¶ÁîüÊïà„ÄÇ Scalar Pandas UDFs1234567891011121314151617import pandas as pdfrom pyspark.sql.functions import col, pandas_udf,udffrom pyspark.sql.types import LongTypedef multiply_func(a, b): return a * bmultiply_pd = pandas_udf(multiply_func, returnType=LongType())multiply = udf(multiply_func, returnType=LongType())x = pd.Series([1, 2, 3] * 10000)df = spark.createDataFrame(pd.DataFrame(x, columns=["x"]))%timeit df.select(multiply_pd(col("x"), col("x"))).count()%timeit df.select(multiply(col("x"), col("x"))).count() Grouped Map Pandas UDFsËÆ°ÁÆóÂùáÊñπÂ∑Æ 1234567891011121314151617181920212223from pyspark.sql.functions import pandas_udf, PandasUDFTypedf = spark.createDataFrame( [(1, 1.0), (1, 2.0), (2, 3.0), (2, 5.0), (2, 10.0)], ("id", "v"))@pandas_udf("id long, v double", PandasUDFType.GROUPED_MAP)def substract_mean(pdf): # pdf is a pandas.DataFrame v = pdf.v return pdf.assign(v=v - v.mean())df.groupby("id").apply(substract_mean).show()+---+----+| id| v|+---+----+| 1|-0.5|| 1| 0.5|| 2|-3.0|| 2|-1.0|| 2| 4.0|+---+----+ ÊµãËØïÁî®‰æãÊï∞ÊçÆÂáÜÂ§áÔºö 10M-row DataFrame , 2ÂàóÔºå‰∏ÄÂàóIntÁ±ªÂûãÔºå‰∏ÄÂàóDoubleÁ±ªÂûã 123df = spark.range(0, 10 * 1000 * 1000).withColumn('id', (col('id') / 10000).cast('integer')).withColumn('v', rand())df.cache()df.count() Plus one12345678from pyspark.sql.functions import pandas_udf, PandasUDFType# ËæìÂÖ•ÂíåËæìÂá∫ÈÉΩÊòØ doubles Á±ªÂûãÁöÑ pandas.Series@pandas_udf('double', PandasUDFType.SCALAR)def pandas_plus_one(v): return v + 1df.withColumn('v2', pandas_plus_one(df.v)) Cumulative Probability123456789import pandas as pdfrom scipy import stats@pandas_udf('double')def cdf(v): return pd.Series(stats.norm.cdf(v))df.withColumn('cumulative_probability', cdf(df.v)) Subtract Mean123456# ËæìÂÖ•ÂíåËæìÂá∫Á±ªÂûãÈÉΩÊòØ pandas.DataFrame@pandas_udf(df.schema, PandasUDFType.GROUPED_MAP)def subtract_mean(pdf): return pdf.assign(v=pdf.v - pdf.v.mean())df.groupby('id').apply(subtract_mean) Scalar Âíå Grouped map ÁöÑ‰∏Ä‰∫õÂå∫Âà´ ‚Ä¶ Scalar Grouped map udf ÂÖ•ÂèÇÁ±ªÂûã pandas.Series pandas.DataFrame udf ËøîÂõûÁ±ªÂûã pandas.Series pandas.DataFrame ËÅöÂêàËØ≠‰πâ Êó† groupby ÁöÑÂ≠êÂè• ËøîÂõûÂ§ßÂ∞è ‰∏éËæìÂÖ•‰∏ÄËá¥ rows Âíå columns ÈÉΩÂèØ‰ª•ÂíåÂÖ•ÂèÇ‰∏çÂêå ËøîÂõûÁ±ªÂûãÂ£∞Êòé pandas.Series ÁöÑ DataType pandas.DataFrame ÁöÑ StructType ÊÄßËÉΩÂØπÊØî Á±ªÂûã udf pandas udf plus_one 2.54s 1.28s cdf 2min 2s 1.52s Subtract Mean 1min 8s 4.4s ÈÖçÁΩÆÂíåÊµãËØïÊñπÊ≥ïÁéØÂ¢É Spark 2.3 Anaconda 4.4.0 (python 2.7.13) ËøêË°åÊ®°Âºè local[10] ÂèÇËÄÉhttp://spark.apache.org/docs/latest/sql-programming-guide.html#grouped-map https://databricks.com/blog/2017/10/30/introducing-vectorized-udfs-for-pyspark.html https://www.slideshare.net/PyData/improving-pandas-and-pyspark-performance-and-interoperability-with-apache-arrow]]></content>
      <categories>
        <category>Â§ßÊï∞ÊçÆ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Grafana mysql‰ΩìÈ™å]]></title>
    <url>%2F2018%2F04%2F09%2FGrafana-mysql%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[‰ªãÁªçÂú®Êó∂Â∫èÂàÜÊûêÂèäÁõëÊéßÂ±ïÁé∞È¢ÜÂüüÔºåGrafanaÊó†ÁñëÊòØÂºÄÊ∫êËß£ÂÜ≥ÊñπÊ°à‰∏≠ÁöÑÁøòÊ•öÔºåÂÖ∂ÁÅµÊ¥ªÁöÑÊèí‰ª∂Êú∫Âà∂ÔºåÊîØÊåÅÂêÑÁßçÊºÇ‰∫ÆÁöÑÈù¢Êùø„ÄÅ‰∏∞ÂØåÁöÑÊï∞ÊçÆÊ∫ê‰ª•ÂèäÂº∫Â§ßÁöÑÂ∫îÁî®„ÄÇÂÖ∏ÂûãÁöÑÈù¢ÊùøÊúâGraph„ÄÅText„ÄÅSinglestat„ÄÅPieChart„ÄÅTable„ÄÅHistogramÁ≠âÔºåÊîØÊåÅÁöÑÊï∞ÊçÆÊ∫êÊúâES„ÄÅGraphite„ÄÅInfluxDB„ÄÅOpenTSDB„ÄÅMySQL„ÄÅDruid „ÄÅPrometheus„ÄÅSimpleJsonÁ≠âÔºåÊèê‰æõÁöÑÂ∫îÁî®ÊúâZabbix„ÄÅK8sÁ≠â +ElasticsearchÂç∞Ë±°‰∏≠GrafanaÊòØ InfluxDB ÂèØËßÜÂåñÂ∑•ÂÖ∑Ôºå‰ΩÜÂü∫‰∫éGrafanaËâØÂ•ΩÁöÑÊû∂ÊûÑÔºåDataSourceÂèØ‰ª•ÂèòÂæóÂ§öÊ†∑ÊÄß‰∫ÜÔºåÁé∞Âú®ÊòØÊîØÊåÅElasticSearch‰Ωú‰∏∫DataSourceÁöÑ„ÄÇ GrafanaÁöÑÂÆâË£Ö‰πüÈùûÂ∏∏ÁÆÄÂçïÔºåËß£ÂéãÂêØÂä®Â∞±ÂèØ‰ª•‰∫Ü„ÄÇDataSourceÈÉΩÊòØÂä®ÊÄÅÊ∑ªÂä†‰∏äÂéªÁöÑ„ÄÇGrafana‰Ωú‰∏∫‰∏Ä‰∏™Á∫ØÁ≤πÁöÑÂèØËßÜÂåñÂ∑•ÂÖ∑ÔºåÁÅµÊ¥ªÊÄßÂÅöÂà∞‰∫ÜÊûÅËá¥„ÄÇ‰ΩøÁî®ElasticSearch‰Ωú‰∏∫DataSourceÔºåÊåáÂÆöÂØπÂ∫îÁöÑIndexÔºåÂ∞±ÂèØ‰ª•Âª∫Á´ãDashBoardÂ∞±Ë°åÊï∞ÊçÆÂèØËßÜÂåñ‰∫Ü„ÄÇÁõ∏ÊØîKibanaÔºåGrafanaÁöÑtemplateÂäüËÉΩËÉΩÊääÊï∞ÊçÆÊåâÁÖß‰ªªÊÑèÁöÑÁª¥Â∫¶ËøõË°åÂàáÂàÜÂ±ïÁ§∫ÔºåËøôÂ∞±ÊòØÂÆÉÁöÑÂº∫Â§ß‰πãÂ§Ñ„ÄÇ ÈÉ®ÁΩ≤GithubÂú∞ÂùÄÔºöhttps://github.com/Grafana/Grafana ‰∏ãËΩΩhttps://grafana.com/grafana/download macÂÆâË£Ö | 12 | brew updatebrew install grafana || ‚Äî- | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî- || | | http://docs.grafana.org/installation/mac/http://docs.grafana.org/installation/configuration/ ÂêØÂä®Grafana | 12345678910111213 | Ë¶ÅÂêØÂä®Grafana‰ΩøÁî®Ëá™Âà∂ÊúçÂä°È¶ñÂÖàÁ°Æ‰øùÂÆâË£Ö‰∫ÜËá™Âà∂ËΩØ‰ª∂/ÊúçÂä°„ÄÇbrew tap homebrew/servicesÁÑ∂ÂêéÂºÄÂßãGrafana‰ΩøÁî®Ôºöbrew services start grafana- ÈÖçÁΩÆÈÖçÁΩÆÊñá‰ª∂Â∫îËØ•‰Ωç‰∫é/usr/local/etc/grafana/grafana.ini„ÄÇ- Êó•ÂøóÊó•ÂøóÊñá‰ª∂Â∫îËØ•‰Ωç‰∫é/usr/local/var/log/grafana/grafana.log„ÄÇ- Êèí‰ª∂Â¶ÇÊûú‰Ω†ÊÉ≥ÊâãÂä®ÂÆâË£Ö‰∏Ä‰∏™Êèí‰ª∂ÊîæÂú®ËøôÈáåÔºö/usr/local/var/lib/grafana/plugins„ÄÇ- Êï∞ÊçÆÂ∫ìÈªòËÆ§ÁöÑsqliteÊï∞ÊçÆÂ∫ì‰Ωç‰∫é /usr/local/var/lib/grafana || ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî || | | Ê±âÂåñ(ÈùûÂøÖË¶Å) | 12 | git clone https://github.com/moonstack/grafana-for-chinese.gitÂ§á‰ªΩÂéüÊúâÁöÑ /public/app/boot.js /public/app/features/org/prefs_control.js ÂÜçÂ∞Ümaster‰∏≠ÁöÑ‰∏§‰∏™Êñá‰ª∂Ë¶ÜÁõñÂà∞ÂØπÂ∫îÁöÑÁõÆÂΩï Âà∑Êñ∞ÊµèËßàÂô®Âç≥ÂèØ || ‚Äî- | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî || | | https://github.com/moonstack/grafana-for-chinesehttps://github.com/heruihong/gf-frontend ËÆøÈóÆhttp://0.0.0.0:3000/ ÔºåÈªòËÆ§Ë¥¶Âè∑/ÂØÜÁ†ÅÔºöadmin/admin Ê∑ªÂä†Êï∞ÊçÆÊ∫êhttp://docs.grafana.org/features/datasources/elasticsearch/http://docs.grafana.org/features/datasources/mysql/ ÂØºÂÖ•dashboard/Êü•Áúãdashboardhttps://grafana.com/dashboards?dataSource=mysqlhttps://grafana.com/dashboards?dataSource=elasticsearch Âà∂Âõæ(mysql)Grafana + mysqlÊï∞ÊçÆÊ∫ê - laomei - CSDNÂçöÂÆ¢http://blog.csdn.net/sweatott/article/details/78278011 ÂõæË°®Êï∞ÊçÆÂ±ïÁ§∫ËßÑÂàô - edit - Metrics 123456789 SELECTDATE_FORMAT(gmt_create,‚Äô%Y-%m-%d‚Äô),UNIX_TIMESTAMP(DATE_FORMAT(gmt_create,‚Äô%Y-%m-%d‚Äô)) as time_sec, ‚Äì xËΩ¥:Êó∂Èó¥count(treaty_no) as value, ‚Äì yËΩ¥:Êï∞ÂÄºpartner_code as metric ‚Äì yËΩ¥ÂàÜÁªÑ:Êï∞ÊçÆÂàÜÁªÑFROM treatyWHERE 1=1group by DATE_FORMAT(gmt_create,‚Äô%Y-%m-%d‚Äô)ORDER BY id ASC Êõ¥Â§öÊñáÊ°£ËßÅ:http://docs.grafana.org/features/datasources/mysql/ ÂêÑÊä•Ë°®Èù¢ÊùøËÆæÁΩÆhttp://docs.grafana.org/features/panels/graph/ ÂõæË°®http://docs.grafana.org/features/panels/singlestat/ ‰ª™Âõæ templating Ê®°Êùøhttp://docs.grafana.org/reference/templating/http://docs.grafana.org/features/datasources/mysql/#query-variable mysqlÁöÑÊü•ËØ¢Ë°®ËææÂºè Âú®Êü•ËØ¢‰∏≠‰ΩøÁî®ÂèòÈáèhttp://docs.grafana.org/features/datasources/mysql/#using-variables-in-queries | 123456789 | SELECTDATE_FORMAT(gmt_create,‚Äô%Y-%m-%d‚Äô),UNIX_TIMESTAMP(DATE_FORMAT(gmt_create,‚Äô%Y-%m-%d‚Äô)) as time_sec, ‚Äì xËΩ¥:Êó∂Èó¥count(treaty_no) as value, ‚Äì yËΩ¥:Êï∞ÂÄºpartner_code as metric ‚Äì yËΩ¥ÂàÜÁªÑ:Êï∞ÊçÆÂàÜÁªÑFROM treatyWHERE 1=1 and partner_code in ($partner)group by DATE_FORMAT(gmt_create,‚Äô%Y-%m-%d‚Äô)ORDER BY id ASC || ‚Äî‚Äî‚Äî | ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî || | | ÊïàÊûú Êä•Ë≠¶http://docs.grafana.org/alerting/notifications/ GrafanaÊ∑ªÂä†Webhook channelhttps://www.tuicool.com/articles/VZf6JjF [ÂõæË°®-alert]ËÆæÁΩÆÊï∞ÊçÆËß¶Ë≠¶ËßÑÂàô [ÂõæË°®-alert]Notifications ÂÆö‰πâÂèëÈÄÅÊ∏†ÈÅì ÈóÆÈ¢òÂÆâË£Ögrafana,HomebrewÂá∫Áé∞‚Äùgo: version missing for ‚Äúgotools‚Äù resource!‚ÄùÁöÑËß£ÂÜ≥ÊñπÊ°à 12 ‚ûú Desktop brew install grafanaError: go: version missing for ‚Äúgotools‚Äù resource! Â∞ùËØïËß£ÂÜ≥: 12 git -C ‚Äú$(brew ‚Äìrepo)‚Äù fetch ‚Äìtagsbrew update ‚Äìforce Êàñ git -C &quot;$(brew --repo)&quot; fetch --tags brew update --forcehttp://blog.csdn.net/lanadeus/article/details/78271240https://github.com/Homebrew/homebrew-core/issues/19221https://blog.labbit.jp/%E8%AC%8E%E3%82%A8%E3%83%A9%E3%83%BCgotools%E3%81%AE%E8%A7%A3%E6%B6%88%E6%B3%95/ ÂÆûÈôÖËß£ÂÜ≥: ÈáçË£Öbrew 1 /usr/bin/ruby -e ‚Äú$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)‚Äù Êñ∞Âª∫template query ÈîôËØØ 12 TemplatingTemplate variables could not be initialized: sql: Scan error on column index 0: unsupported Scan, storing driver.Value type into type *string ÂéüÂõ†: Â≠òÂú®nullÂÄºËß£ÂÜ≥: where column is not null ÂèÇËÄÉÂü∫‰∫éGrafana+SimpleJsonÁöÑÁÅµÊ¥ªÊä•Ë°®Ëß£ÂÜ≥ÊñπÊ°àhttps://www.tuicool.com/articles/EBjUfmi ÁõëÊéßÊï∞ÊçÆÁöÑÂèØËßÜÂåñÂàÜÊûêÁ•ûÂô® Grafana - Êé®ÈÖ∑https://www.tuicool.com/articles/VZf6JjF Kibana and Grafana - Êé®ÈÖ∑https://www.tuicool.com/articles/rURRF3U ‰ΩøÁî®Prometheus+GrafanaÊê≠Âª∫ÁõëÊéßÁ≥ªÁªüÂÆûË∑µ - Êé®ÈÖ∑https://www.tuicool.com/articles/QZRjAv3 ÁõëÊéßÊï∞ÊçÆÁöÑÂèØËßÜÂåñÂàÜÊûêÁ•ûÂô® Grafana - Êé®ÈÖ∑ - OneAlert ‰∫ëÂëäË≠¶https://www.tuicool.com/articles/VZf6JjF grafana + influxdb + telegraf , ÊûÑÂª∫linuxÊÄßËÉΩÁõëÊéßÂπ≥Âè∞ - Êé®ÈÖ∑https://www.tuicool.com/articles/nyM3qyq]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Kibana + Elasticsearch‰ΩìÈ™å]]></title>
    <url>%2F2018%2F04%2F09%2FKibana-Elasticsearch%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[ÂÆâË£Ökibana‰∏ãËΩΩhttps://www.elastic.co/downloads/kibanawget https://artifacts.elastic.co/downloads/kibana/kibana-6.1.3-darwin-x86_64.tar.gz ÂáÜÂ§áelasticsearchÊúçÂä°ËßÅ: ElasticsearchÁõ∏ÂÖ≥.md ElasticsearchKibanaÂÆâË£ÖÈùûÂ∏∏Êñπ‰æøÔºåÂÆòÁΩë‰∏ãËΩΩÔºåÂπ∂ÈÖçÁΩÆ‰∏ãESÁöÑURLÂ∞±ÂèØ‰ª•Ëøû‰∏ä‰∫Ü„ÄÇKibana‰ΩøÁî®ÁöÑÊó∂ÂÄô‰ºöÊúâÂâØ‰ΩúÁî®ÔºåÂÆÉ‰ºöÂú®‰Ω†ÁöÑESÈáåÈù¢ÂàõÂª∫‰∏Ä‰∏™ÂÆÉÊâÄÈúÄË¶ÅÁöÑIndexÔºåÂπ∂‰ºöÊúâËæÉ‰∏∫È¢ëÁπÅÁöÑquery„ÄÇÂ¶ÇÊûúÊòØÁîü‰∫ßÁéØÂ¢ÉÔºåESÂ≠òÁöÑÊòØÊ†∏ÂøÉÊï∞ÊçÆË¶ÅÊÖéÁî®‰∫Ü„ÄÇÂÆâË£ÖÂ•ΩÂêØÂä®ÊåáÂÆöÈúÄË¶ÅÂàÜÊûêÁöÑIndexÔºåÂ∞±ËÉΩÁúãÂà∞‰ª•‰∏ãÂá†‰∏™Tab ÈÖçÁΩÆ config/kibana.yml 1234567891011 server.port: 5601# The host to bind the server to.server.host: ‚Äú‚Äù# If you are running kibana behind a proxy, and want to mount it at a path,# specify that path here. The basePath can‚Äôt end in a slash.# server.basePath: ‚Äú‚Äù# The Elasticsearch instance to use for all your queries.elasticsearch.url: ‚Äúhttp://0.0.0.0:9200‚Äú #ËøôÈáåÊòØelasticsearchÁöÑËÆøÈóÆÂú∞ÂùÄ Ê±âÂåñhttps://github.com/anbai-inc/Kibana_Hanizationpython main.py &lt;kibanaÁõÆÂΩï&gt; ÂêØÂä® 12 ./kibana //‰∏çËÉΩÂÖ≥Èó≠ÁªàÁ´Ønohup ./kibana &gt; /nohub.out &amp; //ÂèØÂÖ≥Èó≠ÁªàÁ´ØÔºåÂú®nohup.out‰∏≠Êü•Áúãlog ËÆøÈóÆ http://0.0.0.0:5601/ ‰ΩøÁî®Êñ∞Âª∫Á¥¢ÂºïÊ®°Âºèhttp://0.0.0.0:5601/app/kibana#/management/kibana/indices Êñ∞Âª∫ÂõæË°®&amp;ËÆæÁΩÆxyËΩ¥Êï∞ÊçÆÂàóhttp://0.0.0.0:5601/app/kibana#/visualize/new?_g=() ‰ª™Ë°®ÁõòÈõÜÊàêÂõæË°® ÂèÇËÄÉKibana and Grafana - Êé®ÈÖ∑https://www.tuicool.com/articles/rURRF3U kibana‰ªãÁªç - CSDNÂçöÂÆ¢http://blog.csdn.net/eff666/article/details/63251710?locationNum=3&amp;fps=1]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ïpaxos]]></title>
    <url>%2F2018%2F04%2F09%2F%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95paxos%2F</url>
    <content type="text"><![CDATA[ÈöèÁùÄÂ§ßÂûãÁΩëÁ´ôÁöÑÂêÑÁßçÈ´òÂπ∂ÂèëËÆøÈóÆ„ÄÅÊµ∑ÈáèÊï∞ÊçÆÂ§ÑÁêÜÁ≠âÂú∫ÊôØË∂äÊù•Ë∂äÂ§öÔºåÂ¶Ç‰ΩïÂÆûÁé∞ÁΩëÁ´ôÁöÑÈ´òÂèØÁî®„ÄÅÊòì‰º∏Áº©„ÄÅÂèØÊâ©Â±ï„ÄÅÂÆâÂÖ®Á≠âÁõÆÊ†áÂ∞±ÊòæÂæóË∂äÊù•Ë∂äÈáçË¶Å„ÄÇ‰∏∫‰∫ÜËß£ÂÜ≥ËøôÊ†∑‰∏ÄÁ≥ªÂàóÈóÆÈ¢òÔºåÂ§ßÂûãÁΩëÁ´ôÁöÑÊû∂ÊûÑ‰πüÂú®‰∏çÊñ≠ÂèëÂ±ï„ÄÇÊèêÈ´òÂ§ßÂûãÁΩëÁ´ôÁöÑÈ´òÂèØÁî®Êû∂ÊûÑÔºå‰∏çÂæó‰∏çÊèêÁöÑÂ∞±ÊòØÂàÜÂ∏ÉÂºè„ÄÇÂú®ÂÖ≥‰∫éÂàÜÂ∏ÉÂºè‰∫ãÂä°„ÄÅ‰∏§Èò∂ÊÆµÊèê‰∫§ÂçèËÆÆ„ÄÅ‰∏âÈò∂Êèê‰∫§ÂçèËÆÆ‰∏ÄÊñá‰∏≠‰∏ªË¶ÅÁî®‰∫éËß£ÂÜ≥ÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÈóÆÈ¢òÁöÑÈõÜ‰∏≠ÂçèËÆÆÔºåÈÇ£‰πàËøôÁØáÊñáÁ´†‰∏ªË¶ÅËÆ≤Ëß£‰∏öÂÜÖÂÖ¨ËÆ§ÁöÑÊØîËæÉÈöæÁöÑ‰πüÊòØÊúÄË°å‰πãÊúâÊïàÁöÑpaxosÁÆóÊ≥ï„ÄÇ ÊàëËÆ§‰∏∫ÂØπpaxosÁÆóÊ≥ïËÆ≤Ëß£ÁöÑÊúÄÊ∏ÖÊ•öÁöÑÂ∞±ÊòØÁª¥Âü∫ÁôæÁßë‰∫Ü„ÄÇ‰ΩÜÊòØË¶ÅÁúãÊáÇÁª¥Âü∫ÁôæÁßë‰∏≠ÁöÑ‰ªãÁªçÈúÄË¶ÅÂæàÂº∫ÁöÑÊï∞Â≠¶ÊÄùÁª¥ÔºàpaxosÊØïÁ´üÊòØ‰∏Ä‰∏™ÁÆóÊ≥ïÔºâÔºåËÄå‰∏îÊúâÂæàÂ§öÂÖ≥‰∫éÂÆöÁêÜÁöÑÊé®ËÆ∫„ÄÅËØÅÊòéÁ≠âËøáÁ®ã„ÄÇÈÇ£‰πàÊú¨ÁØáÊñáÁ´†‰∏ªË¶ÅÁ´ôÂú®Á®ãÂ∫èÁöÑËßíÂ∫¶ÔºåÈÄö‰øóÁöÑÔºåÂæ™Â∫èÊ∏êËøõÁöÑËÆ≤Ëß£Âà∞Â∫ï‰ªÄ‰πàÊòØpaxosÁÆóÊ≥ï„ÄÇ ËÉåÊôØGoogle ChubbyÁöÑ‰ΩúËÄÖMike BurrowsËØ¥ËøáÔºå there is only one consensus protocol, and that‚Äôs Paxos‚Äù ‚Äì all other approaches are just broken versions of Paxos. ÊÑèÂç≥‰∏ñ‰∏äÂè™Êúâ‰∏ÄÁßç‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÔºåÈÇ£Â∞±ÊòØPaxosÔºåÊâÄÊúâÂÖ∂‰ªñ‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÈÉΩÊòØPaxosÁÆóÊ≥ïÁöÑ‰∏çÂÆåÊï¥Áâà„ÄÇ PaxosÁÆóÊ≥ïÊòØËé±ÊñØÂà©¬∑ÂÖ∞‰ºØÁâπÔºàLeslie LamportÔºåÂ∞±ÊòØ LaTeX ‰∏≠ÁöÑ‚ÄùLa‚ÄùÔºåÊ≠§‰∫∫Áé∞Âú®Âú®ÂæÆËΩØÁ†îÁ©∂Èô¢Ôºâ‰∫é1990Âπ¥ÊèêÂá∫ÁöÑ‰∏ÄÁßçÂü∫‰∫éÊ∂àÊÅØ‰º†ÈÄíÁöÑ‰∏ÄËá¥ÊÄßÁÆóÊ≥ï„ÄÇ‰∏∫ÊèèËø∞ Paxos ÁÆóÊ≥ïÔºåLamport ËÆ≤Ëø∞‰∫ÜËøôÊ†∑‰∏Ä‰∏™ÊïÖ‰∫ãÔºö Âú®Âè§Â∏åËÖäÊúâ‰∏Ä‰∏™Â≤õÂ±øÂè´ÂÅöPaxosÔºåËøô‰∏™Â≤õÂ±øÈÄöËøáËÆÆ‰ºöÁöÑÂΩ¢Âºè‰øÆËÆ¢Ê≥ïÂæã„ÄÇÊâßÊ≥ïËÄÖÔºàlegislatorsÔºåÂêéÈù¢Áß∞‰∏∫ÁâßÂ∏àpriestÔºâÂú®ËÆÆ‰ºöÂ§ßÂéÖÔºàchamberÔºâ‰∏≠Ë°®ÂÜ≥ÈÄöËøáÊ≥ïÂæãÔºåÂπ∂ÈÄöËøáÊúçÂä°Âëò‰º†ÈÄíÁ∫∏Êù°ÁöÑÊñπÂºè‰∫§ÊµÅ‰ø°ÊÅØÔºåÊØè‰∏™ÊâßÊ≥ïËÄÖ‰ºöÂ∞ÜÈÄöËøáÁöÑÊ≥ïÂæãËÆ∞ÂΩïÂú®Ëá™Â∑±ÁöÑË¥¶ÁõÆÔºàledgerÔºâ‰∏ä„ÄÇÈóÆÈ¢òÂú®‰∫éÊâßÊ≥ïËÄÖÂíåÊúçÂä°ÂëòÈÉΩ‰∏çÂèØÈù†Ôºå‰ªñ‰ª¨ÈöèÊó∂‰ºöÂõ†‰∏∫ÂêÑÁßç‰∫ãÊÉÖÁ¶ªÂºÄËÆÆ‰ºöÂ§ßÂéÖ„ÄÅÊúçÂä°Âëò‰πüÊúâÂèØËÉΩÈáçÂ§ç‰º†ÈÄíÊ∂àÊÅØÔºàÊàñËÄÖÁõ¥Êé•ÂΩªÂ∫ïÁ¶ªÂºÄÔºâÔºåÂπ∂ÈöèÊó∂ÂèØËÉΩÊúâÊñ∞ÁöÑÊâßÊ≥ïËÄÖÔºàÊàñËÄÖÊòØÂàöÊöÇÊó∂Á¶ªÂºÄÁöÑÔºâÂõûÂà∞ËÆÆ‰ºöÂ§ßÂéÖËøõË°åÊ≥ïÂæãË°®ÂÜ≥ÔºåÂõ†Ê≠§ÔºåËÆÆ‰ºöÂçèËÆÆË¶ÅÊ±Ç‰øùËØÅ‰∏äËø∞ÊÉÖÂÜµ‰∏ãÂèØ‰ª•ËÉΩÂ§üÊ≠£Á°ÆÁöÑ‰øÆËÆ¢Ê≥ïÂæãÂπ∂‰∏î‰∏ç‰ºö‰∫ßÁîüÂÜ≤Á™Å„ÄÇ ‰ªÄ‰πàÊòØpaxosÁÆóÊ≥ïPaxos ÁÆóÊ≥ïÊòØÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÁî®Êù•Ëß£ÂÜ≥‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂ¶Ç‰ΩïÂ∞±Êüê‰∏™ÂÄº(ÂÜ≥ËÆÆ)ËææÊàê‰∏ÄËá¥ÁöÑÈóÆÈ¢ò„ÄÇ ‰∫∫‰ª¨Âú®ÁêÜËß£paxosÁÆóÊ≥ïÊòØ‰ºöÈÅáÂà∞‰∏Ä‰∫õÂõ∞Â¢ÉÔºåÈÇ£‰πàÊé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∏¶ÁùÄ‰ª•‰∏ãÂá†‰∏™ÈóÆÈ¢òÊù•Â≠¶‰π†paxosÁÆóÊ≥ïÔºö 1„ÄÅpaxosÂà∞Â∫ïÂú®Ëß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢òÔºü 2„ÄÅpaxosÂà∞Â∫ïÂ¶Ç‰ΩïÂú®ÂàÜÂ∏ÉÂºèÂ≠òÂÇ®Á≥ªÁªü‰∏≠Â∫îÁî®Ôºü 3„ÄÅpaxosÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØ‰ªÄ‰πàÔºü paxosËß£ÂÜ≥‰∫Ü‰ªÄ‰πàÈóÆÈ¢òÂú®ÂÖ≥‰∫éÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁöÑÊé¢Á©∂‰∏≠Êàë‰ª¨ÊèêÂà∞ËøáÔºåÂàÜÂ∏ÉÂºèÁöÑ‰∏ÄËá¥ÊÄßÈóÆÈ¢òÂÖ∂ÂÆû‰∏ªË¶ÅÊòØÊåáÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢ò„ÄÇÊâÄ‰ª•Ôºå‰∏∫‰∫Ü‰øùËØÅÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑ‰∏ÄËá¥ÊÄßÔºåÂ∞±Ë¶Å‰øùËØÅÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑÊï∞ÊçÆÊòØ‰∏ÄËá¥ÁöÑ„ÄÇ Âú®‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÁ≥ªÁªü‰∏≠ÔºåÂ¶ÇÊûúÂêÑËäÇÁÇπÁöÑÂàùÂßãÁä∂ÊÄÅ‰∏ÄËá¥ÔºåÊØè‰∏™ËäÇÁÇπÈÉΩÊâßË°åÁõ∏ÂêåÁöÑÊìç‰ΩúÂ∫èÂàóÔºåÈÇ£‰πà‰ªñ‰ª¨ÊúÄÂêéËÉΩÂæóÂà∞‰∏Ä‰∏™‰∏ÄËá¥ÁöÑÁä∂ÊÄÅ„ÄÇ‰∏∫‰øùËØÅÊØè‰∏™ËäÇÁÇπÊâßË°åÁõ∏ÂêåÁöÑÂëΩ‰ª§Â∫èÂàóÔºåÈúÄË¶ÅÂú®ÊØè‰∏ÄÊù°Êåá‰ª§‰∏äÊâßË°å‰∏Ä‰∏™‚Äú‰∏ÄËá¥ÊÄßÁÆóÊ≥ï‚Äù‰ª•‰øùËØÅÊØè‰∏™ËäÇÁÇπÁúãÂà∞ÁöÑÊåá‰ª§‰∏ÄËá¥„ÄÇ ÊâÄ‰ª•ÔºåpaxosÁÆóÊ≥ï‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÂ∞±ÊòØÂ¶Ç‰Ωï‰øùËØÅÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÂêÑ‰∏™ËäÇÁÇπÈÉΩËÉΩÊâßË°å‰∏Ä‰∏™Áõ∏ÂêåÁöÑÊìç‰ΩúÂ∫èÂàó„ÄÇ ‰∏äÂõæ‰∏≠ÔºåC1ÊòØ‰∏Ä‰∏™ÂÆ¢Êà∑Á´ØÔºåN1„ÄÅN2„ÄÅN3ÊòØÂàÜÂ∏ÉÂºèÈÉ®ÁΩ≤ÁöÑ‰∏â‰∏™ÊúçÂä°Âô®ÔºåÂàùÂßãÁä∂ÊÄÅ‰∏ãN1„ÄÅN2„ÄÅN3‰∏â‰∏™ÊúçÂä°Âô®‰∏≠Êüê‰∏™Êï∞ÊçÆÁöÑÁä∂ÊÄÅÈÉΩÊòØS0„ÄÇÂΩìÂÆ¢Êà∑Á´ØË¶ÅÂêëÊúçÂä°Âô®ËØ∑Ê±ÇÂ§ÑÁêÜÊìç‰ΩúÂ∫èÂàóÔºöop1op2op3Êó∂ÔºàopË°®Á§∫operationÔºâÔºàËøôÈáåÊääÂÆ¢Êà∑Á´ØÁöÑÂÜôÊìç‰ΩúÁÆÄÂåñÊàêÂêëÊâÄÊúâÊúçÂä°Âô®ÂèëÈÄÅÁõ∏ÂêåÁöÑËØ∑Êìç‰ΩúÂ∫èÂàóÔºåÂÆûÈôÖ‰∏äÂèØËÉΩÈÄöËøáMaster/SlaveÊ®°ÂºèÂ§ÑÁêÜÔºâ„ÄÇÂ¶ÇÊûúÊÉ≥‰øùËØÅÂú®Â§ÑÁêÜÂÆåÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±Ç‰πãÂêéÔºåN1„ÄÅN2„ÄÅN3‰∏â‰∏™ÊúçÂä°Âô®‰∏≠ÁöÑÊï∞ÊçÆÁä∂ÊÄÅÈÉΩËÉΩ‰ªéS0ÂèòÊàêS1Âπ∂‰∏î‰∏ÄËá¥ÁöÑËØùÔºàÊàñËÄÖÊ≤°ÊúâÊâßË°åÊàêÂäüÔºåËøòÊòØS0Áä∂ÊÄÅÔºâÔºåÂ∞±Ë¶Å‰øùËØÅN1„ÄÅN2„ÄÅN3Âú®Êé•Êî∂Âπ∂Â§ÑÁêÜÊìç‰ΩúÂ∫èÂàóop1op2op3Êó∂Ôºå‰∏•Ê†ºÊåâÁÖßËßÑÂÆöÁöÑÈ°∫Â∫èÊ≠£Á°ÆÊâßË°åopiÔºåË¶Å‰πàÂÖ®ÈÉ®ÊâßË°åÊàêÂäüÔºåË¶Å‰∏çÂ∞±ÂÖ®ÈÉ®ÈÉΩ‰∏çÊâßË°å„ÄÇ ÊâÄ‰ª•ÔºåÈíàÂØπ‰∏äÈù¢ÁöÑÂú∫ÊôØÔºåpaxosËß£ÂÜ≥ÁöÑÈóÆÈ¢òÂ∞±ÊòØÂ¶Ç‰Ωï‰æùÊ¨°Á°ÆÂÆö‰∏çÂèØÂèòÊìç‰ΩúopiÁöÑÂèñÂÄºÔºå‰πüÂ∞±ÊòØÁ°ÆÂÆöÁ¨¨i‰∏™Êìç‰Ωú‰ªÄ‰πàÔºåÂú®Á°ÆÂÆö‰∫ÜopiÁöÑÂÜÖÂÆπ‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ËÆ©ÂêÑ‰∏™ÂâØÊú¨ÊâßË°åopiÊìç‰Ωú„ÄÇ PaxosÁÆóÊ≥ïËØ¶Ëß£PaxosÊòØ‰∏Ä‰∏™ÂçÅÂàÜÂ∑ßÂ¶ôÁöÑ‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÔºå‰ΩÜÊòØ‰ªñ‰πüÂçÅÂàÜÈöæ‰ª•ÁêÜËß£ÔºåÂ∞±Ëøû‰ªñÁöÑ‰ΩúËÄÖLamportÈÉΩË¢´Ëø´ÂØπ‰ªñÂÅöËøáÂ§öÁßçËÆ≤Ëß£„ÄÇÊàëËÆ§‰∏∫ÂØπpaxosÁÆóÊ≥ïËÆ≤Ëß£ÁöÑÊúÄÊ∏ÖÊ•öÁöÑÂ∞±ÊòØÁª¥Âü∫ÁôæÁßë‰∫Ü„ÄÇ‰ΩÜÊòØË¶ÅÁúãÊáÇÁª¥Âü∫ÁôæÁßë‰∏≠ÁöÑ‰ªãÁªçÈúÄË¶ÅÂæàÂº∫ÁöÑÊï∞Â≠¶ÊÄùÁª¥ÔºàpaxosÊØïÁ´üÊòØ‰∏Ä‰∏™ÁÆóÊ≥ïÔºâÔºåËÄå‰∏îÊúâÂæàÂ§öÂÖ≥‰∫éÂÆöÁêÜÁöÑÊé®ËÆ∫„ÄÅËØÅÊòéÁ≠âËøáÁ®ã„ÄÇÈÇ£‰πàÊú¨ÁØáÊñáÁ´†‰∏ªË¶ÅÁ´ôÂú®Á®ãÂ∫èÁöÑËßíÂ∫¶ÔºåÈÄö‰øóÁöÑÔºåÂæ™Â∫èÊ∏êËøõÁöÑËÆ≤Ëß£Âà∞Â∫ï‰ªÄ‰πàÊòØpaxosÁÆóÊ≥ï„ÄÇ Êàë‰ª¨ÂÖàÊääÂâçÈù¢ÁöÑÂú∫ÊôØÁÆÄÂåñÔºåÊääÊàë‰ª¨Áé∞Âú®Ë¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÁÆÄÂåñ‰∏∫Â¶Ç‰ΩïÁ°ÆÂÆö‰∏Ä‰∏™‰∏çÂèØÂèòÂèòÈáèÁöÑÂèñÂÄºÔºàÊØè‰∏Ä‰∏™‰∏çÂèØÂèòÂèòÈáèÂèØ‰ª•Ê†áËØÜ‰∏Ä‰∏™Êìç‰ΩúÂ∫èÂàó‰∏≠ÁöÑÊüê‰∏™Êìç‰ΩúÔºåÂΩìÁ°Æ‰øùÊØè‰∏™Êìç‰ΩúÈÉΩÊ≠£Á°Æ‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ÊåâÁÖßÈ°∫Â∫èÊâßË°åËøô‰∫õÊìç‰ΩúÊù•‰øùËØÅÊï∞ÊçÆËÉΩÂ§üÂáÜÁ°ÆÊó†ËØØÁöÑ‰ªé‰∏Ä‰∏™Áä∂ÊÄÅËΩ¨ÂèòÊàêÂè¶Â§ñ‰∏Ä‰∏™Áä∂ÊÄÅ‰∫ÜÔºâ„ÄÇ Êé•‰∏ãÊù•ÔºåËØ∑Ë∑üÊàë‰∏ÄÊ≠•‰∏ÄÊ≠•ÁöÑÂ≠¶‰π†paxosÁÆóÊ≥ï„ÄÇ Ë¶ÅÂ≠¶‰π†paxosÁÆóÊ≥ïÔºåÊàë‰ª¨Â∞±Ë¶Å‰ªé‰ªñË¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÂá∫ÂèëÔºåÂÅáÂ¶ÇÊ≤°ÊúâpaxosÁÆóÊ≥ïÔºåÂΩìÊàë‰ª¨Èù¢ÂØπÂ¶Ç‰ΩïÁ°ÆÂÆö‰∏Ä‰∏™‰∏çÂèØÂèòÂèòÈáèÁöÑÂèñÂÄºËøôÊ†∑‰∏Ä‰∏™ÂêªÈóÆÈ¢òÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â∫îËØ•Â¶Ç‰ΩïËß£ÂÜ≥Âë¢Ôºü ËøôÈáåÊöÇ‰∏ç‰ªãÁªçpaxos‰∏≠ÁöÑËßíËâ≤ÁöÑÊ¶ÇÂøµÔºåËØªËÄÖÂèØ‰ª•Ëá™Ë°å‰ªéÁª¥Âü∫ÁôæÁßë‰∏≠‰∫ÜËß£„ÄÇ‰∏ç‰∫ÜËß£ÁöÑËØù‰πüÂèØ‰ª•Áõ¥Êé•ÂæÄ‰∏ãÁúãÔºåÁúãÁùÄÁúãÁùÄÂ∞±‰∫ÜËß£‰∫Ü„ÄÇ ÈóÆÈ¢òÊäΩË±°Êàë‰ª¨ÊääÁ°ÆÂÆö‰∏Ä‰∏™‰∏çÂèØÂèòÂèòÈáèÁöÑÂèñÂÄºÈóÆÈ¢òÂÆö‰πâÊàêÔºö ËÆæËÆ°‰∏Ä‰∏™Á≥ªÁªüÔºåÊù•Â≠òÂÇ®ÂêçÁß∞‰∏∫varÁöÑÂèòÈáè„ÄÇ varÁöÑÂèñÂÄºÂèØ‰ª•ÊòØ‰ªªÊÑè‰∫åËøõÂà∂Êï∞ Á≥ªÁªüÂÜÖÈÉ®Áî±Â§ö‰∏™AccepterÁªÑÊàê,Ë¥üË¥£ÁÆ°ÁêÜÂíåÂ≠òÂÇ®varÂèòÈáè„ÄÇ Á≥ªÁªüÂØπÂ§ñÊèê‰æõapi,Áî®Êù•ËÆæÁΩÆvarÂèòÈáèÁöÑÂÄºpropose(var,V) =&gt; &lt;ok,f&gt; or &lt;error&gt; Â∞ÜvarÁöÑÂÄºËÆæÁΩÆ‰∏∫VÔºåÁ≥ªÁªü‰ºöËøîÂõûokÂíåÁ≥ªÁªü‰∏≠Â∑≤ÁªèÁ°ÆÂÆöÁöÑÂèñÂÄºfÔºåÊàñËÄÖËøîÂõûerror„ÄÇ Â§ñÈÉ®ÊúâÂ§ö‰∏™ProposerÊú∫Âô®‰ªªÊÑèËØ∑Ê±ÇÁ≥ªÁªüÔºåË∞ÉÁî®Á≥ªÁªüAPI(propose(var,V) =&gt; &lt;ok,f&gt; or &lt;error&gt;)Êù•ËÆæÁΩÆvarÂèòÈáèÁöÑÂÄº„ÄÇ Â¶ÇÊûúÁ≥ªÁªüÊàêÂäüÁöÑÂ∞ÜvarËÆæÁΩÆÊàê‰∫ÜVÔºåÈÇ£‰πàËøîÂõûÁöÑfÂ∫îËØ•Â∞±ÊòØVÁöÑÂÄº„ÄÇÂê¶ÂàôÔºåÁ≥ªÁªüËøîÂõûÁöÑfÂ∞±ÊòØÂÖ∂‰ªñÁöÑProposerËÆæÁΩÆÁöÑÂÄº„ÄÇ > Á≥ªÁªüÈúÄË¶Å‰øùËØÅvarÁöÑÂèñÂÄºÊª°Ë∂≥‰∏ÄËá¥ÊÄß Â¶ÇÊûúvarÊ≤°ÊúâË¢´ËÆæÁΩÆËøáÔºåÈÇ£‰πà‰ªñÁöÑÂàùÂßãÂÄº‰∏∫null ‰∏ÄÊó¶varÁöÑÂÄºË¢´ËÆæÁΩÆÊàêÂäüÔºåÂàô‰∏çÂèØË¢´Êõ¥ÊîπÔºåÂπ∂‰∏îÂèØ‰ª•‰∏ÄÁõ¥ÈÉΩËÉΩËé∑ÂèñÂà∞Ëøô‰∏™ÂÄº Á≥ªÁªüÈúÄË¶ÅÊª°Ë∂≥ÂÆπÈîôÁâπÊÄß ÂèØ‰ª•ÂÆπÂøç‰ªªÊÑèproposerÂá∫Áé∞ÊïÖÈöúÂèØ‰ª•ÂÆπÂøçÂ∞ëÊï∞acceptorÊïÖÈöúÔºàÂçäÊï∞‰ª•‰∏ãÔºâ ÊöÇÊó∂ÂøΩÁï•ÁΩëÁªúÂàÜÂåñÈóÆÈ¢òÂíåacceptorÊïÖÈöúÂØºËá¥var‰∏¢Â§±ÁöÑÈóÆÈ¢ò„ÄÇ Âà∞ËøôÈáåÔºåÈóÆÈ¢òÂ∑≤ÁªèÊäΩË±°ÂÆåÊàê‰∫ÜÔºåËØªËÄÖÂèØ‰ª•ÂÜç‰ªîÁªÜÁúãÁúã‰∏äÈù¢ÁöÑÁ≥ªÁªüÊèèËø∞„ÄÇÂ¶ÇÊûúËøôÊ†∑ËÆæÁΩÆ‰∏Ä‰∏™Á≥ªÁªüÔºåÊòØ‰∏çÊòØÂ∞±ÂèØ‰ª•‰øùËØÅÂèòÈáèvarÁöÑ‰∏çÂèØÂèòÊÄß‰∫ÜÂë¢Ôºü ËøôÈáåËøòÊòØÂÜçÁÆÄÂçïËÆ≤Ëß£‰∏Ä‰∏ãÔºå‰∏äÈù¢ÁöÑÁ≥ªÁªüÁ°ÆÂÆûÂèØ‰ª•‰øùËØÅÂèòÈáèvarÁöÑ‰∏çÂèØÂèòÊÄß„ÄÇ Âõ†‰∏∫varÁöÑÂàùÂßãÂÄº‰∏∫nullÔºåÂΩìÊúâproposerËØ∑Ê±ÇÊé•Âè£proposeÔºàvarÔºåvÔºâËÆæÁΩÆvarÁöÑÂÄºÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰ºöÂ∞ÜvarËÆæÁΩÆ‰∏∫vÔºåÂπ∂ËøîÂõûfÔºàf==vÔºâ„ÄÇ varÂèòÈáèË¢´ÂàùÂßãÂåñ‰ª•ÂêéÔºåÂÜçÊúâproposerËØ∑Ê±Çpropose(var,v)ËÆæÁΩÆvarÁöÑÂÄºÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰ºöÁõ¥Êé•ËøîÂõûÁ≥ªÁªü‰∏≠Â∑≤ÊúâÁöÑvarÁöÑÂÄºfÔºåËÄåÊîæÂºÉproposerÊèê‰æõÁöÑv„ÄÇ Á≥ªÁªüÈöæÁÇπË¶ÅËÆæËÆ°‰ª•‰∏äÁ≥ªÁªüÂ≠òÂú®‰ª•‰∏ãÈöæÁÇπÔºö 1„ÄÅÁÆ°ÁêÜÂ§ö‰∏™proposerÂπ∂ÂèëÊâßË°å 2„ÄÅÂÆπÂøçvarÂèòÈáèÁöÑ‰∏çÂèØÂèòÊÄß 3„ÄÅÂÆπÂøç‰ªªÊÑèProposerÁöÑÊïÖÈöú 4„ÄÅÂÆπÂøçÂçäÊï∞‰ª•‰∏ãÁöÑacceptorÁöÑÊïÖÈöú Ëß£ÂÜ≥ÊñπÊ°à‰∏ÄÂÖàËÄÉËôëÊï¥‰∏™Á≥ªÁªüÁî±Âçï‰∏™acceptorÁªÑÊàê„ÄÇÈÄöËøáÁ±ª‰ºº‰∫íÊñ•ÈîÅÁöÑÊñπÂºèÊù•ÁÆ°ÁêÜÂπ∂ÂèëÁöÑproposerÁöÑËØ∑Ê±Ç„ÄÇ proposerÂêëacceptorÁî≥ËØ∑acceptorÁöÑ‰∫íÊñ•ËÆøÈóÆÊùÉÔºåÂΩìÂèñÂæó‰∫íÊñ•ËÆøÈóÆÊùÉ‰πãÂêéÊâçËÉΩË∞ÉÁî®apiÁªôvarÂèòÈáèËµãÂÄº„ÄÇaccepterÂêëproposerÂèëÊîæ‰∫íÊñ•ËÆøÈóÆÊùÉÔºåË∞ÅÂèñÂæó‰∫Ü‰∫íÊñ•ËÆøÈóÆÊùÉÔºåacceptorÂ∞±Êé•Êî∂Ë∞ÅÁöÑËØ∑Ê±Ç„ÄÇËøôÊ†∑ÈÄöËøá‰∫íÊñ•ËÆøÈóÆÁöÑÊú∫Âà∂ÔºåproposerÂ∞±Ë¶ÅÊåâÁÖßËé∑Âèñ‰∫íÊñ•ËÆøÈóÆÊùÉÁöÑÈ°∫Â∫èÊù•ËØ∑Ê±ÇÁ≥ªÁªü„ÄÇ‰∏ÄÊó¶acceptorÊé•Êî∂Âà∞‰∏Ä‰∏™proposerËØ∑Ê±ÇÔºåÂπ∂ÊàêÂäüÁªôvarÂèòÈáèËµãÂÄº‰πãÂêéÔºåÂ∞±‰∏çÂÜçÂÖÅËÆ∏ÂÖ∂‰ªñÁöÑproposerËÆæÁΩÆvarÂèòÈáèÁöÑÂÄº„ÄÇÊØèÂΩìÂÜçÊúâproposerÊù•ËØ∑Ê±ÇËÆæÁΩÆvarÂèòÈáèÁöÑÂÄºÁöÑÊó∂ÂÄôÔºåacceptorÂ∞±‰ºöÂ∞ÜvarÈáåÈù¢Áé∞ÊúâÁöÑÂÄºËøîÂõûÁªô‰ªñ„ÄÇ Âü∫‰∫é‰∫íÊñ•ËÆøÈóÆÊùÉÁöÑacceptorÁöÑÂÆûÁé∞ acceptor‰ºö‰øùÂ≠òÂèòÈáèvarÁöÑÂÄºÂíå‰∏Ä‰∏™‰∫íÊñ•ÈîÅLock„ÄÇ Êèê‰æõÊé•Âè£prepare() Âä†‰∫íÊñ•ÈîÅÔºåÁªô‰∫àvarÁöÑ‰∫íÊñ•ËÆøÈóÆÊùÉÔºåÂπ∂ËøîÂõûÂΩìÂâçvarÁöÑÂèñÂÄº Êèê‰æõÊé•Âè£release() Áî®‰∫éÈáäÊîæ‰∫íÊñ•ËÆøÈóÆÊùÉ Êèê‰æõÊé•Âè£accept(var, v) Â¶ÇÊûúÂ∑≤ÁªèÂä†ÈîÅÔºåÂπ∂‰∏îÂΩìÂâçvarÊ≤°ÊúâÂÄºÔºåÂàôÂ∞ÜvarÁöÑÂÄºËÆæÁΩÆÊàêvÔºåÂπ∂ÈáäÊîæÈîÅ„ÄÇ proposerÈááÁî®‰∏§Èò∂ÊÆµÊù•ÂÆûÁé∞ Step1„ÄÅÈÄöËøáË∞ÉÁî®prepareÊé•Âè£Êù•Ëé∑Âèñ‰∫íÊñ•ÊÄßËÆøÈóÆÊùÉÂíåÂΩìÂâçvarÁöÑÂèñÂÄº Â¶ÇÊûúÊó†Ê≥ïËé∑ÂèñÂà∞‰∫íÊñ•ÊÄßËÆøÈóÆÊùÉÔºåÂàôËøîÂõûÔºåÂπ∂‰∏çËÉΩËøõÂÖ•Âà∞‰∏ã‰∏Ä‰∏™Èò∂ÊÆµÔºåÂõ†‰∏∫ÂÖ∂‰ªñproposerËé∑ÂèñÂà∞‰∫Ü‰∫íÊñ•ÊÄßËÆøÈóÆÊùÉ„ÄÇ Step2„ÄÅÊ†πÊçÆÂΩìÂâçvarÁöÑÂèñÂÄºfÈÄâÊã©ÊâßË°å 1„ÄÅÂ¶ÇÊûúfÁöÑÂèñÂÄº‰∏∫nullÔºåËØ¥ÊòéÊ≤°ÊúâË¢´ËÆæÁΩÆËøáÂÄºÔºåÂàôË∞ÉÁî®Êé•Âè£accept(var ,v)Êù•Â∞ÜvarÁöÑÂèñÂÄºËÆæÁΩÆÊàêvÔºåÂπ∂ÈáäÊîæÊéâ‰∫íÊñ•ÊÄßËÆøÈóÆÊùÉ„ÄÇ2„ÄÅÂ¶ÇÊûúfÁöÑÂèñÂÄº‰∏ç‰∏∫nullÔºåËØ¥ÊòévarÂ∑≤ÁªèË¢´ÂÖ∂‰ªñproposerËÆæÁΩÆËøáÂÄºÔºåÂàôË∞ÉÁî®releaseÊé•Âè£ÈáäÊîæÊéâ‰∫íÊñ•ÊÄßËÆøÈóÆÊùÉ„ÄÇ ÊÄªÁªìÔºöÊñπÊ°à‰∏ÄÈÄöËøá‰∫íÊñ•ËÆøÈóÆÁöÑÊñπÂºèÊù•‰øùËØÅÊâÄÊúâÁöÑproposerËÉΩÂ§ü‰∏≤Ë°åÁöÑËÆøÈóÆacceptorÔºåËøôÊ†∑ÂÖ∂ÂÆûÂπ∂Ê≤°ÊúâËß£ÂÜ≥Â§ö‰∏™proposerÂπ∂ÂèëÊâßË°åÁöÑÈóÆÈ¢ò„ÄÇÂè™ÊòØÊÉ≥ÂäûÊ≥ïÁªïÂºÄ‰∫ÜÂπ∂ÂèëÊâßË°å„ÄÇËôΩÁÑ∂ÂèØ‰ª•Âú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏ä‰øùËØÅvarÂèòÈáèÁöÑÂèñÂÄºÊòØÁ°ÆÂÆöÁöÑ„ÄÇ‰ΩÜÊòØ‰∏ÄÊó¶Ëé∑ÂèñÂà∞‰∫íÊñ•ËÆøÈóÆÊùÉÁöÑproposerÂú®ÊâßË°åËøáÁ®ã‰∏≠Âá∫Áé∞ÊïÖÈöúÔºåÈÇ£‰πàÂ∞±‰ºöÂØºËá¥ÊâÄÊúâÂÖ∂‰ªñproposerÊó†Ê≥ïÂÜçËé∑ÂèñÂà∞‰∫íÊñ•ËÆøÈóÆÊùÉÔºåÂ∞±‰ºöÂèëÁîüÊ≠ªÈîÅ„ÄÇ„ÄÇÊâÄ‰ª•ÔºåÊñπÊ°à‰∏Ä‰∏ç‰ªÖÊïàÁéá‰Ωé„ÄÅËÄå‰∏îËøò‰ºö‰∫ßÁîüÊ≠ªÈîÅÈóÆÈ¢òÔºå‰∏çËÉΩÂÆπÂøç‰ªªÊÑèProposerÂá∫Áé∞ÊïÖÈöú„ÄÇÂú®‰πãÂâçÊèêÂà∞ÁöÑÂõõ‰∏™Á≥ªÁªüÈöæÁÇπ‰∏≠ÔºåÊñπÊ°à‰∏ÄÂèØ‰ª•Ëß£ÂÜ≥ÈöæÁÇπ1ÂíåÈöæÁÇπ2Ôºå‰ΩÜÊòØÊó†Ê≥ïËß£ÂÜ≥ÈöæÁÇπ3ÂíåÈöæÁÇπ4„ÄÇ Ëß£ÂÜ≥ÊñπÊ°à‰∫åÈÄöËøáÂºïÂÖ•Êä¢Âç†ÂºèËÆøÈóÆÊùÉÊù•Âèñ‰ª£‰∫íÊñ•ËÆøÈóÆÊùÉ„ÄÇacceptorÊúâÊùÉËÆ©‰ªªÊÑèproposerÁöÑËÆøÈóÆÊùÉÂ§±ÊïàÔºåÁÑ∂ÂêéÂ∞ÜËÆøÈóÆÊùÉÂèëÊîæÁªôÂÖ∂‰ªñÁöÑproposer„ÄÇ Âú®ÊñπÊ°à‰∫å‰∏≠ÔºåproposerÂêëacceptorÂèëÂá∫ÁöÑÊØèÊ¨°ËØ∑Ê±ÇÈÉΩË¶ÅÂ∏¶‰∏Ä‰∏™ÁºñÂè∑ÔºàepochÔºâÔºå‰∏îÁºñÂè∑Èó¥Ë¶ÅÂ≠òÂú®ÂÖ®Â∫èÂÖ≥Á≥ª„ÄÇ‰∏ÄÊó¶acceptorÊé•Êî∂Âà∞proposerÁöÑËØ∑Ê±Ç‰∏≠ÂåÖÂê´‰∏Ä‰∏™Êõ¥Â§ßÁöÑepochÁöÑÊó∂ÂÄôÔºåÈ©¨‰∏äËÆ©ÊóßÁöÑepochÂ§±ÊïàÔºå‰∏çÂÜçÊé•Âèó‰ªñ‰ª¨Êèê‰∫§ÁöÑÂèñÂÄº„ÄÇÁÑ∂ÂêéÁªôÊñ∞ÁöÑepochÂèëÊîæËÆøÈóÆÊùÉÔºåËÆ©‰ªñÂèØ‰ª•ËÆæÁΩÆvarÂèòÈáèÁöÑÂÄº„ÄÇ ‰∏∫‰∫Ü‰øùËØÅvarÂèòÈáèÂèñÂÄºÁöÑ‰∏çÂèòÊÄßÔºå‰∏çÂêåepochÁöÑproposer‰πãÂâçÈÅµÂÆàÂêéËÄÖËÆ§ÂêåÂâçËÄÖÁöÑÂéüÂàôÔºö Âú®Á°Æ‰øùÊóßÁöÑepochÂ∑≤ÁªèÂ§±ÊïàÂêéÔºåÂπ∂‰∏îÊóßÁöÑepochÊ≤°ÊúâËÆæÁΩÆvarÂèòÈáèÁöÑÂÄºÔºåÊñ∞ÁöÑepoch‰ºöÊèê‰∫§Ëá™Â∑±ÁöÑÂÄº„ÄÇÂΩìÊóßÁöÑepochÂ∑≤ÁªèËÆæÁΩÆËøávarÂèòÈáèÁöÑÂèñÂÄºÔºåÈÇ£‰πàÊñ∞ÁöÑepochÂ∫îËØ•ËÆ§ÂêåÊóßÁöÑepochËÆæÁΩÆËøáÁöÑÂÄºÔºåÂπ∂‰∏çÂú®Êèê‰∫§Êñ∞ÁöÑÂÄº„ÄÇ]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑCAPÁêÜËÆ∫]]></title>
    <url>%2F2018%2F04%2F09%2F%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84CAP%E7%90%86%E8%AE%BA%2F</url>
    <content type="text"><![CDATA[2000Âπ¥7ÊúàÔºåÂä†Â∑ûÂ§ßÂ≠¶‰ºØÂÖãÂà©ÂàÜÊ†°ÁöÑEric BrewerÊïôÊéàÂú®ACM PODC‰ºöËÆÆ‰∏äÊèêÂá∫CAPÁåúÊÉ≥„ÄÇ2Âπ¥ÂêéÔºåÈ∫ªÁúÅÁêÜÂ∑•Â≠¶Èô¢ÁöÑSeth GilbertÂíåNancy Lynch‰ªéÁêÜËÆ∫‰∏äËØÅÊòé‰∫ÜCAP„ÄÇ‰πãÂêéÔºåCAPÁêÜËÆ∫Ê≠£ÂºèÊàê‰∏∫ÂàÜÂ∏ÉÂºèËÆ°ÁÆóÈ¢ÜÂüüÁöÑÂÖ¨ËÆ§ÂÆöÁêÜ„ÄÇ CAPÁêÜËÆ∫Ê¶ÇËø∞‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊúÄÂ§öÂè™ËÉΩÂêåÊó∂Êª°Ë∂≥‰∏ÄËá¥ÊÄßÔºàConsistencyÔºâ„ÄÅÂèØÁî®ÊÄßÔºàAvailabilityÔºâÂíåÂàÜÂå∫ÂÆπÈîôÊÄßÔºàPartition toleranceÔºâËøô‰∏âÈ°π‰∏≠ÁöÑ‰∏§È°π„ÄÇ CAPÁöÑÂÆö‰πâConsistency ‰∏ÄËá¥ÊÄß‰∏ÄËá¥ÊÄßÊåá‚Äúall nodes see the same data at the same time‚ÄùÔºåÂç≥Êõ¥Êñ∞Êìç‰ΩúÊàêÂäüÂπ∂ËøîÂõûÂÆ¢Êà∑Á´ØÂÆåÊàêÂêéÔºåÊâÄÊúâËäÇÁÇπÂú®Âêå‰∏ÄÊó∂Èó¥ÁöÑÊï∞ÊçÆÂÆåÂÖ®‰∏ÄËá¥„ÄÇÂàÜÂ∏ÉÂºèÁöÑ‰∏ÄËá¥ÊÄß ÂØπ‰∫é‰∏ÄËá¥ÊÄßÔºåÂèØ‰ª•ÂàÜ‰∏∫‰ªéÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´Ø‰∏§‰∏™‰∏çÂêåÁöÑËßÜËßí„ÄÇ‰ªéÂÆ¢Êà∑Á´ØÊù•ÁúãÔºå‰∏ÄËá¥ÊÄß‰∏ªË¶ÅÊåáÁöÑÊòØÂ§öÂπ∂ÂèëËÆøÈóÆÊó∂Êõ¥Êñ∞ËøáÁöÑÊï∞ÊçÆÂ¶Ç‰ΩïËé∑ÂèñÁöÑÈóÆÈ¢ò„ÄÇ‰ªéÊúçÂä°Á´ØÊù•ÁúãÔºåÂàôÊòØÊõ¥Êñ∞Â¶Ç‰ΩïÂ§çÂà∂ÂàÜÂ∏ÉÂà∞Êï¥‰∏™Á≥ªÁªüÔºå‰ª•‰øùËØÅÊï∞ÊçÆÊúÄÁªà‰∏ÄËá¥„ÄÇ‰∏ÄËá¥ÊÄßÊòØÂõ†‰∏∫ÊúâÂπ∂ÂèëËØªÂÜôÊâçÊúâÁöÑÈóÆÈ¢òÔºåÂõ†Ê≠§Âú®ÁêÜËß£‰∏ÄËá¥ÊÄßÁöÑÈóÆÈ¢òÊó∂Ôºå‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÁªìÂêàËÄÉËôëÂπ∂ÂèëËØªÂÜôÁöÑÂú∫ÊôØ„ÄÇ ‰ªéÂÆ¢Êà∑Á´ØËßíÂ∫¶ÔºåÂ§öËøõÁ®ãÂπ∂ÂèëËÆøÈóÆÊó∂ÔºåÊõ¥Êñ∞ËøáÁöÑÊï∞ÊçÆÂú®‰∏çÂêåËøõÁ®ãÂ¶Ç‰ΩïËé∑ÂèñÁöÑ‰∏çÂêåÁ≠ñÁï•ÔºåÂÜ≥ÂÆö‰∫Ü‰∏çÂêåÁöÑ‰∏ÄËá¥ÊÄß„ÄÇÂØπ‰∫éÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºåË¶ÅÊ±ÇÊõ¥Êñ∞ËøáÁöÑÊï∞ÊçÆËÉΩË¢´ÂêéÁª≠ÁöÑËÆøÈóÆÈÉΩËÉΩÁúãÂà∞ÔºåËøôÊòØÂº∫‰∏ÄËá¥ÊÄß„ÄÇÂ¶ÇÊûúËÉΩÂÆπÂøçÂêéÁª≠ÁöÑÈÉ®ÂàÜÊàñËÄÖÂÖ®ÈÉ®ËÆøÈóÆ‰∏çÂà∞ÔºåÂàôÊòØÂº±‰∏ÄËá¥ÊÄß„ÄÇÂ¶ÇÊûúÁªèËøá‰∏ÄÊÆµÊó∂Èó¥ÂêéË¶ÅÊ±ÇËÉΩËÆøÈóÆÂà∞Êõ¥Êñ∞ÂêéÁöÑÊï∞ÊçÆÔºåÂàôÊòØÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇ Availability ÂèØÁî®ÊÄßÂèØÁî®ÊÄßÊåá‚ÄúReads and writes always succeed‚ÄùÔºåÂç≥ÊúçÂä°‰∏ÄÁõ¥ÂèØÁî®ÔºåËÄå‰∏îÊòØÊ≠£Â∏∏ÂìçÂ∫îÊó∂Èó¥„ÄÇ ÂØπ‰∫é‰∏Ä‰∏™ÂèØÁî®ÊÄßÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªüÔºåÊØè‰∏Ä‰∏™ÈùûÊïÖÈöúÁöÑËäÇÁÇπÂøÖÈ°ªÂØπÊØè‰∏Ä‰∏™ËØ∑Ê±Ç‰ΩúÂá∫ÂìçÂ∫î„ÄÇ‰πüÂ∞±ÊòØÔºåËØ•Á≥ªÁªü‰ΩøÁî®ÁöÑ‰ªª‰ΩïÁÆóÊ≥ïÂøÖÈ°ªÊúÄÁªàÁªàÊ≠¢„ÄÇÂΩìÂêåÊó∂Ë¶ÅÊ±ÇÂàÜÂå∫ÂÆπÂøçÊÄßÊó∂ÔºåËøôÊòØ‰∏Ä‰∏™ÂæàÂº∫ÁöÑÂÆö‰πâÔºöÂç≥‰ΩøÊòØ‰∏•ÈáçÁöÑÁΩëÁªúÈîôËØØÔºåÊØè‰∏™ËØ∑Ê±ÇÂøÖÈ°ªÁªàÊ≠¢„ÄÇ Â•ΩÁöÑÂèØÁî®ÊÄß‰∏ªË¶ÅÊòØÊåáÁ≥ªÁªüËÉΩÂ§üÂæàÂ•ΩÁöÑ‰∏∫Áî®Êà∑ÊúçÂä°Ôºå‰∏çÂá∫Áé∞Áî®Êà∑Êìç‰ΩúÂ§±Ë¥•ÊàñËÄÖËÆøÈóÆË∂ÖÊó∂Á≠âÁî®Êà∑‰ΩìÈ™å‰∏çÂ•ΩÁöÑÊÉÖÂÜµ„ÄÇÂèØÁî®ÊÄßÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÂèØÁî®ÊÄßÂíåÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂÜó‰ΩôÔºåË¥üËΩΩÂùáË°°Á≠âÊúâÁùÄÂæàÂ§ßÁöÑÂÖ≥ËÅî„ÄÇ Partition ToleranceÂàÜÂå∫ÂÆπÈîôÊÄßÂàÜÂå∫ÂÆπÈîôÊÄßÊåá‚Äúthe system continues to operate despite arbitrary message loss or failure of part of the system‚ÄùÔºåÂç≥ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂú®ÈÅáÂà∞ÊüêËäÇÁÇπÊàñÁΩëÁªúÂàÜÂå∫ÊïÖÈöúÁöÑÊó∂ÂÄôÔºå‰ªçÁÑ∂ËÉΩÂ§üÂØπÂ§ñÊèê‰æõÊª°Ë∂≥‰∏ÄËá¥ÊÄßÂíåÂèØÁî®ÊÄßÁöÑÊúçÂä°„ÄÇ ÂàÜÂå∫ÂÆπÈîôÊÄßÂíåÊâ©Â±ïÊÄßÁ¥ßÂØÜÁõ∏ÂÖ≥„ÄÇÂú®ÂàÜÂ∏ÉÂºèÂ∫îÁî®‰∏≠ÔºåÂèØËÉΩÂõ†‰∏∫‰∏Ä‰∫õÂàÜÂ∏ÉÂºèÁöÑÂéüÂõ†ÂØºËá¥Á≥ªÁªüÊó†Ê≥ïÊ≠£Â∏∏ËøêËΩ¨„ÄÇÂ•ΩÁöÑÂàÜÂå∫ÂÆπÈîôÊÄßË¶ÅÊ±ÇËÉΩÂ§ü‰ΩøÂ∫îÁî®ËôΩÁÑ∂ÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÔºåËÄåÁúã‰∏äÂéªÂç¥Â•ΩÂÉèÊòØÂú®‰∏Ä‰∏™ÂèØ‰ª•ËøêËΩ¨Ê≠£Â∏∏ÁöÑÊï¥‰Ωì„ÄÇÊØîÂ¶ÇÁé∞Âú®ÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÊúâÊüê‰∏Ä‰∏™ÊàñËÄÖÂá†‰∏™Êú∫Âô®ÂÆïÊéâ‰∫ÜÔºåÂÖ∂‰ªñÂâ©‰∏ãÁöÑÊú∫Âô®ËøòËÉΩÂ§üÊ≠£Â∏∏ËøêËΩ¨Êª°Ë∂≥Á≥ªÁªüÈúÄÊ±ÇÔºåÊàñËÄÖÊòØÊú∫Âô®‰πãÈó¥ÊúâÁΩëÁªúÂºÇÂ∏∏ÔºåÂ∞ÜÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂàÜÈöîÊú™Áã¨Á´ãÁöÑÂá†‰∏™ÈÉ®ÂàÜÔºåÂêÑ‰∏™ÈÉ®ÂàÜËøòËÉΩÁª¥ÊåÅÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑËøê‰ΩúÔºåËøôÊ†∑Â∞±ÂÖ∑ÊúâÂ•ΩÁöÑÂàÜÂå∫ÂÆπÈîôÊÄß„ÄÇ CAPÁöÑËØÅÊòé Â¶Ç‰∏äÂõæÔºåÊòØÊàë‰ª¨ËØÅÊòéCAPÁöÑÂü∫Êú¨Âú∫ÊôØÔºåÁΩëÁªú‰∏≠Êúâ‰∏§‰∏™ËäÇÁÇπN1ÂíåN2ÔºåÂèØ‰ª•ÁÆÄÂçïÁöÑÁêÜËß£N1ÂíåN2ÂàÜÂà´ÊòØ‰∏§Âè∞ËÆ°ÁÆóÊú∫Ôºå‰ªñ‰ª¨‰πãÈó¥ÁΩëÁªúÂèØ‰ª•ËøûÈÄöÔºåN1‰∏≠Êúâ‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èAÔºåÂíå‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìVÔºåN2‰πüÊúâ‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èB2Âíå‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìV„ÄÇÁé∞Âú®ÔºåAÂíåBÊòØÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑ‰∏§‰∏™ÈÉ®ÂàÜÔºåVÊòØÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑÊï∞ÊçÆÂ≠òÂÇ®ÁöÑ‰∏§‰∏™Â≠êÊï∞ÊçÆÂ∫ì„ÄÇ Âú®Êª°Ë∂≥‰∏ÄËá¥ÊÄßÁöÑÊó∂ÂÄôÔºåN1ÂíåN2‰∏≠ÁöÑÊï∞ÊçÆÊòØ‰∏ÄÊ†∑ÁöÑÔºåV0=V0„ÄÇÂú®Êª°Ë∂≥ÂèØÁî®ÊÄßÁöÑÊó∂ÂÄôÔºåÁî®Êà∑‰∏çÁÆ°ÊòØËØ∑Ê±ÇN1ÊàñËÄÖN2ÔºåÈÉΩ‰ºöÂæóÂà∞Á´ãÂç≥ÂìçÂ∫î„ÄÇÂú®Êª°Ë∂≥ÂàÜÂå∫ÂÆπÈîôÊÄßÁöÑÊÉÖÂÜµ‰∏ãÔºåN1ÂíåN2Êúâ‰ªª‰Ωï‰∏ÄÊñπÂÆïÊú∫ÔºåÊàñËÄÖÁΩëÁªú‰∏çÈÄöÁöÑÊó∂ÂÄôÔºåÈÉΩ‰∏ç‰ºöÂΩ±ÂìçN1ÂíåN2ÂΩºÊ≠§‰πãÈó¥ÁöÑÊ≠£Â∏∏Ëøê‰Ωú„ÄÇ Â¶Ç‰∏äÂõæÔºåÊòØÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊ≠£Â∏∏ËøêËΩ¨ÁöÑÊµÅÁ®ãÔºåÁî®Êà∑ÂêëN1Êú∫Âô®ËØ∑Ê±ÇÊï∞ÊçÆÊõ¥Êñ∞ÔºåÁ®ãÂ∫èAÊõ¥Êñ∞Êï∞ÊçÆÂ∫ìVo‰∏∫V1ÔºåÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂ∞ÜÊï∞ÊçÆËøõË°åÂêåÊ≠•Êìç‰ΩúMÔºåÂ∞ÜV1ÂêåÊ≠•ÁöÑN2‰∏≠V0Ôºå‰ΩøÂæóN2‰∏≠ÁöÑÊï∞ÊçÆV0‰πüÊõ¥Êñ∞‰∏∫V1ÔºåN2‰∏≠ÁöÑÊï∞ÊçÆÂÜçÂìçÂ∫îN2ÁöÑËØ∑Ê±Ç„ÄÇ ËøôÈáåÔºåÂèØ‰ª•ÂÆö‰πâN1ÂíåN2ÁöÑÊï∞ÊçÆÂ∫ìV‰πãÈó¥ÁöÑÊï∞ÊçÆÊòØÂê¶‰∏ÄÊ†∑‰∏∫‰∏ÄËá¥ÊÄßÔºõÂ§ñÈÉ®ÂØπN1ÂíåN2ÁöÑËØ∑Ê±ÇÂìçÂ∫î‰∏∫ÂèØÁî®Ë°åÔºõN1ÂíåN2‰πãÈó¥ÁöÑÁΩëÁªúÁéØÂ¢É‰∏∫ÂàÜÂå∫ÂÆπÈîôÊÄß„ÄÇËøôÊòØÊ≠£Â∏∏Ëøê‰ΩúÁöÑÂú∫ÊôØÔºå‰πüÊòØÁêÜÊÉ≥ÁöÑÂú∫ÊôØÔºåÁÑ∂ËÄåÁé∞ÂÆûÊòØÊÆãÈÖ∑ÁöÑÔºåÂΩìÈîôËØØÂèëÁîüÁöÑÊó∂ÂÄôÔºå‰∏ÄËá¥ÊÄßÂíåÂèØÁî®ÊÄßËøòÊúâÂàÜÂå∫ÂÆπÈîôÊÄßÔºåÊòØÂê¶ËÉΩÂêåÊó∂Êª°Ë∂≥ÔºåËøòÊòØËØ¥Ë¶ÅËøõË°åÂèñËàçÂë¢Ôºü ‰Ωú‰∏∫‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÔºåÂÆÉÂíåÂçïÊú∫Á≥ªÁªüÁöÑÊúÄÂ§ßÂå∫Âà´ÔºåÂ∞±Âú®‰∫éÁΩëÁªúÔºåÁé∞Âú®ÂÅáËÆæ‰∏ÄÁßçÊûÅÁ´ØÊÉÖÂÜµÔºåN1ÂíåN2‰πãÈó¥ÁöÑÁΩëÁªúÊñ≠ÂºÄ‰∫ÜÔºåÊàë‰ª¨Ë¶ÅÊîØÊåÅËøôÁßçÁΩëÁªúÂºÇÂ∏∏ÔºåÁõ∏ÂΩì‰∫éË¶ÅÊª°Ë∂≥ÂàÜÂå∫ÂÆπÈîôÊÄßÔºåËÉΩ‰∏çËÉΩÂêåÊó∂Êª°Ë∂≥‰∏ÄËá¥ÊÄßÂíåÂìçÂ∫îÊÄßÂë¢ÔºüËøòÊòØËØ¥Ë¶ÅÂØπ‰ªñ‰ª¨ËøõË°åÂèñËàç„ÄÇ ÂÅáËÆæÂú®N1ÂíåN2‰πãÈó¥ÁΩëÁªúÊñ≠ÂºÄÁöÑÊó∂ÂÄôÔºåÊúâÁî®Êà∑ÂêëN1ÂèëÈÄÅÊï∞ÊçÆÊõ¥Êñ∞ËØ∑Ê±ÇÔºåÈÇ£N1‰∏≠ÁöÑÊï∞ÊçÆV0Â∞ÜË¢´Êõ¥Êñ∞‰∏∫V1ÔºåÁî±‰∫éÁΩëÁªúÊòØÊñ≠ÂºÄÁöÑÔºåÊâÄ‰ª•ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂêåÊ≠•Êìç‰ΩúMÔºåÊâÄ‰ª•N2‰∏≠ÁöÑÊï∞ÊçÆ‰æùÊóßÊòØV0ÔºõËøô‰∏™Êó∂ÂÄôÔºåÊúâÁî®Êà∑ÂêëN2ÂèëÈÄÅÊï∞ÊçÆËØªÂèñËØ∑Ê±ÇÔºåÁî±‰∫éÊï∞ÊçÆËøòÊ≤°ÊúâËøõË°åÂêåÊ≠•ÔºåÂ∫îÁî®Á®ãÂ∫èÊ≤°ÂäûÊ≥ïÁ´ãÂç≥ÁªôÁî®Êà∑ËøîÂõûÊúÄÊñ∞ÁöÑÊï∞ÊçÆV1ÔºåÊÄé‰πàÂäûÂë¢ÔºüÊúâ‰∫åÁßçÈÄâÊã©ÔºåÁ¨¨‰∏ÄÔºåÁâ∫Áâ≤Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºåÂìçÂ∫îÊóßÁöÑÊï∞ÊçÆV0ÁªôÁî®Êà∑ÔºõÁ¨¨‰∫åÔºåÁâ∫Áâ≤ÂèØÁî®ÊÄßÔºåÈòªÂ°ûÁ≠âÂæÖÔºåÁõ¥Âà∞ÁΩëÁªúËøûÊé•ÊÅ¢Â§çÔºåÊï∞ÊçÆÊõ¥Êñ∞Êìç‰ΩúMÂÆåÊàê‰πãÂêéÔºåÂÜçÁªôÁî®Êà∑ÂìçÂ∫îÊúÄÊñ∞ÁöÑÊï∞ÊçÆV1„ÄÇ Ëøô‰∏™ËøáÁ®ãÔºåËØÅÊòé‰∫ÜË¶ÅÊª°Ë∂≥ÂàÜÂå∫ÂÆπÈîôÊÄßÁöÑÂàÜÂ∏ÉÂºèÁ≥ªÁªüÔºåÂè™ËÉΩÂú®‰∏ÄËá¥ÊÄßÂíåÂèØÁî®ÊÄß‰∏§ËÄÖ‰∏≠ÔºåÈÄâÊã©ÂÖ∂‰∏≠‰∏Ä‰∏™„ÄÇ CAPÊùÉË°°ÈÄöËøáCAPÁêÜËÆ∫ÔºåÊàë‰ª¨Áü•ÈÅìÊó†Ê≥ïÂêåÊó∂Êª°Ë∂≥‰∏ÄËá¥ÊÄß„ÄÅÂèØÁî®ÊÄßÂíåÂàÜÂå∫ÂÆπÈîôÊÄßËøô‰∏â‰∏™ÁâπÊÄßÔºåÈÇ£Ë¶ÅËàçÂºÉÂì™‰∏™Âë¢Ôºü CA without PÔºöÂ¶ÇÊûú‰∏çË¶ÅÊ±ÇPÔºà‰∏çÂÖÅËÆ∏ÂàÜÂå∫ÔºâÔºåÂàôCÔºàÂº∫‰∏ÄËá¥ÊÄßÔºâÂíåAÔºàÂèØÁî®ÊÄßÔºâÊòØÂèØ‰ª•‰øùËØÅÁöÑ„ÄÇ‰ΩÜÂÖ∂ÂÆûÂàÜÂå∫‰∏çÊòØ‰Ω†ÊÉ≥‰∏çÊÉ≥ÁöÑÈóÆÈ¢òÔºåËÄåÊòØÂßãÁªà‰ºöÂ≠òÂú®ÔºåÂõ†Ê≠§CAÁöÑÁ≥ªÁªüÊõ¥Â§öÁöÑÊòØÂÖÅËÆ∏ÂàÜÂå∫ÂêéÂêÑÂ≠êÁ≥ªÁªü‰æùÁÑ∂‰øùÊåÅCA„ÄÇ CP without AÔºöÂ¶ÇÊûú‰∏çË¶ÅÊ±ÇAÔºàÂèØÁî®ÔºâÔºåÁõ∏ÂΩì‰∫éÊØè‰∏™ËØ∑Ê±ÇÈÉΩÈúÄË¶ÅÂú®Server‰πãÈó¥Âº∫‰∏ÄËá¥ÔºåËÄåPÔºàÂàÜÂå∫Ôºâ‰ºöÂØºËá¥ÂêåÊ≠•Êó∂Èó¥Êó†ÈôêÂª∂ÈïøÔºåÂ¶ÇÊ≠§CP‰πüÊòØÂèØ‰ª•‰øùËØÅÁöÑ„ÄÇÂæàÂ§ö‰º†ÁªüÁöÑÊï∞ÊçÆÂ∫ìÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈÉΩÂ±û‰∫éËøôÁßçÊ®°Âºè„ÄÇ AP wihtout CÔºöË¶ÅÈ´òÂèØÁî®Âπ∂ÂÖÅËÆ∏ÂàÜÂå∫ÔºåÂàôÈúÄÊîæÂºÉ‰∏ÄËá¥ÊÄß„ÄÇ‰∏ÄÊó¶ÂàÜÂå∫ÂèëÁîüÔºåËäÇÁÇπ‰πãÈó¥ÂèØËÉΩ‰ºöÂ§±ÂéªËÅîÁ≥ªÔºå‰∏∫‰∫ÜÈ´òÂèØÁî®ÔºåÊØè‰∏™ËäÇÁÇπÂè™ËÉΩÁî®Êú¨Âú∞Êï∞ÊçÆÊèê‰æõÊúçÂä°ÔºåËÄåËøôÊ†∑‰ºöÂØºËá¥ÂÖ®Â±ÄÊï∞ÊçÆÁöÑ‰∏ç‰∏ÄËá¥ÊÄß„ÄÇÁé∞Âú®‰ºóÂ§öÁöÑNoSQLÈÉΩÂ±û‰∫éÊ≠§Á±ª„ÄÇ ÂØπ‰∫éÂ§öÊï∞Â§ßÂûã‰∫íËÅîÁΩëÂ∫îÁî®ÁöÑÂú∫ÊôØÔºå‰∏ªÊú∫‰ºóÂ§ö„ÄÅÈÉ®ÁΩ≤ÂàÜÊï£ÔºåËÄå‰∏îÁé∞Âú®ÁöÑÈõÜÁæ§ËßÑÊ®°Ë∂äÊù•Ë∂äÂ§ßÔºåÊâÄ‰ª•ËäÇÁÇπÊïÖÈöú„ÄÅÁΩëÁªúÊïÖÈöúÊòØÂ∏∏ÊÄÅÔºåËÄå‰∏îË¶Å‰øùËØÅÊúçÂä°ÂèØÁî®ÊÄßËææÂà∞N‰∏™9ÔºåÂç≥‰øùËØÅPÂíåAÔºåËàçÂºÉCÔºàÈÄÄËÄåÊ±ÇÂÖ∂Ê¨°‰øùËØÅÊúÄÁªà‰∏ÄËá¥ÊÄßÔºâ„ÄÇËôΩÁÑ∂Êüê‰∫õÂú∞Êñπ‰ºöÂΩ±ÂìçÂÆ¢Êà∑‰ΩìÈ™åÔºå‰ΩÜÊ≤°ËææÂà∞ÈÄ†ÊàêÁî®Êà∑ÊµÅÁ®ãÁöÑ‰∏•ÈáçÁ®ãÂ∫¶„ÄÇ ÂØπ‰∫éÊ∂âÂèäÂà∞Èí±Ë¥¢ËøôÊ†∑‰∏çËÉΩÊúâ‰∏Ä‰∏ùËÆ©Ê≠•ÁöÑÂú∫ÊôØÔºåCÂøÖÈ°ª‰øùËØÅ„ÄÇÁΩëÁªúÂèëÁîüÊïÖÈöúÂÆÅÂèØÂÅúÊ≠¢ÊúçÂä°ÔºåËøôÊòØ‰øùËØÅCAÔºåËàçÂºÉP„ÄÇË≤å‰ººËøôÂá†Âπ¥ÂõΩÂÜÖÈì∂Ë°å‰∏öÂèëÁîü‰∫Ü‰∏ç‰∏ã10Ëµ∑‰∫ãÊïÖÔºå‰ΩÜÂΩ±ÂìçÈù¢‰∏çÂ§ßÔºåÊä•Âà∞‰πü‰∏çÂ§öÔºåÂπøÂ§ßÁæ§‰ºóÁü•ÈÅìÁöÑÂ∞ë„ÄÇËøòÊúâ‰∏ÄÁßçÊòØ‰øùËØÅCPÔºåËàçÂºÉA„ÄÇ‰æãÂ¶ÇÁΩëÁªúÊïÖÈöú‰∫ãÂè™ËØª‰∏çÂÜô„ÄÇ Â≠∞‰ºòÂ≠∞Áï•ÔºåÊ≤°ÊúâÂÆöËÆ∫ÔºåÂè™ËÉΩÊ†πÊçÆÂú∫ÊôØÂÆöÂ§∫ÔºåÈÄÇÂêàÁöÑÊâçÊòØÊúÄÂ•ΩÁöÑ„ÄÇ]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[maven‰ΩøÁî®ÊâãÂÜå]]></title>
    <url>%2F2018%2F03%2F28%2Fmaven%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C%2F</url>
    <content type="text"><![CDATA[‰æùËµñÊú∫Âà∂1„ÄÅA-&gt;B-&gt;C-&gt;X(1.0)ÔºåA-&gt;D-&gt;X(2.0)ÔºåÊ≠§Êó∂‰∏§Êù°‰æùËµñË∑ØÂæÑ‰∏äÊúâ‰∏§‰∏™ÁâàÊú¨ÁöÑXÔºåÊ≠§Êó∂ÈÅµÂæ™Ë∑ØÂæÑÊúÄËøëËÄÖ‰ºòÂÖàÔºåÂõ†Ê≠§X(2.0)Â∞ÜË¢´Ëß£Êûê‰ΩøÁî® 2„ÄÅA-&gt;B-&gt;Y(1.0)ÔºåA-&gt;C-&gt;Y(2.0)ÔºåY(1.0)ÂíåY(2.0)ÁöÑ‰æùËµñÈïøÂ∫¶ÊòØ‰∏ÄÊ†∑ÁöÑÔºå‰ªéMaven2.0.9ÂºÄÂßãÔºåÊ≠§Êó∂ÈÅµÂæ™Á¨¨‰∏ÄÂ£∞ÊòéËÄÖ‰ºòÂÖàÔºåÂç≥È°∫Â∫èÊúÄÈù†ÂâçÁöÑÈÇ£‰∏™‰æùËµñ‰ºòÂÖà ‰æùËµñÊ†ëÊü•Áúã1mvn dependency:tree -Dincludes=org.apache.httpcomponents:httpclient ÂèÇËÄÉ http://maven.apache.org/plugins/maven-dependency-plugin/tree-mojo.html ÊéíÈô§‰æùËµñ‰º†ÈÄíÊÄß‰æùËµñ‰ºöÁªôÈ°πÁõÆÈöêÂºèÂú∞ÂºïÂÖ•ÂæàÂ§ö‰æùËµñÔºåËøôÊûÅÂ§ßÂú∞ÁÆÄÂåñ‰∫ÜÈ°πÁõÆ‰æùËµñÁöÑÁÆ°ÁêÜÔºå‰ΩÜÊòØÊúâÊó∂ÂÄôËøôÁßçÁâπÊÄß‰πü‰ºöÂ∏¶Êù•ÈóÆÈ¢ò„ÄÇÊØîÂ¶ÇÊúâÁßçÊÉÖÂÜµÔºö 1ÂΩìÂâçÈ°πÁõÆ‰æùËµñAÔºåAÁî±‰∫éÊüê‰∫õÂéüÂõ†‰æùËµñ‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™Á±ªÂ∫ìÁöÑSNAPSHOTÁâàÊú¨ÔºåÈÇ£‰πàËøô‰∏™SNAPSHOTÂ∞±‰ºöÊàê‰∏∫ÂΩìÂâçÈ°πÁõÆÁöÑ‰º†ÈÄíÊÄß‰æùËµñÔºå‰∫åSNAPSHOTÁöÑ‰∏çÁ®≥ÂÆöÊÄßÂ∞ÜÁõ¥Êé•ÂΩ±ÂìçÂà∞ÂΩìÂâçÁöÑÈ°πÁõÆÔºåÊ≠§Êó∂Â∞±ÈúÄË¶ÅÊéíÈô§ËØ•SNAPSHOTÔºåÂπ∂‰∏îÂú®ÂΩìÂâçÈ°πÁõÆ‰∏≠Â£∞ÊòéËØ•Á±ªÂ∫ìÁöÑÊüê‰∏™Ê≠£ÂºèÂèëÂ∏ÉÁöÑÁâàÊú¨ 1234567891011&lt;dependency&gt; &lt;groupId&gt;com.alibaba.rocketmq&lt;/groupId&gt; &lt;artifactId&gt;rocketmq-client&lt;/artifactId&gt; &lt;version&gt;3.2.7&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;apache-lang&lt;/groupId&gt; &lt;artifactId&gt;commons-lang&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt; settings.xmlproxyproxyË°®Á§∫MavenÁöÑ‰ª£ÁêÜÔºåÁúã‰∏Ä‰∏ãÂÜôÊ≥ïÔºö 123456789101112&lt;proxies&gt; &lt;proxy&gt; &lt;id&gt;optional&lt;/id&gt; &lt;active&gt;true&lt;/active&gt; &lt;protocol&gt;http&lt;/protocol&gt; &lt;username&gt;proxyuser&lt;/username&gt; &lt;password&gt;proxypass&lt;/password&gt; &lt;host&gt;proxy.host.net&lt;/host&gt; &lt;port&gt;80&lt;/port&gt; &lt;nonProxyHosts&gt;local.net|some.host.com&lt;/nonProxyHosts&gt; &lt;/proxy&gt;&lt;/proxies&gt; ÈúÄË¶ÅproxyÊòØÂõ†‰∏∫ÂæàÂ§öÊó∂ÂÄô‰Ω†ÊâÄÂú®ÁöÑÂÖ¨Âè∏Âü∫‰∫éÂÆâÂÖ®Âõ†Á¥†ËÄÉËôëÔºåË¶ÅÊ±Ç‰Ω†‰ΩøÁî®ÈÄöËøáÂÆâÂÖ®ËÆ§ËØÅÁöÑ‰ª£ÁêÜËÆøÈóÆÂõ†ÁâπÁΩë„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ∞±ÈúÄË¶Å‰∏∫MavenÈÖçÁΩÆHTTP‰ª£ÁêÜÔºåÊâçËÉΩËÆ©ÂÆÉÊ≠£Â∏∏ËÆøÈóÆÂ§ñÈÉ®‰ªìÂ∫ìÔºå‰ª•‰∏ãËΩΩÊâÄÈúÄË¶ÅÁöÑËµÑÊ∫ê„ÄÇproxies‰∏ãÂèØ‰ª•ÈÖçÁΩÆÂ§ö‰∏™proxyÂÖÉÁ¥†ÔºåÂ¶ÇÊûúÂ£∞Êòé‰∫ÜÂ§ö‰∏™proxyÂÖÉÁ¥†ÔºåÂàôÈªòËÆ§ÊÉÖÂÜµ‰∏ãÁ¨¨‰∏Ä‰∏™Ë¢´ÊøÄÊ¥ªÁöÑproxy‰ºöÁîüÊïà„ÄÇactive‰∏∫trueË°®Á§∫ÊøÄÊ¥ªËØ•‰ª£ÁêÜÔºåprotocolË°®Á§∫‰ΩøÁî®ÁöÑ‰ª£ÁêÜÂçèËÆÆÔºåÂΩìÁÑ∂ÊúÄÈáçË¶ÅÁöÑÊòØÊåáÂÆöÊ≠£Á°ÆÁöÑ‰∏ªÊú∫ÂêçÔºàhostÔºâÂíåÁ´ØÂè£ÔºàportÔºâÔºåÂ¶ÇÊûú‰ª£ÁêÜÊúçÂä°Âô®ÈúÄË¶ÅËÆ§ËØÅÂàôÈÖçÁΩÆusernameÂíåpasswordÔºånonProxyHostÂÖÉÁ¥†Ë°®Á§∫ÊåáÂÆöÂì™‰∫õ‰∏ªÊú∫Âêç‰∏çÈúÄË¶Å‰ª£ÁêÜÔºåÂèØ‰ª•Áî®‚Äù|‚ÄùÂàÜÈöîÂ§ö‰∏™‰∏ªÊú∫ÂêçÔºå‰πüÊîØÊåÅÈÄöÈÖçÁ¨¶‚Äù*‚Äù„ÄÇ repositoryrepositoryË°®Á§∫MavenÁöÑ‰∏≠Â§Æ‰ªìÂ∫ìÔºåÂõ†‰∏∫Â∞ΩÁÆ°ÈªòËÆ§ÁöÑËøúÁ®ã‰ªìÂ∫ì‰∏≠ÁöÑÊûÑ‰ª∂ÈùûÂ∏∏Â∫ûÂ§ßÔºå‰ΩÜÊòØÊÄªÂΩí‰ºöÊúâ‰∏çÊª°Ë∂≥Êàë‰ª¨ÈúÄÊ±ÇÁöÑÊó∂ÂÄôÔºåËøôÊó∂ÂÄôÂ∞±Ë¶ÅÁî®Âà∞Âà´ÁöÑ‰∏≠Â§Æ‰ªìÂ∫ì‰∫Ü„ÄÇÁúã‰∏Ä‰∏ãÂÜôÊ≥ïÔºö 1234567891011&lt;repository&gt; &lt;id&gt;public&lt;/id&gt; &lt;name&gt;local private nexus&lt;/name&gt; &lt;url&gt;http://192.168.1.6:8081/nexus/content/groups/public&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt;&lt;/repository&gt; ÂèØ‰ª•Â£∞ÊòéÂ§ö‰∏™repository„ÄÇidÂøÖÈ°ªÊòØÂîØ‰∏ÄÁöÑÔºåÂ∞§ÂÖ∂Ê≥®ÊÑèÔºåMavenËá™Â∏¶ÁöÑ‰∏≠Â§Æ‰ªìÂ∫ì‰ΩøÁî®ÁöÑid‰∏∫centralÔºåÂ¶ÇÊûúÂÖ∂‰ªñ‰ªìÂ∫ìÂ£∞Êòé‰πüÁî®ËØ•idÔºåÂ∞±‰ºöË¶ÜÁõñ‰∏≠Â§Æ‰ªìÂ∫ìÁöÑÈÖçÁΩÆ„ÄÇreleasesÂíåsnapshotsÊØîËæÉÈáçË¶ÅÔºåÂâçËÄÖË°®Á§∫ÂºÄÂêØ‰ªìÂ∫ìÁöÑÂèëÂ∏ÉÁâàÊú¨‰∏ãËΩΩÊîØÊåÅÔºåÂêéËÄÖË°®Á§∫ÂÖ≥Èó≠‰ªìÂ∫ìÁöÑÂø´ÁÖßÁâàÊú¨‰∏ãËΩΩÊîØÊåÅÔºåËøôÊ†∑‰∏ÄÊù•ÔºåMavenÂ∞±‰ºöÂéª‰ªìÂ∫ì‰∏ãËΩΩÂèëÂ∏ÉÁâàÊú¨ÁöÑÊûÑ‰ª∂ËÄå‰∏ç‰ºö‰∏ãËΩΩÂø´ÁÖßÁâàÊú¨ÁöÑÊûÑ‰ª∂‰∫Ü„ÄÇ serverÂ§ßÈÉ®ÂàÜËøúÁ®ã‰ªìÂ∫ìÊó†È°ªËÆ§ËØÅÂ∞±ÂèØ‰ª•ËÆøÈóÆÔºå‰ΩÜÊòØÊúâÊó∂ÂÄôÂ§Ñ‰∫éÂÆâÂÖ®ÊñπÈù¢ÁöÑÂõ†Á¥†ËÄÉËôëÔºåÈúÄË¶ÅÊèê‰æõËÆ§ËØÅ‰ø°ÊÅØÊâçËÉΩËÆøÈóÆ‰∏Ä‰∫õËøúÁ®ã‰ªìÂ∫ìÔºåÂ§Ñ‰∫éÂÆâÂÖ®ËÄÉËôëÔºåËÆ§ËØÅ‰ø°ÊÅØ‰∏ÄËà¨Âè™ÊîæÂú®settings.xml‰∏≠ÔºåserverÂ∞±ÊòØËÆ§ËØÅÂÖÉÁ¥†„ÄÇÁúã‰∏Ä‰∏ãÈÖçÁΩÆÔºö 12345&lt;server&gt; &lt;id&gt;nexus-releases&lt;/id&gt; &lt;username&gt;deployment&lt;/username&gt; &lt;password&gt;deployment&lt;/password&gt;&lt;/server&gt; ËøôÈáåÁöÑÂÖ≥ÈîÆÊòØidÔºåËøô‰∏™idÂøÖÈ°ª‰∏éÈúÄË¶ÅËÆ§ËØÅÁöÑrepositoryÂÖÉÁ¥†ÁöÑidÂÆåÂÖ®‰∏ÄËá¥ÊâçË°åÔºåÊç¢Âè•ËØùËØ¥ÔºåÊ≠£ÂºèËøô‰∏™idÂ∞ÜËÆ§ËØÅ‰ø°ÊÅØÂíå‰ªìÂ∫ìÈÖçÁΩÆËÅîÁ≥ªÂú®‰∫Ü‰∏ÄËµ∑„ÄÇ mirrorÂ¶ÇÊûú‰ªìÂ∫ìXÂèØ‰ª•Êèê‰æõ‰ªìÂ∫ìYÂ≠òÂÇ®ÁöÑÊâÄÊúâÂÜÖÂÆπÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ËÆ§‰∏∫‰ªìÂ∫ìXÊòØ‰ªìÂ∫ìYÁöÑ‰∏Ä‰∏™ÈïúÂÉèÔºàmirrorÔºâÔºåÊç¢Âè•ËØùËØ¥Ôºå‰ªª‰Ωï‰∏Ä‰∏™ÂèØ‰ª•‰ªéY‰∏≠Ëé∑ÂèñÂà∞ÁöÑÊûÑ‰ª∂Â§üÂèØ‰ª•‰ªéX‰∏≠Ëé∑ÂèñÂà∞„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºå‚Äùhttp://maven.net.cn/content/groups/public/&quot;ÊòØ‰∏≠Â§Æ‰ªìÂ∫ì&quot;http://repo1.maven.org/maven2/&quot;Âú®‰∏≠ÂõΩÁöÑÈïúÂÉèÔºåÁî±‰∫éÂú∞ÁêÜ‰ΩçÁΩÆÁöÑÂõ†Á¥†ÔºåËØ•ÈïúÂÉèÂæÄÂæÄËÉΩÂ§üÊèê‰æõÊØî‰∏≠Â§Æ‰ªìÂ∫ìÊõ¥Âø´ÁöÑÊúçÂä°ÔºåËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®mirrorÁöÑÂéüÂõ†„ÄÇ Áúã‰∏Ä‰∏ãmirrorÁöÑÈÖçÁΩÆÔºö 123456&lt;mirror&gt; &lt;id&gt;nexus&lt;/id&gt; &lt;name&gt;internal nexus repository&lt;/name&gt; &lt;url&gt;http://192.168.1.6:8081/nexus/content/groups/public&lt;/url&gt; &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;&lt;/mirror&gt; ËØ•‰æãÂ≠ê‰∏≠Ôºåmirrof‰∏∫*ÔºåË°®Á§∫ËØ•ÈÖçÁΩÆ‰∏∫ÊâÄÊúâ‰∏≠Â§Æ‰ªìÂ∫ìÁöÑÈïúÂÉèÔºå‰ªª‰ΩïÂØπ‰∫é‰∏≠Â§Æ‰ªìÂ∫ìÁöÑËØ∑Ê±ÇÈÉΩ‰ºöËΩ¨Ëá≥ËØ•ÈïúÂÉè„ÄÇÂè¶Â§ñ‰∏â‰∏™ÂÖÉÁ¥†id„ÄÅname„ÄÅurl‰∏é‰∏ÄËà¨‰ªìÂ∫ìÈÖçÁΩÆÊó†ÂºÇÔºåË°®Á§∫ËØ•ÈïúÂÉè‰ªìÂ∫ìÁöÑÂîØ‰∏ÄÊ†áËØÜÁ¨¶„ÄÅÂêçÁß∞‰ª•ÂèäÂú∞ÂùÄ„ÄÇÁ±ª‰ººÁöÑÔºåÂ¶ÇÊûúËØ•ÈïúÂÉèÈúÄË¶ÅËÆ§ËØÅÔºå‰πüÂèØ‰ª•Âü∫‰∫éËØ•idÈÖçÁΩÆ‰ªìÂ∫ìËÆ§ËØÅ„ÄÇ maven deployÊåáÂÆöÊñá‰ª∂deploy 1mvn clean deploy -f pom-deploy.xml]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ÂÆâÂÖ®ÊäÄÊúØ--ÂìàÂ∏åÁÆóÊ≥ïÂØÜÁ†ÅÁ†¥Ëß£‰πãÂΩ©ËôπË°®]]></title>
    <url>%2F2018%2F03%2F27%2F%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF-%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3%E4%B9%8B%E5%BD%A9%E8%99%B9%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[[Âü∫Á°ÄÊäÄËÉΩ] ÂÆâÂÖ®ÊäÄÊúØ‚Äî‚ÄîÂìàÂ∏åÁÆóÊ≥ïÂØÜÁ†ÅÁ†¥Ëß£‰πãÂΩ©ËôπË°®(Rainbow Table)Â≠¶‰π†1„ÄÅÂü∫Á°ÄÁü•ËØÜÂàöÂàöÂ≠¶‰π†ËøáÊï∞Â≠óÁ≠æÂêçÁöÑÁõ∏ÂÖ≥Áü•ËØÜÔºå‰ª•ÂèäÊï∞Â≠óÁ≠æÂêçÁöÑ‰º™ÈÄ†ÊäÄÊúØÔºåËÄå‰º™ÈÄ†Êï∞Â≠óÁ≠æÂêçÂΩíÊ†πÁªìÂ∫ïÂ∞±ÊòØÂØÜÁ†ÅÁ†¥Ëß£ÁöÑ‰∏Ä‰∏™ËøáÁ®ãÔºåÁÑ∂ËÄåÁõ¥Êé•Á†¥Ëß£ÁöÑÈÄüÂ∫¶ÊòØÈùûÂ∏∏ÁºìÊÖ¢ÁöÑÔºåÊâÄ‰ª•Êúâ‰∫∫ÊÉ≥Âá∫‰∏ÄÁßçÂäûÊ≥ïÔºåÁõ¥Êé•Âª∫Á´ãÂá∫‰∏Ä‰∏™Êï∞ÊçÆÊñá‰ª∂ÔºåÈáåÈù¢‰∫ãÂÖàËÆ∞ÂΩï‰∫ÜÈááÁî®ÂíåÁõÆÊ†áÈááÁî®ÂêåÊ†∑ÁÆóÊ≥ïËÆ°ÁÆóÂêéÁîüÊàêÁöÑHashÊï£ÂàóÊï∞ÂÄºÔºåÂú®ÈúÄË¶ÅÁ†¥Ëß£ÁöÑÊó∂ÂÄôÁõ¥Êé•Ë∞ÉÁî®ËøôÊ†∑ÁöÑÊñá‰ª∂ËøõË°åÊØîÂØπÔºåÁ†¥Ëß£ÊïàÁéáÂ∞±ÂèØ‰ª•Â§ßÂπÖÂ∫¶Âú∞ÔºåÁîöËá≥ÊàêÁôæËøëÂçÉËøë‰∏áÂÄçÂú∞ÊèêÈ´òÔºåËøôÊ†∑‰∫ãÂÖàÊûÑÈÄ†ÁöÑHashÊï£ÂàóÊï∞ÊçÆÊñá‰ª∂Âú®ÂÆâÂÖ®ÁïåË¢´Áß∞‰πã‰∏∫Table„ÄÇ ÂÖ∂ÂÆûÁÆÄÂçïÁêÜËß£Â∞±ÊòØ‰ΩøÁî®‰∏Ä‰∏™Â§ßÂûãÊï∞ÊçÆÂ≠óÂÖ∏Êù•ËøõË°åÂø´ÈÄüÂåπÈÖçÊö¥ÂäõÁ†¥Ëß£ÁöÑÊñπÊ≥ïÔºå‰ª•Á©∫Èó¥Êù•Êç¢ÂèñÊó∂Èó¥ÁöÑÊñπÊ≥ï„ÄÇ ÂÖ∑‰ΩìÁöÑÈúÄË¶Å‰∏Ä‰∫õÂü∫Á°ÄÁü•ËØÜÂÅöÊîØÊíëÔºö 1„ÄÅÂìàÂ∏åÁÆóÊ≥ïÂìàÂ∏åÔºàHashÔºâÁÆóÊ≥ïÊòØÂçïÂêëÊï£ÂàóÁÆóÊ≥ïÔºåÂÆÉÊääÊüê‰∏™ËæÉÂ§ßÁöÑÈõÜÂêàPÊò†Â∞ÑÂà∞Âè¶‰∏Ä‰∏™ËæÉÂ∞èÁöÑÈõÜÂêàQ‰∏≠ÔºåÂÅáÂ¶ÇËøô‰∏™ÁÆóÊ≥ïÂè´HÔºåÈÇ£‰πàÂ∞±ÊúâQ = HÔºàPÔºâ„ÄÇÂØπ‰∫éP‰∏≠‰ªª‰Ωï‰∏Ä‰∏™ÂÄºpÈÉΩÊúâÂîØ‰∏ÄÁ°ÆÂÆöÁöÑq‰∏é‰πãÂØπÂ∫îÔºå‰ΩÜÊòØ‰∏Ä‰∏™qÂèØ‰ª•ÂØπÂ∫îÂ§ö‰∏™p„ÄÇ‰Ωú‰∏∫‰∏Ä‰∏™ÊúâÁî®ÁöÑHashÁÆóÊ≥ïÔºåHËøòÂ∫îËØ•Êª°Ë∂≥Ôºö H(p)ÈÄüÂ∫¶ÊØîËæÉÂø´Ôºõ ÁªôÂá∫‰∏Ä‰∏™qÔºåÂæàÈöæÁÆóÂá∫‰∏Ä‰∏™pÊª°Ë∂≥q = H(p)ÔºõÂç≥ÂçïÂêëÊÄß„ÄÇ ÁªôÂá∫‰∏Ä‰∏™p1ÔºåÂæàÈöæÁÆóÂá∫‰∏Ä‰∏™‰∏çÁ≠â‰∫ép1ÁöÑp2‰ΩøÂæó H(p1)=H(p2)ÔºõÂº∫Âº±Á¢∞ÊíûÊÄß„ÄÇ Ê≠£Âõ†‰∏∫ÊúâËøôÊ†∑ÁöÑÁâπÊÄßÔºåHashÁÆóÊ≥ïÁªèÂ∏∏Ë¢´Áî®Êù•‰øùÂ≠òÂØÜÁ†Å‚Äî‚Äî‚Äî‚ÄîËøôÊ†∑‰∏ç‰ºöÊ≥ÑÈú≤ÂØÜÁ†ÅÊòéÊñáÔºåÂèàÂèØ‰ª•Ê†°È™åËæìÂÖ•ÁöÑÂØÜÁ†ÅÊòØÂê¶Ê≠£Á°Æ„ÄÇÂ∏∏Áî®ÁöÑ HashÁÆóÊ≥ïÊúâMD5„ÄÅSHA1Á≠â„ÄÇ 2„ÄÅÁ†¥Ëß£HASH Á†¥Ëß£HashÁöÑ‰ªªÂä°Â∞±ÊòØÔºåÂØπ‰∫éÁªôÂá∫ÁöÑ‰∏Ä‰∏™qÔºåÂèçÁÆóÂá∫‰∏Ä‰∏™pÊù•Êª°Ë∂≥q = H(p)„ÄÇÂç≥Áõ¥Êé•ÈááÁî®Á¢∞ÊíûÁöÑÊñπÊ≥ïÊù•ÊâìÁ†¥ÂÆÉÁöÑÂº∫Âº±Á¢∞ÊíûÊÄß„ÄÇÈÄöÂ∏∏Êàë‰ª¨ËÉΩÊÉ≥Âà∞ÁöÑÂäûÊ≥ïÊúâ‰∏§ÁßçÔºö 1„ÄÅÊö¥ÂäõÁ†¥Ëß£Ê≥ïÔºåÊääP‰∏≠ÁöÑÊØè‰∏Ä‰∏™pÈÉΩÁÆó‰∏Ä‰∏ãH(p)ÔºåÁõ¥Âà∞ÁªìÊûúÁ≠â‰∫éqÔºõ 2„ÄÅÊü•Ë°®Ê≥ïÔºå‰ΩøÁî®‰∏Ä‰∏™Â§ßÂûãÂ≠óÂÖ∏ÔºåÊääÊØè‰∏™pÂíåÂØπÂ∫îÁöÑqÈÉΩËÆ∞ÂΩï‰∏ãÊù•ÔºåÊåâqÂÅö‰∏Ä‰∏ãÁ¥¢ÂºïÔºåÁõ¥Êé•Êü•ÊâæÂåπÈÖç„ÄÇ ‰∏§ÁßçÂäûÊ≥ïÁêÜËÆ∫‰∏äÈÉΩÊòØÂèØ‰ª•ÁöÑÔºå‰ΩÜÊòØÂâç‰∏ÄÁßçÈúÄË¶ÅÂ§ßÈáèÊó∂Èó¥ÔºåÂêé‰∏ÄÁßçÈúÄË¶ÅÂ§ßÈáèÂ≠òÂÇ®„ÄÇËøôÁßçÂçïÁ∫ØÁöÑÂºÄÈîÄÊòØÂæàÂ∑®Â§ßÁöÑÔºåÊâÄ‰ª•ÁõÆÂâçÊàë‰ª¨ËÆ§‰∏∫HashÊòØË∂≥Â§üÂÆâÂÖ®ÁöÑÔºåÂçÅÂá†‰Ωç‰ª•‰∏äÁöÑÂØÜÁ†Å‰πüÊòØÂº∫Â∫¶Ë∂≥Â§üÁöÑ„ÄÇ 3„ÄÅÂΩ©ËôπË°® Êó∂Á©∫ÁöÑÂπ≥Ë°° ÂØπ‰∫éHASHÁöÑ‰º†ÁªüÂÅöÊ≥ïÊòØÊääH(X)ÁöÑÊâÄÊúâËæìÂá∫Á©∑‰∏æÔºåÊü•ÊâæH(X[y])==H(P)ÔºåÂæóÂá∫P==X[y]„ÄÇËÄåÂΩ©ËôπË°®ÂàôÊòØ‰ΩøÁî®Êï£ÂàóÈìæÁöÑÊñπÂºèËøõË°å„ÄÇ ‚ÄúÊï£ÂàóÈìæ‚ÄùÊòØ‰∏∫‰∫ÜÈôç‰Ωé‰º†ÁªüÂÅöÊ≥ïÁ©∫Èó¥Ë¶ÅÊ±ÇÁöÑÊäÄÊúØÔºåÊÉ≥Ê≥ïÊòØÂÆö‰πâ‰∏Ä‰∏™Ë°∞ÂáèÂáΩÊï∞ R ÊääÊï£ÂàóÂÄºÂèòÊç¢ÊàêÂè¶‰∏ÄÂ≠óÁ¨¶‰∏≤„ÄÇÈÄöËøá‰∫§ÊõøËøêÁÆóHÂáΩÊï∞ÂíåRÂáΩÊï∞ÔºåÂΩ¢Êàê‰∫§ÊõøÁöÑÂØÜÁ†ÅÂíåÊï£ÂàóÂÄºÈìæÊù°„ÄÇ 2„ÄÅËØ¶Ëß£ÂΩìÈù¢ÂØπË¶ÅÁ†¥Ëß£ÁöÑÂìàÂ∏åÂáΩÊï∞HÔºåÈ¶ñÂÖàÂÆö‰πâ‰∏Ä‰∏™Á∫¶ÁÆÄÂáΩÊï∞Ôºàreduction functionÔºâRÔºåËØ•ÂáΩÊï∞ÁöÑÂÆö‰πâÂüüÂíåÂÄºÂüüÈúÄË¶ÅÂíåÂìàÂ∏åÂáΩÊï∞Áõ∏ÂèçÔºåÈÄöËøáËØ•ÂáΩÊï∞ÂèØ‰ª•Â∞ÜÂìàÂ∏åÂÄºÁ∫¶ÁÆÄ‰∏∫‰∏Ä‰∏™‰∏éÂéüÊñáÁõ∏ÂêåÊ†ºÂºèÁöÑÂÄºÔºà‚Äùplain text‚Äù valueÔºâ„ÄÇÈúÄË¶ÅÂº∫Ë∞ÉÁöÑÊòØÔºåÁî±‰∫éÂìàÂ∏åÂáΩÊï∞HÊòØ‰∏çÂèØÈÄÜÁöÑÔºåÊâÄ‰ª•ÂØπ‰∫éÂØÜÊñáËøõË°åRËøêÁÆóÂá†‰πé‰∏çÂèØËÉΩÂæóÂà∞ÊòéÊñáÂéüÊñá„ÄÇ‰æãÂ¶ÇÔºå‰∫î‰ΩçÂ≠óÊØçÊòéÊñá‚Äúzhihu‚ÄùËøõË°åHËøêÁÆóÂêéÂæóÂà∞‰∫Ü‚ÄúD2A82C9A‚ÄùÔºåËÄåÂØπ‚ÄúD2A82C9A‚ÄùËøõË°åRËøêÁÆóÂêéÂæóÂà∞Âè¶‰∏Ä‰∏™‰∫î‰ΩçÂ≠óÊØçÊ†ºÂºèÁöÑÂÄº‚Äúvfkkd‚Äù„ÄÇÂõ†‰∏∫Ëøô‰∏™ÂÄºËêΩÂú®HÁöÑÂÆö‰πâÂüü‰∏≠ÔºåÂõ†Ê≠§ÂèØ‰ª•ÂØπÂÆÉÁªßÁª≠ËøõË°åHËøêÁÆó„ÄÇÂ∞±ËøôÊ†∑ÔºåÂ∞ÜHËøêÁÆó„ÄÅRËøêÁÆó„ÄÅHËøêÁÆó‚Ä¶‚Ä¶Ëøô‰∏™ËøáÁ®ãÂèçÂ§çÂú∞ÈáçÂ§ç‰∏ãÂéªÔºåÈáçÂ§ç‰∏Ä‰∏™ÁâπÂÆöÁöÑÊ¨°Êï∞ k ‰ª•ÂêéÔºåÂ∞±ÂæóÂà∞‰∏ÄÊù°ÂìàÂ∏åÈìæÔºå‰æãÂ¶Çk‰∏∫2Êó∂ÂæóÂà∞Ôºö Ë¶ÅÁîüÊàê‰∏Ä‰∏™Ë°®ÔºåÊàë‰ª¨ÈÄâÊã©‰∏ÄÁªÑÈöèÊú∫ÁöÑÂàùÂßãÂØÜÁ†ÅÔºåÊØè‰∏Ä‰∏™ÂØÜÁ†ÅËÆ°ÁÆó‰∏Ä‰∏™Âõ∫ÂÆöÈïøÂ∫¶KÁöÑÈìæÔºåÂπ∂Âè™Â≠òÂÇ®ÊØè‰∏Ä‰∏™ÈìæÁöÑÁ¨¨‰∏Ä‰∏™ÂíåÊúÄÂêé‰∏Ä‰∏™ÂØÜÁ†Å„ÄÇÁ¨¨‰∏ÄÂØÜÁ†ÅË¢´Áß∞‰∏∫ÂßãÁÇπÔºåÊúÄÂêé‰∏Ä‰∏™Ë¢´Áß∞‰∏∫Êú´ÁÇπ„ÄÇÂú®‰∏äÈù¢‰æã‰∏æÁöÑÈìæ‰∏≠Ôºå‚Äúzhihu‚ÄùÂ∞±ÊòØÂßãÁÇπÔºå‚Äúcrepa‚ÄùÂ∞±ÊòØÊú´ÁÇπÔºåÂÖ∂‰ªñÂØÜÁ†ÅÔºàÊàñÊï£ÂàóÂÄºÔºâÂπ∂‰∏çË¢´‰øùÂ≠ò„ÄÇ ÈÄ†Ë°®ËøáÁ®ãÔºö Êü•Ë°®ËøáÁ®ãÔºö ÂèÇËÄÉÔºö ÂΩ©ËôπË°®Á†¥Ëß£ÂºÄÊú∫ÂØÜÁ†Å„ÄÅMD5ÁÆóÊ≥ïÁ≠âÁöÑÂéüÁêÜhttp://www.91ri.org/7593.html]]></content>
      <categories>
        <category>ÂÆâÂÖ®</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[javaÂ∑•Á®ãÂ∏àÊàêÁ•û‰πãË∑Ø]]></title>
    <url>%2F2018%2F03%2F23%2Fjava%E5%B7%A5%E7%A8%8B%E5%B8%88%E6%88%90%E7%A5%9E%E4%B9%8B%E8%B7%AF%2F</url>
    <content type="text"><![CDATA[‰∏Ä„ÄÅÂü∫Á°ÄÁØáJVM JVMÂÜÖÂ≠òÁªìÊûÑÂ†Ü„ÄÅÊ†à„ÄÅÊñπÊ≥ïÂå∫„ÄÅÁõ¥Êé•ÂÜÖÂ≠ò„ÄÅÂ†ÜÂíåÊ†àÂå∫Âà´ JavaÂÜÖÂ≠òÊ®°ÂûãÂÜÖÂ≠òÂèØËßÅÊÄß„ÄÅÈáçÊéíÂ∫è„ÄÅÈ°∫Â∫è‰∏ÄËá¥ÊÄß„ÄÅvolatile„ÄÅÈîÅ„ÄÅfinal ÂûÉÂúæÂõûÊî∂ÂÜÖÂ≠òÂàÜÈÖçÁ≠ñÁï•„ÄÅÂûÉÂúæÊî∂ÈõÜÂô®ÔºàG1Ôºâ„ÄÅGCÁÆóÊ≥ï„ÄÅGCÂèÇÊï∞„ÄÅÂØπË±°Â≠òÊ¥ªÁöÑÂà§ÂÆö JVMÂèÇÊï∞ÂèäË∞É‰ºòJavaÂØπË±°Ê®°Âûãoop-klass„ÄÅÂØπË±°Â§¥ HotSpotÂç≥Êó∂ÁºñËØëÂô®„ÄÅÁºñËØë‰ºòÂåñ Á±ªÂä†ËΩΩÊú∫Âà∂classLoader„ÄÅÁ±ªÂä†ËΩΩËøáÁ®ã„ÄÅÂèå‰∫≤ÂßîÊ¥æÔºàÁ†¥ÂùèÂèå‰∫≤ÂßîÊ¥æÔºâ„ÄÅÊ®°ÂùóÂåñÔºàjboss modules„ÄÅosgi„ÄÅjigsawÔºâ ËôöÊãüÊú∫ÊÄßËÉΩÁõëÊéß‰∏éÊïÖÈöúÂ§ÑÁêÜÂ∑•ÂÖ∑jps, jstack, jmap„ÄÅjstat, jconsole, jinfo, jhat, javap, btrace„ÄÅTProfiler ÁºñËØë‰∏éÂèçÁºñËØë javac „ÄÅjavap „ÄÅjad „ÄÅCRF JavaÂü∫Á°ÄÁü•ËØÜ ÈòÖËØªÊ∫ê‰ª£Á†ÅString„ÄÅInteger„ÄÅLong„ÄÅEnum„ÄÅBigDecimal„ÄÅThreadLocal„ÄÅClassLoader &amp; URLClassLoader„ÄÅArrayList &amp; LinkedList„ÄÅ HashMap &amp; LinkedHashMap &amp; TreeMap &amp; CouncurrentHashMap„ÄÅHashSet &amp; LinkedHashSet &amp; TreeSet Java‰∏≠ÂêÑÁßçÂèòÈáèÁ±ªÂûãÁÜüÊÇâJava StringÁöÑ‰ΩøÁî®ÔºåÁÜüÊÇâStringÁöÑÂêÑÁßçÂáΩÊï∞JDK 6ÂíåJDK 7‰∏≠substringÁöÑÂéüÁêÜÂèäÂå∫Âà´„ÄÅ replaceFirst„ÄÅreplaceAll„ÄÅreplaceÂå∫Âà´„ÄÅ StringÂØπ‚Äú+‚ÄùÁöÑÈáçËΩΩ„ÄÅ String.valueOfÂíåInteger.toStringÁöÑÂå∫Âà´„ÄÅ Â≠óÁ¨¶‰∏≤ÁöÑ‰∏çÂèØÂèòÊÄß Ëá™Âä®ÊãÜË£ÖÁÆ±IntegerÁöÑÁºìÂ≠òÊú∫Âà∂ ÁÜüÊÇâJava‰∏≠ÂêÑÁßçÂÖ≥ÈîÆÂ≠ótransient„ÄÅinstanceof„ÄÅvolatile„ÄÅsynchronized„ÄÅfinal„ÄÅstatic„ÄÅconst ÂéüÁêÜÂèäÁî®Ê≥ï„ÄÇ ÈõÜÂêàÁ±ªÂ∏∏Áî®ÈõÜÂêàÁ±ªÁöÑ‰ΩøÁî® ArrayListÂíåLinkedListÂíåVectorÁöÑÂå∫Âà´ SynchronizedListÂíåVectorÁöÑÂå∫Âà´ HashMap„ÄÅHashTable„ÄÅConcurrentHashMapÂå∫Âà´ Java 8‰∏≠streamÁõ∏ÂÖ≥Áî®Ê≥ï apacheÈõÜÂêàÂ§ÑÁêÜÂ∑•ÂÖ∑Á±ªÁöÑ‰ΩøÁî® ‰∏çÂêåÁâàÊú¨ÁöÑJDK‰∏≠HashMapÁöÑÂÆûÁé∞ÁöÑÂå∫Âà´‰ª•ÂèäÂéüÂõ† Êûö‰∏æÊûö‰∏æÁöÑÁî®Ê≥ï„ÄÅÊûö‰∏æ‰∏éÂçï‰æã„ÄÅEnumÁ±ª Java IO&amp;Java NIOÔºåÂπ∂Â≠¶‰ºö‰ΩøÁî®bio„ÄÅnioÂíåaioÁöÑÂå∫Âà´„ÄÅ‰∏âÁßçIOÁöÑÁî®Ê≥ï‰∏éÂéüÁêÜ„ÄÅnetty JavaÂèçÂ∞Ñ‰∏éjavassistÂèçÂ∞Ñ‰∏éÂ∑•ÂéÇÊ®°Âºè„ÄÅ java.lang.reflect.* JavaÂ∫èÂàóÂåñ‰ªÄ‰πàÊòØÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñ„ÄÅ‰∏∫‰ªÄ‰πàÂ∫èÂàóÂåñ Â∫èÂàóÂåñÂ∫ïÂ±ÇÂéüÁêÜ Â∫èÂàóÂåñ‰∏éÂçï‰æãÊ®°Âºè protobuf ‰∏∫‰ªÄ‰πàËØ¥Â∫èÂàóÂåñÂπ∂‰∏çÂÆâÂÖ® Ê≥®Ëß£ÂÖÉÊ≥®Ëß£„ÄÅËá™ÂÆö‰πâÊ≥®Ëß£„ÄÅJava‰∏≠Â∏∏Áî®Ê≥®Ëß£‰ΩøÁî®„ÄÅÊ≥®Ëß£‰∏éÂèçÂ∞ÑÁöÑÁªìÂêà JMS‰ªÄ‰πàÊòØJavaÊ∂àÊÅØÊúçÂä°„ÄÅJMSÊ∂àÊÅØ‰º†ÈÄÅÊ®°Âûã JMXjava.lang.management.*„ÄÅ javax.management.* Ê≥õÂûãÊ≥õÂûã‰∏éÁªßÊâø Á±ªÂûãÊì¶Èô§ Ê≥õÂûã‰∏≠K T V E objectÁ≠âÁöÑÂê´‰πâ„ÄÅÊ≥õÂûãÂêÑÁßçÁî®Ê≥ï ÂçïÂÖÉÊµãËØïjunit„ÄÅmock„ÄÅmockito„ÄÅÂÜÖÂ≠òÊï∞ÊçÆÂ∫ìÔºàh2Ôºâ Ê≠£ÂàôË°®ËææÂºèjava.lang.util.regex.* Â∏∏Áî®ÁöÑJavaÂ∑•ÂÖ∑Â∫ìcommons.lang, commons.*... guava-libraries netty ‰ªÄ‰πàÊòØAPI&amp;SPIÂºÇÂ∏∏ÂºÇÂ∏∏Á±ªÂûã„ÄÅÊ≠£Á°ÆÂ§ÑÁêÜÂºÇÂ∏∏„ÄÅËá™ÂÆö‰πâÂºÇÂ∏∏ Êó∂Èó¥Â§ÑÁêÜÊó∂Âå∫„ÄÅÊó∂‰ª§„ÄÅJava‰∏≠Êó∂Èó¥API ÁºñÁ†ÅÊñπÂºèËß£ÂÜ≥‰π±Á†ÅÈóÆÈ¢ò„ÄÅÂ∏∏Áî®ÁºñÁ†ÅÊñπÂºè ËØ≠Ê≥ïÁ≥ñJava‰∏≠ËØ≠Ê≥ïÁ≥ñÂéüÁêÜ„ÄÅËß£ËØ≠Ê≥ïÁ≥ñ JavaÂπ∂ÂèëÁºñÁ®ã ‰ªÄ‰πàÊòØÁ∫øÁ®ãÔºå‰∏éËøõÁ®ãÁöÑÂå∫Âà´ÈòÖËØªÊ∫ê‰ª£Á†ÅÔºåÂπ∂Â≠¶‰ºö‰ΩøÁî®Thread„ÄÅRunnable„ÄÅCallable„ÄÅReentrantLock„ÄÅReentrantReadWriteLock„ÄÅAtomic*„ÄÅSemaphore„ÄÅCountDownLatch„ÄÅ„ÄÅConcurrentHashMap„ÄÅExecutors Á∫øÁ®ãÊ±†Ëá™Â∑±ËÆæËÆ°Á∫øÁ®ãÊ±†„ÄÅsubmit() Âíå execute() Á∫øÁ®ãÂÆâÂÖ®Ê≠ªÈîÅ„ÄÅÊ≠ªÈîÅÂ¶Ç‰ΩïÊéíÊü•„ÄÅJavaÁ∫øÁ®ãË∞ÉÂ∫¶„ÄÅÁ∫øÁ®ãÂÆâÂÖ®ÂíåÂÜÖÂ≠òÊ®°ÂûãÁöÑÂÖ≥Á≥ª ÈîÅCAS„ÄÅ‰πêËßÇÈîÅ‰∏éÊÇ≤ËßÇÈîÅ„ÄÅÊï∞ÊçÆÂ∫ìÁõ∏ÂÖ≥ÈîÅÊú∫Âà∂„ÄÅÂàÜÂ∏ÉÂºèÈîÅ„ÄÅÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅ„ÄÅÈáçÈáèÁ∫ßÈîÅ„ÄÅmonitor„ÄÅÈîÅ‰ºòÂåñ„ÄÅÈîÅÊ∂àÈô§„ÄÅÈîÅÁ≤óÂåñ„ÄÅËá™ÊóãÈîÅ„ÄÅÂèØÈáçÂÖ•ÈîÅ„ÄÅÈòªÂ°ûÈîÅ„ÄÅÊ≠ªÈîÅ Ê≠ªÈîÅvolatilehappens-before„ÄÅÁºñËØëÂô®Êåá‰ª§ÈáçÊéíÂíåCPUÊåá‰ª§Èáç synchronizedsynchronizedÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü synchronizedÂíålock‰πãÈó¥ÂÖ≥Á≥ª ‰∏ç‰ΩøÁî®synchronizedÂ¶Ç‰ΩïÂÆûÁé∞‰∏Ä‰∏™Á∫øÁ®ãÂÆâÂÖ®ÁöÑÂçï‰æã sleep Âíå waitwait Âíå notifynotify Âíå notifyAllThreadLocalÂÜô‰∏Ä‰∏™Ê≠ªÈîÅÁöÑÁ®ãÂ∫èÂÜô‰ª£Á†ÅÊù•Ëß£ÂÜ≥Áîü‰∫ßËÄÖÊ∂àË¥πËÄÖÈóÆÈ¢òÂÆàÊä§Á∫øÁ®ãÂÆàÊä§Á∫øÁ®ãÂíåÈùûÂÆàÊä§Á∫øÁ®ãÁöÑÂå∫Âà´‰ª•ÂèäÁî®Ê≥ï ‰∫å„ÄÅ ËøõÈò∂ÁØáJavaÂ∫ïÂ±ÇÁü•ËØÜ Â≠óËäÇÁ†Å„ÄÅclassÊñá‰ª∂Ê†ºÂºèCPUÁºìÂ≠òÔºåL1ÔºåL2ÔºåL3Âíå‰º™ÂÖ±‰∫´Â∞æÈÄíÂΩí‰ΩçËøêÁÆóÁî®‰ΩçËøêÁÆóÂÆûÁé∞Âä†„ÄÅÂáè„ÄÅ‰πò„ÄÅÈô§„ÄÅÂèñ‰Ωô ËÆæËÆ°Ê®°Âºè ‰∫ÜËß£23ÁßçËÆæËÆ°Ê®°Âºè‰ºö‰ΩøÁî®Â∏∏Áî®ËÆæËÆ°Ê®°ÂºèÂçï‰æã„ÄÅÁ≠ñÁï•„ÄÅÂ∑•ÂéÇ„ÄÅÈÄÇÈÖçÂô®„ÄÅË¥£‰ªªÈìæ„ÄÇ ÂÆûÁé∞AOPÂÆûÁé∞IOC‰∏çÁî®synchronizedÂíålockÔºåÂÆûÁé∞Á∫øÁ®ãÂÆâÂÖ®ÁöÑÂçï‰æãÊ®°ÂºènioÂíåreactorËÆæËÆ°Ê®°ÂºèÁΩëÁªúÁºñÁ®ã tcp„ÄÅudp„ÄÅhttp„ÄÅhttpsÁ≠âÂ∏∏Áî®ÂçèËÆÆ‰∏âÊ¨°Êè°Êâã‰∏éÂõõÊ¨°ÂÖ≥Èó≠„ÄÅÊµÅÈáèÊéßÂà∂ÂíåÊã•Â°ûÊéßÂà∂„ÄÅOSI‰∏ÉÂ±ÇÊ®°Âûã„ÄÅtcpÁ≤òÂåÖ‰∏éÊãÜÂåÖ http/1.0 http/1.1 http/2‰πãÂâçÁöÑÂå∫Âà´Java RMIÔºåSocketÔºåHttpClientcookie ‰∏é sessioncookieË¢´Á¶ÅÁî®ÔºåÂ¶Ç‰ΩïÂÆûÁé∞session Áî®JavaÂÜô‰∏Ä‰∏™ÁÆÄÂçïÁöÑÈùôÊÄÅÊñá‰ª∂ÁöÑHTTPÊúçÂä°Âô® ÂÆûÁé∞ÂÆ¢Êà∑Á´ØÁºìÂ≠òÂäüËÉΩÔºåÊîØÊåÅËøîÂõû304 ÂÆûÁé∞ÂèØÂπ∂Âèë‰∏ãËΩΩ‰∏Ä‰∏™Êñá‰ª∂ ‰ΩøÁî®Á∫øÁ®ãÊ±†Â§ÑÁêÜÂÆ¢Êà∑Á´ØËØ∑Ê±Ç ‰ΩøÁî®nioÂ§ÑÁêÜÂÆ¢Êà∑Á´ØËØ∑Ê±Ç ÊîØÊåÅÁÆÄÂçïÁöÑrewriteËßÑÂàô ‰∏äËø∞ÂäüËÉΩÂú®ÂÆûÁé∞ÁöÑÊó∂ÂÄôÈúÄË¶ÅÊª°Ë∂≥‚ÄúÂºÄÈó≠ÂéüÂàô‚Äù ‰∫ÜËß£nginxÂíåapacheÊúçÂä°Âô®ÁöÑÁâπÊÄßÂπ∂Êê≠Âª∫‰∏Ä‰∏™ÂØπÂ∫îÁöÑÊúçÂä°Âô®Áî®JavaÂÆûÁé∞FTP„ÄÅSMTPÂçèËÆÆËøõÁ®ãÈó¥ÈÄöËÆØÁöÑÊñπÂºè‰ªÄ‰πàÊòØCDNÔºüÂ¶ÇÊûúÂÆûÁé∞Ôºü‰ªÄ‰πàÊòØDNSÔºüÂèçÂêë‰ª£ÁêÜÊ°ÜÊû∂Áü•ËØÜ ServletÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢òServlet‰∏≠ÁöÑfilterÂíålistenerHibernateÁöÑÁºìÂ≠òÊú∫Âà∂HiberateÁöÑÊáíÂä†ËΩΩSpring BeanÁöÑÂàùÂßãÂåñSpringÁöÑAOPÂéüÁêÜËá™Â∑±ÂÆûÁé∞SpringÁöÑIOCSpring MVCSpring Boot2.0Spring BootÁöÑstarterÂéüÁêÜÔºåËá™Â∑±ÂÆûÁé∞‰∏Ä‰∏™starter Spring SecurityÂ∫îÁî®ÊúçÂä°Âô® JBosstomcatjettyWeblogicÂ∑•ÂÖ∑ git &amp; svnmaven &amp; gradle ‰∏â„ÄÅ È´òÁ∫ßÁØáÊñ∞ÊäÄÊúØ Java 8lambdaË°®ËææÂºè„ÄÅStream API„ÄÅ Java 9Jigsaw„ÄÅJshell„ÄÅReactive Streams Java 10Â±ÄÈÉ®ÂèòÈáèÁ±ªÂûãÊé®Êñ≠„ÄÅG1ÁöÑÂπ∂Ë°åFull GC„ÄÅThreadLocalÊè°ÊâãÊú∫Âà∂ Spring 5ÂìçÂ∫îÂºèÁºñÁ®ã Spring Boot 2.0ÊÄßËÉΩ‰ºòÂåñ ‰ΩøÁî®Âçï‰æã„ÄÅ‰ΩøÁî®FutureÊ®°Âºè„ÄÅ‰ΩøÁî®Á∫øÁ®ãÊ±†„ÄÅÈÄâÊã©Â∞±Áª™„ÄÅÂáèÂ∞ë‰∏ä‰∏ãÊñáÂàáÊç¢„ÄÅÂáèÂ∞ëÈîÅÁ≤íÂ∫¶„ÄÅÊï∞ÊçÆÂéãÁº©„ÄÅÁªìÊûúÁºìÂ≠ò Á∫ø‰∏äÈóÆÈ¢òÂàÜÊûê dumpËé∑ÂèñÁ∫øÁ®ãDump„ÄÅÂÜÖÂ≠òDump„ÄÅgcÊÉÖÂÜµ dumpÂàÜÊûêÂàÜÊûêÊ≠ªÈîÅ„ÄÅÂàÜÊûêÂÜÖÂ≠òÊ≥ÑÈú≤ Ëá™Â∑±ÁºñÂÜôÂêÑÁßçoutofmemoryÔºåstackoverflowÁ®ãÂ∫èHeapOutOfMemory„ÄÅ Young OutOfMemory„ÄÅMethodArea OutOfMemory„ÄÅConstantPool OutOfMemory„ÄÅDirectMemory OutOfMemory„ÄÅStack OutOfMemory Stack OverFlow Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊÄùË∑ØÂÜÖÂ≠òÊ∫¢Âá∫„ÄÅÁ∫øÁ®ãÊ≠ªÈîÅ„ÄÅÁ±ªÂä†ËΩΩÂÜ≤Á™Å ‰ΩøÁî®Â∑•ÂÖ∑Â∞ùËØïËß£ÂÜ≥‰ª•‰∏ãÈóÆÈ¢òÔºåÂπ∂ÂÜô‰∏ãÊÄªÁªìÂΩì‰∏Ä‰∏™JavaÁ®ãÂ∫èÂìçÂ∫îÂæàÊÖ¢Êó∂Â¶Ç‰ΩïÊü•ÊâæÈóÆÈ¢ò„ÄÅ ÂΩì‰∏Ä‰∏™JavaÁ®ãÂ∫èÈ¢ëÁπÅFullGCÊó∂Â¶Ç‰ΩïËß£ÂÜ≥ÈóÆÈ¢ò„ÄÅ Â¶Ç‰ΩïÊü•ÁúãÂûÉÂúæÂõûÊî∂Êó•Âøó„ÄÅ ÂΩì‰∏Ä‰∏™JavaÂ∫îÁî®ÂèëÁîüOutOfMemoryÊó∂ËØ•Â¶Ç‰ΩïËß£ÂÜ≥„ÄÅ Â¶Ç‰ΩïÂà§Êñ≠ÊòØÂê¶Âá∫Áé∞Ê≠ªÈîÅ„ÄÅ Â¶Ç‰ΩïÂà§Êñ≠ÊòØÂê¶Â≠òÂú®ÂÜÖÂ≠òÊ≥ÑÈú≤ ÁºñËØëÂéüÁêÜÁü•ËØÜ ÁºñËØë‰∏éÂèçÁºñËØëJava‰ª£Á†ÅÁöÑÁºñËØë‰∏éÂèçÁºñËØëJavaÁöÑÂèçÁºñËØëÂ∑•ÂÖ∑ËØçÊ≥ïÂàÜÊûêÔºåËØ≠Ê≥ïÂàÜÊûêÔºàLLÁÆóÊ≥ïÔºåÈÄíÂΩí‰∏ãÈôçÁÆóÊ≥ïÔºåLRÁÆóÊ≥ïÔºâÔºåËØ≠‰πâÂàÜÊûêÔºåËøêË°åÊó∂ÁéØÂ¢ÉÔºå‰∏≠Èó¥‰ª£Á†ÅÔºå‰ª£Á†ÅÁîüÊàêÔºå‰ª£Á†Å‰ºòÂåñÊìç‰ΩúÁ≥ªÁªüÁü•ËØÜLinuxÁöÑÂ∏∏Áî®ÂëΩ‰ª§ËøõÁ®ãÂêåÊ≠•ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÂàÜÊÆµÂíåÂàÜÈ°µËôöÊãüÂÜÖÂ≠ò‰∏é‰∏ªÂ≠òÊï∞ÊçÆÂ∫ìÁü•ËØÜMySql ÊâßË°åÂºïÊìéMySQL ÊâßË°åËÆ°ÂàíÂ¶Ç‰ΩïÊü•ÁúãÊâßË°åËÆ°ÂàíÔºåÂ¶Ç‰ΩïÊ†πÊçÆÊâßË°åËÆ°ÂàíËøõË°åSQL‰ºòÂåñ SQL‰ºòÂåñ‰∫ãÂä°‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´„ÄÅ‰∫ãÂä°ËÉΩ‰∏çËÉΩÂÆûÁé∞ÈîÅÁöÑÂäüËÉΩ Êï∞ÊçÆÂ∫ìÈîÅË°åÈîÅ„ÄÅË°®ÈîÅ„ÄÅ‰ΩøÁî®Êï∞ÊçÆÂ∫ìÈîÅÂÆûÁé∞‰πêËßÇÈîÅ„ÄÅ Êï∞ÊçÆÂ∫ì‰∏ªÂ§áÊê≠Âª∫binlogÂÜÖÂ≠òÊï∞ÊçÆÂ∫ìh2 Â∏∏Áî®ÁöÑnosqlÊï∞ÊçÆÂ∫ìredis„ÄÅmemcached ÂàÜÂà´‰ΩøÁî®Êï∞ÊçÆÂ∫ìÈîÅ„ÄÅNoSqlÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÊÄßËÉΩË∞É‰ºòÊï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ïÁü•ËØÜ ÁÆÄÂçïÁöÑÊï∞ÊçÆÁªìÊûÑÊ†à„ÄÅÈòüÂàó„ÄÅÈìæË°®„ÄÅÊï∞ÁªÑ„ÄÅÂìàÂ∏åË°®„ÄÅ Ê†ë‰∫åÂèâÊ†ë„ÄÅÂ≠óÂÖ∏Ê†ë„ÄÅÂπ≥Ë°°Ê†ë„ÄÅÊéíÂ∫èÊ†ë„ÄÅBÊ†ë„ÄÅB+Ê†ë„ÄÅRÊ†ë„ÄÅÂ§öË∑ØÊ†ë„ÄÅÁ∫¢ÈªëÊ†ë ÊéíÂ∫èÁÆóÊ≥ïÂêÑÁßçÊéíÂ∫èÁÆóÊ≥ïÂíåÊó∂Èó¥Â§çÊùÇÂ∫¶ Ê∑±Â∫¶‰ºòÂÖàÂíåÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢ ÂÖ®ÊéíÂàó„ÄÅË¥™ÂøÉÁÆóÊ≥ï„ÄÅKMPÁÆóÊ≥ï„ÄÅhashÁÆóÊ≥ï„ÄÅÊµ∑ÈáèÊï∞ÊçÆÂ§ÑÁêÜ Â§ßÊï∞ÊçÆÁü•ËØÜZookeeperÂü∫Êú¨Ê¶ÇÂøµ„ÄÅÂ∏∏ËßÅÁî®Ê≥ï SolrÔºåLuceneÔºåElasticSearchÂú®linux‰∏äÈÉ®ÁΩ≤solrÔºåsolrcloudÔºåÔºåÊñ∞Â¢û„ÄÅÂà†Èô§„ÄÅÊü•ËØ¢Á¥¢Âºï StormÔºåÊµÅÂºèËÆ°ÁÆóÔºå‰∫ÜËß£SparkÔºåS4Âú®linux‰∏äÈÉ®ÁΩ≤stormÔºåÁî®zookeeperÂÅöÂçèË∞ÉÔºåËøêË°åstorm hello worldÔºålocalÂíåremoteÊ®°ÂºèËøêË°åË∞ÉËØïstorm topology„ÄÇ HadoopÔºåÁ¶ªÁ∫øËÆ°ÁÆóHDFS„ÄÅMapReduce ÂàÜÂ∏ÉÂºèÊó•ÂøóÊî∂ÈõÜflumeÔºåkafkaÔºålogstashÊï∞ÊçÆÊåñÊéòÔºåmahoutÁΩëÁªúÂÆâÂÖ®Áü•ËØÜ‰ªÄ‰πàÊòØXSSXSSÁöÑÈò≤Âæ° ‰ªÄ‰πàÊòØCSRF‰ªÄ‰πàÊòØÊ≥®ÂÖ•ÊîªÂáªSQLÊ≥®ÂÖ•„ÄÅXMLÊ≥®ÂÖ•„ÄÅCRLFÊ≥®ÂÖ• ‰ªÄ‰πàÊòØÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÂä†ÂØÜ‰∏éËß£ÂØÜMD5ÔºåSHA1„ÄÅDES„ÄÅAES„ÄÅRSA„ÄÅDSA ‰ªÄ‰πàÊòØDOSÊîªÂáªÂíåDDOSÊîªÂáªmemcached‰∏∫‰ªÄ‰πàÂèØ‰ª•ÂØºËá¥DDosÊîªÂáª„ÄÅ‰ªÄ‰πàÊòØÂèçÂ∞ÑÂûãDDoS SSL„ÄÅTLSÔºåHTTPSÂ¶Ç‰ΩïÈÄöËøáHashÁ¢∞ÊíûËøõË°åDOSÊîªÂáªÁî®opensslÁ≠æ‰∏Ä‰∏™ËØÅ‰π¶ÈÉ®ÁΩ≤Âà∞apacheÊàñnginx Âõõ„ÄÅÊû∂ÊûÑÁØáÂàÜÂ∏ÉÂºè Êï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÅÊúçÂä°Ê≤ªÁêÜ„ÄÅÊúçÂä°ÈôçÁ∫ß ÂàÜÂ∏ÉÂºè‰∫ãÂä°2PC„ÄÅ3PC„ÄÅCAP„ÄÅBASE„ÄÅ ÂèØÈù†Ê∂àÊÅØÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÅÊúÄÂ§ßÂä™ÂäõÈÄöÁü•„ÄÅTCC DubboÊúçÂä°Ê≥®ÂÜå„ÄÅÊúçÂä°ÂèëÁé∞ÔºåÊúçÂä°Ê≤ªÁêÜ ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÊÄéÊ†∑ÊâìÈÄ†‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ì„ÄÅ‰ªÄ‰πàÊó∂ÂÄôÈúÄË¶ÅÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ì„ÄÅmycat„ÄÅotter„ÄÅHBase ÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªümfs„ÄÅfastdfs ÂàÜÂ∏ÉÂºèÁºìÂ≠òÁºìÂ≠ò‰∏ÄËá¥ÊÄß„ÄÅÁºìÂ≠òÂëΩ‰∏≠Áéá„ÄÅÁºìÂ≠òÂÜó‰Ωô ÂæÆÊúçÂä° SOA„ÄÅÂ∫∑Â®ÅÂÆöÂæã ServiceMeshDocker &amp; KubernetsSpring BootSpring CloudÈ´òÂπ∂Âèë ÂàÜÂ∫ìÂàÜË°®CDNÊäÄÊúØÊ∂àÊÅØÈòüÂàóActiveMQ ÁõëÊéß ÁõëÊéß‰ªÄ‰πàCPU„ÄÅÂÜÖÂ≠ò„ÄÅÁ£ÅÁõòI/O„ÄÅÁΩëÁªúI/OÁ≠â ÁõëÊéßÊâãÊÆµËøõÁ®ãÁõëÊéß„ÄÅËØ≠‰πâÁõëÊéß„ÄÅÊú∫Âô®ËµÑÊ∫êÁõëÊéß„ÄÅÊï∞ÊçÆÊ≥¢Âä® ÁõëÊéßÊï∞ÊçÆÈááÈõÜÊó•Âøó„ÄÅÂüãÁÇπ DapperË¥üËΩΩÂùáË°° tomcatË¥üËΩΩÂùáË°°„ÄÅNginxË¥üËΩΩÂùáË°° DNS DNSÂéüÁêÜ„ÄÅDNSÁöÑËÆæËÆ° CDN Êï∞ÊçÆ‰∏ÄËá¥ÊÄß ‰∫î„ÄÅ Êâ©Â±ïÁØá‰∫ëËÆ°ÁÆó IaaS„ÄÅSaaS„ÄÅPaaS„ÄÅËôöÊãüÂåñÊäÄÊúØ„ÄÅopenstack„ÄÅServerlsess ÊêúÁ¥¢ÂºïÊìé Solr„ÄÅLucene„ÄÅNutch„ÄÅElasticsearch ÊùÉÈôêÁÆ°ÁêÜ Shiro Âå∫ÂùóÈìæ ÂìàÂ∏åÁÆóÊ≥ï„ÄÅMerkleÊ†ë„ÄÅÂÖ¨Èí•ÂØÜÁ†ÅÁÆóÊ≥ï„ÄÅÂÖ±ËØÜÁÆóÊ≥ï„ÄÅRaftÂçèËÆÆ„ÄÅPaxos ÁÆóÊ≥ï‰∏é Raft ÁÆóÊ≥ï„ÄÅÊãúÂç†Â∫≠ÈóÆÈ¢ò‰∏éÁÆóÊ≥ï„ÄÅÊ∂àÊÅØËÆ§ËØÅÁ†Å‰∏éÊï∞Â≠óÁ≠æÂêç ÊØîÁâπÂ∏ÅÊåñÁüø„ÄÅÂÖ±ËØÜÊú∫Âà∂„ÄÅÈó™ÁîµÁΩëÁªú„ÄÅ‰æßÈìæ„ÄÅÁÉ≠ÁÇπÈóÆÈ¢ò„ÄÅÂàÜÂèâ ‰ª•Â§™ÂùäË∂ÖÁ∫ßË¥¶Êú¨‰∫∫Â∑•Êô∫ËÉΩ Êï∞Â≠¶Âü∫Á°Ä„ÄÅÊú∫Âô®Â≠¶‰π†„ÄÅ‰∫∫Â∑•Á•ûÁªèÁΩëÁªú„ÄÅÊ∑±Â∫¶Â≠¶‰π†„ÄÅÂ∫îÁî®Âú∫ÊôØ„ÄÇ Â∏∏Áî®Ê°ÜÊû∂TensorFlow„ÄÅDeepLearning4J ÂÖ∂‰ªñËØ≠Ë®Ä Groovy„ÄÅPython„ÄÅGo„ÄÅNodeJs„ÄÅSwift„ÄÅRust ÂÖ≠„ÄÅ Êé®Ëçê‰π¶Á±ç „ÄäÊ∑±ÂÖ•ÁêÜËß£JavaËôöÊãüÊú∫„Äã „ÄäEffective Java„Äã „ÄäÊ∑±ÂÖ•ÂàÜÊûêJava WebÊäÄÊúØÂÜÖÂπï„Äã „ÄäÂ§ßÂûãÁΩëÁ´ôÊäÄÊúØÊû∂ÊûÑ„Äã „Ää‰ª£Á†ÅÊï¥Ê¥Å‰πãÈÅì„Äã „ÄäHead FirstËÆæËÆ°Ê®°Âºè„Äã „ÄämavenÂÆûÊàò„Äã „ÄäÂå∫ÂùóÈìæÂéüÁêÜ„ÄÅËÆæËÆ°‰∏éÂ∫îÁî®„Äã „ÄäJavaÂπ∂ÂèëÁºñÁ®ãÂÆûÊàò„Äã „ÄäÈ∏üÂì•ÁöÑLinuxÁßÅÊàøËèú„Äã „Ää‰ªéPaxosÂà∞Zookeeper„Äã „ÄäÊû∂ÊûÑÂç≥Êú™Êù•„Äã]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[MySQLÂºÄÂèëËßÑËåÉ]]></title>
    <url>%2F2018%2F03%2F13%2FMySQL%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83%2F</url>
    <content type="text"><![CDATA[‰∏Ä. ÂëΩÂêçËßÑËåÉ Â∫ìÂêç„ÄÅË°®Âêç„ÄÅÂ≠óÊÆµÂêçÂøÖÈ°ª‰ΩøÁî®Â∞èÂÜôÂ≠óÊØçÔºåÂπ∂ÈááÁî®‰∏ãÂàíÁ∫øÂàÜÂâ≤ ‰∏∫‰∫ÜÁªü‰∏ÄËßÑËåÉÔºå Â∫ìÂêç„ÄÅË°®Âêç„ÄÅÂ≠óÊÆµÂêç‰ΩøÁî®Â∞èÂÜôÂ≠óÊØçÔºåÁ¶ÅÁî®ÂÖ≥ÈîÆÂ≠óÔºàindex,orderÁ≠âÔºâ„ÄÇ ÂâçÁºÄÂëΩ‰ª§ËßÑËåÉ ËßÜÂõæ‰ª•view_ÂºÄÂ§¥Ôºå‰∫ã‰ª∂‰ª•event_ÂºÄÂ§¥ÔºåËß¶ÂèëÂô®‰ª•trig_ÂºÄÂ§¥ÔºåÂ≠òÂÇ®ËøáÁ®ã‰ª•proc_ÂºÄÂ§¥ÔºåÂáΩÊï∞‰ª•func_ÂºÄÂ§¥ÔºåÂ∫îÁî®‰∏äÈù¢Á¶ÅÁî® ÊôÆÈÄöÁ¥¢Âºï‰ª•idx_ÂêÑ‰∏™ÂàóÂêçÁÆÄÁß∞ÔºåÂîØ‰∏ÄÁ¥¢Âºï‰ª•uk_ÂêÑ‰∏™ÂàóÂêçÁÆÄÁß∞ÂëΩÂêçÔºå‰∏≠Èó¥Áî®_ÈöîÂºÄ„ÄÇÂ¶Ç idx_col1_col2_col3(col1,col2,col3)ÔºåÂ¶ÇÊûúÂàóËøáÈïøÔºåÁî®ÁÆÄÂÜô ‰∏¥Êó∂Ë°®‰ª•tmp_ÂÆû‰ΩìË°®ÂêçÔºåÁ∫ø‰∏äÁ¶ÅÁî®ÔºåÂ§á‰ªΩË°®‰ª•bak_Êó•Êúü_ÂÆû‰ΩìË°®ÂêçÔºåÂ∞ΩÂèØËÉΩÂ§á‰ªΩËá≥HDFS Â∫ìÂêç„ÄÅË°®Âêç„ÄÅÂ≠óÊÆµÂêçÁ¶ÅÊ≠¢Ë∂ÖËøá32‰∏™Â≠óÁ¨¶ÔºåÈúÄËßÅÂêçÁü•ÊÑèÂ∫ìÂêç„ÄÅË°®Âêç„ÄÅÂ≠óÊÆµÂêçÊîØÊåÅÊúÄÂ§ö32‰∏™Â≠óÁ¨¶Ôºå‰ΩÜ‰∏∫‰∫ÜÁªü‰∏ÄËßÑËåÉ„ÄÅÊòì‰∫éËæ®ËØÜ‰ª•ÂèäÂáèÂ∞ë‰º†ËæìÈáèÔºåÁ¶ÅÊ≠¢Ë∂ÖËøá32‰∏™Â≠óÁ¨¶Ôºå‰æãÔºö‰∏öÂä°ÂêçÁß∞/ÂÆû‰Ωì_Ë°®‰ΩúÁî® ÊåâÊó•ÊúüÊó∂Èó¥ÂàÜË°®È°ªÁ¨¶Âêà_YYYYMMDDÊ†ºÂºèÊåâÊúàÊàñÊó•ÁîüÊàêÁöÑË°®Ôºå‰ª•_YYYYMM[DD]ÊñπÂºèÂëΩÂêç„ÄÇ ‰∫å. Â∫ìË°®Âü∫Á°ÄËßÑËåÉ ‰ΩøÁî®InnodbÂ≠òÂÇ®ÂºïÊìéÊâÄÊúâË°®ÂøÖÈ°ª‰ΩøÁî®ÈªòËÆ§Â≠òÂÇ®ÂºïÊìéInnoDB„ÄÇ Ë°®ÁºñÁ†ÅÊñπÂºèÁªü‰∏Ä‰ΩøÁî®UTF8ÊàñUTF8MB4ÁöÑÂàõÂª∫Á¥¢ÂºïÊó∂utf8ÊØîutf8mb4Â∞ë‰∏Ä‰∏™Â≠óËäÇÔºåÊâÄ‰ª•ÊòéÁ°ÆÊ≤°ÊúâemojÊó∂ÔºåÂ∞ΩÈáè‰ΩøÁî®utf8„ÄÇ ÊâÄÊúâË°®ÈÉΩË¶ÅÊ∑ªÂä†Ê≥®ÈáäÊâÄÊúâÂ≠óÊÆµÂøÖÈúÄË¶ÅÊúâÊ≥®ÈáäÔºåÂåÖÊã¨Ë°®Ê≥®ÈáäÔºåÂπ∂Ê†áÊ≥®ÁÆÄÂçïÊÑè‰πâ ÊéßÂà∂ÂçïË°®Â≠óÊÆµÊï∞Èáè ÂçïË°®Â≠óÊÆµÊï∞‰∏äÈôê50Â∑¶Âè≥ÔºåÂÜçÂ§öÁöÑËØùËÄÉËôëÂûÇÁõ¥ÂàÜË°®Ôºå‰∏ÄÊòØÂÜ∑ÁÉ≠Êï∞ÊçÆÂàÜÁ¶ªÔºå‰∫åÊòØÂ§ßÂ≠óÊÆµÂàÜÁ¶ªÔºå‰∏âÊòØÂ∏∏Âú®‰∏ÄËµ∑ÂÅöÊù°‰ª∂ÂíåËøîÂõûÂàóÁöÑ‰∏çÂàÜÁ¶ª„ÄÇ Ë°®Â≠óÊÆµÊéßÂà∂Â∞ëËÄåÁ≤æÔºåÂèØ‰ª•ÊèêÈ´òIOÊïàÁéáÔºåÂÜÖÂ≠òÁºìÂ≠òÊõ¥Â§öÊúâÊïàÊï∞ÊçÆÔºå‰ªéËÄåÊèêÈ´òÂìçÂ∫îÈÄüÂ∫¶ÂíåÂπ∂ÂèëËÉΩÂäõÔºåÂêéÁª≠ alter table ‰πüÊõ¥Âø´„ÄÇ ÊâÄÊúâË°®ÈÉΩÂøÖÈ°ªË¶ÅÊòæÂºèÊåáÂÆö‰∏ªÈîÆ ÂèåÊ¥ªÁöÑË°®ÂøÖÈ°ªÁ¶ÅÁî®Ëá™Â¢û‰∏ªÈîÆ„Äêsnowflake„ÄëÔºåInnoDBË°®ÂÆûÈôÖÊòØ‰∏ÄÊ£µÁ¥¢ÂºïÁªÑÁªáË°®ÔºåÈ°∫Â∫èÂ≠òÂÇ®ÂèØ‰ª•ÊèêÈ´òÂ≠òÂèñÊïàÁéáÔºåÂÖÖÂàÜÂà©Áî®Á£ÅÁõòÁ©∫Èó¥„ÄÇËøòÊúâÂØπ‰∏Ä‰∫õÂ§çÊùÇÊü•ËØ¢ÂèØËÉΩÈúÄË¶ÅËá™ËøûÊé•Êù•‰ºòÂåñÊó∂ÈúÄË¶ÅÁî®Âà∞„ÄÇ ÈúÄË¶ÅÂÖ®Â±ÄÂîØ‰∏Ä‰∏ªÈîÆÊó∂Ôºågmt_createËøôÁ±ªÁöÑËÉΩ‰ΩøÁî®‰∏ªÈîÆÊéíÂ∫èÁöÑÂ∞ΩÈáè‰ΩøÁî®‰∏ªÈîÆÂÅöÂàÜÈ°µÊéíÂ∫èÔºå‰∏çÊµ™Ë¥πÁ¥¢Âºï Â∞ëÊï∞ÊÉÖÂÜµÂèØ‰ª•‰ΩøÁî®ËÅîÂêàÂîØ‰∏Ä‰∏ªÈîÆÔºåÈúÄ‰∏éDBAÂçèÂïÜ ‰∏ç‰ΩøÁî®Â§ñÈîÆÂ§ñÈîÆ‰∏•ÈáçÂΩ±ÂìçÊï∞ÊçÆÂ∫ìÊÄßËÉΩÔºåÂ¢ûÂä†Ë°®Áª¥Êä§Â§çÊùÇÂ∫¶ÔºåÊâÄ‰ª•Á∫ø‰∏äÁ¶ÅÁî®Â§ñÈîÆ Â≠óÊÆµÂêçÁß∞Áªü‰∏Ä ÊØèÂº†Ë°®ÂéüÂàô‰∏äÂøÖÈ°ªÂê´Êúâgmt_create,gmt_modifyÔºågmt_create‰∏∫ÂàõÂª∫Êó∂Èó¥„ÄÇgmt_modifyÂ±ûÊÄß‰∏∫NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMPÔºågmt_createÂ±ûÊÄß‰∏∫NOT NULL DEFAULT CURRENT_TIMESTAMPÔºåÁªü‰∏ÄÊîæËá≥Â≠óÊÆµÊúÄÂêé ÊâÄÊúâÁõ∏ÂêåÊÑè‰πâÁöÑË°®ÈááÁî®Áªü‰∏ÄÂ≠óÊÆµÂêçÁß∞ÔºåÂπ∂‰∏îÂ≠óÊÆµÁ±ªÂûã‰∏ÄËá¥ÔºåËøôÊ†∑Â∫îÁî®‰∏éÁª¥Êä§‰∫∫ÂëòËßÅÂ≠óÊÆµÁü•ÂÖ∂Âê´‰πâÔºåÊñπ‰æøÁêÜËß£ ÁÆÄÂçïÂçïË°®Êï∞ÊçÆÈáèÊéßÂà∂Âú®1000w‰ª•ÂÜÖ Â∞ΩÈáè‰øùËØÅÂçïË°®Â≠òÂÇ®Á©∫Èó¥Â∞è‰∫é10GB Âª∫Ë°®Êó∂‰∏çË¶ÅÂä†ÂÖ•COLLATEÁõ∏ÂÖ≥ÂÜÖÂÆπ ‰∏â. Â≠óÊÆµËßÑËåÉ char„ÄÅvarchar„ÄÅtextÁ≠âÂ≠óÁ¨¶‰∏≤Á±ªÂûãÂÆö‰πâ ÂØπ‰∫éÈïøÂ∫¶Âü∫Êú¨Âõ∫ÂÆöÁöÑÂàóÔºåÂ¶ÇÊûúËØ•ÂàóÊÅ∞Â•ΩÊõ¥Êñ∞ÂèàÁâπÂà´È¢ëÁπÅÔºåÈÄÇÂêàchar varcharËôΩÁÑ∂Â≠òÂÇ®ÂèòÈïøÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜ‰∏çÂèØÂ§™Â∞è‰πü‰∏çÂèØÂ§™Â§ß„ÄÇUTF8ÊúÄÂ§öËÉΩÂ≠ò21844‰∏™Ê±âÂ≠óÔºåÊàñ65532‰∏™Ëã±Êñá TEXTÁ±ªÂûã‰∏éVARCHARÈÉΩÁ±ª‰ººÔºåÂ≠òÂÇ®ÂèØÂèòÈïøÂ∫¶ÔºåÊúÄÂ§ßÈôêÂà∂‰πüÊòØ2^16Ôºå‰ΩÜÊòØÂÆÉ20bytes‰ª•ÂêéÁöÑÂÜÖÂÆπÊòØÂú®Êï∞ÊçÆÈ°µ‰ª•Â§ñÁöÑÁ©∫Èó¥Â≠òÂÇ®Ôºàrow_format=dynamicÔºâÔºåÂØπÂÆÉÁöÑ‰ΩøÁî®ÈúÄË¶ÅÂ§ö‰∏ÄÊ¨°ÂØªÂùÄÔºåÊ≤°ÊúâÈªòËÆ§ÂÄº„ÄÇ Êäätext/blobÊãÜÂà∞Âè¶‰∏Ä‰∏™Ë°®‰∏≠ÔºåÂ¶ÇÊûúÂè™Â≠ò‰∏çËØªÁöÑÁ¶ÅÁî®ÔºåÂª∫ËÆÆÁõ¥Êé•Â≠òHDFS BLOBÂèØ‰ª•ÁúãÂá∫varbinaryÁöÑÊâ©Â±ïÁâàÊú¨ÔºåÂÜÖÂÆπ‰ª•‰∫åËøõÂà∂Â≠óÁ¨¶‰∏≤Â≠òÂÇ®ÔºåÊó†Â≠óÁ¨¶ÈõÜÔºåÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºåÊúâ‰∏ÄÁßçÁªèÂ∏∏Êèê‰ΩÜ‰∏çÁî®ÁöÑÂú∫ÊôØÔºö‰∏çË¶ÅÂú®Êï∞ÊçÆÂ∫ìÈáåÂ≠òÂÇ®ÂõæÁâá„ÄÇ Â≠óÁ¨¶ÈõÜ‰∏∫utf8ÔºåvarcharÁ±ªÂûãÊúÄÂ§ßÂè™ËÉΩÂàõÂª∫Á¥¢Âºï‰∏∫Ââç255Â≠óËäÇÔºõÂ≠óÁ¨¶ÈõÜ‰∏∫utf8mb4ÔºåvarcharÁ±ªÂûãÊúÄÂ§ßÂè™ËÉΩÂàõÂª∫Á¥¢Âºï‰∏∫Ââç191Â≠óËäÇ„ÄÇÊâÄ‰ª•Â≠óÊÆµÈÄ†ÂûãÊó∂È¶ñÈÄâintÔºåÂ¶ÇÊûúvarcharÊó∂Â≠óÊÆµÂÅöÊü•ËØ¢ÁöÑË∂äÂ∞èË∂äÂ•ΩÔºåÈïøÂ∫¶‰∏çË¶ÅË∂ÖËøá191„ÄÇ int„ÄÅtinyint„ÄÅdecimalÁ≠âÊï∞Â≠óÁ±ªÂûãÂÆö‰πâ ‰ΩøÁî®tinyintÊù•‰ª£Êõø enumÂíåbooleanENUMÁ±ªÂûãÂú®ÈúÄË¶Å‰øÆÊîπÊàñÂ¢ûÂä†Êûö‰∏æÂÄºÊó∂ÔºåÈúÄË¶ÅÂú®Á∫øDDLÔºåÊàêÊú¨ËæÉÈ´òÔºõENUMÂàóÂÄºÂ¶ÇÊûúÂê´ÊúâÊï∞Â≠óÁ±ªÂûãÔºåÂèØËÉΩ‰ºöÂºïËµ∑ÈªòËÆ§ÂÄºÊ∑∑Ê∑Ütinyint‰ΩøÁî®1‰∏™Â≠óËäÇÔºå‰∏ÄËà¨Áî®‰∫éstatus,type,flagÁöÑÂàó Âª∫ËÆÆ‰ΩøÁî® UNSIGNED Â≠òÂÇ®ÈùûË¥üÊï∞ÂÄºÁõ∏ÊØî‰∏ç‰ΩøÁî® unsignedÔºåÂèØ‰ª•Êâ©Â§ß‰∏ÄÂÄç‰ΩøÁî®Êï∞ÂÄºËåÉÂõ¥ int‰ΩøÁî®Âõ∫ÂÆö4‰∏™Â≠óËäÇÂ≠òÂÇ®Ôºåint(11)‰∏éint(4)Âè™ÊòØÊòæÁ§∫ÂÆΩÂ∫¶ÁöÑÂå∫Âà´ ‰ΩøÁî®intÂ≠òÂÇ®IPv4Âú∞ÂùÄÔºåÂèØËäÇÁúÅ 9%+ÁöÑÊï∞ÊçÆÂ≠òÂÇ®Á©∫Èó¥ ‰ΩøÁî®Decimal ‰ª£Êõøfloat/doubleÂ≠òÂÇ®Á≤æÁ°ÆÊµÆÁÇπÊï∞ÂØπ‰∫éË¥ßÂ∏Å„ÄÅÈáëÈ¢ùËøôÊ†∑ÁöÑÁ±ªÂûãÔºåÂèØ‰ª•‰ΩøÁî®ÔºàË¥ßÂ∏Å‰ΩøÁî®bigint+Â∏ÅÁßç+ÊúÄÂ∞èÂçï‰ΩçÔºâÔºåÂ¶ÇÊûúÁ≤æÂ∫¶‰∏çÈ´òÔºåÂèØ‰ª•‰ΩøÁî®decimal(9,2)„ÄÇfloatÈªòËÆ§Âè™ËÉΩËÉΩÁ≤æÁ°ÆÂà∞6‰ΩçÊúâÊïàÊï∞Â≠ó timestamp‰∏édatetimeÈÄâÊã© datetime Âíå timestampÁ±ªÂûãÊâÄÂç†ÁöÑÂ≠òÂÇ®Á©∫Èó¥‰∏çÂêåÔºåÂâçËÄÖ8‰∏™Â≠óËäÇÔºåÂêéËÄÖ4‰∏™Â≠óËäÇÔºåËøôÊ†∑ÈÄ†ÊàêÁöÑÂêéÊûúÊòØ‰∏§ËÄÖËÉΩË°®Á§∫ÁöÑÊó∂Èó¥ËåÉÂõ¥‰∏çÂêå„ÄÇÂâçËÄÖËåÉÂõ¥‰∏∫1000-01-01 00:00:00 ~ 9999-12-31 23:59:59ÔºåÂêéËÄÖËåÉÂõ¥‰∏∫ 1970-01-01 00:00:00 Âà∞ 2037-12-31 23:59:59„ÄÇÊâÄ‰ª• TIMESTAMP ÊîØÊåÅÁöÑËåÉÂõ¥ÊØî DATATIME Ë¶ÅÂ∞è„ÄÇ timestampÂèØ‰ª•Âú®insert/updateË°åÊó∂ÔºåËá™Âä®Êõ¥Êñ∞Êó∂Èó¥Â≠óÊÆµÔºàÂ¶Ç NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMPÔºâÔºå‰ΩÜ‰∏Ä‰∏™Ë°®Âè™ËÉΩÊúâ‰∏Ä‰∏™ËøôÊ†∑ÁöÑÂÆö‰πâ„ÄÇ timestampÊòæÁ§∫‰∏éÊó∂Âå∫ÊúâÂÖ≥ÔºåÂÜÖÈÉ®ÊÄªÊòØ‰ª• UTC ÊØ´Áßí Êù•Â≠òÁöÑ„ÄÇËøòÂèóÂà∞‰∏•Ê†ºÊ®°ÂºèÁöÑÈôêÂà∂ ‰ºòÂÖà‰ΩøÁî®timestampÔºådatetime‰πüÊ≤°ÈóÆÈ¢òÔºåtimestampÁ≤æÂ∫¶ÂèØ‰ª•Âà∞ÁßíÂêé6‰ΩçÔºåÂç≥timestamp(6) whereÊù°‰ª∂Èáå‰∏çË¶ÅÂØπÊó∂Èó¥Âàó‰∏ä‰ΩøÁî®Êó∂Èó¥ÂáΩÊï∞ Âª∫ËÆÆÂ≠óÊÆµÈÉΩÂÆö‰πâ‰∏∫NOT NULLÂä†‰∏ädefaultÂÄº Â¶ÇÊûúÊòØÁ¥¢ÂºïÂ≠óÊÆµÔºå‰∏ÄÂÆöË¶ÅÂÆö‰πâ‰∏∫not null „ÄÇÂõ†‰∏∫nullÂÄº‰ºöÂΩ±ÂìçcordinateÁªüËÆ°ÔºåÂΩ±Âìç‰ºòÂåñÂô®ÂØπÁ¥¢ÂºïÁöÑÈÄâÊã© Â¶ÇÊûú‰∏çËÉΩ‰øùËØÅinsertÊó∂‰∏ÄÂÆöÊúâÂÄºËøáÊù•ÔºåÂÆö‰πâÊó∂‰ΩøÁî®default ‚Äò‚Äô ÔºåÊàñ 0 ‰∏äÈù¢‰∏§Êù°Â¶ÇÊûúÈúÄË¶ÅÂèåÊú∫ÊàøÂêåÊ≠•ÔºåÈÇ£ÂêåÊ≠•ÁöÑË°®Êñ∞Â¢ûÊàñÊõ¥ÊîπÂøÖÈ°ª‰∏∫NULLÔºåÂÜçË°åÂàùÂßãÂåñÊï∞ÊçÆ Á±ªÂûãÈÄâÊã©ÂéüÂàôInt-&gt;char-&gt;varchar-&gt;textÔºå‰ªéÂ∑¶Âà∞Âè≥ÊÄßËÉΩË∂äÂ∑Æ Âõõ. Á¥¢ÂºïËßÑËåÉ Á¥¢Âºï‰∏™Êï∞ÈôêÂà∂ Á¥¢ÂºïÊòØÂèåÂàÉÂâëÔºå‰ºöÂ¢ûÂä†Áª¥Êä§Ë¥üÊãÖÔºåÂ¢ûÂ§ßIOÂéãÂäõÔºåÁ¥¢ÂºïÂç†Áî®Á©∫Èó¥ÊòØÊàêÂÄçÂ¢ûÂä†ÁöÑ ÂçïÂº†Ë°®ÁöÑÁ¥¢ÂºïÊï∞ÈáèÊéßÂà∂Âú®5‰∏™‰ª•ÂÜÖÔºåÁ¥¢ÂºïÁöÑÂ§ßÂ∞èÂ∞ΩÈáèÊØîË°®Â∞è„ÄÇËã•ÂçïÂº†Ë°®Â§ö‰∏™Â≠óÊÆµÂú®Êü•ËØ¢ÈúÄÊ±Ç‰∏äÈÉΩË¶ÅÂçïÁã¨Áî®Âà∞Á¥¢ÂºïÔºåÈúÄË¶ÅÁªèËøáDBAËØÑ‰º∞„ÄÇ ÈÅøÂÖçÂÜó‰ΩôÁ¥¢Âºï InnoDBË°®ÊòØ‰∏ÄÊ£µÁ¥¢ÂºïÁªÑÁªáË°®Ôºå‰∏ªÈîÆÊòØÂíåÊï∞ÊçÆÊîæÂú®‰∏ÄËµ∑ÁöÑËÅöÈõÜÁ¥¢ÂºïÔºåÊôÆÈÄöÁ¥¢ÂºïÊúÄÁªàÊåáÂêëÁöÑÊòØ‰∏ªÈîÆÂú∞ÂùÄÔºåÊâÄ‰ª•Êää‰∏ªÈîÆÂÅöÊúÄÂêé‰∏ÄÂàóÊòØÂ§ö‰ΩôÁöÑ„ÄÇÂ¶Çid‰Ωú‰∏∫‰∏ªÈîÆÔºåËÅîÂêàÁ¥¢Âºï(user_id,id)‰∏äÁöÑidÂ∞±ÂÆåÂÖ®Â§ö‰Ωô (a,b,c)„ÄÅ(a,b)ÔºåÂêéËÄÖ‰∏∫ÂÜó‰ΩôÁ¥¢Âºï„ÄÇÂèØ‰ª•Âà©Áî®ÂâçÁºÄÁ¥¢ÂºïÊù•ËææÂà∞Âä†ÈÄüÁõÆÁöÑÔºåÂáèËΩªÁª¥Êä§Ë¥üÊãÖ Á¥¢ÂºïÂàõÂª∫ÂéüÂàô Â∞ΩÂèØËÉΩÈÄâÊã©ËøáÊª§ÊïàÊûúÂ•ΩÁöÑÂàó‰∏äÂàõÂª∫Á¥¢Âºï Á¥¢ÂºïÈÄâÊã©ÊÄßËÆ°ÁÆóÊñπÊ≥ïÔºàÂü∫Êï∞ √∑ Êï∞ÊçÆË°åÊï∞ÔºâSelectivity = Cardinality / Total Rows = select count(distinct col1)/count(*) from tbnameÔºåË∂äÊé•Ëøë1ËØ¥Êòécol1‰∏ä‰ΩøÁî®Á¥¢ÂºïÁöÑËøáÊª§ÊïàÊûúË∂äÂ•Ω Â¶ÇÊûúÊüêÂàó‰∏∫sexÔºåÊï∞ÊçÆÂÄæÊñúÊØîËæÉÂ§ßÔºåmaleÂç†ÊØî99%ÔºåfemaleÂç†ÊØî1%ÔºåËÄåÊØèÊ¨°Êü•ËØ¢ÈÉΩ‰∏∫femaleÔºåÂàôÈúÄË¶ÅÂàõÂª∫ËØ•ÂàóÁöÑÁ¥¢Âºï ÊúÄÂ∑¶ÂâçÁºÄÂéüÂàô mysql‰ΩøÁî®ËÅîÂêàÁ¥¢ÂºïÊó∂Ôºå‰ªéÂ∑¶ÂêëÂè≥ÂåπÈÖçÔºåÈÅáÂà∞Êñ≠ÂºÄÊàñËÄÖËåÉÂõ¥Êü•ËØ¢Êó∂ÔºåÊó†Ê≥ïÁî®Âà∞ÂêéÁª≠ÁöÑÁ¥¢ÂºïÂàóÊØîÂ¶ÇÁ¥¢Âºïidx_c1c2c3 (c1,c2,c3)ÔºåÁõ∏ÂΩì‰∫éÂàõÂª∫‰∫Ü(c1)„ÄÅ(c1,c2)„ÄÅ(c1,c2,c3)‰∏â‰∏™Á¥¢ÂºïÔºåwhereÊù°‰ª∂ÂåÖÂê´‰∏äÈù¢‰∏âÁßçÊÉÖÂÜµÁöÑÂ≠óÊÆµÊØîËæÉÂàôÂèØ‰ª•Áî®Âà∞Á¥¢ÂºïÔºå‰ΩÜÂÉè where c1=a and c3=c Âè™ËÉΩÁî®Âà∞c1ÂàóÁöÑÁ¥¢ÂºïÔºåÂÉè c2=b and c3=cÁ≠âÊÉÖÂÜµÂ∞±ÂÆåÂÖ®Áî®‰∏çÂà∞Ëøô‰∏™Á¥¢Âºï ÈÅáÂà∞ËåÉÂõ¥Êü•ËØ¢(&gt;„ÄÅ&lt;„ÄÅbetween„ÄÅlike)‰πü‰ºöÂÅúÊ≠¢Á¥¢ÂºïÂåπÈÖçÔºåÊØîÂ¶Ç c1=a and c2 &gt; 2 and c3=cÔºåÂè™Êúâc1,c2Âàó‰∏äÁöÑÊØîËæÉËÉΩÁî®Âà∞Á¥¢ÂºïÔºå(c1,c2,c3)ÊéíÂàóÁöÑÁ¥¢ÂºïÊâçÂèØËÉΩ‰ºöÈÉΩÁî®‰∏ä whereÊù°‰ª∂ÈáåÈù¢Â≠óÊÆµÁöÑÈ°∫Â∫è‰∏éÁ¥¢ÂºïÈ°∫Â∫èÊó†ÂÖ≥Ôºåmysql‰ºòÂåñÂô®‰ºöËá™Âä®Ë∞ÉÊï¥È°∫Â∫è mysqlÁöÑoptimizer_switchÔºåÂèØ‰ª•ÈÖçÁΩÆicpÔºåmrrÁ≠âÁâπÊÄß„ÄÇmrr‰∏∫Â§ö‰∏™Â≠óÊÆµÂÅöÂêàÂπ∂ÔºåÂ¶ÇÂ∑≤Â≠òÂú®c1,c2,c3Á¥¢ÂºïÔºåÊü•ËØ¢Êó∂c1=‚Äôa‚Äô and/or c2=‚Äôb‚ÄôÔºåÂàô‰ºö‰ΩøÁî®Âà∞Á¥¢ÂºïÂêàÂπ∂ÔºåÂ¶ÇÊûúÂ§ßÈÉ®ÂàÜÊü•ËØ¢Ê≤°Êúâc1Âíåc2ÂêåÊó∂Â≠òÂú®ÔºåÂàôÂª∫ËÆÆÂàõÂª∫ÂçïÂàóÁ¥¢Âºï ÂâçÁºÄÁ¥¢Âºï ÂâçÁºÄÁ¥¢ÂºïÂ∞ΩÈáèÁ¨¨‰∏ÄÂàóÂå∫ÂàÜÂ∫¶È´òÔºåËøôÊ†∑Â¶ÇÊûú‰ºòÂåñÂô®Âà§Êñ≠Êó∂‰ºöÊØîËæÉÂáÜÁ°Æ ,AÂàó1000‰∏™‰∏çÂêåÂÄºÔºåBÂàóÊúâ100000‰∏™‰∏çÂêåÂÄºÔºåËøôÊ†∑Âª∫ËÆÆÁ¥¢ÂºïÂàõÂª∫Êó∂idx_B_A(B,A) ÂêàÁêÜ‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÂáèÂ∞ëIOINNODBÂ≠òÂÇ®ÂºïÊìé‰∏≠Ôºåsecondary index(Èùû‰∏ªÈîÆÁ¥¢ÂºïÔºåÂèàÁß∞‰∏∫ËæÖÂä©Á¥¢Âºï„ÄÅ‰∫åÁ∫ßÁ¥¢Âºï)Ê≤°ÊúâÁõ¥Êé•Â≠òÂÇ®Ë°åÂú∞ÂùÄÔºåËÄåÊòØÂ≠òÂÇ®‰∏ªÈîÆÂÄº„ÄÇÂ¶ÇÊûúÁî®Êà∑ÈúÄË¶ÅÊü•ËØ¢secondary index‰∏≠ÊâÄ‰∏çÂåÖÂê´ÁöÑÊï∞ÊçÆÂàóÔºåÂàôÈúÄË¶ÅÂÖàÈÄöËøásecondary indexÊü•ÊâæÂà∞‰∏ªÈîÆÂÄºÔºåÁÑ∂ÂêéÂÜçÈÄöËøá‰∏ªÈîÆÊü•ËØ¢Âà∞ÂÖ∂‰ªñÊï∞ÊçÆÂàóÔºåÂõ†Ê≠§ÈúÄË¶ÅÊü•ËØ¢‰∏§Ê¨°„ÄÇË¶ÜÁõñÁ¥¢ÂºïÂàôÂèØ‰ª•Âú®‰∏Ä‰∏™Á¥¢Âºï‰∏≠Ëé∑ÂèñÊâÄÊúâÈúÄË¶ÅÁöÑÊï∞ÊçÆÂàóÔºå‰ªéËÄåÈÅøÂÖçÂõûË°®ËøõË°å‰∫åÊ¨°Êü•ÊâæÔºåËäÇÁúÅIOÂõ†Ê≠§ÊïàÁéáËæÉÈ´ò„ÄÇ‰æãÂ¶ÇSELECT emailÔºåuid FROM user_email WHERE uid=xxÔºåÂ¶ÇÊûúuid‰∏çÊòØ‰∏ªÈîÆÔºåÈÄÇÂΩìÊó∂ÂÄôÂèØ‰ª•Â∞ÜÁ¥¢ÂºïÊ∑ªÂä†‰∏∫index(uidÔºåemail)Ôºå‰ª•Ëé∑ÂæóÊÄßËÉΩÊèêÂçá„ÄÇ ‰∏çË¶ÅÂú®È¢ëÁπÅÊõ¥Êñ∞ÁöÑÂàó‰∏äÂàõÂª∫Á¥¢Âºï ‰∫î. SQLËÆæËÆ° ÊùúÁªùÁõ¥Êé• SELECT * ËØªÂèñÂÖ®ÈÉ®Â≠óÊÆµÂç≥‰ΩøÈúÄË¶ÅÊâÄÊúâÂ≠óÊÆµÔºåÂáèÂ∞ëÁΩëÁªúÂ∏¶ÂÆΩÊ∂àËÄóÔºåËÉΩÊúâÊïàÂà©Áî®Ë¶ÜÁõñÁ¥¢ÂºïÔºåË°®ÁªìÊûÑÂèòÊõ¥ÂØπÁ®ãÂ∫èÂü∫Êú¨Êó†ÂΩ±Âìç ËÉΩÁ°ÆÂÆöËøîÂõûÁªìÊûúÂè™Êúâ‰∏ÄÊù°Êó∂Ôºå‰ΩøÁî® limit 1Âú®‰øùËØÅÊï∞ÊçÆ‰∏ç‰ºöÊúâËØØÁöÑÂâçÊèê‰∏ãÔºåËÉΩÁ°ÆÂÆöÁªìÊûúÈõÜÊï∞ÈáèÊó∂ÔºåÂ§ö‰ΩøÁî®limitÔºåÂ∞ΩÂø´ÁöÑËøîÂõûÁªìÊûú„ÄÇ Âª∫ËÆÆ‰∏çË¶Å‰ΩøÁî®ÈöêÂºèÁ±ªÂûãËΩ¨Êç¢ Á¶ÅÊ≠¢Âú®whereÊù°‰ª∂Âàó‰∏ä‰ΩøÁî®ÂáΩÊï∞ ‰ºöÂØºËá¥Á¥¢ÂºïÂ§±ÊïàÔºåÂ¶Çlower(email)Ôºåf_qq % 4„ÄÇÂèØÊîæÂà∞Âè≥ËæπÁöÑÂ∏∏Èáè‰∏äËÆ°ÁÆó ËøîÂõûÂ∞èÁªìÊûúÈõÜ‰∏çÊòØÂæàÂ§ßÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•ÂØπËøîÂõûÂàó‰ΩøÁî®ÂáΩÊï∞ÔºåÁÆÄÂåñÁ®ãÂ∫èÂºÄÂèëÔºå‰ΩÜÂ∞ΩÈáè‰∏çË¶Å‰ΩøÁî®ÂáΩÊï∞Á¥¢Âºï ‰ΩøÁî®likeÊ®°Á≥äÂåπÈÖçÔºå%‰∏çË¶ÅÊîæÈ¶ñ‰Ωç‰ºöÂØºËá¥Á¥¢ÂºïÂ§±ÊïàÔºåÊúâËøôÁßçÊêúÁ¥¢ÈúÄÊ±ÇÊòØÔºåËÄÉËôëÂÖ∂ÂÆÉÊñπÊ°àÔºåÂ¶ÇesÂÖ®ÊñáÊêúÁ¥¢ ‰ΩøÁî®joinÊó∂ÔºåwhereÊù°‰ª∂Â∞ΩÈáè‰ΩøÁî®ÂÖÖÂàÜÂà©Áî®Âêå‰∏ÄË°®‰∏äÁöÑÁ¥¢Âºï Â¶Ç select t1.a,t2.b * from t1,t2 where t1.a=t2.a and t1.b=123 and t2.c= 4 ÔºåÂ¶ÇÊûút1.c‰∏ét2.cÂ≠óÊÆµÁõ∏ÂêåÔºåÈÇ£‰πàt1‰∏äÁöÑÁ¥¢Âºï(b,c)Â∞±Âè™Áî®Âà∞b‰∫Ü„ÄÇÊ≠§Êó∂Â¶ÇÊûúÊääwhereÊù°‰ª∂‰∏≠ÁöÑt2.c=4ÊîπÊàêt1.c=4ÔºåÈÇ£‰πàÂèØ‰ª•Áî®Âà∞ÂÆåÊï¥ÁöÑÁ¥¢Âºï ËøôÁßçÊÉÖÂÜµÂèØËÉΩ‰ºöÂú®Â≠óÊÆµÂÜó‰ΩôËÆæËÆ°ÔºàÂèçËåÉÂºèÔºâÊó∂Âá∫Áé∞ Ê≠£Á°ÆÈÄâÂèñinner joinÂíåleft join Â∞ëÁî®Êàñ‰∏çÁî®Â≠êÊü•ËØ¢ÔºåÊîπÁî®joinmysql 5.6ÁâàÊú¨Âè™ÊîØÊåÅnest loopÔºåËÆ©mysqlËá™Â∑≤Âà§Êñ≠ÈúÄË¶Å‰ΩøÁî®ÁöÑÁ¥¢Âºï ËÄÉËôë‰ΩøÁî®union allÔºåÂ∞ë‰ΩøÁî®unionÔºåÊ≥®ÊÑèËÄÉËôëÂéªÈáç union all‰∏çÂéªÈáçÔºåËÄåÂ∞ë‰∫ÜÊéíÂ∫èÊìç‰ΩúÔºåÈÄüÂ∫¶Áõ∏ÂØπÊØîunionË¶ÅÂø´ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂéªÈáçÁöÑÈúÄÊ±ÇÔºå‰ºòÂÖà‰ΩøÁî®union all Â¶ÇÊûúUNIONÁªìÊûú‰∏≠Êúâ‰ΩøÁî®limitÔºåÂú®2‰∏™Â≠êSQLÂèØËÉΩÊúâËÆ∏Â§öËøîÂõûÂÄºÁöÑÊÉÖÂÜµ‰∏ãÔºåÂêÑËá™Âä†‰∏älimit„ÄÇÂ¶ÇÊûúËøòÊúâorder byÔºåËØ∑ÊâæDBA„ÄÇ INÁöÑÂÜÖÂÆπÂ∞ΩÈáè‰∏çË∂ÖËøá200‰∏™Ë∂ÖËøá200‰∏™ÂÄº‰ΩøÁî®ÊâπÈáèÁöÑÊñπÂºèÔºåÂê¶Âàô‰∏ÄÊ¨°ÊâßË°å‰ºöÂΩ±ÂìçÊï∞ÊçÆÂ∫ìÁöÑÂπ∂ÂèëËÉΩÂäõÔºåÂõ†‰∏∫ÂçïSQLÂè™ËÉΩ‰∏î‰∏ÄÁõ¥Âç†Áî®ÂçïCPUÔºåËÄå‰∏îÂèØËÉΩÂØºËá¥‰∏ª‰ªéÂ§çÂà∂Âª∂Ëøü ÊãíÁªùÂ§ß‰∫ãÂä°ÊØîÂ¶ÇÂú®‰∏Ä‰∏™‰∫ãÂä°ÈáåËøõË°åÂ§ö‰∏™selectÔºåÂ§ö‰∏™updateÔºåÂ¶ÇÊûúÊòØÈ´òÈ¢ë‰∫ãÂä°Ôºå‰ºö‰∏•ÈáçÂΩ±ÂìçMySQLÂπ∂ÂèëËÉΩÂäõÔºåÂõ†‰∏∫‰∫ãÂä°ÊåÅÊúâÁöÑÈîÅÁ≠âËµÑÊ∫êÂè™Âú®‰∫ãÂä°rollback/commitÊó∂ÊâçËÉΩÈáäÊîæ„ÄÇ‰ΩÜÂêåÊó∂‰πüË¶ÅÊùÉË°°Êï∞ÊçÆÂÜôÂÖ•ÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ ÈÅøÂÖç‰ΩøÁî®is null, is not nullËøôÊ†∑ÁöÑÊØîËæÉ ÊùúÁªùÂç±Èô©SQL ÂéªÊéâwhere 1=1 ËøôÊ†∑Êó†ÊÑè‰πâÊàñÊÅíÁúüÁöÑÊù°‰ª∂ÔºåÂ¶ÇÊûúÈÅáÂà∞update/deleteÊàñÈÅ≠Âà∞sqlÊ≥®ÂÖ•Â∞±ÊÅêÊÄñ‰∫Ü SQL‰∏≠‰∏çÂÖÅËÆ∏Âá∫Áé∞DDLËØ≠Âè•„ÄÇ‰∏ÄËà¨‰πü‰∏çÁªô‰∫àcreate/alterËøôÁ±ªÊùÉÈôê ÁºñÂÜôSQL ÊÖéÁî®ÂàÜÁªÑ„ÄÅËÅöÂêà ‚Äã Âú®ÁºñÂÜôSQL‰∏≠ÔºåÂéüÂàô‰∏ä‰∏çËÉΩ‰ΩøÁî®‰ª•‰∏ãÊñπÊ≥ïÔºåÂ∞ΩÂèØËÉΩÂ∞ÜËøô‰∫õÈÄªËæë‰∫§Áî±Â∫îÁî®ÂÆûÁé∞ ‚Äã 1„ÄÅgroup by having2„ÄÅcount/sum/avg etc.3„ÄÅorder by Èùûid4„ÄÅ3Âº†Âèä3Âº†‰ª•‰∏äË°®ÂÅöÂµåÂ•ó5„ÄÅleft join/ right join6„ÄÅselect * from7„ÄÅÊó†whereÊù°‰ª∂ÁöÑÊü•ËØ¢ ‰ΩøÁî®Âª∫ËÆÆ order by .. limitËøôÁßçÊü•ËØ¢Êõ¥Â§öÁöÑÊòØÈÄöËøáÁ¥¢ÂºïÂéª‰ºòÂåñÔºå‰ΩÜorder byÁöÑÂ≠óÊÆµÊúâËÆ≤Á©∂ÔºåÊØîÂ¶Ç‰∏ªÈîÆid‰∏égmt_createÈÉΩÊòØÈ°∫Â∫èÈÄíÂ¢ûÔºåÈÇ£Â∞±ÂèØ‰ª•ËÄÉËôëorder by idËÄåÈùû gmt_create „ÄÇ c1 &lt; a order by c2‰∏é‰∏äÈù¢‰∏çÂêåÁöÑÊòØÔºåorder by‰πãÂâçÊúâ‰∏™ËåÉÂõ¥Êü•ËØ¢ÔºåÁî±ÂâçÈù¢ÁöÑÂÜÖÂÆπÂèØÁü•ÔºåÁî®‰∏çÂà∞Á±ª‰ºº(c1,c2)ÁöÑÁ¥¢ÂºïÔºå‰ΩÜÊòØÂèØ‰ª•Âà©Áî®(c2,c1)Á¥¢Âºï„ÄÇÂè¶Â§ñËøòÂèØ‰ª•ÊîπÂÜôÊàêjoinÁöÑÊñπÂºèÂÆûÁé∞„ÄÇ ÂàÜÈ°µ‰ºòÂåñÂª∫ËÆÆ‰ΩøÁî®ÂêàÁêÜÁöÑÂàÜÈ°µÊñπÂºè‰ª•ÊèêÈ´òÂàÜÈ°µÊïàÁéáÔºåÂ§ßÈ°µÊÉÖÂÜµ‰∏ã‰∏ç‰ΩøÁî®Ë∑≥Ë∑ÉÂºèÂàÜÈ°µÂÅáÂ¶ÇÊúâÁ±ª‰ºº‰∏ãÈù¢ÂàÜÈ°µËØ≠Âè•:SELECT FROM table1 ORDER BY ftime DESC LIMIT 10000,10;ËøôÁßçÂàÜÈ°µÊñπÂºè‰ºöÂØºËá¥Â§ßÈáèÁöÑioÔºåÂõ†‰∏∫MySQL‰ΩøÁî®ÁöÑÊòØÊèêÂâçËØªÂèñÁ≠ñÁï•„ÄÇÊé®ËçêÂàÜÈ°µÊñπÂºèÔºöSELECT FROM table1 WHERE ftime &lt; last_time ORDER BY ftime DESC LIMIT 10Âç≥‰º†ÂÖ•‰∏ä‰∏ÄÊ¨°ÂàÜÈ°µÁöÑÁïåÂÄº SELECT * FROM table as t1 inner JOIN (SELECT id FROM table ORDER BY time LIMIT 10000Ôºå10) as t2 ON t1.id=t2.id countËÆ°Êï∞ È¶ñÂÖàcount()„ÄÅcount(1)„ÄÅcount(col1)ÊòØÊúâÂå∫Âà´ÁöÑÔºåcount()Ë°®Á§∫Êï¥‰∏™ÁªìÊûúÈõÜÊúâÂ§öÂ∞ëÊù°ËÆ∞ÂΩïÔºåcount(1)Ë°®Á§∫ÁªìÊûúÈõÜÈáå‰ª•primary keyÁªüËÆ°Êï∞ÈáèÔºåÁªùÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãcount()‰∏écount(1)ÊïàÊûú‰∏ÄÊ†∑ÁöÑÔºå‰ΩÜcount(col1)Ë°®Á§∫ÁöÑÊòØÁªìÊûúÈõÜÈáå col1 Âàó NOT null ÁöÑËÆ∞ÂΩïÊï∞„ÄÇ‰ºòÂÖàÈááÁî®count() Â§ßÊï∞ÊçÆÈáècountÊòØÊ∂àËÄóËµÑÊ∫êÁöÑÊìç‰ΩúÔºåÁîöËá≥‰ºöÊãñÊÖ¢Êï¥‰∏™Â∫ìÔºåÊü•ËØ¢ÊÄßËÉΩÈóÆÈ¢òÊó†Ê≥ïËß£ÂÜ≥ÁöÑÔºåÂ∫î‰ªé‰∫ßÂìÅËÆæËÆ°‰∏äËøõË°åÈáçÊûÑ„ÄÇ‰æãÂ¶ÇÂΩìÈ¢ëÁπÅÈúÄË¶ÅcountÁöÑÊü•ËØ¢ÔºåËÄÉËôë‰ΩøÁî®Ê±áÊÄªË°® ÈÅáÂà∞distinctÁöÑÊÉÖÂÜµÔºågroup byÊñπÂºèÂèØËÉΩÊïàÁéáÊõ¥È´ò„ÄÇ delete,updateËØ≠Âè•ÊîπÊàêselectÂÜçexplain Ê∂âÂèäÂà∞Â§çÊùÇsqlÊó∂ÔºåÂä°ÂøÖÂÖàÂèÇËÄÉÂ∑≤ÊúâÁ¥¢ÂºïËÆæËÆ°ÔºåÂÖàexplain ÁÆÄÂçïSQLÊãÜÂàÜÔºå‰∏ç‰ª•‰ª£Á†ÅÂ§ÑÁêÜÂ§çÊùÇ‰∏∫Áî±„ÄÇ ÊØîÂ¶Ç OR Êù°‰ª∂Ôºö f_phone=‚Äô10000‚Äô or f_mobile=‚Äô10000‚ÄôÔºå‰∏§‰∏™Â≠óÊÆµÂêÑËá™ÊúâÁ¥¢ÂºïÔºåÂèØ‰ª•‰ΩøÁî®Á¥¢ÂºïÂêàÂπ∂‰ΩøÁî®‰∏§‰∏™Á¥¢Âºï„ÄÇ‰∏çËøáÂª∫ËÆÆÊãÜÂàÜÊàê2‰∏™sqlÔºåÊàñËÄÖunion allÔºåÂ¶ÇÊûúÈùûË¶ÅÁî®mysqlÁ¥¢ÂºïÂÆûÁé∞ÔºåÂàôÈúÄË¶ÅÂàõÂª∫‰∏§ÂàóÂçïÂàóÁ¥¢ÂºïÔºåÊâìÂºÄindex_merge_unionÂêé‰ºöËΩ¨‰πâÊàêunion„ÄÇ ÂÖàexplainÁöÑÂ•ΩÂ§ÑÊòØÂèØ‰ª•‰∏∫‰∫ÜÂà©Áî®Á¥¢ÂºïÔºåÂ¢ûÂä†Êõ¥Â§öÊü•ËØ¢ÈôêÂà∂Êù°‰ª∂ ÂáèÂ∞ë‰∏éÊï∞ÊçÆÂ∫ì‰∫§‰∫íÁöÑÊ¨°Êï∞ÔºåÂ∞ΩÈáèÈááÁî®ÊâπÈáèSQLËØ≠Âè• INSERT ... ON DUPLICATE KEY UPDATE ...ÔºåÊèíÂÖ•Ë°åÂêé‰ºöÂØºËá¥Âú®‰∏Ä‰∏™UNIQUEÁ¥¢ÂºïÊàñPRIMARY KEY‰∏≠Âá∫Áé∞ÈáçÂ§çÂÄºÔºåÂàôÊâßË°åÊóßË°åUPDATEÔºåÂ¶ÇÊûú‰∏çÈáçÂ§çÂàôÁõ¥Êé•ÊèíÂÖ•ÔºåÂΩ±Âìç1Ë°å„ÄÇ REPLACE INTOÁ±ª‰ººÔºå‰ΩÜÂÆÉÊòØÂÜ≤Á™ÅÊó∂Âà†Èô§ÊóßË°å„ÄÇINSERT IGNOREÁõ∏ÂèçÔºå‰øùÁïôÊóßË°åÔºå‰∏¢ÂºÉË¶ÅÊèíÂÖ•ÁöÑÊñ∞Ë°å„ÄÇ INSERT INTO VALUES(),(),()ÔºåÂêàÂπ∂ÊèíÂÖ•„ÄÇ ÈöêÂºèÁ±ªÂûã‰ΩøÁî®Ê≥®ÊÑè‰∫ãÈ°π ‰∏§‰∏™ÂèÇÊï∞Ëá≥Â∞ëÊúâ‰∏Ä‰∏™ÊòØ NULL Êó∂ÔºåÊØîËæÉÁöÑÁªìÊûú‰πüÊòØ NULLÔºå‰æãÂ§ñÊòØ‰ΩøÁî® &lt;=&gt; ÂØπ‰∏§‰∏™ NULL ÂÅöÊØîËæÉÊó∂‰ºöËøîÂõû 1ÔºåËøô‰∏§ÁßçÊÉÖÂÜµÈÉΩ‰∏çÈúÄË¶ÅÂÅöÁ±ªÂûãËΩ¨Êç¢ ‰∏§‰∏™ÂèÇÊï∞ÈÉΩÊòØÂ≠óÁ¨¶‰∏≤Ôºå‰ºöÊåâÁÖßÂ≠óÁ¨¶‰∏≤Êù•ÊØîËæÉÔºå‰∏çÂÅöÁ±ªÂûãËΩ¨Êç¢ ‰∏§‰∏™ÂèÇÊï∞ÈÉΩÊòØÊï¥Êï∞ÔºåÊåâÁÖßÊï¥Êï∞Êù•ÊØîËæÉÔºå‰∏çÂÅöÁ±ªÂûãËΩ¨Êç¢ ÂçÅÂÖ≠ËøõÂà∂ÁöÑÂÄºÂíåÈùûÊï∞Â≠óÂÅöÊØîËæÉÊó∂Ôºå‰ºöË¢´ÂΩìÂÅö‰∫åËøõÂà∂‰∏≤ Êúâ‰∏Ä‰∏™ÂèÇÊï∞ÊòØ TIMESTAMP Êàñ DATETIMEÔºåÂπ∂‰∏îÂè¶Â§ñ‰∏Ä‰∏™ÂèÇÊï∞ÊòØÂ∏∏ÈáèÔºåÂ∏∏Èáè‰ºöË¢´ËΩ¨Êç¢‰∏∫ timestamp Êúâ‰∏Ä‰∏™ÂèÇÊï∞ÊòØ decimal Á±ªÂûãÔºåÂ¶ÇÊûúÂè¶Â§ñ‰∏Ä‰∏™ÂèÇÊï∞ÊòØ decimal ÊàñËÄÖÊï¥Êï∞Ôºå‰ºöÂ∞ÜÊï¥Êï∞ËΩ¨Êç¢‰∏∫ decimal ÂêéËøõË°åÊØîËæÉÔºåÂ¶ÇÊûúÂè¶Â§ñ‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊµÆÁÇπÊï∞ÔºåÂàô‰ºöÊää decimal ËΩ¨Êç¢‰∏∫ÊµÆÁÇπÊï∞ËøõË°åÊØîËæÉ ÊâÄÊúâÂÖ∂‰ªñÊÉÖÂÜµ‰∏ãÔºå‰∏§‰∏™ÂèÇÊï∞ÈÉΩ‰ºöË¢´ËΩ¨Êç¢‰∏∫ÊµÆÁÇπÊï∞ÂÜçËøõË°åÊØîËæÉ„ÄÇ ‰æãÔºöAÂàó‰∏∫intÁ±ªÂûãÊó∂ÔºåA=‚Äô123‚ÄôÈöêÂºèËΩ¨Êç¢ÂêéÂèØ‰ª•‰ΩøÁî®Á¥¢ÂºïÔºõA‰∏∫charÁ±ªÂûãÊó∂ÔºåA=123ÈöêÂºèËΩ¨Êç¢ÂêéÊó†Ê≥ï‰ΩøÁî®Á¥¢Âºï ‰ªª‰ΩïÊñ∞ÁöÑselect,update,delete‰∏äÁ∫øÔºåÂª∫ËÆÆÈÉΩË¶ÅÂÖàexplainÔºåÁúãÁ¥¢Âºï‰ΩøÁî®ÊÉÖÂÜµÂ∞ΩÈáèÈÅøÂÖçextraÂàóÂá∫Áé∞ÔºöUsing File SortÔºåUsing TemporaryÔºårowsË∂ÖËøá1000ÁöÑË¶ÅË∞®ÊÖé‰∏äÁ∫ø„ÄÇexplainËß£ËØª typeÔºöALL, index, range, ref, eq_ref, const, systemÔºà‰ªéÂ∑¶Âà∞Âè≥ÔºåÊÄßËÉΩ‰ªéÂ∑ÆÂà∞Â•ΩÔºâ possible_keysÔºöÊåáÂá∫MySQLËÉΩ‰ΩøÁî®Âì™‰∏™Á¥¢ÂºïÂú®Ë°®‰∏≠ÊâæÂà∞ËÆ∞ÂΩïÔºåÊü•ËØ¢Ê∂âÂèäÂà∞ÁöÑÂ≠óÊÆµ‰∏äËã•Â≠òÂú®Á¥¢ÂºïÔºåÂàôËØ•Á¥¢ÂºïÂ∞ÜË¢´ÂàóÂá∫Ôºå‰ΩÜ‰∏ç‰∏ÄÂÆöË¢´Êü•ËØ¢‰ΩøÁî® keyÔºöË°®Á§∫MySQLÂÆûÈôÖÂÜ≥ÂÆö‰ΩøÁî®ÁöÑÈîÆÔºàÁ¥¢ÂºïÔºâÂ¶ÇÊûúÊ≤°ÊúâÈÄâÊã©Á¥¢ÂºïÔºåÈîÆÊòØNULL„ÄÇË¶ÅÊÉ≥Âº∫Âà∂MySQL‰ΩøÁî®ÊàñÂøΩËßÜpossible_keysÂàó‰∏≠ÁöÑÁ¥¢ÂºïÔºåÂú®Êü•ËØ¢‰∏≠‰ΩøÁî®FORCE INDEX„ÄÅUSE INDEXÊàñËÄÖIGNORE INDEX refÔºöË°®Á§∫ÈÄâÊã© key Âàó‰∏äÁöÑÁ¥¢ÂºïÔºåÂì™‰∫õÂàóÊàñÂ∏∏ÈáèË¢´Áî®‰∫éÊü•ÊâæÁ¥¢ÂºïÂàó‰∏äÁöÑÂÄº rowsÔºöÊ†πÊçÆË°®ÁªüËÆ°‰ø°ÊÅØÂèäÁ¥¢ÂºïÈÄâÁî®ÊÉÖÂÜµÔºå‰º∞ÁÆóÁöÑÊâæÂà∞ÊâÄÈúÄÁöÑËÆ∞ÂΩïÊâÄÈúÄË¶ÅËØªÂèñÁöÑË°åÊï∞ Extra``Using temporaryÔºöË°®Á§∫MySQLÈúÄË¶Å‰ΩøÁî®‰∏¥Êó∂Ë°®Êù•Â≠òÂÇ®ÁªìÊûúÈõÜÔºåÂ∏∏ËßÅ‰∫éÊéíÂ∫èÂíåÂàÜÁªÑÊü•ËØ¢Using filesortÔºöMySQL‰∏≠Êó†Ê≥ïÂà©Áî®Á¥¢ÂºïÂÆåÊàêÁöÑÊéíÂ∫èÊìç‰ΩúÁß∞‰∏∫‚ÄúÊñá‰ª∂ÊéíÂ∫è‚Äù Êü•ËØ¢Êù°‰ª∂ÔºàÂåÖÊã¨DML‰∏≠ÁöÑÊù°‰ª∂ÔºâÂèäÊØè‰∏™Êù°‰ª∂Âç†ÊØîÊï∞ÊçÆÈáèÔºö where login_id=1 100%‰∏çÂêåÂÄº ÁÆóÊ≥ïÔºöcount(distinct login_id) / count(1) where user_name=1 and status=1 order by id desc limit 5 80%‰∏çÂêåÂÄºÔºåÁÆóÊ≥ïÔºöcount(distinct user_name,status) / count(1) ÂéüÂàô‰∏äÂ§ß‰∫é20%‰ª•‰∏äÂ∞±Ë¶ÅÂàõÂª∫‰∏ãÁ¥¢Âºï]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[javaËåÉÂûã‰ΩøÁî®Â∞èÁªì]]></title>
    <url>%2F2018%2F03%2F08%2Fjava%E8%8C%83%E5%9E%8B%E9%80%9A%E9%85%8D%E7%AC%A6%2F</url>
    <content type="text"><![CDATA[ËåÉÂûãÈÄöÈÖçÁ¨¶ &lt;? extends Hero&gt; ArrayList heroList&lt;? extends Hero&gt; Ë°®Á§∫Âè™ËÉΩÊîæÂ≠êÁ±ªÊâÄ‰ª• ÂèØ‰ª•Á°ÆÂáøÁöÑÊòØÔºå‰ªéheroListÂèñÂá∫Êù•ÁöÑÂØπË±°Ôºå‰∏ÄÂÆöÊòØÂèØ‰ª•ËΩ¨ÂûãÊàêHeroÁöÑ &lt;? super Hero&gt; ArrayList heroList&lt;? super Hero&gt; Ë°®Á§∫heroListÁöÑÊ≥õÂûãÂèØËÉΩÊòØHeroheroListÁöÑÊ≥õÂûãÂèØËÉΩÊòØObjectÂèØ‰ª•ÂæÄÈáåÈù¢ÊèíÂÖ•Hero‰ª•ÂèäHeroÁöÑÂ≠êÁ±ª‰ΩÜÊòØÂèñÂá∫Êù•ÊúâÈ£éÈô©ÔºåÂõ†‰∏∫‰∏çÁ°ÆÂÆöÂèñÂá∫Êù•ÊòØHeroËøòÊòØObject Ê≥õÂûãÈÄöÈÖçÁ¨¶? Ê≥õÂûãÈÄöÈÖçÁ¨¶? ‰ª£Ë°®‰ªªÊÑèÊ≥õÂûãÊó¢ÁÑ∂?‰ª£Ë°®‰ªªÊÑèÊ≥õÂûãÔºåÈÇ£‰πàÊç¢Âè•ËØùËØ¥ÔºåËøô‰∏™ÂÆπÂô®‰ªÄ‰πàÊ≥õÂûãÈÉΩÊúâÂèØËÉΩÊâÄ‰ª•Âè™ËÉΩ‰ª•ObjectÁöÑÂΩ¢ÂºèÂèñÂá∫Êù•Âπ∂‰∏î‰∏çËÉΩÂæÄÈáåÈù¢ÊîæÂØπË±°ÔºåÂõ†‰∏∫‰∏çÁü•ÈÅìÂà∞Â∫ïÊòØ‰∏Ä‰∏™‰ªÄ‰πàÊ≥õÂûãÁöÑÂÆπÂô® ‰∏Ä„ÄÅÊ≥õÂûãÁî±Êù•JavaËØ≠Ë®ÄÁ±ªÂûãÂåÖÊã¨ÂÖ´ÁßçÂü∫Êú¨Á±ªÂûã(byte short int long float double boolean char)ÂíåÂ§çÊùÇÁ±ªÂûãÔºåÂ§çÊùÇÁ±ªÂûãÂåÖÊã¨Á±ªÂíåÊï∞ÁªÑ„ÄÇÊó©ÊúüJavaÁâàÊú¨Ôºà1.4‰πãÂâçÔºâÂ¶ÇÊûúË¶Å‰ª£ÊåáÊüê‰∏™Ê≥õÂåñÁ±ªÂØπË±°ÔºåÂè™ËÉΩ‰ΩøÁî®ObjectÔºåËøôÊ†∑ÂÜôÂá∫Êù•ÁöÑ‰ª£Á†ÅÈúÄË¶ÅÂ¢ûÂä†Âº∫ËΩ¨ÔºåËÄå‰∏îÁº∫Â∞ëÁ±ªÂûãÊ£ÄÊü•Ôºå‰ª£Á†ÅÁº∫Â∞ëÂÅ•Â£ÆÊÄß„ÄÇÂú®1.5‰πãÂêéÔºåJavaÂºïÂÖ•‰∫ÜÊ≥õÂûã(Generic)ÁöÑÊ¶ÇÂøµÔºåÊèê‰æõ‰∫Ü‰∏ÄÂ•óÊäΩË±°ÁöÑÁ±ªÂûãË°®Á§∫ÊñπÊ≥ï„ÄÇÂà©Áî®Ê≥õÂûãÔºåÊàë‰ª¨ÂèØ‰ª•Ôºö1„ÄÅË°®Á§∫Â§ö‰∏™ÂèØÂèòÁ±ªÂûã‰πãÈó¥ÁöÑÁõ∏‰∫íÂÖ≥Á≥ªÔºöHashMapË°®Á§∫Á±ªÂûãT‰∏éSÁöÑÊò†Â∞ÑÔºåHashMapË°®Á§∫TÁöÑÂ≠êÁ±ª‰∏éTÁöÑÊò†Â∞ÑÂÖ≥Á≥ª 2„ÄÅÁªÜÂåñÁ±ªÁöÑËÉΩÂäõÔºöArrayList ÂèØ‰ª•ÂÆπÁ∫≥‰ªª‰ΩïÊåáÂÆöÁ±ªÂûãTÁöÑÊï∞ÊçÆÔºåÂΩìT‰ª£Êåá‰∫∫ÔºåÂàôÊòØ‰∫∫ÁöÑÊúâÂ∫èÂàóË°®ÔºåÂΩìT‰ª£ÊåáÊùØÂ≠êÔºåÂàôÊòØÊùØÂ≠êÁöÑÊúâÂ∫èÂàóË°®ÔºåÊâÄÊúâÂØπË±°‰∏™‰ΩìÂèØ‰ª•ÂÖ±Áî®Áõ∏ÂêåÁöÑÊìç‰ΩúË°å‰∏∫ 3„ÄÅÂ§çÊùÇÁ±ªÂûãË¢´ÁªÜÂàÜÊàêÊõ¥Â§öÁ±ªÂûãÔºöListÂíåListÊòØ‰∏§Áßç‰∏çÂêåÁöÑÁ±ªÂûãÔºåËøôÊÑèÂë≥ÁùÄList listP = new ArrayList()ÊòØ‰∏çÂèØÁºñËØëÁöÑ„ÄÇÂêéÈù¢‰ºöÊèêÂà∞ÔºåËøôÁßçÊ£ÄÊü•Âü∫‰∫éÁºñËØëËÄåÈùûËøêË°åÔºåÊâÄ‰ª•ËØ¥ÊòØ‰∏çÂèØÁºñËØëÂπ∂Èùû‰∏çÂèØËøêË°åÔºåÂõ†‰∏∫ËøêË°åÊó∂ArrayList‰∏ç‰øùÁïôCup‰ø°ÊÅØ„ÄÇÂè¶Â§ñË¶ÅÊ≥®ÊÑèÔºåÂç≥‰ΩøPeopleÁªßÊâøËá™ObjectÔºåList listO = new ArrayList()‰πüÊòØ‰∏çÂèØÁºñËØëÁöÑÔºåÂ∫îÁêÜËß£‰∏∫‰∏§Áßç‰∏çÂêåÁ±ªÂûã„ÄÇÂõ†‰∏∫listOÂèØ‰ª•ÂÆπÁ∫≥‰ªªÊÑèÁ±ªÂûãÔºåËÄåÂÆû‰æãÂåñÁöÑPeopleÂàóË°®Âè™ËÉΩÊé•Êî∂PeopleÂÆû‰æãÔºåËøô‰ºöÁ†¥ÂùèÊï∞ÊçÆÁ±ªÂûãÂÆåÊï¥ÊÄß„ÄÇ 4„ÄÅÁÆÄÂåñ‰ª£Á†ÅÂÆûÁé∞ÔºöÂÅáËÆæÊúâ‰∏Ä‰∏™ÊâßË°åËøáÁ®ãÔºåÂØπ‰∏çÂêåÁ±ªÂûãÁöÑÊï∞ÊçÆÔºåËøõË°åÊüê‰∫õÊµÅÁ®ã‰∏ÄËá¥ÁöÑÂ§ÑÁêÜÔºå‰∏çÂºïÂÖ•Ê≥õÂûãÁöÑÂÆûÁé∞ÊñπÊ≥ï‰∏∫Ôºö[java] view plain copypublic void addToArray(Integer data, Integer array[], int pos) { array[pos] = data;}public void addToArray(Long data, Long array[], int pos) { array[pos] = data;}ËøôÊòØ‰∏ÄÁßçÂÖ∏ÂûãÁöÑÂ§öÊÄÅË°å‰∏∫‚Äî‚ÄîÈáçËΩΩÔºå‰ΩÜÊòØ‰∏çÂ§üÁÆÄÂåñ„ÄÇÂºïÂÖ•Ê≥õÂûãÁöÑÂÜôÊ≥ïÊõ¥‰ºòÈõÖÔºö[java] view plain copypublic void addToArray(T data, T array[], int pos) { array[pos] = data;} ‰∫å„ÄÅÊ≥õÂûãÂÆö‰πâ‰∏é‰ΩøÁî®ÔºàÊ≥õÂûãÁ±ªÂíåÊ≥õÂûãÊñπÊ≥ïÔºâ1„ÄÅÊ≥õÂûãÂèÇÊï∞ÁöÑÂëΩÂêçÈ£éÊ†ºÔºö1ÔºâÂ∞ΩÈáèÁî®ÁÆÄ‰æøÁöÑÂëΩÂêçÊù•ÂëΩÂêçÊ≥õÂûãÔºåËã•Á±ªÂûãÊó†ÁâπÂÆöÊÑè‰πâÔºåÂ∞ΩÈáè‰ΩøÁî®‰∏Ä‰∏™Â≠óÁ¨¶2ÔºâÂ∞ΩÈáè‰ΩøÁî®ÂÖ®Â§ßÂÜôÊù•ÂëΩÂêçÊ≥õÂûãÂΩ¢ÂèÇÔºå‰ª•Ê≠§‰∏éÂÖ∂‰ªñÁ±ªÂûãÂå∫ÂàÜÂºÄ3ÔºâÂçïÂ≠óÊØçÁöÑÊ≥õÂûãÂª∫ËÆÆÁî®TÂëΩÂêçÔºåÂ¶ÇÊûúÊúâÂ§ö‰∏™Ê≥õÂûãÔºåÂèØ‰ª•ÂèñTÂë®Âõ¥ÁöÑÂ§ßÂÜôÂ≠óÊØçÔºåÊ≥®ÊÑèÔºåÂ¶ÇÊûúÊ≥õÂûãÊú¨Ë∫´ÊúâÊÑè‰πâÔºåÂèØ‰ª•‰∏çÈÅµÂÆàËøô‰∏ÄÊù°ÔºåÊØîÂ¶ÇÁºìÂ≠òÁÆ°ÁêÜCacheManagerÔºåËØ•Á±ªË¥üË¥£ÁÆ°ÁêÜÁºìÂ≠òÊü•ËØ¢Êù°‰ª∂‰∏éÊï∞ÊçÆÁöÑÊò†Â∞ÑÔºåÁî®ÂçïÂ≠óÊØçÂ∞±‰∏çÂ§™ÂêàÈÄÇÔºå‰ΩøÁî®Â§öÂ≠óÊØçÊõ¥Â•Ω4ÔºâÂØπ‰∫éÊ≥õÂûãÂáΩÊï∞ÊàñËÄÖÊ≥õÂûãÂÜÖÈÉ®Á±ªÂú®Êüê‰∏™Ê≥õÂûãÁ±ª‰∏≠Âá∫Áé∞ÁöÑÊÉÖÂÜµÔºåÂª∫ËÆÆÊ≥õÂûãÂáΩÊï∞ÂíåÂÜÖÈÉ®Á±ªÁöÑÊ≥õÂûãÂΩ¢ÂèÇÂêçÁß∞‰∏éÂ§ñÂ±ÇÁ±ªÁöÑÊ≥õÂûãÂêçÁß∞‰øùÊåÅ‰∏çÂêåÔºåÂê¶ÂàôÂÆπÊòìÂºïËµ∑Ê∑∑Ê∑Ü„ÄÇÁ±ª‰ººËøôÁßçÔºö[java] view plain copypublic class GenericClass { public void testGenericMethod(T t) { }} ÂÖ∂ÂÆûtestGenericMethodÊñπÊ≥ïÁöÑÂΩ¢ÂèÇ‰∏éÂ§ñÈù¢GenericClassÁöÑÂΩ¢ÂèÇÂÆåÂÖ®Ê≤°ÊúâÂÖ≥Á≥ª„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÊ≥õÂûãÊñπÊ≥ïÁöÑÊ≥õÂûãÊòØ‰ºòÂÖà‰ΩøÁî®ÊñπÊ≥ïÊ≥õÂûãÂÆö‰πâÁöÑ„ÄÇËøôÁßçÊõ¥Â∫îËØ•ÂÜôÊàêÔºö[java] view plain copypublic class GenericClass { public void testGenericMethod(S s) { }} 2„ÄÅÊ≥õÂûãÂ≠òÂú®‰∏§ÁßçÁî®Ê≥ïÔºöÊ≥õÂûãÁ±ªÂíåÊ≥õÂûãÊñπÊ≥ï 1ÔºâÊ≥õÂûãÁ±ªÂÆö‰πâÊ≥õÂûãÁ±ªÊó∂ÔºåÂú®Á±ªÂêçÂêéÂä†&lt;&gt;ÔºåÂ∞ñÊã¨Âè∑ÂÜÖÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Ê≥õÂûãÂèÇÊï∞ÔºåÂπ∂ÊåáÂÆöÊ≥õÂûãÂèÇÊï∞ÁöÑÂèñÂÄºËåÉÂõ¥ÔºåÂ§ö‰∏™ÂèÇÊï∞Áî®ÈÄóÂè∑(,)ÂàÜÂâ≤Ê≥õÂûãÁ±ª‰∏≠ÂÆö‰πâÁöÑÊ≥õÂûãÂÖ®Á±ªÂèØÁî®ÔºàÈùôÊÄÅÊñπÊ≥ï„ÄÅÈùôÊÄÅ‰ª£Á†ÅÂùó„ÄÅÈùôÊÄÅÊàêÂëòÂèòÈáèÈô§Â§ñÔºâÁà∂Á±ªÂÆö‰πâÁöÑÊ≥õÂûãÂèÇÊï∞Â≠êÁ±ªÊó†Ê≥ïÁªßÊâøÔºåÊâÄ‰ª•Â≠êÁ±ªÂæóËá™Â∑±ÂÜô[java] view plain copypublic class GenericClass { T data; void setData(T t) { data = t; } T getData() { return data; }} 2ÔºâÊ≥õÂûãÊñπÊ≥ïÂÆö‰πâÊ≥õÂûãÊñπÊ≥ïÔºåÂú®ÊñπÊ≥ï‰øÆÈ•∞Á¨¶ÂêéÔºåËøîÂõûÂèÇÊï∞ÂâçÂä†‰∏ä&lt;&gt;ÔºåÂ∞ñÊã¨Âè∑ÂÜÖÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Ê≥õÂûãÂèÇÊï∞ÔºåÂπ∂ÊåáÂÆöÊ≥õÂûãÂèÇÊï∞ÂèñÂÄºËåÉÂõ¥ÔºåÂ§ö‰∏™ÂèÇÊï∞Áî®ÈÄóÂè∑(,)ÂàÜÂâ≤Ê≥õÂûãÊñπÊ≥ï‰∏≠ÂÆö‰πâÁöÑÊ≥õÂûã‰ΩúÁî®ÂüüÂú®ÊñπÊ≥ïÂÜÖ[java] view plain copypublic class GenericMethodClass { public T setData(T t, S s) { //do something return t; }} ÂÆö‰πâÊ≥õÂûãÊñπÊ≥ïÔºåÊõ¥Â§öÊòØ‰∏∫‰∫ÜË°®ËææËøîÂõûÂÄºÂíåÊñπÊ≥ïÂΩ¢ÂèÇÈó¥ÁöÑÂÖ≥Á≥ªÔºåÊú¨‰æã‰∏≠ÊñπÊ≥ïÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞TÁªßÊâøAClassÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞SÁªßÊâøTÔºåËøîÂõûÂÄºÊòØÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞„ÄÇÂ¶ÇÊûú‰ªÖ‰ªÖÊòØ‰∏∫‰∫ÜÂÆûÁé∞‰∫ÜÂ§öÊÄÅÔºåÂ∫î‰ºòÂÖà‰ΩøÁî®ÈÄöÈÖçÁ¨¶„ÄÇÁ±ª‰ººÂ¶Ç‰∏ãÔºö[java] view plain copypublic void addList(List&lt;?&gt; list) { //todo} 3„ÄÅÂÆö‰πâ‰∫ÜÂ§ö‰∏™Ê≥õÂûãÁ±ªÂûãÂèÇÊï∞Êó∂Ôºå‰∏ÄÂÆöË¶ÅÂú®‰ΩøÁî®Êó∂ÈÉΩÊåáÂÆöÁ±ªÂûãÔºåÂê¶Âàô‰ºöÁºñËØëÂá∫Èîô„ÄÇ 4„ÄÅÂØπÊ≥õÂûãÁ±ªÁöÑÁ±ªÂûãÂèÇÊï∞ËµãÂÄºÂåÖÂê´‰∏§ÁßçÊñπÊ≥ïÔºö1ÔºâÁ±ªÂèòÈáèÊàñÂÆû‰æãÂåñÔºöList listS;listS = new ArrayList(); 2ÔºâÁªßÊâøpublic class MyList extends ArrayList implements IMyInterface {}SÊòØÂØπArrayListÂÜÖÈÉ®ÂÆö‰πâÁöÑÊ≥õÂûãEÁöÑËµãÂÄº„ÄÇ 5„ÄÅÂØπÊ≥õÂûãÊñπÊ≥ïÁöÑËµãÂÄºÔºö[java] view plain copypublic T testMethod1(T t, List list) {} public T testMethod2(List list1, List list2){} People n = null; List list1 = null;testMethod1(n, list1);//Ê≠§Êó∂Ê≥õÂûãÂèÇÊï∞T‰∏∫People List list2 = null;testMethod2(list1, list2);//ÁºñËØëÊä•Èîô ‰∏â„ÄÅÈÄöÈÖçÁ¨¶1Ôºâ‰∏äËø∞Ê≥õÂûãËµãÂÄºÈÉΩÊòØËµã‰∫àÊ≥õÂûãÂèÇÊï∞Á°ÆÂÆöÂÄºÔºåÊàë‰ª¨ËøòÂèØ‰ª•Ëµã‰∫àÊ≥õÂûãÂèÇÊï∞‰∏çÁ°ÆÂÆöÂÄºÔºå‰πüÂ∞±ÊòØÈÄöÈÖçÁ¨¶?„ÄÇ‰ΩøÁî®ÈÄöÈÖçÁ¨¶?Ë°®Á§∫‰∏Ä‰∏™Êú™Áü•ÁöÑÁ±ªÂûã„ÄÇÁ±ª‰ººÂ¶Ç‰∏ãÔºöList&lt;?&gt; list;Â≠òÊîæ‰ªªÊÑèÁöÑÂØπË±°List&lt;? extends AClass&gt; listSubAClass; //Â≠òÊîæAClassÁöÑÂ≠êÁ±ªList&lt;? extends BClass&gt; listSuperBClass; //Â≠òÊîæBClassÁöÑÁà∂Á±ª 2ÔºâÈÄöÈÖçÁ¨¶ÈÄöÂ∏∏‰∏éÊ≥õÂûãÂÖ≥ÈîÆÂ≠ó‰∏ÄËµ∑‰ΩøÁî®„ÄÇ 3ÔºâÂú®JavaÈõÜÂêàÊ°ÜÊû∂‰∏≠ÔºåÂØπ‰∫éÊú™Áü•Á±ªÂûãÁöÑÂÆπÂô®Á±ªÔºåÂè™ËÉΩËØªÂèñÂÖ∂‰∏≠ÂÖÉÁ¥†Ôºå‰∏çËÉΩÊ∑ªÂä†ÂÖÉÁ¥†„ÄÇËøôÊòØÂõ†‰∏∫ÔºåÂØπ‰∏çÁ°ÆÂÆöÁöÑÂèÇÊï∞Á±ªÂûãÔºåÁºñËØëÂô®Êó†Ê≥ïËØÜÂà´Ê∑ªÂä†ÂÖÉÁ¥†ÁöÑÁ±ªÂûãÂíåÂÆπÂô®ÁöÑÁ±ªÂûãÊòØÂê¶ÂÖºÂÆπÔºåÂîØ‰∏ÄÁöÑ‰æãÂ§ñÊòØNULL„ÄÇÂêåÊó∂ÔºåÂÖ∂ËØªÂèñÁöÑÂÖÉÁ¥†Âè™ËÉΩÁî®ObjectÊù•Â≠òÂÇ®„ÄÇ 4ÔºâÈÄöÈÖçÁ¨¶‰∏çËÉΩÁî®Âú®Ê≥õÂûãÁ±ªÂíåÊ≥õÂûãÊñπÊ≥ïÂ£∞Êòé‰∏≠ÔºåÁ±ª‰ººÂ¶Ç‰∏ãÔºö[java] view plain copypublic class GenericClass&lt;?&gt; { //ÁºñËØëÈîôËØØ public &lt;?&gt; void testGenericMethod(? t) { //ÁºñËØëÈîôËØØ }} Âõõ„ÄÅÊ≥õÂûãÂÖ≥ÈîÆÂ≠ó1„ÄÅÊ≥õÂûãÂÖ≥ÈîÆÂ≠óÊúâ‰∫å‰∏™ extendsÂíåsuperÔºåÂàÜÂà´Ë°®Á§∫Á±ªÂûã‰∏äÁïåÂíåÁ±ªÂûã‰∏ãÁïåT extends AClass Ë°®Á§∫TÁªßÊâøËá™AClassÁ±ª? super AClass Ë°®Á§∫?ÊòØAClassÁöÑÁà∂Á±ªÔºåÊ≥®ÊÑèÔºösuperÂè™ËÉΩ‰∏éÈÄöÈÖçÁ¨¶?Êê≠ÈÖç‰ΩøÁî®ÔºåÊàë‰ª¨‰∏çËÉΩÂÜôÔºöpublic class GenericClass { //ÈîôËØØ}Ê≠§‰æãÂ≠ê‰∏≠superÊç¢ÊàêextendsÊòØÊ≠£Á°ÆÁöÑÔºåË°®Á§∫Ê≥õÂûãTÁªßÊâøËá™AClassÔºåTÊç¢ÊàêÈÄöÈÖçÁ¨¶?‰πüÊòØÂèØ‰ª•ÁöÑÔºåË°®Á§∫Êú™Áü•Á±ªÂûãÁöÑ‰∏ãÁïåÊòØAClass„ÄÇ 2„ÄÅÈÄöÈÖçÁ¨¶‰∏éÊ≥õÂûãÂÖ≥ÈîÆÂ≠óÁªÑÂêà‰ΩøÁî® ‰∏æ‰∏§‰∏™‰æãÂ≠êÔºö‰∏ãÁïåÔºö[java] view plain copyList&lt;? super People&gt; list = new ArrayList&lt;&gt;();People people = new People();list.add(people);People data= list.get(0 ); //ÁºñËØëÂá∫ÈîôÔºåÊä•ÈîôObject‰∏çËÉΩËΩ¨‰∏∫People ‰∏äÁïåÔºö[java] view plain copyList&lt;? extends People&gt; list = new ArrayList&lt;&gt;();People people = new People();list.add(people);// ÁºñËØëÂá∫ÈîôÔºå‰∏çËÉΩÂêëÂÆπÂô®‰∏≠Ê∑ªÂä†Á°ÆÂÆöÁöÑÂÖÉÁ¥†People data= list.get( 0); ÊÄªÁªìÂ∞±ÊòØÔºö‰∏äÁïåÊ∑ªÂä†(add)ÂèóÈôêÔºå‰∏ãÁïåÊü•ËØ¢(get)ÂèóÈôê ‰∫î„ÄÅÊ≥õÂûãÂÆûÁé∞ÂéüÁêÜ1„ÄÅJavaÊ≥õÂûãÊòØÁºñËØëÊó∂ÊäÄÊúØÔºåÂú®ËøêË°åÊó∂‰∏çÂåÖÂê´Á±ªÂûã‰ø°ÊÅØÔºå‰ªÖÂÖ∂ÂÆû‰æã‰∏≠ÂåÖÂê´Á±ªÂûãÂèÇÊï∞ÁöÑÂÆö‰πâ‰ø°ÊÅØ„ÄÇ2„ÄÅJavaÂà©Áî®ÁºñËØëÂô®Êì¶Èô§ÔºàerasureÔºåÂâçÁ´ØÂ§ÑÁêÜÔºâÂÆûÁé∞Ê≥õÂûãÔºåÂü∫Êú¨‰∏äÂ∞±ÊòØÊ≥õÂûãÁâàÊú¨Ê∫êÁ†ÅÂà∞ÈùûÊ≥õÂûãÁâàÊú¨Ê∫êÁ†ÅÁöÑËΩ¨Âåñ„ÄÇ3„ÄÅÊì¶Èô§ÂéªÊéâ‰∫ÜÊâÄÊúâÁöÑÊ≥õÂûãÁ±ªÂÜÖÊâÄÊúâÁöÑÊ≥õÂûãÁ±ªÂûã‰ø°ÊÅØÔºåÊâÄÊúâÂú®Â∞ñÊã¨Âè∑‰πãÈó¥ÁöÑÁ±ªÂûã‰ø°ÊÅØÈÉΩË¢´ÊâîÊéâ.‰∏æ‰æãÊù•ËØ¥ÔºöListÁ±ªÂûãË¢´ËΩ¨Êç¢‰∏∫ListÔºåÊâÄÊúâÂØπÁ±ªÂûãÂèòÈáèStringÁöÑÂºïÁî®Ë¢´ÊõøÊç¢ÊàêÁ±ªÂûãÂèòÈáèÁöÑ‰∏äÈôê(ÈÄöÂ∏∏ÊòØObject)„ÄÇËÄå‰∏îÔºåÊó†ËÆ∫‰ΩïÊó∂ÁªìÊûú‰ª£Á†ÅÁ±ªÂûã‰∏çÊ≠£Á°ÆÔºå‰ºöÊèíÂÖ•‰∏Ä‰∏™Âà∞ÂêàÈÄÇÁ±ªÂûãÁöÑËΩ¨Êç¢„ÄÇ[java] view plain copy T badCast(T t, Object o) {return (T) o; // unchecked warning}ËøôËØ¥ÊòéStringÁ±ªÂûãÂèÇÊï∞Âú®ListËøêË°åÊó∂Âπ∂‰∏çÂ≠òÂú®„ÄÇÂÆÉ‰ª¨‰πüÂ∞±‰∏ç‰ºöÊ∑ªÂä†‰ªª‰ΩïÁöÑÊó∂Èó¥ÊàñËÄÖÁ©∫Èó¥‰∏äÁöÑË¥üÊãÖ„ÄÇ‰ΩÜÂêåÊó∂ÔºåËøô‰πüÊÑèÂë≥ÁùÄ‰Ω†‰∏çËÉΩ‰æùÈù†‰ªñ‰ª¨ËøõË°åÁ±ªÂûãËΩ¨Êç¢„ÄÇ 4„ÄÅ‰∏Ä‰∏™Ê≥õÂûãÁ±ªË¢´ÂÖ∂ÊâÄÊúâË∞ÉÁî®ÂÖ±‰∫´ÂØπ‰∫é‰∏äÊñá‰∏≠ÁöÑGenericClassÔºåÂú®ÁºñËØëÂêéÂÖ∂ÂÜÖÈÉ®ÊòØ‰∏çÂ≠òÂÖ•Ê≥õÂûã‰ø°ÊÅØÁöÑÔºå‰πüÂ∞±ÊòØËØ¥Ôºö[java] view plain copyGenericClass gclassA = new GenericClass();GenericClass gclassB = new GenericClass();gClassA.getClass() == gClassB.getClass()Ëøô‰∏™Âà§Êñ≠ËøîÂõûÁöÑÂÄºÊòØtrueÔºåËÄåÈùûfalseÔºåÂõ†‰∏∫‰∏Ä‰∏™Ê≥õÂûãÁ±ªÊâÄÊúâÂÆû‰æãËøêË°åÊó∂ÂÖ∑ÊúâÁõ∏ÂêåÁöÑËøêË°åÊó∂Á±ªÔºåÂÖ∂ÂÆûÈôÖÁ±ªÂûãÂèÇÊï∞Ë¢´Êì¶Èô§‰∫Ü„ÄÇ ÈÇ£‰πàÊòØ‰∏çÊòØGenericClassÈáåÂÆåÂÖ®‰∏çÂ≠òAClassÁöÑ‰ø°ÊÅØÂë¢ÔºüËøô‰∏™‰πü‰∏çÊòØÔºåÂÆÉÂÜÖÈÉ®Â≠òÂÇ®ÁöÑÊòØÊ≥õÂûãÂêë‰∏äÁà∂Á±ªÁöÑÂºïÁî®ÔºåÊØîÂ¶ÇÔºöGenericClass, ÂÖ∂ÁºñËØëÂêéÂÜÖÈÉ®Â≠òÂÇ®ÁöÑÊ≥õÂûãÊõø‰ª£ÊòØCharsequenceÔºåËÄå‰∏çÊòØObject„ÄÇ ÈÇ£‰πàÊàë‰ª¨ÁºñÁ†ÅÊó∂ÁöÑÊ≥õÂûãÁöÑÁ±ªÂûãÂà§Êñ≠ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑÂë¢ÔºüÂÖ∂ÂÆûËøô‰∏™ËøáÁ®ãÊòØÁºñËØëÊó∂Ê£ÄÊü•ÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÈôêÂà∂gClassA.add(new BClass()) ËøôÊ†∑ÁöÑ‰ΩøÁî®ÁöÑÊñπÂºèÁöÑ‰∏ª‰ΩìÔºå‰∏çÊòØËøêË°åÊó∂‰ª£Á†ÅÔºåËÄåÊòØÁºñËØëÊó∂ÁõëÊµã„ÄÇ Ê≥õÂûãÁöÑÊÑè‰πâÂ∞±Âú®‰∫éÔºåÂØπÊâÄÊúâÂÖ∂ÊîØÊåÅÁöÑÁ±ªÂûãÂèÇÊï∞ÔºåÊúâÁõ∏ÂêåÁöÑË°å‰∏∫Ôºå‰ªéËÄåÂèØ‰ª•Ë¢´ÂΩì‰Ωú‰∏çÂêåÁ±ªÂûã‰ΩøÁî®ÔºõÁ±ªÁöÑÈùôÊÄÅÂèòÈáèÂíåÊñπÊ≥ïÂú®ÊâÄÊúâÂÆû‰æãÈó¥ÂÖ±‰∫´‰ΩøÁî®ÔºåÊâÄ‰ª•‰∏çËÉΩ‰ΩøÁî®Ê≥õÂûã„ÄÇ 5„ÄÅÊ≥õÂûã‰∏éinstanceofÊ≥õÂûãÊì¶Èô§‰∫ÜÁ±ªÂûã‰ø°ÊÅØÔºåÊâÄ‰ª•‰ΩøÁî®instanceofÊ£ÄÊü•Êüê‰∏™ÂÆû‰æãÊòØÂê¶ÊòØÁâπÂÆöÁ±ªÂûãÁöÑÊ≥õÂûãÁ±ªÊòØ‰∏çÂèØË°åÁöÑÔºöGenericClass genericClass = new GenericClass();if (genericClass instanceof GenericClass) {} // ÁºñËØëÈîôËØØ ÂêåÊó∂ÔºöGenericClass class1 = (GenericClass) genericClassÔºõ //‰ºöÊä•Ë≠¶Âëä ÂÖ≠„ÄÅClass‰∏éÊ≥õÂûãÔºàÊëòËá™ÁΩëÁªúÔºâ‰ªéJava1.5ÂêéClassÁ±ªÂ∞±Êîπ‰∏∫‰∫ÜÊ≥õÂûãÂÆûÁé∞ÔºåClassÁ±ªÂÜÖÂÆö‰πâÁöÑÊ≥õÂûãTÊåáÁöÑÊòØClassÂØπË±°‰ª£Ë°®ÁöÑÁ±ªÂûã„ÄÇÊØîÂ¶ÇËØ¥String.classÁ±ªÂûã‰ª£Ë°®ClassÔºåPeople.classÁ±ªÂûã‰ª£Ë°®Class„ÄÇ‰∏ªË¶ÅÁî®‰∫éÊèêÈ´òÂèçÂ∞Ñ‰ª£Á†ÅÁöÑÁ±ªÂûãÂÆâÂÖ®„ÄÇ ClassÁ±ªÁöÑnewInstanceËøîÂõûÊ≥õÂûãTÁöÑÂØπË±°ÔºåÊïÖËÄåÂèØ‰ª•Âú®ÂèçÂ∞ÑÊó∂ÂàõÂª∫Êõ¥Á≤æÁ°ÆÁöÑÁ±ªÂûã„ÄÇ‰∏æ‰æãÊù•ËØ¥ÔºöÂÅáÂÆö‰Ω†Ë¶ÅÂÜô‰∏Ä‰∏™Â∑•ÂÖ∑ÊñπÊ≥ïÊù•ËøõË°å‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÊü•ËØ¢ÔºåÁªôÂÆö‰∏Ä‰∏™SQLËØ≠Âè•ÔºåÂπ∂ËøîÂõû‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì‰∏≠Á¨¶ÂêàÊü•ËØ¢Êù°‰ª∂ÁöÑÂØπË±°ÈõÜÂêà(collection)„ÄÇ‰∏Ä‰∏™ÊñπÊ≥ïÊòØÊòæÂºèÁöÑ‰º†ÈÄí‰∏Ä‰∏™Â∑•ÂéÇÂØπË±°ÔºåÂÉè‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö[java] view plain copyinterface Factory { public T[] make();}public Collection select(Factory factory, String statement) { Collection result = new ArrayList(); / run sql query using jdbc / for ( int i=0; i&lt;10; i++ ) { / iterate over jdbc results / T item = factory.make(); / use reflection and set all of item‚Äôs fields from sql results / result.add( item ); } return result;} ‰Ω†ÂèØ‰ª•ËøôÊ†∑Ë∞ÉÁî®Ôºö[java] view plain copyselect(new Factory() { public EmpInfo make() { return new EmpInfo(); } } , ‚Äùselection string‚Äù);‰πüÂèØ‰ª•Â£∞Êòé‰∏Ä‰∏™Á±ª EmpInfoFactory Êù•ÊîØÊåÅÊé•Âè£ FactoryÔºö[java] view plain copyclass EmpInfoFactory implements Factory { ‚Ä¶ public EmpInfo make() { return new EmpInfo(); }}ÁÑ∂ÂêéË∞ÉÁî®Ôºö[java] view plain copyselect(getMyEmpInfoFactory(), ‚Äúselection string‚Äù); Ëøô‰∏™Ëß£ÂÜ≥ÊñπÊ°àÁöÑÁº∫ÁÇπÊòØÂÆÉÈúÄË¶Å‰∏ãÈù¢ÁöÑ‰∫åËÄÖ‰πã‰∏ÄÔºöË∞ÉÁî®Â§ÑÈÇ£ÂÜóÈïøÁöÑÂåøÂêçÂ∑•ÂéÇÁ±ªÔºåÊàñ‰∏∫ÊØè‰∏™Ë¶Å‰ΩøÁî®ÁöÑÁ±ªÂûãÂ£∞Êòé‰∏Ä‰∏™Â∑•ÂéÇÁ±ªÂπ∂‰º†ÈÄíÂÖ∂ÂØπË±°ÁªôË∞ÉÁî®ÁöÑÂú∞ÊñπËøôÂæà‰∏çËá™ÁÑ∂„ÄÇ‰ΩøÁî®classÁ±ªÂûãÂèÇÊï∞ÂÄºÊòØÈùûÂ∏∏Ëá™ÁÑ∂ÁöÑÔºåÂÆÉÂèØ‰ª•Ë¢´ÂèçÂ∞Ñ‰ΩøÁî®„ÄÇÊ≤°ÊúâÊ≥õÂûãÁöÑ‰ª£Á†ÅÂèØËÉΩÊòØÔºö[java] view plain copyCollection emps = sqlUtility.select(EmpInfo.class, ‚Äùselect from emps‚Äù);‚Ä¶public static Collection select(Class c, String sqlStatement) { Collection result = new ArrayList(); / run sql query using jdbc / for ( / iterate over jdbc results / ) { Object item = c.newInstance(); / use reflection and set all of item‚Äôs fields from sql results */ result.add(item); } return result; }} ‰ΩÜÊòØËøô‰∏çËÉΩÁªôÊàë‰ª¨ËøîÂõû‰∏Ä‰∏™Êàë‰ª¨Ë¶ÅÁöÑÁ≤æÁ°ÆÁ±ªÂûãÁöÑÈõÜÂêà„ÄÇÁé∞Âú®ClassÊòØÊ≥õÂûãÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•ÂÜôÔºö[java] view plain copyCollection emps=sqlUtility.select(EmpInfo.class, ‚Äùselect from emps‚Äù);‚Ä¶public static Collection select(Classc, String sqlStatement) { Collection result = new ArrayList(); / run sql query using jdbc / for ( / iterate over jdbc results / ) { T item = c.newInstance(); / use reflection and set all of item‚Äôs fields from sql results */ result.add(item); } return result;} Á±çÊ≠§‰ª•Á±ªÂûãÂÆâÂÖ®ÁöÑÊñπÂºèËé∑ÂèñÊàë‰ª¨ÈúÄË¶ÅÁöÑÈõÜÂêà„ÄÇËøôÈ°πÊäÄÊúØÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÊúâÁî®ÁöÑÊäÄÂ∑ßÔºåÂú®Â§ÑÁêÜÊ≥®Èáä(annotations)ÁöÑÊñ∞API‰∏≠Ë¢´ÂπøÊ≥õ‰ΩøÁî®„ÄÇ ‰∏É„ÄÅÂÆπÂô®‰∏éÊ≥õÂûãJavaÊ≥õÂûãÁöÑÊúÄÊ∑±ÂÖ•‰∫∫ÂøÉÁöÑÂ∫îÁî®Â∞±ÊòØÂÆπÂô®ÔºàCollectionsÔºâ‰∫Ü„ÄÇÂÆπÂô®‰∏çÈúÄË¶ÅËÄÉËôëÂÆÉË¶ÅË£Ö‰ªÄ‰πà‰∏úË•øÔºåÂÆÉÁöÑËÅåË¥£Â∞±ÊòØË°®ËææÂÆÉË£ÖÁöÑ‰∏úË•øÁöÑÈõÜÂêàÊâÄÂÖ∑ÊúâÁöÑÂäüËÉΩ„ÄÇÂõ†Ê≠§ÊòØÂ§©ÁÑ∂ÁöÑÊ≥õÂûãÊîØÊåÅËÄÖ„ÄÇÂú®Ê≤°ÊúâÊ≥õÂûãÊó∂ÔºåÂ¶ÇÊûúË¶ÅÂ∞ÅË£Ö‰∏Ä‰∏™ÂàóË°®ÔºåÁÆÄÂåñÂ∫îËØ•ÊòØËøôÊ†∑ÁöÑÔºö[java] view plain copypublic class ArrayList { Object[] array = new Object[10]; int i = 0; public void add(Object object) { array[i++] = object; } public Object get(int index) { return array[index]; } } ËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÊääÂÖÉÁ¥†Â≠òËøõÂéªÔºåÂèñÂá∫Êù•ËøòË¶ÅÂº∫ËΩ¨ÔºåÁ±ªÂûãÂÆâÂÖ®Êó†Ê≥ï‰øùËØÅÔºàÂ≠òÂÖ•‰∏Ä‰∏™IntegerÂÜçÂ≠ò‰∏Ä‰∏™LongÔºåËΩ¨Âá∫Êó∂Âº∫ËΩ¨ÊàêIntegerÂ∞±Â¥©Ê∫É‰∫ÜÔºâ„ÄÇÁî®Ê≥õÂûãÂèØ‰ª•Âú®ÁºñËØëÊó∂‰øùËØÅ‰∏çËÉΩÂ≠òÂÖ•ÈùûÊ≥õÂûãÊîØÊåÅÁöÑÊï∞ÊçÆÔºå‰øùËØÅÁ±ªÂûãÂÆâÂÖ®„ÄÇÊåâÁÖßÊàë‰ª¨‰πãÂâçËØ¥ÁöÑÔºåArrayListÂÜÖ‰∏çÂ≠òÂÇ®Ê≥õÂûã‰ø°ÊÅØÔºåËÄåÊòØÂ≠òÂÇ®Ê≥õÂûãÁöÑÊúÄËøëÁà∂Á±ªÔºåÂØπArrayListËÄåË®ÄÂ∞±ÊòØObjectÔºåÊâÄ‰ª•ÂÖ∂ÂÜÖÈÉ®‰ª£Á†ÅÊòØÔºö[java] view plain copypublic class ArrayList { Object[] array = new Object[10]; int i = 0; public void add(T object) { array[i++] = object; } public T get(int index) { return (T)array[index]; } } ‰øùËØÅÊàë‰ª¨Âä†ËøõÂéªÂíåÂèñÂá∫Êù•ÁöÑÊï∞ÊçÆÈÉΩÊòØÁªèËøáÁ±ªÂûãÊ£ÄÊü•ÁöÑ„ÄÇ ÂÖ´„ÄÅÊÄªÁªì1„ÄÅÊ≥õÂûãÊòØJava‰∏∫Á±ªÂûãÂÆâÂÖ®ËÄåÂÅöÁöÑ‰∏Ä‰∏™‰ºòÂåñÔºåÂÆÉÂú®ÂÜÖÈÉ®‰øùËØÅ‰∫ÜÊï∞ÊçÆÁ±ªÂûã‰∏ÄËá¥ÊÄßÔºåÁªÜÂåñ‰∫ÜÂèØÂèòÂèÇÊï∞ÁöÑÁ±ªÂûãÔºå‰∏îËÉΩÊõ¥Â•ΩÁöÑË°®Á§∫Á±ªÂûãÈó¥ÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ2„ÄÅÊ≥õÂûãÊòØÁºñËØëÊó∂ÊäÄÊúØÔºåÂÖ∂Ëµ∑‰ΩúÁî®ÁöÑÊó∂Êú∫ÊòØÁºñËØëÊó∂ÔºåÂÆåÂñÑÁöÑÁºñËØëÂô®‰ºöÊä•ÂëäÈîôËØØÁöÑÊ≥õÂûã‰ΩøÁî®Ôºå‰øùËØÅ‰ª£Á†Å‰∏çËÉΩÁºñËØëÈÄöËøá„ÄÇ3„ÄÅÂπ≥Â∏∏ÂÜô‰ª£Á†ÅÊó∂ÔºåË¶ÅËÆ§ÁúüÊÄùËÄÉÊòØÂê¶Êúâ‰ΩøÁî®Ê≥õÂûãÁöÑÂøÖË¶Å„ÄÇÈÄöÂ∏∏Êù•ËÆ≤ÔºåÂ¶ÇÊûúÊñπÊ≥ïÊàñÁ±ªÊèèËø∞ÁöÑÊòØÊï∞ÊçÆÁ±ªÂûãÊó†ÂÖ≥ÁöÑÈÄªËæëÔºå‰∏îÂÖ∂Êï∞ÊçÆÁ±ªÂûãÂèØÂèòÊó∂ÔºåÂàôÂ∫îËØ•‰ΩøÁî®Ê≥õÂûã„ÄÇ]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[influxdbÁî®Ê≥ï]]></title>
    <url>%2F2018%2F03%2F07%2Finfluxdb%E7%94%A8%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä influxdbÊòØÁõÆÂâçÊØîËæÉÊµÅË°åÁöÑÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂ∫ì„ÄÇ ‰ΩïË∞ìÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂ∫ìÔºü‰ªÄ‰πàÊòØÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂ∫ìÔºåÊúÄÁÆÄÂçïÁöÑÂÆö‰πâÂ∞±ÊòØÊï∞ÊçÆÊ†ºÂºèÈáåÂåÖÂê´TimestampÂ≠óÊÆµÁöÑÊï∞ÊçÆÔºåÊØîÂ¶ÇÊüê‰∏ÄÊó∂Èó¥ÁéØÂ¢ÉÁöÑÊ∏©Â∫¶ÔºåCPUÁöÑ‰ΩøÁî®ÁéáÁ≠â„ÄÇ‰ΩÜÊòØÔºåÊúâ‰ªÄ‰πàÊï∞ÊçÆ‰∏çÂåÖÂê´TimestampÂë¢ÔºüÂá†‰πéÊâÄÊúâÁöÑÊï∞ÊçÆÂÖ∂ÂÆûÈÉΩÂèØ‰ª•Êâì‰∏ä‰∏Ä‰∏™TimestampÂ≠óÊÆµ„ÄÇÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÁöÑÊõ¥ÈáçË¶ÅÁöÑ‰∏Ä‰∏™Â±ûÊÄßÊòØÂ¶Ç‰ΩïÂéªÊü•ËØ¢ÂÆÉÔºåÂåÖÊã¨Êï∞ÊçÆÁöÑËøáÊª§ÔºåËÆ°ÁÆóÁ≠âÁ≠â„ÄÇ InfluxdbInfluxdbÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºèÊó∂Â∫è„ÄÅÊó∂Èó¥ÂíåÊåáÊ†áÊï∞ÊçÆÂ∫ìÔºå‰ΩøÁî®goËØ≠Ë®ÄÁºñÂÜôÔºåÊó†ÈúÄÂ§ñÈÉ®‰æùËµñ„ÄÇÂÆÉÊúâ‰∏âÂ§ßÁâπÊÄßÔºö Êó∂Â∫èÊÄßÔºàTime SeriesÔºâÔºö‰∏éÊó∂Èó¥Áõ∏ÂÖ≥ÁöÑÂáΩÊï∞ÁöÑÁÅµÊ¥ª‰ΩøÁî®ÔºàËØ∏Â¶ÇÊúÄÂ§ß„ÄÅÊúÄÂ∞è„ÄÅÊ±ÇÂíåÁ≠âÔºâÔºõ Â∫¶ÈáèÔºàMetricsÔºâÔºöÂØπÂÆûÊó∂Â§ßÈáèÊï∞ÊçÆËøõË°åËÆ°ÁÆóÔºõ ‰∫ã‰ª∂ÔºàEventÔºâÔºöÊîØÊåÅ‰ªªÊÑèÁöÑ‰∫ã‰ª∂Êï∞ÊçÆÔºåÊç¢Âè•ËØùËØ¥Ôºå‰ªªÊÑè‰∫ã‰ª∂ÁöÑÊï∞ÊçÆÊàë‰ª¨ÈÉΩÂèØ‰ª•ÂÅöÊìç‰Ωú„ÄÇ ÂêåÊó∂ÔºåÂÆÉÊúâ‰ª•‰∏ãÂá†Â§ßÁâπÁÇπÔºö schemaless(Êó†ÁªìÊûÑ)ÔºåÂèØ‰ª•ÊòØ‰ªªÊÑèÊï∞ÈáèÁöÑÂàóÔºõ min, max, sum, count, mean, median ‰∏ÄÁ≥ªÂàóÂáΩÊï∞ÔºåÊñπ‰æøÁªüËÆ°Ôºõ Native HTTP API, ÂÜÖÁΩÆhttpÊîØÊåÅÔºå‰ΩøÁî®httpËØªÂÜôÔºõ Powerful Query Language Á±ª‰ººsqlÔºõ Built-in Explorer Ëá™Â∏¶ÁÆ°ÁêÜÂ∑•ÂÖ∑„ÄÇ InfluxdbÂÆâË£Ö Ê≥®ÔºöÊú¨Êñá‰ΩøÁî®ÁöÑinfluxdb versionÊòØ1.0.2 Âú®ËÆ≤Ëß£ÂÖ∑‰ΩìÁöÑÂÆâË£ÖÊ≠•È™§‰πãÂâçÔºåÂÖàËØ¥ËØ¥influxdbÁöÑ‰∏§‰∏™httpÁ´ØÂè£Ôºö8083Âíå8086 port 8083ÔºöÁÆ°ÁêÜÈ°µÈù¢Á´ØÂè£ÔºåËÆøÈóÆlocalhost:8083ÂèØ‰ª•ËøõÂÖ•‰Ω†Êú¨Êú∫ÁöÑinfluxdbÁÆ°ÁêÜÈ°µÈù¢Ôºõ port 8086ÔºöhttpËøûÊé•influxdb clientÁ´ØÂè£Ôºå‰∏ÄËà¨‰ΩøÁî®ËØ•Á´ØÂè£ÂæÄÊú¨Êú∫ÁöÑinfluxdbËØªÂÜôÊï∞ÊçÆ„ÄÇ OS X 12brew updatebrew install influxdb Docker Image 1docker pull influxdb Ubuntu &amp; Debian 12wget https://dl.influxdata.com/influxdb/releases/influxdb_1.0.2_amd64.debsudo dpkg -i influxdb_1.0.2_amd64.deb RedHat &amp; CentOS 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2.x86_64.rpmsudo yum localinstall influxdb-1.0.2.x86_64.rpm Standalone Linux Binaries (64-bit) 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2_linux_amd64.tar.gztar xvfz influxdb-1.0.2_linux_amd64.tar.gz Standalone Linux Binaries (32-bit) 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2_linux_i386.tar.gztar xvfz influxdb-1.0.2_linux_i386.tar.gz Standalone Linux Binaries (ARM) 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2_linux_armhf.tar.gztar xvfz influxdb-1.0.2_linux_armhf.tar.gz How to startÔºüÂÆâË£ÖÂÆå‰πãÂêéÔºåÂ¶Ç‰ΩïÂêØÂä®Âë¢Ôºü 1sudo service influxdb start Âà∞ËøôÈáåinfluxdbÂÆâË£ÖÂêØÂä®ÂÆåÊàêÔºåÂèØ‰ª•ËÆøÈóÆinfluxdbÁÆ°ÁêÜÈ°µÈù¢ÔºöÊú¨Âú∞ÁÆ°ÁêÜÈ°µÈù¢ÔºåËØ•ÁâàÊú¨Ê≤°ÊúâÁôªÂΩïÁî®Êà∑ÂèäÂØÜÁ†ÅÔºåÂèØ‰ª•Ëá™Ë°åËÆæÁΩÆËØªÂÜôÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å„ÄÇ Â¶Ç‰ΩïÂú®ÂëΩ‰ª§Ë°å‰ΩøÁî®ÂÆâË£ÖÂÆåÊØï‰πãÂêéÔºåÂ¶Ç‰ΩïÂú®ÂëΩ‰ª§Ë°å‰ΩøÁî®Âë¢Ôºü influxdbÂú®ÂëΩ‰ª§Ë°å‰∏≠‰ΩøÁî® influxdbÂü∫Êú¨Êìç‰Ωú ÂêçËØçËß£ÈáäÂú®ÂÖ∑‰ΩìÁöÑËÆ≤Ëß£influxdbÁöÑÁõ∏ÂÖ≥Êìç‰Ωú‰πãÂâçÂÖàËØ¥ËØ¥influxdbÁöÑ‰∏Ä‰∫õ‰∏ìÊúâÂêçËØçÔºåËøô‰∫õÂêçËØç‰ª£Ë°®‰ªÄ‰πà„ÄÇ influxdbÁõ∏ÂÖ≥ÂêçËØç databaseÔºöÊï∞ÊçÆÂ∫ìÔºõ measurementÔºöÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑË°®Ôºõ pointsÔºöË°®ÈáåÈù¢ÁöÑ‰∏ÄË°åÊï∞ÊçÆ„ÄÇ influxDB‰∏≠Áã¨ÊúâÁöÑ‰∏Ä‰∫õÊ¶ÇÂøµPointÁî±Êó∂Èó¥Êà≥ÔºàtimeÔºâ„ÄÅÊï∞ÊçÆÔºàfieldÔºâÂíåÊ†áÁ≠æÔºàtagsÔºâÁªÑÊàê„ÄÇ timeÔºöÊØèÊù°Êï∞ÊçÆËÆ∞ÂΩïÁöÑÊó∂Èó¥Ôºå‰πüÊòØÊï∞ÊçÆÂ∫ìËá™Âä®ÁîüÊàêÁöÑ‰∏ªÁ¥¢ÂºïÔºõ fieldsÔºöÂêÑÁßçËÆ∞ÂΩïÁöÑÂÄºÔºõ tagsÔºöÂêÑÁßçÊúâÁ¥¢ÂºïÁöÑÂ±ûÊÄß„ÄÇ ËøòÊúâ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÂêçËØçÔºöseriesÊâÄÊúâÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÔºåÈÉΩÈúÄË¶ÅÈÄöËøáÂõæË°®Êù•Ë°®Á§∫ÔºåseriesË°®Á§∫Ëøô‰∏™Ë°®ÈáåÈù¢ÁöÑÊâÄÊúâÁöÑÊï∞ÊçÆÂèØ‰ª•Âú®ÂõæÊ†á‰∏äÁîªÊàêÂá†Êù°Á∫øÔºàÊ≥®ÔºöÁ∫øÊù°ÁöÑ‰∏™Êï∞Áî±tagsÊéíÂàóÁªÑÂêàËÆ°ÁÆóÂá∫Êù•Ôºâ‰∏æ‰∏™ÁÆÄÂçïÁöÑÂ∞èÊ†óÂ≠êÔºöÊúâÂ¶Ç‰∏ãÊï∞ÊçÆÔºö error_time ÂÆÉÁöÑseries‰∏∫Ôºö error_time_series influxdbÂü∫Êú¨Êìç‰Ωú Êï∞ÊçÆÂ∫ì‰∏éË°®ÁöÑÊìç‰ΩúÂèØ‰ª•Áõ¥Êé•Âú®webÁÆ°ÁêÜÈ°µÈù¢ÂÅöÊìç‰ΩúÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ÂëΩ‰ª§Ë°å„ÄÇ 1234567891011121314#ÂàõÂª∫Êï∞ÊçÆÂ∫ìcreate database "db_name"#ÊòæÁ§∫ÊâÄÊúâÁöÑÊï∞ÊçÆÂ∫ìshow databases#Âà†Èô§Êï∞ÊçÆÂ∫ìdrop database "db_name"#‰ΩøÁî®Êï∞ÊçÆÂ∫ìuse db_name#ÊòæÁ§∫ËØ•Êï∞ÊçÆÂ∫ì‰∏≠ÊâÄÊúâÁöÑË°®show measurements#ÂàõÂª∫Ë°®ÔºåÁõ¥Êé•Âú®ÊèíÂÖ•Êï∞ÊçÆÁöÑÊó∂ÂÄôÊåáÂÆöË°®Âêçinsert test,host=127.0.0.1,monitor_name=test count=1#Âà†Èô§Ë°®drop measurement "measurement_name" Â¢û ‚Äã ÂêëÊï∞ÊçÆÂ∫ì‰∏≠ÊèíÂÖ•Êï∞ÊçÆ„ÄÇ ÈÄöËøáÂëΩ‰ª§Ë°å 12use testDbinsert test,host=127.0.0.1,monitor_name=test count=1 ÈÄöËøáhttpÊé•Âè£ 1curl -i -XPOST 'http://127.0.0.1:8086/write?db=testDb' --data-binary 'test,host=127.0.0.1,monitor_name=test count=1' ËØªËÄÖÁúãÂà∞ËøôÈáåÂèØËÉΩ‰ºöËßÇÂØüÂà∞ÊèíÂÖ•ÁöÑÊï∞ÊçÆÁöÑÊ†ºÂºèË≤å‰ººÊØîËæÉÂ•áÊÄ™ÔºåËøôÊòØÂõ†‰∏∫influxDBÂ≠òÂÇ®Êï∞ÊçÆÈááÁî®ÁöÑÊòØLine ProtocolÊ†ºÂºè„ÄÇÈÇ£‰πà‰ΩïË∞ìLine ProtocoÊ†ºÂºèÔºü Line ProtocolÊ†ºÂºèÔºöÂÜôÂÖ•Êï∞ÊçÆÂ∫ìÁöÑPointÁöÑÂõ∫ÂÆöÊ†ºÂºè„ÄÇÂú®‰∏äÈù¢ÁöÑ‰∏§ÁßçÊèíÂÖ•Êï∞ÊçÆÁöÑÊñπÊ≥ï‰∏≠ÈÉΩÊúâËøôÊ†∑ÁöÑ‰∏ÄÈÉ®ÂàÜÔºö 1test,host=127.0.0.1,monitor_name=test count=1 ÂÖ∂‰∏≠Ôºö testÔºöË°®ÂêçÔºõ host=127.0.0.1,monitor_name=testÔºötagÔºõ count=1Ôºöfield ÊÉ≥ÂØπÊ≠§Ê†ºÂºèÊúâËØ¶ÁªÜÁöÑ‰∫ÜËß£ÂèÇËßÅÂÆòÊñπÊñáÊ°£ Êü• ‚Äã Êü•ËØ¢Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇ ÈÄöËøáÂëΩ‰ª§Ë°å 1select * from test order by time desc ÈÄöËøáhttpÊé•Âè£ 1curl -G 'http://localhost:8086/query?pretty=true' --data-urlencode "db=testDb" --data-urlencode "q=select * from test order by time desc" influxDBÊòØÊîØÊåÅÁ±ªsqlËØ≠Âè•ÁöÑÔºåÂÖ∑‰ΩìÁöÑÊü•ËØ¢ËØ≠Ê≥ïÈÉΩÂ∑Æ‰∏çÂ§öÔºåËøôÈáåÂ∞±‰∏çÂÜçÂÅöËØ¶ÁªÜÁöÑËµòËø∞‰∫Ü„ÄÇ Êï∞ÊçÆ‰øùÂ≠òÁ≠ñÁï•ÔºàRetention PoliciesÔºâinfluxDBÊòØÊ≤°ÊúâÊèê‰æõÁõ¥Êé•Âà†Èô§Êï∞ÊçÆËÆ∞ÂΩïÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÊèê‰æõÊï∞ÊçÆ‰øùÂ≠òÁ≠ñÁï•Ôºå‰∏ªË¶ÅÁî®‰∫éÊåáÂÆöÊï∞ÊçÆ‰øùÁïôÊó∂Èó¥ÔºåË∂ÖËøáÊåáÂÆöÊó∂Èó¥ÔºåÂ∞±Âà†Èô§ËøôÈÉ®ÂàÜÊï∞ÊçÆ„ÄÇ Êü•ÁúãÂΩìÂâçÊï∞ÊçÆÂ∫ìRetention Policies 1show retention policies on "db_name" retention_policies ÂàõÂª∫Êñ∞ÁöÑRetention Policies 1create retention policy "rp_name" on "db_name" duration 3w replication 1 default 12345- rp_nameÔºöÁ≠ñÁï•ÂêçÔºõ- db_nameÔºöÂÖ∑‰ΩìÁöÑÊï∞ÊçÆÂ∫ìÂêçÔºõ- 3wÔºö‰øùÂ≠ò3Âë®Ôºå3Âë®‰πãÂâçÁöÑÊï∞ÊçÆÂ∞ÜË¢´Âà†Èô§ÔºåinfluxdbÂÖ∑ÊúâÂêÑÁßç‰∫ã‰ª∂ÂèÇÊï∞ÔºåÊØîÂ¶ÇÔºöhÔºàÂ∞èÊó∂ÔºâÔºådÔºàÂ§©ÔºâÔºåwÔºàÊòüÊúüÔºâÔºõ- replication 1ÔºöÂâØÊú¨‰∏™Êï∞Ôºå‰∏ÄËà¨‰∏∫1Â∞±ÂèØ‰ª•‰∫ÜÔºõ- defaultÔºöËÆæÁΩÆ‰∏∫ÈªòËÆ§Á≠ñÁï• ‰øÆÊîπRetention Policies 1alter retention policy "rp_name" on "db_name" duration 30d default Âà†Èô§Retention Policies 1drop retention policy "rp_name" ËøûÁª≠Êü•ËØ¢ÔºàContinous QueriesÔºâ ‚Äã ÂΩìÊï∞ÊçÆË∂ÖËøá‰øùÂ≠òÁ≠ñÁï•ÈáåÊåáÂÆöÁöÑÊó∂Èó¥‰πãÂêéÂ∞±‰ºöË¢´Âà†Èô§Ôºå‰ΩÜÊòØËøôÊó∂ÂÄôÂèØËÉΩÂπ∂‰∏çÊÉ≥Êï∞ÊçÆË¢´ÂÆåÂÖ®Âà†ÊéâÔºåÊÄé‰πàÂäûÔºü ‚Äã influxdbÊèê‰æõ‰∫ÜËÅîÁ≥ªÊü•ËØ¢ÔºåÂèØ‰ª•ÂÅöÊï∞ÊçÆÁªüËÆ°ÈááÊ†∑„ÄÇ Êü•ÁúãÊï∞ÊçÆÂ∫ìÁöÑContinous Queries 1show continuous queries continuous_queries. ÂàõÂª∫Êñ∞ÁöÑContinous Queries 1create continous query cq_name on db_name begin select sum(count) into new_table_name from table_name group by time(30m) end 123456- cq_nameÔºöËøûÁª≠Êü•ËØ¢ÂêçÂ≠óÔºõ- db_nameÔºöÊï∞ÊçÆÂ∫ìÂêçÂ≠óÔºõ- sum(count)ÔºöËÆ°ÁÆóÊÄªÂíåÔºõ- table_nameÔºöÂΩìÂâçË°®ÂêçÔºõ- new_table_nameÔºöÂ≠òÊñ∞ÁöÑÊï∞ÊçÆÁöÑË°®ÂêçÔºõ- 30mÔºöÊó∂Èó¥Èó¥Èöî‰∏∫30ÂàÜÈíü Âà†Èô§Continous Queries 1drop continous query cp_name on db_name Áî®Êà∑ÁÆ°ÁêÜÂèØ‰ª•Áõ¥Êé•Âú®webÁÆ°ÁêÜÈ°µÈù¢ÂÅöÊìç‰ΩúÔºå‰πüÂèØ‰ª•ÂëΩ‰ª§Ë°å„ÄÇ 1234567#ÊòæÁ§∫Áî®Êà∑show users#ÂàõÂª∫Áî®Êà∑create user "username" with password 'password'#ÂàõÂª∫ÁÆ°ÁêÜÂëòÊùÉÈôêÁî®Êà∑create user "username" with password 'password' with all privileges#Âà†Èô§Áî®Êà∑drop user "username"]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>influxdb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaÂÜÖÂ≠òÊ®°ÂûãFAQ]]></title>
    <url>%2F2018%2F03%2F06%2FJava%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[‰ªÄ‰πàÊòØÂÜÖÂ≠òÊ®°Âûãhttp://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html Âú®Â§öÊ†∏Á≥ªÁªü‰∏≠ÔºåÂ§ÑÁêÜÂô®‰∏ÄËà¨Êúâ‰∏ÄÂ±ÇÊàñËÄÖÂ§öÂ±ÇÁöÑÁºìÂ≠òÔºåËøô‰∫õÁöÑÁºìÂ≠òÈÄöËøáÂä†ÈÄüÊï∞ÊçÆËÆøÈóÆÔºàÂõ†‰∏∫Êï∞ÊçÆË∑ùÁ¶ªÂ§ÑÁêÜÂô®Êõ¥ËøëÔºâÂíåÈôç‰ΩéÂÖ±‰∫´ÂÜÖÂ≠òÂú®ÊÄªÁ∫ø‰∏äÁöÑÈÄöËÆØÔºàÂõ†‰∏∫Êú¨Âú∞ÁºìÂ≠òËÉΩÂ§üÊª°Ë∂≥ËÆ∏Â§öÂÜÖÂ≠òÊìç‰ΩúÔºâÊù•ÊèêÈ´òCPUÊÄßËÉΩ„ÄÇÁºìÂ≠òËÉΩÂ§üÂ§ßÂ§ßÊèêÂçáÊÄßËÉΩÔºå‰ΩÜÊòØÂÆÉ‰ª¨‰πüÂ∏¶Êù•‰∫ÜËÆ∏Â§öÊåëÊàò„ÄÇ‰æãÂ¶ÇÔºåÂΩì‰∏§‰∏™CPUÂêåÊó∂Ê£ÄÊü•Áõ∏ÂêåÁöÑÂÜÖÂ≠òÂú∞ÂùÄÊó∂‰ºöÂèëÁîü‰ªÄ‰πàÔºüÂú®‰ªÄ‰πàÊ†∑ÁöÑÊù°‰ª∂‰∏ãÂÆÉ‰ª¨‰ºöÁúãÂà∞Áõ∏ÂêåÁöÑÂÄºÔºü Âú®Â§ÑÁêÜÂô®Â±ÇÈù¢‰∏äÔºåÂÜÖÂ≠òÊ®°ÂûãÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂÖÖË¶ÅÊù°‰ª∂Ôºå‚ÄúËÆ©ÂΩìÂâçÁöÑÂ§ÑÁêÜÂô®ÂèØ‰ª•ÁúãÂà∞ÂÖ∂‰ªñÂ§ÑÁêÜÂô®ÂÜôÂÖ•Âà∞ÂÜÖÂ≠òÁöÑÊï∞ÊçÆ‚Äù‰ª•ÂèäÂÖ∂‰ªñÂ§ÑÁêÜÂô®ÂèØ‰ª•ÁúãÂà∞ÂΩìÂâçÂ§ÑÁêÜÂô®ÂÜôÂÖ•Âà∞ÂÜÖÂ≠òÁöÑÊï∞ÊçÆ‚Äù„ÄÇÊúâ‰∫õÂ§ÑÁêÜÂô®ÊúâÂæàÂº∫ÁöÑÂÜÖÂ≠òÊ®°Âûã(strong memory model)ÔºåËÉΩÂ§üËÆ©ÊâÄÊúâÁöÑÂ§ÑÁêÜÂô®Âú®‰ªª‰ΩïÊó∂ÂÄô‰ªª‰ΩïÊåáÂÆöÁöÑÂÜÖÂ≠òÂú∞ÂùÄ‰∏äÈÉΩÂèØ‰ª•ÁúãÂà∞ÂÆåÂÖ®Áõ∏ÂêåÁöÑÂÄº„ÄÇËÄåÂè¶Â§ñ‰∏Ä‰∫õÂ§ÑÁêÜÂô®ÂàôÊúâËæÉÂº±ÁöÑÂÜÖÂ≠òÊ®°ÂûãÔºàweaker memory modelÔºâÔºåÂú®ËøôÁßçÂ§ÑÁêÜÂô®‰∏≠ÔºåÂøÖÈ°ª‰ΩøÁî®ÂÜÖÂ≠òÂ±èÈöúÔºà‰∏ÄÁßçÁâπÊÆäÁöÑÊåá‰ª§ÔºâÊù•Âà∑Êñ∞Êú¨Âú∞Â§ÑÁêÜÂô®ÁºìÂ≠òÂπ∂‰ΩøÊú¨Âú∞Â§ÑÁêÜÂô®ÁºìÂ≠òÊó†ÊïàÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜËÆ©ÂΩìÂâçÂ§ÑÁêÜÂô®ËÉΩÂ§üÁúãÂà∞ÂÖ∂‰ªñÂ§ÑÁêÜÂô®ÁöÑÂÜôÊìç‰ΩúÊàñËÄÖËÆ©ÂÖ∂‰ªñÂ§ÑÁêÜÂô®ËÉΩÁúãÂà∞ÂΩìÂâçÂ§ÑÁêÜÂô®ÁöÑÂÜôÊìç‰Ωú„ÄÇËøô‰∫õÂÜÖÂ≠òÂ±èÈöúÈÄöÂ∏∏Âú®lockÂíåunlockÊìç‰ΩúÁöÑÊó∂ÂÄôÂÆåÊàê„ÄÇÂÜÖÂ≠òÂ±èÈöúÂú®È´òÁ∫ßËØ≠Ë®Ä‰∏≠ÂØπÁ®ãÂ∫èÂëòÊòØ‰∏çÂèØËßÅÁöÑ„ÄÇ Âú®Âº∫ÂÜÖÂ≠òÊ®°Âûã‰∏ãÔºåÊúâÊó∂ÂÄôÁºñÂÜôÁ®ãÂ∫èÂèØËÉΩ‰ºöÊõ¥ÂÆπÊòìÔºåÂõ†‰∏∫ÂáèÂ∞ë‰∫ÜÂØπÂÜÖÂ≠òÂ±èÈöúÁöÑ‰æùËµñ„ÄÇ‰ΩÜÊòØÂç≥‰ΩøÂú®‰∏Ä‰∫õÊúÄÂº∫ÁöÑÂÜÖÂ≠òÊ®°Âûã‰∏ãÔºåÂÜÖÂ≠òÂ±èÈöú‰ªçÁÑ∂ÊòØÂøÖÈ°ªÁöÑ„ÄÇËÆæÁΩÆÂÜÖÂ≠òÂ±èÈöúÂæÄÂæÄ‰∏éÊàë‰ª¨ÁöÑÁõ¥ËßâÂπ∂‰∏ç‰∏ÄËá¥„ÄÇËøëÊù•Â§ÑÁêÜÂô®ËÆæËÆ°ÁöÑË∂ãÂäøÊõ¥ÂÄæÂêë‰∫éÂº±ÁöÑÂÜÖÂ≠òÊ®°ÂûãÔºåÂõ†‰∏∫Âº±ÂÜÖÂ≠òÊ®°ÂûãÂâäÂº±‰∫ÜÁºìÂ≠ò‰∏ÄËá¥ÊÄßÔºåÊâÄ‰ª•Âú®Â§öÂ§ÑÁêÜÂô®Âπ≥Âè∞ÂíåÊõ¥Â§ßÂÆπÈáèÁöÑÂÜÖÂ≠ò‰∏ãÂèØ‰ª•ÂÆûÁé∞Êõ¥Â•ΩÁöÑÂèØ‰º∏Áº©ÊÄß ‚Äú‰∏Ä‰∏™Á∫øÁ®ãÁöÑÂÜôÊìç‰ΩúÂØπÂÖ∂‰ªñÁ∫øÁ®ãÂèØËßÅ‚ÄùËøô‰∏™ÈóÆÈ¢òÊòØÂõ†‰∏∫ÁºñËØëÂô®ÂØπ‰ª£Á†ÅËøõË°åÈáçÊéíÂ∫èÂØºËá¥ÁöÑ„ÄÇ‰æãÂ¶ÇÔºåÂè™Ë¶Å‰ª£Á†ÅÁßªÂä®‰∏ç‰ºöÊîπÂèòÁ®ãÂ∫èÁöÑËØ≠‰πâÔºåÂΩìÁºñËØëÂô®ËÆ§‰∏∫Á®ãÂ∫è‰∏≠ÁßªÂä®‰∏Ä‰∏™ÂÜôÊìç‰ΩúÂà∞ÂêéÈù¢‰ºöÊõ¥ÊúâÊïàÁöÑÊó∂ÂÄôÔºåÁºñËØëÂô®Â∞±‰ºöÂØπ‰ª£Á†ÅËøõË°åÁßªÂä®„ÄÇÂ¶ÇÊûúÁºñËØëÂô®Êé®ËøüÊâßË°å‰∏Ä‰∏™Êìç‰ΩúÔºåÂÖ∂‰ªñÁ∫øÁ®ãÂèØËÉΩÂú®Ëøô‰∏™Êìç‰ΩúÊâßË°åÂÆå‰πãÂâçÈÉΩ‰∏ç‰ºöÁúãÂà∞ËØ•Êìç‰ΩúÁöÑÁªìÊûúÔºåËøôÂèçÊò†‰∫ÜÁºìÂ≠òÁöÑÂΩ±Âìç„ÄÇ Ê≠§Â§ñÔºåÂÜôÂÖ•ÂÜÖÂ≠òÁöÑÊìç‰ΩúËÉΩÂ§üË¢´ÁßªÂä®Âà∞Á®ãÂ∫èÈáåÊõ¥ÂâçÁöÑÊó∂ÂÄô„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂÖ∂‰ªñÁöÑÁ∫øÁ®ãÂú®Á®ãÂ∫è‰∏≠ÂèØËÉΩÁúãÂà∞‰∏Ä‰∏™ÊØîÂÆÉÂÆûÈôÖÂèëÁîüÊõ¥Êó©ÁöÑÂÜôÊìç‰Ωú„ÄÇÊâÄÊúâÁöÑËøô‰∫õÁÅµÊ¥ªÊÄßÁöÑËÆæËÆ°ÊòØ‰∏∫‰∫ÜÈÄöËøáÁªôÁºñËØëÂô®ÔºåËøêË°åÊó∂ÊàñÁ°¨‰ª∂ÁÅµÊ¥ªÊÄß‰ΩøÂÖ∂ËÉΩÂú®ÊúÄ‰Ω≥È°∫Â∫èÁöÑÊÉÖÂÜµ‰∏ãÊù•ÊâßË°åÊìç‰Ωú„ÄÇÂú®ÂÜÖÂ≠òÊ®°ÂûãÁöÑÈôêÂÆö‰πãÂÜÖÔºåÊàë‰ª¨ËÉΩÂ§üËé∑ÂèñÂà∞Êõ¥È´òÁöÑÊÄßËÉΩ„ÄÇ 123456789101112Class Reordering &#123; int x = 0, y = 0; public void writer() &#123; x = 1; y = 2; &#125; public void reader() &#123; int r1 = y; int r2 = x; &#125;&#125; ËÆ©Êàë‰ª¨ÁúãÂú®‰∏§‰∏™Âπ∂ÂèëÁ∫øÁ®ã‰∏≠ÊâßË°åËøôÊÆµ‰ª£Á†ÅÔºåËØªÂèñYÂèòÈáèÂ∞Ü‰ºöÂæóÂà∞2Ëøô‰∏™ÂÄº„ÄÇÂõ†‰∏∫Ëøô‰∏™ÂÜôÂÖ•ÊØîÂÜôÂà∞XÂèòÈáèÊõ¥Êôö‰∏Ä‰∫õÔºåÁ®ãÂ∫èÂëòÂèØËÉΩËÆ§‰∏∫ËØªÂèñXÂèòÈáèÂ∞ÜËÇØÂÆö‰ºöÂæóÂà∞1„ÄÇ‰ΩÜÊòØÔºåÂÜôÂÖ•Êìç‰ΩúÂèØËÉΩË¢´ÈáçÊéíÂ∫èËøá„ÄÇÂ¶ÇÊûúÈáçÊéíÂ∫èÂèëÁîü‰∫ÜÔºåÈÇ£‰πàÔºåÂ∞±ËÉΩÂèëÁîüÂØπYÂèòÈáèÁöÑÂÜôÂÖ•Êìç‰ΩúÔºåËØªÂèñ‰∏§‰∏™ÂèòÈáèÁöÑÊìç‰ΩúÁ¥ßÈöèÂÖ∂ÂêéÔºåËÄå‰∏îÂÜôÂÖ•Âà∞XËøô‰∏™Êìç‰ΩúËÉΩÂèëÁîü„ÄÇÁ®ãÂ∫èÁöÑÁªìÊûúÂèØËÉΩÊòØr1ÂèòÈáèÁöÑÂÄºÊòØ2Ôºå‰ΩÜÊòØr2ÂèòÈáèÁöÑÂÄº‰∏∫0„ÄÇ JavaÂÜÖÂ≠òÊ®°ÂûãÊèèËø∞‰∫ÜÂú®Â§öÁ∫øÁ®ã‰ª£Á†Å‰∏≠Âì™‰∫õË°å‰∏∫ÊòØÂêàÊ≥ïÁöÑÔºå‰ª•ÂèäÁ∫øÁ®ãÂ¶Ç‰ΩïÈÄöËøáÂÜÖÂ≠òËøõË°å‰∫§‰∫í„ÄÇÂÆÉÊèèËø∞‰∫Ü‚ÄúÁ®ãÂ∫è‰∏≠ÁöÑÂèòÈáè‚Äú Âíå ‚Äù‰ªéÂÜÖÂ≠òÊàñËÄÖÂØÑÂ≠òÂô®Ëé∑ÂèñÊàñÂ≠òÂÇ®ÂÆÉ‰ª¨ÁöÑÂ∫ïÂ±ÇÁªÜËäÇ‚Äù‰πãÈó¥ÁöÑÂÖ≥Á≥ª„ÄÇJavaÂÜÖÂ≠òÊ®°ÂûãÈÄöËøá‰ΩøÁî®ÂêÑÁßçÂêÑÊ†∑ÁöÑÁ°¨‰ª∂ÂíåÁºñËØëÂô®ÁöÑ‰ºòÂåñÊù•Ê≠£Á°ÆÂÆûÁé∞‰ª•‰∏ä‰∫ãÊÉÖ„ÄÇ JavaÂåÖÂê´‰∫ÜÂá†‰∏™ËØ≠Ë®ÄÁ∫ßÂà´ÁöÑÂÖ≥ÈîÆÂ≠óÔºåÂåÖÊã¨Ôºövolatile, final‰ª•ÂèäsynchronizedÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂ∏ÆÂä©Á®ãÂ∫èÂëòÂêëÁºñËØëÂô®ÊèèËø∞‰∏Ä‰∏™Á®ãÂ∫èÁöÑÂπ∂ÂèëÈúÄÊ±Ç„ÄÇJavaÂÜÖÂ≠òÊ®°ÂûãÂÆö‰πâ‰∫ÜvolatileÂíåsynchronizedÁöÑË°å‰∏∫ÔºåÊõ¥ÈáçË¶ÅÁöÑÊòØ‰øùËØÅ‰∫ÜÂêåÊ≠•ÁöÑjavaÁ®ãÂ∫èÂú®ÊâÄÊúâÁöÑÂ§ÑÁêÜÂô®Êû∂ÊûÑ‰∏ãÈù¢ÈÉΩËÉΩÊ≠£Á°ÆÁöÑËøêË°å„ÄÇ ÂÖ∂‰ªñËØ≠Ë®ÄÔºåÂÉèC++Ôºå‰πüÊúâÂÜÖÂ≠òÊ®°ÂûãÂêóÂ§ßÈÉ®ÂàÜÂÖ∂‰ªñÁöÑËØ≠Ë®ÄÔºåÂÉèCÂíåC++ÔºåÈÉΩÊ≤°ÊúâË¢´ËÆæËÆ°ÊàêÁõ¥Êé•ÊîØÊåÅÂ§öÁ∫øÁ®ã„ÄÇËøô‰∫õËØ≠Ë®ÄÂØπ‰∫éÂèëÁîüÂú®ÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®Âπ≥Âè∞Êû∂ÊûÑÁöÑÈáçÊéíÂ∫èË°å‰∏∫ÁöÑ‰øùÊä§Êú∫Âà∂‰ºö‰∏•ÈáçÁöÑ‰æùËµñ‰∫éÁ®ãÂ∫è‰∏≠ÊâÄ‰ΩøÁî®ÁöÑÁ∫øÁ®ãÂ∫ìÔºà‰æãÂ¶ÇpthreadsÔºâÔºåÁºñËØëÂô®Ôºå‰ª•Âèä‰ª£Á†ÅÊâÄËøêË°åÁöÑÂπ≥Âè∞ÊâÄÊèê‰æõÁöÑ‰øùÈöú„ÄÇ #JSR133ÊòØ‰ªÄ‰πà ‰ªé1997Âπ¥‰ª•Êù•Ôºå‰∫∫‰ª¨‰∏çÊñ≠ÂèëÁé∞JavaËØ≠Ë®ÄËßÑËåÉÁöÑ17Á´†ÂÆö‰πâÁöÑJavaÂÜÖÂ≠òÊ®°Âûã‰∏≠ÁöÑ‰∏Ä‰∫õ‰∏•ÈáçÁöÑÁº∫Èô∑„ÄÇËøô‰∫õÁº∫Èô∑‰ºöÂØºËá¥‰∏Ä‰∫õ‰Ωø‰∫∫Ëø∑ÊÉëÁöÑË°å‰∏∫Ôºà‰æãÂ¶ÇfinalÂ≠óÊÆµ‰ºöË¢´ËßÇÂØüÂà∞ÂÄºÁöÑÊîπÂèòÔºâÂíåÁ†¥ÂùèÁºñËØëÂô®Â∏∏ËßÅÁöÑ‰ºòÂåñËÉΩÂäõ„ÄÇ JavaÂÜÖÂ≠òÊ®°ÂûãÊòØ‰∏Ä‰∏™ÈõÑÂøÉÂãÉÂãÉÁöÑËÆ°ÂàíÔºåÂÆÉÊòØÁºñÁ®ãËØ≠Ë®ÄËßÑËåÉÁ¨¨‰∏ÄÊ¨°Â∞ùËØïÂêàÂπ∂‰∏Ä‰∏™ËÉΩÂ§üÂú®ÂêÑÁßçÂ§ÑÁêÜÂô®Êû∂ÊûÑ‰∏≠‰∏∫Âπ∂ÂèëÊèê‰æõ‰∏ÄËá¥ËØ≠‰πâÁöÑÂÜÖÂ≠òÊ®°Âûã„ÄÇ‰∏çËøáÔºåÂÆö‰πâ‰∏Ä‰∏™Êó¢‰∏ÄËá¥ÂèàÁõ¥ËßÇÁöÑÂÜÖÂ≠òÊ®°ÂûãËøúÊØîÊÉ≥Ë±°Ë¶ÅÊõ¥Èöæ„ÄÇJSR133‰∏∫JavaËØ≠Ë®ÄÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂÜÖÂ≠òÊ®°ÂûãÔºåÂÆÉ‰øÆÂ§ç‰∫ÜÊó©ÊúüÂÜÖÂ≠òÊ®°Âûã‰∏≠ÁöÑÁº∫Èô∑„ÄÇ‰∏∫‰∫ÜÂÆûÁé∞JSR133ÔºåfinalÂíåvolatileÁöÑËØ≠‰πâÈúÄË¶ÅÈáçÊñ∞ÂÆö‰πâ„ÄÇ ÂÆåÊï¥ÁöÑËØ≠‰πâËßÅÔºöhttp://www.cs.umd.edu/users/pugh/java/memoryModelÔºå‰ΩÜÊòØÊ≠£ÂºèÁöÑËØ≠‰πâ‰∏çÊòØÂ∞èÂøÉÁøºÁøºÁöÑÔºåÂÆÉÊòØ‰ª§‰∫∫ÊÉäËÆ∂ÂíåÊ∏ÖÈÜíÁöÑÔºåÁõÆÁöÑÊòØËÆ©‰∫∫ÊÑèËØÜÂà∞‰∏Ä‰∫õÁúã‰ººÁÆÄÂçïÁöÑÊ¶ÇÂøµÔºàÂ¶ÇÂêåÊ≠•ÔºâÂÖ∂ÂÆûÊúâÂ§öÂ§çÊùÇ„ÄÇÂπ∏ËøêÁöÑÊòØÔºå‰Ω†‰∏çÈúÄË¶ÅÊáÇÂæóËøô‰∫õÊ≠£ÂºèËØ≠‰πâÁöÑÁªÜËäÇ‚Äî‚ÄîJSR133ÁöÑÁõÆÁöÑÊòØÂàõÂª∫‰∏ÄÁªÑÊ≠£ÂºèËØ≠‰πâÔºåËøô‰∫õÊ≠£ÂºèËØ≠‰πâÊèê‰æõ‰∫Üvolatile„ÄÅsynchronziedÂíåfinalÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑÁõ¥ËßÇÊ°ÜÊû∂„ÄÇ JSR 133ÁöÑÁõÆÊ†áÂåÖÂê´‰∫ÜÔºö ‰øùÁïôÂ∑≤ÁªèÂ≠òÂú®ÁöÑÂÆâÂÖ®‰øùËØÅÔºàÂÉèÁ±ªÂûãÂÆâÂÖ®Ôºâ‰ª•ÂèäÂº∫ÂåñÂÖ∂‰ªñÁöÑÂÆâÂÖ®‰øùËØÅ„ÄÇ‰æãÂ¶ÇÔºåÂèòÈáèÂÄº‰∏çËÉΩÂá≠Á©∫ÂàõÂª∫ÔºöÁ∫øÁ®ãËßÇÂØüÂà∞ÁöÑÊØè‰∏™ÂèòÈáèÁöÑÂÄºÂøÖÈ°ªÊòØË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÂêàÁêÜÁöÑËÆæÁΩÆÁöÑ„ÄÇ Ê≠£Á°ÆÂêåÊ≠•ÁöÑÁ®ãÂ∫èÁöÑËØ≠‰πâÂ∫îËØ•Â∞ΩÈáèÁÆÄÂçïÂíåÁõ¥ËßÇ„ÄÇ Â∫îËØ•ÂÆö‰πâÊú™ÂÆåÊàêÊàñËÄÖÊú™Ê≠£Á°ÆÂêåÊ≠•ÁöÑÁ®ãÂ∫èÁöÑËØ≠‰πâÔºå‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÊääÊΩúÂú®ÁöÑÂÆâÂÖ®Âç±ÂÆ≥ÈôçÂà∞ÊúÄ‰Ωé„ÄÇ Á®ãÂ∫èÂëòÂ∫îËØ•ËÉΩÂ§üËá™‰ø°ÁöÑÊé®Êñ≠Â§öÁ∫øÁ®ãÁ®ãÂ∫èÂ¶Ç‰ΩïÂêåÂÜÖÂ≠òËøõË°å‰∫§‰∫íÁöÑ„ÄÇ ËÉΩÂ§üÂú®Áé∞Âú®ËÆ∏Â§öÊµÅË°åÁöÑÁ°¨‰ª∂Êû∂ÊûÑ‰∏≠ËÆæËÆ°Ê≠£Á°Æ‰ª•ÂèäÈ´òÊÄßËÉΩÁöÑJVMÂÆûÁé∞„ÄÇ Â∫îËØ•ËÉΩÊèê‰æõ ÂÆâÂÖ®Âú∞ÂàùÂßãÂåñÁöÑ‰øùËØÅ„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÂØπË±°Ê≠£Á°ÆÁöÑÊûÑÂª∫‰∫ÜÔºàÊÑèÊÄùÊòØÂÆÉÁöÑÂºïÁî®Ê≤°ÊúâÂú®ÊûÑÂª∫ÁöÑÊó∂ÂÄôÈÄ∏Âá∫ÔºåÈÇ£‰πàÊâÄÊúâËÉΩÂ§üÁúãÂà∞Ëøô‰∏™ÂØπË±°ÁöÑÂºïÁî®ÁöÑÁ∫øÁ®ãÔºåÂú®‰∏çËøõË°åÂêåÊ≠•ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰πüÂ∞ÜËÉΩÁúãÂà∞Âú®ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠‰∏≠ËÆæÁΩÆÁöÑfinalÂ≠óÊÆµÁöÑÂÄº„ÄÇ Â∫îËØ•Â∞ΩÈáè‰∏çÂΩ±ÂìçÁé∞ÊúâÁöÑ‰ª£Á†Å ÈáçÊéíÂ∫èÊÑèÂë≥ÁùÄ‰ªÄ‰πàÔºüÂú®ÂæàÂ§öÊÉÖÂÜµ‰∏ãÔºåËÆøÈóÆ‰∏Ä‰∏™Á®ãÂ∫èÂèòÈáèÔºàÂØπË±°ÂÆû‰æãÂ≠óÊÆµÔºåÁ±ªÈùôÊÄÅÂ≠óÊÆµÂíåÊï∞ÁªÑÂÖÉÁ¥†ÔºâÂèØËÉΩ‰ºö‰ΩøÁî®‰∏çÂêåÁöÑÈ°∫Â∫èÊâßË°åÔºåËÄå‰∏çÊòØÁ®ãÂ∫èËØ≠‰πâÊâÄÊåáÂÆöÁöÑÈ°∫Â∫èÊâßË°å„ÄÇÁºñËØëÂô®ËÉΩÂ§üËá™Áî±ÁöÑ‰ª•‰ºòÂåñÁöÑÂêç‰πâÂéªÊîπÂèòÊåá‰ª§È°∫Â∫è„ÄÇÂú®ÁâπÂÆöÁöÑÁéØÂ¢É‰∏ãÔºåÂ§ÑÁêÜÂô®ÂèØËÉΩ‰ºöÊ¨°Â∫èÈ¢†ÂÄíÁöÑÊâßË°åÊåá‰ª§„ÄÇÊï∞ÊçÆÂèØËÉΩÂú®ÂØÑÂ≠òÂô®ÔºåÂ§ÑÁêÜÂô®ÁºìÂÜ≤Âå∫Âíå‰∏ªÂÜÖÂ≠ò‰∏≠‰ª•‰∏çÂêåÁöÑÊ¨°Â∫èÁßªÂä®ÔºåËÄå‰∏çÊòØÊåâÁÖßÁ®ãÂ∫èÊåáÂÆöÁöÑÈ°∫Â∫è„ÄÇ ‰æãÂ¶ÇÔºåÂ¶ÇÊûú‰∏Ä‰∏™Á∫øÁ®ãÂÜôÂÖ•ÂÄºÂà∞Â≠óÊÆµaÔºåÁÑ∂ÂêéÂÜôÂÖ•ÂÄºÂà∞Â≠óÊÆµbÔºåËÄå‰∏îbÁöÑÂÄº‰∏ç‰æùËµñ‰∫éaÁöÑÂÄºÔºåÈÇ£‰πàÔºåÂ§ÑÁêÜÂô®Â∞±ËÉΩÂ§üËá™Áî±ÁöÑË∞ÉÊï¥ÂÆÉ‰ª¨ÁöÑÊâßË°åÈ°∫Â∫èÔºåËÄå‰∏îÁºìÂÜ≤Âå∫ËÉΩÂ§üÂú®a‰πãÂâçÂà∑Êñ∞bÁöÑÂÄºÂà∞‰∏ªÂÜÖÂ≠ò„ÄÇÊúâËÆ∏Â§öÊΩúÂú®ÁöÑÈáçÊéíÂ∫èÁöÑÊù•Ê∫êÔºå‰æãÂ¶ÇÁºñËØëÂô®ÔºåJIT‰ª•ÂèäÁºìÂÜ≤Âå∫„ÄÇ ÁºñËØëÂô®ÔºåËøêË°åÊó∂ÂíåÁ°¨‰ª∂Ë¢´ÊúüÊúõ‰∏ÄËµ∑ÂçèÂäõÂàõÂª∫Â•ΩÂÉèÊòØÈ°∫Â∫èÊâßË°åÁöÑËØ≠‰πâÁöÑÂÅáË±°ÔºåËøôÊÑèÂë≥ÁùÄÂú®ÂçïÁ∫øÁ®ãÁöÑÁ®ãÂ∫è‰∏≠ÔºåÁ®ãÂ∫èÂ∫îËØ•ÊòØ‰∏çËÉΩÂ§üËßÇÂØüÂà∞ÈáçÊéíÂ∫èÁöÑÂΩ±ÂìçÁöÑ„ÄÇ‰ΩÜÊòØÔºåÈáçÊéíÂ∫èÂú®Ê≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•‰∫ÜÁöÑÂ§öÁ∫øÁ®ãÁ®ãÂ∫è‰∏≠ÂºÄÂßãËµ∑‰ΩúÁî®ÔºåÂú®Ëøô‰∫õÂ§öÁ∫øÁ®ãÁ®ãÂ∫è‰∏≠Ôºå‰∏Ä‰∏™Á∫øÁ®ãËÉΩÂ§üËßÇÂØüÂà∞ÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÂΩ±ÂìçÔºå‰πüÂèØËÉΩÊ£ÄÊµãÂà∞ÂÖ∂‰ªñÁ∫øÁ®ãÂ∞Ü‰ºö‰ª•‰∏ÄÁßç‰∏çÂêå‰∫éÁ®ãÂ∫èËØ≠‰πâÊâÄËßÑÂÆöÁöÑÊâßË°åÈ°∫Â∫èÊù•ËÆøÈóÆÂèòÈáè„ÄÇ Â§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™Á∫øÁ®ã‰∏ç‰ºöÂÖ≥Ê≥®ÂÖ∂‰ªñÁ∫øÁ®ãÊ≠£Âú®ÂÅö‰ªÄ‰πàÔºå‰ΩÜÊòØÂΩìÂÆÉÈúÄË¶ÅÂÖ≥Ê≥®ÁöÑÊó∂ÂÄôÔºåËøôÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÂêåÊ≠•‰∫Ü„ÄÇ ÊóßÁöÑÂÜÖÂ≠òÊ®°ÂûãÊúâ‰ªÄ‰πàÈóÆÈ¢òÊóßÁöÑÂÜÖÂ≠òÊ®°Âûã‰∏≠ÊúâÂá†‰∏™‰∏•ÈáçÁöÑÈóÆÈ¢ò„ÄÇËøô‰∫õÈóÆÈ¢òÂæàÈöæÁêÜËß£ÔºåÂõ†Ê≠§Ë¢´ÂπøÊ≥õÁöÑËøùËÉå„ÄÇ‰æãÂ¶ÇÔºåÊóßÁöÑÂ≠òÂÇ®Ê®°ÂûãÂú®ËÆ∏Â§öÊÉÖÂÜµ‰∏ãÔºå‰∏çÂÖÅËÆ∏JVMÂèëÁîüÂêÑÁßçÈáçÊéíÂ∫èË°å‰∏∫„ÄÇÊóßÁöÑÂÜÖÂ≠òÊ®°Âûã‰∏≠ËÆ©‰∫∫‰∫ßÁîüÂõ∞ÊÉëÁöÑÂõ†Á¥†ÈÄ†Â∞±‰∫ÜJSR-133ËßÑËåÉÁöÑËØûÁîü„ÄÇ ‰æãÂ¶ÇÔºå‰∏Ä‰∏™Ë¢´ÂπøÊ≥õËÆ§ÂèØÁöÑÊ¶ÇÂøµÂ∞±ÊòØÔºåÂ¶ÇÊûú‰ΩøÁî®finalÂ≠óÊÆµÔºåÈÇ£‰πàÂ∞±Ê≤°ÊúâÂøÖË¶ÅÂú®Â§ö‰∏™Á∫øÁ®ã‰∏≠‰ΩøÁî®ÂêåÊ≠•Êù•‰øùËØÅÂÖ∂‰ªñÁ∫øÁ®ãËÉΩÂ§üÁúãÂà∞Ëøô‰∏™Â≠óÊÆµÁöÑÂÄº„ÄÇÂ∞ΩÁÆ°ËøôÊòØ‰∏Ä‰∏™ÂêàÁêÜÁöÑÂÅáËÆæÂíåÊòéÊòæÁöÑË°å‰∏∫Ôºå‰πüÊòØÊàë‰ª¨ÊâÄÊúüÂæÖÁöÑÁªìÊûú„ÄÇÂÆûÈôÖ‰∏äÔºåÂú®ÊóßÁöÑÂÜÖÂ≠òÊ®°Âûã‰∏≠ÔºåÊàë‰ª¨ÊÉ≥ËÆ©Á®ãÂ∫èÊ≠£Á°ÆËøêË°åËµ∑Êù•Âç¥ÊòØ‰∏çË°åÁöÑ„ÄÇÂú®ÊóßÁöÑÂÜÖÂ≠òÊ®°Âûã‰∏≠ÔºåfinalÂ≠óÊÆµÂπ∂Ê≤°ÊúâÂêåÂÖ∂‰ªñÂ≠óÊÆµËøõË°åÂå∫Âà´ÂØπÂæÖ‚Äî‚ÄîËøôÊÑèÂë≥ÁùÄÂêåÊ≠•ÊòØ‰øùËØÅÊâÄÊúâÁ∫øÁ®ãÁúãÂà∞‰∏Ä‰∏™Âú®ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ÂàùÂßãÂåñÁöÑfinalÂ≠óÊÆµÁöÑÂîØ‰∏ÄÊñπÊ≥ï„ÄÇÁªìÊûú‚Äî‚ÄîÂ¶ÇÊûúÊ≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•ÁöÑËØùÔºåÂØπ‰∏Ä‰∏™Á∫øÁ®ãÊù•ËØ¥ÔºåÂÆÉÂèØËÉΩÁúãÂà∞‰∏Ä‰∏™Â≠óÊÆµÁöÑÈªòËÆ§ÂÄºÔºåÁÑ∂ÂêéÂú®Á®çÂêéÁöÑÊó∂Èó¥ÈáåÔºåÂèàËÉΩÂ§üÁúãÂà∞ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ËÆæÁΩÆÁöÑÂÄº„ÄÇËøôÊÑèÂë≥ÁùÄÔºå‰∏Ä‰∫õ‰∏çÂèØÂèòÁöÑÂØπË±°Ôºå‰æãÂ¶ÇStringÔºåËÉΩÂ§üÊîπÂèòÂÆÉ‰ª¨ÂÄº‚Äî‚ÄîËøôÂÆûÂú®ÂæàËÆ©‰∫∫ÈÉÅÈó∑„ÄÇ ÊóßÁöÑÂÜÖÂ≠òÊ®°ÂûãÂÖÅËÆ∏volatileÂèòÈáèÁöÑÂÜôÊìç‰ΩúÂíåÈùûvolaitleÂèòÈáèÁöÑËØªÂÜôÊìç‰Ωú‰∏ÄËµ∑ËøõË°åÈáçÊéíÂ∫èÔºåËøôÂíåÂ§ßÂ§öÊï∞ÁöÑÂºÄÂèë‰∫∫ÂëòÂØπ‰∫évolatileÂèòÈáèÁöÑÁõ¥ËßÇÊÑüÂèóÊòØ‰∏ç‰∏ÄËá¥ÁöÑÔºåÂõ†Ê≠§‰ºöÈÄ†ÊàêËø∑ÊÉë„ÄÇ ÊúÄÂêéÔºåÊàë‰ª¨Â∞ÜÁúãÂà∞ÁöÑÊòØÔºåÁ®ãÂ∫èÂëòÂØπ‰∫éÁ®ãÂ∫èÊ≤°ÊúâË¢´Ê≠£Á°ÆÂêåÊ≠•ÁöÑÊÉÖÂÜµ‰∏ãÂ∞Ü‰ºöÂèëÁîü‰ªÄ‰πàÁöÑÁõ¥ËßÇÊÑüÂèóÈÄöÂ∏∏ÊòØÈîôËØØÁöÑ„ÄÇJSR-133ÁöÑÁõÆÁöÑ‰πã‰∏ÄÂ∞±ÊòØË¶ÅÂºïËµ∑ËøôÊñπÈù¢ÁöÑÊ≥®ÊÑè„ÄÇ There were several serious problems with the old memory model. It was difficult to understand, and therefore widely violated. For example, the old model did not, in many cases, allow the kinds of reorderings that took place in every JVM. This confusion about the implications of the old model was what compelled the formation of JSR-133. One widely held belief, for example, was that if final fields were used, then synchronization between threads was unnecessary to guarantee another thread would see the value of the field. While this is a reasonable assumption and a sensible behavior, and indeed how we would want things to work, under the old memory model, it was simply not true. Nothing in the old memory model treated final fields differently from any other field ‚Äî meaning synchronization was the only way to ensure that all threads see the value of a final field that was written by the constructor. As a result, it was possible for a thread to see the default value of the field, and then at some later time see its constructed value. This means, for example, that immutable objects like String can appear to change their value ‚Äî a disturbing prospect indeed. The old memory model allowed for volatile writes to be reordered with nonvolatile reads and writes, which was not consistent with most developers intuitions about volatile and therefore caused confusion. Finally, as we shall see, programmers‚Äô intuitions about what can occur when their programs are incorrectly synchronized are often mistaken. One of the goals of JSR-133 is to call attention to this fact. Ê≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•ÁöÑÂê´‰πâÊòØ‰ªÄ‰πàÊ≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•ÁöÑ‰ª£Á†ÅÂØπ‰∫é‰∏çÂêåÁöÑ‰∫∫Êù•ËØ¥ÂèØËÉΩ‰ºöÊúâ‰∏çÂêåÁöÑÁêÜËß£„ÄÇÂú®JavaÂÜÖÂ≠òÊ®°ÂûãËøô‰∏™ËØ≠‰πâÁéØÂ¢É‰∏ãÔºåÊàë‰ª¨Ë∞àÂà∞‚ÄúÊ≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•‚ÄùÔºåÊàë‰ª¨ÁöÑÊÑèÊÄùÊòØÔºö ‰∏Ä‰∏™Á∫øÁ®ã‰∏≠Êúâ‰∏Ä‰∏™ÂØπÂèòÈáèÁöÑÂÜôÊìç‰ΩúÔºå Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÂØπÂêå‰∏Ä‰∏™ÂèòÈáèÊúâËØªÊìç‰ΩúÔºå ËÄå‰∏îÂÜôÊìç‰ΩúÂíåËØªÊìç‰ΩúÊ≤°ÊúâÈÄöËøáÂêåÊ≠•Êù•‰øùËØÅÈ°∫Â∫è„ÄÇ ÂΩìËøô‰∫õËßÑÂàôË¢´ËøùÂèçÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â∞±ËØ¥Âú®Ëøô‰∏™ÂèòÈáè‰∏äÊúâ‰∏Ä‰∏™‚ÄúÊï∞ÊçÆÁ´û‰∫â‚Äù(data race)„ÄÇ‰∏Ä‰∏™ÊúâÊï∞ÊçÆÁ´û‰∫âÁöÑÁ®ãÂ∫èÂ∞±ÊòØ‰∏Ä‰∏™Ê≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•ÁöÑÁ®ãÂ∫è„ÄÇ Incorrectly synchronized code can mean different things to different people. When we talk about incorrectly synchronized code in the context of the Java Memory Model, we mean any code where there is a write of a variable by one thread, there is a read of the same variable by another thread and the write and read are not ordered by synchronization When these rules are violated, we say we have a data race on that variable. A program with a data race is an incorrectly synchronized program. ÂêåÊ≠•‰ºöÂπ≤‰∫õ‰ªÄ‰πàÂë¢ÂêåÊ≠•ÊúâÂá†‰∏™ÊñπÈù¢ÁöÑ‰ΩúÁî®„ÄÇÊúÄÂπø‰∏∫‰∫∫Áü•ÁöÑÂ∞±ÊòØ‰∫íÊñ• ‚Äî‚Äî‰∏ÄÊ¨°Âè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãËÉΩÂ§üËé∑Âæó‰∏Ä‰∏™ÁõëËßÜÂô®ÔºåÂõ†Ê≠§ÔºåÂú®‰∏Ä‰∏™ÁõëËßÜÂô®‰∏äÈù¢ÂêåÊ≠•ÊÑèÂë≥ÁùÄ‰∏ÄÊó¶‰∏Ä‰∏™Á∫øÁ®ãËøõÂÖ•Âà∞ÁõëËßÜÂô®‰øùÊä§ÁöÑÂêåÊ≠•Âùó‰∏≠ÔºåÂÖ∂‰ªñÁöÑÁ∫øÁ®ãÈÉΩ‰∏çËÉΩËøõÂÖ•Âà∞Âêå‰∏Ä‰∏™ÁõëËßÜÂô®‰øùÊä§ÁöÑÂùó‰∏≠Èó¥ÔºåÈô§ÈùûÁ¨¨‰∏Ä‰∏™Á∫øÁ®ãÈÄÄÂá∫‰∫ÜÂêåÊ≠•Âùó„ÄÇ ‰ΩÜÊòØÂêåÊ≠•ÁöÑÂê´‰πâÊØî‰∫íÊñ•Êõ¥Âπø„ÄÇÂêåÊ≠•‰øùËØÅ‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÂú®ÂêåÊ≠•Âùó‰πãÂâçÊàñËÄÖÂú®ÂêåÊ≠•Âùó‰∏≠ÁöÑ‰∏Ä‰∏™ÂÜÖÂ≠òÂÜôÂÖ•Êìç‰Ωú‰ª•ÂèØÈ¢ÑÁü•ÁöÑÊñπÂºèÂØπÂÖ∂‰ªñÊúâÁõ∏ÂêåÁõëËßÜÂô®ÁöÑÁ∫øÁ®ãÂèØËßÅ„ÄÇÂΩìÊàë‰ª¨ÈÄÄÂá∫‰∫ÜÂêåÊ≠•ÂùóÔºåÊàë‰ª¨Â∞±ÈáäÊîæ‰∫ÜËøô‰∏™ÁõëËßÜÂô®ÔºåËøô‰∏™ÁõëËßÜÂô®ÊúâÂà∑Êñ∞ÁºìÂÜ≤Âå∫Âà∞‰∏ªÂÜÖÂ≠òÁöÑÊïàÊûúÔºåÂõ†Ê≠§ËØ•Á∫øÁ®ãÁöÑÂÜôÂÖ•Êìç‰ΩúËÉΩÂ§ü‰∏∫ÂÖ∂‰ªñÁ∫øÁ®ãÊâÄËßÅ„ÄÇÂú®Êàë‰ª¨ËøõÂÖ•‰∏Ä‰∏™ÂêåÊ≠•Âùó‰πãÂâçÔºåÊàë‰ª¨ÈúÄË¶ÅËé∑ÂèñÁõëËßÜÂô®ÔºåÁõëËßÜÂô®Êúâ‰ΩøÊú¨Âú∞Â§ÑÁêÜÂô®ÁºìÂ≠òÂ§±ÊïàÁöÑÂäüËÉΩÔºåÂõ†Ê≠§ÂèòÈáè‰ºö‰ªé‰∏ªÂ≠òÈáçÊñ∞Âä†ËΩΩÔºå‰∫éÊòØÂÖ∂ÂÆÉÁ∫øÁ®ãÂØπÂÖ±‰∫´ÂèòÈáèÁöÑ‰øÆÊîπÂØπÂΩìÂâçÁ∫øÁ®ãÊù•ËØ¥Â∞±ÂèòÂæóÂèØËßÅ‰∫Ü„ÄÇ ‰æùÊçÆÁºìÂ≠òÊù•ËÆ®ËÆ∫ÂêåÊ≠•ÔºåÂèØËÉΩÂê¨Ëµ∑Êù•Ëøô‰∫õËßÇÁÇπ‰ªÖ‰ªÖ‰ºöÂΩ±ÂìçÂà∞Â§öÂ§ÑÁêÜÂô®ÁöÑÁ≥ªÁªü„ÄÇ‰ΩÜÊòØÔºåÈáçÊéíÂ∫èÊïàÊûúËÉΩÂ§üÂú®Âçï‰∏ÄÂ§ÑÁêÜÂô®‰∏äÈù¢ÂæàÂÆπÊòìËßÅÂà∞„ÄÇÂØπÁºñËØëÂô®Êù•ËØ¥ÔºåÂú®Ëé∑Âèñ‰πãÂâçÊàñËÄÖÈáäÊîæ‰πãÂêéÁßªÂä®‰Ω†ÁöÑ‰ª£Á†ÅÊòØ‰∏çÂèØËÉΩÁöÑ„ÄÇÂΩìÊàë‰ª¨Ë∞àÂà∞Âú®ÁºìÂÜ≤Âå∫‰∏äÈù¢ËøõË°åÁöÑËé∑ÂèñÂíåÈáäÊîæÊìç‰ΩúÔºåÊàë‰ª¨‰ΩøÁî®‰∫ÜÁÆÄËø∞ÁöÑÊñπÂºèÊù•ÊèèËø∞Â§ßÈáèÂèØËÉΩÁöÑÂΩ±Âìç„ÄÇ Êñ∞ÁöÑÂÜÖÂ≠òÊ®°ÂûãËØ≠‰πâÂú®ÂÜÖÂ≠òÊìç‰ΩúÔºàËØªÂèñÂ≠óÊÆµÔºåÂÜôÂÖ•Â≠óÊÆµÔºåÈîÅÔºåËß£ÈîÅÔºâ‰ª•ÂèäÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÊìç‰ΩúÔºàstart Âíå joinÔºâ‰∏≠ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÈÉ®ÂàÜÊéíÂ∫èÔºåÂú®Ëøô‰∫õÊìç‰Ωú‰∏≠Ôºå‰∏Ä‰∫õÊìç‰ΩúË¢´Áß∞‰∏∫happen beforeÂÖ∂‰ªñÊìç‰Ωú„ÄÇÂΩì‰∏Ä‰∏™Êìç‰ΩúÂú®Âè¶Â§ñ‰∏Ä‰∏™Êìç‰Ωú‰πãÂâçÂèëÁîüÔºåÁ¨¨‰∏Ä‰∏™Êìç‰Ωú‰øùËØÅËÉΩÂ§üÊéíÂà∞ÂâçÈù¢Âπ∂‰∏îÂØπÁ¨¨‰∫å‰∏™Êìç‰ΩúÂèØËßÅ„ÄÇËøô‰∫õÊéíÂ∫èÁöÑËßÑÂàôÂ¶Ç‰∏ãÔºö Á∫øÁ®ã‰∏≠ÁöÑÊØè‰∏™Êìç‰Ωúhappens beforeËØ•Á∫øÁ®ã‰∏≠Âú®Á®ãÂ∫èÈ°∫Â∫è‰∏äÂêéÁª≠ÁöÑÊØè‰∏™Êìç‰Ωú„ÄÇ Ëß£ÈîÅ‰∏Ä‰∏™ÁõëËßÜÂô®ÁöÑÊìç‰Ωúhappens beforeÈöèÂêéÂØπÁõ∏ÂêåÁõëËßÜÂô®ËøõË°åÈîÅÁöÑÊìç‰Ωú„ÄÇ ÂØπvolatileÂ≠óÊÆµÁöÑÂÜôÊìç‰Ωúhappens **beforeÂêéÁª≠ÂØπÁõ∏ÂêåvolatileÂ≠óÊÆµÁöÑËØªÂèñÊìç‰Ωú„ÄÇ Á∫øÁ®ã‰∏äË∞ÉÁî®start()ÊñπÊ≥ïhappens **beforeËøô‰∏™Á∫øÁ®ãÂêØÂä®ÂêéÁöÑ‰ªª‰ΩïÊìç‰Ωú„ÄÇ ‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ÊâÄÊúâÁöÑÊìç‰ΩúÈÉΩhappens before‰ªéËøô‰∏™Á∫øÁ®ãjoin()ÊñπÊ≥ïÊàêÂäüËøîÂõûÁöÑ‰ªª‰ΩïÂÖ∂‰ªñÁ∫øÁ®ã„ÄÇÔºàÊ≥®ÊÑèÊÄùÊòØÂÖ∂‰ªñÁ∫øÁ®ãÁ≠âÂæÖ‰∏Ä‰∏™Á∫øÁ®ãÁöÑjion()ÊñπÊ≥ïÂÆåÊàêÔºåÈÇ£‰πàÔºåËøô‰∏™Á∫øÁ®ã‰∏≠ÁöÑÊâÄÊúâÊìç‰Ωúhappens **beforeÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠ÁöÑÊâÄÊúâÊìç‰ΩúÔºâ ËøôÊÑèÂë≥ÁùÄÔºö‰ªª‰ΩïÂÜÖÂ≠òÊìç‰ΩúÔºåËøô‰∏™ÂÜÖÂ≠òÊìç‰ΩúÂú®ÈÄÄÂá∫‰∏Ä‰∏™ÂêåÊ≠•ÂùóÂâçÂØπ‰∏Ä‰∏™Á∫øÁ®ãÊòØÂèØËßÅÁöÑÔºåÂØπ‰ªª‰ΩïÁ∫øÁ®ãÂú®ÂÆÉËøõÂÖ•‰∏Ä‰∏™Ë¢´Áõ∏ÂêåÁöÑÁõëËßÜÂô®‰øùÊä§ÁöÑÂêåÊ≠•ÂùóÂêéÈÉΩÊòØÂèØËßÅÁöÑÔºåÂõ†‰∏∫ÊâÄÊúâÂÜÖÂ≠òÊìç‰Ωúhappens beforeÈáäÊîæÁõëËßÜÂô®‰ª•ÂèäÈáäÊîæÁõëËßÜÂô®happens beforeËé∑ÂèñÁõëËßÜÂô®„ÄÇ ÂÖ∂‰ªñÂ¶Ç‰∏ãÊ®°ÂºèÁöÑÂÆûÁé∞Ë¢´‰∏Ä‰∫õ‰∫∫Áî®Êù•Âº∫Ëø´ÂÆûÁé∞‰∏Ä‰∏™ÂÜÖÂ≠òÂ±èÈöúÁöÑÔºå‰∏ç‰ºöÁîüÊïàÔºö 1synchronized (new Object()) &#123;&#125; ËøôÊÆµ‰ª£Á†ÅÂÖ∂ÂÆû‰∏ç‰ºöÊâßË°å‰ªª‰ΩïÊìç‰ΩúÔºå‰Ω†ÁöÑÁºñËØëÂô®‰ºöÊääÂÆÉÂÆåÂÖ®ÁßªÈô§ÊéâÔºåÂõ†‰∏∫ÁºñËØëÂô®Áü•ÈÅìÊ≤°ÊúâÂÖ∂‰ªñÁöÑÁ∫øÁ®ã‰ºö‰ΩøÁî®Áõ∏ÂêåÁöÑÁõëËßÜÂô®ËøõË°åÂêåÊ≠•„ÄÇË¶ÅÁúãÂà∞ÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÁªìÊûúÔºå‰Ω†ÂøÖÈ°ª‰∏∫‰∏Ä‰∏™Á∫øÁ®ãÂª∫Á´ãhappens beforeÂÖ≥Á≥ª„ÄÇ ÈáçÁÇπÊ≥®ÊÑèÔºöÂØπ‰∏§‰∏™Á∫øÁ®ãÊù•ËØ¥Ôºå‰∏∫‰∫ÜÊ≠£Á°ÆÂª∫Á´ãhappens beforeÂÖ≥Á≥ªËÄåÂú®Áõ∏ÂêåÁõëËßÜÂô®‰∏äÈù¢ËøõË°åÂêåÊ≠•ÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ„ÄÇ‰ª•‰∏ãËßÇÁÇπÊòØÈîôËØØÁöÑÔºöÂΩìÁ∫øÁ®ãAÂú®ÂØπË±°X‰∏äÈù¢ÂêåÊ≠•ÁöÑÊó∂ÂÄôÔºåÊâÄÊúâ‰∏úË•øÂØπÁ∫øÁ®ãAÂèØËßÅÔºåÁ∫øÁ®ãBÂú®ÂØπË±°Y‰∏äÈù¢ËøõË°åÂêåÊ≠•ÁöÑÊó∂ÂÄôÔºåÊâÄÊúâ‰∏úË•øÂØπÁ∫øÁ®ãB‰πüÊòØÂèØËßÅÁöÑ„ÄÇÈáäÊîæÁõëËßÜÂô®ÂíåËé∑ÂèñÁõëËßÜÂô®ÂøÖÈ°ªÂåπÈÖçÔºà‰πüÂ∞±ÊòØËØ¥Ë¶ÅÂú®Áõ∏ÂêåÁöÑÁõëËßÜÂô®‰∏äÈù¢ÂÆåÊàêËøô‰∏§‰∏™Êìç‰ΩúÔºâÔºåÂê¶ÂàôÔºå‰ª£Á†ÅÂ∞±‰ºöÂ≠òÂú®‚ÄúÊï∞ÊçÆÁ´û‰∫â‚Äù„ÄÇ Synchronization has several aspects. The most well-understood is mutual exclusion ‚Äî only one thread can hold a monitor at once, so synchronizing on a monitor means that once one thread enters a synchronized block protected by a monitor, no other thread can enter a block protected by that monitor until the first thread exits the synchronized block. But there is more to synchronization than mutual exclusion. Synchronization ensures that memory writes by a thread before or during a synchronized block are made visible in a predictable manner to other threads which synchronize on the same monitor. After we exit a synchronized block, we release the monitor, which has the effect of flushing the cache to main memory, so that writes made by this thread can be visible to other threads. Before we can enter a synchronized block, we acquire the monitor, which has the effect of invalidating the local processor cache so that variables will be reloaded from main memory. We will then be able to see all of the writes made visible by the previous release. Discussing this in terms of caches, it may sound as if these issues only affect multiprocessor machines. However, the reordering effects can be easily seen on a single processor. It is not possible, for example, for the compiler to move your code before an acquire or after a release. When we say that acquires and releases act on caches, we are using shorthand for a number of possible effects. The new memory model semantics create a partial ordering on memory operations (read field, write field, lock, unlock) and other thread operations (start and join), where some actions are said to happen before other operations. When one action happens before another, the first is guaranteed to be ordered before and visible to the second. The rules of this ordering are as follows: Each action in a thread happens before every action in that thread that comes later in the program‚Äôs order. An unlock on a monitor happens before every subsequent lock on that same monitor. A write to a volatile field happens before every subsequent read of that same volatile. A call to start() on a thread happens before any actions in the started thread. All actions in a thread happen before any other thread successfully returns from a join()on that thread. This means that any memory operations which were visible to a thread before exiting a synchronized block are visible to any thread after it enters a synchronized block protected by the same monitor, since all the memory operations happen before the release, and the release happens before the acquire. Another implication is that the following pattern, which some people use to force a memory barrier, doesn‚Äôt work: 1synchronized (new Object()) &#123;&#125; This is actually a no-op, and your compiler can remove it entirely, because the compiler knows that no other thread will synchronize on the same monitor. You have to set up a happens-before relationship for one thread to see the results of another. Important Note: Note that it is important for both threads to synchronize on the same monitor in order to set up the happens-before relationship properly. It is not the case that everything visible to thread A when it synchronizes on object X becomes visible to thread B after it synchronizes on object Y. The release and acquire have to ‚Äúmatch‚Äù (i.e., be performed on the same monitor) to have the right semantics. Otherwise, the code has a data race. Âú®Êñ∞ÁöÑJavaÂÜÖÂ≠òÊ®°Âûã‰∏≠ÔºåfinalÂ≠óÊÆµÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑHow can final fields appear to change their values?One of the best examples of how final fields‚Äô values can be seen to change involves one particular implementation of the String class. A String can be implemented as an object with three fields ‚Äî a character array, an offset into that array, and a length. The rationale for implementing String this way, instead of having only the character array, is that it lets multiple String and StringBufferobjects share the same character array and avoid additional object allocation and copying. So, for example, the method String.substring() can be implemented by creating a new string which shares the same character array with the original String and merely differs in the length and offset fields. For a String, these fields are all final fields. 12String s1 = "/usr/tmp";String s2 = s1.substring(4); The string s2 will have an offset of 4 and a length of 4. But, under the old model, it was possible for another thread to see the offset as having the default value of 0, and then later see the correct value of 4, it will appear as if the string ‚Äú/usr‚Äù changes to ‚Äú/tmp‚Äù. The original Java Memory Model allowed this behavior; several JVMs have exhibited this behavior. The new Java Memory Model makes this illegal. ‰∏Ä‰∏™ÂØπË±°ÁöÑfinalÂ≠óÊÆµÂÄºÊòØÂú®ÂÆÉÁöÑÊûÑÈÄ†ÊñπÊ≥ïÈáåÈù¢ËÆæÁΩÆÁöÑ„ÄÇÂÅáËÆæÂØπË±°Ë¢´Ê≠£Á°ÆÁöÑÊûÑÈÄ†‰∫ÜÔºå‰∏ÄÊó¶ÂØπË±°Ë¢´ÊûÑÈÄ†ÔºåÂú®ÊûÑÈÄ†ÊñπÊ≥ïÈáåÈù¢ËÆæÁΩÆÁªôfinalÂ≠óÊÆµÁöÑÁöÑÂÄºÂú®Ê≤°ÊúâÂêåÊ≠•ÁöÑÊÉÖÂÜµ‰∏ãÂØπÊâÄÊúâÂÖ∂‰ªñÁöÑÁ∫øÁ®ãÈÉΩ‰ºöÂèØËßÅ„ÄÇÂè¶Â§ñÔºåÂºïÁî®Ëøô‰∫õfinalÂ≠óÊÆµÁöÑÂØπË±°ÊàñÊï∞ÁªÑÈÉΩÂ∞Ü‰ºöÁúãÂà∞finalÂ≠óÊÆµÁöÑÊúÄÊñ∞ÂÄº„ÄÇ ÂØπ‰∏Ä‰∏™ÂØπË±°Êù•ËØ¥ÔºåË¢´Ê≠£Á°ÆÁöÑÊûÑÈÄ†ÊòØ‰ªÄ‰πàÊÑèÊÄùÂë¢ÔºüÁÆÄÂçïÊù•ËØ¥ÔºåÂÆÉÊÑèÂë≥ÁùÄËøô‰∏™Ê≠£Âú®ÊûÑÈÄ†ÁöÑÂØπË±°ÁöÑÂºïÁî®Âú®ÊûÑÈÄ†ÊúüÈó¥Ê≤°ÊúâË¢´ÂÖÅËÆ∏ÈÄ∏Âá∫„ÄÇÔºàÂèÇËßÅÂÆâÂÖ®ÊûÑÈÄ†ÊäÄÊúØÔºâ„ÄÇÊç¢Âè•ËØùËØ¥Ôºå‰∏çË¶ÅËÆ©ÂÖ∂‰ªñÁ∫øÁ®ãÂú®ÂÖ∂‰ªñÂú∞ÊñπËÉΩÂ§üÁúãËßÅ‰∏Ä‰∏™ÊûÑÈÄ†ÊúüÈó¥ÁöÑÂØπË±°ÂºïÁî®„ÄÇ‰∏çË¶ÅÊåáÊ¥æÁªô‰∏Ä‰∏™ÈùôÊÄÅÂ≠óÊÆµÔºå‰∏çË¶Å‰Ωú‰∏∫‰∏Ä‰∏™listenerÊ≥®ÂÜåÁªôÂÖ∂‰ªñÂØπË±°Á≠âÁ≠â„ÄÇËøô‰∫õÊìç‰ΩúÂ∫îËØ•Âú®ÊûÑÈÄ†ÊñπÊ≥ï‰πãÂêéÂÆåÊàêÔºåËÄå‰∏çÊòØÊûÑÈÄ†ÊñπÊ≥ï‰∏≠Êù•ÂÆåÊàê„ÄÇ 1234567891011121314151617181920class FinalFieldExample &#123; final int x; int y; static FinalFieldExample f; public FinalFieldExample() &#123; x = 3; y = 4; &#125; static void writer() &#123; f = new FinalFieldExample(); &#125; static void reader() &#123; if (f != null) &#123; int i = f.x; int j = f.y; &#125; &#125;&#125; ‰∏äÈù¢ÁöÑÁ±ªÂ±ïÁ§∫‰∫ÜfinalÂ≠óÊÆµÂ∫îËØ•Â¶Ç‰Ωï‰ΩøÁî®„ÄÇ‰∏Ä‰∏™Ê≠£Âú®ÊâßË°åreaderÊñπÊ≥ïÁöÑÁ∫øÁ®ã‰øùËØÅÁúãÂà∞f.xÁöÑÂÄº‰∏∫3ÔºåÂõ†‰∏∫ÂÆÉÊòØfinalÂ≠óÊÆµ„ÄÇÂÆÉ‰∏ç‰øùËØÅÁúãÂà∞f.yÁöÑÂÄº‰∏∫4ÔºåÂõ†‰∏∫f.y‰∏çÊòØfinalÂ≠óÊÆµ„ÄÇÂ¶ÇÊûúFinalFieldExampleÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂÉèËøôÊ†∑Ôºö 123456public FinalFieldExample() &#123; // bad! x = 3; y = 4; // bad construction - allowing this to escape global.obj = this;&#125; ÈÇ£‰πàÔºå‰ªéglobal.obj‰∏≠ËØªÂèñthisÁöÑÂºïÁî®Á∫øÁ®ã‰∏ç‰ºö‰øùËØÅËØªÂèñÂà∞ÁöÑxÁöÑÂÄº‰∏∫3„ÄÇ ËÉΩÂ§üÁúãÂà∞Â≠óÊÆµÁöÑÊ≠£Á°ÆÁöÑÊûÑÈÄ†ÂÄºÂõ∫ÁÑ∂‰∏çÈîôÔºå‰ΩÜÊòØÔºåÂ¶ÇÊûúÂ≠óÊÆµÊú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™ÂºïÁî®ÔºåÈÇ£‰πàÔºå‰Ω†ËøòÊòØÂ∏åÊúõ‰Ω†ÁöÑ‰ª£Á†ÅËÉΩÂ§üÁúãÂà∞ÂºïÁî®ÊâÄÊåáÂêëÁöÑËøô‰∏™ÂØπË±°ÔºàÊàñËÄÖÊï∞ÁªÑÔºâÁöÑÊúÄÊñ∞ÂÄº„ÄÇÂ¶ÇÊûú‰Ω†ÁöÑÂ≠óÊÆµÊòØfinalÂ≠óÊÆµÔºåÈÇ£‰πàËøôÊòØËÉΩÂ§ü‰øùËØÅÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂΩì‰∏Ä‰∏™finalÊåáÈíàÊåáÂêë‰∏Ä‰∏™Êï∞ÁªÑÔºå‰Ω†‰∏çÈúÄË¶ÅÊãÖÂøÉÁ∫øÁ®ãËÉΩÂ§üÁúãÂà∞ÂºïÁî®ÁöÑÊúÄÊñ∞ÂÄºÂç¥Áúã‰∏çÂà∞ÂºïÁî®ÊâÄÊåáÂêëÁöÑÊï∞ÁªÑÁöÑÊúÄÊñ∞ÂÄº„ÄÇÈáçÂ§ç‰∏Ä‰∏ãÔºåËøôÂÑøÁöÑ‚ÄúÊ≠£Á°ÆÁöÑ‚ÄùÁöÑÊÑèÊÄùÊòØ‚ÄúÂØπË±°ÊûÑÈÄ†ÊñπÊ≥ïÁªìÂ∞æÁöÑÊúÄÊñ∞ÁöÑÂÄº‚ÄùËÄå‰∏çÊòØ‚ÄúÊúÄÊñ∞ÂèØÁî®ÁöÑÂÄº‚Äù„ÄÇ Áé∞Âú®ÔºåÂú®ËÆ≤‰∫ÜÂ¶Ç‰∏äÁöÑËøôÊÆµ‰πãÂêéÔºåÂ¶ÇÊûúÂú®‰∏Ä‰∏™Á∫øÁ®ãÊûÑÈÄ†‰∫Ü‰∏Ä‰∏™‰∏çÂèØÂèòÂØπË±°‰πãÂêéÔºàÂØπË±°‰ªÖÂåÖÂê´finalÂ≠óÊÆµÔºâÔºå‰Ω†Â∏åÊúõ‰øùËØÅËøô‰∏™ÂØπË±°Ë¢´ÂÖ∂‰ªñÁ∫øÁ®ãÊ≠£Á°ÆÁöÑÊü•ÁúãÔºå‰Ω†‰ªçÁÑ∂ÈúÄË¶Å‰ΩøÁî®ÂêåÊ≠•ÊâçË°å„ÄÇ‰æãÂ¶ÇÔºåÊ≤°ÊúâÂÖ∂‰ªñÁöÑÊñπÂºèÂèØ‰ª•‰øùËØÅ‰∏çÂèØÂèòÂØπË±°ÁöÑÂºïÁî®Â∞ÜË¢´Á¨¨‰∫å‰∏™Á∫øÁ®ãÁúãÂà∞„ÄÇ‰ΩøÁî®finalÂ≠óÊÆµÁöÑÁ®ãÂ∫èÂ∫îËØ•‰ªîÁªÜÁöÑË∞ÉËØïÔºåËøôÈúÄË¶ÅÊ∑±ÂÖ•ËÄå‰∏î‰ªîÁªÜÁöÑÁêÜËß£Âπ∂ÂèëÂú®‰Ω†ÁöÑ‰ª£Á†Å‰∏≠ÊòØÂ¶Ç‰ΩïË¢´ÁÆ°ÁêÜÁöÑ„ÄÇ Â¶ÇÊûú‰Ω†‰ΩøÁî®JNIÊù•ÊîπÂèò‰Ω†ÁöÑfinalÂ≠óÊÆµÔºåËøôÊñπÈù¢ÁöÑË°å‰∏∫ÊòØÊ≤°ÊúâÂÆö‰πâÁöÑ„ÄÇ]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>javaÂÜÖÂ≠òÊ®°Âûã</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mac ‰∏≠ÊñáÁâàmanÂÆâË£Ö]]></title>
    <url>%2F2018%2F03%2F05%2Fmac-%E4%B8%AD%E6%96%87%E7%89%88man%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[Mac 10.13 ÂÆâË£Ö‰∏≠ÊñáÁâà man ÂëΩ‰ª§Êú¨ÊñáÂèÇËÄÉ‰∫é „ÄäMac ÂÆâË£ÖmanÂëΩ‰ª§‰∏≠ÊñáÊñáÊ°£„ÄãÔºå‰ΩÜÂéüÊñáÊèê‰æõÁöÑÈìæÊé•‰ª•ÂèäÂÆâË£ÖÁöÑÁâàÊú¨ÊØîËæÉËÄÅÊóß„ÄÇÂõ†Ê≠§ÈáçÊñ∞Êï¥ÁêÜÊñ∞ÁâàÂú®ËøôËæπÊèê‰æõÁªôÂ§ßÂÆ∂„ÄÇ ‰∏∫‰ªÄ‰πàÈúÄË¶Å man ‰ª•Âèä man ÊÄé‰πà‰ΩøÁî®linux ÊàñËÄÖ mac Á≥ªÁªüÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÈùûÂ∏∏Â§öÔºåÂèØÊòØÊàë‰ª¨‰∏çËÉΩËÆ∞‰ΩèÊâÄÊúâÁöÑËøô‰∫õÂëΩ‰ª§ÔºåÈÄöÂ∏∏Âè™ËÉΩËÆ∞‰Ωè‰∏Ä‰∫õÊàë‰ª¨Â∏∏Áî®ÁöÑ„ÄÇÈÅáÂà∞‰∏çÂ∏∏Áî®ÁöÑÊàë‰ª¨ÈúÄË¶ÅÊù•Êü•ËØ¢‰∏Ä‰∏ãËøô‰∏™ÂëΩ‰ª§ÊòØÊÄé‰πà‰ΩøÁî®ÁöÑ„ÄÇËøôÊó∂ÂÄôÊàë‰ª¨Â∞±ÈúÄË¶Å‰ΩøÁî®Âà∞ man ÂëΩ‰ª§‰∫Ü„ÄÇ ‰ΩøÁî®ÊñπÊ≥ï‰πüÈùûÂ∏∏ÁÆÄÂçïÔºå‰æãÂ¶ÇÊàë‰ª¨‰∏çÊ∏ÖÊ•ö ls Ëøô‰∏™ÂëΩ‰ª§ÁöÑ‰ΩøÁî®ÊñπÊ≥ïÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âú®ÂëΩ‰ª§Ë°å‰∏≠ËæìÂÖ• 1man ls1 Êù•Êü•ÁúãËøô‰∏™ÂëΩ‰ª§ÁöÑËØ¶ÊÉÖ„ÄÇ ‰ΩÜÊòØÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËæìÂá∫ÁöÑÂÜÖÂÆπÊòØËã±ÊñáÁöÑ„ÄÇÂèØËÉΩÂæàÂ§öËã±Êñá‰∏çÂ•ΩÁöÑÊúãÂèãÂ∏åÊúõÊúâ‰∏≠ÊñáÁâàÊú¨ÁöÑ man ÔºåËøôÁØáÂçöÊñáÂ∞±ÊòØÂëäËØâÂ§ßÂÆ∂ÔºåÂ¶Ç‰ΩïÂú® mac‰∏äÂÆâË£Ö‰∏≠ÊñáÁâàÊú¨ÁöÑÁöÑ man„ÄÇ Ëá≥‰∫é linux Á≥ªÁªüÂàôÈùûÂ∏∏ÁÆÄÂçïÔºåÊü•Áúã https://github.com/man-pages-zh/manpages-zh ‰∏≠ÂØπÂ∫îÁöÑÁâàÊú¨ÔºåÂç≥ÂèØÁî®ÁÆÄÂçïÁöÑÂëΩ‰ª§ÂÆâË£Ö„ÄÇ ‰∏ãËΩΩ manpages-zh ÁºñËæëÂÆâË£ÖÈ¶ñÂÖàÔºåÊàë‰ª¨ÊâìÂºÄ‰∏äÈù¢ÁöÑ github Âú∞ÂùÄÔºåÁÇπÂáª releases ‰∏ãËΩΩÊúÄÊñ∞ÁâàÊú¨ÁöÑ tar.gz Ê∫êÁ†ÅÂåÖ„ÄÇÁõÆÂâçÊàë‰∏ãËΩΩÂà∞ÁöÑÊòØ 1.6.3.2 ÁâàÊú¨ÁöÑ„ÄÇ Âõ†‰∏∫ÈúÄË¶ÅÁºñËØëÂÆâË£ÖÔºåÊâÄ‰ª•‰Ω†ÁîµËÑë‰∏äÈúÄË¶ÅÊúâÁºñËØëÂ∑•ÂÖ∑ÔºåËøêË°å‰∏ãÈù¢‰∏§‰∏™ÂëΩ‰ª§ÂÆâË£Ö 12brew install automakebrew install opencc12 ÊàëËøôËæπÊòØÈúÄË¶ÅÂÆâË£ÖËøô‰∏§‰∏™ÁºñËØëÂ∑•ÂÖ∑ÔºåÂ¶ÇÊûú‰Ω†‰∏ãÈù¢ÁºñËØëÂá∫ÈîôÔºå‰ºöÊèêÁ§∫‰Ω†ÈúÄË¶ÅÂÆâË£ÖËØ¥ÊòéÁºñËæëÂ∑•ÂÖ∑ÁöÑ„ÄÇÂà©Áî® brew ÂÆâË£ÖÂç≥ÂèØ„ÄÇ Â¶ÇÊûú‰Ω†ÁîµËÑëÊ≤°ÊúâÂÆâË£Ö brew Â∑•ÂÖ∑ÔºåËØ∑ÂèÇËÄÉ http://blog.csdn.net/FungLeo/article/details/57567538 ËøôÁØáÂçöÊñáÂÆâË£Ö Â•ΩÔºåÂáÜÂ§áÂ∑•‰ΩúÂÅöÂ•ΩÔºåÊàë‰ª¨Êé•ÁùÄÊù•„ÄÇ 12345678910111213141516171819202122# ËøõÂÖ•‰∏ãËΩΩÁõÆÂΩïcd ~/Downloads/# ‰∏ãËΩΩÊúÄÊñ∞ÁâàÊú¨ÁöÑÊ∫êÁ†ÅÂåÖwget https://github.com/man-pages-zh/manpages-zh/archive/v1.6.3.2.tar.gz# Ëß£ÂéãÊ∫êÁ†ÅÂåÖ(atoolÂëΩ‰ª§ÔºåÊé®ËçêÂÆâË£ÖËøô‰∏™Â∑•ÂÖ∑ÔºåÁªü‰∏ÄÊâÄÊúâÂéãÁº©ÊñáÊ°£ÁöÑÂëΩ‰ª§Ôºâatool -x v1.6.3.2.tar.gz# ÊàñËÄÖ‰ΩøÁî®Ëøô‰∏™ÂëΩ‰ª§Ëß£Âéãtar zxvf v1.6.3.2.tar.gz# ËøõÂÖ•Ê∫êÁ†ÅÂåÖÊñá‰ª∂Â§πcd manpages-zh-1.6.3.2/# ÁºñËØëÂÆâË£Ö 1autoreconf --install --force# ÁºñËØëÂÆâË£Ö 2./configure# ÁºñËØëÂÆâË£Ö 3make# ÁºñËØëÂÆâË£Ö 4sudo make install# ÈÖçÁΩÆÂà´Âêçecho "alias cman='man -M /usr/local/share/man/zh_CN'" &gt;&gt; ~/.bash_profile# ‰ΩøÂà´ÂêçÁîüÊïà. ~/.bash_profile12345678910111213141516171819202122 ËøôÊ†∑ÔºåÊàë‰ª¨Â∞±ÂÆâË£Ö‰∏ä‰∫Ü‰∏≠ÊñáÁâàÊú¨ÁöÑ man Â∑•ÂÖ∑‰∫Ü„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® 1cman ls1 Êù•Êü•Áúã‰∏≠ÊñáÁâàÊú¨ÁöÑËß£Èáä‰∫Ü„ÄÇ‰ΩÜÊòØÁî±‰∫é mac ‰∏äÁöÑ groff Â∑•ÂÖ∑ÊØîËæÉËÄÅÔºåÊâÄ‰ª•‰∏≠Êñá‰ºöÂá∫Áé∞‰π±Á†Å„ÄÇÊàë‰ª¨Êù•Ëß£ÂÜ≥‰∏Ä‰∏ãËøô‰∏™ÈóÆÈ¢ò„ÄÇ ÂÆâË£Ö groff Êñ∞ÁâàÊú¨Ëß£ÂÜ≥‰∏≠Êñá‰π±Á†ÅÁöÑÈóÆÈ¢òÈ¶ñÂÖàÔºåÊàë‰ª¨Âà∞ http://git.savannah.gnu.org/cgit/groff.git Ëøô‰∏™È°µÈù¢‰∏ãËΩΩ 1.22 ÁâàÊú¨ÁöÑ groff ÂÆâË£ÖÂåÖ„ÄÇÊàëËøôËæπÁî®ÂëΩ‰ª§Ë°å‰∏ãËΩΩÔºå‰Ω†Â¶ÇÊûúÁõ¥Êé•Â§çÂà∂ÊàëÁöÑÂëΩ‰ª§Ôºå‰∏çËÉΩ‰∏ãËΩΩÔºåËØ∑Âà∞‰∏äÈù¢ÁöÑÂú∞ÂùÄÂéªÁúãÁúã‰∏ãËΩΩÂú∞ÂùÄÊòØÂê¶ÂèëÁîüÂèòÂåñ„ÄÇ 1234567891011121314# ËøõÂÖ•‰∏ãËΩΩÁõÆÂΩïcd ~/Downloads/# ‰∏ãËΩΩ1.22ÁâàÊú¨ÁöÑÊ∫êÁ†ÅÂåÖwget http://git.savannah.gnu.org/cgit/groff.git/snapshot/groff-1.22.tar.gz# Ëß£Âéãatool -x groff-1.22.tar.gz# ËøõÂÖ•ÁõÆÂΩïcd groff-1.22# ÁºñËØëÂÆâË£Ö./configuresudo makesudo make install# Ê∑ªÂä†ÈÖçÁΩÆsudo vim /etc/man.conf1234567891011121314 ËøõÂÖ•ÁºñËæë‰πãÂêéÔºåÂú®Êñá‰ª∂Êú´Â∞æÊ∑ªÂä† 1NROFF preconv -e UTF8 | /usr/local/bin/nroff -Tutf8 -mandoc -c1 ÊúÄÂêé :wq ‰øùÂ≠òÈÄÄÂá∫ ÁÑ∂ÂêéÔºåÊàë‰ª¨Âú®ËæìÂÖ• 1cman ls1 Â∞±ÂèØ‰ª•ÁúãÂà∞‰∏≠ÊñáÁâàÊú¨ÁöÑÂëΩ‰ª§‰ªãÁªç‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[JFR‰ΩøÁî®ÊñπÊ≥ï]]></title>
    <url>%2F2018%2F02%2F07%2Fjmc%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[JFR‰ΩøÁî®ÊñπÂºèÊåâÁÖß‰∏ãÈù¢‰∏â‰∏™Ê≠•È™§Êìç‰ΩúÔºõ ÈÄâÂÆö‰∏ÄÂè∞Êú∫Âô®ÔºåÁôªÈôÜ‰∏äÂéªÔºåÂπ∂ÊâæÂà∞Ë¶ÅÁõëÊéßÁöÑËøõÁ®ãPID Â∞ÜÈôÑ‰ª∂Êñá‰ª∂(*.jfc)ÊîæÂÖ•Âà∞ /usr/install/java/jdk1.8.0_60/jre/lib/jfr ÁõÆÂΩïÔºåÊ≥®ÊÑèÔºåËøô‰∏™ÈÖçÁΩÆÊñá‰ª∂ÊòØÂú®ÂÆòÊñπÈÖçÁΩÆ‰∏äÂ¢ûÂä†‰∫ÜÂØπÂºÇÂ∏∏Êï∞ÊçÆÁöÑÈááÈõÜ„ÄÇÊé®Ëçê‰ΩøÁî®„ÄÇ ÊâßË°å‰∏ãÂàóÂëΩ‰ª§ÔºåÂÖ∂‰∏≠ËØ∑Ëá™Ë°åÊõøÊç¢Ôºö ËøôÊ†∑Â∞±Â•Ω‰∫ÜÔºåÂ¶Ç‰∏äÔºåÁ≠âÂæÖ2ÂàÜÈíüÔºã20ÁßíÔºå/tmp/pid.jfrÊñá‰ª∂Â∞±ÁîüÊàêÂ•Ω‰∫ÜÔºåËøô‰∏™Êñá‰ª∂Áõ¥Êé•ÂØºÂÖ•JMCÂ∑•ÂÖ∑Âç≥ÂèØ 12345678jcmd &lt;pid&gt; VM.unlock_commercial_features #ÂÖàËß£ÈîÅÊäÄËÉΩjcmd &lt;pid&gt; JFR.start name=myrec settings=tongdun delay=20s duration=2m filename=/tmp/pid.jfr#ÂÖ∂‰∏≠ÔºådelayÂèÇÊï∞Ë°®Á§∫profileÂª∂ËøüÂêØÂä®Êó∂Èó¥ÔºådurationË°®Á§∫ÊåÅÁª≠ÈááÈõÜÊó∂Èó¥ÔºåËøôÈáåËÆæÁΩÆ‰∏∫2ÂàÜÈíü#settingsË°®Á§∫‰ΩøÁî®Âì™ÁßçÈááÈõÜÈÖçÁΩÆÔºåËøôÈáåÁî®ÁöÑÂ∞±ÊòØÁ¨¨‰∫åÊ≠•‰∏≠ÊîæÂÖ•ÁöÑtongdun.jfcÈÖçÁΩÆÔºåÂÆÉÈªòËÆ§Êúâ‰∏Ä‰∏™Âêç‰∏∫profileÁöÑÈÖçÁΩÆÔºåÂ¶ÇÊûú‰∏çÊÉ≥ÈááÈõÜÂºÇÂ∏∏‰ø°ÊÅØÔºå‰πüÂèØ‰ª•Áõ¥Êé•Áî®ÂÆÉ„ÄÇ#Ê≥®ÊÑèÔºåÈááÈõÜÊï∞ÊçÆÁîüÊàêÂêéËØ∑ÊâßË°å‰∏ãÂàóÂëΩ‰ª§ÁßªÈô§Ëøô‰∏™ÈááÈõÜjcmd &lt;pid&gt; JFR.stop name=myrec]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[jdk‰πãÁ∫ø‰∏äÈ´òÂÜÖÂ≠òÂç†Áî®]]></title>
    <url>%2F2018%2F02%2F07%2Fjdk%E4%B9%8B%E7%BA%BF%E4%B8%8A%E9%AB%98%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021#ÊâæÂà∞Âç†Áî®ÂÜÖÂ≠òÈ´òÁöÑjavaËøõÁ®ãtop#Êü•ÁúãÂ†Ü‰ΩøÁî®ÊÉÖÂÜµjmp -heap [pid]#Êü•ÁúãÂç†Áî®ÂÜÖÂ≠òÈ´òÁöÑÂØπË±°jmp -histo:live [pid] | head -n 100#Êü•ÁúãÂç†Áî®ÂÜÖÂ≠òÈ´òÁöÑÂØπË±°,dumpÊàêÊñá‰ª∂ÔºåÁ∫ø‰∏ãÂàÜÊûêjmap -dump:live,format=b,file=xxx.xxx [pid]#Êü•ÁúãËøõÁ®ãÁöÑÁ∫øÁ®ãÊÉÖÂÜµps p [pid] -L -o pcpu,pmem,pid,tid,time,tname,cmd#Á∫øÁ®ãidÊâìÂç∞Êàê16ËøõÂà∂printf "%x\n" [tid]#ËæìÂá∫javaËøõÁ®ãÂ†ÜÊ†àÂà∞Êñá‰ª∂jstack -l [pid] &gt; jstack.log#vim Êü•Êâæ16ËøõÂà∂ÁöÑtidÔºå runnableÊ≠£Â∏∏Áä∂ÊÄÅÔºåWAITING‰∏ÄÁõ¥Á≠âÈÇ£‰∏™Êù°‰ª∂ÂèëÁîüÔºåTIMED_WAITINGÂÆöÊó∂ÁöÑÈÇ£‰∏™Êù°‰ª∂‰∏çÂà∞Êù•‰πüÂ∞ÜÂÆöÊó∂Âî§ÈÜíËá™Â∑±vim jstack.log jmapÂëΩ‰ª§Êúâ‰∏ãÈù¢Âá†ÁßçÂ∏∏Áî®ÁöÑÁî®Ê≥ïÔºö ‚Ä¢jmap [pid] ‚Ä¢jmap -histo:live [pid] &gt;a.log ‚Ä¢jmap -dump:live,format=b,file=xxx.xxx [pid] Áî®ÂæóÊúÄÂ§öÊòØÂêéÈù¢‰∏§‰∏™„ÄÇÂÖ∂‰∏≠Ôºåjmap -histo:live [pid] ÂèØ‰ª•Êü•ÁúãÂΩìÂâçJavaËøõÁ®ãÂàõÂª∫ÁöÑÊ¥ªË∑ÉÂØπË±°Êï∞ÁõÆÂíåÂç†Áî®ÂÜÖÂ≠òÂ§ßÂ∞è„ÄÇ jmap -dump:live,format=b,file=xxx.xxx [pid] ÂàôÂèØ‰ª•Â∞ÜÂΩìÂâçJavaËøõÁ®ãÁöÑÂÜÖÂ≠òÂç†Áî®ÊÉÖÂÜµÂØºÂá∫Êù•ÔºåÊñπ‰æøÁî®‰∏ìÈó®ÁöÑÂÜÖÂ≠òÂàÜÊûêÂ∑•ÂÖ∑Ôºà‰æãÂ¶ÇÔºöMATÔºâÊù•ÂàÜÊûê„ÄÇ Ëøô‰∏™ÂëΩ‰ª§ÂØπ‰∫éÂàÜÊûêÊòØÂê¶ÊúâÂÜÖÂ≠òÊ≥ÑÊºèÂæàÊúâÂ∏ÆÂä©„ÄÇÂÖ∑‰ΩìÊÄé‰πà‰ΩøÁî®ÂèØ‰ª•Êü•ÁúãÊú¨ÂçöÁöÑÂè¶‰∏ÄÁØáÊñáÁ´†ÔºöÂà©Áî®Eclipse Memory Analyzer ToolÔºàMATÔºâÂàÜÊûêÂÜÖÂ≠òÊ≥ÑÊºè È¶ñÂÖàÁúã‰∏Ä‰∏ã‰∏Ä‰∏™javaËøõÁ®ãÁöÑjmapËæìÂá∫Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748[lex@chou ~]$ jmap -heap 837Attaching to process ID 837, please wait...Debugger attached successfully.Server compiler detected.JVM version is 20.10-b01using thread-local object allocation.Parallel GC with 2 thread(s)Heap Configuration: MinHeapFreeRatio = 40 MaxHeapFreeRatio = 70 MaxHeapSize = 4294967296 (4096.0MB) NewSize = 1310720 (1.25MB) MaxNewSize = 17592186044415 MB OldSize = 5439488 (5.1875MB) NewRatio = 2 SurvivorRatio = 8 PermSize = 21757952 (20.75MB) MaxPermSize = 85983232 (82.0MB)Heap Usage:PS Young GenerationEden Space: capacity = 41025536 (39.125MB) used = 18413552 (17.560531616210938MB) free = 22611984 (21.564468383789062MB) 44.883147900858624% usedFrom Space: capacity = 4325376 (4.125MB) used = 3702784 (3.53125MB) free = 622592 (0.59375MB) 85.60606060606061% usedTo Space: capacity = 4521984 (4.3125MB) used = 0 (0.0MB) free = 4521984 (4.3125MB) 0.0% usedPS Old Generation capacity = 539820032 (514.8125MB) used = 108786168 (103.74657440185547MB) free = 431033864 (411.06592559814453MB) 20.152302906758376% usedPS Perm Generation capacity = 85983232 (82.0MB) used = 60770232 (57.95500946044922MB) free = 25213000 (24.04499053955078MB) 70.67684080542588% used ÁÑ∂ÂêéÂÜçÁî®psÁúãÁúãÔºö 123[lex@chou ~]$ ps -p 837 -o vsz,rss VSZ RSS7794992 3047320 ÂÖ≥‰∫éËøôÈáåÁöÑÂá†‰∏™generationÁΩë‰∏äËµÑÊñô‰∏ÄÂ§ßÊääÂ∞±‰∏çÁªÜËØ¥‰∫ÜÔºåËøôÈáåÁÆó‰∏Ä‰∏ãÊ±ÇÂíåÂèØ‰ª•ÂæóÁü•ÂâçËÄÖÊÄªÂÖ±ÁªôJavaÁéØÂ¢ÉÂàÜÈÖç‰∫Ü644MÁöÑÂÜÖÂ≠òÔºåËÄåpsËæìÂá∫ÁöÑVSZÂíåRSSÂàÜÂà´ÊòØ7.4GÂíå2.9GÔºåËøôÂà∞Â∫ïÊòØÊÄé‰πàÂõû‰∫ãÂë¢ÔºüÂâçÈù¢jmapËæìÂá∫ÁöÑÂÜÖÂÆπÈáåÔºåMaxHeapSize ÊòØÂú®ÂëΩ‰ª§Ë°å‰∏äÈÖçÁöÑÔºå-Xmx4096mÔºåËøô‰∏™javaÁ®ãÂ∫èÂèØ‰ª•Áî®Âà∞ÁöÑÊúÄÂ§ßÂ†ÜÂÜÖÂ≠ò„ÄÇVSZÊòØÊåáÂ∑≤ÂàÜÈÖçÁöÑÁ∫øÊÄßÁ©∫Èó¥Â§ßÂ∞èÔºåËøô‰∏™Â§ßÂ∞èÈÄöÂ∏∏Âπ∂‰∏çÁ≠â‰∫éÁ®ãÂ∫èÂÆûÈôÖÁî®Âà∞ÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºå‰∫ßÁîüËøô‰∏™ÁöÑÂèØËÉΩÊÄßÂæàÂ§öÔºåÊØîÂ¶ÇÂÜÖÂ≠òÊò†Â∞ÑÔºåÂÖ±‰∫´ÁöÑÂä®ÊÄÅÂ∫ìÔºåÊàñËÄÖÂêëÁ≥ªÁªüÁî≥ËØ∑‰∫ÜÊõ¥Â§öÁöÑÂ†ÜÔºåÈÉΩ‰ºöÊâ©Â±ïÁ∫øÊÄßÁ©∫Èó¥Â§ßÂ∞èÔºåË¶ÅÊü•Áúã‰∏Ä‰∏™ËøõÁ®ãÊúâÂì™‰∫õÂÜÖÂ≠òÊò†Â∞ÑÔºåÂèØ‰ª•‰ΩøÁî® pmap ÂëΩ‰ª§Êù•Êü•ÁúãÔºö 12345678910111213141516[lex@chou ~]$ pmap -x 837837: javaAddress Kbytes RSS Dirty Mode Mapping0000000040000000 36 4 0 r-x-- java0000000040108000 8 8 8 rwx-- java00000000418c9000 13676 13676 13676 rwx-- [ anon ]00000006fae00000 83968 83968 83968 rwx-- [ anon ]0000000700000000 527168 451636 451636 rwx-- [ anon ]00000007202d0000 127040 0 0 ----- [ anon ]......00007f55ee124000 4 4 0 r-xs- az.png00007fff017ff000 4 4 0 r-x-- [ anon ]ffffffffff600000 4 0 0 r-x-- [ anon ]---------------- ------ ------ ------total kB 7796020 3037264 3023928 ËøôÈáåÂèØ‰ª•ÁúãÂà∞ÂæàÂ§öanonÔºåËøô‰∫õË°®Á§∫ËøôÂùóÂÜÖÂ≠òÊòØÁî±mmapÂàÜÈÖçÁöÑ„ÄÇ RSZÊòØResident Set SizeÔºåÂ∏∏È©ªÂÜÖÂ≠òÂ§ßÂ∞èÔºåÂç≥ËøõÁ®ãÂÆûÈôÖÂç†Áî®ÁöÑÁâ©ÁêÜÂÜÖÂ≠òÂ§ßÂ∞èÔºå Âú®Áé∞Âú®Ëøô‰∏™‰æãÂ≠êÂΩì‰∏≠ÔºåRSZÂíåÂÆûÈôÖÂ†ÜÂÜÖÂ≠òÂç†Áî®Â∑Æ‰∫Ü2.3GÔºåËøô2.3GÁöÑÂÜÖÂ≠òÁªÑÊàêÂàÜÂà´‰∏∫Ôºö JVMÊú¨Ë∫´ÈúÄË¶ÅÁöÑÂÜÖÂ≠òÔºåÂåÖÊã¨ÂÖ∂Âä†ËΩΩÁöÑÁ¨¨‰∏âÊñπÂ∫ì‰ª•ÂèäËøô‰∫õÂ∫ìÂàÜÈÖçÁöÑÂÜÖÂ≠ò NIOÁöÑDirectBufferÊòØÂàÜÈÖçÁöÑnative memory ÂÜÖÂ≠òÊò†Â∞ÑÊñá‰ª∂ÔºåÂåÖÊã¨JVMÂä†ËΩΩÁöÑ‰∏Ä‰∫õJARÂíåÁ¨¨‰∏âÊñπÂ∫ìÔºå‰ª•ÂèäÁ®ãÂ∫èÂÜÖÈÉ®Áî®Âà∞ÁöÑ„ÄÇ‰∏äÈù¢ pmap ËæìÂá∫ÁöÑÂÜÖÂÆπÈáåÔºåÊúâ‰∏Ä‰∫õÈùôÊÄÅÊñá‰ª∂ÊâÄÂç†Áî®ÁöÑÂ§ßÂ∞è‰∏çÂú®JavaÁöÑheapÈáåÔºåÂõ†Ê≠§‰Ωú‰∏∫‰∏Ä‰∏™WebÊúçÂä°Âô®ÔºåËµ∂Á¥ßÊääÈùôÊÄÅÊñá‰ª∂‰ªéËøô‰∏™WebÊúçÂä°Âô®‰∏≠‰∫∫ÁßªÂºÄÂêßÔºåÊîæÂà∞nginxÊàñËÄÖCDNÈáåÂéªÂêß„ÄÇ JITÔºå JVM‰ºöÂ∞ÜClassÁºñËØëÊàênative‰ª£Á†ÅÔºåËøô‰∫õÂÜÖÂ≠ò‰πü‰∏ç‰ºöÂ∞ëÔºåÂ¶ÇÊûú‰ΩøÁî®‰∫ÜSpringÁöÑAOPÔºåCGLIB‰ºöÁîüÊàêÊõ¥Â§öÁöÑÁ±ªÔºåJITÁöÑÂÜÖÂ≠òÂºÄÈîÄ‰πü‰ºöÈöè‰πãÂèòÂ§ßÔºåËÄå‰∏îClassÊú¨Ë∫´JVMÁöÑGC‰ºöÂ∞ÜÂÖ∂ÊîæÂà∞Perm GenerationÈáåÂéªÔºåÂæàÈöæË¢´ÂõûÊî∂ÊéâÔºåÈù¢ÂØπËøôÁßçÊÉÖÂÜµÔºåÂ∫îËØ•ËÆ©JVM‰ΩøÁî®ConcurrentMarkSweep GCÔºåÂπ∂ÂêØÁî®Ëøô‰∏™GCÁöÑÁõ∏ÂÖ≥ÂèÇÊï∞ÂÖÅËÆ∏Â∞Ü‰∏ç‰ΩøÁî®ÁöÑclass‰ªéPerm Generation‰∏≠ÁßªÈô§Ôºå ÂèÇÊï∞ÈÖçÁΩÆÔºö -XX:+UseConcMarkSweepGC -X:+CMSPermGenSweepingEnabled -X:+CMSClassUnloadingEnabledÔºåÂ¶ÇÊûú‰∏çÈúÄË¶ÅÁßªÈô§ËÄåPerm GenerationÁ©∫Èó¥‰∏çÂ§üÔºåÂèØ‰ª•Âä†Â§ß‰∏ÄÁÇπÔºö -X:PermSize=256M -X:MaxPermSize=512M JNIÔºå‰∏Ä‰∫õJNIÊé•Âè£Ë∞ÉÁî®ÁöÑnativeÂ∫ì‰πü‰ºöÂàÜÈÖç‰∏Ä‰∫õÂÜÖÂ≠òÔºåÂ¶ÇÊûúÈÅáÂà∞JNIÂ∫ìÁöÑÂÜÖÂ≠òÊ≥ÑÈú≤ÔºåÂèØ‰ª•‰ΩøÁî®valgrindÁ≠âÂÜÖÂ≠òÊ≥ÑÈú≤Â∑•ÂÖ∑Êù•Ê£ÄÊµã Á∫øÁ®ãÊ†àÔºåÊØè‰∏™Á∫øÁ®ãÈÉΩ‰ºöÊúâËá™Â∑±ÁöÑÊ†àÁ©∫Èó¥ÔºåÂ¶ÇÊûúÁ∫øÁ®ã‰∏ÄÂ§öÔºåËøô‰∏™ÁöÑÂºÄÈîÄÂ∞±ÂæàÊòéÊòæ‰∫Ü jmap/jstack ÈááÊ†∑ÔºåÈ¢ëÁπÅÁöÑÈááÊ†∑‰πü‰ºöÂ¢ûÂä†ÂÜÖÂ≠òÂç†Áî®ÔºåÂ¶ÇÊûú‰Ω†ÊúâÊúçÂä°Âô®ÂÅ•Â∫∑ÁõëÊéßÔºåËÆ∞ÂæóËøô‰∏™È¢ëÁéáÂà´Â§™È´òÔºåÂê¶ÂàôÂÅ•Â∫∑ÁõëÊéßÂèòÊàêËá¥ÁóÖÁõëÊéß‰∫Ü„ÄÇ ÂÖ≥‰∫éJVMÁöÑÂá†‰∏™GCÂ†ÜÂíåGCÁöÑÊÉÖÂÜµÔºåÂèØ‰ª•Áî®jstatÊù•ÁõëÊéßÔºå‰æãÂ¶ÇÁõëÊéßËøõÁ®ã837ÊØèÈöî1000ÊØ´ÁßíÂà∑Êñ∞‰∏ÄÊ¨°ÔºåËæìÂá∫20Ê¨°Ôºö 1234[lex@chou ~]$ jstat -gcutil 837 1000 20 S0 S1 E O P YGC YGCT FGC FGCT GCT 0.00 80.43 24.62 87.44 98.29 7101 119.652 40 19.719 139.371 0.00 80.43 33.14 87.44 98.29 7101 119.652 40 19.719 139.371 Âá†‰∏™Â≠óÊÆµÂàÜÂà´Âê´‰πâÂ¶Ç‰∏ãÔºö S0 Âπ¥ËΩª‰ª£‰∏≠Á¨¨‰∏Ä‰∏™survivorÔºàÂπ∏Â≠òÂå∫ÔºâÂ∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî S1 Âπ¥ËΩª‰ª£‰∏≠Á¨¨‰∫å‰∏™survivorÔºàÂπ∏Â≠òÂå∫ÔºâÂ∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî E Âπ¥ËΩª‰ª£‰∏≠EdenÔºà‰ºäÁî∏Âõ≠ÔºâÂ∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî O old‰ª£Â∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî P perm‰ª£Â∑≤‰ΩøÁî®ÁöÑÂç†ÂΩìÂâçÂÆπÈáèÁôæÂàÜÊØî YGC ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂Âπ¥ËΩª‰ª£‰∏≠gcÊ¨°Êï∞ YGCT ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂Âπ¥ËΩª‰ª£‰∏≠gcÊâÄÁî®Êó∂Èó¥(s) FGC ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂old‰ª£(ÂÖ®gc)gcÊ¨°Êï∞ FGCT ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂old‰ª£(ÂÖ®gc)gcÊâÄÁî®Êó∂Èó¥(s) GCT ‰ªéÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Âà∞ÈááÊ†∑Êó∂gcÁî®ÁöÑÊÄªÊó∂Èó¥(s) ÁªìËÆ∫Âõ†Ê≠§Â¶ÇÊûúÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãjmapËæìÂá∫ÁöÑÂÜÖÂ≠òÂç†Áî®ËøúÂ∞è‰∫é RSZÔºåÂèØ‰ª•‰∏çÁî®Â§™ÊãÖÂøÉÔºåÈô§ÈùûÂèëÁîü‰∏Ä‰∫õ‰∏•ÈáçÈîôËØØÔºåÊØîÂ¶ÇPermGenÁ©∫Èó¥Êª°‰∫ÜÂØºËá¥OutOfMemoryErrorÂèëÁîüÔºåÊàñËÄÖRSZÂ§™È´òÂØºËá¥ÂºïËµ∑Á≥ªÁªüÂÖ¨ÊÑ§Ë¢´OOM KillerÁªôÂπ≤ÊéâÔºåÂ∞±ÂæóÊ≥®ÊÑè‰∫ÜÔºåËØ•Âä†ÂÜÖÂ≠òÂä†ÂÜÖÂ≠òÔºåÊ≤°Èí±‰π∞ÂÜÖÂ≠òÂä†‰∫§Êç¢Á©∫Èó¥ÔºåÊàñËÄÖÊåâ‰∏äÈù¢ÂàóÁöÑÁªÑÊàêÈÉ®ÂàÜÈÄê‰∏ÄÊéíÈô§„ÄÇËøôÂá†‰∏™ÂÜÖÂ≠òÊåáÊ†á‰πãÈó¥ÁöÑÂÖ≥Á≥ªÊòØÔºöVSZ &gt;&gt; RSZ &gt;&gt; JavaÁ®ãÂ∫èÂÆûÈôÖ‰ΩøÁî®ÁöÑÂ†ÜÂ§ßÂ∞è 12 ‰ΩøÁî®topÂëΩ‰ª§Êü•ÁúãÁ≥ªÁªüËµÑÊ∫êÁöÑ‰ΩøÁî®ÊÉÖÂÜµÔºåÂëΩ‰ª§Ôºö top Â¶ÇÂõæÂèØ‰ª•ÁúãÂà∞javaÁöÑËøõÁ®ãÂÜÖÂ≠ò‰ΩøÁî®ÁéáËæÉÈ´òÔºåjavaËøõÁ®ãÁöÑÂÜÖÂ≠ò‰ΩøÁî®ÁéáËææÂà∞‰∫Ü70%+ 2.ÂÆö‰ΩçÁ∫øÁ®ãÈóÆÈ¢òÔºàÈÄöËøáÂëΩ‰ª§Êü•Áúã9718ËøõÁ®ãÁöÑÁ∫øÁ®ãÊÉÖÂÜµÔºâÔºåÂëΩ‰ª§Ôºö ps p 9718 -L -o pcpu,pmem,pid,tid,time,tname,cmd Áî±Ê≠§ÂèØ‰ª•ÁúãÂà∞ËøôPIDÔºö9718ÁöÑËøõÁ®ã‰∫ßÁîü‰∫ÜÂæàÂ§öÁ∫øÁ®ã„ÄÇÊé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÈÄöËøájstackÊü•ÁúãÂÜÖÂ≠ò‰ΩøÁî®ÁöÑÂ†ÜÊ†à„ÄÇ Êü•ÁúãÂÜÖÂ≠ò‰ΩøÁî®ÁöÑÂ†ÜÊ†àÔºöÂú®ËøôÈáåÊàë‰ª¨ÊåëÈÄâ‰∫ÜTID=9720ÁöÑÁ∫øÁ®ãËøõË°åÂàÜÊûêÔºåÈ¶ñÂÖàÈúÄË¶ÅÂ∞Ü9731Ëøô‰∏™idËΩ¨Êç¢‰∏∫16ËøõÂà∂„ÄÇÈúÄËæìÂÖ•Â¶Ç‰∏ãÂëΩ‰ª§Ôºå printf ‚Äú%x\n‚Äù 9731 Êé•‰∏ãÈúÄË¶Å‰ΩøÁî®16ËøõÂà∂ÁöÑ2603 Â∞ÜPID‰∏∫9718ÁöÑÂ†ÜÊ†à‰ø°ÊÅØÊâìÂç∞Âà∞jstack.log‰∏≠ÔºåÂëΩ‰ª§Ôºö jstack -l 9718 &gt; jstack.log 5. Êü•ÁúãÂ†ÜÊ†à‰ø°ÊÅØÊñá‰ª∂ÔºåÂëΩ‰ª§Ôºövim jstack.log Âú®ËøõË°åÊêúÁ¥¢TID‰∏∫2603ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇÂ¶ÇÂõæÔºö ÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™Á∫øÁ®ãÁä∂ÊÄÅ‰∏∫ÔºöWAITING„ÄÇÈÄöËøáÊü•ÁúãÊñá‰ª∂ÂàÜÊûê ÁúãÂà∞Â§ßÈáè Java Thread State„ÄÇ ËØ¥ÊòéÂÆÉÂú®Á≠âÂæÖÂè¶‰∏Ä‰∏™Êù°‰ª∂ÁöÑÂèëÁîüÔºåÊù•ÊääËá™Â∑±Âî§ÈÜíÔºåÊàñËÄÖÂπ≤ËÑÜÂÆÉÊòØË∞ÉÁî®‰∫Ü sleep(N)„ÄÇ Ê≠§Êó∂Á∫øÁ®ãÁä∂ÊÄÅÂ§ßËá¥‰∏∫‰ª•‰∏ãÂá†ÁßçÔºö java.lang.Thread.State: WAITING (parking)Ôºö‰∏ÄÁõ¥Á≠âÈÇ£‰∏™Êù°‰ª∂ÂèëÁîüÔºõ java.lang.Thread.State: TIMED_WAITING (parkingÊàñsleeping)ÔºöÂÆöÊó∂ÁöÑÔºåÈÇ£‰∏™Êù°‰ª∂‰∏çÂà∞Êù•Ôºå‰πüÂ∞ÜÂÆöÊó∂Âî§ÈÜíËá™Â∑±„ÄÇ 6.‰ª£Á†Å‰ºòÂåñÔºöÂ∞ÜÊñá‰ª∂ÂèëÈÄÅÁªôÂºÄÂèë„ÄÇ‰ºòÂåñ‰∏ãÁ∫øÁ®ã]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>ops</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[kubernetes‰πã‰ΩøÁî®minikubeÊú¨Âú∞ÈÉ®ÁΩ≤]]></title>
    <url>%2F2018%2F01%2F30%2Fkubernetes%E4%B9%8B%E4%BD%BF%E7%94%A8minikube%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%2F</url>
    <content type="text"><![CDATA[ÁõÆÂΩï kubernetes ‰ªãÁªç ÁéØÂ¢É„ÄÅËΩØ‰ª∂ÂáÜÂ§á kubectl ÂÆâË£Ö minikube ÂÆâË£Ö ÈÉ®ÁΩ≤ËøêË°åÂÆû‰æã 1„ÄÅkubernetes ‰ªãÁªç Kubernetes ÊòØ Google ÂºÄÊ∫êÁöÑÂÆπÂô®ÈõÜÁæ§ÁÆ°ÁêÜÁ≥ªÁªüÔºåÂÆÉÊûÑÂª∫Âú®ÁõÆÂâçÊµÅË°åÁöÑ Docker ÊäÄÊúØ‰πã‰∏äÔºå‰∏∫ÂÆπÂô®ÂåñÁöÑÂ∫îÁî®Êèê‰æõËµÑÊ∫êË∞ÉÂ∫¶„ÄÅÈÉ®ÁΩ≤ËøêË°å„ÄÅÊúçÂä°ÂèëÁé∞„ÄÅÊâ©ÂÆπÁº©ÂÆπÁ≠â‰∏ÄÊï¥Â•óÂäüËÉΩ„ÄÇËÄåÂ∞±Âú®Êó•Ââç DockerCon Ê¨ßÊ¥≤Â§ß‰ºö‰∏äÔºå Docker ÂÆ£Â∏ÉÊã•Êä±ÊîØÊåÅ KubernetesÔºåDocker ÂÖ¨Âè∏ËÆ°ÂàíÊèê‰æõ‰∏Ä‰∏™Êó†ÁºùÂπ≥Âè∞ÔºåÂêåÊó∂ÊîØÊåÅÂåÖÂê´ Swarm Âíå Kubernetes ÈõÜÁæ§ÁöÑÂºÇÊûÑÈÉ®ÁΩ≤„ÄÇminikube ÊòØ‰∏Ä‰∏™‰ΩøÊàë‰ª¨ÂæàÂÆπÊòìÂú®Êú¨Âú∞ËøêË°å kubernetes ÁöÑÂ∑•ÂÖ∑Ôºå‰ªñÊòØÈÄöËøáÂú®Êú¨Êú∫ VM ÈáåËøêË°å‰∏Ä‰∏™ÂçïËäÇÁÇπÈõÜÁæ§ÔºåÂ§ßÂ§ßÊñπ‰æøÂ≠¶‰π†Âíå‰ΩøÁî® kubernetes„ÄÇ 2„ÄÅÁéØÂ¢É„ÄÅËΩØ‰ª∂ÂáÜÂ§á Êú¨Ê¨°ÊºîÁ§∫ÁéØÂ¢ÉÔºåÊàëÊòØÂú®Êú¨Êú∫ MAC OS ‰ª•ÂèäËôöÊãüÊú∫ Linux Centos7 ‰∏äÊìç‰ΩúÔºå‰ª•‰∏ãÊòØÂÆâË£ÖÁöÑËΩØ‰ª∂ÂèäÁâàÊú¨Ôºö Docker: version 17.09.0-ce Oracle VirtualBox: version 5.1.20 r114628 (Qt5.6.2) Minikube: version v0.22.2 Kuberctl: Client Version: v1.8.1 Server Version: v1.7.5 Ê≥®ÊÑèÔºöMinikube ÂêØÂä®ÁöÑÂçïËäÇÁÇπ k8s Node ÂÆû‰æãÊòØÈúÄË¶ÅËøêË°åÂú®Êú¨Êú∫ÁöÑ VM ËôöÊãüÊú∫ÈáåÈù¢ÔºåÊâÄ‰ª•ÈúÄË¶ÅÊèêÂâçÂÆâË£ÖÂ•Ω VMÔºåËøôÈáåÊàëÈÄâÊã© Oracle VirtualBox„ÄÇk8s ËøêË°åÂ∫ïÂ±Ç‰ΩøÁî® Docker ÂÆπÂô®ÔºåÊâÄ‰ª•Êú¨Êú∫ÈúÄË¶ÅÂÆâË£ÖÂ•Ω Docker ÁéØÂ¢ÉÔºåËøôÈáåÂøΩÁï• Docker„ÄÅVirtualBox ÁöÑÂÆâË£ÖËøáÁ®ãÔºåÁùÄÈáç‰ªãÁªç‰∏ã Minikube Âíå Kuberctl ÁöÑÂÆâË£Ö„ÄÇ 3„ÄÅ kubectl ÂÆâË£Ö kubectl ÊòØ Kubernetes ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ËØ•Â∑•ÂÖ∑Êü•ÁúãÈõÜÁæ§ËµÑÊ∫êÔºåÂàõÂª∫„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§ÂêÑ‰∏™ÁªÑ‰ª∂Á≠âÁ≠âÔºåÂêåÊó∂Êèê‰æõ‰∫ÜÈùûÂ∏∏ËØ¶ÁªÜÁöÑ‰ΩøÁî®ÊñáÊ°£ÔºåÈùûÂ∏∏Êñπ‰æøÔºåÈÇ£Êàë‰ª¨Âú®Êú¨Êú∫ Mac ‰∏äÂÆâË£Ö‰∏Ä‰∏ã„ÄÇ ÂÆâË£ÖÊñπÂºèÊúâ‰∏§ÁßçÔºö ‰∏Ä„ÄÅÈÄöËøá curl ÂÆâË£Ö 12345678910111„ÄÅÂÆâË£ÖÊúÄÊñ∞Áâàcurl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/darwin/amd64/kubectl# ÂÆâË£ÖÊåáÂÆöÁâàÊú¨Ôºå‰æãÂ¶Ç v1.8.0curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.8.0/bin/darwin/amd64/kubectl2„ÄÅËµã‰∫åËøõÂà∂Êñá‰ª∂ÊâßË°åÊùÉÈôêchmod +x ./kubectl3„ÄÅÂ∞Ü‰∫åËøõÂà∂Êñá‰ª∂ÁßªÂà∞ PATH ‰∏≠sudo mv ./kubectl /usr/local/bin/kubectl1234567891011 ‰∫å„ÄÅÈÄöËøá Homebrew ÂÆâË£Ö 1brew install kubectl1 ÂÆâË£ÖÂÆåÊØïÂêéÔºåÊâßË°å kubectl version Êü•ÁúãÁâàÊú¨‰ª•ÂèäÊòØÂê¶ÂÆâË£ÖÊàêÂäü„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá kubectl help Êü•ÁúãËØ¥ÊòéÊñáÊ°£„ÄÇ 4„ÄÅminikube ÂÆâË£Ö minikube ÊòØ‰∏Ä‰∏™‰ΩøÊàë‰ª¨ÂæàÂÆπÊòìÂú®Êú¨Âú∞ËøêË°å kubernetes ÁöÑÂ∑•ÂÖ∑Ôºå‰ªñÊòØÈÄöËøáÂú®Êú¨Êú∫ VM ÈáåËøêË°å‰∏Ä‰∏™ÂçïËäÇÁÇπ kubernetes ÈõÜÁæ§ÔºåËøôÂØπ‰∫éÊñ∞ÊâãÊÉ≥‰∫ÜËß£ÂíåÂ≠¶‰π† kubernetes Êèê‰æõ‰∫ÜÂæàÂ§ßÁöÑÂ∏ÆÂä©„ÄÇÊâÄ‰ª•Âú®ÂÆâË£Ö minikube ‰πãÂâçÊàë‰ª¨ÈúÄË¶ÅÂú®Êú¨Êú∫ÂÖàÂÆâË£Ö VMÔºåËøôÈáåÊàëÈÄâÊã© VirtualBox ÂøΩÁï•ÂÆâË£ÖËøáÁ®ãÔºå‰ª•‰∏ãÊòØÂèØÈÄâ VM ÂàóË°®Ôºö OS X: xhyve driver, VirtualBox, VMware Fusion. Linux: VirtualBox, KVM Windows: VirtualBox, Hyper-V minikube ÁöÑÂÆâË£Ö‰πüÂæàÁÆÄÂçï„ÄÇ 1„ÄÅcurl ÊñπÂºèÂÆâË£Ö 12345OSX Á≥ªÁªüÔºöcurl -Lo minikube https://storage.googleapis.com/minikube/releases/v0.22.3/minikube-darwin-amd64 &amp;&amp; chmod +x minikube &amp;&amp; sudo mv minikube /usr/local/bin/Linux Á≥ªÁªüÔºöcurl -Lo minikube https://storage.googleapis.com/minikube/releases/v0.22.3/minikube-linux-amd64 &amp;&amp; chmod +x minikube &amp;&amp; sudo mv minikube /usr/local/bin/12345 2„ÄÅËã•‰∏äËæπÂú∞ÂùÄË¢´Â¢ô‰∫ÜÔºåÂèØ‰ª•Âéª GitHub ‰∏ä‰∏ãËΩΩÂÆâË£ÖÂåÖÔºåÂú®ÊâßË°å„ÄÇ ‰∏ãËΩΩÊúÄÊñ∞ÁâàÂÆâË£ÖÂåÖÔºåÂêÑÁ≥ªÁªüÂØπÂ∫îÂú∞ÂùÄÂ¶Ç‰∏ãÔºö minikube-darwin-amd64 minikube-linux-amd64 minikube-installer.exe ÁÑ∂ÂêéÊâßË°å chmod +x minikube &amp;&amp; sudo mv minikube /usr/local/bin/ÔºåÂç≥ÂèØÂÆåÊàêÂÆâË£Ö„ÄÇÂÆâË£ÖÂÆåÊØïÂêéÔºåÊâßË°å minikube version Êü•ÁúãÁâàÊú¨‰ª•ÂèäÊòØÂê¶ÂÆâË£ÖÊàêÂäü„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá minikube help Êü•ÁúãËØ¥ÊòéÊñáÊ°£„ÄÇ 5„ÄÅÈÉ®ÁΩ≤ËøêË°åÂÆû‰æã Â•Ω‰∫ÜÔºåÁéØÂ¢ÉÊàë‰ª¨Â∑≤ÁªèÂÆâË£ÖÂÆåÊØïÔºåÁé∞Âú®Êù•ÊºîÁ§∫ËøêË°å‰∏Ä‰∏™ÂÆû‰æãÔºåËøôÈáåÊàëÂ∑≤ tomcat ÈïúÂÉè‰∏∫‰æãÔºåÊºîÁ§∫ÈÉ®ÁΩ≤ÊúçÂä°ÔºåÂèëÂ∏ÉÊúçÂä°ÔºåÊâ©ÂÆπÁº©ÂÆπÊúçÂä°Á≠âÊìç‰Ωú„ÄÇ 123456789101112131415161718192021222324252627282930313233341„ÄÅÂàõÂª∫Âπ∂ÂêØÂä® minikube ËôöÊãüÊú∫$ minikube startStarting local Kubernetes cluster...Running pre-create checks...Creating machine...Starting local Kubernetes cluster...2„ÄÅÂàõÂª∫ hello-minikube ÈÉ®ÁΩ≤$ kubectl run hello-minikube --image=tomcat:8.0 --port=8080deployment "hello-minikube" created3„ÄÅÂèëÂ∏ÉÊúçÂä° hello-minikube$ kubectl expose deployment hello-minikube --type=NodePortservice "hello-minikube" exposed4„ÄÅÊü•Áúã pods$ kubectl get podsNAME READY STATUS RESTARTS AGEhello-minikube-598805112-3bzmf 1/1 ContainerCreating 0 5sÊ≥®ÊÑèÔºöÂàöÂºÄÂßãÊó∂Ôºåpod Ê≤°ÊúâÂÆåÂÖ®ÂàõÂª∫Â•ΩÁöÑÊó∂ÂÄôÔºåÁä∂ÊÄÅÊòØ ContainerCreatingÔºåÂΩìÈÉ®ÁΩ≤ÂÆåÊàêÂêéÔºåÁä∂ÊÄÅÂ∞±ÂèòÊàê Running„ÄÇ$ kubectl get podsNAME READY STATUS RESTARTS AGEhello-minikube-598805112-3bzmf 1/1 Running 0 25s5„ÄÅËé∑ÂèñÊúçÂä°Âú∞ÂùÄ$ minikube service hello-minikube --urlhttp://192.168.99.102:30724$ minikube service hello-minikube Â∞ÜÁõ¥Êé•ÊâìÂºÄÂú∞ÂùÄÂà∞ÈªòËÆ§ÊµèËßàÂô®‰∏ä„ÄÇ6„ÄÅÂÅúÊ≠¢ minikube ËôöÊãüÊú∫$ minikube stopStopping local Kubernetes cluster...Stopping "minikube"...12345678910111213141516171819202122232425262728293031323334 Ê≥®ÊÑèÔºöÂú®ÈÉ®ÁΩ≤ËøáÁ®ã‰∏≠ÂèØËÉΩ‰ºöÂá∫Áé∞ÈóÆÈ¢òÔºåÂ§ßÈÉ®ÂàÜË∑üÁΩëÁªúÁõ∏ÂÖ≥Ôºå‰∏ãËΩΩ images Êó∂‰ºöË∂ÖÊó∂Êä•ÈîôÔºåËß£ÂÜ≥ÂäûÊ≥ïÊòØ‰∏ÄÂÆâË£ÖÁøªÂ¢ôÂ∑•ÂÖ∑Ôºå‰∫åÊòØÊõø‰ª£ÈúÄË¶ÅÁøªÂ¢ô‰∏ãËΩΩÁöÑ images„ÄÇ‰ª•‰∏ãÊòØÊàëÊú¨Êú∫ÂÆûÈ™åÈÅáÂà∞ÁöÑÈóÆÈ¢òÔºå‰ª•ÂèäËß£ÂÜ≥ÊñπÊ≥ï„ÄÇ ÈóÆÈ¢ò‰∏ÄÔºöÂëΩ‰ª§Ë°å‰∏ãËΩΩ tomcat:8.0 ÈïúÂÉèÔºåÊâßË°å docker pull tomcat:8.0 Ê≤°Êúâ‰ªª‰ΩïÂèçÂ∫îÔºåÂàùÊ≠•ÂàÜÊûêÂèØËÉΩÊòØ minikube ËôöÊãüÊú∫ÈáåÊ≤°ÊúâËøûÊé•Âà∞Êú¨Âú∞ docker ÊúçÂä°„ÄÇ 12345$ minikube docker-envexport DOCKER_TLS_VERIFY="1"export DOCKER_HOST="tcp://192.168.99.102:2376"export DOCKER_CERT_PATH="/Users/wanyang3/.minikube/certs"export DOCKER_API_VERSION="1.23"12345 ÊâßË°å eval $(minikube docker-env)ÔºåÂç≥ËÆæÁΩÆ minikube ËôöÊãüÊú∫ÁöÑ docker ÁéØÂ¢ÉÂèòÈáèÂç≥ÂèØ„ÄÇ ÈóÆÈ¢ò‰∫åÔºöÊâßË°åÂÆåÊØï‰∏äËæπ 2 Âíå 3 Ê≠•È™§ÂêéÔºåÂèëÁé∞ hello-minikube ÊúçÂä°Âπ∂Ê≤°ÊúâÊàêÂäüÂêØÂä®„ÄÇ 123$ kubectl get podsNAME READY STATUS RESTARTS AGEhello-minikube-598805112-3bzmf 0/1 ContainerCreating 0 15s123 ÂèëÁé∞ hello-minikube ÁöÑÁä∂ÊÄÅ‰∏ÄÁõ¥ÊòØ ContainerCreatingÔºåÂπ∂‰∏î READY ‰∏∫ 0/1ÔºåÈÄöËøá minikube logs Êü•ÁúãÊó•ÂøóÂèØ‰ª•ÁúãÂá∫ÔºåÊúâ‰∏Ä‰∏™ÈïúÂÉè gcr.io/google_containers/pause-amd64:3.0 ÊòæÁ§∫ÊãâÂèñÂ§±Ë¥•ÔºåÂàÜÊûêÂéüÂõ†Â∫îËØ•ÊòØ gcr.io Ëøô‰∏™Âú∞ÂùÄË¢´Â¢ô‰∫Ü„ÄÇ 123456# ÊõøÊç¢ÈïúÂÉè$ docker pull visenzek8s/pause-amd64:3.0$ docker tag visenzek8s/pause-amd64:3.0 gcr.io/google_containers/pause-amd64:3.0# ÊòæÂºèËÆæÁΩÆÊãâÂèñÁ≠ñÁï•‰∏∫ IfNotPresent$ kubectl run hello-minikube --image=tomcat:8.0 --port=8080 --image-pull-policy=IfNotPresent 123456 ÊñπÊ°àÂ∞±ÊòØÊõøÊç¢ËØ•ÈïúÂÉèÔºåÁÑ∂ÂêéÂèØ‰ª•ËÆæÁΩÆÊãâÂèñÁ≠ñÁï•‰∏∫‰ºòÂÖàÊú¨Âú∞Ëé∑ÂèñÔºåÊú¨Âú∞Ê≤°ÊúâÂÜçÂéªËøúÁ®ãËé∑Âèñ„ÄÇÂõ†‰∏∫ËøôÈáåÊúçÂä°ÂêØÂä®Á≠ñÁï•‰∏∫ alwaysÔºå‰ºöÂÆöÊó∂Ëá™Âä®ÈáçÊñ∞ÊãâÂèñÔºåÊâÄ‰ª•‰∏ÄÊó¶Êú¨Âú∞ÊãâÂèñËØ•ÈïúÂÉèÂêéÔºåÊàë‰ª¨‰ºöÂèëÁé∞‰∏äËæπ hello-minikube ‰∏Ä‰ºöÂ∞±ÂêØÂä®ÊàêÂäü‰∫Ü„ÄÇ ‰∏ãËæπ‰ªãÁªç‰∏Ä‰∏ã kubectl ‰∏Ä‰∫õÂÖ∂‰ªñÂ∏∏Áî®Êìç‰Ωú„ÄÇ 1„ÄÅÂàõÂª∫ËµÑÊ∫êÁöÑ‰∏§ÁßçÊñπÂºè 1.1 ÈÄöËøá Yaml Êàñ Json Êñá‰ª∂ÂàõÂª∫ 12$ kubectl create -f &lt;file_path&gt;/xxx.yaml | &lt;file_path&gt;/xxx.json --[options]egÔºökubectl create -f ./redis.yaml12 ÁÆÄÂçïÁöÑ redis.yaml Á§∫‰æãÔºö 123456789101112131415161718192021222324252627282930313233apiVersion: extensions/v1beta1kind: Deploymentmetadata: name: hello-redis namespace: my-kubespec: replicas: 2 template: metadata: labels: group: hello-scm my-kube: hello-redis k8s-app: redis spec: containers: - name: redis image: redis:latest---apiVersion: v1kind: Servicemetadata: labels: group: hello-scm kubernetes.io/cluster-service: 'true' kubernetes.io/name: hello-redis name: hello-redis namespace: my-kubespec: ports: - port: 6379 targetPort: 6379 selector: k8s-app: redis123456789101112131415161718192021222324252627282930313233 yaml Êñá‰ª∂Ë¶ÅÁ¨¶Âêà kubernetes ÁöÑËßÑËåÉÔºåÂèØ‰ª•ÂèÇËÄÉÂÆòÁΩëÂØπ yaml ËØ≠Ê≥ïÂÆö‰πâÔºåÂèØ‰ª•Ëá™Â≠¶‰∏Ä‰∏ãÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄÊù•ËØ¥‰∫Ü„ÄÇ 1.2 ÊåáÂÆöÈïúÂÉèÂêØÂä® 12$ kubectl run --image=xxxx:xx --[options]eg: kubectl run hello-minikube --image=tomcat:8.0 --port=8080 12 2„ÄÅÂ§çÂà∂Â§ö‰∏™ÈÉ®ÁΩ≤ pod 12345678910$ kubectl scale --replicas=3 deployment/hello-minikubedeployment "hello-minikube" scaled$ kubectl get podsNAME READY STATUS RESTARTS AGEhello-minikube-598805112-3bzmf 1/1 Running 1 1dhello-minikube-598805112-vrskz 1/1 Running 1 1dhello-minikube-598805112-xwq55 1/1 Running 1 1d‰πüÂèØ‰ª•Âú®ÂêØÂä®Êó∂ÔºåÊåáÂÆöÂ§çÂà∂Êï∞Èáè$ kubectl run hello-minikube --image=tomcat:8.0 --port=8080 --replicas=312345678910 3„ÄÅÊö¥Èú≤ pod (po), service (svc), replicationcontroller (rc), deployment (deploy), replicaset (rs) ÊàêÊñ∞ÁöÑÊúçÂä° 123456789$ kubectl expose po | svc | rc | delpoy | rs --[options]egÔºökubectl expose deployment hello-minikube --type=NodePort # Êö¥Èú≤ÂêçÁß∞‰∏∫ hello-minikube ÈÉ®ÁΩ≤‰∏∫Á±ªÂûã‰∏∫ NodePort ÁöÑÊúçÂä°egÔºökubectl expose rc hello-nginx --port=80 --target-port=8000 --type=NodePort # Êö¥ÊºèÂêçÁß∞‰∏∫ nginx ÁöÑÂâØÊú¨‰∏∫ÊåáÂÆöÊúçÂä°Á´ØÂè£80ÔºåËøûÊé•ËØ•ÊúçÂä°Á´ØÂè£8000ÔºåÁ±ªÂûã‰∏∫ NodePort ÁöÑÊúçÂä°$ kubectl get serviceNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEhello-minikube NodePort 10.0.0.176 &lt;none&gt; 8080:30724/TCP 1dhello-nginx NodePort 10.0.0.94 &lt;none&gt; 80:8000/TCP 1dkubernetes ClusterIP 10.0.0.1 &lt;none&gt; 443/TCP 1d123456789 4„ÄÅÈáçÊñ∞Âä†ËΩΩÊüê‰∏™ËµÑÊ∫ê 12$ kubectl apply -f &lt;file_path&gt;/xxx.yaml | &lt;file_path&gt;/xxx.json --[options]egÔºökubectl apply -f ./redis.yaml12 5„ÄÅÊü•Áúã pod, service, replicationcontroller, deployment, replicaset ÂêÑÁßçÁ±ªÂûãËµÑÊ∫ê‰ø°ÊÅØÂàóË°® 12$ kubectl get po | svc | rc | deploy | rs # Êü•ÁúãÈªòËÆ§ namespace ‰∏ãÂêÑÁ±ªÂûãËµÑÊ∫ê‰ø°ÊÅØÂàóË°®$ kubectl get po | svc | rc | deploy | rs --all-namespaces # Êü•ÁúãÊâÄÊúâ namespace ‰∏ãÂêÑÁ±ªÂûãËµÑÊ∫ê‰ø°ÊÅØÂàóË°®12 6„ÄÅÊü•Áúã pod, service, replicationcontroller, deployment, replicaset ÂêÑÁßçÁ±ªÂûãËµÑÊ∫êÊó•Âøó‰ø°ÊÅØÊàñÊèèËø∞‰ø°ÊÅØ 12345678$ kubectl logs &lt;resource_type&gt;/&lt;resource_name&gt; [options]egÔºökubectl logs -f po/hello-minikube-598805112-3bzmf # Êü•ÁúãÊåáÂÆö pod ÁöÑÊó•ÂøóegÔºökubectl logs deploy/hello-nginx -n my-kube # Êü•ÁúãÊåáÂÆö delpoy Âíå namespace ÁöÑÊó•Âøó$ kubectl describe &lt;resource_type&gt;/&lt;resource_name&gt; [options]egÔºökubectl describe pods # Êü•ÁúãÊâÄÊúâ pod ÁöÑÊèèËø∞‰ø°ÊÅØegÔºökubectl describe po/hello-minikube-598805112-3bzmf # Êü•ÁúãÊåáÂÆö pod ÁöÑÊèèËø∞‰ø°ÊÅØegÔºökubectl describe deploy/hello-nginx -n my-kube # Êü•ÁúãÊåáÂÆö delpoy Âíå namespace ÁöÑÊèèËø∞‰ø°ÊÅØ12345678 7„ÄÅÊü•ÁúãÈõÜÁæ§‰ø°ÊÅØ 12$ kubectl cluster-infoKubernetes master is running at https://192.168.99.102:844312 Â•Ω‰∫ÜÔºåÂÖà‰ªãÁªçËøô‰πàÂ§öÔºå‰∏ã‰∏ÄÁØáÁªßÁª≠‰ªãÁªç‰∏ãÈÄöËøá minikube ÂÆâË£Ö Kubernetes Dashboard Âπ∂ÈõÜÊàê Heapster Êèí‰ª∂„ÄÇ ÂèÇËÄÉËµÑÊñô Running Kubernetes Locally via Minikube Install Minikube Install and Set Up kubectl github minikube]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[dockerËøêÁª¥‰∏ékubernatesÂÆûÊàò]]></title>
    <url>%2F2018%2F01%2F27%2Fdocker%E8%BF%90%E7%BB%B4%E4%B8%8Ekubernates%E5%AE%9E%E6%88%98%2F</url>
    <content type="text"><![CDATA[dockerÂèÇËÄÉ ÂÆòÊñπÊñáÊ°£ https://docs.docker.com https://docs.docker.com/docker-for-mac/#explore-the-application-and-run-examples ‰∏≠ÊñáÈïúÂÉèÈÖçÁΩÆ1. ‰∏ãËΩΩDocker for Mac„ÄÇ ÂÆòÊñπ‰∏ãËΩΩÈìæÊé•Ôºöhttps://download.docker.com/mac/stable/Docker.dmg 2. ÂÆâË£ÖDocker for MacÂπ∂ÂêØÂä®„ÄÇ 3. Ê£ÄÊü•ÁâàÊú¨‰ø°ÊÅØ„ÄÇ 1$ docker --version1 ÈÖçÁΩÆ ËøõÂÖ•ÈòøÈáå‰∫ëÂÆπÂô®HubÊúçÂä°ÁöÑÊéßÂà∂Âè∞ÔºåÂπ∂Áî≥ËØ∑Êàê‰∏∫ÂºÄÂèëËÄÖ„ÄÇ ÁÇπÂáªÂ∑¶‰æßÁöÑÂä†ÈÄüÂô®Â∏ÆÂä©È°µÈù¢Â∞±‰ºöÊòæÁ§∫ÊÇ®ÁöÑ‰∏ìÂ±ûÂä†ÈÄüÂô®Âú∞ÂùÄ„ÄÇ Â§çÂà∂Âú∞ÂùÄÊÇ®ÁöÑ‰∏ìÂ±ûÂä†ÈÄüÂô®Âú∞ÂùÄÔºåÂ∞ÜÂú∞ÂùÄÂ°´ÂÖ•DockerÁöÑÈÖçÁΩÆ‰∏≠ÔºåË∑ØÂæÑÂ¶Ç‰∏ãÔºöPreferences‚Äì&gt;Daemon‚Äì&gt;Basic‚Äì&gt;Registry mirrorsÔºåÁÑ∂ÂêéÈáçÂêØ„ÄÇ Á°ÆËÆ§DockerÊòØÂê¶ÂÆâË£ÖÊàêÂäü 1docker run hello-world ÂëΩ‰ª§ÈïúÂÉèÂëΩ‰ª§123456789101112131415161718192021222324252627282930313233# ‰ø°ÊÅØdocker info# ÁâàÊú¨docker version# Â∏ÆÂä©ÔºåÈÄöËøáÂ∏ÆÂä©ÂëΩ‰ª§Â≠¶‰π†ÂÖ∂‰ªñÂëΩ‰ª§docker --helpdocker COMMAND --help# Êü•ÁúãÈïúÂÉèÂàóË°®, -aÊâÄÊúâ‰ø°ÊÅØÔºå -qÈùôÈªò‰ø°ÊÅØÔºå --digestsÊëòË¶Å‰ø°ÊÅØdocker images#ÊêúÁ¥¢ÈïúÂÉè -s 10 Ê†áÊòüÊï∞docker search nginx#‰∏ãËΩΩÈïúÂÉèdocker pull nginx#Âà†Èô§ÈïúÂÉèdocker rmi nginx:latest#Âà†Èô§Ê≠£Âú®ËøêË°åÁöÑÈïúÂÉèdocker rmi $&#123;docker ps&#125;#Âà†Èô§ÂÖ®ÈÉ®ÈïúÂÉèdocker rmi -f $(docker images -q)docker run -d -p 80:80 --name webserver nginxdocker stop webserverdocker start webserverdocker ps -a#Âà†Èô§ÂÆπÂô® stop and remove the running containerdocker rm -f webserver ÂÆπÂô®ÂëΩ‰ª§1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#Êñ∞Âª∫Âπ∂ÂêØÂä®ÂÆπÂô® #options:(-dÂêéÂè∞ËøêË°å -i‰∫§‰∫íÊñπÂºè -tÂêØÂä®‰∏∫ÁªàÁ´Ø)#options:(-pÊåáÂÆöÁ´ØÂè£(ÂÆø‰∏ªÊú∫:ÂÆπÂô®)Êò†Â∞Ñ -PÈöèÊú∫Á´ØÂè£Êò†Â∞Ñ)#options:(--name ‰∏∫ÂÆπÂô®ÊåáÂÆöÂêçÁß∞)#options:(-v Êï∞ÊçÆÂç∑ÊåÇËΩΩ)docker run [OPTIONS] IMAGE [COMMAND] [ARG...]docker run -it ee48881b3e82docker run -d -p 7777:8080 --name mytomcat ee48881b3e82docker run -d -p 8888:8080 --name tomcat-docs2 tomcat2:2.0docker run -it -v ~/mydata:/datacontainer centos#ÂàóÂá∫ÂÆπÂô®Ôºà-lÊúÄËøë‰∏ÄÊ¨° -n 3ÊúÄËøënÊ¨° -aÂÖ®ÈÉ®Ôºâdocker psdocker ps -n 3#Êü•ÁúãÊó•ÂøóÔºåÊéíÊü•ÈîôËØØdocker logs [OPTIONS] CONTAINER [flags]#ÈÄÄÂá∫Âπ∂ÂÅúÊ≠¢ÂÆπÂô®exit#ÈÄÄÂá∫‰∏çÂÅúÊ≠¢ÂÆπÂô®ctrl + p + q#ÂêØÂä®ÂÆπÂô®docker start [OPTIONS] CONTAINER [CONTAINER...]docker start e5fbd89ce11b#ÈáçÂêØÂÆπÂô®docker restart [OPTIONS] CONTAINER [CONTAINER...]#ÂÅúÊ≠¢ÂÆπÂô®docker stop ÂÆπÂô®id ÊàñÂÆπÂô®ÂêçÁß∞#Âº∫Âà∂ÂÅúÊ≠¢ÂÆπÂô®docker kill ÂÆπÂô®id ÊàñÂÆπÂô®ÂêçÁß∞#Âà†Èô§ÂÆπÂô®docker rm ÂÆπÂô®id#Âà†Èô§Â§ö‰∏™ÂÆπÂô®docker rm -f $(docker ps -a -q)#ÂèØÂèòÂèÇÊï∞Âà†Èô§docker ps -a -q | xargs docker rm#ËøõÂÖ•ÂÆπÂô®Ôºå‰∏ç‰∫ßÁîüÊñ∞ÁöÑËøõÁ®ãdocker attach [OPTIONS] CONTAINER#ÂÆπÂô®‰∏≠ÊâßË°åÂëΩ‰ª§docker exec [OPTIONS] CONTAINER COMMAND [ARG...]docker exec -it 7220e09b7c04 /bin/bash#‰ªéÂÆπÂô®‰∏≠ÂàõÂª∫ÈïúÂÉè,OPTIONS:(-a‰ΩúËÄÖ -mÊ∂àÊÅØ)docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]docker commit -a="xiaowu" -m="hello,world" 98696deb2879 "tomcat2:2.0"#Êñá‰ª∂Â§çÂà∂Ôºå‰ªéÂÆπÂô®Âà∞ÂÆø‰∏ªÊú∫docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATHdocker cp 2b8b669f4f45:/usr/local/tomcat/CONTRIBUTING.md ~/test/#Êñá‰ª∂Â§çÂà∂Ôºå‰ªéÂÆø‰∏ªÊú∫Âà∞ÂÆπÂô®docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH dockerÊï∞ÊçÆÂç∑ÊØîÂñªÔºöUÁõòÂ∞±ÊòØÊï∞ÊçÆÂç∑ Áî®ÈÄî Êï∞ÊçÆÊåÅ‰πÖÂåñ ÂÆπÂô®Èó¥ÂÖ±‰∫´Êï∞ÊçÆ 1docker run -it -v ~/mydata:/datacontainer centos Êï∞ÊçÆÂÆπÂô®Âç∑ ÈÄöËøáÂÆπÂô®ÊåÇËΩΩÊï∞ÊçÆÂç∑ Âè™Ë¶ÅÊúâ‰∏Ä‰∏™ÂÆπÂô®Âú®‰ΩøÁî®Êï∞ÊçÆÂç∑ÔºåÂ∞±‰∏ç‰ºöÂõûÊî∂ 1docker run -it --name n1 --volumes-from distracted_galileo centos Dockerfile Áî®Êù•ÊûÑÂª∫ÈïúÂÉèÁöÑÊûÑÂª∫Êñá‰ª∂ docker hub ÊêúÁ¥¢ÔºåÊü•ÁúãDockerfileÊñá‰ª∂ ÂèÇËÄÉ https://github.com/docker-library/tomcat/blob/7cdbab2ce07c1593fc657fd6fac7821a5472dfd2/9.0/jdk8/openjdk/Dockerfile 123456789FROM ÂΩìÂâçÊñ∞ÈïúÂÉèÂü∫‰∫éÂì™‰∏™ÈïúÂÉèCONTAINER Áª¥Êä§ËÄÖRUN ÈïúÂÉèÊûÑÂª∫Êó∂ÈúÄË¶ÅËøêË°åÁöÑÂëΩ‰ª§WORKDIR Â∑•‰ΩúÁõÆÂΩïEXPOSE ÂΩìÂâçÂÆπÂô®ÂØπÂ§ñÊö¥Èú≤ÁöÑÁ´ØÂè£ENV ÁéØÂ¢ÉÂèòÈáèADD ÂÆø‰∏ªÊú∫ÁöÑÊñá‰ª∂copyÂà∞ÈïúÂÉèÔºå‰ºöËá™Âä®Ëß£ÂéãCOPY Â§çÂà∂COLUME ÂÆπÂô®Êï∞ÊçÆÂç∑ÔºåÁî®‰∫é‰øùÂ≠òÂíåÊåÅ‰πÖÂåñ CMD CMD ÊåáÂÆöÂÆπÂô®ÂêØÂä®ËøáÁ®ã‰∏≠ÔºåËøêË°åÁöÑÂëΩ‰ª§ ÂùëÔºöÂ§öÊù°CMDÂè™ÊúâÊúÄÂêé‰∏ÄÊù°ÁîüÊïà„ÄÇCMDÂëΩ‰ª§‰ºöË¢´docker run ‰πãÂêéÁöÑÂèÇÊï∞ÊõøÊç¢„ÄÇ ENTRYPOINT ‰ºöÊäädocker run ÂëΩ‰ª§ÁöÑÂèÇÊï∞ËøΩÂä†Âà∞ÂêéÈù¢ tomcat9Ê°à‰æã Dockerfile 123456789101112131415161718192021FROM centosMAINTAINER xiaowu&lt;zhouxiaowu.12345@163.com&gt;COPY test.txt /usr/local/testincontainer.txtADD apache-tomcat-9.0.24.tar.gz /usr/local/ADD jre-8u201-linux-x64.tar.gz /usr/local/RUN yum -y install vimENV MYPATH /usr/localWORKDIR $MYPATHENV JAVA_HOME /usr/local/jre1.8.0_201ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jarENV CATALINA_HOME /usr/local/apache-tomcat-9.0.24ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.24ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/binEXPOSE 8080CMD /usr/local/apache-tomcat-9.0.24/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.24/logs/catalina.out ÊûÑÂª∫ÈïúÂÉè 12docker build [OPTIONS] PATH | URL | -docker build -f Dockerfile -t mytomcat9 . ÂêØÂä®ÂÆπÂô® 1234docker run -d -p 9092:8080 --name mytomcat92 \-v /Users/zhouxiaowu/Dropbox/Dockerfile/tomcat/app1:/usr/local/apache-tomcat-9.0.24/webapps/app1 \-v /Users/zhouxiaowu/Dropbox/Dockerfile/tomcat/logs:/usr/local/apache-tomcat-9.0.24/webapps/logs \mytomcat9 ÂéüÁêÜdockerÊ≤°ÊúâÂÜÖÊ†∏Ôºå‰∫§ÁªôÂÆø‰∏ªÊú∫ docker‰ΩìÁ≥ªÊû∂ÊûÑCS docker Server reset client Êï∞ÊçÆÂç∑ network ÈïúÂÉè rootfs Êñá‰ª∂ÂíåÂÖÉÊï∞ÊçÆÁöÑÈõÜÂêà ÂàÜÂ±ÇÁöÑÊñá‰ª∂Á≥ªÁªü ÂêåÂ±ÇÂÖ±‰∫´ kernel -&gt; centos -&gt; jdk -&gt; tomcat quick startdocker container12345678910111213141516docker build -t friendlyhello . # Create image using this directory's Dockerfiledocker run -p 4000:80 friendlyhello # Run "friendlyname" mapping port 4000 to 80docker run -d -p 4000:80 friendlyhello # Same thing, but in detached modedocker container ls # List all running containersdocker container ls -a # List all containers, even those not runningdocker container stop &lt;hash&gt; # Gracefully stop the specified containerdocker container kill &lt;hash&gt; # Force shutdown of the specified containerdocker container rm &lt;hash&gt; # Remove specified container from this machinedocker container rm $(docker container ls -a -q) # Remove all containersdocker image ls -a # List all images on this machinedocker image rm &lt;image id&gt; # Remove specified image from this machinedocker image rm $(docker image ls -a -q) # Remove all images from this machinedocker login # Log in this CLI session using your Docker credentialsdocker tag &lt;image&gt; username/repository:tag # Tag &lt;image&gt; for upload to registrydocker push username/repository:tag # Upload tagged image to registrydocker run username/repository:tag # Run image from a registry docker service12345678docker stack ls # List stacks or appsdocker stack deploy -c &lt;composefile&gt; &lt;appname&gt; # Run the specified Compose filedocker service ls # List running services associated with an appdocker service ps &lt;service&gt; # List tasks associated with an appdocker inspect &lt;task or container&gt; # Inspect task or containerdocker container ls -q # List container IDsdocker stack rm &lt;appname&gt; # Tear down an applicationdocker swarm leave --force # Take down a single node swarm from the manager ÈúÄË¶Åhttps://api.github.com/repos/boot2docker/boot2docker/releases/latest ‰∏ãËΩΩÔºå‚Äùhtml_url‚Äù: ‚Äúhttps://github.com/boot2docker/boot2docker/releases/tag/v17.07.0-ce‚Äú swarmÈõÜÁæ§1234567891011121314151617181920212223242526272829docker-machine create --virtualbox-boot2docker-url ~/.docker/machine/cache/boot2docker.iso manager1mv boot2docker.iso /Users/zhouxiaowu/.docker/machine/cache/docker-machine create --virtualbox-boot2docker-url ~/.docker/machine/cache/boot2docker.iso myvm1docker-machine create --virtualbox-boot2docker-url ~/.docker/machine/cache/boot2docker.iso myvm210513 docker-machine ssh myvm1 "docker swarm init --advertise-addr 192.168.99.101"10514 docker-machine ls10515 docker-machine ssh myvm2 " docker swarm join --token SWMTKN-1-13x2fyyubrz6b0k0p86bpt0rjydu59ze8a7g4q6n4yn1aip7so-96zlikwtz3h7mmpa18ilu0i6g 192.168.99.101:2377"10516 docker-machine ssh myvm1 "docker node ls"10520 docker-machine env myvm110521 eval $(docker-machine env myvm1)10526 docker stack deploy -c docker-compose.yml getstartedlab10527 docker stack ls10529 docker stack ps getstartedlab10530 docker container ls10569 docker stack ls10570 docker stack rm getstartedlab10571 docker-machine env -u10572 eval $(docker-machine env -u) Á¨îËÆ∞1234567891011find namelsoflsof -p 2951viewulimit -n 1000cd var/logminikube logs &gt;aavim aakubectl get pods --all-namespaces minikubeÂëΩ‰ª§1234#ÂêØÂä®ËôöÊãüÊú∫minikube startminikube stop k8sÂëΩ‰ª§123456789101112131415161718192021222324252627282930kubectl podkubectl get podkubectl get pod XXX &gt; aavim aakubectl get pod hello-minikube-5df766f774-ws8fk -o yamlkubectl edit pod hello-minikube-5df766f774-ws8fkkubectl describe pod XXX //ÁªìÂêàpodÂíåeventkubectl get eventkubectl get serviceskubectl get services hello-minikube -o yamlkubectl get rskubectl describe rskubectl config rename-context mini minikube2kubectl create -f ./**.yaml -f ***.yamlwget https://.../k8s.tar.gzexample guestbooksudo docker imagesfront-images Êç¢Êàênginx 12345678910111213141516171819202122232425262728293031323334353637383940414243444546471 api service „ÄÅ2etcd Ê≠• create_timestamp3 schedule -&gt; api service6 ÂêØÂä®docker1. 3 node 1node down load balancer -&gt; api server ÂàÜÂèëÂà∞Âè¶Â§ñ‰∏§Âè∞ etcd2. scheduler/CM Ê≠ªÁöÑnode‰∏ªÔºåÈúÄË¶ÅÈÄâ‰∏æ3. kubelet sysmtem ËøõÁ®ãÊ≠ªÊéâËá™Âä®ÊãâËµ∑vimdiff aa bbkubectl get rskubectl get deployment##Êâ©ÂÆπÊàñÁº©ÂÆπkubectl scale --replicas=2 deployment/frontendsudo docker run XXXkubectl get pod --all-name-spacekubectl logs xxx##ÂØªÂèñÂ∏ÆÂä©kubectl logs -h## busyboxÁªàÁ´Økubectl run -i --tty busyboxkubectl attach XXX -ikubectl top podkubectl delete deployment XXXkubectl delete pod XXXÁî®‰∫éÊü•Èîôskubectl cluster-info dump --out-directory=tmp k8s ÂÆâË£Ödocker https://docs.docker.com/install/linux/docker-ce/ubuntu/ ‰ªégithub‰∏ä‰∏ãËΩΩminikube‰∫åËøõÂà∂ https://github.com/kubernetes/minikube/releases Â¢ôÂÜÖÂÆâË£Ökubectl https://www.kubernetes.org.cn/installkubectl 123bin dpkg-deb -x kubelet.deb tmpcd tmpcp ./usr/bin/kubectl /usr/local/bin ÂêØÂä®minikubeÔºåÁªïËøágcr.io‰∏ãÊó†Ê≥ï‰∏ãËΩΩÈïúÂÉèÁöÑÈóÆÈ¢ò ÔÅÆ ËßÇÂØüÊó•Âøó/var/lib/localkube/*.err ÔÅÆ docker pull kubernetes/pause ÔÅÆ docker pull grrywlsn/kubernetes-addon-manager:v1.8.0 Kubectl„ÄÅKubeadmÂõΩÂÜÖ‰∏ãËΩΩÂú∞ÂùÄÔºö https://mirrors.ustc.edu.cn/kubernetes/apt/pool/ ÂÆâË£ÖÂíåËÆæÁΩÆkubectl https://www.kubernetes.org.cn/installkubectl Kubectl ÂÆ¢Êà∑Á´ØÁöÑ‰∏ãËΩΩÂíåÈÖçÁΩÆhttp://blog.csdn.net/csdn_duomaomao/article/details/76159874]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[mybatis‰∏≠#Âíå$ÁöÑÂå∫Âà´]]></title>
    <url>%2F2018%2F01%2F15%2Fmybatis%E4%B8%AD-%E5%92%8C-%E7%9A%84%E5%8C%BA%E5%88%AB%2F</url>
    <content type="text"><![CDATA[‰ªäÂ§©Âú®Â∑•‰Ωú‰∏≠Êúâ‰∏™ÁÇπÂáªÊéíÂ∫èÁöÑÂäüËÉΩË∞ÉËØï‰∫ÜËÆ∏‰πÖÔºåÁªàÂØªÂõ†ÔºåÊÄªÁªì‰πã„ÄÇ ÈúÄÊ±ÇÊòØËøôÊ†∑ÁöÑÔºåÈ°µÈù¢Êúâ‰∏™tableÔºåÊúâ‰∏ÄÂàóÁöÑ‰∏ä‰∏ãÁÆ≠Â§¥ÂèØÁÇπÂáªÂπ∂ÊéíÂ∫è„ÄÇÂØπ‰∫éËøôÁßçÈúÄÊ±ÇÔºåÊàëÁöÑmybatis.xmlÁöÑsqlÈÖçÁΩÆÂÜôÊàê‰∫ÜÂ¶Ç‰∏ãÔºö ORDER BY columnName #{map.ColumnNameSort} ColumnNameSortÂç≥ÂâçÁ´Ø‰º†ÁöÑÊéíÂ∫èÊñπÂºèÔºåascÊàñËÄÖdesc„ÄÇ ÁÑ∂ÂêéÔºåÈ¢ÑËÆ°ÂÆÉÁöÑËæìÂá∫Â∫îËØ•ÊòØÁ±ª‰ºº‰∫é‰∏ãÈù¢ËøôÊ†∑ÁöÑ ORDER BY columnName desc ‰ΩÜÊòØÔºåÁúüÊ≠£Ë∑ëËµ∑Êù•Êó∂ÔºåÊéíÂ∫èÁöÑÊïàÊûú‰∏ÄÁõ¥Ê≤°Âá∫Áé∞ÔºåÁªèÂ∏∏‰∏ÄÁï™Êü•ÊâæÔºåÂèëÁé∞ÊòØmybatis ÁöÑ‚Äô#{}‚Äô‰º†ÂÄºÁöÑÈóÆÈ¢òÔºåÂÆÉÂ∞ÜsqlËØ≠Âè•ÁºñËØëÊàê‰∫ÜÂ¶Ç‰∏ã ORDER BY columnName ‚Äòdesc‚Äô ÊàñËÄÖ ORDER BY columnName ‚Äòasc‚Äô ËøôÊ†∑ÔºådescÊàñËÄÖascÂ∞±Êàê‰∫ÜÂ≠óÁ¨¶‰∏≤ËÄå‰∏çÊòØÂÖ≥ÈîÆÂ≠óÔºåsqlËØ≠Âè•ÁöÑÊÑèÊÄùÊòØcolumnNameÁöÑÂà´ÂêçÊòØdescÊàñËÄÖascÔºåÊ≤°Âä†ÊéíÂ∫èÂÖ≥ÈîÆÂ≠óÊó∂ÈªòËÆ§ÊòØÊ≠£Â∫èÊéíÂ∫èÔºåÊàê‰∫ÜÂ¶Ç‰∏ã ORDER BY columnName ‚Äúdesc‚Äù asc ÊàñËÄÖ ORDER BY columnName ‚Äúasc‚Äù asc ÊéíÂ∫èÊ≤°ÊïàÊûúÁöÑÈóÆÈ¢òÊâæÂà∞ÂéüÂõ†‰∫ÜÔºåËß£ÂÜ≥‰πãÔºåmybatisÊèê‰æõ‰∫ÜÂè¶‰∏ÄÁßçÁªëÂÆöÂèÇÊï∞ÁöÑÊñπÂºè‚Äì${param}ÔºåÂ∞ÜsqlÈÖçÁΩÆÊîπ‰∏∫ ORDER BY columnName ${map.ColumnNameSort} ËøôÊ†∑‰∏ÄÊù•Ôºåmybatis‰ºöÁõ¥Êé•Â∞ÜColumnNameSortÁöÑÂÄºÂä†ÂÖ•sql‰∏≠Ôºå‰∏ç‰ºöËΩ¨‰πâ„ÄÇÊ≠£Á°ÆÁªìÊûúÔºö ORDER BY columnName desc ÊúÄÂêéÔºåÂØπ‰∫émybatis‰∏≠#Âíå$ÁªëÂÆöÂèÇÊï∞ÁöÑÂå∫Âà´ÂÅö‰∏™ÊÄªÁªìÔºåÈÅøÂÖç‰ª•ÂêéÁ±ª‰ººÁöÑÈóÆÈ¢òÂèëÁîü„ÄÇ ÔºÉ{}Â∞Ü‰º†ÂÖ•ÁöÑÊï∞ÊçÆÈÉΩÂΩìÊàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºå‰ºöÂØπËá™Âä®‰º†ÂÖ•ÁöÑÊï∞ÊçÆÂä†‰∏Ä‰∏™ÂèåÂºïÂè∑„ÄÇÂ¶ÇÔºöorder by #{id}ÔºåÂ¶ÇÊûú‰º†ÂÖ•ÁöÑÂÄºÊòØ111,ÈÇ£‰πàËß£ÊûêÊàêsqlÊó∂ÁöÑÂÄº‰∏∫order by ‚Äú111‚Äù, Â¶ÇÊûú‰º†ÂÖ•ÁöÑÂÄºÊòØidÔºåÂàôËß£ÊûêÊàêÁöÑsql‰∏∫order by ‚Äúid‚Äù„ÄÇ ${}Â∞Ü‰º†ÂÖ•ÁöÑÊï∞ÊçÆÁõ¥Êé•ÊòæÁ§∫ÁîüÊàêÂú®sql‰∏≠„ÄÇÂ¶ÇÔºöorder by ${id}ÔºåÂ¶ÇÊûú‰º†ÂÖ•ÁöÑÂÄºÊòØ111,ÈÇ£‰πàËß£ÊûêÊàêsqlÊó∂ÁöÑÂÄº‰∏∫order by 111, Â¶ÇÊûú‰º†ÂÖ•ÁöÑÂÄºÊòØidÔºåÂàôËß£ÊûêÊàêÁöÑsql‰∏∫order by id„ÄÇ ‚Äò#‚ÄôÊñπÂºè ËÉΩÂ§üÂæàÂ§ßÁ®ãÂ∫¶Èò≤Ê≠¢sqlÊ≥®ÂÖ•„ÄÇ $ÊñπÂºèÊó†Ê≥ïÈò≤Ê≠¢SqlÊ≥®ÂÖ•„ÄÇ $ÊñπÂºè‰∏ÄËà¨Áî®‰∫é‰º†ÂÖ•Êï∞ÊçÆÂ∫ìÂØπË±°Ôºå‰æãÂ¶Ç‰º†ÂÖ•Ë°®Âêç. ‰∏ÄËà¨ËÉΩÁî®#ÁöÑÂ∞±Âà´Áî®$. ps:Âú®‰ΩøÁî®mybatis‰∏≠ËøòÈÅáÂà∞&lt;![CDATA[]]&gt;ÁöÑÁî®Ê≥ïÔºåÂú®ËØ•Á¨¶Âè∑ÂÜÖÁöÑËØ≠Âè•ÔºåÂ∞Ü‰∏ç‰ºöË¢´ÂΩìÊàêÂ≠óÁ¨¶‰∏≤Êù•Â§ÑÁêÜÔºåËÄåÊòØÁõ¥Êé•ÂΩìÊàêsqlËØ≠Âè•ÔºåÊØîÂ¶ÇË¶ÅÊâßË°å‰∏Ä‰∏™Â≠òÂÇ®ËøáÁ®ã„ÄÇ]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mysql update‰ΩøÁî®Â≠êÊü•ËØ¢]]></title>
    <url>%2F2018%2F01%2F11%2FMysql-update%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2%2F</url>
    <content type="text"><![CDATA[‰ªäÂ§©ÊàëÂÉè‰ª•ÂâçÊìç‰ΩúOracleÂÜô‰∫Ü‰∏Ä‰∏™update sql: 12update device_user a set a.scene_id=nullwhere a.id not in(select min(t.id) from device_user t group by t.device_id);12 Ê†πÊçÆÂ≠êÊü•ËØ¢ÁöÑÁªìÊûúÔºåÊõ¥Êñ∞Ë°®‰∏≠ÁöÑ‰∏Ä‰∏™Â≠óÊÆµ„ÄÇ Âú®mysqlÊï∞ÊçÆÂ∫ì‰∏≠ÊâßË°åÂêéÊä•ÈîôÔºö 12Error Code: 1093. You can't specify target table 'a' for update in FROM clause12 ‰∏ÄÁõ¥Ê≤°ÂºÑÊòéÁôΩËøô‰∏™ÈîôËØØÔºåÁÑ∂ÂêéÁªèËøáÂ§öÊ¨°Â∫¶Â®òÂêéÔºåÂèëÁé∞mysql updateÊó∂ÔºåÊõ¥Êñ∞ÁöÑË°®‰∏çËÉΩÂú®setÂíåwhere‰∏≠Áî®‰∫éÂ≠êÊü•ËØ¢„ÄÇ ‰øÆÊîπ‰∏äÈù¢ÁöÑsql‰∏∫mysqlÊï∞ÊçÆÂ∫ìÊîØÊåÅÁöÑÊñπÂºèÔºö 1234update device_user du,(select id from device_user where id not in(select min(t.id) from device_user t group by t.device_id)) bset du.scene_id=nullwhere du.id=b.id;]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JVMÂ†ÜÂÜÖÂ≠òÂíåÈùûÂ†ÜÂÜÖÂ≠ò]]></title>
    <url>%2F2018%2F01%2F02%2FJVM%E5%A0%86%E5%86%85%E5%AD%98%E5%92%8C%E9%9D%9E%E5%A0%86%E5%86%85%E5%AD%98%2F</url>
    <content type="text"><![CDATA[Â†ÜÂíåÈùûÂ†ÜÂÜÖÂ≠ò ÊåâÁÖßÂÆòÊñπÁöÑËØ¥Ê≥ïÔºö‚ÄúJava ËôöÊãüÊú∫ÂÖ∑Êúâ‰∏Ä‰∏™Â†Ü(Heap)ÔºåÂ†ÜÊòØËøêË°åÊó∂Êï∞ÊçÆÂå∫ÂüüÔºåÊâÄÊúâÁ±ªÂÆû‰æãÂíåÊï∞ÁªÑÁöÑÂÜÖÂ≠òÂùá‰ªéÊ≠§Â§ÑÂàÜÈÖç„ÄÇÂ†ÜÊòØÂú® Java ËôöÊãüÊú∫ÂêØÂä®Êó∂ÂàõÂª∫ÁöÑ„ÄÇ‚Äù‚ÄúÂú®JVM‰∏≠Â†Ü‰πãÂ§ñÁöÑÂÜÖÂ≠òÁß∞‰∏∫ÈùûÂ†ÜÂÜÖÂ≠ò(Non-heap memory)‚Äù„ÄÇ JVM‰∏ªË¶ÅÁÆ°ÁêÜ‰∏§ÁßçÁ±ªÂûãÁöÑÂÜÖÂ≠òÔºöÂ†ÜÂíåÈùûÂ†Ü„ÄÇ Heap memory Code Cache Eden Space Survivor Space Tenured Gen non-heap memory Perm Gen native heap?(I guess) Â†ÜÂÜÖÂ≠ò Java ËôöÊãüÊú∫ÂÖ∑Êúâ‰∏Ä‰∏™Â†ÜÔºåÂ†ÜÊòØËøêË°åÊó∂Êï∞ÊçÆÂå∫ÂüüÔºåÊâÄÊúâÁ±ªÂÆû‰æãÂíåÊï∞ÁªÑÁöÑÂÜÖÂ≠òÂùá‰ªéÊ≠§Â§ÑÂàÜÈÖç„ÄÇÂ†ÜÊòØÂú® Java ËôöÊãüÊú∫ÂêØÂä®Êó∂ÂàõÂª∫ÁöÑ„ÄÇÂØπË±°ÁöÑÂ†ÜÂÜÖÂ≠òÁî±Áß∞‰∏∫ÂûÉÂúæÂõûÊî∂Âô®ÁöÑËá™Âä®ÂÜÖÂ≠òÁÆ°ÁêÜÁ≥ªÁªüÂõûÊî∂„ÄÇ Â†ÜÁöÑÂ§ßÂ∞èÂèØ‰ª•Âõ∫ÂÆöÔºå‰πüÂèØ‰ª•Êâ©Â§ßÂíåÁº©Â∞è„ÄÇÂ†ÜÁöÑÂÜÖÂ≠ò‰∏çÈúÄË¶ÅÊòØËøûÁª≠Á©∫Èó¥„ÄÇ ÈùûÂ†ÜÂÜÖÂ≠ò Java ËôöÊãüÊú∫ÁÆ°ÁêÜÂ†Ü‰πãÂ§ñÁöÑÂÜÖÂ≠òÔºàÁß∞‰∏∫ÈùûÂ†ÜÂÜÖÂ≠òÔºâ„ÄÇ Java ËôöÊãüÊú∫ÂÖ∑Êúâ‰∏Ä‰∏™Áî±ÊâÄÊúâÁ∫øÁ®ãÂÖ±‰∫´ÁöÑÊñπÊ≥ïÂå∫„ÄÇÊñπÊ≥ïÂå∫Â±û‰∫éÈùûÂ†ÜÂÜÖÂ≠ò„ÄÇÂÆÉÂ≠òÂÇ®ÊØè‰∏™Á±ªÁªìÊûÑÔºåÂ¶ÇËøêË°åÊó∂Â∏∏Êï∞Ê±†„ÄÅÂ≠óÊÆµÂíåÊñπÊ≥ïÊï∞ÊçÆÔºå‰ª•ÂèäÊñπÊ≥ïÂíåÊûÑÈÄ†ÊñπÊ≥ïÁöÑ‰ª£Á†Å„ÄÇÂÆÉÊòØÂú® Java ËôöÊãüÊú∫ÂêØÂä®Êó∂ÂàõÂª∫ÁöÑ„ÄÇ ÊñπÊ≥ïÂå∫Âú®ÈÄªËæë‰∏äÂ±û‰∫éÂ†ÜÔºå‰ΩÜ Java ËôöÊãüÊú∫ÂÆûÁé∞ÂèØ‰ª•ÈÄâÊã©‰∏çÂØπÂÖ∂ËøõË°åÂõûÊî∂ÊàñÂéãÁº©„ÄÇ‰∏éÂ†ÜÁ±ª‰ººÔºåÊñπÊ≥ïÂå∫ÁöÑÂ§ßÂ∞èÂèØ‰ª•Âõ∫ÂÆöÔºå‰πüÂèØ‰ª•Êâ©Â§ßÂíåÁº©Â∞è„ÄÇÊñπÊ≥ïÂå∫ÁöÑÂÜÖÂ≠ò‰∏çÈúÄË¶ÅÊòØËøûÁª≠Á©∫Èó¥„ÄÇ Èô§‰∫ÜÊñπÊ≥ïÂå∫Â§ñÔºåJava ËôöÊãüÊú∫ÂÆûÁé∞ÂèØËÉΩÈúÄË¶ÅÁî®‰∫éÂÜÖÈÉ®Â§ÑÁêÜÊàñ‰ºòÂåñÁöÑÂÜÖÂ≠òÔºåËøôÁßçÂÜÖÂ≠ò‰πüÊòØÈùûÂ†ÜÂÜÖÂ≠ò„ÄÇ‰æãÂ¶ÇÔºåJIT ÁºñËØëÂô®ÈúÄË¶ÅÂÜÖÂ≠òÊù•Â≠òÂÇ®‰ªé Java ËôöÊãüÊú∫‰ª£Á†ÅËΩ¨Êç¢ËÄåÊù•ÁöÑÊú¨Êú∫‰ª£Á†ÅÔºå‰ªéËÄåËé∑ÂæóÈ´òÊÄßËÉΩ„ÄÇ Âá†‰∏™Âü∫Êú¨Ê¶ÇÂøµ PermGen spaceÔºöÂÖ®Áß∞ÊòØPermanent Generation spaceÔºåÂç≥Ê∞∏‰πÖ‰ª£„ÄÇÂ∞±ÊòØËØ¥ÊòØÊ∞∏‰πÖ‰øùÂ≠òÁöÑÂå∫Âüü,Áî®‰∫éÂ≠òÊîæClassÂíåMeta‰ø°ÊÅØÔºåClassÂú®Ë¢´LoadÁöÑÊó∂ÂÄôË¢´ÊîæÂÖ•ËØ•Âå∫ÂüüÔºåGC(Garbage Collection)Â∫îËØ•‰∏ç‰ºöÂØπPermGen spaceËøõË°åÊ∏ÖÁêÜÔºåÊâÄ‰ª•Â¶ÇÊûú‰Ω†ÁöÑAPP‰ºöLOADÂæàÂ§öCLASSÁöÑËØùÔºåÂ∞±ÂæàÂèØËÉΩÂá∫Áé∞PermGen spaceÈîôËØØ„ÄÇ Heap spaceÔºöÂ≠òÊîæInstance„ÄÇ Java HeapÂàÜ‰∏∫3‰∏™Âå∫ÔºåYoungÂç≥Êñ∞Áîü‰ª£ÔºåOldÂç≥ËÄÅÁîü‰ª£ÂíåPermanent„ÄÇ Young‰øùÂ≠òÂàöÂÆû‰æãÂåñÁöÑÂØπË±°„ÄÇÂΩìËØ•Âå∫Ë¢´Â°´Êª°Êó∂ÔºåGC‰ºöÂ∞ÜÂØπË±°ÁßªÂà∞OldÂå∫„ÄÇPermanentÂå∫ÂàôË¥üË¥£‰øùÂ≠òÂèçÂ∞ÑÂØπË±°„ÄÇ Â†ÜÂÜÖÂ≠òÂàÜÈÖç JVMÂàùÂßãÂàÜÈÖçÁöÑÂ†ÜÂÜÖÂ≠òÁî±-XmsÊåáÂÆöÔºåÈªòËÆ§ÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑ1/64Ôºõ JVMÊúÄÂ§ßÂàÜÈÖçÁöÑÂ†ÜÂÜÖÂ≠òÁî±-XmxÊåáÂÆöÔºåÈªòËÆ§ÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑ1/4„ÄÇ ÈªòËÆ§Á©∫‰ΩôÂ†ÜÂÜÖÂ≠òÂ∞è‰∫é40%Êó∂ÔºåJVMÂ∞±‰ºöÂ¢ûÂ§ßÂ†ÜÁõ¥Âà∞-XmxÁöÑÊúÄÂ§ßÈôêÂà∂Ôºõ Á©∫‰ΩôÂ†ÜÂÜÖÂ≠òÂ§ß‰∫é70%Êó∂ÔºåJVM‰ºöÂáèÂ∞ëÂ†ÜÁõ¥Âà∞-XmsÁöÑÊúÄÂ∞èÈôêÂà∂„ÄÇ Âõ†Ê≠§ÊúçÂä°Âô®‰∏ÄËà¨ËÆæÁΩÆ-Xms„ÄÅ-Xmx Áõ∏Á≠â‰ª•ÈÅøÂÖçÂú®ÊØèÊ¨°GC ÂêéË∞ÉÊï¥Â†ÜÁöÑÂ§ßÂ∞è„ÄÇ ËØ¥ÊòéÔºöÂ¶ÇÊûú-Xmx ‰∏çÊåáÂÆöÊàñËÄÖÊåáÂÆöÂÅèÂ∞èÔºåÂ∫îÁî®ÂèØËÉΩ‰ºöÂØºËá¥java.lang.OutOfMemoryÈîôËØØÔºåÊ≠§ÈîôËØØÊù•Ëá™JVMÔºå‰∏çÊòØThrowableÁöÑÔºåÊó†Ê≥ïÁî®try‚Ä¶catchÊçïÊçâ„ÄÇ ÈùûÂ†ÜÂÜÖÂ≠òÂàÜÈÖç \1. JVM‰ΩøÁî®-XX:PermSizeËÆæÁΩÆÈùûÂ†ÜÂÜÖÂ≠òÂàùÂßãÂÄºÔºåÈªòËÆ§ÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑ1/64Ôºõ \2. Áî±XX:MaxPermSizeËÆæÁΩÆÊúÄÂ§ßÈùûÂ†ÜÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÔºåÈªòËÆ§ÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑ1/4„ÄÇ ËøòÊúâ‰∏ÄËØ¥ÔºöMaxPermSizeÁº∫ÁúÅÂÄºÂíå-server -clientÈÄâÈ°πÁõ∏ÂÖ≥Ôºå-serverÈÄâÈ°π‰∏ãÈªòËÆ§MaxPermSize‰∏∫64mÔºå-clientÈÄâÈ°π‰∏ãÈªòËÆ§MaxPermSize‰∏∫32m„ÄÇËøô‰∏™ÊàëÊ≤°ÊúâÂÆûÈ™å„ÄÇ \3. XX:MaxPermSizeËÆæÁΩÆËøáÂ∞è‰ºöÂØºËá¥java.lang.OutOfMemoryError: PermGen space Â∞±ÊòØÂÜÖÂ≠òÁõäÂá∫„ÄÇ \4. ‰∏∫‰ªÄ‰πà‰ºöÂÜÖÂ≠òÁõäÂá∫Ôºö Ëøô‰∏ÄÈÉ®ÂàÜÂÜÖÂ≠òÁî®‰∫éÂ≠òÊîæClassÂíåMetaÁöÑ‰ø°ÊÅØÔºåClassÂú®Ë¢´ LoadÁöÑÊó∂ÂÄôË¢´ÊîæÂÖ•PermGen spaceÂå∫ÂüüÔºåÂÆÉÂíåÂ≠òÊîæInstanceÁöÑHeapÂå∫Âüü‰∏çÂêå„ÄÇ GC(Garbage Collection)‰∏ç‰ºöÂú®‰∏ªÁ®ãÂ∫èËøêË°åÊúüÂØπPermGen spaceËøõË°åÊ∏ÖÁêÜÔºåÊâÄ‰ª•Â¶ÇÊûú‰Ω†ÁöÑAPP‰ºöLOADÂæàÂ§öCLASS ÁöÑËØù,Â∞±ÂæàÂèØËÉΩÂá∫Áé∞PermGen spaceÈîôËØØ„ÄÇ \5. ËøôÁßçÈîôËØØÂ∏∏ËßÅÂú®webÊúçÂä°Âô®ÂØπJSPËøõË°åpre compileÁöÑÊó∂ÂÄô„ÄÇ JVMÂÜÖÂ≠òÈôêÂà∂(ÊúÄÂ§ßÂÄº) \1. È¶ñÂÖàJVMÂÜÖÂ≠òÈôêÂà∂‰∫éÂÆûÈôÖÁöÑÊúÄÂ§ßÁâ©ÁêÜÂÜÖÂ≠òÔºåÂÅáËÆæÁâ©ÁêÜÂÜÖÂ≠òÊó†ÈôêÂ§ßÁöÑËØùÔºåJVMÂÜÖÂ≠òÁöÑÊúÄÂ§ßÂÄºË∑üÊìç‰ΩúÁ≥ªÁªüÊúâÂæàÂ§ßÁöÑÂÖ≥Á≥ª„ÄÇÁÆÄÂçïÁöÑËØ¥Â∞±32‰ΩçÂ§ÑÁêÜÂô®ËôΩÁÑ∂ÂèØÊéßÂÜÖÂ≠òÁ©∫Èó¥Êúâ4GB,‰ΩÜÊòØÂÖ∑‰ΩìÁöÑÊìç‰ΩúÁ≥ªÁªü‰ºöÁªô‰∏Ä‰∏™ÈôêÂà∂ÔºåËøô‰∏™ÈôêÂà∂‰∏ÄËà¨ÊòØ2GB-3GBÔºà‰∏ÄËà¨Êù•ËØ¥WindowsÁ≥ªÁªü‰∏ã‰∏∫1.5G-2GÔºåLinuxÁ≥ªÁªü‰∏ã‰∏∫2G-3GÔºâÔºåËÄå64bit‰ª•‰∏äÁöÑÂ§ÑÁêÜÂô®Â∞±‰∏ç‰ºöÊúâÈôêÂà∂‰∫Ü„ÄÇ \2. ‰∏∫‰ªÄ‰πàÊúâÁöÑÊú∫Âô®ÊàëÂ∞Ü-XmxÂíå-XX:MaxPermSizeÈÉΩËÆæÁΩÆ‰∏∫512M‰πãÂêéEclipseÂèØ‰ª•ÂêØÂä®ÔºåËÄåÊúâ‰∫õÊú∫Âô®Êó†Ê≥ïÂêØÂä®Ôºü ÈÄöËøá‰∏äÈù¢ÂØπJVMÂÜÖÂ≠òÁÆ°ÁêÜÁöÑ‰ªãÁªçÊàë‰ª¨Â∑≤Áªè‰∫ÜËß£Âà∞JVMÂÜÖÂ≠òÂåÖÂê´‰∏§ÁßçÔºöÂ†ÜÂÜÖÂ≠òÂíåÈùûÂ†ÜÂÜÖÂ≠òÔºåÂè¶Â§ñJVMÊúÄÂ§ßÂÜÖÂ≠òÈ¶ñÂÖàÂèñÂÜ≥‰∫éÂÆûÈôÖÁöÑÁâ©ÁêÜÂÜÖÂ≠òÂíåÊìç‰ΩúÁ≥ªÁªü„ÄÇÊâÄ‰ª•ËØ¥ËÆæÁΩÆVMÂèÇÊï∞ÂØºËá¥Á®ãÂ∫èÊó†Ê≥ïÂêØÂä®‰∏ªË¶ÅÊúâ‰ª•‰∏ãÂá†ÁßçÂéüÂõ†Ôºö ÂèÇÊï∞‰∏≠-XmsÁöÑÂÄºÂ§ß‰∫é-XmxÔºåÊàñËÄÖ-XX:PermSizeÁöÑÂÄºÂ§ß‰∫é-XX:MaxPermSizeÔºõ -XmxÁöÑÂÄºÂíå-XX:MaxPermSizeÁöÑÊÄªÂíåË∂ÖËøá‰∫ÜJVMÂÜÖÂ≠òÁöÑÊúÄÂ§ßÈôêÂà∂ÔºåÊØîÂ¶ÇÂΩìÂâçÊìç‰ΩúÁ≥ªÁªüÊúÄÂ§ßÂÜÖÂ≠òÈôêÂà∂ÔºåÊàñËÄÖÂÆûÈôÖÁöÑÁâ©ÁêÜÂÜÖÂ≠òÁ≠âÁ≠â„ÄÇËØ¥Âà∞ÂÆûÈôÖÁâ©ÁêÜÂÜÖÂ≠òËøôÈáåÈúÄË¶ÅËØ¥Êòé‰∏ÄÁÇπÁöÑÊòØÔºåÂ¶ÇÊûú‰Ω†ÁöÑÂÜÖÂ≠òÊòØ1024MBÔºå‰ΩÜÂÆûÈôÖÁ≥ªÁªü‰∏≠Áî®Âà∞ÁöÑÂπ∂‰∏çÂèØËÉΩÊòØ1024MBÔºåÂõ†‰∏∫Êúâ‰∏ÄÈÉ®ÂàÜË¢´Á°¨‰ª∂Âç†Áî®‰∫Ü„ÄÇ \3. Â¶ÇÊûú‰Ω†Êúâ‰∏Ä‰∏™ÂèåÊ†∏ÁöÑCPUÔºå‰πüËÆ∏ÂèØ‰ª•Â∞ùËØïËøô‰∏™ÂèÇÊï∞: -XX:+UseParallelGC ËÆ©GCÂèØ‰ª•Êõ¥Âø´ÁöÑÊâßË°å„ÄÇÔºàÂè™ÊòØJDK 5ÈáåÂØπGCÊñ∞Â¢ûÂä†ÁöÑÂèÇÊï∞Ôºâ \4. Â¶ÇÊûú‰Ω†ÁöÑWEB APP‰∏ãÈÉΩÁî®‰∫ÜÂ§ßÈáèÁöÑÁ¨¨‰∏âÊñπjarÔºåÂÖ∂Â§ßÂ∞èË∂ÖËøá‰∫ÜÊúçÂä°Âô®jvmÈªòËÆ§ÁöÑÂ§ßÂ∞èÔºåÈÇ£‰πàÂ∞±‰ºö‰∫ßÁîüÂÜÖÂ≠òÁõäÂá∫ÈóÆÈ¢ò‰∫Ü„ÄÇËß£ÂÜ≥ÊñπÊ≥ïÔºö ËÆæÁΩÆMaxPermSizeÂ§ßÂ∞è„ÄÇ Â¢ûÂä†ÊúçÂä°Âô®ÂêØÂä®ÁöÑJVMÂèÇÊï∞ËÆæÁΩÆÔºö -Xms128m -Xmx256m -XX:PermSize=128M -XX:MaxNewSize=256m -XX:MaxPermSize=256m Â¶ÇtomcatÔºå‰øÆÊîπTOMCAT_HOME/bin/catalina.shÔºåÂú®echo ‚ÄúUsing CATALINA_BASE: $CATALINA_BASE‚Äù‰∏äÈù¢Âä†ÂÖ•‰ª•‰∏ãË°åÔºöJAVA_OPTS=‚Äù-server -XX:PermSize=64M -XX:MaxPermSize=128m \5. Âª∫ËÆÆÔºöÂ∞ÜÁõ∏ÂêåÁöÑÁ¨¨‰∏âÊñπjarÊñá‰ª∂ÁßªÁΩÆÂà∞tomcat/shared/libÁõÆÂΩï‰∏ãÔºåËøôÊ†∑ÂèØ‰ª•ÂáèÂ∞ëjar ÊñáÊ°£ÈáçÂ§çÂç†Áî®ÂÜÖÂ≠ò JVMÂÜÖÂ≠òËÆæÁΩÆÂèÇÊï∞ ÂÜÖÂ≠òËÆæÁΩÆÂèÇÊï∞ ËØ¥ÊòéÔºö Â¶ÇÊûú-Xmx‰∏çÊåáÂÆöÊàñËÄÖÊåáÂÆöÂÅèÂ∞èÔºåÂ∫îÁî®ÂèØËÉΩ‰ºöÂØºËá¥java.lang.OutOfMemoryÈîôËØØÔºåÊ≠§ÈîôËØØÊù•Ëá™JVM‰∏çÊòØThrowableÁöÑÔºåÊó†Ê≥ïÁî®try‚Ä¶catchÊçïÊçâ„ÄÇ PermSizeÂíåMaxPermSizeÊåáÊòéËôöÊãüÊú∫‰∏∫javaÊ∞∏‰πÖÁîüÊàêÂØπË±°ÔºàPermanate generationÔºâÂ¶ÇÔºåclassÂØπË±°„ÄÅÊñπÊ≥ïÂØπË±°Ëøô‰∫õÂèØÂèçÂ∞ÑÔºàreflectiveÔºâÂØπË±°ÂàÜÈÖçÂÜÖÂ≠òÈôêÂà∂ÔºåËøô‰∫õÂÜÖÂ≠ò‰∏çÂåÖÊã¨Âú®HeapÔºàÂ†ÜÂÜÖÂ≠òÔºâÂå∫‰πã‰∏≠„ÄÇ -XX:MaxPermSizeÂàÜÈÖçËøáÂ∞è‰ºöÂØºËá¥Ôºöjava.lang.OutOfMemoryError: PermGen space„ÄÇ MaxPermSizeÁº∫ÁúÅÂÄºÂíå-server -clientÈÄâÈ°πÁõ∏ÂÖ≥Ôºö-serverÈÄâÈ°π‰∏ãÈªòËÆ§MaxPermSize‰∏∫64m„ÄÅ-clientÈÄâÈ°π‰∏ãÈªòËÆ§MaxPermSize‰∏∫32m„ÄÇ Áî≥ËØ∑‰∏ÄÂùóÂÜÖÂ≠òÁöÑËøáÁ®ã JVM‰ºöËØïÂõæ‰∏∫Áõ∏ÂÖ≥JavaÂØπË±°Âú®Eden‰∏≠ÂàùÂßãÂåñ‰∏ÄÂùóÂÜÖÂ≠òÂå∫Âüü ÂΩìEdenÁ©∫Èó¥Ë∂≥Â§üÊó∂ÔºåÂÜÖÂ≠òÁî≥ËØ∑ÁªìÊùü„ÄÇÂê¶ÂàôÂà∞‰∏ã‰∏ÄÊ≠• JVMËØïÂõæÈáäÊîæÂú®Eden‰∏≠ÊâÄÊúâ‰∏çÊ¥ªË∑ÉÁöÑÂØπË±°ÔºàËøôÂ±û‰∫é1ÊàñÊõ¥È´òÁ∫ßÁöÑÂûÉÂúæÂõûÊî∂ÔºâÔºõÈáäÊîæÂêéËã•EdenÁ©∫Èó¥‰ªçÁÑ∂‰∏çË∂≥‰ª•ÊîæÂÖ•Êñ∞ÂØπË±°ÔºåÂàôËØïÂõæÂ∞ÜÈÉ®ÂàÜEden‰∏≠Ê¥ªË∑ÉÂØπË±°ÊîæÂÖ•SurvivorÂå∫/OLDÂå∫ SurvivorÂå∫Ë¢´Áî®Êù•‰Ωú‰∏∫EdenÂèäOLDÁöÑ‰∏≠Èó¥‰∫§Êç¢Âå∫ÂüüÔºåÂΩìOLDÂå∫Á©∫Èó¥Ë∂≥Â§üÊó∂ÔºåSurvivorÂå∫ÁöÑÂØπË±°‰ºöË¢´ÁßªÂà∞OldÂå∫ÔºåÂê¶Âàô‰ºöË¢´‰øùÁïôÂú®SurvivorÂå∫ ÂΩìOLDÂå∫Á©∫Èó¥‰∏çÂ§üÊó∂ÔºåJVM‰ºöÂú®OLDÂå∫ËøõË°åÂÆåÂÖ®ÁöÑÂûÉÂúæÊî∂ÈõÜÔºà0Á∫ßÔºâ ÂÆåÂÖ®ÂûÉÂúæÊî∂ÈõÜÂêéÔºåËã•SurvivorÂèäOLDÂå∫‰ªçÁÑ∂Êó†Ê≥ïÂ≠òÊîæ‰ªéEdenÂ§çÂà∂ËøáÊù•ÁöÑÈÉ®ÂàÜÂØπË±°ÔºåÂØºËá¥JVMÊó†Ê≥ïÂú®EdenÂå∫‰∏∫Êñ∞ÂØπË±°ÂàõÂª∫ÂÜÖÂ≠òÂå∫ÂüüÔºåÂàôÂá∫Áé∞‚Äùout of memoryÈîôËØØ‚Äù resinÊúçÂä°Âô®ÂÖ∏ÂûãÁöÑÂìçÂ∫îÊó∂Èó¥‰ºòÂÖàÂûãÁöÑjvmÈÖçÁΩÆÔºö -Xmx2000M -Xms2000M -Xmn500M -XX:PermSize=250M -XX:MaxPermSize=250M -Xss256K -XX:+DisableExplicitGC -XX:SurvivorRatio=1 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+CMSParallelRemarkEnabled -XX:+UseCMSCompactAtFullCollection -XX:CMSFullGCsBeforeCompaction=0 -XX:+CMSClassUnloadingEnabled -XX:LargePageSizeInBytes=128M -XX:+UseFastAccessorMethods -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=60 -XX:SoftRefLRUPolicyMSPerMB=0 -XX:+PrintClassHistogram -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC -Xloggc:log/gc.log ÂÜÖÂ≠òÂõûÊî∂ÁÆóÊ≥ï Java‰∏≠ÊúâÂõõÁßç‰∏çÂêåÁöÑÂõûÊî∂ÁÆóÊ≥ïÔºåÂØπÂ∫îÁöÑÂêØÂä®ÂèÇÊï∞‰∏∫: ‚ÄìXX:+UseSerialGC ‚ÄìXX:+UseParallelGC ‚ÄìXX:+UseParallelOldGC ‚ÄìXX:+UseConcMarkSweepGC Serial Collector Â§ßÈÉ®ÂàÜÂπ≥Âè∞ÊàñËÄÖÂº∫Âà∂ java -client ÈªòËÆ§‰ºö‰ΩøÁî®ËøôÁßç„ÄÇ young generationÁÆóÊ≥ï = serial old generationÁÆóÊ≥ï = serial (mark-sweep-compact) ËøôÁßçÊñπÊ≥ïÁöÑÁº∫ÁÇπÂæàÊòéÊòæ, stop-the-world, ÈÄüÂ∫¶ÊÖ¢„ÄÇÊúçÂä°Âô®Â∫îÁî®‰∏çÊé®Ëçê‰ΩøÁî®„ÄÇ Parallel Collector Âú®linux x64‰∏äÈªòËÆ§ÊòØËøôÁßçÔºåÂÖ∂‰ªñÂπ≥Âè∞Ë¶ÅÂä† java -server ÂèÇÊï∞Êâç‰ºöÈªòËÆ§ÈÄâÁî®ËøôÁßç„ÄÇ young = parallelÔºåÂ§ö‰∏™threadÂêåÊó∂copy old = mark-sweep-compact = 1 ‰ºòÁÇπÔºöÊñ∞Áîü‰ª£ÂõûÊî∂Êõ¥Âø´„ÄÇÂõ†‰∏∫Á≥ªÁªüÂ§ßÈÉ®ÂàÜÊó∂Èó¥ÂÅöÁöÑgcÈÉΩÊòØÊñ∞Áîü‰ª£ÁöÑÔºåËøôÊ†∑ÊèêÈ´ò‰∫Üthroughput(cpuÁî®‰∫éÈùûgcÊó∂Èó¥) Áº∫ÁÇπÔºöÂΩìËøêË°åÂú®8G/16G server‰∏äold generation live objectÂ§™Â§öÊó∂ÂÄôpause timeËøáÈïø Parallel Compact Collector (ParallelOld) young = parallel = 2 old = parallelÔºåÂàÜÊàêÂ§ö‰∏™Áã¨Á´ãÁöÑÂçïÂÖÉÔºåÂ¶ÇÊûúÂçïÂÖÉ‰∏≠live objectÂ∞ëÂàôÂõûÊî∂ÔºåÂ§öÂàôË∑≥Ëøá ‰ºòÁÇπÔºöold old generation‰∏äÊÄßËÉΩËæÉ parallel ÊñπÂºèÊúâÊèêÈ´ò Áº∫ÁÇπÔºöÂ§ßÈÉ®ÂàÜserverÁ≥ªÁªüold generationÂÜÖÂ≠òÂç†Áî®‰ºöËææÂà∞60%-80%, Ê≤°ÊúâÈÇ£‰πàÂ§öÁêÜÊÉ≥ÁöÑÂçïÂÖÉlive objectÂæàÂ∞ëÊñπ‰æøËøÖÈÄüÂõûÊî∂ÔºåÂêåÊó∂compactÊñπÈù¢ÂºÄÈîÄÊØîËµ∑parallelÂπ∂Ê≤°ÊòéÊòæÂáèÂ∞ë„ÄÇ Concurrent Mark-Sweep(CMS) Collector young generation = parallel collector = 2 old = cms ÂêåÊó∂‰∏çÂÅö compact Êìç‰Ωú„ÄÇ ‰ºòÁÇπÔºöpause time‰ºöÈôç‰Ωé, pauseÊïèÊÑü‰ΩÜCPUÊúâÁ©∫Èó≤ÁöÑÂú∫ÊôØÈúÄË¶ÅÂª∫ËÆÆ‰ΩøÁî®Á≠ñÁï•4. Áº∫ÁÇπÔºöcpuÂç†Áî®ËøáÂ§öÔºåcpuÂØÜÈõÜÂûãÊúçÂä°Âô®‰∏çÈÄÇÂêà„ÄÇÂè¶Â§ñÁ¢éÁâáÂ§™Â§öÔºåÊØè‰∏™objectÁöÑÂ≠òÂÇ®ÈÉΩË¶ÅÈÄöËøáÈìæË°®ËøûÁª≠Ë∑≥n‰∏™Âú∞ÊñπÔºåÁ©∫Èó¥Êµ™Ë¥πÈóÆÈ¢ò‰πü‰ºöÂ¢ûÂ§ß„ÄÇ ÂÜÖÂ≠òÁõëÊéßÊñπÊ≥ï jmap -heap Êü•Áúãjava Â†ÜÔºàheapÔºâ‰ΩøÁî®ÊÉÖÂÜµ jmap -heap pid using thread-local object allocation. Parallel GC with 4 thread(s) #GC ÊñπÂºè Heap Configuration: #Â†ÜÂÜÖÂ≠òÂàùÂßãÂåñÈÖçÁΩÆ MinHeapFreeRatio=40 #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:MinHeapFreeRatioËÆæÁΩÆJVMÂ†ÜÊúÄÂ∞èÁ©∫Èó≤ÊØîÁéá(default 40) MaxHeapFreeRatio=70 #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞ -XX:MaxHeapFreeRatioËÆæÁΩÆJVMÂ†ÜÊúÄÂ§ßÁ©∫Èó≤ÊØîÁéá(default 70) MaxHeapSize=512.0MB #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:MaxHeapSize=ËÆæÁΩÆJVMÂ†ÜÁöÑÊúÄÂ§ßÂ§ßÂ∞è NewSize = 1.0MB #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:NewSize=ËÆæÁΩÆJVMÂ†ÜÁöÑ‚ÄòÊñ∞Áîü‰ª£‚ÄôÁöÑÈªòËÆ§Â§ßÂ∞è MaxNewSize =4095MB #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:MaxNewSize=ËÆæÁΩÆJVMÂ†ÜÁöÑ‚ÄòÊñ∞Áîü‰ª£‚ÄôÁöÑÊúÄÂ§ßÂ§ßÂ∞è OldSize = 4.0MB #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:OldSize=:ËÆæÁΩÆJVMÂ†ÜÁöÑ‚ÄòËÄÅÁîü‰ª£‚ÄôÁöÑÂ§ßÂ∞è NewRatio = 8 #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:NewRatio=:‚ÄòÊñ∞Áîü‰ª£‚ÄôÂíå‚ÄòËÄÅÁîü‰ª£‚ÄôÁöÑÂ§ßÂ∞èÊØîÁéá SurvivorRatio = 8 #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:SurvivorRatio=ËÆæÁΩÆÂπ¥ËΩª‰ª£‰∏≠EdenÂå∫‰∏éSurvivorÂå∫ÁöÑÂ§ßÂ∞èÊØîÂÄº PermSize= 16.0MB #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:PermSize=:ËÆæÁΩÆJVMÂ†ÜÁöÑ‚ÄòÊ∞∏Áîü‰ª£‚ÄôÁöÑÂàùÂßãÂ§ßÂ∞è MaxPermSize=64.0MB #ÂØπÂ∫îjvmÂêØÂä®ÂèÇÊï∞-XX:MaxPermSize=:ËÆæÁΩÆJVMÂ†ÜÁöÑ‚ÄòÊ∞∏Áîü‰ª£‚ÄôÁöÑÊúÄÂ§ßÂ§ßÂ∞è Heap Usage: #Â†ÜÂÜÖÂ≠òÂàÜÊ≠• PS Young Generation Eden Space: #EdenÂå∫ÂÜÖÂ≠òÂàÜÂ∏É capacity = 20381696 (19.4375MB) #EdenÂå∫ÊÄªÂÆπÈáè used = 20370032 (19.426376342773438MB) #EdenÂå∫Â∑≤‰ΩøÁî® free = 11664 (0.0111236572265625MB) #EdenÂå∫Ââ©‰ΩôÂÆπÈáè 99.94277218147106% used #EdenÂå∫‰ΩøÁî®ÊØîÁéá From Space: #ÂÖ∂‰∏≠‰∏Ä‰∏™SurvivorÂå∫ÁöÑÂÜÖÂ≠òÂàÜÂ∏É capacity = 8519680 (8.125MB) used = 32768 (0.03125MB) free = 8486912 (8.09375MB) 0.38461538461538464% used To Space: #Âè¶‰∏Ä‰∏™SurvivorÂå∫ÁöÑÂÜÖÂ≠òÂàÜÂ∏É capacity = 9306112 (8.875MB) used = 0 (0.0MB) free = 9306112 (8.875MB) 0.0% used PS Old Generation #ÂΩìÂâçÁöÑOldÂå∫ÂÜÖÂ≠òÂàÜÂ∏É capacity = 366280704 (349.3125MB) used = 322179848 (307.25464630126953MB) free = 44100856 (42.05785369873047MB) 87.95982001825573% used PS Perm Generation #ÂΩìÂâçÁöÑ ‚ÄúÊ∞∏Áîü‰ª£‚Äù ÂÜÖÂ≠òÂàÜÂ∏É capacity = 32243712 (30.75MB) used = 28918584 (27.57891082763672MB) free = 3325128 (3.1710891723632812MB) 89.68751488662348% used JVMÂÜÖÂ≠òÁõëÊéßÂ∑•ÂÖ∑ &lt;%@ page import=‚Äùjava.lang.management.*‚Äù %&gt; &lt;%@ page import=‚Äùjava.util.*‚Äù %&gt; JVM Memory Monitor‚Äã Memory MXBean‚Äã Heap Memory Usage&lt;%=ManagementFactory.getMemoryMXBean().getHeapMemoryUsage()%&gt;‚Äã Non-Heap Memory Usage&lt;%=ManagementFactory.getMemoryMXBean().getNonHeapMemoryUsage()%&gt;‚Äã ‚Äã Memory Pool MXBeans&lt;%‚Äã Iterator iter = ManagementFactory.getMemoryPoolMXBeans().iterator();‚Äã while (iter.hasNext()) {‚Äã MemoryPoolMXBean item = (MemoryPoolMXBean) iter.next();%&gt;‚Äã ‚Äã &lt;%= item.getName() %&gt;‚Äã Type&lt;%= item.getType() %&gt;‚Äã Usage&lt;%= item.getUsage() %&gt;‚Äã Peak Usage&lt;%= item.getPeakUsage() %&gt;‚Äã Collection Usage&lt;%= item.getCollectionUsage() %&gt;‚Äã &lt;%} %&gt;]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>JVM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQL selectÂ≠êÊü•ËØ¢ÂºïÁî®ÂèòÈáè]]></title>
    <url>%2F2017%2F12%2F28%2FMySQL-select%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%BC%95%E7%94%A8%E5%8F%98%E9%87%8F%2F</url>
    <content type="text"><![CDATA[Á§∫‰æã‰∏ÄÂâçÂá†Â§©ÁúãÂà´‰∫∫ÁöÑ‰ª£Á†Å‰∏≠ÁúãÂà∞Âú®Â≠óÊÆµ‰∏≠‰ΩøÁî®selectÂ≠êÊü•ËØ¢ÁöÑÊñπÊ≥ïÔºåÁ¨¨‰∏ÄÊ¨°ËßÅËøôÁßçÂÜôÊ≥ïÔºåÁÑ∂ÂêéÁ†îÁ©∂‰∫Ü‰∏Ä‰∏ãÔºåËÆ∞ÂΩï‰∏ãÊù• Â§ßÊ¶ÇÁöÑÂΩ¢ÂºèÊòØËøôÊ†∑ÁöÑ: 1select a .*,(select b.another_field from b where a.id=b.aid) another_field from a where 1 limit 10; ‰∏ãÈù¢ËøòÊòØ‰ª•ÂÆû‰æãÊù•ËØ¥ÊòéÔºåË¶Å‰∏çÁÑ∂‰∏çÂ•ΩÁêÜËß£ÔºåÊñ∞Âª∫‰∏§Âº†Ë°®Ôºå‰∏ÄÂº†ÊòØÂïÜÂìÅË°®ÔºåÂè¶Â§ñ‰∏ÄÂº†ÊòØÂïÜÂìÅÁöÑËØÑËÆ∫Ë°® ÂïÜÂìÅË°®Ôºö 123456CREATE TABLE `product` ( `id` int(11) NOT NULL AUTO_INCREMENT, `product_name` varchar(30) CHARACTER SET utf8 NOT NULL, `price` float NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB; ËØÑËÆ∫Ë°®Ôºö 1234567CREATE TABLE `comment` ( `id` int(11) NOT NULL AUTO_INCREMENT, `entity_id` int(11) NOT NULL, `content` varchar(100) CHARACTER SET utf8 NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB; ÁÑ∂ÂêéÊèíÂÖ•‰∏Ä‰∫õÊï∞ÊçÆÔºö 123456789INSERT INTO `product` (`id`, `product_name`, `price`) VALUES(1, 'ËÇâÊùæÈ•º', 5),(2, 'ÂèØ‰πê', 5),(3, 'È∏°ÁøÖ', 12),(4, 'ÊùØÂ≠ê', 42);INSERT INTO `comment` (`id`, `entity_id`, `content`) VALUES(1, 1, 'Âë≥ÈÅìËøò‰∏çÈîô'),(2, 1, 'ËøòË°åÂïä'),(3, 3, 'ÂæàÂÆûÁî®Âì¶'); ‰∏ãÈù¢Êàë‰ª¨Áî®Â≠êÊü•ËØ¢ÁöÑÊñπÂºèÊù•Êü•Âá∫ÂïÜÂìÅÁöÑ‰ø°ÊÅØ‰ª•ÂèäÊØè‰∏™ÂïÜÂìÅÁöÑËØÑËÆ∫Êï∞Èáè 1SELECT product.*,(select count(comment.id) from comment where product.id=comment.entity_id) comment_count FROM `product` limit 5; Êü•ËØ¢ÁªìÊûúÂ¶Ç‰∏ãÔºö id product_name price comment_count 1 ËÇâÊùæÈ•º 5 2 2 ÂèØ‰πê 5 0 3 È∏°ÁøÖ 12 1 4 ÊùØÂ≠ê 42 0 ÂØπ‰∫éËøôÁßçÊü•ËØ¢ÔºåÂèØ‰ª•ÂàÜÊàê‰∏§ÈÉ®Êù•ÁêÜËß£ÔºåÈ¶ñÂÖàÂøΩÁï•Êï¥‰∏™selectÂ≠êÊü•ËØ¢ÔºåÊü•Âá∫ÂïÜÂìÅË°®‰∏≠ÁöÑÊï∞ÊçÆÔºåÁÑ∂ÂêéÊ†πÊçÆÂïÜÂìÅÁöÑidÊâßË°åÂ≠êÊü•ËØ¢ÔºåÂØπ‰∫é‰∏Ä‰∏™ÂïÜÂìÅid,Â≠êÊü•ËØ¢Âè™ËÉΩËøîÂõû‰∏ÄÊù°Êï∞ÊçÆÔºåÂ¶ÇÊûúÂ≠êÊü•ËØ¢ËøîÂõûÂ§öÊù°Êï∞ÊçÆÂàô‰ºöÂá∫ÈîôÔºåÂè¶Â§ñÔºåÊØè‰∏ÄÊù°selectÂ≠êÊü•ËØ¢Âè™ËÉΩÊü•ËØ¢‰∏Ä‰∏™Â≠óÊÆµ„ÄÇ Âè¶Â§ñÁöÑÂàóÂ≠êÔºåÊü•Âá∫ÊØè‰∏™ÂïÜÂìÅ‰ø°ÊÅØ‰ª•ÂèäÂïÜÂìÅÁöÑÊúÄÊñ∞ËØÑËÆ∫ÂÜÖÂÆπÔºö 1SELECT product.*,(select comment.content from comment where product.id=comment.entity_id order by comment.id desc limit 1) comment_count FROM `product` limit 5; Êü•ËØ¢ÁªìÊûúÂ¶Ç‰∏ãÔºö id product_name price last_comment 1 ËÇâÊùæÈ•º 5 ËøòË°åÂïä 2 ÂèØ‰πê 5 NULL 3 È∏°ÁøÖ 12 ÂæàÂÆûÁî®Âì¶ 4 ÊùØÂ≠ê 42 NULL Á§∫‰æã‰∫å billingÂàÜ‰∏§Ê≠•ÁúãÔºå ‰∏çÁúãÂ≠óÊü•ËØ¢bi.id not in () , Áõ∏ÂΩì‰∫éÊü•ËØ¢Âá∫ÊâÄÊúâÁöÑstatus‰∏∫1ÁöÑidÔºåÂíåËÆ∞ÂΩï SELECT substring_index(group_concat(id ORDER BY product_start_time desc) , ‚Äò,‚Äô , 1)‚Äã FROM cash_billing_item‚Äã WHERE status = 1‚Äã GROUP BY product_no, customer_no SELECT SUBSTRING_INDEX(‚Äò15,151,152,16‚Äô,‚Äô,‚Äô,1); ==&gt;ÂæóÂà∞ÁªìÊûú‰∏∫Ôºö 15 ÁÑ∂ÂêéÊØè‰∏ÄÊù°ËÆ∞ÂΩïÁöÑbi.product_no Âíåbi.customer_noÔºåÂàÜÂà´ÂíåselectÁöÑÁªìÊûúÊØîËæÉ 123456789101112131415161718192021222324252627SELECT bi.idFROM cash_billing_item biWHERE bi.id and bi.status = 1 and bi.id not in ( SELECT substring_index(group_concat(id ORDER BY product_start_time desc) , ',' , 1) FROM cash_billing_item WHERE product_no = bi.product_no AND customer_no = bi.customer_no and status = 1 GROUP BY product_no, customer_no ); UPDATE cash_billing_item bi, ( SELECT bi.id FROM cash_billing_item bi WHERE bi.id and bi.status = 1 and bi.id not in ( SELECT group_concat(id ORDER BY product_start_time desc) FROM cash_billing_item WHERE product_no = bi.product_no AND customer_no = bi.customer_no and status = 1 GROUP BY product_no, customer_no ) ) temp SET bi.status = 2 WHERE bi.id = temp.id; cash_billing_item_copy 123456789101112131415161718192021222324252627282930313233343536373839404142create table cash_billing_item_copy( id bigint(11) unsigned auto_increment comment 'Ëá™Â¢ûid' primary key, customer_no varchar(64) null comment 'ÂÆ¢Êà∑ÁºñÂè∑', product_id int not null comment '‰∫ßÂìÅË°®pk', product_start_time timestamp null comment '‰∫ßÂìÅÁîüÊïàÊó∂Èó¥', gmt_create timestamp default CURRENT_TIMESTAMP not null comment 'ÂàõÂª∫Êó∂Èó¥', gmt_modify timestamp default CURRENT_TIMESTAMP not null comment '‰øÆÊîπÊó∂Èó¥') comment '‰ªéË¥¶Âä°Á≥ªÁªüÊé®Êù•ÁöÑËÆ°Ë¥πÈ°π';INSERT INTO cash_billing_item_copy (customer_no, product_id, product_start_time) VALUES ('ct2',1,'2017-12-27 00:00:00');SELECT * FROM cash_billing_item_copy;SELECT group_concat(id ORDER BY product_start_time DESC), customer_no , product_idFROM cash_billing_item_copyGROUP BY customer_no , product_id;SELECT c.id FROM cash_billing_item_copy cWHERE c.id AND c.id NOT IN ( SELECT substring_index(group_concat(id ORDER BY product_start_time DESC), ',', 1) FROM cash_billing_item_copy GROUP BY customer_no, product_id );SELECT SUBSTRING_INDEX('15,151,152,16',',',1);]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ReactÁîüÂëΩÂë®Êúü]]></title>
    <url>%2F2017%2F12%2F27%2FReact%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂ≠¶‰π†ReactÔºåÁîüÂëΩÂë®ÊúüÂæàÈáçË¶ÅÔºåÊàë‰ª¨‰∫ÜËß£ÂÆåÁîüÂëΩÂë®ÊúüÁöÑÂêÑ‰∏™ÁªÑ‰ª∂ÔºåÂØπÂÜôÈ´òÊÄßËÉΩÁªÑ‰ª∂‰ºöÊúâÂæàÂ§ßÁöÑÂ∏ÆÂä©. RactÁîüÂëΩÂë®ÊúüReact ÁîüÂëΩÂë®ÊúüÂàÜ‰∏∫‰∏âÁßçÁä∂ÊÄÅ 1. ÂàùÂßãÂåñ 2.Êõ¥Êñ∞ 3.ÈîÄÊØÅ ÂàùÂßãÂåñ 1„ÄÅgetDefaultProps() ËÆæÁΩÆÈªòËÆ§ÁöÑpropsÔºå‰πüÂèØ‰ª•Áî®dufaultPropsËÆæÁΩÆÁªÑ‰ª∂ÁöÑÈªòËÆ§Â±ûÊÄß. 2„ÄÅgetInitialState() Âú®‰ΩøÁî®es6ÁöÑclassËØ≠Ê≥ïÊó∂ÊòØÊ≤°ÊúâËøô‰∏™Èí©Â≠êÂáΩÊï∞ÁöÑÔºåÂèØ‰ª•Áõ¥Êé•Âú®constructor‰∏≠ÂÆö‰πâthis.state„ÄÇÊ≠§Êó∂ÂèØ‰ª•ËÆøÈóÆthis.props 3„ÄÅcomponentWillMount() ÁªÑ‰ª∂ÂàùÂßãÂåñÊó∂Âè™Ë∞ÉÁî®Ôºå‰ª•ÂêéÁªÑ‰ª∂Êõ¥Êñ∞‰∏çË∞ÉÁî®ÔºåÊï¥‰∏™ÁîüÂëΩÂë®ÊúüÂè™Ë∞ÉÁî®‰∏ÄÊ¨°ÔºåÊ≠§Êó∂ÂèØ‰ª•‰øÆÊîπstate„ÄÇ 4„ÄÅ render() reactÊúÄÈáçË¶ÅÁöÑÊ≠•È™§ÔºåÂàõÂª∫ËôöÊãüdomÔºåËøõË°ådiffÁÆóÊ≥ïÔºåÊõ¥Êñ∞domÊ†ëÈÉΩÂú®Ê≠§ËøõË°å„ÄÇÊ≠§Êó∂Â∞±‰∏çËÉΩÊõ¥Êîπstate‰∫Ü„ÄÇ 5„ÄÅcomponentDidMount() ÁªÑ‰ª∂Ê∏≤Êüì‰πãÂêéË∞ÉÁî®ÔºåÂè™Ë∞ÉÁî®‰∏ÄÊ¨°„ÄÇ Êõ¥Êñ∞ 6„ÄÅcomponentWillReceiveProps(nextProps) ÁªÑ‰ª∂ÂàùÂßãÂåñÊó∂‰∏çË∞ÉÁî®ÔºåÁªÑ‰ª∂Êé•ÂèóÊñ∞ÁöÑpropsÊó∂Ë∞ÉÁî®„ÄÇ 7„ÄÅshouldComponentUpdate(nextProps, nextState) reactÊÄßËÉΩ‰ºòÂåñÈùûÂ∏∏ÈáçË¶ÅÁöÑ‰∏ÄÁéØ„ÄÇÁªÑ‰ª∂Êé•ÂèóÊñ∞ÁöÑstateÊàñËÄÖpropsÊó∂Ë∞ÉÁî®ÔºåÊàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆÂú®Ê≠§ÂØπÊØîÂâçÂêé‰∏§‰∏™propsÂíåstateÊòØÂê¶Áõ∏ÂêåÔºåÂ¶ÇÊûúÁõ∏ÂêåÂàôËøîÂõûfalseÈòªÊ≠¢Êõ¥Êñ∞ÔºåÂõ†‰∏∫Áõ∏ÂêåÁöÑÂ±ûÊÄßÁä∂ÊÄÅ‰∏ÄÂÆö‰ºöÁîüÊàêÁõ∏ÂêåÁöÑdomÊ†ëÔºåËøôÊ†∑Â∞±‰∏çÈúÄË¶ÅÂàõÈÄ†Êñ∞ÁöÑdomÊ†ëÂíåÊóßÁöÑdomÊ†ëËøõË°ådiffÁÆóÊ≥ïÂØπÊØîÔºåËäÇÁúÅÂ§ßÈáèÊÄßËÉΩÔºåÂ∞§ÂÖ∂ÊòØÂú®domÁªìÊûÑÂ§çÊùÇÁöÑÊó∂ÂÄô 8„ÄÅcomponentWillUpdata(nextProps, nextState) ÁªÑ‰ª∂ÂàùÂßãÂåñÊó∂‰∏çË∞ÉÁî®ÔºåÂè™ÊúâÂú®ÁªÑ‰ª∂Â∞ÜË¶ÅÊõ¥Êñ∞Êó∂ÊâçË∞ÉÁî®ÔºåÊ≠§Êó∂ÂèØ‰ª•‰øÆÊîπstate 9„ÄÅrender() ÁªÑ‰ª∂Ê∏≤Êüì 10„ÄÅcomponentDidUpdate() ÁªÑ‰ª∂ÂàùÂßãÂåñÊó∂‰∏çË∞ÉÁî®ÔºåÁªÑ‰ª∂Êõ¥Êñ∞ÂÆåÊàêÂêéË∞ÉÁî®ÔºåÊ≠§Êó∂ÂèØ‰ª•Ëé∑ÂèñdomËäÇÁÇπ„ÄÇ Âç∏ËΩΩ 11„ÄÅcomponentWillUnmount() ÁªÑ‰ª∂Â∞ÜË¶ÅÂç∏ËΩΩÊó∂Ë∞ÉÁî®Ôºå‰∏Ä‰∫õ‰∫ã‰ª∂ÁõëÂê¨ÂíåÂÆöÊó∂Âô®ÈúÄË¶ÅÂú®Ê≠§Êó∂Ê∏ÖÈô§„ÄÇ ÁªìÊùüËØ≠‰ª•‰∏äÂ∞±ÊòØReact ÁöÑÁîüÂëΩÂë®ÊúüÔºåÂ§ßÂÆ∂ÂèØ‰ª•Ëá™Ë°åÂÜô‰∏ãcodeÊµãËØï‰∏Ä‰∏ãÔºåÂú®ËøôÈáåÊàëÂ∞±‰∏çË¥¥code ‰∫Ü„ÄÇ ‰∏ãÈù¢ÊâÄÂÜôÁöÑÔºåÂè™ÈÄÇÂêàÂâçÁ´ØÁöÑReact„ÄÇÔºàReact‰πüÊîØÊåÅÂêéÁ´ØÊ∏≤ÊüìÔºåËÄå‰∏îÂíåÂâçÁ´ØÊúâÁÇπÂ∞èÂå∫Âà´Ôºå‰∏çËøáÊàëÊ≤°Áî®Ëøá„ÄÇÔºâ Áõ∏ÂÖ≥ÂáΩÊï∞ÁÆÄÂçïÂú∞ËØ¥ÔºåReact ComponentÈÄöËøáÂÖ∂ÂÆö‰πâÁöÑÂá†‰∏™ÂáΩÊï∞Êù•ÊéßÂà∂ÁªÑ‰ª∂Âú®ÁîüÂëΩÂë®ÊúüÁöÑÂêÑ‰∏™Èò∂ÊÆµÁöÑÂä®‰Ωú„ÄÇ Âú®ES6‰∏≠Ôºå‰∏Ä‰∏™ReactÁªÑ‰ª∂ÊòØÁî®‰∏Ä‰∏™classÊù•Ë°®Á§∫ÁöÑÔºàÂÖ∑‰ΩìÂèØ‰ª•ÂèÇËÄÉÂÆòÊñπÊñáÊ°£ÔºâÔºåÂ¶Ç‰∏ãÔºö 1234// ÂÆö‰πâ‰∏Ä‰∏™TodoListÁöÑReactÁªÑ‰ª∂ÔºåÈÄöËøáÁªßÊâøReact.ComponentÊù•ÂÆûÁé∞class TodoList extends React.Component &#123; ...&#125; ËøôÂá†‰∏™ÁîüÂëΩÂë®ÊúüÁõ∏ÂÖ≥ÁöÑÂáΩÊï∞ÊúâÔºö 1constructor(props, context) ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂú®ÂàõÂª∫ÁªÑ‰ª∂ÁöÑÊó∂ÂÄôË∞ÉÁî®‰∏ÄÊ¨°„ÄÇ 1void componentWillMount() Âú®ÁªÑ‰ª∂ÊåÇËΩΩ‰πãÂâçË∞ÉÁî®‰∏ÄÊ¨°„ÄÇÂ¶ÇÊûúÂú®Ëøô‰∏™ÂáΩÊï∞ÈáåÈù¢Ë∞ÉÁî®setStateÔºåÊú¨Ê¨°ÁöÑrenderÂáΩÊï∞ÂèØ‰ª•ÁúãÂà∞Êõ¥Êñ∞ÂêéÁöÑstateÔºåÂπ∂‰∏îÂè™Ê∏≤Êüì‰∏ÄÊ¨°„ÄÇ 1void componentDidMount() Âú®ÁªÑ‰ª∂ÊåÇËΩΩ‰πãÂêéË∞ÉÁî®‰∏ÄÊ¨°„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÂ≠ê‰∏ªÈîÆ‰πüÈÉΩÊåÇËΩΩÂ•Ω‰∫ÜÔºåÂèØ‰ª•Âú®ËøôÈáå‰ΩøÁî®refs„ÄÇ 1void componentWillReceiveProps(nextProps) propsÊòØÁà∂ÁªÑ‰ª∂‰º†ÈÄíÁªôÂ≠êÁªÑ‰ª∂ÁöÑ„ÄÇÁà∂ÁªÑ‰ª∂ÂèëÁîürenderÁöÑÊó∂ÂÄôÂ≠êÁªÑ‰ª∂Â∞±‰ºöË∞ÉÁî®componentWillReceivePropsÔºà‰∏çÁÆ°propsÊúâÊ≤°ÊúâÊõ¥Êñ∞Ôºå‰πü‰∏çÁÆ°Áà∂Â≠êÁªÑ‰ª∂‰πãÈó¥ÊúâÊ≤°ÊúâÊï∞ÊçÆ‰∫§Êç¢Ôºâ„ÄÇ 1bool shouldComponentUpdate(nextProps, nextState) ÁªÑ‰ª∂ÊåÇËΩΩ‰πãÂêéÔºåÊØèÊ¨°Ë∞ÉÁî®setStateÂêéÈÉΩ‰ºöË∞ÉÁî®shouldComponentUpdateÂà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÈáçÊñ∞Ê∏≤ÊüìÁªÑ‰ª∂„ÄÇÈªòËÆ§ËøîÂõûtrueÔºåÈúÄË¶ÅÈáçÊñ∞render„ÄÇÂú®ÊØîËæÉÂ§çÊùÇÁöÑÂ∫îÁî®ÈáåÔºåÊúâ‰∏Ä‰∫õÊï∞ÊçÆÁöÑÊîπÂèòÂπ∂‰∏çÂΩ±ÂìçÁïåÈù¢Â±ïÁ§∫ÔºåÂèØ‰ª•Âú®ËøôÈáåÂÅöÂà§Êñ≠Ôºå‰ºòÂåñÊ∏≤ÊüìÊïàÁéá„ÄÇ 1void componentWillUpdate(nextProps, nextState) shouldComponentUpdateËøîÂõûtrueÊàñËÄÖË∞ÉÁî®forceUpdate‰πãÂêéÔºåcomponentWillUpdate‰ºöË¢´Ë∞ÉÁî®„ÄÇ 1void componentDidUpdate() Èô§‰∫ÜÈ¶ñÊ¨°render‰πãÂêéË∞ÉÁî®componentDidMountÔºåÂÖ∂ÂÆÉrenderÁªìÊùü‰πãÂêéÈÉΩÊòØË∞ÉÁî®componentDidUpdate„ÄÇ componentWillMount„ÄÅcomponentDidMountÂíåcomponentWillUpdate„ÄÅcomponentDidUpdateÂèØ‰ª•ÂØπÂ∫îËµ∑Êù•„ÄÇÂå∫Âà´Âú®‰∫éÔºåÂâçËÄÖÂè™ÊúâÂú®ÊåÇËΩΩÁöÑÊó∂ÂÄô‰ºöË¢´Ë∞ÉÁî®ÔºõËÄåÂêéËÄÖÂú®‰ª•ÂêéÁöÑÊØèÊ¨°Êõ¥Êñ∞Ê∏≤Êüì‰πãÂêéÈÉΩ‰ºöË¢´Ë∞ÉÁî®„ÄÇ 1ReactElement render() renderÊòØ‰∏Ä‰∏™ReactÁªÑ‰ª∂ÊâÄÂøÖ‰∏çÂèØÂ∞ëÁöÑÊ†∏ÂøÉÂáΩÊï∞Ôºà‰∏äÈù¢ÁöÑÂÖ∂ÂÆÉÂáΩÊï∞ÈÉΩ‰∏çÊòØÂøÖÈ°ªÁöÑÔºâ„ÄÇËÆ∞‰ΩèÔºå‰∏çË¶ÅÂú®renderÈáåÈù¢‰øÆÊîπstate„ÄÇ 1void componentWillUnmount() ÁªÑ‰ª∂Ë¢´Âç∏ËΩΩÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇ‰∏ÄËà¨Âú®componentDidMountÈáåÈù¢Ê≥®ÂÜåÁöÑ‰∫ã‰ª∂ÈúÄË¶ÅÂú®ËøôÈáåÂà†Èô§„ÄÇ Êõ¥Êñ∞ÊñπÂºèÂú®react‰∏≠ÔºåËß¶ÂèërenderÁöÑÊúâ4Êù°Ë∑ØÂæÑ„ÄÇ ‰ª•‰∏ãÂÅáËÆæshouldComponentUpdateÈÉΩÊòØÊåâÁÖßÈªòËÆ§ËøîÂõûtrueÁöÑÊñπÂºè„ÄÇ È¶ñÊ¨°Ê∏≤ÊüìInitial Render Ë∞ÉÁî®this.setState ÔºàÂπ∂‰∏çÊòØ‰∏ÄÊ¨°setState‰ºöËß¶Âèë‰∏ÄÊ¨°renderÔºåReactÂèØËÉΩ‰ºöÂêàÂπ∂Êìç‰ΩúÔºåÂÜç‰∏ÄÊ¨°ÊÄßËøõË°årenderÔºâ Áà∂ÁªÑ‰ª∂ÂèëÁîüÊõ¥Êñ∞Ôºà‰∏ÄËà¨Â∞±ÊòØpropsÂèëÁîüÊîπÂèòÔºå‰ΩÜÊòØÂ∞±ÁÆópropsÊ≤°ÊúâÊîπÂèòÊàñËÄÖÁà∂Â≠êÁªÑ‰ª∂‰πãÈó¥Ê≤°ÊúâÊï∞ÊçÆ‰∫§Êç¢‰πü‰ºöËß¶ÂèërenderÔºâ Ë∞ÉÁî®this.forceUpdate ‰∏ãÈù¢ÊòØÊàëÂØπReactÁªÑ‰ª∂ÂõõÊù°Êõ¥Êñ∞Ë∑ØÂæÑÂú∞ÊÄªÁªìÔºö ReactÁªÑ‰ª∂Êõ¥Êñ∞Ë∑ØÂæÑ.png Ê≥®ÊÑèÔºåÂ¶ÇÊûúÂú®shouldComponentUpdateÈáåÈù¢ËøîÂõûfalseÂèØ‰ª•ÊèêÂâçÈÄÄÂá∫Êõ¥Êñ∞Ë∑ØÂæÑ„ÄÇ ‰∏Ä‰∏™ReactÁªÑ‰ª∂ÁîüÂëΩÂë®ÊúüÁöÑÊµãËØï‰æãÂ≠ê‰ª£Á†ÅÊØîËæÉÁÆÄÂçïÔºåÊ≤°ÊúâÈÄªËæëÔºåÂè™ÊòØÂú®ÊØè‰∏™Áõ∏ÂÖ≥ÂáΩÊï∞ÈáåÈù¢alert‰∏Ä‰∏ã„ÄÇÁÇπÂáªÈìæÊé•Êù•ËØïËØïËøô‰∏™‰æãÂ≠ê„ÄÇÊ∫êÁ†ÅÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112class LifeCycle extends React.Component &#123; constructor(props) &#123; super(props); alert("Initial render"); alert("constructor"); this.state = &#123;str: "hello"&#125;; &#125; componentWillMount() &#123; alert("componentWillMount"); &#125; componentDidMount() &#123; alert("componentDidMount"); &#125; componentWillReceiveProps(nextProps) &#123; alert("componentWillReceiveProps"); &#125; shouldComponentUpdate() &#123; alert("shouldComponentUpdate"); return true; // ËÆ∞ÂæóË¶ÅËøîÂõûtrue &#125; componentWillUpdate() &#123; alert("componentWillUpdate"); &#125; componentDidUpdate() &#123; alert("componentDidUpdate"); &#125; componentWillUnmount() &#123; alert("componentWillUnmount"); &#125; setTheState() &#123; let s = "hello"; if (this.state.str === s) &#123; s = "HELLO"; &#125; this.setState(&#123; str: s &#125;); &#125; forceItUpdate() &#123; this.forceUpdate(); &#125; render() &#123; alert("render"); return( &lt;div&gt; &lt;span&gt;&#123;"Props:"&#125;&lt;h2&gt;&#123;parseInt(this.props.num)&#125;&lt;/h2&gt;&lt;/span&gt; &lt;br /&gt; &lt;span&gt;&#123;"State:"&#125;&lt;h2&gt;&#123;this.state.str&#125;&lt;/h2&gt;&lt;/span&gt; &lt;/div&gt; ); &#125;&#125;class Container extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; num: Math.random() * 100 &#125;; &#125; propsChange() &#123; this.setState(&#123; num: Math.random() * 100 &#125;); &#125; setLifeCycleState() &#123; this.refs.rLifeCycle.setTheState(); &#125; forceLifeCycleUpdate() &#123; this.refs.rLifeCycle.forceItUpdate(); &#125; unmountLifeCycle() &#123; // ËøôÈáåÂç∏ËΩΩÁà∂ÁªÑ‰ª∂‰πü‰ºöÂØºËá¥Âç∏ËΩΩÂ≠êÁªÑ‰ª∂ React.unmountComponentAtNode(document.getElementById("container")); &#125; parentForceUpdate() &#123; this.forceUpdate(); &#125; render() &#123; return ( &lt;div&gt; &lt;a href="javascript:;" className="weui_btn weui_btn_primary" onClick=&#123;this.propsChange.bind(this)&#125;&gt;propsChange&lt;/a&gt; &lt;a href="javascript:;" className="weui_btn weui_btn_primary" onClick=&#123;this.setLifeCycleState.bind(this)&#125;&gt;setState&lt;/a&gt; &lt;a href="javascript:;" className="weui_btn weui_btn_primary" onClick=&#123;this.forceLifeCycleUpdate.bind(this)&#125;&gt;forceUpdate&lt;/a&gt; &lt;a href="javascript:;" className="weui_btn weui_btn_primary" onClick=&#123;this.unmountLifeCycle.bind(this)&#125;&gt;unmount&lt;/a&gt; &lt;a href="javascript:;" className="weui_btn weui_btn_primary" onClick=&#123;this.parentForceUpdate.bind(this)&#125;&gt;parentForceUpdateWithoutChange&lt;/a&gt; &lt;LifeCycle ref="rLifeCycle" num=&#123;this.state.num&#125;&gt;&lt;/LifeCycle&gt; &lt;/div&gt; ); &#125;&#125;ReactDom.render( &lt;Container&gt;&lt;/Container&gt;, document.getElementById('container'));]]></content>
      <categories>
        <category>ÂâçÁ´Ø</category>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂâçÁ´ØÊåáÂçó-reactÂø´ÈÄüÂºÄÂèë]]></title>
    <url>%2F2017%2F12%2F23%2F%E5%89%8D%E7%AB%AF%E6%8C%87%E5%8D%97-react%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91%2F</url>
    <content type="text"><![CDATA[ReactÈ°πÁõÆÂºÄÂèëÈÄöËøá npm ‰ΩøÁî® ReactÂ¶ÇÊûú‰Ω†ÁöÑÁ≥ªÁªüËøò‰∏çÊîØÊåÅ Node.js Âèä NPM ÂèØ‰ª•ÂèÇËÄÉÊàë‰ª¨ÁöÑ Node.js ÊïôÁ®ã„ÄÇ Êàë‰ª¨Âª∫ËÆÆÂú® React ‰∏≠‰ΩøÁî® CommonJS Ê®°ÂùóÁ≥ªÁªüÔºåÊØîÂ¶Ç browserify Êàñ webpackÔºåÊú¨ÊïôÁ®ã‰ΩøÁî® webpack„ÄÇ ÂõΩÂÜÖ‰ΩøÁî® npm ÈÄüÂ∫¶ÂæàÊÖ¢Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî®Ê∑òÂÆùÂÆöÂà∂ÁöÑ cnpm (gzip ÂéãÁº©ÊîØÊåÅ) ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑‰ª£ÊõøÈªòËÆ§ÁöÑ npm: 12$ npm install -g cnpm --registry=https://registry.npm.taobao.org$ npm config set registry https://registry.npm.taobao.org ËøôÊ†∑Â∞±ÂèØ‰ª•‰ΩøÁî® cnpm ÂëΩ‰ª§Êù•ÂÆâË£ÖÊ®°Âùó‰∫ÜÔºö 1$ cnpm install [name] Êõ¥Â§ö‰ø°ÊÅØÂèØ‰ª•Êü•ÈòÖÔºöhttp://npm.taobao.org/„ÄÇ ‰ΩøÁî® create-react-app Âø´ÈÄüÊûÑÂª∫ React ÂºÄÂèëÁéØÂ¢Écreate-react-app ÊòØÊù•Ëá™‰∫é FacebookÔºåÈÄöËøáËØ•ÂëΩ‰ª§Êàë‰ª¨Êó†ÈúÄÈÖçÁΩÆÂ∞±ËÉΩÂø´ÈÄüÊûÑÂª∫ React ÂºÄÂèëÁéØÂ¢É„ÄÇ create-react-app Ëá™Âä®ÂàõÂª∫ÁöÑÈ°πÁõÆÊòØÂü∫‰∫é Webpack + ES6 „ÄÇ ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÂàõÂª∫È°πÁõÆÔºö 12345678$ cnpm install -g create-react-app$ create-react-app my-app$ cd my-app/$ npm startyarn startyarn build 1234567891011121314151617 yarn start Starts the development server. yarn build Bundles the app into static files for production. yarn test Starts the test runner. yarn eject Removes this tool and copies build dependencies, configuration files and scripts into the app directory. If you do this, you can‚Äôt go back!We suggest that you begin by typing: cd billing-monitor-web yarn start ‰ΩøÁî®yarnÊûÑÂª∫ÂâçÁ´Ø1234563425 npm install yarn -g //ÂÖ®Â±ÄÂÆâË£Öyarn,‰∏çÂú®package.jsonÊñá‰ª∂3426 ls3427 yarn add serve -g //ÂÖ®Â±ÄÂÆâË£Öserve,Êúâ‰∏™ÊúçÂä°ÂÆπÂô®3428 lsysq3429 yarn start //ÂêØÂä®È°πÁõÆyarn build ÊûÑÂª∫ÂâçÁ´Ø nodeÈ°πÁõÆÂºÄÂèë##ËøõÂÖ•Â∑•Á®ãÁõÆÂΩï 1cd $&#123;project_path&#125; ##‰ªégit‰∏≠Ëé∑ÂèñÊúÄÊñ∞‰ª£Á†Å 12git pullgit checkout $&#123;tag_name&#125; ##ËøêË°ånpm install 1npm install Êü•Áúãpm2ËøõÁ®ãid1pm2 list ÂÅúÊ≠¢ÂéüÊúçÂä° 1pm2 delete $&#123;pm2_ID&#125; ÂêØÂä®ÊúçÂä° ÂàáÊç¢NODE_VERSION 1nvm use $&#123;node_version&#125; ÂêØÂä®ÊúçÂä° 1NODE_ENV=$&#123;env&#125; pm2 start $&#123;main_script&#125; Ê£ÄÊü•ÊúçÂä°ËøêË°åÊÉÖÂÜµ 12pm2 list #Êü•ÁúãÂΩìÂâçÊâÄÊúâËøêË°åÊúçÂä°pm2 logs $&#123;pm2_ID&#125; #Êü•ÁúãÊüêÊúçÂä°ÁöÑÊó•Âøó 123456$&#123;project_path&#125;: ~/lss_core$&#123;tag_name&#125;: release-20160705-GATEWAY-40$&#123;pm2_ID&#125;: // Get by pm2 list$&#123;node_version&#125;: 0.10.44$&#123;env&#125;: prod // dev | test | uat | prod$&#123;main_script&#125;: lss-core.js 123npm install xxx ‚Äîsavepm2 logs 39pm2 list]]></content>
      <categories>
        <category>ÂâçÁ´Ø</category>
        <category>react</category>
      </categories>
      <tags>
        <tag>ÂâçÁ´ØÊåáÂçó</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LinuxÊé¢Á©∂-Á°¨ËøûÊé•‰∏éÁ¨¶Âè∑ËøûÊé•]]></title>
    <url>%2F2017%2F12%2F20%2FLinux%E6%8E%A2%E7%A9%B6-%E7%A1%AC%E8%BF%9E%E6%8E%A5%E4%B8%8E%E7%AC%A6%E5%8F%B7%E8%BF%9E%E6%8E%A5%2F</url>
    <content type="text"><![CDATA[ÂàõÂª∫Á°¨ËøûÊé•1234mkdit aa.txtvim aa.txtln aa.txt aa-hard Ê≥®ÊÑèÊó†ËÆ∫‰øÆÊîπaa.txt aa-hard‰∏≠ÁöÑ‰ªª‰Ωï‰∏Ä‰∏™ÔºåÂÜÖÂÆπÈÉΩ‰ºöÂêåÊó∂ÂèòÂåñ„ÄÇ Âà†Èô§ÂÖ∂‰∏≠‰ªª‰Ωï‰∏Ä‰∏™ÔºåÂè¶‰∏Ä‰∏™Ëøò‰ºöÂ≠òÂú®„ÄÇ 12345# Êü•ÁúãÂΩìÂâçÁõÆÂΩïÁöÑÂ≠óËäÇÊï∞du -sb# Êü•ÁúãiNode‰ºöÊåáÂêëÂêå‰∏Ä‰∏™ls -i ÂàõÂª∫Á¨¶Âè∑ËøûÊé•Symbolic1ln -s aa.txt aa-symbolic Ê≥®ÊÑèÁ¨¶Âè∑ËøûÊé•Â¶ÇÊûúÊåáÂêëÁõÆÂΩïÔºå‰ºöÁõ¥Êé•ÂØπÂéüÁõÆÂΩïÁöÑÂÜÖÂÆπÊìç‰ΩúÔºåÂ¢ûÂà†ÊîπÔºåË¶ÅÂ∞èÂøÉ„ÄÇ ###]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TomcatËß£ÊÉë ‰πã CATALINA_HOME‰∏éCATALINA_BASE]]></title>
    <url>%2F2017%2F12%2F19%2FTomcat%E8%A7%A3%E6%83%91-%E4%B9%8B-CATALINA-HOME%E4%B8%8ECATALINA-BASE%2F</url>
    <content type="text"><![CDATA[ÁúãTomcatÊ∫êÁ†Å‰∏ÄÊÆµÊó∂Èó¥‰∏ÄÁõ¥ÂæàÂ•ΩÂ•á‰∏∫‰ªÄ‰πàÊúâCATALINA_HOMEÂíåCATALINA_BASEÂå∫Âà´Ôºö ÂàÜCATALINA_HOMEÂíåCATALINA_BASEÊ¶ÇÂøµÊòØ‰∏∫‰∫ÜËß£ÂÜ≥ËøôÊ†∑ÁöÑÂú∫ÊôØÔºö ‰Ω†ÈúÄË¶ÅÂú®‰∏ÄÂè∞Êú∫Âô®‰∏äÈù¢ÈÉ®ÁΩ≤Â§ö‰∏™TomcatÂÆû‰æãÔºå‰ΩÜÊòØ‰Ω†Âèà‰∏çÊÉ≥ÂàõÂª∫Â§ö‰∏™TomcatÁöÑÂâØÊú¨ÔºåÊç¢Âè•ËØùËØ¥Â∞±ÊòØËÆ©Ëøô‰∫õTomcatÂâØÊú¨Êã•ÊúâËá™Â∑±ÁöÑÂ∑•‰ΩúÁõÆÂΩï‰ΩÜÊòØÂÖ±‰∫´TomcatÁöÑ‰ª£Á†Å„ÄÇ ÂÖ≥‰∫éCATALINA_HOMEÂíåCATALINA_BASEÂÆòÊñπÊñáÊ°£‰∏äÈù¢ÊòØËøôÊ†∑Ëß£ÈáäÁöÑÔºö [html] view plain copy Throughout the docs, you‚Äôll notice there are numerous references to $CATALINA_HOME. This represents the root of your Tomcat installation. When we say, ‚ÄúThis information can be found in your $CATALINA_HOME/README.txt file‚Äù we mean to look at the README.txt file at the root of your Tomcat install. Optionally, Tomcat may be configured for multiple instances by defining $CATALINA_BASE for each instance. If multiple instances are not configured, $CATALINA_BASE is the same as $CATALINA_HOME. ÁøªËØëËøáÊù•Â∞±ÊòØCATALINA_HOMEÊòØTomcatÁöÑÂÆâË£ÖÁõÆÂΩïÔºåCATALINA_BASEÊòØTomcatÁöÑÂ∑•‰ΩúÁõÆÂΩï CATALINA_BASEÊòØÂíåÊØè‰∏™TomcatÂÆû‰æãÁõ∏ÂÖ≥ÁöÑÔºåÊé•‰∏ãÊù•Êàë‰ª¨Êù•‰∏ÄËµ∑Áé©‰∏Ä‰∏ã‰∏äÈù¢ÊèèËø∞ÁöÑÈÇ£‰∏™Âú∫ÊôØ ÊèèËø∞:CATALINA_HOMEÊòØTomcatÁöÑÂÆâË£ÖÁõÆÂΩïÔºåCATALINA_BASEÊòØTomcatÁöÑÂ∑•‰ΩúÁõÆÂΩï‰ΩúÁî®:ÈÄöËøáÂ§öÂ∑•‰ΩúÁõÆÂΩï(CATALINA_BASE),ÂçïÂÆâË£ÖÁõÆÂΩï(CATALINA_HOME). ÂèØÂÆûÁé∞ÊØè‰∏™Â∫îÁî®ÂÖ±Áî®‰∏Ä‰∏™tomcat‰ΩÜ‰∏çÂÖ•‰æµÂÆâË£ÖÁõÆÂΩï,ÂèØ‰ª•ÂàÜÂà´ÈÖçÁΩÆ. ÂÖà‰∏ã‰∏Ä‰∏™TomcatÁöÑzipÂèëÂ∏ÉÁâàÊú¨ÂèØ‰ª•Âú®ËøôÈáå‰∏ãËΩΩÔºöhttp://archive.apache.org/dist/tomcat/tomcat-7/v7.0.69/bin/ Ëß£ÂéãÂà∞FÁõòÔºåÁÑ∂ÂêéÊñ∞Âª∫‰∏§‰∏™ÁõÆÂΩï ÂàÜÂà´‰∏∫tomcat ins1Âíåtomcat ins2 ÊääTomcatÁöÑÂÖ±‰∫´Êñá‰ª∂Â§πÂàÜÂà´Êã∑Ë¥ùÂà∞tomcat ins1Âíåtomcat ins2‰∏≠ÔºåÊúâ ÁÑ∂ÂêéÂú® ÁÑ∂ÂêéÂú®tomcat ins1ÁöÑÊñá‰ª∂Â§π‰∏ãÂàõÂª∫startup.bat Êñá‰ª∂ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö [plain] view plain copy set ‚ÄúCATALINA_BASE=%cd%‚Äù set ‚ÄúCATALINA_HOME=F:\apache-tomcat-7.0.69‚Äù set ‚ÄúEXECUTABLE=%CATALINA_HOME%\bin\catalina.bat‚Äù4.5. call ‚Äú%EXECUTABLE%‚Äù start ÁÑ∂ÂêéÊàë‰ª¨ÂèØ‰ª•Âú®tomcat ins1‰∏ãÁöÑconf‰∏≠ÁöÑserver.xml‰∏≠‰øÆÊîπhttpÁ´ØÂè£Âè∑ÂàÜÂà´‰∏∫7070 tomcat ins2ÁöÑÂÅöÊ≥ïÂíåtomcat ins1‰∏ÄÊ†∑Âè™‰∏çËøáÁ´ØÂè£Âè∑Êîπ‰∏∫9090 ÂàÜÂà´ÂèåÂáªstartup.bat ÁÑ∂ÂêéËÆøÈóÆTomcat‰Ω†‰ºöÁúãÂà∞Ôºö]]></content>
      <categories>
        <category>tomcat</category>
      </categories>
      <tags>
        <tag>tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á≤æÁªÜÂåñJVMÂ∫îÁî®ÊÄßËÉΩÂâñÊûêÂ∑•ÂÖ∑]]></title>
    <url>%2F2017%2F12%2F19%2F%E7%B2%BE%E7%BB%86%E5%8C%96JVM%E5%BA%94%E7%94%A8%E6%80%A7%E8%83%BD%E5%89%96%E6%9E%90%E5%B7%A5%E5%85%B7%2F</url>
    <content type="text"><![CDATA[‰Ωï‰∏∫Á≤æÁªÜÂåñÔºüÈïøÊúü‰ª•Êù•ÂêÑ‰∏™‰∏öÂä°Á∫øÂºÄÂèëÈ•±ÂèóÊÄßËÉΩÈóÆÈ¢òÁöÑÂõ∞Êâ∞„ÄÇ ‰ªéÂèçÈ¶àÂíåËßÇÂØüÊù•ÁúãÔºåÊàë‰ª¨Èù¢‰∏¥‰∏ãÈù¢‰∏ÄÁ≥ªÂàóÁöÑÈóÆÈ¢òÔºö ‰∏çÊ∏ÖÊ•öÂ∫îÁî®ÁöÑËøêË°åÊÉÖÂÜµÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫éGCÊÉÖÂÜµ„ÄÅÁÉ≠ÁÇπ‰ª£Á†Å„ÄÅÁ∫øÁ®ã„ÄÅÂºÇÂ∏∏ÔºàÁâπÂà´ÊòØË¢´ÂêûÊ≤°ÁöÑÂºÇÂ∏∏ÔºâÔºõ ‰∏çÊ∏ÖÊ•öÂ∫îÁî®‰ª£Á†ÅÊâßË°åÊÉÖÂÜµÔºåÁîöËá≥‰∏çÁü•ÈÅìÊüê‰∏™Ê®°ÂùóÊòØÂê¶ËøòÂèØËÉΩ‰ºöËøêË°åÔºåÂ∞§ÂÖ∂ÊòØÂØπ‰∫éÊúâÁùÄ‰∏ÄÂÆöÂéÜÂè≤ÁöÑÂ∫îÁî®ÔºåÂèØËÉΩÂ∑≤ÁªèÊúâÂæàÂ§öÂºÄÂèëÂú®‰∏äÈù¢Ë¥°ÁåÆËøá‰ª£Á†ÅÔºå‰ΩÜÈöèÁùÄ‰∏öÂä°ÂèëÂ±ïËøô‰∫õÂäüËÉΩÂèØËÉΩÂ∑≤Áªè‰∏çÂÜçË¢´‰ΩøÁî®Ôºõ ‰∏çÊ∏ÖÊ•öÂ∫îÁî®ÁöÑIOÊÉÖÂÜµÔºåÊ≥®ÊÑèÔºåËøôÈáåËØ¥ÁöÑÁªùÂØπ‰∏ç‰ªÖ‰ªÖÊòØzabbix‰∏äÁöÑ‚ÄùÁ£ÅÁõòIO‚ÄùÔºåËÄåÊòØÂÖ∑‰ΩìÂà∞Êüê‰∏™Êñá‰ª∂„ÄÅÊüê‰∏™Á´ØÂè£„ÄÅÊüê‰∏™Á∫øÁ®ãÁöÑIOÊÉÖÂÜµÔºõ Ëøô‰∫õÈóÆÈ¢òÂØºËá¥ÁöÑÁõ¥Êé•ÂêéÊûúÂ∞±ÊòØÔºöÂØπ‰∫éÊÄßËÉΩ‰ºòÂåñÔºåÊó†‰ªé‰∏ãÊâãÔºåÂè™ËÉΩÂá≠ÁªèÈ™åÂíåÁõ¥ËßâÂéªÁåúÊµã„ÄÅÂüãÁÇπ„ÄÅ‰ºòÂåñÔºåÂΩìÁÑ∂ÔºåÊúÄÁªàÁªìÊûú‰∏ÄËà¨Â∞±ÊòØ‚ÄúÂä†Êú∫Âô®Êâ©ÂÆπ‚Äù„ÄÇ ÊòØÊó∂ÂÄôÁªìÊùüËøôÁßçÁ≤óÊîæÈáéËõÆÁöÑÊÄßËÉΩÂàÜÊûêË∞É‰ºò‰∫ÜÔºÅ ÂÄºÂæóÈ´òÂÖ¥ÁöÑÊòØÁé∞Âú®ÊâÄÊúâÁöÑJDK7‰ª•‰∏äÁâàÊú¨Â∑≤ÁªèÂÜÖÁΩÆ‰∫Ü‰∏ÄÊ¨æÊñ∞ÂûãÁöÑÊÄßËÉΩÂâñÊûêÂ∑•ÂÖ∑Ôºå‰πüÂ∞±ÊòØ‰ªäÂ§©Ë¶ÅÈáçÁÇπ‰ªãÁªçÁöÑÔºçJava Flight RecorderÔºåÁÆÄÁß∞JFR„ÄÇ JFRÁ©∂Á´üÊòØ‰ªÄ‰πàÔºüJava Flight RecorderÔºàJFRÔºâÊú¨Êù•ÊòØ‰∏Ä‰∏™ÂïÜ‰∏öÁâπÊÄßÔºåÁî®Âú®Áîü‰∫ßÊúçÂä°Âô®‰∏äÊòØÈúÄË¶ÅÂïÜ‰∏öËÆ∏ÂèØÔºàËøôÂÖ∂ÂÆûÊòØÂ∫üËØùÔºåÂõ†‰∏∫Áé∞Âú®‰∏çÈúÄË¶ÅËÆ∏ÂèØ‰πüÂèØ‰ª•Áõ¥Êé•Áî®Ôºâ„ÄÇ JFR ËÆ∞ÂΩï‰∫ÜÂÖ≥‰∫é Java ËøêË°åÊó∂ÂèäËøêË°åÂú®ÂÖ∂ÂÜÖÁöÑ Java Â∫îÁî®Á®ãÂ∫èÁöÑËØ¶ÁªÜ‰ø°ÊÅØÔºåËÆ∞ÂΩïÁî®Â∞ëÈáèÁöÑÂºÄÈîÄÂÆåÊàê„ÄÇÊï∞ÊçÆÊòØ‰Ωú‰∏∫Êó∂Èó¥‰∏äÁöÑÊï∞ÊçÆÁÇπÔºàÁß∞‰∏∫‰∫ã‰ª∂ÔºâËÆ∞ÂΩïÁöÑ„ÄÇÂÖ∏ÂûãÁöÑ‰∫ã‰ª∂ÂèØ‰ª•ÊòØÁ∫øÁ®ãÁ≠âÂæÖÈîÅ„ÄÅGC„ÄÅCPU Âë®Êúü‰ΩøÁî®Êï∞ÊçÆÁ≠â„ÄÇ Âú®ÂàõÂª∫È£ûË°åËÆ∞ÂΩïÊó∂Ôºå‰Ω†ÂèØ‰ª•ÈÄâÊã©Âì™‰∫õ‰∫ã‰ª∂Â∫îÂΩì‰øùÂ≠òÔºåËøôÂè´ÂÅöËÆ∞ÂΩïÊ®°Êùø„ÄÇÊúâ‰∫õÊ®°ÊùøÂè™‰øùÂ≠òÂü∫Êú¨‰∫ã‰ª∂ÔºåÂØπÊÄßËÉΩÂá†‰πéÊ≤°ÊúâÂΩ±Âìç„ÄÇÂÖ∂‰ªñÊ®°ÊùøÂèØËÉΩÊúâËΩªÂæÆÁöÑÊÄßËÉΩÂºÄÈîÄÔºåËøòÂèØËÉΩËß¶Âèë GC Êù•Êî∂ÈõÜÊõ¥Â§ö‰ø°ÊÅØ„ÄÇÈÄöÂ∏∏ÔºåË∂ÖËøáÁôæÂàÜ‰πãÂá†ÁöÑÂºÄÈîÄÊòØÂæàÁΩïËßÅ„ÄÇÈ£ûË°åËÆ∞ÂΩïÂèØÁî®‰∫éË∞ÉËØïÂæàÂ§ßËåÉÂõ¥ÁöÑÈóÆÈ¢òÔºå‰ªéÊÄßËÉΩÈóÆÈ¢òÂà∞ÂÜÖÂ≠òÊ≥ÑÊºèÊàñ‰∏•ÈáçÁöÑÈîÅÁ´û‰∫â„ÄÇ Ê≥®ÊÑèÔºåJFRÊòØ‰∏Ä‰∏™ÊÄßËÉΩÊï∞ÊçÆÈááÈõÜÂ∑•ÂÖ∑ÔºåÂÆÉÊääÊúÄÁªàÈááÈõÜÂà∞ÁöÑÊï∞ÊçÆÂ≠òÂú®‰∏Ä‰∏™Ê†ºÂºè‰∏∫jfrÁöÑÊñá‰ª∂‰∏≠ÔºåÁî±‰∫éÊú¨Ë∫´Âπ∂‰∏çÂÖ∑Â§áÊï∞ÊçÆÂàÜÊûêÊàñËÄÖÂèØËßÜÂåñÂäüËÉΩÔºåÊâÄ‰ª•‰∏ÄËà¨Êàë‰ª¨ÈúÄË¶ÅÈÖçÂêàJDKÂè¶Â§ñ‰∏Ä‰∏™ÂÜÖÁΩÆÂ∑•ÂÖ∑ÔºåÂç≥JMC‰∏ÄËµ∑‰ΩøÁî®„ÄÇ JMCÂèàÊòØ‰ªÄ‰πàÔºüÂÆÉÊòØÂú® JAVA 7u40 ÂèëÂ∏É‰∏≠Âä†ÂÖ•ÁöÑÂõæÂΩ¢ÂåñÊÄßËÉΩÁõëÊéßÂ∑•ÂÖ∑ÔºåÂÆÉÂèØ‰ª•Áõ¥Êé•ÊâìÂºÄÁî±jfrÁîüÊàêÁöÑÂéüÂßãÊï∞ÊçÆÈááÈõÜÊñá‰ª∂Ôºå ËØ∑Âú®Ëá™Â∑±Êú∫Âô®ÁöÑÂëΩ‰ª§Ë°åËæìÂÖ• jmc Êù•‰ΩìÈ™å„ÄÇ Áõ∏ÊØîÂÖ∂ÂÆÉProfileÂ∑•ÂÖ∑Êúâ‰ªÄ‰πà‰ºòÁÇπÔºüÂú®ÂºÄÂèëÁéØÂ¢É‰∏≠ÔºåÊàë‰ª¨Áî®VisualVM„ÄÅJProfilerÁ≠âÔºåÂäüËÉΩÂº∫Â§ßÔºåÊîØÊåÅÂõæÂΩ¢ÂåñÁïåÈù¢Êìç‰ΩúÔºåÂèØ‰ª•ÂæàÂø´ÂÆö‰Ωç‰ª£Á†ÅÈóÆÈ¢ò„ÄÇ ‰ΩÜÊòØ‰ªñ‰ª¨ÂØπÂ∫îÁî®ÊÄßËÉΩÁöÑÂΩ±Âìç‰πüÈùûÂ∏∏Â§ßÔºåÊâÄ‰ª•‰∏çÈÄÇÂêàÂú®Áîü‰∫ßÁéØÂ¢É‰∏ã‰ΩøÁî®„ÄÇËøòÊúâËøô‰∫õËΩØ‰ª∂Ë¶ÅattachÂà∞jvmËøõÁ®ã‰∏äÔºåÁîü‰∫ßÁéØÂ¢É‰∏ÄËà¨ÁΩëÁªúÈöîÁ¶ªÔºåÂæàÈöæÂÅöÂà∞„ÄÇ Âú®Áîü‰∫ßÁéØÂ¢ÉÊàë‰ª¨ÊúÄÂ∏∏Áî®ÁöÑprofilingÂ∑•ÂÖ∑Â∞±ÊòØjava/bin‰∏ãÁöÑjstackÔºåÂ§öÂÅöÂá†Ê¨°jstackÔºå‰πüÁõ∏ÂΩì‰∫éprofiling‰∫Ü„ÄÇ jstackÊñπ‰æøÊòìÁî®Ôºå‰ΩÜÂπ∂‰∏çÊòØÁâπÂà´ÈÄÇÂêàÊù•ÂÅöprofilingÔºåÊìç‰ΩúÈ¢ëÁéá‰ΩéÔºå‰ºöÂØºËá¥safepointÊåáÊ†áÊÄ•ÂâßÂ¢ûÈïøÁ≠âÁ≠â„ÄÇ ÈáçÁÇπÊù•‰∫ÜÔºå‰ΩøÁî®jfr‰∏çÈúÄË¶ÅÂú®Áé∞ÊúâÂ∫îÁî®‰∏äÈ¢ùÂ§ñÊ∑ªÂä†‰ªª‰ΩïÂèÇÊï∞„ÄÅÈáçÂêØËøõÁ®ãÁ≠âÔºåÁõ¥Êé•Âú®ÂëΩ‰ª§Ë°åÊâßË°åÂç≥ÂèØÔºåÂÆûÊó∂ÁîüÊïàÔºå100%Êó†ÂÖ•‰æµÔºå‰∏îÁ®≥ÂÆöÂèØÈù†Ôºå‰∏çÂΩ±ÂìçÁ∫ø‰∏äÂ∫îÁî®ËøêË°å„ÄÇ ÂÆâÂÖ®ÊÄßÂ¶Ç‰ΩïÔºüÁî±‰∫éËøô‰∏™Â∑•ÂÖ∑ÂèØ‰ª•Áõ¥Êé•Âú®Á∫ø‰∏ä‰ΩøÁî®ÔºåÈÇ£‰πàÂÆÉ‰ºöÊúâÂÆâÂÖ®ÊÄßÈóÆÈ¢òÂêóÔºü‰ºöÈÄ†ÊàêÂÆ¢Êà∑Êï∞ÊçÆÊ≥ÑÈú≤ÂêóÔºü Á≠îÊ°àÊòØÂê¶ÂÆöÁöÑÔºåÂõ†‰∏∫jfrÈááÈõÜÁöÑÊÄßËÉΩÊï∞ÊçÆÂÖ∂ÂÆûÂèØ‰ª•Áúã‰ΩúÊòØJVMÊú¨Ë∫´ÁöÑÂÖÉÊï∞ÊçÆËÄå‰∏çÊòØ‰∏öÂä°Êï∞ÊçÆÔºåÂõ†Ê≠§‰∏çÂ≠òÂú®‰ªª‰ΩïÂÆâÂÖ®ÊÄßÈóÆÈ¢òÔºåÂèØ‰ª•ÊîæÂøÉ‰ΩøÁî®„ÄÇ ‰ΩøÁî®ÊñπÂºèÁúã‰∫Ü‰ª•‰∏äËøô‰πàÂ§öÁêÜÔºàÂ∫üÔºâËÆ∫ÔºàËØùÔºâÁõ∏‰ø°ÂêÑ‰ΩçÂ∑≤ÁªèË∑ÉË∑ÉÊ¨≤ËØïÔºåÈÇ£‰πàÔºåJFRËØ•Â¶Ç‰Ωï‰ΩøÁî®ÔºüÂæàÁÆÄÂçïÔºåÊåâÁÖß‰∏ãÈù¢‰∏â‰∏™Ê≠•È™§Êìç‰ΩúÔºõ ÈÄâÂÆö‰∏ÄÂè∞Êú∫Âô®ÔºåÁôªÈôÜ‰∏äÂéªÔºåÂπ∂ÊâæÂà∞Ë¶ÅÁõëÊéßÁöÑËøõÁ®ãPID Â∞ÜÈôÑ‰ª∂Êñá‰ª∂(tongdun.jfc)ÊîæÂÖ•Âà∞ /usr/install/java/jdk1.8.0_60/jre/lib/jfr ÁõÆÂΩïÔºåÊ≥®ÊÑèÔºåËøô‰∏™ÈÖçÁΩÆÊñá‰ª∂ÊòØÂú®ÂÆòÊñπÈÖçÁΩÆ‰∏äÂ¢ûÂä†‰∫ÜÂØπÂºÇÂ∏∏Êï∞ÊçÆÁöÑÈááÈõÜ„ÄÇÊé®Ëçê‰ΩøÁî®„ÄÇ ÊâßË°å‰∏ãÂàóÂëΩ‰ª§ÔºåÂÖ∂‰∏≠ËØ∑Ëá™Ë°åÊõøÊç¢Ôºö ËøôÊ†∑Â∞±Â•Ω‰∫ÜÔºåÂ¶Ç‰∏äÔºåÁ≠âÂæÖ2ÂàÜÈíüÔºã20ÁßíÔºå/tmp/pid.jfrÊñá‰ª∂Â∞±ÁîüÊàêÂ•Ω‰∫ÜÔºåËøô‰∏™Êñá‰ª∂Áõ¥Êé•ÂØºÂÖ•JMCÂ∑•ÂÖ∑Âç≥ÂèØ JMC‰ø°ÊÅØ]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>jvm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[intelliJ ËøúÁ®ãË∞ÉËØï]]></title>
    <url>%2F2017%2F12%2F18%2FintelliJ-%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95%2F</url>
    <content type="text"><![CDATA[Êü•Áúãaddress‰∏∫9996 1ps -ef | grep java | grep address 1admin 3052 1 19 19:02 ? 00:02:10 /usr/install/jdk1.8.0_60/bin/java -Djava.util.logging.config.file=/home/admin/billing/deploy/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Xms2g -Xmx2g -XX:PermSize=512m -XX:SurvivorRatio=2 -XX:+UseParallelOldGC -Dtrace.flag=true -Dtrace.output.dir=/home/admin/billing/deploy/trace/ -server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,address=9996,server=y,suspend=n -Djava.awt.headless=true -Djava.net.preferIPv4Stack=true -Dfile.encoding=UTF-8 -DdisableIntlRMIStatTask=true -Ddubbo.application.logger=slf4j -Djdk.tls.ephemeralDHKeySize=2048 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=10.57.19.253 -Djava.endorsed.dirs=/usr/install/tomcat/endorsed -classpath /usr/install/tomcat/bin/bootstrap.jar:/usr/install/tomcat/bin/tomcat-juli.jar -Dcatalina.base=/home/admin/billing/deploy/tomcat -Dcatalina.home=/usr/install/tomcat -Djava.io.tmpdir=/home/admin/billing/deploy/tomcat/temp org.apache.catalina.startup.Bootstrap start Êü•ÁúãÂΩìÂâçËøõÁ®ãËøúÁ®ãÊàêÂäü 1netstat -an | grep 9996 1tcp 0 0 10.57.19.253:9996 10.57.241.56:62655 ESTABLISHED]]></content>
      <categories>
        <category>Á∫ø‰∏äÊïÖÈöúÊéíÊü•</category>
      </categories>
      <tags>
        <tag>debug</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2017%2F12%2F13%2Fvi-vim%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C%2F</url>
    <content type="text"><![CDATA[viÁä∂ÊÄÅÊâßË°åÂëΩ‰ª§1:! echo $JAVA_HOME ÂÖâÊ†áÁßªÂä®ÂçïËØçÁßªÂä®ÂêëÂêéÁßªÂä®ÂçïËØç1w ÂêëÂâçÁßªÂä®ÂçïËØç1b ÁßªÂä®Âà∞Ë°åÈ¶ñ10 ÁßªÂä®Âà∞Ë°åÂ∞æ 1$ Âà†Èô§ÂçïË°åÂà†Èô§ Âà†Ëá≥Ë°åÈ¶ñ1d0 Âà†Ëá≥Ë°åÂ∞æ1d$ Âà†Èô§ÂΩìÂâçË°å 1dd Â§öË°åÂà†Èô§ ndd Âà†Èô§‰ª•ÂΩìÂâçË°åÂºÄÂßãÁöÑnË°å 13dd Â§öË°åÂà†Èô§ÔºåÂà†Èô§1Âà∞10Ë°å 1: 1,10d ‰ªéÂΩìÂâçË°åÂà†Èô§Âà∞ÂÄíÊï∞ÊúÄÂêé‰∏ÄË°å 1: .,$-1d ‰ªéÊüêË°åÂºÄÂßãËá≥ÊñáÊú¨Êú´Â∞æÂÖ®ÈÉ®Âà†Èô§ÔºåÂà†Èô§Á¨¨8Ë°åËá≥Êú´Â∞æ 1: 8Ôºå$d Âà†Èô§ÂÖ®ÈÉ® 1‰ª£Ë°®ÂºÄÂßãÁ¨¨‰∏ÄË°åÔºå$Ê†áËØÜÁªìÊùüË°åÔºådÂà†Èô§ÂëΩ‰ª§ 1: 1,$d Êü•Êâæ‰ΩçÁΩÆ Ë∑≥Âà∞È¶ñË°å 1gg Ë∑≥Âà∞Â∞æ‰∏ÄË°å 1GG Ë∑≥ËΩ¨Âà∞ÊñáÊú¨ÁöÑÁ¨¨12Ë°å 1212gg / 12G:12 Êü•Êâæ Âêë‰∏ãÊü•Êâæ 1/text Âêë‰∏äÊü•Êâæ 1?text nÈáçÂ§ç‰∏ä‰∏ÄÊ¨°ÁöÑÊü•ÊâæÂëΩ‰ª§ shift n ÂèçÂêëÈáçÂ§ç‰∏ä‰∏ÄÊ¨°ÁöÑÊü•ÊâæÂëΩ‰ª§ ÊñáÊú¨‰∏≠ÊÉ≥Êü•ÁúãÂΩìÂâçË°å‰ø°ÊÅØÔºåÂèØËæìÂÖ•Ôºö ctrl + g]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>vi</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[guavaÈõÜÂêàapiÂ≠¶‰π†]]></title>
    <url>%2F2017%2F11%2F30%2Fguava%E9%9B%86%E5%90%88api%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[1ÔºåÂ§ßÁ∫≤ ËÆ©Êàë‰ª¨Êù•ÁÜüÊÇâÁìúÂ®ÉÔºåÂπ∂‰ΩìÈ™å‰∏ãÂÆÉÁöÑ‰∏Ä‰∫õAPI,ÂàÜÊàêÂ¶Ç‰∏ãÂá†‰∏™ÈÉ®ÂàÜÔºö Introduction Guava Collection API Guava Basic Utilities IO API Cache API 2Ôºå‰∏∫Á•ûÈ©¨ÈÄâÊã©ÁìúÂ®ÉÔºü ÁìúÂ®ÉÊòØjava APIËõãÁ≥ï‰∏äÁöÑÂÜ∞ÊøÄÂáåÔºàÁ≤æÂçéÔºâ È´òÊïàËÆæËÆ°ËâØÂ•ΩÁöÑAPI. Ë¢´googleÁöÑÂºÄÂèëËÄÖËÆæËÆ°ÔºåÂÆûÁé∞Âíå‰ΩøÁî®„ÄÇ ÈÅµÂæ™È´òÊïàÁöÑjavaËøôÊú¨‰π¶ÁöÑÂ•ΩÁöÑËØ≠Ê≥ïÂÆûË∑µ„ÄÇ ‰Ωø‰ª£Á†ÅÊõ¥ÂàªÂ∫¶ÔºåÁÆÄÊ¥ÅÔºåÁÆÄÂçï„ÄÇ ‰ΩøÁî®java 1.5ÁöÑÁâπÊÄßÔºå ÊµÅË°åÁöÑAPIÔºåÂä®ÊÄÅÁöÑÂºÄÂèë ÂÆÉÊèê‰æõ‰∫ÜÂ§ßÈáèÁõ∏ÂÖ≥ÁöÑÂ∫îÁî®Á±ªÔºåÈõÜÂêàÔºåÂ§öÁ∫øÁ®ãÔºåÊØîËæÉÔºåÂ≠óÁ¨¶‰∏≤ÔºåËæìÂÖ•ËæìÂá∫ÔºåÁºìÂ≠òÔºåÁΩëÁªúÔºåÂéüÁîüÁ±ªÂûãÔºåÊï∞Â≠¶ÔºåÂèçÂ∞ÑÁ≠âÁ≠â ÁôæÂàÜÁôæÁöÑÂçïÂÖÉÊµãËØïÔºåË¢´ÂæàÂ§öÁöÑÈ°πÁõÆ‰ΩøÁî®ÔºåÂ∏ÆÂä©ÂºÄÂèëËÄÖ‰∏ìÊ≥®‰∏öÂä°ÈÄªËæëËÄå‰∏çÊòØÂÜôjavaÂ∫îÁî®Á±ª ËäÇÁúÅÊó∂Èó¥ÔºåËµÑÊ∫êÔºåÊèêÈ´òÁîü‰∫ßÂäõ ÊàëÁöÑÁõÆÁöÑÊòØ‰∏∫Âü∫Êú¨ÁöÑjavaÁâπÂæÅÊèê‰æõÂºÄÊ∫ê‰ª£Á†ÅÁöÑÊîØÊåÅÔºåËÄå‰∏çÊòØËá™Â∑±ÂÜçÂÜô‰∏Ä‰∏™ Apache CommonÂ∫ì-ApacheÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑÊàêÁÜüÁöÑÂ∫ìÔºå‰ΩÜÊòØ‰∏çÊîØÊåÅÊ≥õÂûãÔºåApacheÂØπÊó©Ëµ∑ÁöÑjavaÁâàÊú¨ÂæàÊúâÁî®ÔºåÔºà1.5‰πãÂâçÁöÑÔºâ java7Ôºåjava8 ÊúÄÊñ∞ÁöÑjavaÊîØÊåÅ‰∏Ä‰∫õguavaÁöÑAPI guavaÊúÄÊñ∞ÁöÑÊ≠£ÂºèÁâàÊú¨ÊòØ14.0-rc2ÔºåËøô‰∏™ÁâàÊú¨ÈúÄË¶Åjava1.6ÊîØÊåÅ. ÊúÄÊñ∞ÁöÑmavenÂùêÊ†áÊòØÔºö com.google.guavaguava14.0-rc2 3,ÈõÜÂêàAPIÁöÑ‰ΩøÁî® 3.1ÁÆÄÂåñÂ∑•‰Ωú ÂèØ‰ª•ÁÆÄÂåñÈõÜÂêàÁöÑÂàõÂª∫ÂíåÂàùÂßãÂåñÔºõ Á±ªÂà´ ÂéüÊù•ÁöÑÂÜôÊ≥ï guavaÁöÑÂÜôÊ≥ï ÈõÜÂêàÂàõÂª∫ Map]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>guava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zookeeperËØ¶Ëß£]]></title>
    <url>%2F2017%2F11%2F26%2Fzookeeper%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[start123bin/zkServer.sh start$ bin/zkCli.sh -server 127.0.0.1:2181 zk client Êìç‰Ωústat path [watch] set path data [version] ls path [watch] delquota [-n|-b] path ls2 path [watch] setAcl path acl setquota -n|-b val path history redo cmdno printwatches on|off delete path [version] sync path listquota path rmr path get path [watch] create [-s] [-e] path data acl addauth scheme auth quit getAcl path close connect host:port ‰º™ÈõÜÁæ§Êê≠Âª∫ÂèÇËÄÉÔºöhttp://zookeeper.apache.org/doc/trunk/zookeeperStarted.html ÈõÜÁæ§ÈÖçÁΩÆÔºö 1„ÄÅÈÖçÁΩÆÊñá‰ª∂conf/zoo.cfgÔºåÈô§‰∫ÜÂçïÊú∫Ê®°ÂºèÁöÑÈÖçÁΩÆ‰πãÂ§ñÔºåËøòÈúÄË¶ÅÊñ∞Âä†server.x‰ø°ÊÅØÔºåÂ¶Ç‰∏ãÊâÄÁ§∫„ÄÇ 12345678tickTime=2000dataDir=D:\09tmp\zookeeper\dataclientPort=2181initLimit=5syncLimit=2server.1=zoo1:2888:3888server.2=zoo2:2888:3888server.3=zoo3:2888:3888 ‚Äã zooxË°®Á§∫ÁöÑÊòØzookeeperÊúçÂä°Âô®ÁöÑIPÂú∞ÂùÄÔºåÁ¨¨‰∏Ä‰∏™Á´ØÂè£2888ÔºöÂú®zookeeperÊúçÂä°Âô®‰πãÈó¥ÂèäÂíåleaderËøûÊé•Êó∂‰ΩøÁî®ÔºåÁ¨¨‰∫å‰∏™Á´ØÂè£Âè∑Ôºö3888ÊòØÂú®ËøõË°åleaderÈÄâ‰∏æÊó∂‰ΩøÁî®„ÄÇ 2„ÄÅÂêåÊó∂ÈúÄË¶ÅÂú®ÈÖçÁΩÆÈ°πdataDirÊâÄÊåáÁ§∫ÁõÆÂΩï‰∏ãÂàõÂª∫Êñá‰ª∂myidÊñá‰ª∂ÔºåÂÖ∂ÂÜÖÂÆπ‰∏∫ËØ•1‰∏≠server.x‰∏≠ÁöÑxÔºåË°®Á§∫ËØ•zookeeperÊúçÂä°Âô®ÁöÑÁºñÂè∑„ÄÇ 3„ÄÅ‰∏∫‰∫ÜÈôç‰ΩéÊõ¥Êñ∞ÁöÑÂª∂ËøüÔºåÈúÄË¶Å‰∏∫‰∫ãÁâ©Êó•ÂøóÁöÑÂ≠òÊîæ‰∏ìÈó®ÊåáÂÆöÂ≠òÂÇ®Ë∑ØÂæÑÔºåËØ•ÈÖçÁΩÆÈ°π‰∏∫ÔºödataLogDir 12345678910111213# The number of milliseconds of each ticktickTime=2000# The number of ticks that the initial# synchronization phase can takeinitLimit=10# The number of ticks that can pass between# sending a request and getting an acknowledgementsyncLimit=5# the directory where the snapshot is stored.# do not use /tmp for storage, /tmp here is just# example sakes.dataDir=D:\\09tmp\\zookeeper\\datadataLogDir=D:\\09tmp\\zookeeper\\log ‰º™ÈõÜÁæ§ÈÖçÁΩÆÔºö 1„ÄÅÁî±‰∫éÊâÄÊúâzookeeperÊúçÂä°Âô®ÈÉΩÂú®‰∏ÄÂè∞Áâ©ÁêÜÊú∫Âô®‰∏äÔºåÂõ†Ê≠§zoo1.cfg‰∏≠ÈÖçÁΩÆÈ°πserver.xÁöÑÁ´ØÂè£‰ø°ÊÅØÔºå‰∏çËÉΩÁõ∏Âêå„ÄÇ‰∏îÈÖçÁΩÆÈ°πdataDirÂíådataLogDir‰πüÈúÄË¶Å‰∏∫‰º™ÊúçÂä°Âô®ÂçïÁã¨ÊåáÂÆö„ÄÇÈÖçÁΩÆÈ°πclientPortÂú®‰∏â‰∏™ÊúçÂä°Âô®‰∏≠‰πüË¶ÅÈÖçÁΩÆ‰∏çÂêåÁöÑÂÄºÔºåÁ§∫‰æãÂ¶Ç‰∏ãÔºö 123456789tickTime=2000dataDir=D:\09tmp\zookeeper\data\\1dataLogDir=D:\09tmp\zookeeper\log\\1clientPort=2181initLimit=5syncLimit=2server.1=localhost:2888:3888server.2=localhost:2889:3889server.3=localhost:2890:3890 2„ÄÅÂêåÊó∂ÈúÄË¶ÅÂáÜÂ§ázoo2.cfgÂíåzoo3.cfgÈÖçÁΩÆÊñá‰ª∂ÔºåÂèÇËÄÉ1ËøõË°åÈÖçÁΩÆ 3„ÄÅÂú®D:\09tmp\zookeeper\data\1„ÄÅD:\09tmp\zookeeper\data\2ÂíåD:\09tmp\zookeeper\data\3‰∏≠ÂàÜÂà´ÂàõÂª∫Êñá‰ª∂myidÔºåÈáåÈù¢Â°´ÂÜôÂØπÂ∫îÁöÑzookeeperÊúçÂä°Âô®ÁºñÂè∑„ÄÇ 4„ÄÅÂàõÂª∫‰∏â‰∏™Êñá‰ª∂ÔºözkEnv1.cmd„ÄÅzkEnv2.cmdÂíåzkEnv3.cmdÂàÜÂà´Áî®Êù•ÊåáÂÆö‰ΩøÁî®‰∏çÂêåÁöÑzoo.cfg„ÄÇ 5„ÄÅÂàõÂª∫‰∏â‰∏™Êñá‰ª∂ÔºözkServer1.cmd„ÄÅzkServer2.cmdÂíåzkServer3.cmdÂàÜÂà´Áî®Êù•ÊåáÂÆö‰∏çÂêåÁöÑÊñá‰ª∂zkEnv.cmd„ÄÇ]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
      <tags>
        <tag>zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MockitoÊµÖË∞à]]></title>
    <url>%2F2017%2F11%2F25%2FMockito%E6%B5%85%E8%B0%88%2F</url>
    <content type="text"><![CDATA[MockitoÁÆÄ‰ªã ‰ªÄ‰πàÊòØmockÔºüÂú®ËΩØ‰ª∂ÂºÄÂèëÁöÑ‰∏ñÁïå‰πãÂ§ñ, ‚Äúmock‚Äù‰∏ÄËØçÊòØÊåáÊ®°‰ªøÊàñËÄÖÊïà‰ªø„ÄÇ Âõ†Ê≠§ÂèØ‰ª•Â∞Ü‚Äúmock‚ÄùÁêÜËß£‰∏∫‰∏Ä‰∏™ÊõøË∫´ÔºåÊõø‰ª£ËÄÖ. Âú®ËΩØ‰ª∂ÂºÄÂèë‰∏≠ÊèêÂèä‚Äùmock‚ÄùÔºåÈÄöÂ∏∏ÁêÜËß£‰∏∫Ê®°ÊãüÂØπË±°ÊàñËÄÖFake„ÄÇ ‰∏∫‰ªÄ‰πàÈúÄË¶ÅMock?MockÊòØ‰∏∫‰∫ÜËß£ÂÜ≥units‰πãÈó¥Áî±‰∫éËÄ¶ÂêàËÄåÈöæ‰∫éË¢´ÊµãËØïÁöÑÈóÆÈ¢ò„ÄÇÊâÄ‰ª•mock objectÊòØunit testÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ MockÁöÑÂ•ΩÂ§ÑÊòØ‰ªÄ‰πà? ÊèêÂâçÂàõÂª∫ÊµãËØïÔºåTDDÔºàÊµãËØïÈ©±Âä®ÂºÄÂèëÔºâ ËøôÊòØ‰∏™ÊúÄÂ§ßÁöÑÂ•ΩÂ§ÑÂêß„ÄÇÂ¶ÇÊûú‰Ω†ÂàõÂª∫‰∫Ü‰∏Ä‰∏™MockÈÇ£‰πà‰Ω†Â∞±ÂèØ‰ª•Âú®serviceÊé•Âè£ÂàõÂª∫‰πãÂâçÂÜôService Tests‰∫ÜÔºåËøôÊ†∑‰Ω†Â∞±ËÉΩÂú®ÂºÄÂèëËøáÁ®ã‰∏≠ÊääÊµãËØïÊ∑ªÂä†Âà∞‰Ω†ÁöÑËá™Âä®ÂåñÊµãËØïÁéØÂ¢É‰∏≠‰∫Ü„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÊ®°Êãü‰Ωø‰Ω†ËÉΩÂ§ü‰ΩøÁî®ÊµãËØïÈ©±Âä®ÂºÄÂèë„ÄÇ Âõ¢ÈòüÂèØ‰ª•Âπ∂Ë°åÂ∑•‰Ωú ËøôÁ±ª‰ºº‰∫é‰∏äÈù¢ÁöÑÈÇ£ÁÇπÔºõ‰∏∫‰∏çÂ≠òÂú®ÁöÑ‰ª£Á†ÅÂàõÂª∫ÊµãËØï„ÄÇ‰ΩÜÂâçÈù¢ËÆ≤ÁöÑÊòØÂºÄÂèë‰∫∫ÂëòÁºñÂÜôÊµãËØïÁ®ãÂ∫èÔºåËøôÈáåËØ¥ÁöÑÊòØÊµãËØïÂõ¢ÈòüÊù•ÂàõÂª∫„ÄÇÂΩìËøòÊ≤°Êúâ‰ªª‰Ωï‰∏úË•øË¶ÅÊµãÁöÑÊó∂ÂÄôÊµãËØïÂõ¢ÈòüÂ¶Ç‰ΩïÊù•ÂàõÂª∫ÊµãËØïÂë¢ÔºüÊ®°ÊãüÂπ∂ÈíàÂØπÊ®°ÊãüÊµãËØïÔºÅËøôÊÑèÂë≥ÁùÄÂΩìserviceÂÄüÂè£ÈúÄË¶ÅÊµãËØïÊó∂ÔºåÂÆûÈôÖ‰∏äQAÂõ¢ÈòüÂ∑≤ÁªèÊúâ‰∫Ü‰∏ÄÂ•óÂÆåÊï¥ÁöÑÊµãËØïÁªÑ‰ª∂ÔºõÊ≤°ÊúâÂá∫Áé∞‰∏Ä‰∏™Âõ¢ÈòüÁ≠âÂæÖÂè¶‰∏Ä‰∏™Âõ¢ÈòüÂÆåÊàêÁöÑÊÉÖÂÜµ„ÄÇËøô‰ΩøÂæóÊ®°ÊãüÁöÑÊïàÁõäÂûãÂ∞§‰∏∫Á™ÅÂá∫‰∫Ü„ÄÇ ‰Ω†ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™È™åËØÅÊàñËÄÖÊºîÁ§∫Á®ãÂ∫è„ÄÇ Áî±‰∫éMocksÈùûÂ∏∏È´òÊïàÔºåMocksÂèØ‰ª•Áî®Êù•ÂàõÂª∫‰∏Ä‰∏™Ê¶ÇÂøµËØÅÊòéÔºå‰Ωú‰∏∫‰∏Ä‰∏™Á§∫ÊÑèÂõæÔºåÊàñËÄÖ‰Ωú‰∏∫‰∏Ä‰∏™‰Ω†Ê≠£ËÄÉËôëÊûÑÂª∫È°πÁõÆÁöÑÊºîÁ§∫Á®ãÂ∫è„ÄÇËøô‰∏∫‰Ω†ÂÜ≥ÂÆöÈ°πÁõÆÊé•‰∏ãÊù•ÊòØÂê¶Ë¶ÅËøõË°åÊèê‰æõ‰∫ÜÊúâÂäõÁöÑÂü∫Á°ÄÔºå‰ΩÜÊúÄÈáçË¶ÅÁöÑËøòÊòØÊèê‰æõ‰∫ÜÂÆûÈôÖÁöÑËÆæËÆ°ÂÜ≥Á≠ñ„ÄÇ ‰∏∫Êó†Ê≥ïËÆøÈóÆÁöÑËµÑÊ∫êÁºñÂÜôÊµãËØï Ëøô‰∏™Â•ΩÂ§Ñ‰∏çÂ±û‰∫éÂÆûÈôÖÊïàÁõäÁöÑ‰∏ÄÁßçÔºåËÄåÊòØ‰Ωú‰∏∫‰∏Ä‰∏™ÂøÖË¶ÅÊó∂ÁöÑ‚ÄúÊïëÁîüÂúà‚Äù„ÄÇÊúâÊ≤°ÊúâÈÅáÂà∞ËøôÊ†∑ÁöÑÊÉÖÂÜµÔºüÂΩì‰Ω†ÊÉ≥Ë¶ÅÊµãËØï‰∏Ä‰∏™serviceÊé•Âè£Ôºå‰ΩÜserviceÈúÄË¶ÅÁªèËøáÈò≤ÁÅ´Â¢ôËÆøÈóÆÔºåÈò≤ÁÅ´Â¢ô‰∏çËÉΩ‰∏∫‰Ω†ÊâìÂºÄÊàñËÄÖ‰Ω†ÈúÄË¶ÅËÆ§ËØÅÊâçËÉΩËÆøÈóÆ„ÄÇÈÅáÂà∞ËøôÊ†∑ÊÉÖÂÜµÊó∂Ôºå‰Ω†ÂèØ‰ª•Âú®‰Ω†ËÉΩËÆøÈóÆÁöÑÂú∞Êñπ‰ΩøÁî®MockServiceÊõø‰ª£ÔºåËøôÂ∞±ÊòØ‰∏Ä‰∏™‚ÄúÊïëÁîüÂúà‚ÄùÂäüËÉΩ„ÄÇ Mock ÂèØ‰ª•‰∫§ÁªôÁî®Êà∑ Âú®Êúâ‰∫õÊÉÖÂÜµ‰∏ãÔºåÊüêÁßçÂéüÂõ†‰Ω†ÈúÄË¶ÅÂÖÅËÆ∏‰∏Ä‰∫õÂ§ñÈÉ®Êù•Ê∫êËÆøÈóÆ‰Ω†ÁöÑÊµãËØïÁ≥ªÁªüÔºåÂÉèÂêà‰Ωú‰ºô‰º¥ÊàñËÄÖÂÆ¢Êà∑„ÄÇËøô‰∫õÂéüÂõ†ÂØºËá¥Âà´‰∫∫‰πüÂèØ‰ª•ËÆøÈóÆ‰Ω†ÁöÑÊïèÊÑü‰ø°ÊÅØÔºåËÄå‰Ω†ÊàñËÆ∏Âè™ÊòØÊÉ≥ÂÖÅËÆ∏ËÆøÈóÆÈÉ®ÂàÜÊµãËØïÁéØÂ¢É„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ¶Ç‰ΩïÂêëÂêà‰Ωú‰ºô‰º¥ÊàñËÄÖÂÆ¢Êà∑Êèê‰æõ‰∏Ä‰∏™ÊµãËØïÁ≥ªÁªüÊù•ÂºÄÂèëÊàñËÄÖÂÅöÊµãËØïÂë¢ÔºüÊúÄÁÆÄÂçïÁöÑÂ∞±ÊòØÊèê‰æõ‰∏Ä‰∏™mockÔºåÊó†ËÆ∫ÊòØÊù•Ëá™‰∫é‰Ω†ÁöÑÁΩëÁªúÊàñËÄÖÂÆ¢Êà∑ÁöÑÁΩëÁªú„ÄÇsoapUI mockÈùûÂ∏∏ÂÆπÊòìÈÖçÁΩÆÔºå‰ªñÂèØ‰ª•ËøêË°åÂú®soapUIÊàñËÄÖ‰Ωú‰∏∫‰∏Ä‰∏™warÂåÖÂèëÂ∏ÉÂà∞‰Ω†ÁöÑjavaÊúçÂä°Âô®ÈáåÈù¢„ÄÇ ÈöîÁ¶ªÁ≥ªÁªü ÊúâÊó∂Ôºå‰Ω†Â∏åÊúõÂú®Ê≤°ÊúâÁ≥ªÁªüÂÖ∂‰ªñÈÉ®ÂàÜÁöÑÂΩ±Âìç‰∏ãÊµãËØïÁ≥ªÁªüÂçïÁã¨ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÁî±‰∫éÂÖ∂‰ªñÁ≥ªÁªüÈÉ®ÂàÜ‰ºöÁªôÊµãËØïÊï∞ÊçÆÈÄ†ÊàêÂπ≤Êâ∞ÔºåÂΩ±ÂìçÊ†πÊçÆÊï∞ÊçÆÊî∂ÈõÜÂæóÂà∞ÁöÑÊµãËØïÁªìËÆ∫„ÄÇ‰ΩøÁî®mock‰Ω†ÂèØ‰ª•ÁßªÈô§ÊéâÈô§‰∫ÜÈúÄË¶ÅÊµãËØïÈÉ®ÂàÜÁöÑÁ≥ªÁªü‰æùËµñÁöÑÊ®°Êãü„ÄÇÂΩìÈöîÁ¶ªËøô‰∫õmocksÂêéÔºåmocksÂ∞±ÂèòÂæóÈùûÂ∏∏ÁÆÄÂçïÂèØÈù†ÔºåÂø´ÈÄüÂèØÈ¢ÑËßÅ„ÄÇËøô‰∏∫‰Ω†Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÁßªÈô§‰∫ÜÈöèÊú∫Ë°å‰∏∫ÔºåÊúâÈáçÂ§çÊ®°ÂºèÂπ∂‰∏îÂèØ‰ª•ÁõëÊéßÁâπÊÆäÁ≥ªÁªüÁöÑÊµãËØïÁéØÂ¢É„ÄÇ Mockito‰ΩøÁî®Á§∫‰æãÊ®°ÊãüÂØπË±°1234// Ê®°ÊãüLinkedList ÁöÑ‰∏Ä‰∏™ÂØπË±°LinkedList mockedList = mock(LinkedList.class);// Ê≠§Êó∂Ë∞ÉÁî®getÊñπÊ≥ïÔºå‰ºöËøîÂõûnullÔºåÂõ†‰∏∫ËøòÊ≤°ÊúâÂØπÊñπÊ≥ïË∞ÉÁî®ÁöÑËøîÂõûÂÄºÂÅöÊ®°ÊãüSystem.out.println(mockedList.get(0)); Ê®°ÊãüÊñπÊ≥ïË∞ÉÁî®ÁöÑËøîÂõûÂÄº1234// Ê®°ÊãüËé∑ÂèñÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Êó∂ÔºåËøîÂõûÂ≠óÁ¨¶‰∏≤first„ÄÇ ÁªôÁâπÂÆöÁöÑÊñπÊ≥ïË∞ÉÁî®ËøîÂõûÂõ∫ÂÆöÂÄºÂú®ÂÆòÊñπËØ¥Ê≥ï‰∏≠Áß∞‰∏∫stub„ÄÇwhen(mockedList.get(0)).thenReturn("first");// Ê≠§Êó∂ÊâìÂç∞ËæìÂá∫firstSystem.out.println(mockedList.get(0)); Ê®°ÊãüÊñπÊ≥ïË∞ÉÁî®ÊäõÂá∫ÂºÇÂ∏∏1234// Ê®°ÊãüËé∑ÂèñÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†Êó∂ÔºåÊäõÂá∫RuntimeExceptionwhen(mockedList.get(1)).thenThrow(new RuntimeException());// Ê≠§Êó∂Â∞Ü‰ºöÊäõÂá∫RuntimeExceptionSystem.out.println(mockedList.get(1)); Â¶ÇÊûú‰∏Ä‰∏™ÂáΩÊï∞Ê≤°ÊúâËøîÂõûÂÄºÁ±ªÂûãÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî®Ê≠§ÊñπÊ≥ïÊ®°ÊãüÂºÇÂ∏∏ÊäõÂá∫ 12doThrow(new RuntimeException("clear exception")).when(mockedList).clear();mockedList.clear(); Ê®°ÊãüË∞ÉÁî®ÊñπÊ≥ïÊó∂ÁöÑÂèÇÊï∞ÂåπÈÖç1234// anyInt()ÂåπÈÖç‰ªª‰ΩïintÂèÇÊï∞ÔºåËøôÊÑèÂë≥ÁùÄÂèÇÊï∞‰∏∫‰ªªÊÑèÂÄºÔºåÂÖ∂ËøîÂõûÂÄºÂùáÊòØelementwhen(mockedList.get(anyInt())).thenReturn("element");// Ê≠§Êó∂ÊâìÂç∞ÊòØelementSystem.out.println(mockedList.get(999)); Ê®°ÊãüÊñπÊ≥ïË∞ÉÁî®Ê¨°Êï∞12345// Ë∞ÉÁî®add‰∏ÄÊ¨°mockedList.add("once");// ‰∏ãÈù¢‰∏§‰∏™ÂÜôÊ≥ïÈ™åËØÅÊïàÊûú‰∏ÄÊ†∑ÔºåÂùáÈ™åËØÅaddÊñπÊ≥ïÊòØÂê¶Ë¢´Ë∞ÉÁî®‰∫Ü‰∏ÄÊ¨°verify(mockedList).add("once");verify(mockedList, times(1)).add("once"); Ê†°È™åË°å‰∏∫12345678// mock creationList mockedList = mock(List.class);// using mock objectmockedList.add("one");mockedList.clear();//verificationverify(mockedList).add("one");verify(mockedList).clear(); Ê®°ÊãüÊñπÊ≥ïË∞ÉÁî®(Stubbing)12345678910111213//You can mock concrete classes, not just interfacesLinkedList mockedList = mock(LinkedList.class);//stubbingwhen(mockedList.get(0)).thenReturn("first");when(mockedList.get(1)).thenThrow(new RuntimeException());//following prints "first"System.out.println(mockedList.get(0));//following throws runtime exceptionSystem.out.println(mockedList.get(1));//following prints "null" because get(999) was not stubbedSystem.out.println(mockedList.get(999));verify(mockedList).get(0); ÂèÇÊï∞ÂåπÈÖç12345678910//stubbing using built-in anyInt() argument matcherwhen(mockedList.get(anyInt())).thenReturn("element");//stubbing using custom matcher (let's say isValid() returns your own matcher implementation):when(mockedList.contains(argThat(isValid()))).thenReturn("element");//following prints "element"System.out.println(mockedList.get(999));//you can also verify using an argument matcherverify(mockedList).get(anyInt());//argument matchers can also be written as Java 8 Lambdasverify(mockedList).add(someString -&gt; someString.length() &gt; 5); Ê†°È™åÊñπÊ≥ïË∞ÉÁî®Ê¨°Êï∞123456789101112131415161718192021//using mockmockedList.add("once");mockedList.add("twice");mockedList.add("twice");mockedList.add("three times");mockedList.add("three times");mockedList.add("three times");//following two verifications work exactly the same - times(1) is used by defaultverify(mockedList).add("once");verify(mockedList, times(1)).add("once");//exact number of invocations verificationverify(mockedList, times(2)).add("twice");verify(mockedList, times(3)).add("three times");//verification using never(). never() is an alias to times(0)verify(mockedList, never()).add("never happened");//verification using atLeast()/atMost()verify(mockedList, atLeastOnce()).add("three times");verify(mockedList, atLeast(2)).add("five times");verify(mockedList, atMost(5)).add("three times"); Ê®°ÊãüÊó†ËøîÂõûÊñπÊ≥ïÊäõÂá∫ÂºÇÂ∏∏123doThrow(new RuntimeException()).when(mockedList).clear();//following throws RuntimeException:mockedList.clear(); Ê†°È™åÊñπÊ≥ïË∞ÉÁî®È°∫Â∫è1234567891011121314151617181920212223// A. Single mock whose methods must be invoked in a particular orderList singleMock = mock(List.class);//using a single mocksingleMock.add("was added first");singleMock.add("was added second");//create an inOrder verifier for a single mockInOrder inOrder = inOrder(singleMock);//following will make sure that add is first called with "was added first, then with "was added second"inOrder.verify(singleMock).add("was added first");inOrder.verify(singleMock).add("was added second");// B. Multiple mocks that must be used in a particular orderList firstMock = mock(List.class);List secondMock = mock(List.class);//using mocksfirstMock.add("was called first");secondMock.add("was called second");//create inOrder object passing any mocks that need to be verified in orderInOrder inOrder = inOrder(firstMock, secondMock);//following will make sure that firstMock was called before secondMockinOrder.verify(firstMock).add("was called first");inOrder.verify(secondMock).add("was called second");// Oh, and A + B can be mixed together at will Ê†°È™åÊñπÊ≥ïÊòØÂê¶‰ªéÊú™Ë∞ÉÁî®12345678//using mocks - only mockOne is interactedmockOne.add("one");//ordinary verificationverify(mockOne).add("one");//verify that method was never called on a mockverify(mockOne, never()).add("two");//verify that other mocks were not interactedverifyZeroInteractions(mockTwo, mockThree); Âø´ÈÄüÂàõÂª∫MockÂØπË±°123456789public class ArticleManagerTest &#123; @Mock private ArticleCalculator calculator; @Mock private ArticleDatabase database; @Mock private UserProvider userProvider; @Before public void before()&#123; MockitoAnnotations.initMocks(this); &#125;&#125; Ëá™ÂÆö‰πâËøîÂõû‰∏çÂêåÁªìÊûú123456789when(mock.someMethod("some arg")) .thenThrow(new RuntimeException()) // Á¨¨‰∏ÄÊ¨°‰ºöÊäõÂá∫ÂºÇÂ∏∏ .thenReturn("foo"); // Á¨¨‰∫åÊ¨°‰ºöËøîÂõûËøô‰∏™ÁªìÊûú//First call: throws runtime exception:mock.someMethod("some arg"); // Á¨¨‰∏ÄÊ¨°//Second call: prints "foo"System.out.println(mock.someMethod("some arg")); // Á¨¨‰∫åÊ¨°//Any consecutive call: prints "foo" as well (last stubbing wins).System.out.println(mock.someMethod("some arg")); // Á¨¨nÊ¨°(n&gt; 2)Ôºå‰æùÊóß‰ª•ÊúÄÂêéËøîÂõûÊúÄÂêé‰∏Ä‰∏™ÈÖçÁΩÆ ÂØπËøîÂõûÁªìÊûúËøõË°åÊã¶Êà™123456789when(mock.someMethod(anyString())).thenAnswer(new Answer() &#123; Object answer(InvocationOnMock invocation) &#123; Object[] args = invocation.getArguments(); Object mock = invocation.getMock(); return "called with arguments: " + args; &#125;&#125;);//the following prints "called with arguments: foo"System.out.println(mock.someMethod("foo")); MockÂáΩÊï∞Êìç‰ΩúÂèØ‰ª•ÈÄöËøádoThrow(), doAnswer(), doNothing(), doReturn() and doCallRealMethod() Êù•Ëá™ÂÆö‰πâÂáΩÊï∞Êìç‰Ωú„ÄÇ Êöó‰∏≠Ë∞ÉÁî®ÁúüÂÆûÂØπË±°1234567891011121314List list = new LinkedList();List spy = spy(list);//optionally, you can stub out some methods:when(spy.size()).thenReturn(100);//using the spy calls *real* methodsspy.add("one");spy.add("two");//prints "one" - the first element of a listSystem.out.println(spy.get(0));//size() method was stubbed - 100 is printedSystem.out.println(spy.size());//optionally, you can verifyverify(spy).add("one"); verify(spy).add("two"); ÊîπÂèòÈªòËÆ§ËøîÂõûÂÄº12Foo mock = mock(Foo.class, Mockito.RETURNS_SMART_NULLS);Foo mockTwo = mock(Foo.class, new YourOwnAnswer()); ÊçïËé∑ÂáΩÊï∞ÁöÑÂèÇÊï∞ÂÄº123ArgumentCaptor&lt;Person&gt; argument = ArgumentCaptor.forClass(Person.class);verify(mock).doSomething(argument.capture());assertEquals("John", argument.getValue().getName()); ÈÉ®ÂàÜMock1234567//you can create partial mock with spy() method:List list = spy(new LinkedList());//you can enable partial mock capabilities selectively on mocks:Foo mock = mock(Foo.class);//Be sure the real implementation is 'safe'.//If real implementation throws exceptions or depends on specific state of the object then you're in trouble.when(mock.someMethod()).thenCallRealMethod(); ÈáçÁΩÆMock12345List mock = mock(List.class);when(mock.size()).thenReturn(10);mock.add(1);reset(mock);//at this point the mock forgot any interactions &amp; stubbing Â∫èÂàóÂåñ12345List&lt;Object&gt; list = new ArrayList&lt;Object&gt;();List&lt;Object&gt; spy = mock(ArrayList.class, withSettings() .spiedInstance(list) .defaultAnswer(CALLS_REAL_METHODS) .serializable()); Ê£ÄÊü•Ë∂ÖÊó∂1234567891011//passes when someMethod() is called within given time spanverify(mock, timeout(100)).someMethod();//above is an alias to:verify(mock, timeout(100).times(1)).someMethod();//passes when som`eMethod() is called *exactly* 2 times within given time spanverify(mock, timeout(100).times(2)).someMethod();//passes when someMethod() is called *at least* 2 times within given time spanverify(mock, timeout(100).atLeast(2)).someMethod();//verifies someMethod() within given time span using given verification mode//useful only if you have your own custom verification modes.verify(mock, new Timeout(100, yourOwnVerificationMode)).someMethod(); MockËØ¶ÊÉÖ12Mockito.mockingDetails(someObject).isMock();Mockito.mockingDetails(someObject).isSpy();]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysql group_cat]]></title>
    <url>%2F2017%2F11%2F16%2Fmysql-group-cat%2F</url>
    <content type="text"><![CDATA[group_concat()ÂáΩÊï∞ÁöÑÂèÇÊï∞ÊòØÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®order byÊéíÂ∫èÁöÑ„ÄÇ666„ÄÇ„ÄÇ‰∏ãÈù¢ÈÄöËøá‰æãÂ≠êÊù•ËØ¥ÊòéÔºåÈ¶ñÂÖàÁúã‰∏ãÈù¢ÁöÑt1Ë°®„ÄÇ ÊØîÂ¶ÇÔºåÊàë‰ª¨Ë¶ÅÊü•ÁúãÊØè‰∏™‰∫∫ÁöÑÂ§ö‰∏™ÂàÜÊï∞ÔºåÂ∞ÜËØ•‰∫∫ÂØπÂ∫îÁöÑÂ§ö‰∏™ÂàÜÊï∞ÊòæÁ§∫Âú®‰∏ÄËµ∑ÔºåÂàÜÊï∞Ë¶Å‰ªéÈ´òÂà∞Â∫ïÊéíÂ∫è„ÄÇÂèØ‰ª•ËøôÊ†∑ÂÜôÔºö SELECT username,GROUP_CONCAT(score ORDER BY score DESC) AS myScore FROM t1 GROUP BY username; ÊïàÊûúÂ¶Ç‰∏ãÔºö 12345678910111213141516UPDATE cash_billing_item bi, ( SELECT bi.id FROM cash_billing_item bi WHERE bi.id and bi.status = 1 and bi.id not in ( SELECT group_concat(id ORDER BY product_start_time desc) FROM cash_billing_item WHERE product_no = bi.product_no AND customer_no = bi.customer_no and status = 1 GROUP BY product_no, customer_no ) ) tempSET bi.status = 2WHERE bi.id = temp.id; group_cat‰πãÂêéÁõ∏ÂΩì‰∫éËøòÊúâ‰∏Ä‰∏™SELECT substring_index(‚Äò10,3,4,5‚Äô,‚Äô,‚Äô,1); ËøîÂõûÁ¨¨‰∏Ä‰∏™10]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQL‰∏≠decimalÁ±ªÂûãËØ¶Ëß£ÂèäÁ±ªÂûãËΩ¨Êç¢]]></title>
    <url>%2F2017%2F11%2F16%2FMySQL%E4%B8%ADdecimal%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3%E5%8F%8A%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%2F</url>
    <content type="text"><![CDATA[1select name,cast(age/(select sum(age) from boss) as decimal(32,2)) as age from boss; ÂÖ∂‰∏≠castÊòØÁ±ªÂûãËΩ¨Êç¢ÂáΩÊï∞Ôºådecimal‰∏∫‰∏Ä‰∏™Á±ªÂûã 1.È¶ñÂÖàÔºåÂØπ‰∫éÁ≤æÂ∫¶ÊØîËæÉÈ´òÁöÑ‰∏úË•øÔºåÊØîÂ¶ÇmoneyÔºåÊàë‰ºöÁî®decimalÁ±ªÂûãÔºå‰∏ç‰ºöËÄÉËôëfloat,double,Âõ†‰∏∫‰ªñ‰ª¨ÂÆπÊòì‰∫ßÁîüËØØÂ∑ÆÔºånumericÂíådecimalÂêå‰πâÔºånumericÂ∞ÜËá™Âä®ËΩ¨Êàêdecimal„ÄÇ DECIMAL‰ªéMySQL 5.1ÂºïÂÖ•ÔºåÂàóÁöÑÂ£∞ÊòéËØ≠Ê≥ïÊòØDECIMAL(M,D)„ÄÇÂú®MySQL 5.1‰∏≠ÔºåÂèÇÈáèÁöÑÂèñÂÄºËåÉÂõ¥Â¶Ç‰∏ãÔºö ¬∑MÊòØÊï∞Â≠óÁöÑÊúÄÂ§ßÊï∞ÔºàÁ≤æÂ∫¶Ôºâ„ÄÇÂÖ∂ËåÉÂõ¥‰∏∫1ÔΩû65ÔºàÂú®ËæÉÊóßÁöÑMySQLÁâàÊú¨‰∏≠ÔºåÂÖÅËÆ∏ÁöÑËåÉÂõ¥ÊòØ1ÔΩû254ÔºâÔºåM ÁöÑÈªòËÆ§ÂÄºÊòØ10„ÄÇ ¬∑DÊòØÂ∞èÊï∞ÁÇπÂè≥‰æßÊï∞Â≠óÁöÑÊï∞ÁõÆÔºàÊ†áÂ∫¶Ôºâ„ÄÇÂÖ∂ËåÉÂõ¥ÊòØ0ÔΩû30Ôºå‰ΩÜ‰∏çÂæóË∂ÖËøáM„ÄÇ ËØ¥ÊòéÔºöfloatÂç†4‰∏™Â≠óËäÇÔºådoubleÂç†8‰∏™Â≠óËäÇÔºådecimail(M,D)Âç†M+2‰∏™Â≠óËäÇ„ÄÇ Â¶ÇDECIMAL(5,2) ÁöÑÊúÄÂ§ßÂÄº‰∏∫9 9 9 9 . 9 9ÔºåÂõ†‰∏∫Êúâ7 ‰∏™Â≠óËäÇÂèØÁî®„ÄÇ M ‰∏éD ÂØπDECIMAL(M, D) ÂèñÂÄºËåÉÂõ¥ÁöÑÂΩ±Âìç Á±ªÂûãËØ¥ÊòéÂèñÂÄºËåÉÂõ¥ÔºàMySQL &lt; 3.23ÔºâÂèñÂÄºËåÉÂõ¥ÔºàMySQL &gt;= 3.23Ôºâ MySQL &lt; 3.23 MySQL &gt;=3.23DECIMAL(4, 1) -9.9 Âà∞ 99.9 -999.9 Âà∞ 9999.9 DECIMAL(5,1) -99.9 Âà∞ 999.9 -9999.9 Âà∞ 99999.9 DECIMAL(6,1) -999.9 Âà∞ 9999.9 -99999.9 Âà∞ 999999.9 DECIMAL(6,2) -99.99 Âà∞ 999.99 -9999.99 Âà∞ 99999.99 DECIMAL(6,3) -9.999 Âà∞ 99.999 -999.999 Âà∞ 9999.999 Âú®MySQL 3.23 Âèä‰ª•ÂêéÁöÑÁâàÊú¨‰∏≠ÔºåDECIMAL(M, D) ÁöÑÂèñÂÄºËåÉÂõ¥Á≠â‰∫éÊó©ÊúüÁâàÊú¨‰∏≠ÁöÑDECIMAL(M + 2, D) ÁöÑÂèñÂÄºËåÉÂõ¥„ÄÇ ÁªìËÆ∫Ôºö ÂΩìÊï∞ÂÄºÂú®ÂÖ∂ÂèñÂÄºËåÉÂõ¥‰πãÂÜÖÔºåÂ∞èÊï∞‰ΩçÂ§ö‰∫ÜÔºåÂàôÁõ¥Êé•Êà™Êñ≠Â∞èÊï∞‰Ωç„ÄÇ Ëã•Êï∞ÂÄºÂú®ÂÖ∂ÂèñÂÄºËåÉÂõ¥‰πãÂ§ñÔºåÂàôÁî®ÊúÄÂ§ß(Â∞è)ÂÄºÂØπÂÖ∂Â°´ÂÖÖ„ÄÇ]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DubboÁõ¥ËøûË∞ÉËØï]]></title>
    <url>%2F2017%2F11%2F14%2FDubbo%E7%9B%B4%E8%BF%9E%E8%B0%83%E8%AF%95%2F</url>
    <content type="text"><![CDATA[ÊúçÂä°Á´ØÔºö 123456789101112131415161718192021222324252627&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd" default-autowire="byName"&gt; &lt;dubbo:provider group="xxx"/&gt;&lt;!-- Êèê‰æõÊñπÂ∫îÁî®‰ø°ÊÅØÔºåÁî®‰∫éËÆ°ÁÆó‰æùËµñÂÖ≥Á≥ª --&gt; &lt;dubbo:application name="sports-basic-provider"/&gt; &lt;!-- ‰ΩøÁî®zookeeperÊ≥®ÂÜå‰∏≠ÂøÉÊö¥Èú≤ÊúçÂä°Âú∞ÂùÄ --&gt; &lt;dubbo:registry protocol="zookeeper" address="$&#123;dubbo.registry.address&#125;"/&gt; &lt;!-- ‰ΩøÁî®dubboÂçèËÆÆÂú®20880Á´ØÂè£Êö¥Èú≤ÊúçÂä° --&gt; &lt;dubbo:protocol name="dubbo" port="20880"/&gt; &lt;!-- basic start --&gt; &lt;dubbo:service interface="com.xxx.basic.manage.service.OrganizationService" ref="organizationService" timeout="10000"/&gt; &lt;dubbo:service interface="com.xxx.basic.manage.service.ResourceService" ref="resourceService" timeout="10000"/&gt; &lt;dubbo:service interface="com.xxx.basic.manage.service.SysRoleService" ref="sysRoleService" timeout="10000"/&gt; &lt;dubbo:service interface="com.xxx.basic.manage.service.SysUserService" ref="sysUserService" timeout="10000"/&gt;&lt;/beans&gt; Ê∂àË¥πÁ´ØÔºö Â¢ûÂä†url=‚Äùdubbo://localhost:20880‚ÄùÂç≥ÂèØ„ÄÇ 1234567891011121314151617181920&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd" default-autowire="byName"&gt; &lt;dubbo:application name="$&#123;dubbo.application.name&#125;"/&gt; &lt;dubbo:registry address="$&#123;dubbo.registry.address&#125;" timeout="$&#123;dubbo.consumer.timeout&#125;" /&gt; &lt;dubbo:consumer retries="$&#123;dubbo.consumer.retries&#125;" group="oa" /&gt; &lt;!-- basic start --&gt; &lt;dubbo:reference interface="com.xxx.basic.manage.service.SysRoleService" id="sysRoleService" check="false" url="dubbo://localhost:20880"/&gt; &lt;dubbo:reference interface="com.xxx.basic.manage.service.ResourceService" id="resourceService" check="false" url="dubbo://localhost:20880" /&gt; &lt;dubbo:reference interface="com.xxx.basic.manage.service.OrganizationService" id="organizationService" check="false" url="dubbo://localhost:20880" /&gt; &lt;dubbo:reference interface="com.xxx.basic.manage.service.SysUserService" id="sysUserService" check="false" url="dubbo://localhost:20880"/&gt;&lt;/beans&gt; ÂºÄÂèëË∞ÉËØï Êàë‰ª¨ÂêØÂä®ËøúÁ®ãÊúçÂä°Êèê‰æõËÄÖ ÊàëÂêØÂä®web-bossÔºåËøôÈáåË∞ÉÁî®ÊòØËøúÁ®ãÊèê‰æõËÄÖÊúçÂä° Êü•Áúãuser-service,providerÊñπÁöÑÈÖçÁΩÆ ÈÖçÁΩÆconsumerÊñπË∞ÉÁî®Êú¨Âú∞dubboÊúçÂä°ÔºåËøõË°åÁõ¥ËøûË∞ÉËØï Êàë‰ª¨ÂêØÂä®Êú¨Âú∞ dubboÊúçÂä°,‰ª•debugÊ®°ÂºèÂêØÂä® Âú®dubboÁÆ°ÁêÜÊéßÂà∂Âè∞Êü•ÁúãdubboÊúçÂä° ÂêØÂä®Ê∂àË¥πÁ´ØÔºåweb-bossÊàë‰ª¨ËøõË°åÁõ¥ËøûË∞ÉËØï consumerÊéßÂà∂Âè∞‰ø°ÊÅØ Êàë‰ª¨ÂÜçËÆøÈóÆÁôªÂΩïÔºå‰ºöÂèëÁé∞Â∑≤Ë∞ÉÁî®Êú¨Âú∞dubboÊ®°ÂºèÔºåËøõÂÖ•debugË∞ÉËØïÊ®°Âºè Êàë‰ª¨Âú®DubboÁÆ°ÁêÜÊéßÂà∂Âè∞ÊääproviderÁ¶ÅÁî®ÔºåÂèëÁé∞‰πüÊòØË∞ÉÁî®Êú¨Âú∞dubboÊúçÂä°ÔºåÁªïËøá‰∫ÜÊ≥®ÂÜå‰∏≠ÂøÉÔºåËøôÂ∞±ÊòØÁõ¥ËøûÊèê‰æõËÄÖ Êàë‰ª¨Âú®${user.home}‰∏ãÈÖçÁΩÆÁõ¥Êé•Êèê‰æõËÄÖÂ±ûÊÄß‰πüÊòØÂèØ‰ª•ÁöÑ(Êé®Ëçê‰ΩøÁî®Ôºâ dubbo-resolve.properties ÂÜÖÂÆπ Ôºö edu.facade.user.service.PmsUserFacade=dubbo://localhost:20880 Ê≥®ÊÑèÁÇπÔºö 1„ÄÅ Áõ¥ËøûÊèê‰æõËÄÖÂè™ÈúÄË¶ÅÂú®Ê∂àË¥πÁ´ØËÆæÁΩÆ 2„ÄÅ ${user.home}ÊåáÁöÑÊòØÂΩìÂâçÊìç‰ΩúÁ≥ªÁªüÁî®Êà∑ÁõÆÂΩïÔºåÂ¶Ç Win7Á≥ªÁªü AdministratorÁöÑÁî®Êà∑ÁõÆÂΩïÂ∞±ÊòØ C:\Users\Administrator]]></content>
      <categories>
        <category>Dubbo</category>
      </categories>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JedisCommandsËØ¥Êòé]]></title>
    <url>%2F2017%2F11%2F13%2FJedisCommands%E8%AF%B4%E6%98%8E%2F</url>
    <content type="text"><![CDATA[https://redis.io/commands/incr 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880881882883884885886887888889890891892893894895896897898899900901902903904905906907908909910911912913914915916917918919920921922923924925926927928929930931932933934935936937938939940941942943944945946947948949950951952953954955956957958959960961962963964965966967968969970971972973974975976977978979980981982983984985986987988989990991992993994995996997998999100010011002100310041005100610071008100910101011101210131014101510161017101810191020102110221023102410251026102710281029103010311032103310341035103610371038103910401041104210431044104510461047104810491050105110521053105410551056105710581059106010611062106310641065106610671068106910701071107210731074107510761077107810791080108110821083108410851086108710881089109010911092109310941095109610971098109911001101110211031104110511061107110811091110111111121113111411151116111711181119112011211122112311241125112611271128112911301131113211331134113511361137113811391140114111421143114411451146114711481149115011511152115311541155115611571158115911601161116211631164116511661167116811691170117111721173117411751176117711781179118011811182118311841185118611871188118911901191119211931194119511961197119811991200120112021203120412051206120712081209121012111212121312141215121612171218121912201221122212231224122512261227122812291230import java.util.List;import java.util.Map;import java.util.Set;/** * Common interface for sharded and non-sharded Jedis */public interface JedisCommands &#123; /** * Â≠òÂÇ®Êï∞ÊçÆÂà∞ÁºìÂ≠ò‰∏≠ÔºåËã•keyÂ∑≤Â≠òÂú®ÂàôË¶ÜÁõñ valueÁöÑÈïøÂ∫¶‰∏çËÉΩË∂ÖËøá1073741824 bytes (1 GB) * * @param key * @param value * @return */ String set(String key, String value); /** * Â≠òÂÇ®Êï∞ÊçÆÂà∞ÁºìÂ≠ò‰∏≠ÔºåÂπ∂Âà∂ÂÆöËøáÊúüÊó∂Èó¥ÂíåÂΩìKeyÂ≠òÂú®Êó∂ÊòØÂê¶Ë¶ÜÁõñ„ÄÇ * * @param key * @param value * @param nxxx * nxxxÁöÑÂÄºÂè™ËÉΩÂèñNXÊàñËÄÖXXÔºåÂ¶ÇÊûúÂèñNXÔºåÂàôÂè™ÊúâÂΩìkey‰∏çÂ≠òÂú®ÊòØÊâçËøõË°åsetÔºåÂ¶ÇÊûúÂèñXXÔºåÂàôÂè™ÊúâÂΩìkeyÂ∑≤ÁªèÂ≠òÂú®Êó∂ÊâçËøõË°åset * * @param expx expxÁöÑÂÄºÂè™ËÉΩÂèñEXÊàñËÄÖPXÔºå‰ª£Ë°®Êï∞ÊçÆËøáÊúüÊó∂Èó¥ÁöÑÂçï‰ΩçÔºåEX‰ª£Ë°®ÁßíÔºåPX‰ª£Ë°®ÊØ´Áßí„ÄÇ * @param time ËøáÊúüÊó∂Èó¥ÔºåÂçï‰ΩçÊòØexpxÊâÄ‰ª£Ë°®ÁöÑÂçï‰Ωç„ÄÇ * @return */ String set(String key, String value, String nxxx, String expx, long time); /** * ‰ªéÁºìÂ≠ò‰∏≠Ê†πÊçÆkeyÂèñÂæóÂÖ∂StringÁ±ªÂûãÁöÑÂÄºÔºåÂ¶ÇÊûúkey‰∏çÂ≠òÂú®ÂàôËøîÂõûnullÔºåÂ¶ÇÊûúkeyÂ≠òÂú®‰ΩÜvalue‰∏çÊòØstringÁ±ªÂûãÁöÑÔºå * ÂàôËøîÂõû‰∏Ä‰∏™error„ÄÇËøô‰∏™ÊñπÊ≥ïÂè™ËÉΩ‰ªéÁºìÂ≠ò‰∏≠ÂèñÂæóvalue‰∏∫stringÁ±ªÂûãÁöÑÂÄº„ÄÇ * * @param key * @return */ String get(String key); /** * Ê£ÄÊü•Êüê‰∏™keyÊòØÂê¶Âú®ÁºìÂ≠ò‰∏≠Â≠òÂú®ÔºåÂ¶ÇÊûúÂ≠òÂú®ËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalseÔºõÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂç≥‰ΩøËØ•keyÊâÄÂØπÂ∫îÁöÑvalueÊòØ‰∏Ä‰∏™Á©∫Â≠óÁ¨¶‰∏≤Ôºå * ‰πü‰æùÁÑ∂‰ºöËøîÂõûtrue„ÄÇ * * @param key * @return */ Boolean exists(String key); /** * * Â¶ÇÊûú‰∏Ä‰∏™keyËÆæÁΩÆ‰∫ÜËøáÊúüÊó∂Èó¥ÔºåÂàôÂèñÊ∂àÂÖ∂ËøáÊúüÊó∂Èó¥Ôºå‰ΩøÂÖ∂Ê∞∏‰πÖÂ≠òÂú®„ÄÇ * * @param key * @return ËøîÂõû1ÊàñËÄÖ0,1‰ª£Ë°®ÂèñÊ∂àËøáÊúüÊó∂Èó¥ÊàêÂäüÔºå0‰ª£Ë°®‰∏çÊàêÂäü(Âè™ÊúâÂΩìkey‰∏çÂ≠òÂú®Êó∂ËøôÁßçÊÉÖÂÜµÊâç‰ºöÂèëÁîü) */ Long persist(String key); /** * ËøîÂõûÊüê‰∏™keyÊâÄÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåËøîÂõûÁöÑÊï∞ÊçÆÁ±ªÂûãÊúâÂèØËÉΩÊòØ"none", "string", "list", "set", "zset", * "hash". "none"‰ª£Ë°®key‰∏çÂ≠òÂú®„ÄÇ * * @param key * @return */ String type(String key); /** * ‰∏∫keyËÆæÁΩÆ‰∏Ä‰∏™ÁâπÂÆöÁöÑËøáÊúüÊó∂Èó¥ÔºåÂçï‰Ωç‰∏∫Áßí„ÄÇËøáÊúüÊó∂Èó¥‰∏ÄÂà∞ÔºåredisÂ∞Ü‰ºö‰ªéÁºìÂ≠ò‰∏≠Âà†Èô§ÊéâËØ•key„ÄÇ * Âç≥‰ΩøÊòØÊúâËøáÊúüÊó∂Èó¥ÁöÑkeyÔºåredis‰πü‰ºöÂú®ÊåÅ‰πÖÂåñÊó∂Â∞ÜÂÖ∂ÂÜôÂà∞Á°¨Áõò‰∏≠ÔºåÂπ∂ÊääÁõ∏ÂØπËøáÊúüÊó∂Èó¥Êîπ‰∏∫ÁªùÂØπÁöÑUnixËøáÊúüÊó∂Èó¥„ÄÇ * Âú®‰∏Ä‰∏™ÊúâËÆæÁΩÆËøáÊúüÊó∂Èó¥ÁöÑkey‰∏äÈáçÂ§çËÆæÁΩÆËøáÊúüÊó∂Èó¥Â∞Ü‰ºöË¶ÜÁõñÂéüÂÖàËÆæÁΩÆÁöÑËøáÊúüÊó∂Èó¥„ÄÇ * * @param key * @param seconds * @return ËøîÂõû1Ë°®Á§∫ÊàêÂäüËÆæÁΩÆËøáÊúüÊó∂Èó¥ÔºåËøîÂõû0Ë°®Á§∫key‰∏çÂ≠òÂú®„ÄÇ */ Long expire(String key, int seconds); /** * Êú∫Âà∂Âêå&#123;@link expire&#125;‰∏ÄÊ†∑ÔºåÂè™ÊòØÊó∂Èó¥Âçï‰ΩçÊîπ‰∏∫ÊØ´Áßí„ÄÇ * * @param key * @param milliseconds * @return ËøîÂõûÂÄºÂêå &#123;@link expire&#125;‰∏ÄÊ†∑„ÄÇ */ Long pexpire(String key, long milliseconds); /** * ‰∏é&#123;@link expire&#125;‰∏ç‰∏ÄÊ†∑ÔºåexpireAtËÆæÁΩÆÁöÑÊó∂Èó¥‰∏çÊòØËÉΩÂ≠òÊ¥ªÂ§ö‰πÖÔºåËÄåÊòØÂõ∫ÂÆöÁöÑUNIXÊó∂Èó¥Ôºà‰ªé1970Âπ¥ÂºÄÂßãÁÆóËµ∑ÔºâÔºåÂçï‰Ωç‰∏∫Áßí„ÄÇ * * @param key * @param unixTime * @return */ Long expireAt(String key, long unixTime); /** * Âêå&#123;@link expireAt&#125;Êú∫Âà∂Áõ∏ÂêåÔºå‰ΩÜÂçï‰Ωç‰∏∫ÊØ´Áßí„ÄÇ * * @param key * @param millisecondsTimestamp * @return */ Long pexpireAt(String key, long millisecondsTimestamp); /** * ËøîÂõû‰∏Ä‰∏™keyËøòËÉΩÊ¥ªÂ§ö‰πÖÔºåÂçï‰Ωç‰∏∫Áßí * * @param key * @return Â¶ÇÊûúËØ•keyÊú¨Êù•Âπ∂Ê≤°ÊúâËÆæÁΩÆËøáÊúüÊó∂Èó¥ÔºåÂàôËøîÂõû-1ÔºåÂ¶ÇÊûúËØ•key‰∏çÂ≠òÂú®ÔºåÂàôËøîÂõû-2 */ Long ttl(String key); /** * ËÆæÁΩÆÊàñËÄÖÊ∏ÖÈô§ÊåáÂÆökeyÁöÑvalue‰∏äÁöÑÊüê‰∏™‰ΩçÁΩÆÁöÑÊØîÁâπ‰ΩçÔºåÂ¶ÇÊûúËØ•keyÂéüÂÖà‰∏çÂ≠òÂú®ÔºåÂàôÊñ∞ÂàõÂª∫‰∏Ä‰∏™keyÔºåÂÖ∂valueÂ∞Ü‰ºöËá™Âä®ÂàÜÈÖçÂÜÖÂ≠òÔºå * Áõ¥Âà∞ÂèØ‰ª•Êîæ‰∏ãÊåáÂÆö‰ΩçÁΩÆÁöÑbitÂÄº„ÄÇ * * @param key * @param offset * @param value true‰ª£Ë°®1Ôºåfalse‰ª£Ë°®0 * @return ËøîÂõûÂéüÊù•‰ΩçÁΩÆÁöÑbitÂÄºÊòØÂê¶ÊòØ1ÔºåÂ¶ÇÊûúÊòØ1ÔºåÂàôËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalse„ÄÇ */ Boolean setbit(String key, long offset, boolean value); /** * ËÆæÁΩÆÊàñËÄÖÊ∏ÖÈô§ÊåáÂÆökeyÁöÑvalue‰∏äÁöÑÊüê‰∏™‰ΩçÁΩÆÁöÑÊØîÁâπ‰ΩçÔºåÂ¶ÇÊûúËØ•keyÂéüÂÖà‰∏çÂ≠òÂú®ÔºåÂàôÊñ∞ÂàõÂª∫‰∏Ä‰∏™keyÔºåÂÖ∂valueÂ∞Ü‰ºöËá™Âä®ÂàÜÈÖçÂÜÖÂ≠òÔºå * Áõ¥Âà∞ÂèØ‰ª•Êîæ‰∏ãÊåáÂÆö‰ΩçÁΩÆÁöÑbitÂÄº„ÄÇ * * @param key * @param offset * @param value Âè™ËÉΩÊòØ"1"ÊàñËÄÖ"0" * @return ËøîÂõûÂéüÊù•‰ΩçÁΩÆÁöÑbitÂÄºÊòØÂê¶ÊòØ1ÔºåÂ¶ÇÊûúÊòØ1ÔºåÂàôËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalse„ÄÇ */ Boolean setbit(String key, long offset, String value); /** * ÂèñÂæóÂÅèÁßªÈáè‰∏∫offsetÁöÑbitÂÄº„ÄÇ * * @param key * @param offset * @return true‰ª£Ë°®1Ôºåfalse‰ª£Ë°®0 */ Boolean getbit(String key, long offset); /** * Ëøô‰∏™ÂëΩ‰ª§ÁöÑ‰ΩúÁî®ÊòØË¶ÜÁõñkeyÂØπÂ∫îÁöÑstringÁöÑ‰∏ÄÈÉ®ÂàÜÔºå‰ªéÊåáÂÆöÁöÑoffsetÂ§ÑÂºÄÂßãÔºåË¶ÜÁõñvalueÁöÑÈïøÂ∫¶„ÄÇ * Â¶ÇÊûúoffsetÊØîÂΩìÂâçkeyÂØπÂ∫îstringËøòË¶ÅÈïøÔºå * ÈÇ£Ëøô‰∏™stringÂêéÈù¢Â∞±Ë°•0‰ª•ËææÂà∞offset„ÄÇ‰∏çÂ≠òÂú®ÁöÑkeysË¢´ËÆ§‰∏∫ÊòØÁ©∫Â≠óÁ¨¶‰∏≤ÔºåÊâÄ‰ª•Ëøô‰∏™ÂëΩ‰ª§ÂèØ‰ª•Á°Æ‰øùkeyÊúâ‰∏Ä‰∏™Ë∂≥Â§üÂ§ßÁöÑÂ≠óÁ¨¶‰∏≤ * ËÉΩÂú®offsetÂ§ÑËÆæÁΩÆvalue„ÄÇ * * @param key * @param offset * @param value * @return ËØ•ÂëΩ‰ª§‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ */ Long setrange(String key, long offset, String value); /** * Ëé∑Âæóstart - end‰πãÈó¥ÁöÑÂ≠êÂ≠óÁ¨¶‰∏≤ÔºåËã•ÂÅèÁßªÈáè‰∏∫Ë¥üÊï∞Ôºå‰ª£Ë°®‰ªéÊú´Â∞æÂºÄÂßãËÆ°ÁÆóÔºå‰æãÂ¶Ç-1‰ª£Ë°®ÂÄíÊï∞Á¨¨‰∏Ä‰∏™Ôºå-2‰ª£Ë°®ÂÄíÊï∞Á¨¨‰∫å‰∏™ * * @param key * @param startOffset * @param endOffset * @return */ String getrange(String key, long startOffset, long endOffset); /** * Ëá™Âä®Â∞ÜkeyÂØπÂ∫îÂà∞valueÂπ∂‰∏îËøîÂõûÂéüÊù•keyÂØπÂ∫îÁöÑvalue„ÄÇÂ¶ÇÊûúkeyÂ≠òÂú®‰ΩÜÊòØÂØπÂ∫îÁöÑvalue‰∏çÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂ∞±ËøîÂõûÈîôËØØ„ÄÇ * * @param key * @param value * @return */ String getSet(String key, String value); /** * ÂèÇËÄÉ &#123;@link set(String key, String value, String nxxx, String expx, long * time)&#125; * * @param key * @param value * @return */ Long setnx(String key, String value); /** * ÂèÇËÄÉ &#123;@link set(String key, String value, String nxxx, String expx, long * time)&#125; * * @param key * @param seconds * @param value * @return */ String setex(String key, int seconds, String value); /** * Â∞ÜÊåáÂÆökeyÁöÑÂÄºÂáèÂ∞ëÊüê‰∏™ÂÄº * * @param key * @param integer * @return ËøîÂõûÂáèÂ∞ëÂêéÁöÑÊñ∞ÂÄº */ Long decrBy(String key, long integer); /** * Â∞ÜÊåáÂÆöKeyÁöÑÂÄºÂáèÂ∞ë1 * * @param key * @return ËøîÂõûÂáèÂ∞ëÂêéÁöÑÊñ∞ÂÄº */ Long decr(String key); /** * Â∞ÜÊåáÂÆöÁöÑkeyÁöÑÂÄºÂ¢ûÂä†ÊåáÂÆöÁöÑÂÄº * * @param key * @param integer * @return ËøîÂõûÂ¢ûÂä†ÂêéÁöÑÊñ∞ÂÄº */ Long incrBy(String key, long integer); /** * Â∞ÜÊåáÂÆöÁöÑkeyÁöÑÂÄºÂ¢ûÂä†ÊåáÂÆöÁöÑÂÄº(ÊµÆÁÇπÊï∞) * * @param key * @param value * @return ËøîÂõûÂ¢ûÂä†ÂêéÁöÑÊñ∞ÂÄº */ Double incrByFloat(String key, double value); /** * Â∞ÜÊåáÂÆöÁöÑkeyÁöÑÂÄºÂ¢ûÂä†1 * * @param key * @return ËøîÂõûÂ¢ûÂä†ÂêéÁöÑÊñ∞ÂÄº */ Long incr(String key); /** * Ëã•keyÂ≠òÂú®ÔºåÂ∞ÜvalueËøΩÂä†Âà∞ÂéüÊúâÂ≠óÁ¨¶‰∏≤ÁöÑÊú´Â∞æ„ÄÇËã•key‰∏çÂ≠òÂú®ÔºåÂàôÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÁ©∫Â≠óÁ¨¶‰∏≤„ÄÇ * * @param key * @param value * @return ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÊÄªÈïøÂ∫¶ */ Long append(String key, String value); /** * ËøîÂõûstart - end ‰πãÈó¥ÁöÑÂ≠êÂ≠óÁ¨¶‰∏≤(start Âíå endÂ§ÑÁöÑÂ≠óÁ¨¶‰πüÂåÖÊã¨Âú®ÂÜÖ) * * @param key * @param start * @param end * @return ËøîÂõûÂ≠êÂ≠óÁ¨¶‰∏≤ */ String substr(String key, int start, int end); /** * ËÆæÁΩÆhashË°®ÈáåfieldÂ≠óÊÆµÁöÑÂÄº‰∏∫value„ÄÇÂ¶ÇÊûúkey‰∏çÂ≠òÂú®ÔºåÂàôÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑhashË°® * * @param key * @param field * @param value * @return Â¶ÇÊûúËØ•Â≠óÊÆµÂ∑≤ÁªèÂ≠òÂú®ÔºåÈÇ£‰πàÂ∞Ü‰ºöÊõ¥Êñ∞ËØ•Â≠óÊÆµÁöÑÂÄºÔºåËøîÂõû0.Â¶ÇÊûúÂ≠óÊÆµ‰∏çÂ≠òÂú®ÔºåÂàôÊñ∞ÂàõÂª∫‰∏Ä‰∏™Âπ∂‰∏îËøîÂõû1. */ Long hset(String key, String field, String value); /** * Â¶ÇÊûúËØ•keyÂØπÂ∫îÁöÑÂÄºÊòØ‰∏Ä‰∏™HashË°®ÔºåÂàôËøîÂõûÂØπÂ∫îÂ≠óÊÆµÁöÑÂÄº„ÄÇ Â¶ÇÊûú‰∏çÂ≠òÂú®ËØ•Â≠óÊÆµÔºåÊàñËÄÖkey‰∏çÂ≠òÂú®ÔºåÂàôËøîÂõû‰∏Ä‰∏™"nil"ÂÄº„ÄÇ * * @param key * @param field * @return */ String hget(String key, String field); /** * ÂΩìÂ≠óÊÆµ‰∏çÂ≠òÂú®Êó∂ÔºåÊâçËøõË°åset„ÄÇ * * @param key * @param field * @param value * @return Â¶ÇÊûúËØ•Â≠óÊÆµÂ∑≤ÁªèÂ≠òÂú®ÔºåÂàôËøîÂõû0.Ëã•Â≠óÊÆµ‰∏çÂ≠òÂú®ÔºåÂàôÂàõÂª∫ÂêésetÔºåËøîÂõû1. */ Long hsetnx(String key, String field, String value); /** * ËÆæÁΩÆÂ§ö‰∏™Â≠óÊÆµÂíåÂÄºÔºåÂ¶ÇÊûúÂ≠óÊÆµÂ≠òÂú®ÔºåÂàôË¶ÜÁõñ„ÄÇ * * @param key * @param hash * @return ËÆæÁΩÆÊàêÂäüËøîÂõûOKÔºåËÆæÁΩÆ‰∏çÊàêÂäüÂàôËøîÂõûEXCEPTION */ String hmset(String key, Map&lt;String, String&gt; hash); /** * Âú®hash‰∏≠Ëé∑ÂèñÂ§ö‰∏™Â≠óÊÆµÁöÑÂÄºÔºåËã•Â≠óÊÆµ‰∏çÂ≠òÂú®ÔºåÂàôÂÖ∂ÂÄº‰∏∫nil„ÄÇ * * @param key * @param fields * @return ÊåâÈ°∫Â∫èËøîÂõûÂ§ö‰∏™Â≠óÊÆµÁöÑÂÄº„ÄÇ */ List&lt;String&gt; hmget(String key, String... fields); /** * ÂØπhash‰∏≠ÊåáÂÆöÂ≠óÊÆµÁöÑÂÄºÂ¢ûÂä†ÊåáÂÆöÁöÑÂÄº * * @param key * @param field * @param value * @return ËøîÂõûÂ¢ûÂä†ÂêéÁöÑÊñ∞ÂÄº */ Long hincrBy(String key, String field, long value); /** * Âà§Êñ≠hash‰∏≠ÊåáÂÆöÂ≠óÊÆµÊòØÂê¶Â≠òÂú® * * @param key * @param field * @return Ëã•Â≠òÂú®ËøîÂõû1ÔºåËã•‰∏çÂ≠òÂú®ËøîÂõû0 */ Boolean hexists(String key, String field); /** * Âà†Èô§hash‰∏≠ÊåáÂÆöÂ≠óÊÆµ * * @param key * @param field * @return Âà†Èô§ÊàêÂäüËøîÂõû1Ôºå Âà†Èô§‰∏çÊàêÂäüËøîÂõû0 */ Long hdel(String key, String... field); /** * ËøîÂõû key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜÂåÖÂê´ÁöÑÂ≠óÊÆµÁöÑÊï∞Èáè * * @param key * @return ÂìàÂ∏åÈõÜ‰∏≠Â≠óÊÆµÁöÑÊï∞ÈáèÔºåÂΩì key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏çÂ≠òÂú®Êó∂ËøîÂõû 0 */ Long hlen(String key); /** * ËøîÂõû key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏≠ÊâÄÊúâÂ≠óÊÆµÁöÑÂêçÂ≠ó„ÄÇ * * @param key * @return ÂìàÂ∏åÈõÜ‰∏≠ÁöÑÂ≠óÊÆµÂàóË°®ÔºåÂΩì key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏çÂ≠òÂú®Êó∂ËøîÂõûÁ©∫ÂàóË°®„ÄÇ */ Set&lt;String&gt; hkeys(String key); /** * ËøîÂõû key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏≠ÊâÄÊúâÂ≠óÊÆµÁöÑÂÄº„ÄÇ * * @param key * @return ÂìàÂ∏åÈõÜ‰∏≠ÁöÑÂÄºÁöÑÂàóË°®ÔºåÂΩì key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏çÂ≠òÂú®Êó∂ËøîÂõûÁ©∫ÂàóË°®„ÄÇ */ List&lt;String&gt; hvals(String key); /** * ËøîÂõû key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏≠ÊâÄÊúâÁöÑÂ≠óÊÆµÂíåÂÄº * * @param key * @return ËøîÂõû key ÊåáÂÆöÁöÑÂìàÂ∏åÈõÜ‰∏≠ÊâÄÊúâÁöÑÂ≠óÊÆµÂíåÂÄº,Ëã•key‰∏çÂ≠òÂú®ËøîÂõûÁ©∫map„ÄÇ */ Map&lt;String, String&gt; hgetAll(String key); /** * ÂêëÂ≠ò‰∫é key ÁöÑÂàóË°®ÁöÑÂ∞æÈÉ®ÊèíÂÖ•ÊâÄÊúâÊåáÂÆöÁöÑÂÄº„ÄÇÂ¶ÇÊûú key ‰∏çÂ≠òÂú®ÔºåÈÇ£‰πà‰ºöÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑÂàóË°®ÁÑ∂ÂêéÂÜçËøõË°å push Êìç‰Ωú„ÄÇ ÂΩì key * ‰øùÂ≠òÁöÑ‰∏çÊòØ‰∏Ä‰∏™ÂàóË°®ÔºåÈÇ£‰πà‰ºöËøîÂõû‰∏Ä‰∏™ÈîôËØØ„ÄÇ * * ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™ÂëΩ‰ª§ÊääÂ§ö‰∏™ÂÖÉÁ¥†ÊâìÂÖ•ÈòüÂàóÔºåÂè™ÈúÄË¶ÅÂú®ÂëΩ‰ª§ÂêéÈù¢ÊåáÂÆöÂ§ö‰∏™ÂèÇÊï∞„ÄÇÂÖÉÁ¥†ÊòØ‰ªéÂ∑¶Âà∞Âè≥‰∏Ä‰∏™Êé•‰∏Ä‰∏™‰ªéÂàóË°®Â∞æÈÉ®ÊèíÂÖ•„ÄÇ ÊØîÂ¶ÇÂëΩ‰ª§ RPUSH mylist a * b c ‰ºöËøîÂõû‰∏Ä‰∏™ÂàóË°®ÔºåÂÖ∂Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØ a ÔºåÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÊòØ b ÔºåÁ¨¨‰∏â‰∏™ÂÖÉÁ¥†ÊòØ c„ÄÇ * * @param key * @param string * @return Âú® push Êìç‰ΩúÂêéÁöÑÂàóË°®ÈïøÂ∫¶„ÄÇ */ Long rpush(String key, String... string); /** * Â∞ÜÊâÄÊúâÊåáÂÆöÁöÑÂÄºÊèíÂÖ•Âà∞Â≠ò‰∫é key ÁöÑÂàóË°®ÁöÑÂ§¥ÈÉ®„ÄÇÂ¶ÇÊûú key ‰∏çÂ≠òÂú®ÔºåÈÇ£‰πàÂú®ËøõË°å push Êìç‰ΩúÂâç‰ºöÂàõÂª∫‰∏Ä‰∏™Á©∫ÂàóË°®„ÄÇ Â¶ÇÊûú key * ÂØπÂ∫îÁöÑÂÄº‰∏çÊòØ‰∏Ä‰∏™ list ÁöÑËØùÔºåÈÇ£‰πà‰ºöËøîÂõû‰∏Ä‰∏™ÈîôËØØ„ÄÇ * * ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™ÂëΩ‰ª§ÊääÂ§ö‰∏™ÂÖÉÁ¥† push ËøõÂÖ•ÂàóË°®ÔºåÂè™ÈúÄÂú®ÂëΩ‰ª§Êú´Â∞æÂä†‰∏äÂ§ö‰∏™ÊåáÂÆöÁöÑÂèÇÊï∞„ÄÇÂÖÉÁ¥†ÊòØ‰ªéÊúÄÂ∑¶Á´ØÁöÑÂà∞ÊúÄÂè≥Á´ØÁöÑ„ÄÅ‰∏Ä‰∏™Êé•‰∏Ä‰∏™Ë¢´ÊèíÂÖ•Âà∞ list * ÁöÑÂ§¥ÈÉ®„ÄÇ ÊâÄ‰ª•ÂØπ‰∫éËøô‰∏™ÂëΩ‰ª§‰æãÂ≠ê LPUSH mylist a b cÔºåËøîÂõûÁöÑÂàóË°®ÊòØ c ‰∏∫Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå b ‰∏∫Á¨¨‰∫å‰∏™ÂÖÉÁ¥†Ôºå a ‰∏∫Á¨¨‰∏â‰∏™ÂÖÉÁ¥†„ÄÇ * * @param key * @param string * @return Âú® push Êìç‰ΩúÂêéÁöÑÂàóË°®ÈïøÂ∫¶„ÄÇ */ Long lpush(String key, String... string); /** * ËøîÂõûÂ≠òÂÇ®Âú® key ÈáåÁöÑlistÁöÑÈïøÂ∫¶„ÄÇ Â¶ÇÊûú key ‰∏çÂ≠òÂú®ÔºåÈÇ£‰πàÂ∞±Ë¢´Áúã‰ΩúÊòØÁ©∫listÔºåÂπ∂‰∏îËøîÂõûÈïøÂ∫¶‰∏∫ 0„ÄÇ ÂΩìÂ≠òÂÇ®Âú® key * ÈáåÁöÑÂÄº‰∏çÊòØ‰∏Ä‰∏™listÁöÑËØùÔºå‰ºöËøîÂõûerror„ÄÇ * * @param key * @return keyÂØπÂ∫îÁöÑlistÁöÑÈïøÂ∫¶„ÄÇ */ Long llen(String key); /** * ËøîÂõûÂ≠òÂÇ®Âú® key ÁöÑÂàóË°®ÈáåÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÂÖÉÁ¥†„ÄÇ start Âíå end * ÂÅèÁßªÈáèÈÉΩÊòØÂü∫‰∫é0ÁöÑ‰∏ãÊ†áÔºåÂç≥listÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†‰∏ãÊ†áÊòØ0ÔºàlistÁöÑË°®Â§¥ÔºâÔºåÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†‰∏ãÊ†áÊòØ1Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * * ÂÅèÁßªÈáè‰πüÂèØ‰ª•ÊòØË¥üÊï∞ÔºåË°®Á§∫ÂÅèÁßªÈáèÊòØ‰ªélistÂ∞æÈÉ®ÂºÄÂßãËÆ°Êï∞„ÄÇ ‰æãÂ¶ÇÔºå -1 Ë°®Á§∫ÂàóË°®ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå-2 ÊòØÂÄíÊï∞Á¨¨‰∫å‰∏™Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * * @param key * @param start * @param end * @return ÊåáÂÆöËåÉÂõ¥ÈáåÁöÑÂàóË°®ÂÖÉÁ¥†„ÄÇ */ List&lt;String&gt; lrange(String key, long start, long end); /** * ‰øÆÂâ™(trim)‰∏Ä‰∏™Â∑≤Â≠òÂú®ÁöÑ listÔºåËøôÊ†∑ list Â∞±‰ºöÂè™ÂåÖÂê´ÊåáÂÆöËåÉÂõ¥ÁöÑÊåáÂÆöÂÖÉÁ¥†„ÄÇstart Âíå stop ÈÉΩÊòØÁî±0ÂºÄÂßãËÆ°Êï∞ÁöÑÔºå ËøôÈáåÁöÑ 0 * ÊòØÂàóË°®ÈáåÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÔºàË°®Â§¥ÔºâÔºå1 ÊòØÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * * @param key * @param start * @param end * @return */ String ltrim(String key, long start, long end); /** * ËøîÂõûÂàóË°®ÈáåÁöÑÂÖÉÁ¥†ÁöÑÁ¥¢Âºï index Â≠òÂÇ®Âú® key ÈáåÈù¢„ÄÇ ‰∏ãÊ†áÊòØ‰ªé0ÂºÄÂßãÁ¥¢ÂºïÁöÑÔºåÊâÄ‰ª• 0 ÊòØË°®Á§∫Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå 1 Ë°®Á§∫Á¨¨‰∫å‰∏™ÂÖÉÁ¥†ÔºåÂπ∂‰ª•Ê≠§Á±ªÊé®„ÄÇ * Ë¥üÊï∞Á¥¢ÂºïÁî®‰∫éÊåáÂÆö‰ªéÂàóË°®Â∞æÈÉ®ÂºÄÂßãÁ¥¢ÂºïÁöÑÂÖÉÁ¥†„ÄÇÂú®ËøôÁßçÊñπÊ≥ï‰∏ãÔºå-1 Ë°®Á§∫ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå-2 Ë°®Á§∫ÂÄíÊï∞Á¨¨‰∫å‰∏™ÂÖÉÁ¥†ÔºåÂπ∂‰ª•Ê≠§ÂæÄÂâçÊé®„ÄÇ * * ÂΩì key ‰ΩçÁΩÆÁöÑÂÄº‰∏çÊòØ‰∏Ä‰∏™ÂàóË°®ÁöÑÊó∂ÂÄôÔºå‰ºöËøîÂõû‰∏Ä‰∏™error„ÄÇ * * @param key * @param index * @return ËØ∑Ê±ÇÁöÑÂØπÂ∫îÂÖÉÁ¥†ÔºåÊàñËÄÖÂΩì index Ë∂ÖËøáËåÉÂõ¥ÁöÑÊó∂ÂÄôËøîÂõû nil„ÄÇ */ String lindex(String key, long index); /** * ËÆæÁΩÆ index ‰ΩçÁΩÆÁöÑlistÂÖÉÁ¥†ÁöÑÂÄº‰∏∫ value„ÄÇ * * ÂΩìindexË∂ÖÂá∫ËåÉÂõ¥Êó∂‰ºöËøîÂõû‰∏Ä‰∏™error„ÄÇ * * @param key * @param index * @param value * @return Áä∂ÊÄÅÊÅ¢Â§ç */ String lset(String key, long index, String value); /** * ‰ªéÂ≠ò‰∫é key ÁöÑÂàóË°®ÈáåÁßªÈô§Ââç count Ê¨°Âá∫Áé∞ÁöÑÂÄº‰∏∫ value ÁöÑÂÖÉÁ¥†„ÄÇ Ëøô‰∏™ count ÂèÇÊï∞ÈÄöËøá‰∏ãÈù¢Âá†ÁßçÊñπÂºèÂΩ±ÂìçËøô‰∏™Êìç‰ΩúÔºö * * count &gt; 0: ‰ªéÂ§¥ÂæÄÂ∞æÁßªÈô§ÂÄº‰∏∫ value ÁöÑÂÖÉÁ¥†„ÄÇ count &lt; 0: ‰ªéÂ∞æÂæÄÂ§¥ÁßªÈô§ÂÄº‰∏∫ value ÁöÑÂÖÉÁ¥†„ÄÇ count = 0: * ÁßªÈô§ÊâÄÊúâÂÄº‰∏∫ value ÁöÑÂÖÉÁ¥†„ÄÇ * * ÊØîÂ¶ÇÔºå LREM list -2 "hello" ‰ºö‰ªéÂ≠ò‰∫é list ÁöÑÂàóË°®ÈáåÁßªÈô§ÊúÄÂêé‰∏§‰∏™Âá∫Áé∞ÁöÑ "hello"„ÄÇ * * ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûúlistÈáåÊ≤°ÊúâÂ≠òÂú®keyÂ∞±‰ºöË¢´ÂΩì‰ΩúÁ©∫listÂ§ÑÁêÜÔºåÊâÄ‰ª•ÂΩì key ‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄôÔºåËøô‰∏™ÂëΩ‰ª§‰ºöËøîÂõû 0„ÄÇ * * @param key * @param count * @param value * @return ËøîÂõûÂà†Èô§ÁöÑ‰∏™Êï∞ */ Long lrem(String key, long count, String value); /** * ÁßªÈô§Âπ∂‰∏îËøîÂõû key ÂØπÂ∫îÁöÑ list ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÇ * * @param key * @return ËøîÂõûÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂÄºÔºåÊàñËÄÖÂΩì key ‰∏çÂ≠òÂú®Êó∂ËøîÂõû nil„ÄÇ */ String lpop(String key); /** * ÁßªÈô§Âπ∂ËøîÂõûÂ≠ò‰∫é key ÁöÑ list ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÇ * * @param key * @return ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂÄºÔºåÊàñËÄÖÂΩì key ‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄôËøîÂõû nil„ÄÇ */ String rpop(String key); /** * Ê∑ªÂä†‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊåáÂÆöÁöÑmemberÂÖÉÁ¥†Âà∞ÈõÜÂêàÁöÑ key‰∏≠.ÊåáÂÆöÁöÑ‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™ÂÖÉÁ¥†member Â¶ÇÊûúÂ∑≤ÁªèÂú®ÈõÜÂêàkey‰∏≠Â≠òÂú®ÂàôÂøΩÁï•.Â¶ÇÊûúÈõÜÂêàkey * ‰∏çÂ≠òÂú®ÔºåÂàôÊñ∞Âª∫ÈõÜÂêàkey,Âπ∂Ê∑ªÂä†memberÂÖÉÁ¥†Âà∞ÈõÜÂêàkey‰∏≠. * * Â¶ÇÊûúkey ÁöÑÁ±ªÂûã‰∏çÊòØÈõÜÂêàÂàôËøîÂõûÈîôËØØ. * * @param key * @param member * @return ËøîÂõûÊñ∞ÊàêÂäüÊ∑ªÂä†Âà∞ÈõÜÂêàÈáåÂÖÉÁ¥†ÁöÑÊï∞ÈáèÔºå‰∏çÂåÖÊã¨Â∑≤ÁªèÂ≠òÂú®‰∫éÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†. */ Long sadd(String key, String... member); /** * ËøîÂõûkeyÈõÜÂêàÊâÄÊúâÁöÑÂÖÉÁ¥†. * * ËØ•ÂëΩ‰ª§ÁöÑ‰ΩúÁî®‰∏é‰ΩøÁî®‰∏Ä‰∏™ÂèÇÊï∞ÁöÑSINTER ÂëΩ‰ª§‰ΩúÁî®Áõ∏Âêå. * * @param key * @return ÈõÜÂêà‰∏≠ÁöÑÊâÄÊúâÂÖÉÁ¥†. */ Set&lt;String&gt; smembers(String key); /** * Âú®keyÈõÜÂêà‰∏≠ÁßªÈô§ÊåáÂÆöÁöÑÂÖÉÁ¥†. Â¶ÇÊûúÊåáÂÆöÁöÑÂÖÉÁ¥†‰∏çÊòØkeyÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÂàôÂøΩÁï• Â¶ÇÊûúkeyÈõÜÂêà‰∏çÂ≠òÂú®ÂàôË¢´ËßÜ‰∏∫‰∏Ä‰∏™Á©∫ÁöÑÈõÜÂêàÔºåËØ•ÂëΩ‰ª§ËøîÂõû0. * * Â¶ÇÊûúkeyÁöÑÁ±ªÂûã‰∏çÊòØ‰∏Ä‰∏™ÈõÜÂêà,ÂàôËøîÂõûÈîôËØØ. * * @param key * @param member * @return ‰ªéÈõÜÂêà‰∏≠ÁßªÈô§ÂÖÉÁ¥†ÁöÑ‰∏™Êï∞Ôºå‰∏çÂåÖÊã¨‰∏çÂ≠òÂú®ÁöÑÊàêÂëò. */ Long srem(String key, String... member); /** * ÁßªÈô§Âπ∂ËøîÂõû‰∏Ä‰∏™ÈõÜÂêà‰∏≠ÁöÑÈöèÊú∫ÂÖÉÁ¥† * * ËØ•ÂëΩ‰ª§‰∏é SRANDMEMBERÁõ∏‰ºº,‰∏çÂêåÁöÑÊòØsrandmemberÂëΩ‰ª§ËøîÂõû‰∏Ä‰∏™ÈöèÊú∫ÂÖÉÁ¥†‰ΩÜÊòØ‰∏çÁßªÈô§. * * @param key * @return Ë¢´ÁßªÈô§ÁöÑÂÖÉÁ¥†, ÂΩìkey‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄôËøîÂõû nil . */ String spop(String key); /** * ÁßªÈô§Âπ∂ËøîÂõûÂ§ö‰∏™ÈõÜÂêà‰∏≠ÁöÑÈöèÊú∫ÂÖÉÁ¥† * * @param key * @param count * @return Ë¢´ÁßªÈô§ÁöÑÂÖÉÁ¥†, ÂΩìkey‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄôÂÄº‰∏∫ nil . */ Set&lt;String&gt; spop(String key, long count); /** * ËøîÂõûÈõÜÂêàÂ≠òÂÇ®ÁöÑkeyÁöÑÂü∫Êï∞ (ÈõÜÂêàÂÖÉÁ¥†ÁöÑÊï∞Èáè). * * @param key * @return ÈõÜÂêàÁöÑÂü∫Êï∞(ÂÖÉÁ¥†ÁöÑÊï∞Èáè),Â¶ÇÊûúkey‰∏çÂ≠òÂú®,ÂàôËøîÂõû 0. */ Long scard(String key); /** * ËøîÂõûÊàêÂëò member ÊòØÂê¶ÊòØÂ≠òÂÇ®ÁöÑÈõÜÂêà keyÁöÑÊàêÂëò. * * @param key * @param member * @return Â¶ÇÊûúmemberÂÖÉÁ¥†ÊòØÈõÜÂêàkeyÁöÑÊàêÂëòÔºåÂàôËøîÂõû1.Â¶ÇÊûúmemberÂÖÉÁ¥†‰∏çÊòØkeyÁöÑÊàêÂëòÔºåÊàñËÄÖÈõÜÂêàkey‰∏çÂ≠òÂú®ÔºåÂàôËøîÂõû0 */ Boolean sismember(String key, String member); /** * ‰ªÖÊèê‰æõkeyÂèÇÊï∞,ÈÇ£‰πàÈöèÊú∫ËøîÂõûkeyÈõÜÂêà‰∏≠ÁöÑ‰∏Ä‰∏™ÂÖÉÁ¥†.ËØ•ÂëΩ‰ª§‰ΩúÁî®Á±ª‰ºº‰∫éSPOPÂëΩ‰ª§, ‰∏çÂêåÁöÑÊòØSPOPÂëΩ‰ª§‰ºöÂ∞ÜË¢´ÈÄâÊã©ÁöÑÈöèÊú∫ÂÖÉÁ¥†‰ªéÈõÜÂêà‰∏≠ÁßªÈô§, * ËÄåSRANDMEMBER‰ªÖ‰ªÖÊòØËøîÂõûËØ•ÈöèËÆ∞ÂÖÉÁ¥†,ËÄå‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú. * * @param key * @return ËøîÂõûÈöèÊú∫ÁöÑÂÖÉÁ¥†,Â¶ÇÊûúkey‰∏çÂ≠òÂú®ÂàôËøîÂõûnil */ String srandmember(String key); /** * Â¶ÇÊûúcountÊòØÊï¥Êï∞‰∏îÂ∞è‰∫éÂÖÉÁ¥†ÁöÑ‰∏™Êï∞ÔºåËøîÂõûÂê´Êúâ count * ‰∏™‰∏çÂêåÁöÑÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ,Â¶ÇÊûúcountÊòØ‰∏™Êï¥Êï∞‰∏îÂ§ß‰∫éÈõÜÂêà‰∏≠ÂÖÉÁ¥†ÁöÑ‰∏™Êï∞Êó∂,‰ªÖËøîÂõûÊï¥‰∏™ÈõÜÂêàÁöÑÊâÄÊúâÂÖÉÁ¥† * ,ÂΩìcountÊòØË¥üÊï∞,Âàô‰ºöËøîÂõû‰∏Ä‰∏™ÂåÖÂê´countÁöÑÁªùÂØπÂÄºÁöÑ‰∏™Êï∞ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ * ÔºåÂ¶ÇÊûúcountÁöÑÁªùÂØπÂÄºÂ§ß‰∫éÂÖÉÁ¥†ÁöÑ‰∏™Êï∞,ÂàôËøîÂõûÁöÑÁªìÊûúÈõÜÈáå‰ºöÂá∫Áé∞‰∏Ä‰∏™ÂÖÉÁ¥†Âá∫Áé∞Â§öÊ¨°ÁöÑÊÉÖÂÜµ. * * @param key * @param count * @return ËøîÂõû‰∏Ä‰∏™ÈöèÊú∫ÁöÑÂÖÉÁ¥†Êï∞ÁªÑ,Â¶ÇÊûúkey‰∏çÂ≠òÂú®ÂàôËøîÂõû‰∏Ä‰∏™Á©∫ÁöÑÊï∞ÁªÑ. */ List&lt;String&gt; srandmember(String key, int count); /** * ËøîÂõûkeyÁöÑstringÁ±ªÂûãvalueÁöÑÈïøÂ∫¶„ÄÇÂ¶ÇÊûúkeyÂØπÂ∫îÁöÑÈùûstringÁ±ªÂûãÔºåÂ∞±ËøîÂõûÈîôËØØ„ÄÇ * * @param key * @return keyÂØπÂ∫îÁöÑÂ≠óÁ¨¶‰∏≤valueÁöÑÈïøÂ∫¶ÔºåÊàñËÄÖ0Ôºàkey‰∏çÂ≠òÂú®Ôºâ */ Long strlen(String key); /** * ËØ•ÂëΩ‰ª§Ê∑ªÂä†ÊåáÂÆöÁöÑÊàêÂëòÂà∞keyÂØπÂ∫îÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÔºåÊØè‰∏™ÊàêÂëòÈÉΩÊúâ‰∏Ä‰∏™ÂàÜÊï∞„ÄÇ‰Ω†ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™ÂàÜÊï∞/ÊàêÂëòÁªÑÂêà„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÊåáÂÆöÁöÑÊàêÂëòÂ∑≤ÁªèÂú®ÂØπÂ∫îÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠‰∫ÜÔºå * ÈÇ£‰πàÂÖ∂ÂàÜÊï∞Â∞±‰ºöË¢´Êõ¥Êñ∞ÊàêÊúÄÊñ∞ÁöÑ * ÔºåÂπ∂‰∏îËØ•ÊàêÂëò‰ºöÈáçÊñ∞Ë∞ÉÊï¥Âà∞Ê≠£Á°ÆÁöÑ‰ΩçÁΩÆÔºå‰ª•Á°Æ‰øùÈõÜÂêàÊúâÂ∫è„ÄÇÂ¶ÇÊûúkey‰∏çÂ≠òÂú®ÔºåÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™Âê´ÊúâËøô‰∫õÊàêÂëòÁöÑÊúâÂ∫èÈõÜÂêàÔºåÂ∞±Â•ΩÂÉèÂæÄ‰∏Ä‰∏™Á©∫ÁöÑÈõÜÂêà‰∏≠Ê∑ªÂä†‰∏ÄÊ†∑ * „ÄÇÂ¶ÇÊûúkeyÂ≠òÂú®Ôºå‰ΩÜÊòØÂÆÉÂπ∂‰∏çÊòØ‰∏Ä‰∏™ÊúâÂ∫èÈõÜÂêàÔºåÈÇ£‰πàÂ∞±ËøîÂõû‰∏Ä‰∏™ÈîôËØØ„ÄÇ * * ÂàÜÊï∞ÁöÑÂÄºÂøÖÈ°ªÊòØ‰∏Ä‰∏™Ë°®Á§∫Êï∞Â≠óÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂‰∏îÂèØ‰ª•ÊòØdoubleÁ±ªÂûãÁöÑÊµÆÁÇπÊï∞„ÄÇ * * @param key * @param score * @param member * @return ËøîÂõûÊ∑ªÂä†Âà∞ÊúâÂ∫èÈõÜÂêà‰∏≠ÂÖÉÁ¥†ÁöÑ‰∏™Êï∞Ôºå‰∏çÂåÖÊã¨ÈÇ£ÁßçÂ∑≤ÁªèÂ≠òÂú®Âè™ÊòØÊõ¥Êñ∞ÂàÜÊï∞ÁöÑÂÖÉÁ¥†„ÄÇ */ Long zadd(String key, double score, String member); /** * ËØ•ÂëΩ‰ª§Ê∑ªÂä†ÊåáÂÆöÁöÑÊàêÂëòÂà∞keyÂØπÂ∫îÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÔºåÊØè‰∏™ÊàêÂëòÈÉΩÊúâ‰∏Ä‰∏™ÂàÜÊï∞„ÄÇ‰Ω†ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™ÂàÜÊï∞/ÊàêÂëòÁªÑÂêà„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÊåáÂÆöÁöÑÊàêÂëòÂ∑≤ÁªèÂú®ÂØπÂ∫îÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠‰∫ÜÔºå * ÈÇ£‰πàÂÖ∂ÂàÜÊï∞Â∞±‰ºöË¢´Êõ¥Êñ∞ÊàêÊúÄÊñ∞ÁöÑ * ÔºåÂπ∂‰∏îËØ•ÊàêÂëò‰ºöÈáçÊñ∞Ë∞ÉÊï¥Âà∞Ê≠£Á°ÆÁöÑ‰ΩçÁΩÆÔºå‰ª•Á°Æ‰øùÈõÜÂêàÊúâÂ∫è„ÄÇÂ¶ÇÊûúkey‰∏çÂ≠òÂú®ÔºåÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™Âê´ÊúâËøô‰∫õÊàêÂëòÁöÑÊúâÂ∫èÈõÜÂêàÔºåÂ∞±Â•ΩÂÉèÂæÄ‰∏Ä‰∏™Á©∫ÁöÑÈõÜÂêà‰∏≠Ê∑ªÂä†‰∏ÄÊ†∑ * „ÄÇÂ¶ÇÊûúkeyÂ≠òÂú®Ôºå‰ΩÜÊòØÂÆÉÂπ∂‰∏çÊòØ‰∏Ä‰∏™ÊúâÂ∫èÈõÜÂêàÔºåÈÇ£‰πàÂ∞±ËøîÂõû‰∏Ä‰∏™ÈîôËØØ„ÄÇ * * ÂàÜÊï∞ÁöÑÂÄºÂøÖÈ°ªÊòØ‰∏Ä‰∏™Ë°®Á§∫Êï∞Â≠óÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂‰∏îÂèØ‰ª•ÊòØdoubleÁ±ªÂûãÁöÑÊµÆÁÇπÊï∞„ÄÇ * * @param key * @param scoreMembers * @return ËøîÂõûÊ∑ªÂä†Âà∞ÊúâÂ∫èÈõÜÂêà‰∏≠ÂÖÉÁ¥†ÁöÑ‰∏™Êï∞Ôºå‰∏çÂåÖÊã¨ÈÇ£ÁßçÂ∑≤ÁªèÂ≠òÂú®Âè™ÊòØÊõ¥Êñ∞ÂàÜÊï∞ÁöÑÂÖÉÁ¥†„ÄÇ */ Long zadd(String key, Map&lt;String, Double&gt; scoreMembers); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëò„ÄÇÂÖ∂‰∏≠ÊàêÂëòÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ∞èÂà∞Â§ß)Êù•ÊéíÂ∫è„ÄÇÂÖ∑ÊúâÁõ∏ÂêåscoreÂÄºÁöÑÊàêÂëòÊåâÂ≠óÂÖ∏Â∫èÊù•ÊéíÂàó„ÄÇ * * Â¶ÇÊûú‰Ω†ÈúÄË¶ÅÊàêÂëòÊåâscoreÂÄºÈÄíÂáè(scoreÁõ∏Á≠âÊó∂ÊåâÂ≠óÂÖ∏Â∫èÈÄíÂáè)Êù•ÊéíÂàóÔºåËØ∑‰ΩøÁî®ZREVRANGEÂëΩ‰ª§„ÄÇ * ‰∏ãÊ†áÂèÇÊï∞startÂíåstopÈÉΩ‰ª•0‰∏∫Â∫ïÔºå‰πüÂ∞±ÊòØËØ¥Ôºå‰ª•0Ë°®Á§∫ÊúâÂ∫èÈõÜÁ¨¨‰∏Ä‰∏™ÊàêÂëòÔºå‰ª•1Ë°®Á§∫ÊúâÂ∫èÈõÜÁ¨¨‰∫å‰∏™ÊàêÂëòÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * ‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®Ë¥üÊï∞‰∏ãÊ†áÔºå‰ª•-1Ë°®Á§∫ÊúÄÂêé‰∏Ä‰∏™ÊàêÂëòÔºå-2Ë°®Á§∫ÂÄíÊï∞Á¨¨‰∫å‰∏™ÊàêÂëòÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * * Ë∂ÖÂá∫ËåÉÂõ¥ÁöÑ‰∏ãÊ†áÂπ∂‰∏ç‰ºöÂºïËµ∑ÈîôËØØ„ÄÇÂ¶ÇÊûústartÁöÑÂÄºÊØîÊúâÂ∫èÈõÜÁöÑÊúÄÂ§ß‰∏ãÊ†áËøòË¶ÅÂ§ßÔºåÊàñÊòØstart &gt; * stopÊó∂ÔºåZRANGEÂëΩ‰ª§Âè™ÊòØÁÆÄÂçïÂú∞ËøîÂõû‰∏Ä‰∏™Á©∫ÂàóË°®„ÄÇ * Âè¶‰∏ÄÊñπÈù¢ÔºåÂÅáÂ¶ÇstopÂèÇÊï∞ÁöÑÂÄºÊØîÊúâÂ∫èÈõÜÁöÑÊúÄÂ§ß‰∏ãÊ†áËøòË¶ÅÂ§ßÔºåÈÇ£‰πàRedisÂ∞ÜstopÂΩì‰ΩúÊúÄÂ§ß‰∏ãÊ†áÊù•Â§ÑÁêÜ„ÄÇ * * @param key * @param start * @param end * @return ÊåáÂÆöËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°® */ Set&lt;String&gt; zrange(String key, long start, long end); /** * ‰ªéÈõÜÂêà‰∏≠Âà†Èô§ÊåáÂÆömemberÂÖÉÁ¥†ÔºåÂΩìkeyÂ≠òÂú®Ôºå‰ΩÜÊòØÂÖ∂‰∏çÊòØÊúâÂ∫èÈõÜÂêàÁ±ªÂûãÔºåÂ∞±ËøîÂõû‰∏Ä‰∏™ÈîôËØØ„ÄÇ * * @param key * @param member * @return ËøîÂõûÁöÑÊòØ‰ªéÊúâÂ∫èÈõÜÂêà‰∏≠Âà†Èô§ÁöÑÊàêÂëò‰∏™Êï∞Ôºå‰∏çÂåÖÊã¨‰∏çÂ≠òÂú®ÁöÑÊàêÂëò„ÄÇ */ Long zrem(String key, String... member); /** * ‰∏∫ÊúâÂ∫èÈõÜkeyÁöÑÊàêÂëòmemberÁöÑscoreÂÄºÂä†‰∏äÂ¢ûÈáèincrement„ÄÇÂ¶ÇÊûúkey‰∏≠‰∏çÂ≠òÂú®memberÔºåÂ∞±Âú®key‰∏≠Ê∑ªÂä†‰∏Ä‰∏™memberÔºå * scoreÊòØincrementÔºàÂ∞±Â•ΩÂÉèÂÆÉ‰πãÂâçÁöÑscoreÊòØ0.0Ôºâ„ÄÇÂ¶ÇÊûúkey‰∏çÂ≠òÂú®ÔºåÂ∞±ÂàõÂª∫‰∏Ä‰∏™Âè™Âê´ÊúâÊåáÂÆömemberÊàêÂëòÁöÑÊúâÂ∫èÈõÜÂêà„ÄÇ * * ÂΩìkey‰∏çÊòØÊúâÂ∫èÈõÜÁ±ªÂûãÊó∂ÔºåËøîÂõû‰∏Ä‰∏™ÈîôËØØ„ÄÇ * * scoreÂÄºÂøÖÈ°ªÊï¥Êï∞ÂÄºÊàñÂèåÁ≤æÂ∫¶ÊµÆÁÇπÊï∞„ÄÇ‰πüÊúâÂèØËÉΩÁªô‰∏Ä‰∏™Ë¥üÊï∞Êù•ÂáèÂ∞ëscoreÁöÑÂÄº„ÄÇ * * @param key * @param score * @param member * @return memberÊàêÂëòÁöÑÊñ∞scoreÂÄº. */ Double zincrby(String key, double score, String member); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÊàêÂëòmemberÁöÑÊéíÂêç„ÄÇÂÖ∂‰∏≠ÊúâÂ∫èÈõÜÊàêÂëòÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ∞èÂà∞Â§ß)È°∫Â∫èÊéíÂàó„ÄÇÊéíÂêç‰ª•0‰∏∫Â∫ïÔºå‰πüÂ∞±ÊòØËØ¥Ôºå * scoreÂÄºÊúÄÂ∞èÁöÑÊàêÂëòÊéíÂêç‰∏∫0„ÄÇ * * ‰ΩøÁî®ZREVRANKÂëΩ‰ª§ÂèØ‰ª•Ëé∑ÂæóÊàêÂëòÊåâscoreÂÄºÈÄíÂáè(‰ªéÂ§ßÂà∞Â∞è)ÊéíÂàóÁöÑÊéíÂêç„ÄÇ * * @param key * @param member * @return Â¶ÇÊûúmemberÊòØÊúâÂ∫èÈõÜkeyÁöÑÊàêÂëòÔºåËøîÂõûmemberÁöÑÊéíÂêçÁöÑÊï¥Êï∞„ÄÇ Â¶ÇÊûúmember‰∏çÊòØÊúâÂ∫èÈõÜkeyÁöÑÊàêÂëòÔºåËøîÂõû nil„ÄÇ */ Long zrank(String key, String member); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÊàêÂëòmemberÁöÑÊéíÂêçÔºåÂÖ∂‰∏≠ÊúâÂ∫èÈõÜÊàêÂëòÊåâscoreÂÄº‰ªéÂ§ßÂà∞Â∞èÊéíÂàó„ÄÇÊéíÂêç‰ª•0‰∏∫Â∫ïÔºå‰πüÂ∞±ÊòØËØ¥ÔºåscoreÂÄºÊúÄÂ§ßÁöÑÊàêÂëòÊéíÂêç‰∏∫0„ÄÇ * * ‰ΩøÁî®ZRANKÂëΩ‰ª§ÂèØ‰ª•Ëé∑ÂæóÊàêÂëòÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ∞èÂà∞Â§ß)ÊéíÂàóÁöÑÊéíÂêç„ÄÇ * * @param key * @param member * @return Â¶ÇÊûúmemberÊòØÊúâÂ∫èÈõÜkeyÁöÑÊàêÂëòÔºåËøîÂõûmemberÁöÑÊéíÂêç„ÄÇÊï¥ÂûãÊï∞Â≠ó„ÄÇ Â¶ÇÊûúmember‰∏çÊòØÊúâÂ∫èÈõÜkeyÁöÑÊàêÂëòÔºåËøîÂõûBulk * reply: nil. */ Long zrevrank(String key, String member); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëò„ÄÇÂÖ∂‰∏≠ÊàêÂëòÁöÑ‰ΩçÁΩÆÊåâscoreÂÄºÈÄíÂáè(‰ªéÂ§ßÂà∞Â∞è)Êù•ÊéíÂàó„ÄÇÂÖ∑ÊúâÁõ∏ÂêåscoreÂÄºÁöÑÊàêÂëòÊåâÂ≠óÂÖ∏Â∫èÁöÑÂèçÂ∫èÊéíÂàó„ÄÇ * Èô§‰∫ÜÊàêÂëòÊåâscoreÂÄºÈÄíÂáèÁöÑÊ¨°Â∫èÊéíÂàóËøô‰∏ÄÁÇπÂ§ñÔºåZREVRANGEÂëΩ‰ª§ÁöÑÂÖ∂‰ªñÊñπÈù¢ÂíåZRANGEÂëΩ‰ª§‰∏ÄÊ†∑„ÄÇ * * @param key * @param start * @param end * @return ÊåáÂÆöËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°®(ÂèØÈÄâÊòØÂê¶Âê´ÊúâÂàÜÊï∞)„ÄÇ */ Set&lt;String&gt; zrevrange(String key, long start, long end); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëò„ÄÇÂÖ∂‰∏≠ÊàêÂëòÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ∞èÂà∞Â§ß)Êù•ÊéíÂ∫è„ÄÇÂÖ∑ÊúâÁõ∏ÂêåscoreÂÄºÁöÑÊàêÂëòÊåâÂ≠óÂÖ∏Â∫èÊù•ÊéíÂàó„ÄÇ * * Â¶ÇÊûú‰Ω†ÈúÄË¶ÅÊàêÂëòÊåâscoreÂÄºÈÄíÂáè(scoreÁõ∏Á≠âÊó∂ÊåâÂ≠óÂÖ∏Â∫èÈÄíÂáè)Êù•ÊéíÂàóÔºåËØ∑‰ΩøÁî®ZREVRANGEÂëΩ‰ª§„ÄÇ * ‰∏ãÊ†áÂèÇÊï∞startÂíåstopÈÉΩ‰ª•0‰∏∫Â∫ïÔºå‰πüÂ∞±ÊòØËØ¥Ôºå‰ª•0Ë°®Á§∫ÊúâÂ∫èÈõÜÁ¨¨‰∏Ä‰∏™ÊàêÂëòÔºå‰ª•1Ë°®Á§∫ÊúâÂ∫èÈõÜÁ¨¨‰∫å‰∏™ÊàêÂëòÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * ‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®Ë¥üÊï∞‰∏ãÊ†áÔºå‰ª•-1Ë°®Á§∫ÊúÄÂêé‰∏Ä‰∏™ÊàêÂëòÔºå-2Ë°®Á§∫ÂÄíÊï∞Á¨¨‰∫å‰∏™ÊàêÂëòÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇ * * Ë∂ÖÂá∫ËåÉÂõ¥ÁöÑ‰∏ãÊ†áÂπ∂‰∏ç‰ºöÂºïËµ∑ÈîôËØØ„ÄÇÂ¶ÇÊûústartÁöÑÂÄºÊØîÊúâÂ∫èÈõÜÁöÑÊúÄÂ§ß‰∏ãÊ†áËøòË¶ÅÂ§ßÔºåÊàñÊòØstart &gt; * stopÊó∂ÔºåZRANGEÂëΩ‰ª§Âè™ÊòØÁÆÄÂçïÂú∞ËøîÂõû‰∏Ä‰∏™Á©∫ÂàóË°®„ÄÇ * Âè¶‰∏ÄÊñπÈù¢ÔºåÂÅáÂ¶ÇstopÂèÇÊï∞ÁöÑÂÄºÊØîÊúâÂ∫èÈõÜÁöÑÊúÄÂ§ß‰∏ãÊ†áËøòË¶ÅÂ§ßÔºåÈÇ£‰πàRedisÂ∞ÜstopÂΩì‰ΩúÊúÄÂ§ß‰∏ãÊ†áÊù•Â§ÑÁêÜ„ÄÇ * * ‰ΩøÁî®WITHSCORESÈÄâÈ°πÔºåÊù•ËÆ©ÊàêÂëòÂíåÂÆÉÁöÑscoreÂÄº‰∏ÄÂπ∂ËøîÂõûÔºåËøîÂõûÂàóË°®‰ª•value1,score1, ..., * valueN,scoreNÁöÑÊ†ºÂºèË°®Á§∫ÔºåËÄå‰∏çÊòØvalue1,...,valueN„ÄÇÂÆ¢Êà∑Á´ØÂ∫ìÂèØËÉΩ‰ºöËøîÂõû‰∏Ä‰∫õÊõ¥Â§çÊùÇÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåÊØîÂ¶ÇÊï∞ÁªÑ„ÄÅÂÖÉÁªÑÁ≠â„ÄÇ * * @param key * @param start * @param end * @return ÊåáÂÆöËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°®(‰ª•ÂÖÉÁªÑÈõÜÂêàÁöÑÂΩ¢Âºè)„ÄÇ */ Set&lt;Tuple&gt; zrangeWithScores(String key, long start, long end); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëò„ÄÇÂÖ∂‰∏≠ÊàêÂëòÁöÑ‰ΩçÁΩÆÊåâscoreÂÄºÈÄíÂáè(‰ªéÂ§ßÂà∞Â∞è)Êù•ÊéíÂàó„ÄÇÂÖ∑ÊúâÁõ∏ÂêåscoreÂÄºÁöÑÊàêÂëòÊåâÂ≠óÂÖ∏Â∫èÁöÑÂèçÂ∫èÊéíÂàó„ÄÇ * Èô§‰∫ÜÊàêÂëòÊåâscoreÂÄºÈÄíÂáèÁöÑÊ¨°Â∫èÊéíÂàóËøô‰∏ÄÁÇπÂ§ñÔºåZREVRANGEÂëΩ‰ª§ÁöÑÂÖ∂‰ªñÊñπÈù¢ÂíåZRANGEÂëΩ‰ª§‰∏ÄÊ†∑„ÄÇ * * @param key * @param start * @param end * @return ÊåáÂÆöËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°®(ÂèØÈÄâÊòØÂê¶Âê´ÊúâÂàÜÊï∞)„ÄÇ */ Set&lt;Tuple&gt; zrevrangeWithScores(String key, long start, long end); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂÖÉÁ¥†‰∏™Êï∞„ÄÇ * * @param key * @return keyÂ≠òÂú®ÁöÑÊó∂ÂÄôÔºåËøîÂõûÊúâÂ∫èÈõÜÁöÑÂÖÉÁ¥†‰∏™Êï∞ÔºåÂê¶ÂàôËøîÂõû0„ÄÇ */ Long zcard(String key); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊàêÂëòmemberÁöÑscoreÂÄº„ÄÇ * * Â¶ÇÊûúmemberÂÖÉÁ¥†‰∏çÊòØÊúâÂ∫èÈõÜkeyÁöÑÊàêÂëòÔºåÊàñkey‰∏çÂ≠òÂú®ÔºåËøîÂõûnil„ÄÇ * * @param key * @param member * @return memberÊàêÂëòÁöÑscoreÂÄºÔºàdoubleÂûãÊµÆÁÇπÊï∞Ôºâ */ Double zscore(String key, String member); /** * ÂØπ‰∏Ä‰∏™ÈõÜÂêàÊàñËÄÖ‰∏Ä‰∏™ÂàóË°®ÊéíÂ∫è * * ÂØπÈõÜÂêàÔºåÊúâÂ∫èÈõÜÂêàÔºåÊàñËÄÖÂàóË°®ÁöÑvalueËøõË°åÊéíÂ∫è„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊéíÂ∫èÂè™ÂØπÊï∞Â≠óÊéíÂ∫èÔºåÂèåÁ≤æÂ∫¶ÊµÆÁÇπÊï∞„ÄÇ * * @see #sort(String, String) * @see #sort(String, SortingParams) * @see #sort(String, SortingParams, String) * @param key * @return ÂÅáËÆæÈõÜÂêàÊàñÂàóË°®ÂåÖÂê´ÁöÑÊòØÊï∞Â≠óÂÖÉÁ¥†ÔºåÈÇ£‰πàËøîÂõûÁöÑÂ∞Ü‰ºöÊòØ‰ªéÂ∞èÂà∞Â§ßÊéíÂàóÁöÑ‰∏Ä‰∏™ÂàóË°®„ÄÇ */ List&lt;String&gt; sort(String key); /** * Ê†πÊçÆÊåáÂÆöÂèÇÊï∞Êù•ÂØπÂàóË°®ÊàñÈõÜÂêàËøõË°åÊéíÂ∫è. * &lt;p&gt; * &lt;b&gt;examples:&lt;/b&gt; * &lt;p&gt; * ‰∏Ä‰∏ãÊòØ‰∏Ä‰∫õ‰æãÂ≠êÂàóË°®ÊàñËÄÖkey-value: * * &lt;pre&gt; * x = [1, 2, 3] * y = [a, b, c] * * k1 = z * k2 = y * k3 = x * * w1 = 9 * w2 = 8 * w3 = 7 * &lt;/pre&gt; * * ÊéíÂ∫è: * * &lt;pre&gt; * sort(x) or sort(x, sp.asc()) * -&gt; [1, 2, 3] * * sort(x, sp.desc()) * -&gt; [3, 2, 1] * * sort(y) * -&gt; [c, a, b] * * sort(y, sp.alpha()) * -&gt; [a, b, c] * * sort(y, sp.alpha().desc()) * -&gt; [c, b, a] * &lt;/pre&gt; * * Limit (e.g. for Pagination): * * &lt;pre&gt; * sort(x, sp.limit(0, 2)) * -&gt; [1, 2] * * sort(y, sp.alpha().desc().limit(1, 2)) * -&gt; [b, a] * &lt;/pre&gt; * * ‰ΩøÁî®Â§ñÈÉ®ÈîÆÊù•ÊéíÂ∫è: * * &lt;pre&gt; * sort(x, sb.by(w*)) * -&gt; [3, 2, 1] * * sort(x, sb.by(w*).desc()) * -&gt; [1, 2, 3] * &lt;/pre&gt; * * Getting external keys: * * &lt;pre&gt; * sort(x, sp.by(w*).get(k*)) * -&gt; [x, y, z] * * sort(x, sp.by(w*).get(#).get(k*)) * -&gt; [3, x, 2, y, 1, z] * &lt;/pre&gt; * * @see #sort(String) * @see #sort(String, SortingParams, String) * @param key * @param sortingParameters * @return a list of sorted elements. */ List&lt;String&gt; sort(String key, SortingParams sortingParameters); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåscoreÂÄºÂú®minÂíåmax‰πãÈó¥(ÈªòËÆ§ÂåÖÊã¨scoreÂÄºÁ≠â‰∫éminÊàñmax)ÁöÑÊàêÂëò„ÄÇ * * @param key * @param min * @param max * @return ÊåáÂÆöÂàÜÊï∞ËåÉÂõ¥ÁöÑÂÖÉÁ¥†‰∏™Êï∞„ÄÇ */ Long zcount(String key, double min, double max); /** * ËøîÂõûÊúâÂ∫èÈõÜkey‰∏≠ÔºåscoreÂÄºÂú®minÂíåmax‰πãÈó¥(ÈªòËÆ§ÂåÖÊã¨scoreÂÄºÁ≠â‰∫éminÊàñmax)ÁöÑÊàêÂëò„ÄÇ * * @param key * @param min * @param max * @return ÊåáÂÆöÂàÜÊï∞ËåÉÂõ¥ÁöÑÂÖÉÁ¥†‰∏™Êï∞„ÄÇ */ Long zcount(String key, String min, String max); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó * * @param key * @param min * @param max * @return ÊåáÂÆöÂàÜÊï∞ËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°® */ Set&lt;String&gt; zrangeByScore(String key, double min, double max); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó * * @param key * @param min * @param max * @return ÊåáÂÆöÂàÜÊï∞ËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°® */ Set&lt;String&gt; zrangeByScore(String key, String min, String max); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó, ÊåáÂÆöËøîÂõûÁªìÊûúÁöÑÊï∞ÈáèÂèäÂå∫Èó¥„ÄÇ * * @param key * @param min * @param max * @param offset * @param count * @return ÊåáÂÆöÂàÜÊï∞ËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°® */ Set&lt;String&gt; zrangeByScore(String key, double min, double max, int offset, int count); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó, ÊåáÂÆöËøîÂõûÁªìÊûúÁöÑÊï∞ÈáèÂèäÂå∫Èó¥„ÄÇ * * @param key * @param min * @param max * @param offset * @param count * @return ÊåáÂÆöÂàÜÊï∞ËåÉÂõ¥ÁöÑÂÖÉÁ¥†ÂàóË°® */ Set&lt;String&gt; zrangeByScore(String key, String min, String max, int offset, int count); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó„ÄÇËøîÂõûÂÖÉÁ¥†ÂíåÂÖ∂ÂàÜÊï∞ÔºåËÄå‰∏çÂè™ÊòØÂÖÉÁ¥†„ÄÇ * * @param key * @param min * @param max * @return */ Set&lt;Tuple&gt; zrangeByScoreWithScores(String key, double min, double max); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó, ÊåáÂÆöËøîÂõûÁªìÊûúÁöÑÊï∞ÈáèÂèäÂå∫Èó¥„ÄÇ ËøîÂõûÂÖÉÁ¥†ÂíåÂÖ∂ÂàÜÊï∞ÔºåËÄå‰∏çÂè™ÊòØÂÖÉÁ¥†„ÄÇ * * @param key * @param min * @param max * @param offset * @param count * @return */ Set&lt;Tuple&gt; zrangeByScoreWithScores(String key, double min, double max, int offset, int count); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó„ÄÇËøîÂõûÂÖÉÁ¥†ÂíåÂÖ∂ÂàÜÊï∞ÔºåËÄå‰∏çÂè™ÊòØÂÖÉÁ¥†„ÄÇ * * @param key * @param min * @param max * @return */ Set&lt;Tuple&gt; zrangeByScoreWithScores(String key, String min, String max); /** * ËøîÂõûkeyÁöÑÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÊâÄÊúâÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂàÜÊï∞Á≠â‰∫émaxÊàñËÄÖminÁöÑÂÖÉÁ¥†Ôºâ„ÄÇÂÖÉÁ¥†Ë¢´ËÆ§‰∏∫ÊòØ‰ªé‰ΩéÂàÜÂà∞È´òÂàÜÊéíÂ∫èÁöÑ„ÄÇ * ÂÖ∑ÊúâÁõ∏ÂêåÂàÜÊï∞ÁöÑÂÖÉÁ¥†ÊåâÂ≠óÂÖ∏Â∫èÊéíÂàó, ÊåáÂÆöËøîÂõûÁªìÊûúÁöÑÊï∞ÈáèÂèäÂå∫Èó¥„ÄÇ ËøîÂõûÂÖÉÁ¥†ÂíåÂÖ∂ÂàÜÊï∞ÔºåËÄå‰∏çÂè™ÊòØÂÖÉÁ¥†„ÄÇ * * @param key * @param min * @param max * @param offset * @param count * @return */ Set&lt;Tuple&gt; zrangeByScoreWithScores(String key, String min, String max, int offset, int count); /** * Êú∫Âà∂‰∏ézrangeByScore‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @return */ Set&lt;String&gt; zrevrangeByScore(String key, double max, double min); /** * Êú∫Âà∂‰∏ézrangeByScore‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @return */ Set&lt;String&gt; zrevrangeByScore(String key, String max, String min); /** * Êú∫Âà∂‰∏ézrangeByScore‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @param offset * @param count * @return */ Set&lt;String&gt; zrevrangeByScore(String key, double max, double min, int offset, int count); /** * Êú∫Âà∂‰∏ézrangeByScoreWithScores‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @return */ Set&lt;Tuple&gt; zrevrangeByScoreWithScores(String key, double max, double min); /** * Êú∫Âà∂‰∏ézrangeByScore‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @param offset * @param count * @return */ Set&lt;String&gt; zrevrangeByScore(String key, String max, String min, int offset, int count); /** * Êú∫Âà∂‰∏ézrangeByScoreWithScores‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @return */ Set&lt;Tuple&gt; zrevrangeByScoreWithScores(String key, String max, String min); /** * Êú∫Âà∂‰∏ézrangeByScoreWithScores‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @param offset * @param count * @return */ Set&lt;Tuple&gt; zrevrangeByScoreWithScores(String key, double max, double min, int offset, int count); /** * Êú∫Âà∂‰∏ézrangeByScoreWithScores‰∏ÄÊ†∑ÔºåÂè™ÊòØËøîÂõûÁªìÊûú‰∏∫ÈôçÂ∫èÊéíÂ∫è„ÄÇ * * @param key * @param max * @param min * @param offset * @param count * @return */ Set&lt;Tuple&gt; zrevrangeByScoreWithScores(String key, String max, String min, int offset, int count); /** * ÁßªÈô§ÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊåáÂÆöÊéíÂêç(rank)Âå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÊàêÂëò„ÄÇ‰∏ãÊ†áÂèÇÊï∞startÂíåstopÈÉΩ‰ª•0‰∏∫Â∫ïÔºå0Â§ÑÊòØÂàÜÊï∞ÊúÄÂ∞èÁöÑÈÇ£‰∏™ÂÖÉÁ¥†„ÄÇËøô‰∫õÁ¥¢Âºï‰πüÂèØÊòØË¥üÊï∞Ôºå * Ë°®Á§∫‰ΩçÁßª‰ªéÊúÄÈ´òÂàÜÂ§ÑÂºÄÂßãÊï∞„ÄÇ‰æãÂ¶ÇÔºå-1ÊòØÂàÜÊï∞ÊúÄÈ´òÁöÑÂÖÉÁ¥†Ôºå-2ÊòØÂàÜÊï∞Á¨¨‰∫åÈ´òÁöÑÔºå‰æùÊ¨°Á±ªÊé®„ÄÇ * * @param key * @param start * @param end * @return Ë¢´ÁßªÈô§ÊàêÂëòÁöÑÊï∞Èáè„ÄÇ */ Long zremrangeByRank(String key, long start, long end); /** * ÁßªÈô§ÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊâÄÊúâscoreÂÄº‰ªã‰∫éminÂíåmax‰πãÈó¥(ÂåÖÊã¨Á≠â‰∫éminÊàñmax)ÁöÑÊàêÂëò„ÄÇ * * Ëá™ÁâàÊú¨2.1.6ÂºÄÂßãÔºåscoreÂÄºÁ≠â‰∫éminÊàñmaxÁöÑÊàêÂëò‰πüÂèØ‰ª•‰∏çÂåÖÊã¨Âú®ÂÜÖÔºåËØ≠Ê≥ïËØ∑ÂèÇËßÅZRANGEBYSCOREÂëΩ‰ª§„ÄÇ * * @param key * @param start * @param end * @return Âà†Èô§ÁöÑÂÖÉÁ¥†ÁöÑ‰∏™Êï∞ */ Long zremrangeByScore(String key, double start, double end); /** * ÁßªÈô§ÊúâÂ∫èÈõÜkey‰∏≠ÔºåÊâÄÊúâscoreÂÄº‰ªã‰∫éminÂíåmax‰πãÈó¥(ÂåÖÊã¨Á≠â‰∫éminÊàñmax)ÁöÑÊàêÂëò„ÄÇ * * Ëá™ÁâàÊú¨2.1.6ÂºÄÂßãÔºåscoreÂÄºÁ≠â‰∫éminÊàñmaxÁöÑÊàêÂëò‰πüÂèØ‰ª•‰∏çÂåÖÊã¨Âú®ÂÜÖÔºåËØ≠Ê≥ïËØ∑ÂèÇËßÅZRANGEBYSCOREÂëΩ‰ª§„ÄÇ * * @param key * @param start * @param end * @return Âà†Èô§ÁöÑÂÖÉÁ¥†ÁöÑ‰∏™Êï∞ */ Long zremrangeByScore(String key, String start, String end); /** * ÂΩìÊèíÂÖ•Âà∞ÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÈÉΩÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂàÜÊï∞Êó∂ÔºåËøô‰∏™ÂëΩ‰ª§ÂèØ‰ª•ËøîÂõûminÂíåmaxÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÂÖÉÁ¥†ÁöÑÊï∞Èáè„ÄÇ * * @param key * @param min * @param max * @return */ Long zlexcount(final String key, final String min, final String max); /** * Êää value ÊèíÂÖ•Â≠ò‰∫é key ÁöÑÂàóË°®‰∏≠Âú®Âü∫ÂáÜÂÄº pivot ÁöÑÂâçÈù¢ÊàñÂêéÈù¢„ÄÇ * * ÂΩì key ‰∏çÂ≠òÂú®Êó∂ÔºåËøô‰∏™list‰ºöË¢´Áúã‰ΩúÊòØÁ©∫listÔºå‰ªª‰ΩïÊìç‰ΩúÈÉΩ‰∏ç‰ºöÂèëÁîü„ÄÇ * * ÂΩì key Â≠òÂú®Ôºå‰ΩÜ‰øùÂ≠òÁöÑ‰∏çÊòØ‰∏Ä‰∏™listÁöÑÊó∂ÂÄôÔºå‰ºöËøîÂõûerror„ÄÇ * * @param key * @param where * @param pivot ÂâçÊàñÂêé * @param value * @return Âú® insert Êìç‰ΩúÂêéÁöÑ list ÈïøÂ∫¶„ÄÇ */ Long linsert(String key, Client.LIST_POSITION where, String pivot, String value); /** * Âè™ÊúâÂΩì key Â∑≤ÁªèÂ≠òÂú®Âπ∂‰∏îÂ≠òÁùÄ‰∏Ä‰∏™ list ÁöÑÊó∂ÂÄôÔºåÂú®Ëøô‰∏™ key ‰∏ãÈù¢ÁöÑ list ÁöÑÂ§¥ÈÉ®ÊèíÂÖ• value„ÄÇ ‰∏é LPUSH Áõ∏ÂèçÔºåÂΩì * key ‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄô‰∏ç‰ºöËøõË°å‰ªª‰ΩïÊìç‰Ωú„ÄÇ * * @param key * @param string * @return Âú® push Êìç‰ΩúÂêéÁöÑ list ÈïøÂ∫¶„ÄÇ */ Long lpushx(String key, String... string); /** * Â∞ÜÂÄº value ÊèíÂÖ•Âà∞ÂàóË°® key ÁöÑË°®Â∞æ, ÂΩì‰∏î‰ªÖÂΩì key Â≠òÂú®Âπ∂‰∏îÊòØ‰∏Ä‰∏™ÂàóË°®„ÄÇ Âíå RPUSH ÂëΩ‰ª§Áõ∏Âèç, ÂΩì key * ‰∏çÂ≠òÂú®Êó∂ÔºåRPUSHX ÂëΩ‰ª§‰ªÄ‰πà‰πü‰∏çÂÅö„ÄÇ * * @param key * @param string * @return Âú®PushÊìç‰ΩúÂêéListÁöÑÈïøÂ∫¶ */ Long rpushx(String key, String... string); /** * @deprecated unusable command, this will be removed in 3.0.0. */ @Deprecated List&lt;String&gt; blpop(String arg); /** * BLPOP ÊòØÈòªÂ°ûÂºèÂàóË°®ÁöÑÂºπÂá∫ÂéüËØ≠„ÄÇ ÂÆÉÊòØÂëΩ‰ª§ LPOP ÁöÑÈòªÂ°ûÁâàÊú¨ÔºåËøôÊòØÂõ†‰∏∫ÂΩìÁªôÂÆöÂàóË°®ÂÜÖÊ≤°Êúâ‰ªª‰ΩïÂÖÉÁ¥†ÂèØ‰æõÂºπÂá∫ÁöÑÊó∂ÂÄôÔºå ËøûÊé•Â∞ÜË¢´ BLPOP * ÂëΩ‰ª§ÈòªÂ°û„ÄÇ ÂΩìÁªôÂÆöÂ§ö‰∏™ key ÂèÇÊï∞Êó∂ÔºåÊåâÂèÇÊï∞ key ÁöÑÂÖàÂêéÈ°∫Â∫è‰æùÊ¨°Ê£ÄÊü•ÂêÑ‰∏™ÂàóË°®ÔºåÂºπÂá∫Á¨¨‰∏Ä‰∏™ÈùûÁ©∫ÂàóË°®ÁöÑÂ§¥ÂÖÉÁ¥†„ÄÇ &#123;@link http * ://www.redis.cn/commands/blpop.html&#125; * * @param timeout * @param key * @return */ List&lt;String&gt; blpop(int timeout, String key); /** * @deprecated unusable command, this will be removed in 3.0.0. */ @Deprecated List&lt;String&gt; brpop(String arg); /** * BRPOP ÊòØ‰∏Ä‰∏™ÈòªÂ°ûÁöÑÂàóË°®ÂºπÂá∫ÂéüËØ≠„ÄÇ ÂÆÉÊòØ RPOP ÁöÑÈòªÂ°ûÁâàÊú¨ÔºåÂõ†‰∏∫Ëøô‰∏™ÂëΩ‰ª§‰ºöÂú®ÁªôÂÆölistÊó†Ê≥ïÂºπÂá∫‰ªª‰ΩïÂÖÉÁ¥†ÁöÑÊó∂ÂÄôÈòªÂ°ûËøûÊé•„ÄÇ * ËØ•ÂëΩ‰ª§‰ºöÊåâÁÖßÁªôÂá∫ÁöÑ key È°∫Â∫èÊü•Áúã listÔºåÂπ∂Âú®ÊâæÂà∞ÁöÑÁ¨¨‰∏Ä‰∏™ÈùûÁ©∫ list ÁöÑÂ∞æÈÉ®ÂºπÂá∫‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÇ * * ËØ∑Âú® BLPOP ÊñáÊ°£ ‰∏≠Êü•ÁúãËØ•ÂëΩ‰ª§ÁöÑÂáÜÁ°ÆËØ≠‰πâÔºåÂõ†‰∏∫ BRPOP Âíå BLPOP * Âü∫Êú¨ÊòØÂÆåÂÖ®‰∏ÄÊ†∑ÁöÑÔºåÈô§‰∫ÜÂÆÉ‰ª¨‰∏Ä‰∏™ÊòØ‰ªéÂ∞æÈÉ®ÂºπÂá∫ÂÖÉÁ¥†ÔºåËÄåÂè¶‰∏Ä‰∏™ÊòØ‰ªéÂ§¥ÈÉ®ÂºπÂá∫ÂÖÉÁ¥†„ÄÇ &#123;@link http * ://www.redis.cn/commands/brpop.html&#125; * * * @param timeout * @param key * @return */ List&lt;String&gt; brpop(int timeout, String key); /** * Âà†Èô§‰∏Ä‰∏™Key,Â¶ÇÊûúÂà†Èô§ÁöÑkey‰∏çÂ≠òÂú®ÔºåÂàôÁõ¥Êé•ÂøΩÁï•„ÄÇ * * @param key * @return Ë¢´Âà†Èô§ÁöÑkeysÁöÑÊï∞Èáè */ Long del(String key); /** * ÂõûÊòæ * * @param string * @return ÂõûÊòæËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ */ String echo(String string); /** * Â∞ÜÂΩìÂâçÊï∞ÊçÆÂ∫ìÁöÑ key ÁßªÂä®Âà∞ÁªôÂÆöÁöÑÊï∞ÊçÆÂ∫ì db ÂΩì‰∏≠„ÄÇ * * Â¶ÇÊûúÂΩìÂâçÊï∞ÊçÆÂ∫ì(Ê∫êÊï∞ÊçÆÂ∫ì)ÂíåÁªôÂÆöÊï∞ÊçÆÂ∫ì(ÁõÆÊ†áÊï∞ÊçÆÂ∫ì)ÊúâÁõ∏ÂêåÂêçÂ≠óÁöÑÁªôÂÆö key ÔºåÊàñËÄÖ key ‰∏çÂ≠òÂú®‰∫éÂΩìÂâçÊï∞ÊçÆÂ∫ìÔºåÈÇ£‰πà MOVE Ê≤°Êúâ‰ªª‰ΩïÊïàÊûú„ÄÇ * * Âõ†Ê≠§Ôºå‰πüÂèØ‰ª•Âà©Áî®Ëøô‰∏ÄÁâπÊÄßÔºåÂ∞Ü MOVE ÂΩì‰ΩúÈîÅ(locking)ÂéüËØ≠(primitive)„ÄÇ * * @param key * @param dbIndex * @return ÁßªÂä®ÊàêÂäüËøîÂõû 1 Â§±Ë¥•ÂàôËøîÂõû 0 */ Long move(String key, int dbIndex); /** * ÁªüËÆ°Â≠óÁ¨¶‰∏≤ÁöÑÂ≠óËäÇÊï∞ * * @param key * @return Â≠óËäÇÊï∞ */ Long bitcount(final String key); /** * ÁªüËÆ°Â≠óÁ¨¶‰∏≤ÊåáÂÆöËµ∑Âßã‰ΩçÁΩÆÁöÑÂ≠óËäÇÊï∞ * * @param key * @param start * @param end * @return */ Long bitcount(final String key, long start, long end); /** * Ëø≠‰ª£hashÈáåÈù¢ÁöÑÂÖÉÁ¥† * * @param key * @param cursor * @return */ ScanResult&lt;Map.Entry&lt;String, String&gt;&gt; hscan(final String key, final String cursor); /** * Ëø≠‰ª£setÈáåÈù¢ÁöÑÂÖÉÁ¥† * * @param key * @param cursor * @return */ ScanResult&lt;String&gt; sscan(final String key, final String cursor); /** * Ëø≠‰ª£zsetÈáåÈù¢ÁöÑÂÖÉÁ¥† * * @param key * @param cursor * @return */ ScanResult&lt;Tuple&gt; zscan(final String key, final String cursor);&#125;]]></content>
      <categories>
        <category>ÁºìÂ≠ò</category>
        <category>redis</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic-jobÁöÑÂéüÁêÜÁÆÄ‰ªãÂíå‰ΩøÁî®]]></title>
    <url>%2F2017%2F11%2F12%2Felastic-job%E7%9A%84%E5%8E%9F%E7%90%86%E7%AE%80%E4%BB%8B%E5%92%8C%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[elastic-jobÊòØÂΩìÂΩìÂºÄÊ∫êÁöÑ‰∏ÄÊ¨æÈùûÂ∏∏Â•ΩÁî®ÁöÑ‰Ωú‰∏öÊ°ÜÊû∂ÔºåÂú®Ëøô‰πãÂâçÔºåÊàë‰ª¨ÂºÄÂèëÂÆöÊó∂‰ªªÂä°‰∏ÄËà¨ÈÉΩÊòØ‰ΩøÁî®quartzÊàñËÄÖspring-taskÔºàScheduledExecutorServiceÔºâÔºåÊó†ËÆ∫ÊòØ‰ΩøÁî®quartzËøòÊòØspring-taskÔºåÊàë‰ª¨ÈÉΩ‰ºöËá≥Â∞ëÈÅáÂà∞‰∏§‰∏™ÁóõÁÇπÔºö 1.‰∏çÊï¢ËΩªÊòìË∑üÁùÄÂ∫îÁî®ÊúçÂä°Â§öËäÇÁÇπÈÉ®ÁΩ≤ÔºåÂèØËÉΩ‰ºöÈáçÂ§çÂ§öÊ¨°ÊâßË°åËÄåÂºïÂèëÁ≥ªÁªüÈÄªËæëÁöÑÈîôËØØ„ÄÇ 2.quartzÁöÑÈõÜÁæ§‰ªÖ‰ªÖÂè™ÊòØÁî®Êù•HAÔºåËäÇÁÇπÊï∞ÈáèÁöÑÂ¢ûÂä†Âπ∂‰∏çËÉΩÁªôÊàë‰ª¨ÁöÑÊØèÊ¨°ÊâßË°åÊïàÁéáÂ∏¶Êù•ÊèêÂçáÔºåÂç≥‰∏çËÉΩÂÆûÁé∞Ê∞¥Âπ≥Êâ©Â±ï„ÄÇ Êú¨ÁØáÂçöÊñáÂ∞Ü‰ºöËá™È°∂Âêë‰∏ãÂú∞‰ªãÁªçelastic-jobÔºåËÆ©Â§ßÂÆ∂ËÆ§ËØÜ‰∫ÜËß£Âπ∂‰∏îÂø´ÈÄüÊê≠Âª∫Ëµ∑ÁéØÂ¢É„ÄÇ elastic-job‰∫ßÂìÅÁ∫øËØ¥Êòéelastic-jobÂú®2.x‰πãÂêéÔºåÂá∫‰∫Ü‰∏§‰∏™‰∫ßÂìÅÁ∫øÔºöElastic-Job-LiteÂíåElastic-Job-Cloud„ÄÇÊàë‰ª¨‰∏ÄËà¨‰ΩøÁî®Elastic-Job-LiteÂ∞±ËÉΩÂ§üÊª°Ë∂≥ÈúÄÊ±ÇÔºåÊú¨Êñá‰πüÊòØ‰ª•Elastic-Job-Lite‰∏∫‰∏ª„ÄÇ1.xÁ≥ªÂàóÂØπÂ∫îÁöÑÂ∞±Âè™ÊúâElastic-Job-LiteÔºåÂπ∂‰∏îÂú®2.xÈáå‰øÆÊîπ‰∫Ü‰∏Ä‰∫õÊ†∏ÂøÉÁ±ªÂêçÔºåÂ∑ÆÂà´ËôΩÂ§ßÔºåÂéüÁêÜÁ±ª‰ººÔºåÂª∫ËÆÆ‰ΩøÁî®2.xÁ≥ªÂàó„ÄÇÂÜôÊ≠§ÂçöÊñáÔºåÊúÄÊñ∞releaseÁâàÊú¨‰∏∫2.0.5„ÄÇ elastic-job-liteÂéüÁêÜ‰∏æ‰∏™ÂÖ∏ÂûãÁöÑjobÂú∫ÊôØÔºåÊØîÂ¶Ç‰ΩôÈ¢ùÂÆùÈáåÁöÑÊò®Êó•Êî∂ÁõäÔºåÁ≥ªÁªüÈúÄË¶ÅjobÂú®ÊØèÂ§©Êüê‰∏™Êó∂Èó¥ÁÇπÂºÄÂßãÔºåÁªôÊâÄÊúâ‰ΩôÈ¢ùÂÆùÁî®Êà∑ËÆ°ÁÆóÊî∂Áõä„ÄÇÂ¶ÇÊûúÁî®Êà∑Êï∞Èáè‰∏çÂ§öÔºåÊàë‰ª¨ÂèØ‰ª•ËΩªÊòì‰ΩøÁî®quartzÊù•ÂÆåÊàêÔºåÊàë‰ª¨ËÆ©ËÆ°ÊÅØjobÂú®Êüê‰∏™Êó∂Èó¥ÁÇπÂºÄÂßãÊâßË°åÔºåÂæ™ÁéØÈÅçÂéÜÊâÄÊúâÁî®Êà∑ËÆ°ÁÆóÂà©ÊÅØÔºåËøôÊ≤°ÈóÆÈ¢ò„ÄÇÂèØÊòØÔºåÂ¶ÇÊûúÁî®Êà∑‰ΩìÈáèÁâπÂà´Â§ßÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÈù¢‰∏¥ÁùÄÂú®Á¨¨‰∫åÂ§©‰πãÂâçÂ§ÑÁêÜ‰∏çÂÆåËøô‰πàÂ§öÁî®Êà∑„ÄÇÂè¶Â§ñÔºåÊàë‰ª¨ÈÉ®ÁΩ≤jobÁöÑÊó∂ÂÄô‰πüÂæóÊ≥®ÊÑèÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÊääjobÁõ¥Êé•ÊîæÂú®Êàë‰ª¨ÁöÑwebappÈáåÔºåwebappÈÄöÂ∏∏ÊòØÂ§öËäÇÁÇπÈÉ®ÁΩ≤ÁöÑÔºåËøôÊ†∑ÔºåÊàë‰ª¨ÁöÑjob‰πüÂ∞±ÊòØÂ§öËäÇÁÇπÔºåÂ§ö‰∏™jobÂêåÊó∂ÊâßË°åÔºåÂæàÂÆπÊòìÈÄ†ÊàêÈáçÂ§çÊâßË°åÔºåÊØîÂ¶ÇÁî®Êà∑ÈáçÂ§çËÆ°ÊÅØÔºå‰∏∫‰∫ÜÈÅøÂÖçËøôÁßçÊÉÖÂÜµÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÂØπjobÁöÑÊâßË°åÂä†ÈîÅÔºå‰øùËØÅÂßãÁªàÂè™Êúâ‰∏Ä‰∏™ËäÇÁÇπËÉΩÊâßË°åÔºåÊàñËÄÖÂπ≤ËÑÜËÆ©job‰ªéwebappÈáåÂâ•Á¶ªÂá∫Êù•ÔºåÁã¨Ëá™ÈÉ®ÁΩ≤‰∏Ä‰∏™ËäÇÁÇπ„ÄÇelastic-jobÂ∞±ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Ëß£ÂÜ≥‰∏äÈù¢ÁöÑÈóÆÈ¢òÔºåelasticÂ∫ïÂ±ÇÁöÑ‰ªªÂä°Ë∞ÉÂ∫¶ËøòÊòØ‰ΩøÁî®ÁöÑquartzÔºåÈÄöËøázookeeperÊù•Âä®ÊÄÅÁªôjobËäÇÁÇπÂàÜÁâá„ÄÇÊàë‰ª¨Êù•ÁúãÔºöÂæàÂ§ß‰ΩìÈáèÁöÑÁî®Êà∑ÈúÄË¶ÅÂú®ÁâπÂÆöÁöÑÊó∂Èó¥ÊÆµÂÜÖËÆ°ÊÅØÂÆåÊàêÊàë‰ª¨ËÇØÂÆöÊòØÂ∏åÊúõÊàë‰ª¨ÁöÑ‰ªªÂä°ÂèØ‰ª•ÈÄöËøáÈõÜÁæ§ËææÂà∞Ê∞¥Âπ≥Êâ©Â±ïÔºåÈõÜÁæ§ÈáåÁöÑÊØè‰∏™ËäÇÁÇπÈÉΩÂ§ÑÁêÜÈÉ®ÂàÜÁî®Êà∑Ôºå‰∏çÁÆ°Áî®Êà∑Êï∞ÈáèÊúâÂ§öÂ∫ûÂ§ßÔºåÊàë‰ª¨Âè™Ë¶ÅÂ¢ûÂä†Êú∫Âô®Â∞±ÂèØ‰ª•‰∫ÜÔºåÊØîÂ¶ÇÂçïÂè∞Êú∫Âô®ÁâπÂÆöÊó∂Èó¥ËÉΩÂ§ÑÁêÜn‰∏™Áî®Êà∑Ôºå2Âè∞Êú∫Âô®Â§ÑÁêÜ2n‰∏™Áî®Êà∑Ôºå3Âè∞3nÔºå4Âè∞4n‚Ä¶ÔºåÂÜçÂ§öÁöÑÁî®Êà∑‰πü‰∏çÊÄï‰∫Ü„ÄÇ‰ΩøÁî®elastic-jobÂºÄÂèëÁöÑ‰Ωú‰∏öÈÉΩÊòØzookeeperÁöÑÂÆ¢Êà∑Á´ØÔºåÊØîÂ¶ÇÊàëÂ∏åÊúõ3Âè∞Êú∫Âô®Ë∑ëjobÔºåÊàë‰ª¨Â∞Ü‰ªªÂä°ÂàÜÊàê3ÁâáÔºåÊ°ÜÊû∂ÈÄöËøázkÁöÑÂçèË∞ÉÔºåÊúÄÁªà‰ºöËÆ©3Âè∞Êú∫Âô®ÂàÜÂà´ÂàÜÈÖçÂà∞0,1,2ÁöÑ‰ªªÂä°ÁâáÔºåÊØîÂ¶Çserver0‚Äì&gt;0Ôºåserver1‚Äì&gt;1Ôºåserver2‚Äì&gt;2ÔºåÂΩìserver0ÊâßË°åÊó∂ÔºåÂèØ‰ª•Âè™Êü•ËØ¢id%3==0ÁöÑÁî®Êà∑Ôºåserver1ÊâßË°åÊó∂ÔºåÂè™Êü•ËØ¢id%3==1ÁöÑÁî®Êà∑Ôºåserver2ÊâßË°åÊó∂ÔºåÂè™Êü•ËØ¢id%3==2ÁöÑÁî®Êà∑„ÄÇ‰ªªÂä°ÈÉ®ÁΩ≤Â§öËäÇÁÇπÂºïÂèëÈáçÂ§çÊâßË°åÂú®‰∏äÈù¢ÁöÑÂü∫Á°Ä‰∏äÔºåÊàë‰ª¨ÂÜçÂ¢ûÂä†server3ÔºåÊ≠§Êó∂Ôºåserver3ÂàÜ‰∏çÂà∞‰ªªÂä°ÂàÜÁâáÔºåÂõ†‰∏∫Âè™Êúâ3ÁâáÔºåÂ∑≤ÁªèÂàÜÂÆå‰∫Ü„ÄÇÊ≤°ÊúâÂàÜÂà∞‰ªªÂä°ÂàÜÁâáÁöÑ‰Ωú‰∏öÁ®ãÂ∫èÂ∞Ü‰∏çÊâßË°å„ÄÇÂ¶ÇÊûúÊ≠§Êó∂server2ÊåÇ‰∫ÜÔºåÈÇ£‰πàserver2ÁöÑÂàÜÁâáÈ°π‰ºöÂàÜÈÖçÁªôserver3Ôºåserver3Êúâ‰∫ÜÂàÜÁâáÔºåÂ∞±‰ºöÊõø‰ª£server2ÊâßË°å„ÄÇÂ¶ÇÊûúÊ≠§Êó∂server3‰πüÊåÇ‰∫ÜÔºåÂè™Ââ©‰∏ãserver0Âíåserver1‰∫ÜÔºåÊ°ÜÊû∂‰πü‰ºöËá™Âä®Êääserver3ÁöÑÂàÜÁâáÈöèÊú∫ÂàÜÈÖçÁªôserver0ÊàñËÄÖserver1ÔºåÂèØËÉΩ‰ºöËøôÊ†∑Ôºåserver0‚Äì&gt;0Ôºåserver1‚Äì&gt;1,2„ÄÇËøôÁßçÁâπÊÄßÁß∞‰πã‰∏∫ÂºπÊÄßÊâ©ÂÆπÔºåÂç≥elastic-jobÂêçÁß∞ÁöÑÁî±Êù•„ÄÇ ‰ª£Á†ÅÊºîÁ§∫Êàë‰ª¨Êê≠Âª∫ÁéØÂ¢ÉÈÄöËøáÁ§∫‰æã‰ª£Á†ÅÊù•ÊºîÁ§∫‰∏äÈù¢ÁöÑ‰æãÂ≠êÔºåelastic-jobÊòØ‰∏çÊîØÊåÅÂçïÊú∫Â§öÂÆû‰æãÁöÑÔºåÈÄöËøázkÁöÑÂçèË∞ÉÂàÜÁâáÊòØ‰ª•ip‰∏∫ÂçïÂÖÉÁöÑ„ÄÇÂæàÂ§öÂêåÂ≠¶‰∏äÊù•ÂèØËÉΩÂ∞±ÊòØÈÄöËøáÂçïÊú∫Â§öÂÆû‰æãÊù•Â≠¶‰π†ÔºåÁªìÊûúÂØºËá¥ÂàÜÁâáÂíåÈ¢ÑÊúü‰∏ç‰∏ÄËá¥„ÄÇËøôÈáåÊ≤°ÂäûÊ≥ïÔºåÂè™ËÉΩÈÄöËøáÂ§öÊú∫Âô®ÊàñËÄÖËôöÊãüÊú∫ÔºåÊàë‰ª¨ËøôÈáå‰ΩøÁî®ËôöÊãüÊú∫ÔºåÂè¶Â§ñÔºåÁî±‰∫éËµÑÊ∫êÊúâÈôêÔºåÊàë‰ª¨ËøôÈáå‰ªÖ‰ªÖÂè™Ê®°Êãü‰∏§Âè∞Êú∫Âô®„ÄÇ ËäÇÁÇπËØ¥ÊòéÔºöÊú¨Âú∞ÂÆø‰∏ªÊú∫Âô®zookeeper„ÄÅjob192.168.241.1ËôöÊãüÊú∫job192.168.241.128ÁéØÂ¢ÉËØ¥ÊòéÔºöJavaËØ∑‰ΩøÁî®JDK1.7ÂèäÂÖ∂‰ª•‰∏äÁâàÊú¨„ÄÇZookeeperËØ∑‰ΩøÁî®Zookeeper3.4.6ÂèäÂÖ∂‰ª•‰∏äÁâàÊú¨Elastic-Job-Lite2.0.5Ôºà2.xÁ≥ªÂàóÂç≥ÂèØÔºåÊúÄÂ•ΩÊòØ2.0.4ÂèäÂÖ∂‰ª•‰∏äÔºâÈúÄÊ±ÇËØ¥ÊòéÔºöÈÄöËøá‰∏§Âè∞Êú∫Âô®ÊºîÁ§∫Âä®ÊÄÅÂàÜÁâá step1. ÂºïÂÖ•Ê°ÜÊû∂ÁöÑjarÂåÖ 123456789101112&lt;!-- ÂºïÂÖ•elastic-job-liteÊ†∏ÂøÉÊ®°Âùó --&gt;&lt;dependency&gt; &lt;groupId&gt;com.dangdang&lt;/groupId&gt; &lt;artifactId&gt;elastic-job-lite-core&lt;/artifactId&gt; &lt;version&gt;2.0.5&lt;/version&gt;&lt;/dependency&gt;&lt;!-- ‰ΩøÁî®springframeworkËá™ÂÆö‰πâÂëΩÂêçÁ©∫Èó¥Êó∂ÂºïÂÖ• --&gt;&lt;dependency&gt; &lt;groupId&gt;com.dangdang&lt;/groupId&gt; &lt;artifactId&gt;elastic-job-lite-spring&lt;/artifactId&gt; &lt;version&gt;2.0.5&lt;/version&gt;&lt;/dependency&gt; step2. ÁºñÂÜôjob 123456789101112131415161718192021package com.fanfan.sample001;import com.dangdang.ddframe.job.api.ShardingContext;import com.dangdang.ddframe.job.api.simple.SimpleJob;import java.util.Date;/** * Created by fanfan on 2016/12/20. */public class MySimpleJob implements SimpleJob &#123; @Override public void execute(ShardingContext shardingContext) &#123; System.out.println(String.format("------Thread ID: %s, ‰ªªÂä°ÊÄªÁâáÊï∞: %s, ÂΩìÂâçÂàÜÁâáÈ°π: %s", Thread.currentThread().getId(), shardingContext.getShardingTotalCount(), shardingContext.getShardingItem())); /** * ÂÆûÈôÖÂºÄÂèë‰∏≠ÔºåÊúâ‰∫Ü‰ªªÂä°ÊÄªÁâáÊï∞ÂíåÂΩìÂâçÂàÜÁâáÈ°πÔºåÂ∞±ÂèØ‰ª•ÂØπ‰ªªÂä°ËøõË°åÂàÜÁâáÊâßË°å‰∫Ü * ÊØîÂ¶Ç SELECT * FROM user WHERE status = 0 AND MOD(id, shardingTotalCount) = shardingItem */ &#125;&#125; Step3. SpringÈÖçÁΩÆ 123456789101112131415161718192021&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:reg="http://www.dangdang.com/schema/ddframe/reg" xmlns:job="http://www.dangdang.com/schema/ddframe/job" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.dangdang.com/schema/ddframe/reg http://www.dangdang.com/schema/ddframe/reg/reg.xsd http://www.dangdang.com/schema/ddframe/job http://www.dangdang.com/schema/ddframe/job/job.xsd"&gt; &lt;!--ÈÖçÁΩÆ‰Ωú‰∏öÊ≥®ÂÜå‰∏≠ÂøÉ --&gt; &lt;reg:zookeeper id="regCenter" server-lists="192.168.241.1:2181" namespace="dd-job" base-sleep-time-milliseconds="1000" max-sleep-time-milliseconds="3000" max-retries="3" /&gt; &lt;!-- ÈÖçÁΩÆ‰Ωú‰∏ö--&gt; &lt;job:simple id="mySimpleJob" class="com.fanfan.sample001.MySimpleJob" registry-center-ref="regCenter" sharding-total-count="2" cron="0/2 * * * * ?" overwrite="true" /&gt;&lt;/beans&gt; Case1. ÂçïËäÇÁÇπ Case2. Â¢ûÂä†‰∏Ä‰∏™ËäÇÁÇπ Case3. Êñ≠ÂºÄ‰∏Ä‰∏™ËäÇÁÇπ ‰Ωú‰∏öÁ±ªÂûãelastic-jobÊèê‰æõ‰∫Ü‰∏âÁßçÁ±ªÂûãÁöÑ‰Ωú‰∏öÔºöSimpleÁ±ªÂûã‰Ωú‰∏ö„ÄÅDataflowÁ±ªÂûã‰Ωú‰∏ö„ÄÅScriptÁ±ªÂûã‰Ωú‰∏ö„ÄÇËøôÈáå‰∏ªË¶ÅËÆ≤Ëß£Ââç‰∏§ËÄÖ„ÄÇScriptÁ±ªÂûã‰Ωú‰∏öÊÑè‰∏∫ËÑöÊú¨Á±ªÂûã‰Ωú‰∏öÔºåÊîØÊåÅshellÔºåpythonÔºåperlÁ≠âÊâÄÊúâÁ±ªÂûãËÑöÊú¨Ôºå‰ΩøÁî®‰∏çÂ§öÔºåÂèØ‰ª•ÂèÇËßÅgithubÊñáÊ°£„ÄÇSimpleJobÈúÄË¶ÅÂÆûÁé∞SimpleJobÊé•Âè£ÔºåÊÑè‰∏∫ÁÆÄÂçïÂÆûÁé∞ÔºåÊú™ÁªèËøá‰ªª‰ΩïÂ∞ÅË£ÖÔºå‰∏équartzÂéüÁîüÊé•Âè£Áõ∏‰ººÔºåÊØîÂ¶ÇÁ§∫‰æã‰ª£Á†Å‰∏≠ÊâÄ‰ΩøÁî®ÁöÑjob„ÄÇDataflowÁ±ªÂûãÁî®‰∫éÂ§ÑÁêÜÊï∞ÊçÆÊµÅÔºåÈúÄÂÆûÁé∞DataflowJobÊé•Âè£„ÄÇËØ•Êé•Âè£Êèê‰æõ2‰∏™ÊñπÊ≥ïÂèØ‰æõË¶ÜÁõñÔºåÂàÜÂà´Áî®‰∫éÊäìÂèñ(fetchData)ÂíåÂ§ÑÁêÜ(processData)Êï∞ÊçÆ„ÄÇÂèØÈÄöËøáDataflowJobConfigurationÈÖçÁΩÆÊòØÂê¶ÊµÅÂºèÂ§ÑÁêÜ„ÄÇÊµÅÂºèÂ§ÑÁêÜÊï∞ÊçÆÂè™ÊúâfetchDataÊñπÊ≥ïÁöÑËøîÂõûÂÄº‰∏∫nullÊàñÈõÜÂêàÈïøÂ∫¶‰∏∫Á©∫Êó∂Ôºå‰Ωú‰∏öÊâçÂÅúÊ≠¢ÊäìÂèñÔºåÂê¶Âàô‰Ωú‰∏öÂ∞Ü‰∏ÄÁõ¥ËøêË°å‰∏ãÂéªÔºõ ÈùûÊµÅÂºèÂ§ÑÁêÜÊï∞ÊçÆÂàôÂè™‰ºöÂú®ÊØèÊ¨°‰Ωú‰∏öÊâßË°åËøáÁ®ã‰∏≠ÊâßË°å‰∏ÄÊ¨°fetchDataÊñπÊ≥ïÂíåprocessDataÊñπÊ≥ïÔºåÈöèÂç≥ÂÆåÊàêÊú¨Ê¨°‰Ωú‰∏ö„ÄÇÂÆûÈôÖÂºÄÂèë‰∏≠ÔºåDataflowÁ±ªÂûãÁöÑjobËøòÊòØÂæàÊúâÂ•ΩÁî®ÁöÑ„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839package com.fanfan.sample001;import com.dangdang.ddframe.job.api.ShardingContext;import com.dangdang.ddframe.job.api.dataflow.DataflowJob;import java.util.ArrayList;import java.util.List;/** * Created by fanfan on 2016/12/23. */public class MyDataFlowJob implements DataflowJob&lt;User&gt; &#123; /* status 0ÔºöÂæÖÂ§ÑÁêÜ 1ÔºöÂ∑≤Â§ÑÁêÜ */ @Override public List&lt;User&gt; fetchData(ShardingContext shardingContext) &#123; List&lt;User&gt; users = null; /** * users = SELECT * FROM user WHERE status = 0 AND MOD(id, shardingTotalCount) = shardingItem Limit 0, 30 */ return users; &#125; @Override public void processData(ShardingContext shardingContext, List&lt;User&gt; data) &#123; for (User user: data) &#123; System.out.println(String.format("Áî®Êà∑ %s ÂºÄÂßãËÆ°ÊÅØ", user.getUserId())); user.setStatus(1); /** * update user */ &#125; &#125;&#125; 123&lt;job:dataflow id="myDataFlowJob" class="com.fanfan.sample001.MyDataFlowJob" registry-center-ref="regCenter" sharding-total-count="2" cron="0 0 02 * * ?" streaming-process="true" overwrite="true" /&gt; ÂÖ∂ÂÆÉÂäüËÉΩ‰∏äËø∞‰ªãÁªçÁöÑÊòØÊúÄÁ≤æÁÆÄÂ∏∏Áî®ÁöÑÂäüËÉΩ„ÄÇelastic-jobÁöÑÂäüËÉΩÈõÜËøò‰∏çÊ≠¢Ëøô‰∫õÔºåÊØîÂ¶ÇÂÉè‰Ωú‰∏ö‰∫ã‰ª∂ËøΩË∏™„ÄÅ‰ªªÂä°ÁõëÂê¨Á≠âÔºåÂè¶Â§ñÔºåelastic-job-lite-console‰Ωú‰∏∫‰∏Ä‰∏™Áã¨Á´ãÁöÑËøêÁª¥Âπ≥Âè∞ËøòÊèê‰æõ‰∫ÜÁî®Êù•Êü•ËØ¢ÂíåÊìç‰Ωú‰ªªÂä°ÁöÑwebÈ°µÈù¢„ÄÇËøô‰∫õÂ¢ûÂº∫ÁöÑÂäüËÉΩËØªËÄÖÂèØ‰ª•Âú®github/elastic-job‰∏äËá™Ë°åÂ≠¶‰π†ÔºåÁõ∏‰ø°Êúâ‰∫ÜÊú¨ÁØáÂçöÊñáÁöÑÂü∫Á°ÄÔºåÂÜçÈòÖËØªÈÇ£‰∫õÊñáÊ°£Â∞±ÁâπÂà´ÁÆÄÂçï‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>ÂàÜÂ∏ÉÂºè</category>
      </categories>
      <tags>
        <tag>elastic-job</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[cronËØ¶Ëß£]]></title>
    <url>%2F2017%2F11%2F10%2Fcron%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[CronË°®ËææÂºèÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂ≠óÁ¨¶‰∏≤‰ª•5Êàñ6‰∏™Á©∫Ê†ºÈöîÂºÄÔºåÂàÜ‰∏∫6Êàñ7‰∏™ÂüüÔºåÊØè‰∏Ä‰∏™Âüü‰ª£Ë°®‰∏Ä‰∏™Âê´‰πâÔºåCronÊúâÂ¶Ç‰∏ã‰∏§ÁßçËØ≠Ê≥ïÊ†ºÂºèÔºö Seconds Minutes Hours DayofMonth Month DayofWeek Year Êàñ Seconds Minutes Hours DayofMonth Month DayofWeek ÊØè‰∏Ä‰∏™ÂüüÂèØÂá∫Áé∞ÁöÑÂ≠óÁ¨¶Â¶Ç‰∏ãÔºöSeconds:ÂèØÂá∫Áé∞‚Äù, - /‚ÄúÂõõ‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫0-59ÁöÑÊï¥Êï∞Minutes:ÂèØÂá∫Áé∞‚Äù, - /‚ÄúÂõõ‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫0-59ÁöÑÊï¥Êï∞Hours:ÂèØÂá∫Áé∞‚Äù, - /‚ÄúÂõõ‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫0-23ÁöÑÊï¥Êï∞DayofMonth:ÂèØÂá∫Áé∞‚Äù, - / ? L W C‚ÄùÂÖ´‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫0-31ÁöÑÊï¥Êï∞Month:ÂèØÂá∫Áé∞‚Äù, - /‚ÄúÂõõ‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫1-12ÁöÑÊï¥Êï∞ÊàñJAN-DEcDayofWeek:ÂèØÂá∫Áé∞‚Äù, - / ? L C #‚ÄùÂõõ‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫1-7ÁöÑÊï¥Êï∞ÊàñSUN-SAT‰∏§‰∏™ËåÉÂõ¥„ÄÇ1Ë°®Á§∫ÊòüÊúüÂ§©Ôºå2Ë°®Á§∫ÊòüÊúü‰∏ÄÔºå ‰æùÊ¨°Á±ªÊé®Year:ÂèØÂá∫Áé∞‚Äù, - * /‚ÄúÂõõ‰∏™Â≠óÁ¨¶ÔºåÊúâÊïàËåÉÂõ¥‰∏∫1970-2099Âπ¥ ÊØè‰∏Ä‰∏™ÂüüÈÉΩ‰ΩøÁî®Êï∞Â≠óÔºå‰ΩÜËøòÂèØ‰ª•Âá∫Áé∞Â¶Ç‰∏ãÁâπÊÆäÂ≠óÁ¨¶ÔºåÂÆÉ‰ª¨ÁöÑÂê´‰πâÊòØÔºö(1)ÔºöË°®Á§∫ÂåπÈÖçËØ•ÂüüÁöÑ‰ªªÊÑèÂÄºÔºåÂÅáÂ¶ÇÂú®MinutesÂüü‰ΩøÁî®, Âç≥Ë°®Á§∫ÊØèÂàÜÈíüÈÉΩ‰ºöËß¶Âèë‰∫ã‰ª∂„ÄÇ (2)?:Âè™ËÉΩÁî®Âú®DayofMonthÂíåDayofWeek‰∏§‰∏™Âüü„ÄÇÂÆÉ‰πüÂåπÈÖçÂüüÁöÑ‰ªªÊÑèÂÄºÔºå‰ΩÜÂÆûÈôÖ‰∏ç‰ºö„ÄÇÂõ†‰∏∫DayofMonthÂíå DayofWeek‰ºöÁõ∏‰∫íÂΩ±Âìç„ÄÇ‰æãÂ¶ÇÊÉ≥Âú®ÊØèÊúàÁöÑ20Êó•Ëß¶ÂèëË∞ÉÂ∫¶Ôºå‰∏çÁÆ°20Êó•Âà∞Â∫ïÊòØÊòüÊúüÂá†ÔºåÂàôÂè™ËÉΩ‰ΩøÁî®Â¶Ç‰∏ãÂÜôÊ≥ïÔºö 13 13 15 20 ?, ÂÖ∂‰∏≠ÊúÄÂêé‰∏Ä‰ΩçÂè™ËÉΩÁî®ÔºüÔºåËÄå‰∏çËÉΩ‰ΩøÁî®ÔºåÂ¶ÇÊûú‰ΩøÁî®*Ë°®Á§∫‰∏çÁÆ°ÊòüÊúüÂá†ÈÉΩ‰ºöËß¶ÂèëÔºåÂÆûÈôÖ‰∏äÂπ∂‰∏çÊòØËøôÊ†∑„ÄÇ(3)-:Ë°®Á§∫ËåÉÂõ¥Ôºå‰æãÂ¶ÇÂú®MinutesÂüü‰ΩøÁî®5-20ÔºåË°®Á§∫‰ªé5ÂàÜÂà∞20ÂàÜÈíüÊØèÂàÜÈíüËß¶Âèë‰∏ÄÊ¨°(4)/ÔºöË°®Á§∫Ëµ∑ÂßãÊó∂Èó¥ÂºÄÂßãËß¶ÂèëÔºåÁÑ∂ÂêéÊØèÈöîÂõ∫ÂÆöÊó∂Èó¥Ëß¶Âèë‰∏ÄÊ¨°Ôºå‰æãÂ¶ÇÂú®MinutesÂüü‰ΩøÁî®5/20,ÂàôÊÑèÂë≥ÁùÄ5ÂàÜÈíüËß¶Âèë‰∏ÄÊ¨°ÔºåËÄå25Ôºå45Á≠âÂàÜÂà´Ëß¶Âèë‰∏ÄÊ¨°.(5),:Ë°®Á§∫ÂàóÂá∫Êûö‰∏æÂÄºÂÄº„ÄÇ‰æãÂ¶ÇÔºöÂú®MinutesÂüü‰ΩøÁî®5,20ÔºåÂàôÊÑèÂë≥ÁùÄÂú®5Âíå20ÂàÜÊØèÂàÜÈíüËß¶Âèë‰∏ÄÊ¨°„ÄÇ(6)L:Ë°®Á§∫ÊúÄÂêéÔºåÂè™ËÉΩÂá∫Áé∞Âú®DayofWeekÂíåDayofMonthÂüüÔºåÂ¶ÇÊûúÂú®DayofWeekÂüü‰ΩøÁî®5L,ÊÑèÂë≥ÁùÄÂú®ÊúÄÂêéÁöÑ‰∏Ä‰∏™ÊòüÊúüÂõõËß¶Âèë„ÄÇ(7)W: Ë°®Á§∫ÊúâÊïàÂ∑•‰ΩúÊó•(Âë®‰∏ÄÂà∞Âë®‰∫î),Âè™ËÉΩÂá∫Áé∞Âú®DayofMonthÂüüÔºåÁ≥ªÁªüÂ∞ÜÂú®Á¶ªÊåáÂÆöÊó•ÊúüÁöÑÊúÄËøëÁöÑÊúâÊïàÂ∑•‰ΩúÊó•Ëß¶Âèë‰∫ã‰ª∂„ÄÇ‰æãÂ¶ÇÔºöÂú® DayofMonth‰ΩøÁî®5WÔºåÂ¶ÇÊûú5Êó•ÊòØÊòüÊúüÂÖ≠ÔºåÂàôÂ∞ÜÂú®ÊúÄËøëÁöÑÂ∑•‰ΩúÊó•ÔºöÊòüÊúü‰∫îÔºåÂç≥4Êó•Ëß¶Âèë„ÄÇÂ¶ÇÊûú5Êó•ÊòØÊòüÊúüÂ§©ÔºåÂàôÂú®6Êó•(Âë®‰∏Ä)Ëß¶ÂèëÔºõÂ¶ÇÊûú5Êó•Âú®ÊòüÊúü‰∏Ä Âà∞ÊòüÊúü‰∫î‰∏≠ÁöÑ‰∏ÄÂ§©ÔºåÂàôÂ∞±Âú®5Êó•Ëß¶Âèë„ÄÇÂè¶Â§ñ‰∏ÄÁÇπÔºåWÁöÑÊúÄËøëÂØªÊâæ‰∏ç‰ºöË∑®ËøáÊúà‰ªΩ(8)LW:Ëøô‰∏§‰∏™Â≠óÁ¨¶ÂèØ‰ª•ËøûÁî®ÔºåË°®Á§∫Âú®Êüê‰∏™ÊúàÊúÄÂêé‰∏Ä‰∏™Â∑•‰ΩúÊó•ÔºåÂç≥ÊúÄÂêé‰∏Ä‰∏™ÊòüÊúü‰∫î„ÄÇ(9)#:Áî®‰∫éÁ°ÆÂÆöÊØè‰∏™ÊúàÁ¨¨Âá†‰∏™ÊòüÊúüÂá†ÔºåÂè™ËÉΩÂá∫Áé∞Âú®DayofMonthÂüü„ÄÇ‰æãÂ¶ÇÂú®4#2ÔºåË°®Á§∫ÊüêÊúàÁöÑÁ¨¨‰∫å‰∏™ÊòüÊúü‰∏â„ÄÇ ‰∏æÂá†‰∏™‰æãÂ≠ê:0 0 2 1 ? Ë°®Á§∫Âú®ÊØèÊúàÁöÑ1Êó•ÁöÑÂáåÊô®2ÁÇπË∞ÉÂ∫¶‰ªªÂä°0 15 10 ? * MON-FRI Ë°®Á§∫Âë®‰∏ÄÂà∞Âë®‰∫îÊØèÂ§©‰∏äÂçà10Ôºö15ÊâßË°å‰Ωú‰∏ö0 15 10 ? 6L 2002-2006 Ë°®Á§∫2002-2006Âπ¥ÁöÑÊØè‰∏™ÊúàÁöÑÊúÄÂêé‰∏Ä‰∏™ÊòüÊúü‰∫î‰∏äÂçà10:15ÊâßË°å‰Ωú]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Git ÊïôÁ®ã]]></title>
    <url>%2F2017%2F11%2F08%2FGit-%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[ÈÖçÁΩÆ‰ΩúËÄÖÈÇÆ‰ª∂1234 git config --global --edit git config --global user.name "your name"git config --global user.email "your email" ÂõûÈÄÄÂà∞ÊüêÊ¨°commitÔºåÊèê‰∫§ËøúÁ®ãÂàÜÊîØ123456789101112Êü•Áúãcommit idgit loggit log --pretty=onelineÊú¨Âú∞ÂõûÈÄÄgit reset --hard commit_idgit reset --hard HEAD^ ÂõûÈÄÄÂà∞‰∏ä‰∏™ÁâàÊú¨Âº∫Êé®Âà∞ËøúÁ®ãÔºögit push origin HEAD --forcegit push -f HEADÊåáÂêëÁöÑÁâàÊú¨Â∞±ÊòØÂΩìÂâçÁâàÊú¨ÔºåÂõ†Ê≠§ÔºåGitÂÖÅËÆ∏Êàë‰ª¨Âú®ÁâàÊú¨ÁöÑÂéÜÂè≤‰πãÈó¥Á©øÊ¢≠Ôºå‰ΩøÁî®ÂëΩ‰ª§ git reset --hard commit_id„ÄÇ git reset --hard HEAD^ Á©øÊ¢≠ÂâçÔºåÁî®git logÂèØ‰ª•Êü•ÁúãÊèê‰∫§ÂéÜÂè≤Ôºå‰ª•‰æøÁ°ÆÂÆöË¶ÅÂõûÈÄÄÂà∞Âì™‰∏™ÁâàÊú¨„ÄÇ git log --pretty=oneline Ë¶ÅÈáçËøîÊú™Êù•ÔºåÁî®git reflogÊü•ÁúãÂëΩ‰ª§ÂéÜÂè≤Ôºå‰ª•‰æøÁ°ÆÂÆöË¶ÅÂõûÂà∞Êú™Êù•ÁöÑÂì™‰∏™ÁâàÊú¨„ÄÇ git reflog Êú¨Âú∞ÂàÜÊîØË¢´ËøúÁ®ãË¶ÜÁõñ123git fetch --allgit reset --hard origin/master (ËøôÈáåmasterË¶Å‰øÆÊîπ‰∏∫ÂØπÂ∫îÁöÑÂàÜÊîØÂêç)git pull git ÂêåÊ≠•github‰∏äforkÁöÑÈ°πÁõÆ123456git checkout mastergit remote -vgit remote add leader git@github.com:MyCATApache/tcp-proxy.gitgit fetch leadergit merge leader/mastergit push origin master ÂêåÊ≠•ËøúÁ®ãÊúçÂä°Âô®ÔºåÊú¨Âú∞Â§çÂà∂‰∏Ä‰ªΩorigin git fetch origin Âª∫Á´ãÊú¨Âú∞ÂàÜÊîØ dev -&gt; origin/dev git checkout -b dev origin/dev git checkout -b [ÂàÜÊîØÂêç] [ËøúÁ®ãÂêç]/[ÂàÜÊîØÂêç]„ÄÇ Â¶ÇÊûú‰Ω†Êúâ 1.6.2 ‰ª•‰∏äÁâàÊú¨ÁöÑ GitÔºåËøòÂèØ‰ª•Áî® ‚Äìtrack ÈÄâÈ°πÁÆÄÂåñÔºö $ git checkout --track origin/serverfix ÂàõÂª∫ÂàÜÊîØ(remeber) git branch iss53 checkoutÂàÜÊîØ(remeber) git checkout iss53 ÂàõÂª∫Âπ∂checkoutÂàÜÊîØ git branch -b iss53 Êü•ÁúãÊâÄÊúâÂàÜÊîØ git branch -a Êé®ÈÄÅÊú¨Âú∞ÂàÜÊîØÂà∞ÊúçÂä°Âô®ÂàÜÊîØgit push [ËøúÁ®ãÂêç] [Êú¨Âú∞ÂàÜÊîØ]:[ËøúÁ®ãÂàÜÊîØ] Âà†Èô§ËøúÁ®ãÂàÜÊîØ git branch -r -d origin/branch-name git push origin :branch-name Âà†Èô§Êú¨Âú∞ÂàÜÊîØgit branch -d iss53 ÂΩì‰Ω†Âú® master ‰∏ã $ git pull # Á≠â‰∫é fetch originÔºåÁÑ∂Âêé merge origin/master ÂΩì‰Ω†Âú® develop ‰∏ã $ git pull # Á≠â‰∫é fetch originÔºåÁÑ∂Âêé merge origin/develop Âú®masterÂàÜÊîØ‰∏≠ $ git checkout -b hotfix $ vim index.html $ git commit -a -m &apos;fixed the broken email address&apos; $ git checkout master $ git merge hotfix $ git branch -d hotfix git checkout iss53 Vim index.html Git commit -a -m ‚Äòyour message‚Äô git merge master. ÂèØ‰ª•ÂêàÂπ∂master‰∏≠hotfixÁöÑÊõ¥Êñ∞ git checkout master git merge iss53 ÂèØ‰ª•Áî®git statusÊü•ÁúãÂêàÂπ∂‰∫ßÁîüÂÜ≤Á™ÅÁöÑÊñá‰ª∂ git addË°®Á§∫Ëß£ÂÜ≥Ôºå‰øùÂ≠òÂà∞ÊöÇÂ≠òÂå∫ÔºåÂÜçgit commitÂç≥ÂèØ git branch -d is53 Áõ∏ÊØîgit resetÔºåÂÆÉ‰∏ç‰ºöÊîπÂèòÁé∞Âú®ÁöÑÊèê‰∫§ÂéÜÂè≤„ÄÇÂõ†Ê≠§Ôºågit revertÂèØ‰ª•Áî®Âú®ÂÖ¨ÂÖ±ÂàÜÊîØ‰∏äÔºågit resetÂ∫îËØ•Áî®Âú®ÁßÅÊúâÂàÜÊîØ‰∏ä„ÄÇ‰Ω†‰πüÂèØ‰ª•Êäägit revertÂΩì‰ΩúÊí§ÈîÄÂ∑≤ÁªèÊèê‰∫§ÁöÑÊõ¥ÊîπÔºåËÄågit reset HEADÁî®Êù•Êí§ÈîÄÊ≤°ÊúâÊèê‰∫§ÁöÑÊõ¥Êîπ„ÄÇÂ∞±ÂÉègit checkout ‰∏ÄÊ†∑Ôºågit revert ‰πüÊúâÂèØËÉΩ‰ºöÈáçÂÜôÊñá‰ª∂„ÄÇÊâÄ‰ª•ÔºåGit‰ºöÂú®‰Ω†ÊâßË°årevert‰πãÂâçË¶ÅÊ±Ç‰Ω†Êèê‰∫§ÊàñËÄÖÁºìÂ≠ò‰Ω†Â∑•‰ΩúÁõÆÂΩï‰∏≠ÁöÑÊõ¥Êîπ„ÄÇ Âº∫Âà∂ÈáçÂÜôÊú¨Âú∞masterÂàÜÊîØ git fetch origin master git reset --hard FETCH_HEAD git clean -df Âº∫Âà∂Âà†Èô§ËøúÁ®ãÂàÜÊîØÁöÑÊüê‰∏™Êñá‰ª∂ git rm --cached --force .idea/libraries/Maven__org_springframework_spring_core_4_1_6_RELEASE.xml ‚Äã‚Äã git ‰øÆÊîπremoteÂú∞ÂùÄ12345678 ÊñπÊ≥ïÊúâ‰∏âÁßçÔºö1.‰øÆÊîπÂëΩ‰ª§git remote set-url origin [url]‰æãÂ¶ÇÔºöGit remote set-url origin gitlab@gitlab.chumob.com:PHP/hasoffer.git2.ÂÖàÂà†ÂêéÂä†git remote rm origingit remote add origin [url]3.Áõ¥Êé•‰øÆÊîπconfigÊñá‰ª∂ git diffÊóßÁöÑÂú®ÂâçÔºåÊñ∞ÁöÑÂú®Âêé git diff d1afe9 b588527d &gt; ~/Desktop/patch.diff git apply --reject ~/Desktop/patch.diff $ git diff 608e120 4abe32e --name-only $ git diff 608e120 4abe32e --name-only | xargs zip update.zip git mergetool12345678910‰∏ãËΩΩdiffmergeÔºàhttp://download.sourcegear.com/DiffMerge/4.2.1/DiffMerge.4.2.1.1013.intel.stable.pkgÔºâÈÖçÁΩÆgitÁ°Æ‰øù/usr/local/bin/diffmergeÂ≠òÂú®ÔºåËã•‰∏çÂ≠òÂú®ÔºåÂª∫Á´ãÁ¨¶Âè∑ÈìæÊé•Ôºàln /Applications/DiffMerge.app/Contents/MacOS/DiffMerge /usr/local/bin/diffmergeÔºâgit config --global diff.tool diffmergegit config --global difftool.diffmerge.cmd "/usr/local/bin/diffmerge \"\$LOCAL\" \"\$REMOTE\""git config --global merge.tool diffmergegit config --global mergetool.diffmerge.trustExitCode truegit config --global mergetool.diffmerge.cmd "/usr/local/bin/diffmerge --merge --result=\"\$MERGED\" \"\$LOCAL\" \"\$BASE\" \"\$REMOTE\""ÂÜ≤Á™ÅÂèëÁîüÂêé‰ΩøÁî® git mergetool ËøõË°åmerge git tag$ git tag -a v1.4 -m &apos;my version 1.4&apos; $ git tag v0.1 v1.3 v1.4 git mergeGit merge ‚Äìno-ff ÂèØ‰ª•‰øùÂ≠ò‰Ω†‰πãÂâçÁöÑÂàÜÊîØÂéÜÂè≤„ÄÇËÉΩÂ§üÊõ¥Â•ΩÁöÑÊü•Áúã mergeÂéÜÂè≤Ôºå‰ª•Âèäbranch Áä∂ÊÄÅ„ÄÇ git merge Âàô‰∏ç‰ºöÊòæÁ§∫ featureÔºåÂè™‰øùÁïôÂçïÊù°ÂàÜÊîØËÆ∞ÂΩï„ÄÇ ####Ê∑ªÂä†Â≠êÈ°πÁõÆ12345git submodule add --name tools --force http://git.zenzet.com/lss-server/lss-data-mining-toolscd toolsgit submodule initgit submodule updategit clone --recursive https://github.com/chaconinc/MainProject git stash git stash ‰øùÂ≠òÂΩìÂâçÁöÑÂ∑•‰ΩúËøõÂ∫¶„ÄÇ‰ºöÂàÜÂà´ÂØπÊöÇÂ≠òÂå∫ÂíåÂ∑•‰ΩúÂå∫ÁöÑÁä∂ÊÄÅËøõË°å‰øùÂ≠ò git stash save ‚Äúmessage‚Ä¶‚Äù ËøôÊù°ÂëΩ‰ª§ÂÆûÈôÖ‰∏äÊòØÁ¨¨‰∏ÄÊù° git stash ÂëΩ‰ª§ÁöÑÂÆåÊï¥Áâà git stash list ÊòæÁ§∫ËøõÂ∫¶ÂàóË°®„ÄÇÊ≠§ÂëΩ‰ª§ÊòæÁÑ∂ÊöóÁ§∫‰∫Ügit stash ÂèØ‰ª•Â§öÊ¨°‰øùÂ≠òÂ∑•‰ΩúËøõÂ∫¶ÔºåÂπ∂Áî®Âú®ÊÅ¢Â§çÊó∂ÂÄôËøõË°åÈÄâÊã© git stash pop [‚Äìindex] [] Â¶ÇÊûú‰∏ç‰ΩøÁî®‰ªª‰ΩïÂèÇÊï∞Ôºå‰ºöÊÅ¢Â§çÊúÄÊñ∞‰øùÂ≠òÁöÑÂ∑•‰ΩúËøõÂ∫¶ÔºåÂπ∂Â∞ÜÊÅ¢Â§çÁöÑÂ∑•‰ΩúËøõÂ∫¶‰ªéÂ≠òÂÇ®ÁöÑÂ∑•‰ΩúËøõÂ∫¶ÂàóË°®‰∏≠Ê∏ÖÈô§„ÄÇ Â¶ÇÊûúÊèê‰æõÂèÇÊï∞ÔºàÊù•Ëá™ git stash list ÊòæÁ§∫ÁöÑÂàóË°®ÔºâÔºåÂàô‰ªéËØ• &lt;stash&gt; ‰∏≠ÊÅ¢Â§ç„ÄÇÊÅ¢Â§çÂÆåÊØï‰πüÂ∞Ü‰ªéËøõÂ∫¶ÂàóË°®‰∏≠Âà†Èô§ &lt;stash&gt;„ÄÇ ÈÄâÈ°π‚Äìindex Èô§‰∫ÜÊÅ¢Â§çÂ∑•‰ΩúÂå∫ÁöÑÊñá‰ª∂Â§ñÔºåËøòÂ∞ùËØïÊÅ¢Â§çÊöÇÂ≠òÂå∫„ÄÇ git stash apply [‚Äìindex] [] Èô§‰∫Ü‰∏çÂà†Èô§ÊÅ¢Â§çÁöÑËøõÂ∫¶‰πãÂ§ñÔºåÂÖ∂‰ΩôÂíå git stash pop ÂëΩ‰ª§‰∏ÄÊ†∑ git stash clear Âà†Èô§ÊâÄÊúâÂ≠òÂÇ®ÁöÑËøõÂ∫¶ 123456789101112131415git stash [save message] [-k|--no-keep-index] [--patch]ËøôÊòØgit stash‰øùÂ≠òËøõÂ∫¶ÁöÑÂÆåÊï¥ÂëΩ‰ª§ÂΩ¢Âºè‰ΩøÁî®saveÂèØ‰ª•ÂØπËøõÂ∫¶Ê∑ªÂä†Â§áÊ≥®# git stash save "ËøôÊòØ‰øùÂ≠òÁöÑËøõÂ∫¶"git stash apply stash@&#123;2&#125;Áé∞Âú®ÊâßË°ålistÔºå‰ºöÂèëÁé∞ÂêéÈù¢‰ºöÂá∫Áé∞Ëá™ÂÆö‰πâÁöÑË¢´ÂêàÁßü# git stash liststash@&#123;0&#125;: On master: ËøôÊòØ‰øùÂ≠òÁöÑËøõÂ∫¶-kÂíå--no-keep-indexÊåáÂÆö‰øùÂ≠òËøõÂ∫¶ÂêéÔºåÊòØÂê¶ÈáçÁΩÆÊöÇÂ≠òÂå∫--patch ‰ºöÊòæÁ§∫Â∑•‰ΩúÂå∫ÂíåHEADÁöÑÂ∑ÆÂºÇ,ÈÄöËøáÁºñËæëÂ∑ÆÂºÇÊñá‰ª∂ÔºåÊéíÈô§‰∏çÈúÄË¶Å‰øùÂ≠òÁöÑÂÜÖÂÆπ„ÄÇÂíågit add -pÂëΩ‰ª§Á±ª‰ºº 123456789git stash ÂØπÂΩìÂâçÁöÑÊöÇÂ≠òÂå∫ÂíåÂ∑•‰ΩúÂå∫Áä∂ÊÄÅËøõË°å‰øùÂ≠ò„ÄÇgit stash list ÂàóÂá∫ÊâÄÊúâ‰øùÂ≠òÁöÑËøõÂ∫¶ÂàóË°®„ÄÇgit stash pop [--index] [&lt;stash&gt;] ÊÅ¢Â§çÂ∑•‰ΩúËøõÂ∫¶--index ÂèÇÊï∞Ôºö‰∏ç‰ªÖÊÅ¢Â§çÂ∑•‰ΩúÂå∫ÔºåËøòÊÅ¢Â§çÊöÇÂ≠òÂå∫&lt;stash&gt; ÊåáÂÆöÊÅ¢Â§çÊüê‰∏Ä‰∏™ÂÖ∑‰ΩìËøõÂ∫¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâËøô‰∏™ÂèÇÊï∞ÔºåÈªòËÆ§ÊÅ¢Â§çÊúÄÊñ∞ËøõÂ∫¶Â¶ÇÔºö‰ª•‰∏ãÂëΩ‰ª§ÊÅ¢Â§çÁºñÂè∑‰∏∫0ÁöÑËøõÂ∫¶ÁöÑÂ∑•‰ΩúÂå∫ÂíåÊöÇÂ≠òÂå∫# git stash pop --index stash@&#123;0&#125; git rebaseÂú®‰ΩøÁî® Git ‰Ωú‰∏∫ÁâàÊú¨ÊéßÂà∂ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÁî±‰∫éÂêÑÁßçÂêÑÊ†∑ÁöÑÂéüÂõ†Êèê‰∫§‰∫ÜËÆ∏Â§ö‰∏¥Êó∂ÁöÑ commitÔºåËÄåËøô‰∫õ commit ÊãºÊé•Ëµ∑Êù•ÊâçÊòØÂÆåÊï¥ÁöÑ‰ªªÂä°„ÄÇÈÇ£‰πàÊàë‰ª¨‰∏∫‰∫ÜÈÅøÂÖçÂ§™Â§öÁöÑ commit ËÄåÈÄ†ÊàêÁâàÊú¨ÊéßÂà∂ÁöÑÊ∑∑‰π±ÔºåÈÄöÂ∏∏Êàë‰ª¨Êé®ËçêÂ∞ÜËøô‰∫õ commit ÂêàÂπ∂Êàê‰∏Ä‰∏™„ÄÇ 1,Êü•ÁúãÊèê‰∫§ÂéÜÂè≤Ôºågit log È¶ñÂÖà‰Ω†Ë¶ÅÁü•ÈÅìËá™Â∑±ÊÉ≥ÂêàÂπ∂ÁöÑÊòØÂì™Âá†‰∏™Êèê‰∫§ÔºåÂèØ‰ª•‰ΩøÁî®git logÂëΩ‰ª§Êù•Êü•ÁúãÊèê‰∫§ÂéÜÂè≤ÔºåÂÅáÂ¶ÇÊúÄËøë4Êù°ÂéÜÂè≤Â¶Ç‰∏ãÔºö 1234567commit 3ca6ec340edc66df13423f36f52919dfa3......commit 1b4056686d1b494a5c86757f9eaed844......commit 53f244ac8730d33b353bee3b24210b07......commit 3a4226b4a0b6fa68783b07f1cee7b688....... ÂéÜÂè≤ËÆ∞ÂΩïÊòØÊåâÁÖßÊó∂Èó¥ÊéíÂ∫èÁöÑÔºåÊó∂Èó¥ËøëÁöÑÊéíÂú®ÂâçÈù¢„ÄÇ 2,git rebase ÊÉ≥Ë¶ÅÂêàÂπ∂1-3Êù°ÔºåÊúâ‰∏§‰∏™ÊñπÊ≥ï 1.‰ªéHEADÁâàÊú¨ÂºÄÂßãÂæÄËøáÂéªÊï∞3‰∏™ÁâàÊú¨ 1git rebase -i HEAD~3 2.ÊåáÂêçË¶ÅÂêàÂπ∂ÁöÑÁâàÊú¨‰πãÂâçÁöÑÁâàÊú¨Âè∑ 1git rebase -i 3a4226b ËØ∑Ê≥®ÊÑè3a4226bËøô‰∏™ÁâàÊú¨ÊòØ‰∏çÂèÇ‰∏éÂêàÂπ∂ÁöÑÔºåÂèØ‰ª•ÊääÂÆÉÂΩìÂÅö‰∏Ä‰∏™ÂùêÊ†á 3,ÈÄâÂèñË¶ÅÂêàÂπ∂ÁöÑÊèê‰∫§ 1.ÊâßË°å‰∫ÜrebaseÂëΩ‰ª§‰πãÂêéÔºå‰ºöÂºπÂá∫‰∏Ä‰∏™Á™óÂè£ÔºåÂ§¥Âá†Ë°åÂ¶Ç‰∏ãÔºö 12345pick 3ca6ec3 'Ê≥®Èáä**********'pick 1b40566 'Ê≥®Èáä*********'pick 53f244a 'Ê≥®Èáä**********' 2.Â∞ÜpickÊîπ‰∏∫squashÊàñËÄÖs,‰πãÂêé‰øùÂ≠òÂπ∂ÂÖ≥Èó≠ÊñáÊú¨ÁºñËæëÁ™óÂè£Âç≥ÂèØ„ÄÇÊîπÂÆå‰πãÂêéÊñáÊú¨ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 12345pick 3ca6ec3 'Ê≥®Èáä**********'s 1b40566 'Ê≥®Èáä*********'s 53f244a 'Ê≥®Èáä**********' 3.ÁÑ∂Âêé‰øùÂ≠òÈÄÄÂá∫ÔºåGit‰ºöÂéãÁº©Êèê‰∫§ÂéÜÂè≤ÔºåÂ¶ÇÊûúÊúâÂÜ≤Á™ÅÔºåÈúÄË¶Å‰øÆÊîπÔºå‰øÆÊîπÁöÑÊó∂ÂÄôË¶ÅÊ≥®ÊÑèÔºå‰øùÁïôÊúÄÊñ∞ÁöÑÂéÜÂè≤Ôºå‰∏çÁÑ∂Êàë‰ª¨ÁöÑ‰øÆÊîπÂ∞±‰∏¢ÂºÉ‰∫Ü„ÄÇ‰øÆÊîπ‰ª•ÂêéË¶ÅËÆ∞ÂæóÊï≤‰∏ãÈù¢ÁöÑÂëΩ‰ª§Ôºö 123git add .git rebase --continue Â¶ÇÊûú‰Ω†ÊÉ≥ÊîæÂºÉËøôÊ¨°ÂéãÁº©ÁöÑËØùÔºåÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºö 1git rebase --abort 4.Â¶ÇÊûúÊ≤°ÊúâÂÜ≤Á™ÅÔºåÊàñËÄÖÂÜ≤Á™ÅÂ∑≤ÁªèËß£ÂÜ≥ÔºåÂàô‰ºöÂá∫Áé∞Â¶Ç‰∏ãÁöÑÁºñËæëÁ™óÂè£Ôºö 12345678# This is a combination of 4 commits.#The first commit‚Äôs message is:Ê≥®Èáä......# The 2nd commit‚Äôs message is:Ê≥®Èáä......# The 3rd commit‚Äôs message is:Ê≥®Èáä......# Please enter the commit message for your changes. Lines starting # with ‚Äò#‚Äô will be ignored, and an empty message aborts the commit. 5.ËæìÂÖ•wq‰øùÂ≠òÂπ∂Êé®Âá∫, ÂÜçÊ¨°ËæìÂÖ•git logÊü•Áúã commit ÂéÜÂè≤‰ø°ÊÅØÔºå‰Ω†‰ºöÂèëÁé∞Ëøô‰∏§‰∏™ commit Â∑≤ÁªèÂêàÂπ∂‰∫Ü„ÄÇ git review Ëé∑ÂèñÂΩìÂâçÂàÜÊîØ 1git symbolic-ref -q --short HEAD Âú®gitÂà´ÂêçÈáå‰ΩøÁî®shellÂáΩÊï∞Ôºå$1Ëé∑ÂèñÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂÄºÔºå$2‚Ä¶‚Ä¶$n‰æùÊ¨°Á±ªÊé®ÔºåÊ†πÊçÆËá™Â∑±‰π†ÊÉØÈúÄË¶ÅÂÆöÂà∂ Êèê‰∫§reviewÁöÑÊ≠£Á°ÆËØ≠Âè•ÊòØÔºö git push origin HEAD:refs/for/destination_branch ÊÑèÊÄùÊòØ‚ÄîÊääÂΩìÂâçÂàÜÊîØÁöÑ‰ª£Á†ÅÊé®ÈÄÅÂà∞ËøúÁ®ãorigin‰ªìÂ∫ìÁöÑreviewÂàÜÊîØdestination_branch‰∏äÂéª ‚Äã originË°®Á§∫ËøúÁ®ãgitÊúçÂä°Âô®Âú∞ÂùÄÔºõHEADË°®Á§∫ÂΩìÂâçÂàÜÊîØÔºõrefs/for/destination_branch Ë°®Á§∫ËøúÁ®ãreviewÂàÜÊîØ ‰∏ãÈù¢ÈÖçÁΩÆÁöÑÂê´‰πâÔºö ÊâßË°ågit reviewÁ≠â‰ª∑‰∫égit push origin HEAD:refs/for/current_branch ÊâßË°ågit review destination_branchÁ≠â‰ª∑‰∫égit push origin HEAD:refs/for/destination_branch 1`review = ``"!f() &#123; if [ -z $1 ];then currBra=`git symbolic-ref -q --short HEAD`;else currBra=$1;fi;git push origin HEAD:refs/for/$currBra; &#125;; f"` ÂÖ®ÈÉ®ÈÖçÁΩÆÔºö 1`[core]`` ``repositoryformatversion = ``0`` ``filemode = ``true`` ``bare = ``false`` ``logallrefupdates = ``true`` ``ignorecase = ``true`` ``precomposeunicode = ``true``[remote ``"origin"``]`` ``url = ssh:``//depu.shen@gerrit.tongdun.me:29418/ganghui.zeng/gerrit_test`` ``fetch = +refs/heads/*:refs/remotes/origin/*``[branch ``"master"``]`` ``remote = origin`` ``merge = refs/heads/master``[branch ``"gerrit_test1811052223a"``]`` ``remote = origin`` ``merge = refs/heads/gerrit_test1811052223``[branch ``"gerrit_test1811052223"``]`` ``remote = origin`` ``merge = refs/heads/gerrit_test1811052223``[alias]`` ``st = status`` ``review = ``"!f() &#123; if [ -z $1 ];then currBra=`git symbolic-ref -q --short HEAD`;else currBra=$1;fi;git push origin HEAD:refs/for/$currBra; &#125;; f"` ÈÖçÁΩÆÁîüÊïàÁöÑÂú∞ÊñπÔºå‰ºòÂÖàÁ∫ßÁî±È´òÂà∞Â∫ïÔºö È°πÁõÆÈÖçÁΩÆÔºå‰Ωç‰∫éÈ°πÁõÆ‰∏ãÁöÑ.git/config Êü•Áúãgit config ‚Äìlocal ‚Äìlist ÁºñËæëgit config ‚Äìlocal -e Êüê‰∏™Áî®Êà∑‰∏ãÁöÑÊâÄÊúâÈ°πÁõÆÈÖçÁΩÆÔºö~/.gitconfig Êü•Áúãgit config ‚Äìglobal ‚Äìlist ÁºñËæëgit config ‚Äìglobal -e ÂΩìÂâçÁ≥ªÁªü‰∏ãÁöÑÊâÄÊúâÁî®Êà∑ÊâÄÊúâÈ°πÁõÆÈÖçÁΩÆÔºö/etc/gitconfig Êü•Áúãgit config ‚Äìsystem ‚Äìlist ÁºñËæëgit config ‚Äìsystem -e https://hellomin.github.io/2018/09/11/%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E7%9A%84Git%E5%88%AB%E5%90%8D/ git diff1„ÄÅÂ∑•‰ΩúÂå∫ÂíåÊú¨Âú∞ÁâàÊú¨Â∫ìÂØπÊØî git diff HEAD Êü•ÁúãÂ∑•‰ΩúÂå∫ÂíåÁâàÊú¨Â∫ìÈáåÈù¢ÊúÄÊñ∞ÁâàÊú¨ÁöÑÊâÄÊúâÊñá‰ª∂ÁöÑÂå∫Âà´ git diff HEAD ‚Äì file1Êü•ÁúãÂ∑•‰ΩúÂå∫ÂíåÁâàÊú¨Â∫ìÈáåÈù¢ÊúÄÊñ∞ÁâàÊú¨ÁöÑÊñá‰ª∂file1ÁöÑÂå∫Âà´ git diff HEAD^ Êü•ÁúãÂ∑•‰ΩúÂå∫ÂíåÁâàÊú¨Â∫ìÈáåÈù¢‰∏ä‰∏™ÁâàÊú¨ÁöÑÊâÄÊúâÊñá‰ª∂ÁöÑÂå∫Âà´ git diff commitId ‚Äì ./lib Êü•ÁúãÂΩìÂâçÂ∑•‰ΩúÂå∫ÂíåÊüê‰∏™ÂéÜÂè≤ÁâàÊú¨commitIdÁöÑÁõÆÂΩïlibÁöÑÂå∫Âà´ 2„ÄÅÊöÇÂ≠òÂå∫ÂíåÊú¨Âú∞ÁâàÊú¨Â∫ìÂØπÊØî git diff ‚Äìcached Êü•ÁúãÊöÇÂ≠òÂå∫ÂíåÊú¨Âú∞ÁâàÊú¨Â∫ìÊúÄÊñ∞ÁâàÊú¨ÊâÄÊúâÊñá‰ª∂ÁöÑÂå∫Âà´ git diff ‚Äìcached ‚Äì file1 Êü•ÁúãÊöÇÂ≠òÂå∫ÂíåÊú¨Âú∞ÁâàÊú¨Â∫ìÊúÄÊñ∞ÁâàÊú¨Êñá‰ª∂file1ÁöÑÂå∫Âà´ git diff ‚Äìcached commitId file1 Êü•ÁúãÂ∑≤Áªè add ËøõÊöÇÂ≠òÂå∫‰ΩÜÊòØÂ∞öÊú™ commit ÁöÑÂÜÖÂÆπÂêåÊüê‰∏ÄÊ¨° commit Êó∂ÁöÑÂÜÖÂÆπÁöÑÂ∑ÆÂºÇ ‰πüÂèØ‰ª•‰ΩøÁî®git diff ‚Äìstaged 3„ÄÅÂ∑•‰ΩúÂéªÂíåÊöÇÂ≠òÂå∫ÂØπÊØî git diff Êü•ÁúãÂ∑•‰ΩúÂå∫ÂíåÊöÇÂ≠òÂå∫‰∏§‰∏™ÁâàÊú¨ÊâÄÊúâÊñá‰ª∂ÁöÑÂå∫Âà´ git diff ‚Äì file1 Êü•ÁúãÂ∑•‰ΩúÂå∫ÂíåÊöÇÂ≠òÂå∫‰∏§‰∏™ÁâàÊú¨Êñá‰ª∂file1ÁöÑÂå∫Âà´ 4„ÄÅÊØîËæÉ‰∏§‰∏™ÂéÜÂè≤ÁâàÊú¨Áõ¥Êé•ÁöÑÂå∫Âà´ git dff commitId1 commitId2 ÊØîËæÉ‰∏§‰∏™ÂéÜÂè≤ÁâàÊú¨‰πãÈó¥ÁöÑÂå∫Âà´ git diff commitId1:file1 commidId2:file2 ÊØîËæÉ‰∏§‰∏™ÂéÜÂè≤ÁâàÊú¨‰πãÈó¥Êñá‰ª∂ÁöÑÂå∫Âà´ 5„ÄÅËæìÂá∫Ëá™topicÂíåmasterÂàÜÂà´ÂºÄÂèë‰ª•Êù•ÔºåmasterÂàÜÊîØ‰∏äÁöÑchanged„ÄÇ ‚Äã git diff topic‚Ä¶master Changes that occurred on the master branch since when the topic branch was started off it git diffÊòæÁ§∫ÂÜÖÂÆπËß£ËØªÔºöhttp://www.ruanyifeng.com/blog/2012/08/how_to_read_diff.html git resetgit reset HEAD file ‰ΩøÊöÇÂ≠òÂå∫ÂíåÊú¨Âú∞ÁâàÊú¨Â∫ì‰øùÊåÅ‰∏ÄËá¥ÔºåÂ∑•‰ΩúÂå∫‰∏çÂèóÂΩ±Âìç„ÄÇÂèØ‰ª•ÁêÜËß£‰Ωçgit addÁöÑÂèçÊìç‰Ωú git reset ‚Äìhard xxx ‰ΩøÂ∑•‰ΩúÂå∫ÂíåÂΩìÂú∞ÁâàÊú¨Â∫ì‰øùÊåÅ‰∏ÄËá¥Ôºå‰πüÂ∞±ÊòØ‰∏¢ÂºÉ‰Ω†Âú®Â∑•‰ΩúÂå∫ÂÅöÁöÑÂ∑•‰Ωú(ËøòÊ≤°ÊúâÊèê‰∫§Âà∞ÂΩìÂú∞ÁâàÊú¨Â∫ìÁöÑÂÜÖÂÆπ) xxxÂèØ‰ª•ÊòØÔºöHEADË°®Á§∫ÂΩìÂâçÁâàÊú¨ÔºåHEAD^Ë°®Á§∫‰∏ä‰∏Ä‰∏™ÁâàÊú¨ÔºåHEAD^^Ë°®Á§∫‰∏ä‰∏ä‰∏™ÁâàÊú¨ÔºåHEAD~10Ë°®Á§∫‰∏ä10‰∏™ÁâàÊú¨Ôºõ‰πüÂèØ‰ª•ÊòØcommitId Â¶ÇÂõæÊâÄÁ§∫ÔºåÊú¨Âú∞‰øÆÊîπ‰∫Ü‰∏§‰∏™Êñá‰ª∂ÔºåÁé∞Âú®ÊÉ≥ÊÅ¢Â§çÊñá‰ª∂ÔºåÂ¶ÇÊûúÊÉ≥‰∏ÄÊ¨°ÊÄßÂÆåÊàêÔºå‰ΩøÁî®ÂëΩ‰ª§git reset ‚Äìhard HEAD,Áõ¥Êé•‰ªéÂΩìÂú∞ÁâàÊú¨Â∫ìÊÅ¢Â§çÔºåÁî®ÁâàÊú¨Â∫ìÁöÑÂÜÖÂÆπË¶ÜÁõñÂ∑•‰ΩúÂå∫ÔºåËøôÁßçÊìç‰ΩúÂè™ËÉΩÂØπÊâÄÊúâÊñá‰ª∂Êìç‰ΩúÔºå‰∏çËÉΩÈíàÂØπÂçï‰∏™Êñá‰ª∂Êìç‰Ωú„ÄÇÂ¶ÇÊûúÊÉ≥ÊÅ¢Â§çÂçï‰∏™Êñá‰ª∂ÊàñÂ§ö‰∏™Êñá‰ª∂Ôºå‰ΩøÁî®ÂëΩ‰ª§git checkout ‚Äì a.txt b.txt„ÄÇ ËøôÁ±ªÊìç‰ΩúË¶ÅÊÖéÈáçÔºå‰∏ÄÊó¶ÂÆåÊàêÔºåÂ∞±‰ºö‰∏¢ÂºÉ‰πãÂâçÁöÑ‰øÆÊîπÔºåÊó†Ê≥ïÊÅ¢Â§ç git checkoutgit checkout ‚Äì file ‰øùÊåÅÂ∑•‰ΩúÂå∫ÂíåÊöÇÂ≠òÂå∫Êñá‰ª∂ÂÜÖÂÆπ‰∏ÄËá¥Ôºå‰ª•ÊöÇÂ≠òÂå∫‰∏∫Ê®°ÊùøÔºåÊí§ÈîÄÂ∑•‰ΩúÂå∫ÁöÑ‰øÆÊîπ git statusÁªìÊûúÂ¶ÇÂõæÔºåË°®Á§∫ÊöÇÂ≠òÂå∫ÁöÑÂÜÖÂÆπÂíåÁâàÊú¨Â∫ìÁöÑÂÜÖÂÆπ‰∏ÄËá¥ÔºåÊâÄ‰ª•git diff ‚ÄìcachedÊó∂ÔºåÊöÇÂ≠òÂå∫ÂíåÊú¨Âú∞ÁâàÊú¨Â∫ìÂÜÖÂÆπ‰∏ÄËá¥ÔºåÊ≤°ÊúâÂ∑ÆÂºÇ„ÄÇ ÂΩìÈÄöËøágit add file1ÂæÄÊöÇÂ≠òÂå∫Ê∑ªÂä†Êñá‰ª∂file1Êó∂ÔºåÊöÇÂ≠òÂå∫Â∞±ÊØîÊú¨Âú∞ÁâàÊú¨Â∫ìÂ§ö‰∫Ü‰∏™Êñá‰ª∂file1ÁöÑÊõ¥Êîπ„ÄÇ ÊâÄ‰ª•Ë¶ÅÁêÜËß£Ôºå‰∏ãÂõæÂπ∂‰∏çÊòØËØ¥ÊöÇÂ≠òÂå∫ÊòØÁ©∫ÁöÑÔºåÂè™ÊòØËØ¥ÊòéÊöÇÂ≠òÂå∫Áõ∏ÂØπ‰∫éÊú¨Âú∞ÁâàÊú¨Â∫ìÊ≤°ÊúâÂ∑ÆÂºÇÔºåÂç≥ÂíåÁâàÊú¨Â∫ìÂÜÖÂÆπ‰∏ÄËá¥ git stashÔºöhttps://gist.github.com/subchen/3409a16cb46327ca7691‰øùÂ≠òÂΩìÂâçÁöÑÂ∑•‰ΩúËøõÂ∫¶ÔºåÂàáÊç¢Âà∞ÂÖ∂‰ªñÂàÜÊîØÁªßÁª≠Â∑•‰ΩúÔºåÁÑ∂ÂêéÂàáÂõûÂéüÊù•ÁöÑÂàÜÊîØÔºåÊÅ¢Â§ç‰πãÂâçÁöÑÂ∑•‰Ωú git stash listÊü•ÁúãÂΩìÂâçÂ≠òÂÇ®ÁöÑ‰∏¥Êó∂Áä∂ÊÄÅ„ÄÇ git stash pop ‚Äìindex 1ÊÅ¢Â§çÁõ∏Â∫îÂ≠òÂÇ®Âå∫ÁöÑÂÜÖÂÆπÔºåÂêåÊó∂‰ªéËøô‰∏™Â≠òÂÇ®Âå∫Âà†Èô§Ëøô‰∏™Â≠òÂÇ®„ÄÇ ‰∏ãÂõæindexÂÄºÂàÜÂà´‰∏∫0„ÄÅ1 Ê≥®ÊÑèÔºöÂ§ö‰∏™ÂàÜÊîØÂàáÊç¢Êó∂ÔºåË¶ÅÊÅ¢Â§çÁõ∏Â∫îÁöÑÂ≠òÂÇ®Âå∫ÂÜÖÂÆπÔºåÊåáÂÆöÁõ∏Â∫îÁöÑÁ¥¢ÂºïÂÄºÊÅ¢Â§ç„ÄÇÂè™‰ΩøÁî®ÂëΩ‰ª§git stash popÊúâÂèØËÉΩÊÅ¢Â§çÊàêÂÖ∂‰ªñÂàÜÊîØÁöÑÂ∑•‰Ωú„ÄÇÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•ÈÄöËøáËøôÊ†∑ÁöÑÊñπÂºèÊääÂÖ∂‰ªñÂàÜÊîØÁöÑÂ∑•‰ΩúÁä∂ÊÄÅÂ§çÂà∂Âà∞ÂΩìÂâçÂàÜÊîØ„ÄÇ ÂàÜÊîØÈáçÂëΩÂêçgit branch -M new_branch_name git branch -m old_name new_name ‰ΩøÁî®git statusÂëΩ‰ª§Êü•ÁúãÔºöÂèØ‰ª•Áü•ÈÅìÊú¨Âú∞ÁöÑÂàÜÊîØÊØîÊú¨Âú∞ÁöÑËøúÁ®ãÂàÜÊîØÂ§ö‰∫Ü‰∏ÄÊ¨°Êèê‰∫§„ÄÇ‰ΩøÁî®git pullÔºàgit fetch+ git mergeÔºâÊãâÂèñËøúÁ®ãÂàÜÊîØÔºåÂπ∂ËØïÂõæÂêàÂπ∂Êú¨Âú∞ÂàÜÊîØÂíåÂàöÂàöÊõ¥Êñ∞ÁöÑÂ≠òÂÇ®Âú®Êú¨Âú∞ÁöÑËøúÁ®ãÂàÜÊîØÊó∂ÔºåÂá∫Áé∞ÂÜ≤Á™Å ‰∏ãÂõæË°®Á§∫‰ªéÊú¨Âú∞ÂíåËøúÁ®ãÁöÑÂÖ±ÂêåÁà∂Êèê‰∫§ÁÆóËµ∑ÔºåÊú¨Âú∞Êúâ‰∏ÄÊ¨°Êèê‰∫§ÔºåËøúÁ®ãÂàÜÊîØÊúâ‰∏âÊ¨°Êèê‰∫§ Êõ¥Âä†‰∏äÂõæÁöÑÁä∂ÊÄÅÔºåËøôÈáåÂÖ∂ÂÆû‰ΩøÁî®git mergeÊõ¥‰∏∫ÂáÜÁ°Æ„ÄÇ Âà∞Ëøô‰∏ÄÊ≠•Ôºå‰Ω†ÂèØ‰ª•ÂèñÊ∂àËøôÊ¨°git mergeÊìç‰ΩúÔºögit merge ‚Äìabort„ÄÇÊàñËÄÖËß£ÂÜ≥ÂÜ≤Á™ÅÂêécommitÔºåÁÑ∂Âêégit push HEAD:refs/for/xxx_branchÈáçÊñ∞Êèê‰∫§review git branch Êñ∞Âª∫ÂàÜÊîØÔºögit branch branch_name: ‰ª•ÂΩìÂâçÂàÜÊîØÁöÑÊúÄÂêé‰∏ÄÊ¨°Êèê‰∫§‰Ωú‰∏∫Êñ∞Âª∫ÂàÜÊîØÁöÑÊúÄÂêé‰∏ÄÊ¨°Êèê‰∫§ÔºåÂ∞±ÊòØÂΩìÂâçÂàÜÊîØÁöÑÂ§çÂà∂ÔºåÊèê‰∫§ÂéÜÂè≤/ÁâàÊú¨ÂéÜÂè≤ÁöÑÂ§çÂà∂ git branch branch_name commitIdÔºö‰ª•ÂΩìÂâçÂàÜÊîØÁöÑÊüê‰∏ÄÊ¨°Êèê‰∫§‰Ωú‰∏∫Êñ∞Âª∫ÂàÜÊîØÁöÑÊúÄÂêé‰∏ÄÊ¨°Êèê‰∫§ÔºåÂ∞±ÊòØÂΩìÂâçÂàÜÊîØÊüêÊ¨°Êèê‰∫§Âèä‰πãÂâçÊèê‰∫§ÂéÜÂè≤ÁöÑÂ§çÂà∂„ÄÇÊñπ‰æø‰ªé‰ªª‰Ωï‰∏Ä‰∏™Êèê‰∫§ÁÇπÊ£ÄÂá∫‰∏Ä‰∏™Êñ∞ÁöÑÂàÜÊîØ„ÄÇ Ëøô‰∏™ÂäüËÉΩÂæàÂ•ΩÁî®ÔºåÊØîÂ¶ÇÊàë‰ª¨Âú®ÂΩìÂâçÂàÜÊîØÂºÄÂèë‰∫Ü‰∏Ä‰∏™Êñ∞ÂäüËÉΩÔºå‰ΩÜÊòØÂèàÊÉ≥Â∞ùËØïËøô‰∏™ÂäüËÉΩÁöÑÂè¶‰∏ÄÁßçÂÆûÁé∞ÊñπÊ≥ïÔºåÊ≠§Êó∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ªéÊñ∞ÂäüËÉΩÊèê‰∫§ÁöÑÂâç‰∏ÄÊ¨°Êèê‰∫§ÁöÑÂú∞ÊñπÊ£ÄÂá∫‰∏Ä‰∏™Êñ∞ÁöÑÂàÜÊîØÔºåÈáçÊñ∞ÂºÄÂèëÔºåËÄå‰∏çÂøÖÊääÂΩìÂâçÂ∑≤ÁªèÂºÄÂèëÁöÑÊñ∞ÂäüËÉΩ‰øÆÊîπ‰∏∫Âè¶‰∏ÄÁßçÂÆûÁé∞„ÄÇ # ÊâπÈáè‰øÆÊîπcommitÈáåÈù¢ÁöÑÁî®Êà∑‰ø°ÊÅØÂíåÊèê‰∫§ËÄÖ‰ø°ÊÅØ‰ª•‰∏ã‰ª£Á†ÅÂèØ‰ª•‰øÆÊîπÊâÄÊúâcommitÁöÑAuthorÈÇÆÁÆ±Ôºögit filter-branch ‚Äìenv-filter ‚Äòexport GIT_AUTHOR_EMAIL=new_author_email‚Äô ‚Äì„ÄÇÊïàÊûúÊÉä‰∫∫Âì¶ Èô§‰∫ÜGIT_AUTHOR_EMAIL, ËøòÊúâGIT_AUTHOR_NAME, GIT_COMMITTER_EMAIL, GIT_COMMITTER_NAMEÁ≠âÂèÇÊï∞ÂèØ‰ª•‰øÆÊîπ. Ë∞®ÊÖéÊìç‰ΩúÔºöÂØπ‰∫éÂ∑≤ÁªèÊèê‰∫§ÁöÑ‰øÆÊîπÔºå‰ºöÈÄ†ÊàêÊú¨Âú∞ÂàÜÊîØÂíåËøúÁ®ãÂàÜÊîØÂ≠òÂú®ÂàÜÊ≠ß git checkout ÂàáÊç¢ÂàÜÊîØÊàñËÄÖÊñ∞Âª∫ÂàÜÊîØgit checkout branch_name ÂàáÊç¢Âà∞Â∑≤ÁªèÂàõÂª∫ÁöÑÂàÜÊîØ‰∏ä git checkout commitId ÂàáÊç¢Âà∞ÊüêÊ¨°Êèê‰∫§‰∏äÔºåËÆ∞ÂæóÂàáÊç¢ÂêéÁöÑÁä∂ÊÄÅÊòØ‰∏™‰∏¥Êó∂Áä∂ÊÄÅÔºå‰Ω†ÊâÄÂÅöÁöÑÊâÄÊúâ‰øÆÊîπÂ¶ÇÊûú‰∏ç‰øùÂ≠òÂà∞Êüê‰∏™ÂàÜÊîØ‰∏äÔºåÂΩì‰Ω†ÂàáÊç¢Âà∞ÂÖ∂‰ªñÂàÜÊîØÊó∂ÔºåÂ∞±ÂèØËÉΩ‰∏¢Â§±„ÄÇ Èò≤Ê≠¢‰∏¢Â§±ÁöÑÊñπÊ≥ïÊòØÔºö 1„ÄÅÂàáÊç¢ÂâçÊâßË°åÂëΩ‰ª§ git branch branch_nameÔºåÁ≠â‰∫éÂØπÂΩìÂâçÁöÑÊèê‰∫§ÂéÜÂè≤Â§çÂà∂‰∏Ä‰ªΩÔºåÊñ∞ÂàÜÊîØÂ§á‰ªΩÂêéÔºå‰ªçÁÑ∂Âú®ÂΩìÂâç‰∏¥Êó∂ÂàÜÊîØÊìç‰Ωú 2„ÄÅÂàáÊç¢ÂâçÊâßË°åÂëΩ‰ª§ git checkout -b branch_name, Á≠â‰∫éÂØπÂΩìÂâçÁöÑÊèê‰∫§ÂéÜÂè≤Â§çÂà∂‰∏Ä‰ªΩÔºåÂπ∂ÂêåÊó∂ÂàáÊç¢Âà∞Êñ∞ÂàÜÊîØ 3„ÄÅÂàáÊç¢ÂêéÊâßË°åÂëΩ‰ª§ git branch branch_name commitIdÔºåÂÖ∂‰∏≠commitIdÊòØÂàáÊç¢ÂâçÂàÜÊîØÁöÑÊúÄÂêé‰∏ÄÊ¨°Êèê‰∫§commitIdÔºåÂàáÊç¢ÂêéÔºåÂëΩ‰ª§Ë°å‰ºöÊèêÁ§∫Áªô‰Ω†ÔºöÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÁöÑ‚Äú6c91c0a‚Äù git checkout -b branch_name Êñ∞Âª∫ÂàÜÊîØÔºåÂπ∂ÂàáÊç¢Âà∞Ëøô‰∏™ÂàÜÊîØÔºåÊñ∞ÂàÜÊîØÁõ∏ÂΩì‰∫éÂéüÊù•ÂàÜÊîØÁöÑ‰∏Ä‰∏™ÂâØÊú¨ git checkout -b branch_name commitId Êñ∞Âª∫ÂàÜÊîØÔºåÂπ∂ÂàáÊç¢Âà∞Ëøô‰∏™ÂàÜÊîØÔºåÊñ∞ÂàÜÊîØÁõ∏ÂΩì‰∫éÂéüÊù•ÂàÜÊîØ‰ªéÊüêÊ¨°Êèê‰∫§ÂºÄÂßãÂæÄÂâçÁöÑÊâÄÊúâÊèê‰∫§ÂéÜÂè≤ÁöÑ‰∏Ä‰∏™ÂâØÊú¨ Âè¶Â§ñÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºöÂΩìÊàë‰ª¨Âú®‰∏Ä‰∏™ÂàÜÊîØ‰∏ä‰øÆÊîπÂÆåÔºåÂ¶ÇÊûúÊ≤°Êúâgit add/git commitÊèê‰∫§ÂêéÔºåÊàñËÄÖgit stash‰øùÊåÅÂΩìÂâçÁä∂ÊÄÅÔºåÊòØÊó†Ê≥ïËøõË°åÂàÜÊîØÂàáÊç¢ÁöÑ„ÄÇÂΩìÊó∂ÂØπ‰∫é‰∏¥Êó∂ÂàÜÊîØÊòØÂèØ‰ª•ÁöÑÔºåËÄå‰∏î‰ºöÊääÂéÜÂè≤ÂàÜÊîØÁöÑ‰øÆÊîπÂ∏¶Âà∞ÂàáÊç¢ÂêéÁöÑÂàÜÊîØ‰∏äÔºåÊõ¥Âä†ÊúâÊÑèÊÄùÁöÑÊòØÔºåÂèØ‰ª•Êää‰øÆÊîπÂ∏¶Âà∞‰ªª‰Ωï‰∏Ä‰∏™ÂÖ∂‰ªñÂ∑≤ÁªèÂ≠òÂú®ÁöÑÂàÜÊîØÊàñËÄÖÊüê‰∏ÄÊ¨°Êèê‰∫§commitId‰∏äÊàñËÄÖÊñ∞Âª∫ÁöÑÂàÜÊîØ‰∏ä git checkout ‚Äì file1 Ê£ÄÊü•Êñá‰ª∂file1ÔºåÊ≥®ÊÑèÊ†ºÂºè ‚Äú‚Äì‚Äù ‰ΩúÁî®ÊòØÊòéÊòæÁöÑÔºåÂõ†‰∏∫Â¶ÇÊûúÂ≠òÂú®Âíåfile1ÂêåÂêçÁöÑÂàÜÊîØÔºåÈÇ£‰πà‰ºöË¢´ËÆ§‰∏∫ÊòØÂàáÊç¢ÂàÜÊîØÊìç‰ΩúÔºåËÄå‰∏çÊòØÊ£ÄÂá∫Êñá‰ª∂Êìç‰Ωú„ÄÇÂ¶ÇÂõæÔºöÂêåÊó∂Â≠òÂú®Êñá‰ª∂testÂíåÂàÜÊîØtest git checkout commitId ‚Äì test Ê£ÄÊü•Êüê‰∏™Êñá‰ª∂ÊüêÊ¨°Êèê‰∫§Êó∂ÁöÑÂÜÖÂÆπ„ÄÇËøô‰∏™ÂäüËÉΩÊå∫ÊúâÁî®ÁöÑÔºåÊØîÂ¶ÇÊàë‰ª¨ÂºÄÂèë‰∫ÜÂæà‰πÖÔºå‰∏≠Èó¥Êèê‰∫§‰∫ÜÂ§öÊ¨°ÔºåÁÑ∂ÂêéÂøΩÁÑ∂ÂèëÁé∞Êüê‰∏™Êñá‰ª∂‰øÆÊîπÈîô‰∫ÜÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÊääËøô‰∏™Êñá‰ª∂ÊÅ¢Â§çÂà∞‰ª•ÂâçÊüêÊ¨°Êèê‰∫§ÁöÑÁä∂ÊÄÅÔºåËÄå‰∏çÁî®‰øÆÊîπÂÖ∂‰ªñÊñá‰ª∂ÁöÑ‰øÆÊîπ„ÄÇÊóßÁöÑÊñá‰ª∂ÁâàÊú¨‰ºöÊòæÁ§∫‰∏∫„ÄåÈúÄË¶ÅÊèê‰∫§ÁöÑÊõ¥Êîπ„ÄçÔºåÂÖÅËÆ∏‰Ω†ÂõûÊªöÂà∞Êñá‰ª∂‰πãÂâçÁöÑÁâàÊú¨„ÄÇ ÂèÇËÄÉÔºöhttps://github.com/geeeeeeeeek/git-recipes/wiki/2.5-%E6%A3%80%E5%87%BA%E4%B9%8B%E5%89%8D%E7%9A%84%E6%8F%90%E4%BA%A4 git logÊ†ºÂºèÂåñLogËæìÂá∫Ôºögit log ‚Äìoneline Âè™ÊòæÁ§∫Êèê‰∫§IDÂíåÊèê‰∫§‰ø°ÊÅØÁöÑÁ¨¨‰∏ÄË°å git log ‚Äìdecorate ÂæàÂ§öÊó∂ÂÄôÔºåÁü•ÈÅìÊØè‰∏™Êèê‰∫§ÂÖ≥ËÅîÁöÑÂàÜÊîØÊàñËÄÖÊ†áÁ≠æÂæàÊúâÁî®„ÄÇ--decorate Ê†áËÆ∞ËÆ© git log ÊòæÁ§∫ÊåáÂêëËøô‰∏™Êèê‰∫§ÁöÑÊâÄÊúâÂºïÁî®ÔºàÊØîÂ¶ÇËØ¥ÂàÜÊîØ„ÄÅÊ†áÁ≠æÁ≠âÔºâ git log ‚Äìall ÊòæÁ§∫ÊâÄÊúâÂàÜÊîØÁöÑÊèê‰∫§ git log ‚Äìstat / git log -p Êèê‰æõ‰∫ÜÂæàÂ§öÈÄâÈ°πÊù•ÊòæÁ§∫‰∏§‰∏™Êèê‰∫§‰πãÈó¥ÁöÑÂ∑ÆÂºÇ„ÄÇÂÖ∂‰∏≠ÊúÄÂ∏∏Áî®ÁöÑ‰∏§‰∏™ÊòØ --stat Âíå -p„ÄÇ git shortlog ÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑ git logÔºåÂÆÉÊòØ‰∏∫ÂàõÂª∫ÂèëÂ∏ÉÂ£∞ÊòéËÆæËÆ°ÁöÑ„ÄÇÂÆÉÊääÊØè‰∏™Êèê‰∫§Êåâ‰ΩúËÄÖÂàÜÁ±ªÔºåÊòæÁ§∫Êèê‰∫§‰ø°ÊÅØÁöÑÁ¨¨‰∏ÄË°å„ÄÇËøôÊ†∑ÂèØ‰ª•ÂÆπÊòìÂú∞ÁúãÂà∞Ë∞ÅÂÅö‰∫Ü‰ªÄ‰πà„ÄÇ git log --graph ÈÄâÈ°πÁªòÂà∂‰∏Ä‰∏™ ASCII ÂõæÂÉèÊù•Â±ïÁ§∫Êèê‰∫§ÂéÜÂè≤ÁöÑÂàÜÊîØÁªìÊûÑ„ÄÇÂÆÉÁªèÂ∏∏Âíå --oneline Âíå --decorate ‰∏§‰∏™ÈÄâÈ°π‰∏ÄËµ∑‰ΩøÁî®ÔºåËøôÊ†∑‰ºöÊõ¥ÂÆπÊòìÊü•ÁúãÂì™‰∏™Êèê‰∫§Â±û‰∫éÂì™‰∏™ÂàÜÊîØÔºö git log branch_name/comitId ÊòæÁ§∫Êüê‰∏™ÂàÜÊîØÊàñËÄÖÊüê‰∏™Êèê‰∫§ÁöÑlog ËøáÊª§Êèê‰∫§ÂéÜÂè≤1234git log -3 Âè™ÊòæÁ§∫ÊúÄÊñ∞ÁöÑ3Ê¨°Êèê‰∫§git log --after="2014-7-1" --before="2014-7-4"git log --author="John"git log -- foo.py bar.py `` 1git log master..feature ÂÖ∂‰∏≠ÁöÑ master..feature ËåÉÂõ¥ÂåÖÂê´‰∫ÜÂú® feature ÂàÜÊîØËÄå‰∏çÂú® master ÂàÜÊîØ‰∏≠ÊâÄÊúâÁöÑÊèê‰∫§„ÄÇÊç¢Âè•ËØùËØ¥ÔºåËøô‰∏™ÂëΩ‰ª§ÂèØ‰ª•ÁúãÂá∫‰ªé master ÂàÜÊîØ fork Âà∞ feature ÂàÜÊîØÂêéÂèëÁîü‰∫ÜÂì™‰∫õÂèòÂåñ ËøáÊª§ÂêàÂπ∂Êèê‰∫§git log ËæìÂá∫Êó∂ÈªòËÆ§ÂåÖÊã¨ÂêàÂπ∂Êèê‰∫§„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûú‰Ω†ÁöÑÂõ¢ÈòüÈááÁî®Âº∫Âà∂ÂêàÂπ∂Á≠ñÁï•ÔºàÊÑèÊÄùÊòØ merge ‰Ω†‰øÆÊîπÁöÑ‰∏äÊ∏∏ÂàÜÊîØËÄå‰∏çÊòØÂ∞Ü‰Ω†ÁöÑÂàÜÊîØ rebase Âà∞‰∏äÊ∏∏ÂàÜÊîØÔºâÔºå‰Ω†ÁöÑÈ°πÁõÆÂéÜÂè≤‰∏≠‰ºöÊúâÂæàÂ§öÂ§ñÊù•ÁöÑÊèê‰∫§„ÄÇ ‰Ω†ÂèØ‰ª•ÈÄöËøá --no-merges Ê†áËÆ∞Êù•ÊéíÈô§Ëøô‰∫õÊèê‰∫§Ôºö 1git log --no-merges Âè¶‰∏ÄÊñπÈù¢ÔºåÂ¶ÇÊûú‰Ω†Âè™ÂØπÂêàÂπ∂Êèê‰∫§ÊÑüÂÖ¥Ë∂£Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî® --merges Ê†áËÆ∞Ôºö 1git log --merges ÂÆÉ‰ºöËøîÂõûÊâÄÊúâÂåÖÂê´‰∏§‰∏™Áà∂ËäÇÁÇπÁöÑÊèê‰∫§„ÄÇ 1git log --graph --decorate --oneline --simplify-by-decoration --all ËØ¥ÊòéÔºö ‚Äìdecorate Ê†áËÆ∞‰ºöËÆ©git logÊòæÁ§∫ÊØè‰∏™commitÁöÑÂºïÁî®(Â¶Ç:ÂàÜÊîØ„ÄÅtagÁ≠â) ‚Äìoneline ‰∏ÄË°åÊòæÁ§∫ ‚Äìsimplify-by-decoration Âè™ÊòæÁ§∫Ë¢´branchÊàñtagÂºïÁî®ÁöÑcommit ‚Äìall Ë°®Á§∫ÊòæÁ§∫ÊâÄÊúâÁöÑbranchÔºåËøôÈáå‰πüÂèØ‰ª•ÈÄâÊã©ÔºåÊØîÂ¶ÇÊàëÂè™ÊÉ≥ÊòæÁ§∫ÂàÜÊîØABCÁöÑÂÖ≥Á≥ªÔºåÂàôÂ∞Ü‚ÄìallÊõøÊç¢‰∏∫branchA branchB branchC gitÁïåÈù¢git gui gitk‰∏çÊåâÁÖßÊó∂Èó¥ÊéíÂ∫èÁöÑÊèê‰∫§ gitk -d‰∏çÊåâÁÖßÊó∂Èó¥ÊéíÂ∫èÁöÑÊèê‰∫§ ÂèÇËÄÉÔºöhttps://github.com/geeeeeeeeek/git-recipes/wiki/5.3-Git-log-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95 git rebase# git rebase -i HEAD~3 ÂØπÊúÄËøë‰∏âÊ¨°ÁöÑÊèê‰∫§ÂéÜÂè≤ËøõË°åÂèòÂü∫ ËøôÈáåÈ°∫Â∏¶ËÆ≤‰∏ãÊØèÊ¨°commitÁöÑÊÑèÊÄùÔºöÊØèÊ¨°commitÈÉΩËÆ∞ÂΩï‰∫ÜËøôÊ¨°commit(ÊàñËÄÖËøô‰∏™ÁâàÊú¨)ÊâÄÂÅöÁöÑÊõ¥ÊîπÔºåÂ¶ÇÊûúÂà†Èô§‰∫ÜÊüêÊ¨°ÁöÑcommitÔºåÈÇ£‰πàËøôÊ¨°commitÊâÄÂÅöÁöÑÊõ¥ÊîπÂ∞±‰ºö‰∏¢Â§±„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºö ÂàõÂª∫Âπ∂ÁºñÂÜôÊñá‰ª∂1.txtÁöÑÂÜÖÂÆπÔºågit add 1.txtÔºågit commit -m ‚Äòadd 1.txt and edit it‚ÄôÔºå‰∫ßÁîücommitId1 ÂàõÂª∫Âπ∂ÁºñÂÜôÊñá‰ª∂2.txtÁöÑÂÜÖÂÆπÔºågit add 2.txtÔºågit commit -m ‚Äòadd 2.txt and edit it‚ÄôÔºå‰∫ßÁîücommitId2 ‰øÆÊîπÊñá‰ª∂1.txtÁöÑÂÜÖÂÆπÔºågit commit -am ‚Äòmodify 1.txt‚ÄôÔºå‰∫ßÁîücommitId3 ÊâßË°åÂëΩ‰ª§git rebase -i HEAD~3ÔºåÂà†Èô§Ââç‰∏§Ê¨°Êèê‰∫§commitId1ÂíåcommitId2ÔºåÁªìÊûúÂ∞±ÊòØÔºö2.txtÊñá‰ª∂Áõ¥Êé•Ë¢´Âà†Èô§Ôºå‰ΩÜÊòØ1.txtÂ≠òÂú®ÂÜ≤Á™ÅÔºåÂéüÂõ†ÊòØcommitId1ÁöÑÊó∂ÂÄôÂàõÂª∫‰∫ÜÔºåÈÇ£‰πàÂà†Èô§Ëøô‰∏™commitId1ÁöÑÊó∂ÂÄôÔºåËá™ÁÑ∂‰πü‰ºöÊääËøô‰∏™Êñá‰ª∂Âà†Èô§ÔºåÂèØ‰ª•ÊòØcommitId3ÁöÑÊó∂ÂÄôÂèà‰øÆÊîπ‰∫ÜËøô‰∏™Êñá‰ª∂ÔºåËÄå‰∏îÂπ∂Ê≤°ÊúâÂà†Èô§commitId3ÔºåÂõ†Ê≠§Â≠òÂú®‰øÆÊîπ‰∫Ü‰∏Ä‰∏™Â∑≤ÁªèÂà†Èô§ÁöÑÊñá‰ª∂ÁöÑÂÜ≤Á™Å Êü•ÁúãÁä∂ÊÄÅÔºöËß£ÂÜ≥ÂäûÊ≥ïÊúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØgit rebase ‚Äìskip‰∏¢ÂºÉcommitId3ÊâÄÂÅöÁöÑ‰øÆÊîπÔºåËøôÊ†∑1.txtÊñá‰ª∂‰πüË¢´Âà†Èô§ÔºõÂè¶‰∏ÄÁßçÊòØgit add 1.txtÔºåËøôÊ†∑commitId1ÂàõÂª∫Âπ∂‰øÆÊîπÁöÑ1.txtÁöÑÂÜÖÂÆπÂíåcommitId3‰øÆÊîπÁöÑÂÜÖÂÆπÈÉΩ‰ºö‰øùÁïô‰∏ãÊù•„ÄÇ‰Ω†ÂèØ‰ª•Ê†πÊçÆÊèêÁ§∫‰ΩøÁî®ÂëΩ‰ª§git reset HEAD 1.txtÂíåÂëΩ‰ª§git rm 1.txtËß£ÂÜ≥ÂÜ≤Á™ÅÔºåÊïàÊûúÊòØÔºågit reset HEAD 1.txt‰øùÁïô‰∫ÜÊñá‰ª∂1.txt‰ª•Âèä1.txtÁöÑÂÜÖÂÆπÂú®Â∑•‰ΩúÂå∫„ÄÇgit rm 1.txtÂàôÊòØÂà†Èô§‰∫Ü1.txtÊñá‰ª∂„ÄÇ ÊâÄÊúâ‰ΩøÁî®ÂëΩ‰ª§git rebase -i HEAD~nÊó∂ÊÖéÈáç‰ΩøÁî®ÈÄâÈ°πd, drop = remove commitÔºå‰ºöÂà†Èô§Êèê‰∫§ÂéÜÂè≤ÈáåÁöÑÊñá‰ª∂‰ª•Âèä‰øÆÊîπÂÜÖÂÆπ„ÄÇ‰∫ßÁîüÁ†¥ÂùèÔºåÈô§Èùû‰Ω†Ê∏ÖÊ•ö‰Ω†Âú®ÂÅö‰ªÄ‰πà„ÄÇ ÈÄâÈ°πs, squash = use commit, but meld into previous commitÁöÑ‰ΩúÁî®ÊòØÂêàÂπ∂ÂéÜÂè≤Êèê‰∫§ÔºåÊääÂ§ö‰∏™commitIdÂêàÂπ∂‰Ωç‰∏Ä‰∏™ÔºåÂáèÂ∞ëÊó†Áî®commitIdÁöÑÊï∞Èáè„ÄÇ‰øùÁïôË¢´ÂêàÂπ∂Êèê‰∫§ÁöÑÊèê‰∫§‰ø°ÊÅØÂÜÖÂÆπ„ÄÇ ÈÄâÈ°πf, fixup = like ‚Äòsquash‚Äô, but discard this commit‚Äôs log messageÁöÑ‰ΩúÁî®ÊòØÂêàÂπ∂ÂéÜÂè≤Êèê‰∫§ÔºåÊääÂ§ö‰∏™commitIdÂêàÂπ∂‰Ωç‰∏Ä‰∏™ÔºåÂáèÂ∞ëÊó†Áî®commitIdÁöÑÊï∞Èáè„ÄÇÂíåsquashÁöÑÂå∫Âà´ÊòØÔºå‰∏ç‰øùÂ≠òË¢´ÂêàÂπ∂ÁöÑÊèê‰∫§ÁöÑÊèê‰∫§‰ø°ÊÅØÂÜÖÂÆπÔºåÁõ¥Êé•Âà†Èô§„ÄÇ Âè¶Â§ñgit rebase -i HEAD~n‰ºöÈáçÊñ∞ÂØπÊ∂âÂèäÁöÑcommitIdÂÄºËøõË°å‰øÆÊîπ git showgit show commitId ÊòæÁ§∫Êüê‰∏ÄÊ¨°Êèê‰∫§ÁöÑÂÜÖÂÆπ git diff commitId^! ÊòæÁ§∫Êüê‰∏ÄÊ¨°Êèê‰∫§ÁöÑÂÜÖÂÆπ git log -p -n Êü•ÁúãÊúÄËøënÊ¨°Êèê‰∫§ÁöÑ‰øÆÊîπ git update-refgit update-ref refs/heads/test cac0ca ‰ΩøÂàÜÊîØtestÊåáÂêëcommitId=cac0ca ÊúâÁÇπgit reset cac0caÁöÑÊïàÊûú git symbolic-refÊúâÁÇπgit checkout branch_name ÂàáÊç¢ÂàÜÊîØÁöÑÊÑüËßâ git symbolic-ref HEAD refs/heads/test ÊääHEADÈáåÁöÑÂÜÖÂÆπÂèò‰∏∫refs/heads/test git cherry-pickgit cherry-pick commitId ÊääÊüê‰∏™ÂàÜÊîØÁöÑÊüêÊ¨°Êèê‰∫§ÁöÑÂÜÖÂÆπÂêàÂπ∂Âà∞ÂΩìÂâçÂàÜÊîØ git cherry-pick -m 1 commitId ÊääÊüê‰∏™ÂàÜÊîØÁöÑÊüêÊ¨°ÂêàÂπ∂Êèê‰∫§ÁöÑÂÜÖÂÆπÂêàÂπ∂Âà∞ÂΩìÂâçÂàÜÊîØ„ÄÇÊÑèÊÄùÊòØcommitIdÊúâmergeÊìç‰ΩúÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåËØ¶ÁªÜ‰ªãÁªçÂèÇËÄÉÔºöhttps://segmentfault.com/q/1010000010185984Ôºõhttps://blog.csdn.net/zhangxiaoyang0/article/details/79299203 git rev-parsegit rev-parse ‚Äìgit-dir ÊòæÁ§∫ÁâàÊú¨Â∫ì.gitÁõÆÂΩïÊâÄÂú®‰ΩçÁΩÆgit rev-parse ‚Äìshow-toplevel ÊòæÁ§∫Â∑•‰ΩúÂå∫Ê†πÁõÆÂΩïgit rev-parse ‚Äìshow-prefix ÊâÄÂú®ÁõÆÂΩïÁõ∏ÂØπ‰∫éÂ∑•‰ΩúÂå∫Ê†πÁõÆÂΩïÁöÑÁõ∏ÂØπÁõÆÂΩïgit rev-parse ‚Äìshow-cdup ÊòæÁ§∫‰ªéÂΩìÂâçÁõÆÂΩïÂêéÈÄÄÂà∞Â∑•‰ΩúÂå∫ÁöÑÊ†πÁöÑË∫´Â∫¶ 12git rev-parse origin/ivs180926115904^&#123;commit&#125;git rev-parse ivs180926115904^&#123;commit&#125; Â¶ÇÊûú‰Ω†ÊÉ≥Áü•ÈÅìÊüê‰∏™ÂàÜÊîØÊåáÂêëÂì™‰∏™ÁâπÂÆöÁöÑ SHAÔºåÊàñËÄÖÊÉ≥Áúã‰ªª‰Ωï‰∏Ä‰∏™‰æãÂ≠ê‰∏≠Ë¢´ÁÆÄÂÜôÁöÑ SHA-1Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™Âè´ÂÅö rev-parse ÁöÑ Git Êé¢ÊµãÂ∑•ÂÖ∑„ÄÇÁÆÄÂçïÊù•ËØ¥Ôºårev-parse ÊòØ‰∏∫‰∫ÜÂ∫ïÂ±ÇÊìç‰ΩúËÄå‰∏çÊòØÊó•Â∏∏Êìç‰ΩúËÆæËÆ°ÁöÑ„ÄÇ‰∏çËøáÔºåÊúâÊó∂‰Ω†ÊÉ≥Áúã Git Áé∞Âú®Âà∞Â∫ïÂ§Ñ‰∫é‰ªÄ‰πàÁä∂ÊÄÅÊó∂ÔºåÂÆÉÂèØËÉΩ‰ºöÂæàÊúâÁî®„ÄÇËøôÈáå‰Ω†ÂèØ‰ª•ÂØπ‰Ω†ÁöÑÂàÜÊîØËøêÊâßË°å rev-parse„ÄÇ 12$ git rev-parse topic1ca82a6dff817ec66f44342007202690a93763949 git grepgit grep ‚Äìhelp git grep -in wwwÂú®ÂΩìÂâç‰ªìÂ∫ìÊâÄÊúâÊñá‰ª∂‰∏≠ÊêúÁ¥¢ÂÜÖÂÆπ‚Äòwwww‚ÄôÔºå-iË°®Á§∫ÂøΩÁï•Â§ßÂ∞èÂÜôÔºå-nË°®Á§∫ÊòæÁ§∫ÊêúÁ¥¢ÂÜÖÂÆπÊâÄÂú®ÁöÑË°å 12git ``grep` `--name-only www ÊêúÁ¥¢Âà∞ÁöÑÂÜÖÂÆπÂè™ÊòæÁ§∫Êñá‰ª∂Âêçgit ``grep` `-c www ÊòæÁ§∫ÊêúÁ¥¢Âà∞ÁöÑÂÜÖÂÆπÁöÑÂåπÈÖçÁöÑ‰∏™Êï∞ git grep www commit_id ÈíàÂØπÊüê‰∏™ÁâàÊú¨ËøõË°åÊêúÁ¥¢ 123git ``grep` `-e ÂÜÖÂÆπ1 --and/--or -e ÂÜÖÂÆπ2 Êù°‰ª∂ÊêúÁ¥¢git ``grep` `-e ÂÜÖÂÆπ1 --and \( -e ant -e ÂÜÖÂÆπ2 \)git ``grep` `--all-match -e ÂÜÖÂÆπ1 --or -e ÂÜÖÂÆπ2 --all-matchË°®Á§∫ÂÖ®ÂåπÈÖçÔºå ÂÖ®ÂåπÈÖçÂíåÊôÆÈÄöÂåπÈÖçÁöÑÂå∫Âà´Âú®‰∫éÔºåÂÖ®ÂåπÈÖçÂøÖÈ°ªÂú®ÂÖ®ÊñáÊª°Ë∂≥ÊåáÂÆöÁöÑÊù°‰ª∂„ÄÇÂ¶ÇÊûúÊòØÂÖ®ÂåπÈÖçÔºåÈÇ£‰πàÂøÖÈ°ªÂú®Êñá‰ª∂‰∏≠ÔºåÂêåÊó∂ÂÖ∑Êúâ‚ÄùÂÜÖÂÆπ1‚ÄùÂíå‚ÄùÂÜÖÂÆπ2‚ÄùÔºàÊ≤°Ë¶ÅÂêå‰∏ÄË°åÔºâ„ÄÇËÄåÊôÆÈÄöÂåπÈÖçÔºåÂè™Ë¶ÅÂú®Êñá‰ª∂‰∏≠ÂÖ∑Êúâ‚ÄùÂÜÖÂÆπ1‚ÄùÊàñËÄÖ‚ÄùÂÜÖÂÆπ2‚Äù‰∏≠ÁöÑ‰∏Ä‰∏™Âç≥ÂèØ„ÄÇ http://www.softwhy.com/article-8652-1.html git cat-file -p hash_idÊü•ÁúãÊüêÊ¨°hashÂÄºÂæóÂÜÖÂÆπ git ls-tree commit_idÊü•ÁúãÊüêÊ¨°Êèê‰∫§ÂåÖÂê´ÁöÑÂÜÖÂÆπÁöÑhashÂÄº]]></content>
      <categories>
        <category>Â∑•ÂÖ∑</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËΩØ‰ª∂Á≥ªÁªüÂø´Êç∑ÈîÆ]]></title>
    <url>%2F2017%2F11%2F08%2FMac%E7%AC%94%E8%AE%B0%E6%9C%AC%E5%BF%AB%E6%8D%B7%E9%94%AE%2F</url>
    <content type="text"><![CDATA[macÁ≥ªÁªü12Command + K Ê∏ÖÂ±èControl + C ÈÄÄÂá∫ÂëΩ‰ª§ 123456789101112131415161718‚åò Command‚áß Shift‚å• Option‚åÉ Control‚Ü©Ô∏é Return/Enter‚å´ Delete‚å¶ ÂêëÂâçÂà†Èô§ÈîÆÔºàFn+DeleteÔºâ‚Üë ‰∏äÁÆ≠Â§¥‚Üì ‰∏ãÁÆ≠Â§¥‚Üê Â∑¶ÁÆ≠Â§¥‚Üí Âè≥ÁÆ≠Â§¥‚áû Page UpÔºàFn+‚ÜëÔºâ‚áü Page DownÔºàFn+‚ÜìÔºâHome Fn + ‚ÜêEnd Fn + ‚Üí‚á• Âè≥Âà∂Ë°®Á¨¶ÔºàTabÈîÆÔºâ‚á§ Â∑¶Âà∂Ë°®Á¨¶ÔºàShift+TabÔºâ‚éã Escape (Esc) chromeÂø´Êç∑ÈîÆ(mac)12command + R Âà∑Êñ∞command shift R Âº∫Âà∂Âà∑Êñ∞]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>Âø´Êç∑ÈîÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[java ÂëΩ‰ª§]]></title>
    <url>%2F2017%2F11%2F08%2Fjava-%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[12java -jar ÂêØÂä®jarÂåÖ ÊåáÂÆöspring profilejava -jar microservice-discovery-eureka-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer1]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MacOSX10.5+Âø´Êç∑ÈîÆÊï¥ÁêÜ-ÈáçË¶Å]]></title>
    <url>%2F2017%2F11%2F05%2FMacOSX10.5%2B%E5%BF%AB%E6%8D%B7%E9%94%AE%E6%95%B4%E7%90%86-%E9%87%8D%E8%A6%81%2F</url>
    <content type="text"><![CDATA[‰ª£Á†ÅÁºñËæë(ÈáçË¶ÅÁöÑÔºå‰ºòÂÖàÁ∫ßÈ´ò)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869 1. shift ÈÖçÂêàÂ∑¶Âè≥ÈîÆÔºåÁî®‰∫éÈÄâ‰∏≠ 2. Control M ÁßªÂä®Âà∞Êã¨Âè∑ÁöÑÂºÄÂßãÁªìÊùü 3. Alter command [ ] ÁßªÂä®Âà∞‰ª£Á†ÅÂùóÁöÑÂºÄÂßãÂíåÁªìÊùü , ÂÜçÂä†‰∏äshiftÂèØ‰ª•ÈÄâ‰∏≠Â≠óÁ¨¶ 4 command Âä†‰∏äÂ∑¶Âè≥ÈîÆÔºåÁßªÂä®Âà∞Ë°åÁöÑÁªìÊùüÊàñÂºÄÂ§¥„ÄÇÂ∏¶‰∏äshiftÂèØ‰ª•ÈÄâ‰∏≠Â≠óÁ¨¶ 5 Alter Âä†‰∏äÂ∑¶Âè≥ÈîÆÔºåÁßªÂä®Âà∞‰∏ä‰∏Ä‰∏ãÊàñ‰∏ã‰∏Ä‰∏™ÂçïËØç„ÄÇÂ∏¶‰∏äshiftÂèØ‰ª•ÈÄâÊã©Â≠óÁ¨¶ Shitft command u ÂàáÊç¢Â§ßÂ∞èÂÜô alter command u ÂàáÊç¢È©ºÂ≥∞ toggle camel case command N ÁîüÊàêmapperÂèädao command alter T ÁîüÊàêtry catch‰ª£Á†ÅÂùó command L Ë∑≥Âà∞ÊåáÂÆöË°å Alt + F8 ËÆ°ÁÆóÂèòÈáèË°®ËææÂºè 1.Alt+‚¨ÜÔ∏è/‚¨áÔ∏è ---------------- ÈÄâ‰∏≠‰ª£Á†Å 2.option+shift +‚¨ÜÔ∏è/‚¨áÔ∏è -------------- ‰∏ä‰∏ãÁßªÂä®‰ª£Á†ÅË°å shitft command + ‰∏ä‰∏ãÁßªÂä®ÈÄâ‰∏≠ÁöÑ‰ª£Á†Å 3.cmd+d -------------- Â§çÂà∂ÂΩìÂâçË°åÂà∞‰∏ã‰∏ÄË°å- ‚áû Page UpÔºàFn+‚ÜëÔºâ- ‚áü Page DownÔºàFn+‚ÜìÔºâ ‰∫å ‰ª£Á†ÅÁöÑÁßªÂä® 1.Alt+‚¨ÜÔ∏è/‚¨áÔ∏è ---------------- ÈÄâ‰∏≠‰ª£Á†Å 2.option+shift +‚¨ÜÔ∏è/‚¨áÔ∏è -------------- ‰∏ä‰∏ãÁßªÂä®‰ª£Á†Å 3.cmd+d -------------- Â§çÂà∂ÂΩìÂâçË°åÂà∞‰∏ã‰∏ÄË°å 4.cmd+x -------------- Ââ™Âàá 5.ctrl+k -------------- Âà†Èô§Ë°å 6.cmd+option+l ------------- Ê†ºÂºèÂåñ‰ª£Á†Å 7.ctrl+alt+o -------------- Ê∏ÖÈô§Êó†ÊïàÁöÑÂºïÁî®ÂåÖ ‰∏â ‰ª£Á†ÅÊ≥®Èáä 1.cmd+/ --------------- ÂçïË°åÊ≥®Èáä 2.cmd+option+/ ------------- Â§öË°åÊ≥®Èáä 3.ctrl+alt+/ ------------ ‰∏∫ÊñπÊ≥ïÊàñÂèòÈáèÊ∑ªÂä†Ê≥®ÈáäËØ¥Êòé(‰∏™‰∫∫ËÆæÁΩÆÁöÑ,Â§ßÂÆ∂Ê†πÊçÆËá™Â∑±‰π†ÊÉØËá™Ë°åËÆæÁΩÆ) Âõõ ‰ª£Á†ÅÊü•Áúã 1.cmd+f ----------- Êü•Êâæ 2.cmd+r ----------- Êü•Êâæ/ÊõøÊç¢ 3.ctrl+o ----------- Êü•ÁúãËØ•Á±ª‰∏≠ÂèØ‰ª•ÈáçÂÜôÁöÑÊñπÊ≥ï 4.cmd+y ------------ Êü•ÁúãÊñπÊ≥ïÁöÑÊñπÊ≥ï‰ΩìÔºåÂú®È¢ÑËßàÊ°Ü‰∏≠ÊòæÁ§∫ 5.cmd+‚¨ÖÔ∏è/‚Üí ---------- Âø´Êç∑ÂÆö‰ΩçÂà∞Ë°åÈ¶ñÂíåË°åÂ∞æ 6.cmd+/- ----------- Â±ïÂºÄÊàñËÄÖÊäòÂè† 7.ctrl+option+h ----------- Ë∑üË∏™Êüê‰∏™ÊñπÊ≥ïË¢´Ë∞ÉÁî®ÁöÑ‰ΩçÁΩÆ 8.cmd+option_‚¨ÖÔ∏è ------------ ‰ª£Á†ÅËøîÂõû(Êü•Áúã‰πãÂâçÁúãÁöÑ‰ΩçÁΩÆ) 9.ctrl+h ----------- Êü•ÁúãÁªìÊûÑÁ±ªÂõæ 10.cmd+alt+b --------- Êü•ÁúãÂΩìÂâçÁ±ªÁöÑÂÆûÁé∞Á±ª 11.‚åòO:Âú®ÂΩìÂâçproject(‰∏Ä‰∏™projectÂèØ‰ª•Âê´Â§ö‰∏™moudle)‰∏≠ÊêúÁ¥¢class,ÂÜçÊåâ‰∏ÄÊ¨°‚åòOÔºåÊêúÁ¥¢ÁªìÊûúÂèØÂåÖÂê´Èùûproject‰∏≠ÁöÑclassÔºåÂ¶Çexternal libraries‰∏≠ÁöÑandroid.jarÈáåÁöÑclassÂèØ‰ª•Âú®ÊêúÁ¥¢ÊñáÊú¨ÂêéË∑ü:lineNumber ‰ªéËÄåÂÆö‰ΩçÂà∞ÊüêË°å. 12.‚åòO:Âú®ÂΩìÂâçproject(‰∏Ä‰∏™projectÂèØ‰ª•Âê´Â§ö‰∏™moudle)‰∏≠ÊêúÁ¥¢class,ÂÜçÊåâ‰∏ÄÊ¨°‚åòOÔºåÊêúÁ¥¢ÁªìÊûúÂèØÂåÖÂê´Èùûproject‰∏≠ÁöÑclassÔºåÂ¶Çexternal libraries‰∏≠ÁöÑandroid.jarÈáåÁöÑclassÂèØ‰ª•Âú®ÊêúÁ¥¢ÊñáÊú¨ÂêéË∑ü:lineNumber,‰ªéËÄåÂÆö‰ΩçÂà∞ÊüêË°å. 13.‚áß‚åòO:Âú®ÂΩìÂâçproject‰∏≠ÊêúÁ¥¢file(ÂåÖÂê´‰∏äÈù¢ÁöÑclassÁªìÊûú),ÂÜçÊåâ‰∏ÄÊ¨°‚áß‚åòO,ÊêúÁ¥¢ÁªìÊûúÂèØÂåÖÂê´Èùûproject‰∏≠ÁöÑflieÔºåÂ¶Çexternal libraries‰∏≠ÁöÑresÈáåÁöÑfileÂèØ‰ª•Âú®ÊêúÁ¥¢ÊñáÊú¨ÂêéË∑ü:lineNumber,‰ªéËÄåÂÆö‰ΩçÂà∞ÊüêË°å. 14.‚å•‚åòO:Âú®ÂΩìÂâçproject‰∏≠ÊêúÁ¥¢file(ÂåÖÂê´‰∏äÈù¢ÁöÑclass„ÄÅfileÁªìÊûúÂèämethod) ‰∫î ‰ª£Á†ÅÁîüÊàê 1.cmd+n Âø´Êç∑ÁîüÊàê get/setÊñπÊ≥ï ÊûÑÈÄ†Âô®Á≠â 2.cmd+j ‰ª£Á†ÅÊ®°ÊùøÁîüÊàê(if for foreach findViewById VIew.Gone Toast Á≠â) 3.cmd+t try_catch if_else for Á≠âËá™Âä®ÁîüÊàê ÂÖ≠ ÂÖ∂‰ªñ 1.cmd+shift+u ------------ Â§ßÂ∞èÂÜôÊ†ºÂºèÂåñ 2.ctrl+d ------------ debug Ë∞ÉËØïAPP 3.ctrl+r ------------ run APP 4.ctrl+v ------------ ÁâàÊú¨ÊéßÂà∂ 1.‰ª£Á†ÅÁõ∏ÂÖ≥Ôºö1.Âà†Èô§ÂΩìÂâçË°å command+delete/command+x2.Â§çÂà∂ÂΩìÂâçË°å command+d3.ÁßªÂä®ÂΩìÂâçË°å shift+command+‚Üë4.Êü•ÊâæÂèòÈáè‰ΩøÁî®ÁöÑÂú∞Êñπ alt+f75.ÁîüÊàêtry/catch‰ª£Á†Å alt+command+f76.Ë∑≥Ëá≥‰∏äÊñπ(Áà∂Á±ª)ÁöÑÂ±ÇÁ∫ß common+u7.Ë∑≥Ëá≥‰∏ãÊñπ(Â≠êÁ±ª)ÁöÑÂ±ÇÁ∫ß alt+commond+b8.Êü•ÊâæÈÄâ‰∏≠ÁöÑÂ≠óÁ¨¶Âú®Â∑•Á®ã‰∏≠Âá∫Áé∞ÁöÑÂú∞Êñπ command+alt+f79.ÈÄâ‰∏≠ÊñáÊú¨ÔºåÈ´ò‰∫ÆÊòæÁ§∫ÊâÄÊúâËØ•ÊñáÊú¨ÔºåÊåâEscÈ´ò‰∫ÆÊ∂àÂ§± command+shift+F710.Âá∫Áé∞ÁîüÊàêget,setÊñπÊ≥ïÁöÑÁïåÈù¢ ctrl+enter11.Âú®ÂΩìÂâçÊñá‰ª∂‰∏≠ÊõøÊç¢ commond+r12.Âú®Êï¥‰∏™Â∑•Á®ã‰∏≠ÊõøÊç¢ commond+shift+r13.ÊääÂ§öË°åËøûÊé•Êàê‰∏ÄË°åÔºå‰ºöÂéªÊéâÁ©∫Ê†ºÁöÑË°å control+shift+J14.ÂØºÂÖ•ÂåÖÔºåËá™Âä®‰øÆÊîπ alt+enter15.Ê†ºÂºèÂåñ‰ª£Á†Å command+alt+L16.Â§ßÂ∞èÂÜôËΩ¨Êç¢ command+shift+U17.Ê≥®Èáä/ÂèñÊ∂à‰∏ÄË°åÊàñÁùÄÂ§öË°å command+/18.Ê≥®Èáä/‚Ä¶/ÊàñÂèñÊ∂à command+alt+/19.ËøîÂõûÊúÄÂ∑¶ËæπÊúÄÂè≥Ëæπ command+Â∑¶Âè≥ÁÆ≠Â§¥20.Ë∞ÉÂá∫IDEAÁöÑÁ•ûÂô®live template commond+J21.Ë∞ÉÂá∫IDEAÂØÑÂ≠òÂô®‰∏≠‰øùÂ≠òÁöÑÊúÄËøëÂ§çÂà∂ÁöÑN‰ªΩÂÜÖÂÆπÔºåÂèØÈÄâÊã©ÊÄßÁ≤òË¥¥ shift + cmd + v22.Á•ûÂô®ÔºåË°•ÂÖ®ÂΩìÂâçË°åÔºåÊúÄÂ∏∏Áî®ÁöÑÂú∫ÊôØÊó∂Ë°•ÂÖ®ÂΩìÂâçË°åÂêéÁöÑÔºõÂè∑ÔºåÂπ∂Â∞ÜÂÖâÊ†áÂÆö‰ΩçÂà∞‰∏ã‰∏ÄË°å shift + cmd + enter 2.Êñá‰ª∂Áõ∏ÂÖ≥Ôºö1.Êü•ÊâæÊñá‰ª∂ shift+shift2.ÊòæÁ§∫ÂΩìÂâçÊñá‰ª∂ÁöÑÁªìÊûÑ Cmd+F123.Ë∑≥ËΩ¨Âà∞ÂØºËà™Ê†èÔºåÊü•ÁúãÈ°πÁõÆÊ†ë Cmd+Âêë‰∏äÈîÆ4.Êü•ÁúãÊúâÂÖ≥ÊâÄÊúâÂÆûÁé∞ÊàñËÄÖË¶ÜÂÜô‰∫ÜÂΩìÂâçÊñπÊ≥ïÁöÑÁ±ªÁöÑÁªìÊûÑÂõæ shift+commond+h5.ÊúÄËøëÁºñËæëËøáÁöÑÊñá‰ª∂ shift+commond+e6.ÊòæÁ§∫ÊúÄËøëÊâìÂºÄÁöÑÊñá‰ª∂ command + E7.Ê∑ªÂä†‰π¶Á≠æ F38.ÊòæÁ§∫‰π¶Á≠æ command + F3 9.ÁßªÂä®Êñá‰ª∂Âà∞ÂÖ∂ÂÆÉÂú∞Êñπ F610.Êã∑Ë¥ùÊñá‰ª∂Âà∞ÂÖ∂ÂÆÉÂú∞Êñπ F511.Êñ∞Âª∫Êñá‰ª∂ÔºàÈÄâ‰∏≠Ê†πÁõÆÂΩïÔºâ commond+N12.ÈÄâ‰∏≠Êñá‰ª∂Êù•ÈáçÂëΩÂêç shift+f6 3.ÁïåÈù¢Á™óÂè£Áõ∏ÂÖ≥Ôºö1.ÈöêËóèÂΩìÂâçËßÜÂõæ shift Ôºã esc2.Ë∞ÉÂá∫settingÁïåÈù¢ cmd + ,3.Ë∞ÉÂá∫È°πÁõÆsettingÁïåÈù¢ cmd + ;4.ÂÖ≥Èó≠ÂΩìÂâçÊñá‰ª∂ commond+w5.ÈÄÄÂá∫Idea commond+Q6.‰∏áËÉΩÂø´Êç∑ÈîÆÔºöshift + command + AÔºàÈÄÇÁî®‰∫é‰∏çÁü•ÈÅìÂø´Êç∑ÈîÆÔºå‰ΩÜÊòØÁü•ÈÅìÊìç‰ΩúÁöÑÈÉ®ÂàÜÂä®‰Ωú„ÄÇÂ¶ÇÔºåËæìÂÖ•‚Äùopen‚Äù‰ºöÂàóÂá∫‰∏ÄÁ≥ªÂàóÂíåÊâìÂºÄÁõ∏ÂÖ≥ÁöÑÊìç‰Ωú„ÄÇÔºâ mac ÈîÆÁõòÁ¨¶Âè∑ ‚åò Command ‚áß Shift ‚å• Option ‚åÉ Control ‚Ü©Ô∏é Return/Enter ‚å´ Delete ‚å¶ ÂêëÂâçÂà†Èô§ÈîÆÔºàFn+DeleteÔºâ ‚Üë ‰∏äÁÆ≠Â§¥ ‚Üì ‰∏ãÁÆ≠Â§¥ ‚Üê Â∑¶ÁÆ≠Â§¥ ‚Üí Âè≥ÁÆ≠Â§¥ ‚áû Page UpÔºàFn+‚ÜëÔºâ ‚áü Page DownÔºàFn+‚ÜìÔºâ Home Fn + ‚Üê End Fn + ‚Üí ‚á• Âè≥Âà∂Ë°®Á¨¶ÔºàTabÈîÆÔºâ ‚á§ Â∑¶Âà∂Ë°®Á¨¶ÔºàShift+TabÔºâ ‚éã Escape (Esc)]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>Âø´Êç∑ÈîÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mac chrome Âø´Êç∑ÈîÆ]]></title>
    <url>%2F2017%2F08%2F29%2Fmac-chrome%E5%BF%AB%E6%8D%B7%E9%94%AE%2F</url>
    <content type="text"><![CDATA[12345678910111213141516‚åò-Shift-J ÊâìÂºÄ‚Äú‰∏ãËΩΩÂÜÖÂÆπ‚ÄùÈ°µ„ÄÇ‚åò-Shift-Delete ÊâìÂºÄ‚ÄúÊ∏ÖÈô§ÊµèËßàÊï∞ÊçÆ‚ÄùÂØπËØùÊ°Ü„ÄÇ‚åò-R ÈáçÊñ∞ËΩΩÂÖ•ÂΩìÂâçÁΩëÈ°µ„ÄÇ‚åò-, ÂÅúÊ≠¢ËΩΩÂÖ•ÂΩìÂâçÁΩëÈ°µ„ÄÇ‚åò-Option-I ÊâìÂºÄ‚ÄúÂºÄÂèë‰∫∫ÂëòÂ∑•ÂÖ∑‚Äù„ÄÇ‚åò-Option-J ÊâìÂºÄ‚ÄúJavaScript ÊéßÂà∂Âè∞‚Äù„ÄÇ‚åò-Option-U ÊâìÂºÄÂΩìÂâçÁΩëÈ°µÁöÑÊ∫ê‰ª£Á†Å„ÄÇ‚åò-D Â∞ÜÂΩìÂâçÁΩëÈ°µ‰øùÂ≠ò‰∏∫‰π¶Á≠æ„ÄÇ‚åò-Shift-D Â∞ÜÊâÄÊúâÊâìÂºÄÁöÑÊ†áÁ≠æÈ°µ‰ª•‰π¶Á≠æÁöÑÂΩ¢Âºè‰øùÂ≠òÂú®Êñ∞Êñá‰ª∂Â§π‰∏≠„ÄÇ‚åò-Shift-F Âú®ÂÖ®Â±èÊ®°Âºè‰∏ãÊâìÂºÄÁΩëÈ°µ„ÄÇÂÜçÊåâ‰∏ÄÊ¨° ‚åò-Shift-F ÂèØÈÄÄÂá∫ÂÖ®Â±èÊ®°Âºè„ÄÇ‚åò-+ ÊîæÂ§ßÁΩëÈ°µ‰∏äÁöÑÊâÄÊúâÂÜÖÂÆπ„ÄÇ‚åò Âíå - Áº©Â∞èÁΩëÈ°µ‰∏äÁöÑÊâÄÊúâÂÜÖÂÆπ„ÄÇ‚åò-0 Â∞ÜÁΩëÈ°µ‰∏äÁöÑÊâÄÊúâÂÜÖÂÆπÊÅ¢Â§çÂà∞Ê≠£Â∏∏Â§ßÂ∞è„ÄÇ‚åò-Shift-H Âú®ÂΩìÂâçÊ†áÁ≠æÈ°µ‰∏≠ÊâìÂºÄ‰∏ªÈ°µ„ÄÇÁ©∫Ê†ºÈîÆ Âêë‰∏ãÊªöÂä®ÁΩëÈ°µ„ÄÇ‚åò-Option-F ÊêúÁ¥¢ÁΩëÈ°µ„ÄÇ]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>Âø´Êç∑ÈîÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AngularJS ÊïôÁ®ã]]></title>
    <url>%2F2017%2F08%2F23%2FAngularJS%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[Êñ∞Âª∫ÂâçÁ´ØÈ°πÁõÆ1234567891011121314cnpm install -g @angular/cliwebstrom new empty project 601 ng new demo --skip-install --style=sass --routing 604 ls 605 cd demo 606 ls 608 cnpm install 609 ls 611 ng serve 612 ls 613 cd demo 614 ls 615 ng serve Â∏∏Áî®Êåá‰ª§12345ng-app Êåá‰ª§ÂàùÂßãÂåñ‰∏Ä‰∏™ AngularJS Â∫îÁî®Á®ãÂ∫è„ÄÇng-init Êåá‰ª§ÂàùÂßãÂåñÂ∫îÁî®Á®ãÂ∫èÊï∞ÊçÆ„ÄÇng-model Êåá‰ª§ÊääÂÖÉÁ¥†ÂÄºÔºàÊØîÂ¶ÇËæìÂÖ•ÂüüÁöÑÂÄºÔºâÁªëÂÆöÂà∞Â∫îÁî®Á®ãÂ∫è„ÄÇ&#123;&#123;4*5&#125;&#125; Ë°®ËææÂºèng-repeat ÈáçÂ§çÂÖÉÁ¥† Ëá™ÂÆö‰πâÊåá‰ª§‰ΩøÁî®È©ºÂ≥∞Ê≥ïÊù•ÂëΩÂêç‰∏Ä‰∏™Êåá‰ª§Ôºå ‰ΩÜÂú®‰ΩøÁî®ÂÆÉÊó∂ÈúÄË¶Å‰ª• - ÂàÜÂâ≤ 123456789101112131415161718&lt;runoob-directive&gt;&lt;/runoob-directive&gt;&lt;script&gt;var app = angular.module("myApp", []);app.directive("runoobDirective", function() &#123; return &#123; restrict : "A", template : "&lt;h1&gt;Ëá™ÂÆö‰πâÊåá‰ª§!&lt;/h1&gt;" &#125;;&#125;);&lt;/script&gt;restrict ÂÄºÂèØ‰ª•ÊòØ‰ª•‰∏ãÂá†Áßç:E ‰Ωú‰∏∫ÂÖÉÁ¥†Âêç‰ΩøÁî®A ‰Ωú‰∏∫Â±ûÊÄß‰ΩøÁî®C ‰Ωú‰∏∫Á±ªÂêç‰ΩøÁî®M ‰Ωú‰∏∫Ê≥®Èáä‰ΩøÁî®restrict ÈªòËÆ§ÂÄº‰∏∫ EA, Âç≥ÂèØ‰ª•ÈÄöËøáÂÖÉÁ¥†ÂêçÂíåÂ±ûÊÄßÂêçÊù•Ë∞ÉÁî®Êåá‰ª§„ÄÇ]]></content>
      <tags>
        <tag>AngularJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Sublime macÂø´Êç∑ÈîÆ]]></title>
    <url>%2F2017%2F08%2F16%2FSublime%E5%BF%AB%E6%8D%B7%E9%94%AE%2F</url>
    <content type="text"><![CDATA[json format 1cmd+ctrl+j package install 123Êåâ‰∏ãCTRL + SHIFT + PÂπ∂‰∏îËæìÂÖ•Package Control: Install PackageÂÜçËæìÂÖ•Pretty JSONÔºåÊåâ‰∏ãENTERÂÆåÊàêÂÆâË£ù Êü•ÊâæÊñá‰ª∂Âêç 1cmd + P]]></content>
      <categories>
        <category>ËøêÁª¥</category>
      </categories>
      <tags>
        <tag>Âø´Êç∑ÈîÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊéíÂ∫èÁÆóÊ≥ïÁõ∏ÂÖ≥(java)]]></title>
    <url>%2F2017%2F08%2F10%2F%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3(java)%2F</url>
    <content type="text"><![CDATA[Â∏∏ËßÅÁöÑÂÜÖÈÉ®ÊéíÂ∫èÁÆóÊ≥ïÊèíÂÖ•ÊéíÂ∫è„ÄÅÂ∏åÂ∞îÊéíÂ∫è„ÄÅÈÄâÊã©ÊéíÂ∫è„ÄÅÂÜíÊ≥°ÊéíÂ∫è„ÄÅÂΩíÂπ∂ÊéíÂ∫è„ÄÅÂø´ÈÄüÊéíÂ∫è„ÄÅÂ†ÜÊéíÂ∫è„ÄÅÂü∫Êï∞ÊéíÂ∫èÁ≠â123456789101112131415161718192021public class SortingDemo &#123; public static void main(String[] args) &#123; /* ÁÆÄÂçïÊéíÂ∫è */ EasySort.bubbleList();// ÂÜíÊ≥° EasySort.bubbleArray();// ÂÜíÊ≥° EasySort.xuanze();// ÈÄâÊã© EasySort.charu();// ÊèíÂÖ• /* È´òÊïàÊéíÂ∫è */ QuickSort.quickSort();// Âø´Êéí MergeSort.mergeSort();// ÂΩíÂπ∂ÊéíÂ∫è(ÂàÜÊ≤ªÈÄíÂΩíÊÄùÊÉ≥) ShellSort.shellSort();// Â∏åÂ∞îÊéíÂ∫è(ÊèíÂÖ•ÊéíÂ∫èÁöÑ‰∏ÄÁßçÈ´òÊïàÁéáÁöÑÂÆûÁé∞Ôºå‰πüÂè´Áº©Â∞èÂ¢ûÈáèÊéíÂ∫è) // Â†ÜÊéíÂ∫è(ÂçáÂ∫èÊéíÂ∫èÂ∞±‰ΩøÁî®Â§ßÈ°∂Â†ÜÔºåÂèç‰πã‰ΩøÁî®Â∞èÈ°∂Â†Ü) /* Á∫øÊÄßÊéíÂ∫è */ // ËÆ°Êï∞ÊéíÂ∫è // Ê°∂ÊéíÂ∫è // Âü∫Êï∞ÊéíÂ∫è &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116/*** ÁÆÄÂçïÊéíÂ∫è*/class EasySort &#123; /** * ÂÜíÊ≥°ÊéíÂ∫è List * &lt;p&gt; * ÁÆóÊ≥ïÊÄùÊÉ≥ÔºöÈÅçÂéÜÂæÖÊéíÂ∫èÁöÑÊï∞ÁªÑÔºåÊØèÊ¨°ÈÅçÂéÜÊØîËæÉÁõ∏ÈÇªÁöÑ‰∏§‰∏™ÂÖÉÁ¥†ÔºåÂ¶ÇÊûú‰ªñ‰ª¨ÁöÑÊéíÂàóÈ°∫Â∫èÈîôËØØÂ∞±‰∫§Êç¢‰ªñ‰ª¨ÁöÑ‰ΩçÁΩÆÔºå * ÁªèËøá‰∏ÄË∂üÊéíÂ∫èÂêéÔºåÊúÄÂ§ßÁöÑÂÖÉÁ¥†‰ºöÊµÆÁΩÆÊï∞ÁªÑÁöÑÊú´Á´Ø„ÄÇÈáçÂ§çÊìç‰ΩúÔºåÁõ¥Âà∞ÊéíÂ∫èÂÆåÊàê„ÄÇ */ static void bubbleList() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± System.out.println(list); for (int i = 0; i &lt; list.size(); i++) &#123; for (int j = 0; j &lt; list.size() - 1 - i; j++) &#123; int current = list.get(j); int comp = list.get(j + 1); if (current &gt; comp) &#123; int temp = list.get(j + 1); list.set(j + 1, list.get(j)); list.set(j, temp); &#125; &#125; System.out.println(list); &#125; &#125; /** * ÂÜíÊ≥°ÊéíÂ∫è Array (Âæ™ÁéØÊúÄÂ§ßÂÄºÁΩÆÈ°∂) * &lt;p&gt; * ÁÆóÊ≥ïÊÄùÊÉ≥ÔºöÈÅçÂéÜÂæÖÊéíÂ∫èÁöÑÊï∞ÁªÑÔºåÊØèÊ¨°ÈÅçÂéÜÊØîËæÉÁõ∏ÈÇªÁöÑ‰∏§‰∏™ÂÖÉÁ¥†ÔºåÂ¶ÇÊûú‰ªñ‰ª¨ÁöÑÊéíÂàóÈ°∫Â∫èÈîôËØØÂ∞±‰∫§Êç¢‰ªñ‰ª¨ÁöÑ‰ΩçÁΩÆÔºå * ÁªèËøá‰∏ÄË∂üÊéíÂ∫èÂêéÔºåÊúÄÂ§ßÁöÑÂÖÉÁ¥†‰ºöÊµÆÁΩÆÊï∞ÁªÑÁöÑÊú´Á´Ø„ÄÇÈáçÂ§çÊìç‰ΩúÔºåÁõ¥Âà∞ÊéíÂ∫èÂÆåÊàê„ÄÇ */ static void bubbleArray() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± Integer[] values = (Integer[]) list.toArray(); System.out.println(Arrays.asList(values)); for (int i = 0; i &lt; values.length; i++) &#123; for (int j = 0; j &lt; values.length - 1 - i; j++) &#123; int current = values[j]; int comp = values[j + 1]; if (current &gt; comp) &#123; int temp = values[j + 1]; values[j + 1] = values[j]; values[j] = temp; &#125; &#125; System.out.println(Arrays.asList(values)); &#125; &#125; /** * ÈÄâÊã©ÊéíÂ∫è * &lt;p&gt; * ÁÆóÊ≥ïÊÄùÊÉ≥ÔºöÈáçÂæÖÊéíÂ∫èÁöÑÊï∞ÁªÑ‰∏≠ÈÄâÊã©‰∏Ä‰∏™ÊúÄÂ∞èÁöÑÂÖÉÁ¥†ÔºåÂ∞ÜÂÆÉ‰∏éÊï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™‰ΩçÁΩÆÁöÑÂÖÉÁ¥†‰∫§Êç¢‰ΩçÁΩÆ„ÄÇ * ÁÑ∂Âêé‰ªéÂâ©‰∏ãÁöÑÂÖÉÁ¥†‰∏≠ÈÄâÊã©‰∏Ä‰∏™ÊúÄÂ∞èÁöÑÂÖÉÁ¥†ÔºåÂ∞ÜÂÆÉ‰∏éÁ¨¨‰∫å‰∏™‰ΩçÁΩÆÁöÑÂÖÉÁ¥†‰∫§Êç¢‰ΩçÁΩÆÔºå * Â¶ÇÊûúÊúÄÂ∞èÂÖÉÁ¥†Â∞±ÊòØËØ•‰ΩçÁΩÆÁöÑÂÖÉÁ¥†ÔºåÂ∞±Â∞ÜÂÆÉÂíåËá™Ë∫´‰∫§Êç¢‰ΩçÁΩÆÔºå‰æùÊ¨°Á±ªÊé®ÔºåÁõ¥Âà∞ÊéíÂ∫èÂÆåÊàê„ÄÇ */ static void xuanze() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± Integer[] values = (Integer[]) list.toArray(); System.out.println(Arrays.asList(values)); Integer[] array = values; for (int i = 0; i &lt; values.length; i++) &#123; int courrentMinIndex = i;// ÂΩìÂâçÊúÄÂ∞èÂÄº‰∏ãÊ†á // ‰ªéÂΩìÂâç‰∏ãÊ†áÂà∞ÊúÄÂêéÁöÑËåÉÂõ¥,ÊâæÂá∫ÊúÄÂ∞èÁöÑÂÄº for (int j = i + 1; j &lt; values.length; j++) &#123; if (values[j] &lt; values[courrentMinIndex]) &#123; courrentMinIndex = j; &#125; &#125; // ÂΩìÂâç‰Ωç‰∏éÊúÄÂ∞èÂÄº‰Ωç‰∫§Êç¢ int temp = values[i]; values[i] = values[courrentMinIndex]; values[courrentMinIndex] = temp; System.out.println(Arrays.asList(array)); &#125; &#125; /** * ÊèíÂÖ•ÊéíÂ∫è(‰ºòÂÖà‰øùÈöúcurrentIndexÂâçÁΩÆÊúâÂ∫è) * &lt;p&gt; * ÁÆóÊ≥ïÊÄùÊÉ≥:‰ªéÊï∞ÁªÑÁöÑÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÂºÄÂßãÈÅçÂéÜÔºåÂ∞ÜËØ•ÂÖÉÁ¥†‰∏éÂâçÈù¢ÁöÑÂÖÉÁ¥†ÊØîËæÉÔºåÂ¶ÇÊûúËØ•ÂÖÉÁ¥†ÊØîÂâçÈù¢ÁöÑÂÖÉÁ¥†Â∞èÔºå * Â∞ÜËØ•ÂÖÉÁ¥†‰øùÂ≠òËøõ‰∏¥Êó∂ÂèòÈáè‰∏≠Ôºå‰æùÊ¨°Â∞ÜÂâçÈù¢ÁöÑÂÖÉÁ¥†ÂêéÁßªÔºåÁÑ∂ÂêéÂ∞ÜËØ•ÂÖÉÁ¥†ÊèíÂÖ•Âà∞ÂêàÈÄÇÁöÑ‰ΩçÁΩÆ„ÄÇ * ÊØèÊ¨°ÊéíÂ∫èÂÆåÊàêÂêéÔºåÁ¥¢ÂºïÂ∑¶ËæπÁöÑÂÖÉÁ¥†‰∏ÄÂÆöÊòØÊúâÂ∫èÁöÑÔºå‰ΩÜÊòØËøòÂèØ‰ª•ÁßªÂä®„ÄÇÂØπ‰∫éÂÄíÁΩÆË∂äÂ∞ëÁöÑÊï∞ÁªÑÔºåËØ•ÁÆóÊ≥ïÁöÑÊéíÂ∫èÊïàÁéáË∂äÈ´ò„ÄÇ */ static void charu() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± Integer[] values = (Integer[]) list.toArray(); System.out.println(Arrays.asList(values)); for (int i = 1; i &lt; values.length; i++) &#123; for (int j = 0; j &lt; i; j++) &#123; int current = values[i]; int comp = values[j]; if (current &lt; comp) &#123; int third = values[i]; values[i] = values[j]; values[j] = third; &#125; &#125; System.out.println(Arrays.asList(values)); &#125; &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110/*** Âø´ÈÄüÊéíÂ∫è*/class QuickSort &#123; /** * Âø´ÈÄüÊéíÂ∫èÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÔºöÈÄöËøá‰∏ÄË∂üÊéíÂ∫èÂ∞ÜÂæÖÊéíÂ∫èËÆ∞ÂΩïÂàÜÂâ≤ÊàêÁã¨Á´ãÁöÑ‰∏§ÈÉ®ÂàÜÔºåÂÖ∂‰∏≠‰∏ÄÈÉ®ÂàÜËÆ∞ÂΩïÁöÑÂÖ≥ÈîÆÂ≠óÂùáÊØîÂè¶‰∏ÄÈÉ®ÂàÜÂÖ≥ÈîÆÂ≠óÂ∞èÔºå * ÂàôÂàÜÂà´ÂØπËøô‰∏§ÈÉ®ÂàÜÁªßÁª≠ËøõË°åÊéíÂ∫èÔºåÁõ¥Âà∞Êï¥‰∏™Â∫èÂàóÊúâÂ∫è„ÄÇ */ static void quickSort() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± System.out.println("======(ÂàÜÂå∫)"); Integer[] values = (Integer[]) list.toArray(); System.out.println(Arrays.asList(values)); quickSortEasy(values, 0, values.length - 1); System.out.println("======(‰∫§Êç¢)"); values = (Integer[]) list.toArray(); System.out.println(Arrays.asList(values)); quickSortSwap(values, 0, values.length - 1); &#125; /** * ÂàÜÊ≤ªÊ≥ï-ÂàÜÂå∫(Êñπ‰æøÁêÜËß£) * * @param values * @param begin * @param end */ static void quickSortEasy(Integer[] values, int begin, int end) &#123; if (begin &gt;= end) return; int middleIndex = quickSortMiddleEasy(values, begin, end); System.out.printf("begin:%d end:%d middleIndex:%d(value=%d) %n", begin, end, middleIndex, values[middleIndex]); System.out.println(Arrays.asList(values));// ÂÆö‰Ωç‰∏≠‰ΩçÊï∞Êó∂,Â∑≤ÁªèÂÆåÊàêÂàÜÊ≤ª quickSortEasy(values, begin, middleIndex - 1); quickSortEasy(values, middleIndex + 1, end); &#125; static int quickSortMiddleEasy(Integer[] values, int begin, int end) &#123; // Á¨¨‰∏ÄÊ≠•,‰ª•ÊúÄ‰Ωé‰ΩçÂÄº‰Ωú‰∏∫‰∏≠ËΩ¥,Â∞ÜÂÖ∂ÂÆÉÊï∞ËøõË°å‰∏§ËæπÂàÜÊ≤ªÊ≥ï.ÁªìÊùüÂêé,‰∏≠ËΩ¥‰Ωç‰∏çÂÜçÂèÇ‰∏éÂêéÁª≠ÊéíÂ∫è(Âõ†‰∏∫‰ΩçÁΩÆÂ∑≤ÁªèÁ°ÆÂÆö‰∫Ü) // Á§∫‰æã:[6, 2, 1, 8, 5, 4, 9, 3, 7]‰∏≠ËΩ¥ÂÄº‰∏∫6,ÂàÜÊ≤ªÊ≥ïÁªìÊûú[32145]6[987](‰∫§Êç¢)/[21543]6[897](ÂàÜÂå∫) int middleValue = values[begin]; // Á¨¨‰∫åÊ≠•,ÂàÜÊ≤ªÊ≥ï.ÂÖàËÖæÂá∫‰∏≠ËΩ¥ÂÄº‰ΩçÁΩÆ[0],Âπ∂‰øùÊåÅ‰∏≠ËΩ¥ÂÄº. List&lt;Integer&gt; left = new ArrayList&lt;&gt;(); List&lt;Integer&gt; right = new ArrayList&lt;&gt;(); left.addAll(Arrays.asList(Arrays.copyOfRange(values, 0, begin)));// ÊéíÂ∫èÂå∫Èó¥Ââç for (int i = begin; i &lt; end + 1; i++) &#123; if (values[i] &lt; middleValue) &#123; left.add(values[i]); // ÊéíÂ∫èÂå∫Èó¥Â∑¶Âå∫ &#125; else if (values[i] &gt; middleValue) &#123; right.add(values[i]);// ÊéíÂ∫èÂå∫Èó¥Âè≥Âå∫ &#125; &#125; left.add(middleValue);// ÊéíÂ∫èÂå∫Èó¥‰∏≠ËΩ¥ int middleIndex = left.size() - 1; left.addAll(right);// ÊéíÂ∫èÂå∫Èó¥Âè≥Âå∫‰πüÂêàÂπ∂Âà∞Âçï‰∏™ÈõÜÂêà left.addAll(Arrays.asList(Arrays.copyOfRange(values, end + 1, values.length)));// ÊéíÂ∫èÂå∫Èó¥Âêé values = left.toArray(values);// ÈáçÂÜôÂéüÊï∞ÁªÑ return middleIndex; &#125; /** * ÂàÜÊ≤ªÊ≥ï-‰∫§Êç¢(ËäÇÁúÅÂÜÖÂ≠òÁ©∫Èó¥) * @param values * @param begin * @param end */ static void quickSortSwap(Integer[] values, int begin, int end) &#123; if (begin &gt;= end) return; int middleIndex = getMiddle(values, begin, end); System.out.printf("begin:%d end:%d middleIndex:%d(value=%d) %n", begin, end, middleIndex, values[middleIndex]); System.out.println(Arrays.asList(values));// ÂÆö‰Ωç‰∏≠‰ΩçÊï∞Êó∂,Â∑≤ÁªèÂÆåÊàêÂàÜÊ≤ª quickSortSwap(values, begin, middleIndex - 1); quickSortSwap(values, middleIndex + 1, end); &#125; public static int getMiddle(Integer[] numbers, int low, int high) &#123; // Á§∫‰æã:[6, 2, 1, 8, 5, 4, 9, 3, 7]‰∏≠ËΩ¥ÂÄº‰∏∫6,ÂàÜÊ≤ªÊ≥ïÁªìÊûú[32145]6[987](‰∫§Êç¢)/[21543]6[897](ÂàÜÂå∫) int temp = numbers[low]; // Êï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™‰Ωú‰∏∫‰∏≠ËΩ¥ numbers[low] = null;// Âéü‰ΩçÁΩÆÂÄºÂ∑≤ÁªèËΩ¨Áßª,Êú™Êù•‰πü‰ºöË¢´ÂàÜÊ≤ªÊ≥ïÁöÑÊñ∞ÂÄºË¶ÜÁõñ,ÂèØÁúÅÁï•.‰ΩÜÊ†áËÆ∞null,Êñπ‰æøÁêÜËß£ while (low &lt; high) &#123; while (low &lt; high &amp;&amp; numbers[high] &gt; temp) &#123;// ÂÖàÊúÄÈ´ò‰Ωç‰∏é‰∏≠ËΩ¥ÂÄºÊØîËæÉ high--; &#125; numbers[low] = numbers[high];// ÊØî‰∏≠ËΩ¥Â∞èÁöÑËÆ∞ÂΩïÁßªÂà∞‰ΩéÁ´Ø numbers[high] = null;// Âéü‰ΩçÁΩÆÂÄºÂ∑≤ÁªèËΩ¨Áßª,Êú™Êù•‰πü‰ºöË¢´ÂàÜÊ≤ªÊ≥ïÁöÑÊñ∞ÂÄºË¶ÜÁõñ,ÂèØÁúÅÁï•.‰ΩÜÊ†áËÆ∞null,Êñπ‰æøÁêÜËß£ while (low &lt; high &amp;&amp; numbers[low] &lt; temp) &#123; low++; &#125; numbers[high] = numbers[low]; //ÊØî‰∏≠ËΩ¥Â§ßÁöÑËÆ∞ÂΩïÁßªÂà∞È´òÁ´Ø numbers[low] = null;// Âéü‰ΩçÁΩÆÂÄºÂ∑≤ÁªèËΩ¨Áßª,Êú™Êù•‰πü‰ºöË¢´ÂàÜÊ≤ªÊ≥ïÁöÑÊñ∞ÂÄºË¶ÜÁõñ,ÂèØÁúÅÁï•.‰ΩÜÊ†áËÆ∞null,Êñπ‰æøÁêÜËß£ &#125; numbers[low] = temp; //‰∏≠ËΩ¥ËÆ∞ÂΩïÂà∞Â∞æ return low; // ËøîÂõû‰∏≠ËΩ¥ÁöÑ‰ΩçÁΩÆ &#125;&#125; ÂΩíÂπ∂ÊéíÂ∫è Âü∫Êú¨ÊÄùÊÉ≥:ÂÖàÈÄíÂΩíÂàíÂàÜÂ≠êÈóÆÈ¢òÔºåÁÑ∂ÂêéÂêàÂπ∂ÁªìÊûú„ÄÇÊääÂæÖÊéíÂ∫èÂàóÁúãÊàêÁî±‰∏§‰∏™ÊúâÂ∫èÁöÑÂ≠êÂ∫èÂàóÔºåÁÑ∂ÂêéÂêàÂπ∂‰∏§‰∏™Â≠êÂ∫èÂàóÔºåÁÑ∂ÂêéÊääÂ≠êÂ∫èÂàóÁúãÊàêÁî±‰∏§‰∏™ÊúâÂ∫èÂ∫èÂàó„ÄÇÂÄíÁùÄÊù•ÁúãÔºåÂÖ∂ÂÆûÂ∞±ÊòØÂÖà‰∏§‰∏§ÂêàÂπ∂ÔºåÁÑ∂ÂêéÂõõÂõõÂêàÂπ∂ÔºåÊúÄÁªàÂΩ¢ÊàêÊúâÂ∫èÂ∫èÂàó„ÄÇ ÂÅöÊ≥ï(Âª∫ËÆÆsublime‰∏≠ÁºñËæë,Êñπ‰æøÁ¨¶Âè∑ÂØπÂÖ∂):123int mid = (beginIndex + endIndex) / 2;// Âèñ‰∏≠‰ΩçindexmiddleSort(values, beginIndex, mid);// Â∑¶‰æßÈÄíÂΩíÂÜçÂàÜ,Âà∞‰∏çÂèØÂÜçÂàÜmiddleSort(values, mid + 1, endIndex);// Âè≥‰æßÈÄíÂΩíÂÜçÂàÜ,Âà∞‰∏çÂèØÂÜçÂàÜ 1234567897, 6, 5, 2, 1, 3, 4, 9, 8- - - - - - - - -8- - - - -4- - -2- -1 - -3 - - - -7 - -5 - -6 ÊØîËæÉ‰∫§Êç¢,ÊñπÊ≥ï‰∏Ä:midÂ∑¶‰æßÁ¨¨‰∏Ä‰ΩçÂºÄÂßã‰∏émidÂè≥‰æßÁ¨¨‰∏Ä‰ΩçÂºÄÂßãÊØîËæÉ,Â∞èÁöÑÊ∑ªÂä†Âà∞Êñ∞array.ÊúÄÂêéÂÜçÊåâÂå∫Èó¥Êõ¥Êñ∞ÂéüarrayÂ¶Ç:[5, 6, 7, 1, 2](‰∏≠‰ΩçÊï∞‰∏§‰æß‰∫ãÂâçÂ∑≤ÁªèÁªèËøáÊéíÂ∫è)‰ºöÊãÜ‰Ωç[5,6,7][1,2](ËøõË°åÂêàÂπ∂)5&lt;&gt;1 =&gt; 1(Â∞è) tempArray=[1]5&lt;&gt;2 =&gt; 2(Â∞è) tempArray=[1,2]ÊääÊ≤°ÊúâÂà∞tempArrayÁöÑÂ§ßÂÄºÊ∑ªÂä†ËøõÂéª: tempArray=[1,2,5,6,7] ËßÅ: ‚òÖÈù¢ËØï‰∏≠ÁöÑÊéíÂ∫èÁÆóÊ≥ïÊÄªÁªì - ÁÆÄ‰π¶ - ÂΩíÂπ∂ÊéíÂ∫è`http://www.jianshu.com/p/c360a58db21d ÊØîËæÉ‰∫§Êç¢,ÊñπÊ≥ï‰∫å(Êé®Ëçê): ÂØπÂæÖÂêàÂπ∂Êï∞ÊçÆ[5, 6, 7][1, 2]Áõ¥Êé•‰ªÖÈúÄÊèíÂÖ•ÊéíÂ∫è.123456789101112// ÂæÖÂêàÂπ∂ÁöÑ‰∫åÂàÜÊï∞ÊçÆ,Â∑≤ÁªèÂü∫Êú¨ÊúâÂ∫è,ÊâÄÊúâ‰ΩøÁî®`ÊèíÂÖ•ÊéíÂ∫è`ËøõË°åÂêàÂπ∂,ÂÖ∑Â§áÊõ¥È´òÁöÑÊÄßËÉΩ(Âõ†‰∏∫ÁßªÂä®ÁöÑ‰ΩçÁΩÆËæÉÂ∞ë)‰∏î‰∏çÈúÄË¶ÅÊõ¥Â§öÁöÑÂÜÖÂ≠ò‰ªÖÈúÄ‰∏Ä‰∏™‰∫§Êç¢ÂèòÈáè.for (int i = beginIndex + 1; i &lt; endIndex; i++) &#123; for (int j = beginIndex; j &lt; i; j++) &#123; if (values[i] &lt; values[j]) &#123; int temp = values[j]; values[j] = values[i]; values[i] = temp; System.out.println("markNum:"+markNum++); &#125; &#125;&#125;System.out.println(Arrays.asList(values)); ËßÅ: myServer/@java/demo-sorting/SortingDemo.java12345678910111213141516171819202122232425262728293031323334353637383940/*** ÂΩíÂπ∂ÊéíÂ∫è*/class MergeSort &#123; static void mergeSort() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± Integer[] values = (Integer[]) list.toArray(); System.out.println(Arrays.asList(values)); middleSort(values, 0, values.length); &#125; static int markNum=0; static void middleSort(Integer[] values, int beginIndex, int endIndex) &#123; if (!(beginIndex &lt; endIndex)) return; int mid = (beginIndex + endIndex) / 2;// Âèñ‰∏≠‰Ωçindex middleSort(values, beginIndex, mid);// Â∑¶‰æßÈÄíÂΩíÂÜçÂàÜ,Âà∞‰∏çÂèØÂÜçÂàÜ middleSort(values, mid + 1, endIndex);// Âè≥‰æßÈÄíÂΩíÂÜçÂàÜ,Âà∞‰∏çÂèØÂÜçÂàÜ // ÂØπÊúÄËøëÁöÑ‰∫åÂàÜÊï∞ÊçÆËøõË°åÂêàÂπ∂. Â¶Ç:[5,6,7][1,2] // ÂæÖÂêàÂπ∂ÁöÑ‰∫åÂàÜÊï∞ÊçÆ,Â∑≤ÁªèÂü∫Êú¨ÊúâÂ∫è,ÊâÄÊúâ‰ΩøÁî®`ÊèíÂÖ•ÊéíÂ∫è`ËøõË°åÂêàÂπ∂,ÂÖ∑Â§áÊõ¥È´òÁöÑÊÄßËÉΩ(Âõ†‰∏∫ÁßªÂä®ÁöÑ‰ΩçÁΩÆËæÉÂ∞ë)‰∏î‰∏çÈúÄË¶ÅÊõ¥Â§öÁöÑÂÜÖÂ≠ò‰ªÖÈúÄ‰∏Ä‰∏™‰∫§Êç¢ÂèòÈáè. for (int i = beginIndex + 1; i &lt; endIndex; i++) &#123; for (int j = beginIndex; j &lt; i; j++) &#123; if (values[i] &lt; values[j]) &#123; int temp = values[j]; values[j] = values[i]; values[i] = temp; System.out.println("markNum:"+markNum++); &#125; &#125; &#125; System.out.println(Arrays.asList(values)); &#125;&#125; Â∏åÂ∞îÊéíÂ∫èÂü∫Êú¨ÊÄùÊÉ≥ÊòØÔºöÂÖàÂ∞ÜÊï¥‰∏™ÂæÖÊéíËÆ∞ÂΩïÂ∫èÂàóÂàÜÂâ≤Êàê‰∏∫Ëã•Âπ≤Â≠êÂ∫èÂàóÔºåÂàÜÂà´ËøõË°åÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫è„ÄÇÂæÖÊï¥‰∏™Â∫èÂàó‰∏≠ÁöÑËÆ∞ÂΩïÂü∫Êú¨ÊúâÂ∫èÊó∂ÔºåÂÜçÂØπÂÖ®‰ΩìËÆ∞ÂΩïËøõË°å‰∏ÄÊ¨°Áõ¥Êé•ÊèíÂÖ•ÊéíÂ∫è„ÄÇ12345678910111213141516171819202122232425262728293031323334353637383940418, 7, 4, 1, 3, 5, 6, 2, 9length/2=4- - - - - - - - - -3, 5, 4, 1, 8, 7, 6, 2, 94/2=2- - - - - - - - - - - - - - - - - -x x 1 5 x 8 x 7 x 6 8 2 5 7 x x x 93, 1, 4, 2, 6, 5, 8, 7, 92/2=1- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -1 3 i=1 x x i=2 2 3 4 i=3 x x x 6 i=4 x x x 5 6 i=5 x x x x X 8 i=6 x x x x X 7 8 i=7 x x x x X x x x 9 i=8 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/*** Â∏åÂ∞îÊéíÂ∫è*/class ShellSort &#123; static void shellSort() &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9); Collections.shuffle(list);// listÈöèÊú∫Êâì‰π± Integer[] values = (Integer[]) list.toArray();// List ËΩ¨ Array System.out.println(Arrays.asList(values)); int[] valuesI = new int[values.length]; Arrays.stream(values).forEachOrdered(i -&gt; valuesI[i - 1] = values[i - 1].intValue());// Â∞ÅË£ÖÊï∞ÁªÑËΩ¨Âü∫Á°ÄÊï∞ÁªÑ(Integer[] ËΩ¨ int[]) Arrays.stream(valuesI).forEach(value -&gt; System.out.print(value + ", "));// ÊâìÂç∞Âü∫Á°ÄÁ±ªÂûãÊï∞ÁªÑ(int[]) System.out.println(); int[] valuesI2 = new int[]&#123;8, 7, 4, 1, 3, 5, 6, 2, 9&#125;;// Ëá™ÂÆö‰πâ shellSort(valuesI2); Arrays.stream(valuesI2).forEach(value -&gt; System.out.print(value + ", "));// ÊâìÂç∞Âü∫Á°ÄÁ±ªÂûãÊï∞ÁªÑ(int[]) &#125; /** * Â∏åÂ∞îÊéíÂ∫èÁöÑ‰∏ÄË∂üÊèíÂÖ• * * @param arr ÂæÖÊéíÊï∞ÁªÑ * @param d Â¢ûÈáè */ public static void shellInsert(int[] arr, int d) &#123; System.out.println("d:" + d); for (int i = d; i &lt; arr.length; i++) &#123; int j = i - d; int temp = arr[i]; //ËÆ∞ÂΩïË¶ÅÊèíÂÖ•ÁöÑÊï∞ÊçÆ while (j &gt;= 0 &amp;&amp; arr[j] &gt; temp) &#123; //‰ªéÂêéÂêëÂâçÔºåÊâæÂà∞ÊØîÂÖ∂Â∞èÁöÑÊï∞ÁöÑ‰ΩçÁΩÆ arr[j + d] = arr[j]; //ÂêëÂêéÊå™Âä® j -= d; &#125; if (j != i - d) //Â≠òÂú®ÊØîÂÖ∂Â∞èÁöÑÊï∞ arr[j + d] = temp; Arrays.stream(arr).forEach(value -&gt; System.out.print(value + ", "));// ÊâìÂç∞Âü∫Á°ÄÁ±ªÂûãÊï∞ÁªÑ(int[]) System.out.println(); &#125; &#125; public static void shellSort(int[] arr) &#123; if (arr == null || arr.length == 0) return; int d = arr.length / 2; while (d &gt;= 1) &#123; shellInsert(arr, d); d /= 2; &#125; &#125;&#125; Êó∂Èó¥Â§çÊùÇÂ∫¶,Á©∫Èó¥Â§çÊùÇÂ∫¶,Á®≥ÂÆöÊÄß ÂÖ≥‰∫éÊó∂Èó¥Â§çÊùÇÂ∫¶ÔºöÂπ≥ÊñπÈò∂(O(n2))ÊéíÂ∫èÔºöÂêÑÁ±ªÁÆÄÂçïÊéíÂ∫è:Áõ¥Êé•ÊèíÂÖ•„ÄÅÁõ¥Êé•ÈÄâÊã©ÂíåÂÜíÊ≥°ÊéíÂ∫è„ÄÇÁ∫øÊÄßÂØπÊï∞Èò∂(O(nlog2n))ÊéíÂ∫èÔºöÂø´ÈÄüÊéíÂ∫è„ÄÅÂ†ÜÊéíÂ∫èÂíåÂΩíÂπ∂ÊéíÂ∫è„ÄÇO(n1+¬ß))ÊéíÂ∫èÔºö¬ßÊòØ‰ªã‰∫é0Âíå1‰πãÈó¥ÁöÑÂ∏∏Êï∞„ÄÇÁ∫øÊÄßÈò∂(O(n))ÊéíÂ∫èÔºöÂü∫Êï∞ÊéíÂ∫èÔºåÊ≠§Â§ñËøòÊúâÊ°∂„ÄÅÁÆ±ÊéíÂ∫è„ÄÇ ÂÖ≥‰∫éÁ®≥ÂÆöÊÄßÔºöÁ®≥ÂÆöÁöÑÊéíÂ∫èÁÆóÊ≥ïÔºöÂÜíÊ≥°ÊéíÂ∫è„ÄÅÊèíÂÖ•ÊéíÂ∫è„ÄÅÂΩíÂπ∂ÊéíÂ∫èÂíåÂü∫Êï∞ÊéíÂ∫èÔºõ‰∏çÊòØÁ®≥ÂÆöÁöÑÊéíÂ∫èÁÆóÊ≥ïÔºöÈÄâÊã©ÊéíÂ∫è„ÄÅÂø´ÈÄüÊéíÂ∫è„ÄÅÂ∏åÂ∞îÊéíÂ∫è„ÄÅÂ†ÜÊéíÂ∫è„ÄÇ Âπ≥ÂùáÊó∂Èó¥,ÊúÄÂùèÊÉÖÂÜµ,ËæÖÂä©Â≠òÂÇ® Âπ≥ÂùáÊó∂Èó¥Êù•ÁúãÔºåÂø´ÈÄüÊéíÂ∫èÊòØÊïàÁéáÊúÄÈ´òÁöÑ„ÄÇ‰ΩÜÂø´ÈÄüÊéíÂ∫èÂú®ÊúÄÂùèÊÉÖÂÜµ‰∏ãÁöÑÊó∂Èó¥ÊÄßËÉΩÔºå‰∏çÂ¶ÇÂ†ÜÊéíÂ∫èÂíåÂΩíÂπ∂ÊéíÂ∫è„ÄÇËÄåÂêéËÄÖÁõ∏ÊØîËæÉÁöÑÁªìÊûúÊòØÂú®nËæÉÂ§ßÊó∂ÔºåÂΩíÂπ∂ÊéíÂ∫è‰ΩøÁî®Êó∂Èó¥ËæÉÂ∞ëÔºå‰ΩÜ‰ΩøÁî®ËæÖÂä©Á©∫Èó¥ËæÉÂ§ö„ÄÇ ÁÆÄÂçïÊéíÂ∫èÔºåÂåÖÊã¨Èô§Â∏åÂ∞îÊéíÂ∫è‰πãÂ§ñÁöÑÊâÄÊúâÂÜíÊ≥°ÊéíÂ∫è„ÄÅÊèíÂÖ•ÊéíÂ∫è„ÄÅÁÆÄÂçïÈÄâÊã©ÊéíÂ∫è„ÄÇÂÖ∂‰∏≠Áõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÊúÄÁÆÄÂçï„ÄÇ‰ΩÜÂ∫èÂàóÂü∫Êú¨ÊúâÂ∫èÊàñËÄÖnËæÉÂ∞èÊó∂ÔºåÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫èÊòØÂ•ΩÁöÑÊñπÊ≥ï„ÄÇÂõ†Ê≠§Â∏∏Â∞ÜÂÆÉÂíåÂÖ∂‰ªñÁöÑÊéíÂ∫èÊñπÊ≥ïÔºåÂ¶ÇÂø´ÈÄüÊéíÂ∫è„ÄÅÂΩíÂπ∂ÊéíÂ∫èÁ≠âÁªìÂêàÂú®‰∏ÄËµ∑‰ΩøÁî®„ÄÇ Âü∫Êï∞ÊéíÂ∫èÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰πüÂèØ‰ª•ÂÜôÊàêO(d*n)„ÄÇÂõ†Ê≠§ÂÆÉÊúÄ‰ΩøÁî®‰∫énÂÄºÂæàÂ§ßËÄåÂÖ≥ÈîÆÂ≠óËæÉÂ∞èÁöÑÁöÑÂ∫èÂàó„ÄÇËã•ÂÖ≥ÈîÆÂ≠ó‰πüÂæàÂ§ßÔºåËÄåÂ∫èÂàó‰∏≠Â§ßÂ§öÊï∞ËÆ∞ÂΩïÁöÑÊúÄÈ´òÂÖ≥ÈîÆÂ≠óÂùá‰∏çÂêåÔºåÂàô‰∫¶ÂèØÂÖàÊåâÊúÄÈ´òÂÖ≥ÈîÆÂ≠ó‰∏çÂêåÔºåÂ∞ÜÂ∫èÂàóÂàÜÊàêËã•Âπ≤Â∞èÁöÑÂ≠êÂ∫èÂàóÔºåËÄåÂêéËøõË°åÁõ¥Êé•ÊèíÂÖ•ÊéíÂ∫è„ÄÇ ‰ªéÊñπÊ≥ïÁöÑÁ®≥ÂÆöÊÄßÊù•ÊØîËæÉÔºåÂü∫Êï∞ÊéíÂ∫èÊòØÁ®≥ÂÆöÁöÑÂÜÖÊéíÊñπÊ≥ïÔºåÊâÄÊúâÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫O(n^2)ÁöÑÁÆÄÂçïÊéíÂ∫è‰πüÊòØÁ®≥ÂÆöÁöÑ„ÄÇ‰ΩÜÊòØÂø´ÈÄüÊéíÂ∫è„ÄÅÂ†ÜÊéíÂ∫è„ÄÅÂ∏åÂ∞îÊéíÂ∫èÁ≠âÊó∂Èó¥ÊÄßËÉΩËæÉÂ•ΩÁöÑÊéíÂ∫èÊñπÊ≥ïÈÉΩÊòØ‰∏çÁ®≥ÂÆöÁöÑ„ÄÇÁ®≥ÂÆöÊÄßÈúÄË¶ÅÊ†πÊçÆÂÖ∑‰ΩìÈúÄÊ±ÇÈÄâÊã©„ÄÇ ‰∏äÈù¢ÁöÑÁÆóÊ≥ïÂÆûÁé∞Â§ßÂ§öÊï∞ÊòØ‰ΩøÁî®Á∫øÊÄßÂ≠òÂÇ®ÁªìÊûÑÔºåÂÉèÊèíÂÖ•ÊéíÂ∫èËøôÁßçÁÆóÊ≥ïÔºåÁî®ÈìæË°®ÂÆûÁé∞Êõ¥Â•ΩÔºåÁúÅÂéª‰∫ÜÁßªÂä®ÂÖÉÁ¥†ÁöÑÊó∂Èó¥„ÄÇÂÖ∑‰ΩìÁöÑÂ≠òÂÇ®ÁªìÊûÑÔºåÂú®ÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÁâàÊú¨‰∏≠‰πüÊòØ‰∏çÂêåÁöÑ„ÄÇ ÂèÇËÄÉ‚òÖÈù¢ËØï‰∏≠ÁöÑÊéíÂ∫èÁÆóÊ≥ïÊÄªÁªì - ÁÆÄ‰π¶http://www.jianshu.com/p/c360a58db21d ÊéíÂ∫èÁÆóÊ≥ïÂõæÂΩ¢ÂåñÊØîËæÉÔºöÂø´ÈÄüÊéíÂ∫è„ÄÅÊèíÂÖ•ÊéíÂ∫è„ÄÅÈÄâÊã©ÊéíÂ∫è„ÄÅÂÜíÊ≥°ÊéíÂ∫è - ÁÆÄ‰π¶http://www.jianshu.com/p/70619984fbc6ÂÆåÂÖ®‰∫åÂèâÊ†ëÂÆûÁé∞‰ºòÂÖàÈòüÂàó‰∏éÂ†ÜÊéíÂ∫è - ÁÆÄ‰π¶http://www.jianshu.com/p/9a456d1b59b5 8Â§ßÊéíÂ∫èÁÆóÊ≥ïÂõæÊñáËÆ≤Ëß£http://www.jianshu.com/p/e6ad4423efcd ÂÖ´Â§ßÊéíÂ∫èÁÆóÊ≥ï - guisuÔºåÁ®ãÂ∫è‰∫∫Áîü„ÄÇ ÈÄÜÊ∞¥Ë°åËàüÔºå‰∏çËøõÂàôÈÄÄ„ÄÇ - CSDNÂçöÂÆ¢http://blog.csdn.net/hguisu/article/details/7776068]]></content>
      <categories>
        <category>ÁÆóÊ≥ï</category>
      </categories>
      <tags>
        <tag>ÊéíÂ∫èÁÆóÊ≥ï</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂÜÖÁΩëdockerÈõÜÁæ§ÁéØÂ¢É]]></title>
    <url>%2F2017%2F08%2F03%2F%E5%86%85%E7%BD%91docker%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[Node‰∏ÄÈîÆÊé•ÂÖ•ÈõÜÁæ§ÔºåÂª∫ËÆÆÂàùÂßãÈïúÂÉè‰ΩøÁî®ÂÜÖÁΩëcentos7.2ÂàùÂßãÈïúÂÉè 12345678910111213141516curl -sSL https://shipyard-project.com/deploy | ACTION=node DISCOVERY=etcd://192.168.10.165:4001 bash -ÂÜÖÁΩëdockerÈõÜÁæ§docker registry : dr.zenzet.comdocker console : shipyard.zenzet.comdocker nodes : 192.168.10.113~115Áõ∏ÂÖ≥dockerÂëΩ‰ª§docker build -t gateway .docker run -d -p 6500:6500 gatewaydocker tag gateway dr.zenzet.com/gatewaydocker push dr.zenzet.com/gatewaydocker exec -it 198eb84bf118 /bin/shdocker kill 372f0742488adocker rmi -f b537edc85f45docker run -d -p 80:5000 -v /opt/registry:/tmp/registry-dev registrydocker run -d -p 6500:6500 dr.zenzet.com/gateway]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring BeanÁöÑÂàùÂßãÂåñÂêØÂä®ÊñπÂºè]]></title>
    <url>%2F2017%2F08%2F01%2FSpring%20Bean%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ÊñπÂºè‰∏Ä: xml &lt;bean init-method=&quot;init&quot;1234&lt;bean class="cn.fraudmetrix.billing.consumer.FlowConsumer" init-method="init" destroy-method="destroy"&gt; &lt;property name="kafkaTopics" value="$&#123;billing.kafka.topics&#125;"/&gt; &lt;property name="debug" value="$&#123;billing.flow.consumer.debug&#125;"/&gt;&lt;/bean&gt; ÊñπÂºè‰∫å: implements InitializingBean12345678public class DisconfPropertiesFactory implements FactoryBean&lt;Properties&gt;, InitializingBean &#123; ... public void afterPropertiesSet() throws Exception &#123; if (this.singleton) &#123; this.singletonInstance = this.createProperties(); &#125; &#125; ... ÊñπÂºè‰∏â:Ê≥®Ëß£@PostConstruct @PreDestroy12345678910111213141516171819202122232425262728package com.myapp.core.annotation.init;import javax.annotation.PostConstruct;import javax.annotation.PreDestroy;public class PersonService &#123; private String message; public String getMessage() &#123; return message; &#125; public void setMessage(String message) &#123; this.message = message; &#125; @PostConstruct public void init()&#123; System.out.println("I'm init method using @PostConstrut...."+message); &#125; @PreDestroy public void dostory()&#123; System.out.println("I'm destory method using @PreDestroy....."+message); &#125;&#125; bean factoryË¥üË¥£beanÂàõÂª∫ÁöÑÊúÄÂàùÂõõÊ≠•ÔºåÁÑ∂ÂêéÁßª‰∫§ÁªôÂ∫îÁî®‰∏ä‰∏ãÊñáÂÅöÂêéÁª≠ÂàõÂª∫ËøáÁ®ãÔºö 1.SpringÂàùÂßãÂåñbean 2.SpringÂ∞ÜÂÄºÂíåÂÖ∂‰ªñbeanÁöÑÂºïÁî®Ê≥®ÂÖ•ÔºàinjectÔºâÂà∞ÂΩìÂâçbeanÁöÑÂØπÂ∫îÂ±ûÊÄß‰∏≠Ôºõ 3.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜBeanNameAwareÊé•Âè£ÔºåSpring‰ºö‰º†ÂÖ•beanÁöÑIDÊù•Ë∞ÉÁî®setBeanNameÊñπÊ≥ïÔºõ 4.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜBeanFactoryAwareÊé•Âè£ÔºåSpring‰º†ÂÖ•bean factoryÁöÑÂºïÁî®Êù•Ë∞ÉÁî®setBeanFactoryÊñπÊ≥ïÔºõ 5.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜApplicationContextAwareÊé•Âè£ÔºåSpringÂ∞Ü‰º†ÂÖ•Â∫îÁî®‰∏ä‰∏ãÊñáÁöÑÂºïÁî®Êù•Ë∞ÉÁî®setApplicationContextÊñπÊ≥ïÔºõ 6.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜBeanPostProcessorÊé•Âè£ÔºåÂàôSpringË∞ÉÁî®postProcessBeforeInitializationÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÂú®ÂàùÂßãÂåñÂíåÂ±ûÊÄßÊ≥®ÂÖ•‰πãÂêéË∞ÉÁî®ÔºåÂú®‰ªª‰ΩïÂàùÂßãÂåñ‰ª£Á†Å‰πãÂâçË∞ÉÁî®Ôºõ 7.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜInitializingBeanÊé•Âè£ÔºåÂàôÈúÄË¶ÅË∞ÉÁî®ËØ•Êé•Âè£ÁöÑafterPropertiesSetÊñπÊ≥ïÔºõÂ¶ÇÊûúÂú®beanÂÆö‰πâÁöÑÊó∂ÂÄôËÆæÁΩÆ‰∫Üinit-methodÂ±ûÊÄßÔºåÂàôÈúÄË¶ÅË∞ÉÁî®ËØ•Â±ûÊÄßÊåáÂÆöÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºõ 8.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜBeanPostProcessorÊé•Âè£ÔºåÂàôSpringË∞ÉÁî®postProcessAfterInitializationÊñπÊ≥ï 9.Âú®Ëøô‰∏™Êó∂ÂÄôbeanÂ∞±ÂèØ‰ª•Áî®‰∫éÂú®Â∫îÁî®‰∏ä‰∏ãÊñá‰∏≠‰ΩøÁî®‰∫ÜÔºåÂΩì‰∏ä‰∏ãÊñáÈÄÄÂá∫Êó∂bean‰πü‰ºöË¢´ÈîÄÊØÅÔºõ 10.Â¶ÇÊûúBeanÂÆûÁé∞‰∫ÜDisposableBeanÊé•Âè£ÔºåSpring‰ºöË∞ÉÁî®destroy()ÊñπÊ≥ï;Â¶ÇÊûúÂú®beanÂÆö‰πâÁöÑÊó∂ÂÄôËÆæÁΩÆ‰∫Üdestroy-methodÔºå ÂàôÊ≠§Êó∂ÈúÄË¶ÅË∞ÉÁî®ÊåáÂÆöÁöÑÊñπÊ≥ï„ÄÇ SpringÂÆûÊàò1ÔºöSpringÂàùÊé¢ - ÁÆÄ‰π¶http://www.jianshu.com/p/9370707091ef ÂèÇËÄÉ13 Spring Bean init-method Âíå destroy-methodÂÆû‰æã - ÁÆÄ‰π¶http://www.jianshu.com/p/30a0a74cd31f ÈÄöËøáSpring @PostConstruct Âíå @PreDestroy ÊñπÊ≥ï ÂÆûÁé∞ÂàùÂßãÂåñÂíåÈîÄÊØÅbean‰πãÂâçËøõË°åÁöÑÊìç‰Ωú - ÂÆâÂæ∑Èáå‰∫öÁöÑÊàêÈïø - CSDNÂçöÂÆ¢http://blog.csdn.net/topwqp/article/details/8681497]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JVMÂèÇÊï∞ÈÖçÁΩÆ]]></title>
    <url>%2F2015%2F10%2F07%2FJVM%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[Â∏∏ËßÅÈÖçÁΩÆ12# 4GÂÜÖÂ≠ò:JAVA_OPTS="$JAVA_OPTS -server -Xms2500m -Xmx2500m -XX:PermSize=256M -XX:MaxPermSize=512m" 1234567891011# Êú∫Âô®ÂÜÖÂ≠òÂàÜÈÖçÁªìÊûÑÔºö# Ê†∏ÂøÉÂ∫îÁî®Âç†Áî®ÂÜÖÂ≠òÔºàÂèØÈÄöËøáÁõëÊéßÊü•ÁúãÂá∫ÂêàÈÄÇÁöÑÂ§ßÂ∞èÔºåÈÖçÁΩÆÂ§™È´òÁî®‰∏çÂà∞‰πüÊòØÊµ™Ë¥πÔºâ# Á≥ªÁªüÂèäÈùûÊ†∏ÂøÉÂ∫îÁî®Âç†Áî®ÂÜÖÂ≠òÔºàÂú®Ê†∏ÂøÉÂ∫îÁî®Êú™ÂêØÁî®Êó∂ÔºåtopÊâÄÂç†Áî®ÂÜÖÂ≠ò„ÄÇÊ≠§Âü∫Á°Ä‰∏äËøòÈúÄÂºπÊÄßÁ©∫Èó¥Ôºâ# Ê≥®:Êó•Â∏∏Áä∂ÊÄÅÂÜÖÂ≠òÂ∞ΩÈáèÊéßÂà∂Âú®70%‰ª•ÂÜÖ,È¢ÑÁïôÂÜÖÂ≠ò‰ª•Â§áÂ§ÑÁêÜ‚ÄòÂÜÖÂ≠òÈíàÂà∫‚ÄôÁöÑ‰∏öÂä°# (ÊúçÂä°Âô®‰∏ÄËà¨ËÆæÁΩÆ-Xms„ÄÅ-XmxÁõ∏Á≠â‰ª•ÈÅøÂÖçÂú®ÊØèÊ¨°GCÂêéË∞ÉÊï¥Â†ÜÁöÑÂ§ßÂ∞è)-Xms128m #JVMÂàùÂßãÂàÜÈÖçÁöÑÂ†ÜÂÜÖÂ≠ò-Xmx512m #JVMÊúÄÂ§ßÂÖÅËÆ∏ÂàÜÈÖçÁöÑÂ†ÜÂÜÖÂ≠òÔºåÊåâÈúÄÂàÜÈÖç-XX:PermSize=64M #JVMÂàùÂßãÂàÜÈÖçÁöÑÈùûÂ†ÜÂÜÖÂ≠ò-XX:MaxPermSize=128M #JVMÊúÄÂ§ßÂÖÅËÆ∏ÂàÜÈÖçÁöÑÈùûÂ†ÜÂÜÖÂ≠òÔºåÊåâÈúÄÂàÜÈÖç tomcat jvmÈÖçÁΩÆ12345678910111213141516171819202122232425# ÊúçÂä°Á´ØÈÖçÁΩÆËøúÁ®ãË∞ÉËØïCATALINA_OPTS="$CATALINA_OPTS -server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5888"# jconsoleÔºåVisualVMÔºåJMC ÁõëÊéßÈÖçÁΩÆÔºàrmiÔºâ# -Dcom.sun.management.jmxremote.authenticate=false ‰∏∫ JMC ÂÖ≥Èó≠È£ûË°åÊ®°ÂºèJAVA_OPTS="$JAVA_OPTS -Dcom.sun.management.jmxremote=true -Djava.rmi.server.hostname=121.40.84.8 -Dcom.sun.management.jmxremote.port=8999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.managementote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false"# ÈÖçÁΩÆtomcatÔºåÊó•Â∏∏GCÊó•Âøó. ÂèØËÆ∞ÂΩï‰∏ãÊúçÂä°Âô®ÂéÜÂè≤ÁöÑGCÊÉÖÂÜµ# Ê≥®ÊÑèÔºötomcatÂêØÂä®ÂêéÂ¶ÇÊûúwebapps‰∏ãÊú™Ëá™Âä®ÂàõÂª∫sysÁõÆÂΩïÔºåËØ∑ÊâãÂä®ÂàõÂª∫ */webapps&gt;mkdir sys# ÈÖçÁΩÆË∑ØÂæÑÂà∞webapps‰∏ãÔºåÊñπ‰æøÊó•ÂøóÊñá‰ª∂ÁöÑ‰∏ãËΩΩÂíåÁõ¥Êé•ÂÆö‰ΩçÔºö# ËÆøÈóÆÔºö# http://121.40.87.121:8080/sys/gc.log# http://121.40.84.8:8080/sys/gc.log# ÂèØËßÜÂåñÂ∑•ÂÖ∑:GCViewerÂèØ‰ª•‰ΩøÁî®ÁΩëÁªúÂú∞ÂùÄÁõ¥Êé•Êü•ÁúãCATALINA_OPTS="$CATALINA_OPTS -Xloggc:webapps/sys/gc.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps"# jprofileÊúçÂä°Âô®Á´ØÈÖçÁΩÆCATALINA_OPTS="$CATALINA_OPTS -agentlib:jprofilerti=port=8849,nowait -Xbootclasspath/a:/usr/local/jprofile/jprofiler9/bin/agent.jar"# jvm shut downÊó∂,ËæìÂá∫dumpÊñá‰ª∂CATALINA_OPTS="$CATALINA_OPTS -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/usr/local/apache-tomcat-7.0.59/logs/heap.dump" windows ÈÖçÁΩÆ12345# ÊúçÂä°Á´ØÈÖçÁΩÆËøúÁ®ãË∞ÉËØïSET CATALINA_OPTS=-server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5888# jprofileÊúçÂä°Âô®Á´ØÈÖçÁΩÆset CATALINA_OPTS=%CATALINA_OPTS% -agentpath:G:\workTool\jprofiler9\bin\windows-x64\jprofilerti.dll=port=8849,nowait]]></content>
      <categories>
        <category>javaÂü∫Á°Ä</category>
      </categories>
  </entry>
</search>

<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="ops," />










<meta name="description" content="CPU相关、进程查看cpu硬件配置1less /proc/cpuinfo 1234uname -a                查看内核/操作系统/CPU信息head -n 1 /etc/issue    查看操作系统版本less /proc/cpuinfo      查看CPU信息hostname                查看计算机名 top  命令实时显示各种系统资源使用情况及进程状态">
<meta name="keywords" content="ops">
<meta property="og:type" content="article">
<meta property="og:title" content="linux常用命令">
<meta property="og:url" content="http://yoursite.com/2018/05/13/linux-commands/index.html">
<meta property="og:site_name" content="xiaowu&#39;s blog">
<meta property="og:description" content="CPU相关、进程查看cpu硬件配置1less /proc/cpuinfo 1234uname -a                查看内核/操作系统/CPU信息head -n 1 /etc/issue    查看操作系统版本less /proc/cpuinfo      查看CPU信息hostname                查看计算机名 top  命令实时显示各种系统资源使用情况及进程状态">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-08-22T03:19:10.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="linux常用命令">
<meta name="twitter:description" content="CPU相关、进程查看cpu硬件配置1less /proc/cpuinfo 1234uname -a                查看内核/操作系统/CPU信息head -n 1 /etc/issue    查看操作系统版本less /proc/cpuinfo      查看CPU信息hostname                查看计算机名 top  命令实时显示各种系统资源使用情况及进程状态">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/05/13/linux-commands/"/>





  <title>linux常用命令 | xiaowu's blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3da41265a1a0042eebe5413c0d6c76f5";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">xiaowu's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/13/linux-commands/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="周小伍 Joey">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/xiaowu_avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xiaowu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">linux常用命令</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-13T14:11:17+08:00">
                2018-05-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/运维/" itemprop="url" rel="index">
                    <span itemprop="name">运维</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/05/13/linux-commands/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2018/05/13/linux-commands/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  29
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="CPU相关、进程"><a href="#CPU相关、进程" class="headerlink" title="CPU相关、进程"></a>CPU相关、进程</h1><h2 id="查看cpu硬件配置"><a href="#查看cpu硬件配置" class="headerlink" title="查看cpu硬件配置"></a>查看cpu硬件配置</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">less</span> /<span class="meta">proc</span>/cpuinfo</span><br></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uname -a                查看内核<span class="regexp">/操作系统/</span>CPU信息</span><br><span class="line">head -n <span class="number">1</span> <span class="regexp">/etc/i</span>ssue    查看操作系统版本</span><br><span class="line">less <span class="regexp">/proc/</span>cpuinfo      查看CPU信息</span><br><span class="line">hostname                查看计算机名</span><br></pre></td></tr></table></figure>
<h2 id="top-命令"><a href="#top-命令" class="headerlink" title="top  命令"></a>top  命令</h2><p>实时显示各种系统资源使用情况及进程状态</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">详细命令参数：</span><br><span class="line">h: 显示帮助</span><br><span class="line"><span class="keyword">c</span>：显示详细的命令参数</span><br><span class="line">M：按照占用内存大小（<span class="symbol">%MEM</span> 列）对进程排序；</span><br><span class="line">P：按照 CPU 使用率( <span class="symbol">%CPU</span> 列）对进程排序；</span><br><span class="line">u：显示指定用户的进程。默认显示所有进程；</span><br><span class="line">T：根据累计运行时间排序</span><br></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一行：当前时间：系统已运行时间：<span class="number">751</span>天，目前<span class="number">4</span>个用户，<span class="number">1</span>、<span class="number">5</span>、<span class="number">15</span>分钟内的load分别是<span class="number">0.07</span>、<span class="number">0.02</span> 、<span class="number">0.00</span></span><br><span class="line">第二行：进程情况：总共<span class="number">148</span>个，正在运行的有<span class="number">2</span>个，休眠有<span class="number">139</span>个，僵尸进程<span class="number">1</span>个</span><br><span class="line">第三行：cpu的使用情况（按数字<span class="number">1</span>显示所有cpu）</span><br><span class="line">第四行：内存情况（buffers表示用作内核缓存的内存量）</span><br><span class="line">第五行：虚拟内存情况（系统的物理内存不够用的时候，把硬盘空间中的一部分空间释放出来，以供当前运行的程序使用）</span><br><span class="line">第六行：进程id，虚拟内存，驻留内存使用，cpu，内存使用百分比，运行时间,命令参数等。</span><br><span class="line">VIRT表示进程可以使用的内存总大小，VIRT=SWAP+RES，包括这个进程真实使用的内存, 映射过的文件, 和别的进程共享的内存等。</span><br><span class="line">RES表示这个进程真实占用内存的大小，一般这个值和JVM的参数配置有关，如果%MEM使用过高则需要关注</span><br><span class="line">SHR表示可以和别的进程共享的内存和库大小。</span><br></pre></td></tr></table></figure>
<ul>
<li>某一个进程下的线程资源使用情况：</li>
</ul>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">top</span> -p &#123;pid&#125; -H</span><br></pre></td></tr></table></figure>
<ul>
<li>查看系统load、cpu资源的其它命令</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mpstat <span class="number">1</span> （汇总的）</span><br><span class="line">mpstat -P ALL <span class="number">1</span>  （汇总的+每个cpu的）</span><br><span class="line">w</span><br><span class="line">uptime</span><br><span class="line">top -H 和 ps -efL/ -Tel  显示 线程</span><br></pre></td></tr></table></figure>
<h2 id="统计一个进程下的线程数"><a href="#统计一个进程下的线程数" class="headerlink" title="统计一个进程下的线程数"></a>统计一个进程下的线程数</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="string">/proc/</span>$&#123;pid&#125;<span class="string">/status</span></span><br><span class="line"></span><br><span class="line">返回：</span><br><span class="line"><span class="string">...</span>省略</span><br><span class="line">Threads:	74</span><br><span class="line"><span class="string">....</span>省略</span><br><span class="line"></span><br><span class="line">其它命令：</span><br><span class="line">top -bH -d 3 -p &#123;pid&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>pstree （以树状图的方式展现进程之间的派生关系）<br><a href="http://man.linuxde.net/pstree" target="_blank" rel="external">Linux命令大全</a></li>
</ul>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pstree -p</span><br><span class="line">pstree -p &#123;pid&#125; <span class="string">| wc -l</span></span><br></pre></td></tr></table></figure>
<ul>
<li>pstack （显示每个进程的栈跟踪），也可以查看一个进程下的线程总数</li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">pstack </span>&#123;pid&#125;</span><br><span class="line"><span class="comment">// 输出第一行</span></span><br><span class="line"><span class="class">pstack </span>&#123;pid&#125; | head <span class="number">-1</span></span><br></pre></td></tr></table></figure>
<h2 id="查看所有进程"><a href="#查看所有进程" class="headerlink" title="查看所有进程"></a>查看所有进程</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span> -ef</span><br><span class="line"><span class="keyword">ps</span> -ef|<span class="keyword">grep</span> java</span><br></pre></td></tr></table></figure>
<p>5、对于Java应用从操作系统层面观察，就只有进程和线程两个指标，任何东西在操作系统层面都是以文件的形式存储的，进程也不例外。Linux上部署一个Tomcat程序产生一个进程，这个进程所有的东西都在这个目录下</p>
<p>ll /proc/{pid}/</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 可以查看所有的socket连接</span></span><br><span class="line">ll /<span class="keyword">proc</span>/&#123;<span class="keyword">pid</span>&#125;/fd | grep <span class="keyword">socket</span></span><br></pre></td></tr></table></figure>
<h2 id="ulimit-a-（显示当前的各种用户进程限制）"><a href="#ulimit-a-（显示当前的各种用户进程限制）" class="headerlink" title="ulimit -a （显示当前的各种用户进程限制）"></a>ulimit -a （显示当前的各种用户进程限制）</h2><p><a href="http://blog.csdn.net/bbaiggey/article/details/51004817" target="_blank" rel="external">linux修改max user processes limits</a></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ulimit -a</span><br><span class="line"></span><br><span class="line">core file size (<span class="name">blocks</span>, -c) <span class="number">100</span></span><br><span class="line">data seg size (<span class="name">kbytes</span>, -d) unlimited</span><br><span class="line">file size (<span class="name">blocks</span>, -f) unlimited</span><br><span class="line">pending signals (<span class="name">-i</span>) <span class="number">15237</span></span><br><span class="line">max locked memory (<span class="name">kbytes</span>, -l) <span class="number">64</span></span><br><span class="line">max memory size (<span class="name">kbytes</span>, -m) unlimited</span><br><span class="line">open files (<span class="name">-n</span>) <span class="number">1024</span></span><br><span class="line">pipe size (<span class="number">512</span> bytes, -p) <span class="number">8</span></span><br><span class="line">POSIX message queues (<span class="name">bytes</span>, -q) <span class="number">819200</span></span><br><span class="line">stack size (<span class="name">kbytes</span>, -s) <span class="number">8192</span></span><br><span class="line">cpu time (<span class="name">seconds</span>, -t) unlimited</span><br><span class="line">max user processes (<span class="name">-u</span>) <span class="number">15237</span></span><br><span class="line">virtual memory (<span class="name">kbytes</span>, -v) unlimited</span><br><span class="line">file locks (<span class="name">-x</span>) unlimited</span><br></pre></td></tr></table></figure>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">输出的每一行由资源名字、（单位，ulimit命令的参数）、软限制组成。详细解释：</span><br><span class="line">参数 描述</span><br><span class="line">core <span class="keyword">file</span> <span class="keyword">size</span> core文件的最大值为<span class="number">100</span> blocks，</span><br><span class="line">data seg <span class="keyword">size</span> 进程的数据段可以任意大</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">size</span> 文件可以任意大</span><br><span class="line">pending signals 最多有<span class="number">15237</span>个待处理的信号</span><br><span class="line"><span class="keyword">max</span> locked <span class="keyword">memory</span> 一个任务锁住的物理内存的最大值为<span class="number">64</span>kB</span><br><span class="line"><span class="keyword">max</span> <span class="keyword">memory</span> <span class="keyword">size</span> 一个任务的常驻物理内存的最大值</span><br><span class="line">open files 一个任务最多可以同时打开<span class="number">1024</span>的文件</span><br><span class="line">pipe <span class="keyword">size</span> 管道的最大空间为<span class="number">4096</span>字节</span><br><span class="line">POSIX message queues POSIX的消息队列的最大值为<span class="number">819200</span>字节</span><br><span class="line">stack <span class="keyword">size</span> 进程的栈的最大值为<span class="number">8192</span>字节</span><br><span class="line">cpu time 进程使用的CPU时间</span><br><span class="line"><span class="keyword">max</span> user processes 当前用户同时打开的进程(包括线程)的最大个数为<span class="number">15237</span></span><br><span class="line">virtual <span class="keyword">memory</span> 没有限制进程的最大地址空间</span><br><span class="line"><span class="keyword">file</span> locks 所能锁住的文件的最大个数没有限制</span><br></pre></td></tr></table></figure>
<h1 id="内存相关"><a href="#内存相关" class="headerlink" title="内存相关"></a>内存相关</h1><h2 id="vmstat"><a href="#vmstat" class="headerlink" title="vmstat"></a>vmstat</h2><p>Virtual Memory Statistics，统计进程、内存、io、cpu等的活动信息。对于多CPU系统，vmstat打印的是所有CPU的平均输出</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">procs</span><br><span class="line"><span class="symbol">r:</span> 运行队列中进程数量</span><br><span class="line"><span class="symbol">b:</span> 等待IO的进程数量</span><br><span class="line">memory</span><br><span class="line"><span class="symbol">swpd:</span> 使用虚拟内存大小</span><br><span class="line"><span class="symbol">free:</span> 可用内存大小</span><br><span class="line"><span class="symbol">buff:</span> 用作缓冲的内存大小</span><br><span class="line"><span class="symbol">cache:</span> 用作缓存的内存大小</span><br><span class="line"><span class="keyword">swap</span></span><br><span class="line"><span class="symbol">si:</span> 每秒从交换区写到内存的大小</span><br><span class="line"><span class="symbol">so:</span> 每秒从内存写入交换区的大小</span><br><span class="line">io</span><br><span class="line"><span class="symbol">bi:</span> 每秒读取的块数（现在的Linux版本块的大小为<span class="number">1024</span>bytes）</span><br><span class="line"><span class="symbol">bo:</span> 每秒写入的块数</span><br><span class="line">system</span><br><span class="line"><span class="symbol">in:</span> 每秒中断数，包括时钟中断</span><br><span class="line"><span class="symbol">cs:</span> 每秒上下文切换数</span><br><span class="line">cpu（以百分比表示）</span><br><span class="line"><span class="symbol">us:</span> 用户进程执行时间(user time)</span><br><span class="line"><span class="symbol">sy:</span> 系统进程执行时间(system time)</span><br><span class="line"><span class="symbol">id:</span> 空闲时间(包括IO等待时间)</span><br><span class="line"><span class="symbol">wa:</span> 等待IO时间</span><br></pre></td></tr></table></figure>
<p><strong>注意：排查问题时，要特别关注r的值，如果长时间超过cpu核数2倍，说明系统的负载很重，cpu已经无法及时处理堆积任务。</strong></p>
<h1 id="IO及网络"><a href="#IO及网络" class="headerlink" title="IO及网络"></a>IO及网络</h1><h2 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h2><h3 id="OSI-七层模型-（应表会，传网数物）"><a href="#OSI-七层模型-（应表会，传网数物）" class="headerlink" title="OSI 七层模型 （应表会，传网数物）"></a>OSI 七层模型 （应表会，传网数物）</h3><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>应用层</td>
<td>APDU应用协议数据单元</td>
<td>应用协议数据单元 用户接口</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>表示层</td>
<td>PPDU</td>
<td>数据的表现形式，压缩、加密</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>会话层</td>
<td>SPDU</td>
<td>会话的管理、同步</td>
<td>上三层，给用户</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>传输层</td>
<td>TPDU</td>
<td>TCP/UDP 可靠与不可靠的传输，确定端口</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>网络层</td>
<td></td>
<td>IP地址 报文，提供逻辑地址，选路由</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>数据链路层</td>
<td></td>
<td>成帧、用MAC地址访问媒介</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>物理层</td>
<td>物理层协议</td>
<td>设备之间的比特流的传输、物理接口、电气特性等</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="TCP-IP-四层协议"><a href="#TCP-IP-四层协议" class="headerlink" title="TCP/IP 四层协议"></a>TCP/IP 四层协议</h3><h2 id="常用网络命令"><a href="#常用网络命令" class="headerlink" title="常用网络命令"></a>常用网络命令</h2><h3 id="清理dns缓存"><a href="#清理dns缓存" class="headerlink" title="清理dns缓存"></a>清理dns缓存</h3><ul>
<li>mac</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo dscacheutil -flushcache</span></span><br></pre></td></tr></table></figure>
<h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><blockquote>
<p><a href="http://aiezu.com/article/linux_curl_command.html" target="_blank" rel="external">http://aiezu.com/article/linux_curl_command.html</a></p>
</blockquote>
<p><code>-i</code>输出响应头和内容, <code>-b</code>设置cookie内容</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -<span class="selector-tag">i</span> -<span class="selector-tag">b</span> <span class="string">"TSESSIONID=K5PCUJM6W-NWH6793X36IPW7Y7QWSW3-868SY2XJ-YP6"</span> https:<span class="comment">//portal.tongdun.cn/admin/acl/userManage.json?operationType=doSearch</span></span><br></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -<span class="selector-tag">i</span> -<span class="selector-tag">b</span> <span class="string">"TSESSIONID=K5PCUJM6W-NWH6793X36IPW7Y7QWSW3-868SY2XJ-YP6"</span> https:<span class="comment">//oceanus.tongdun.cn/PartnerAppSelect.json?operationType=doSelectMessage</span></span><br><span class="line"></span><br><span class="line">curl -<span class="selector-tag">i</span> http:<span class="comment">//login-dev.tongdun.cn:8081/userLogin.htm\?loginId\=asgard.pro.06@demo.com\&amp;password\=Tongdun123450</span></span><br><span class="line"></span><br><span class="line">curl -<span class="selector-tag">i</span> https:<span class="comment">//login.tongdun.cn/userLogin.htm\?loginId\=asgard.pro.06@demo.com\&amp;password\=Tongdun123450</span></span><br></pre></td></tr></table></figure>
<h3 id="tsar-–traffic：显示网络带宽"><a href="#tsar-–traffic：显示网络带宽" class="headerlink" title="tsar –traffic：显示网络带宽"></a>tsar –traffic：显示网络带宽</h3><h3 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 查看端口，及其进程</span></span><br><span class="line">netstat -tunlp <span class="string">| grep 8088</span></span><br></pre></td></tr></table></figure>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有TCP链接</span></span><br><span class="line">netstat -nat</span><br><span class="line"><span class="comment"># 查询dubbo的链接，总数</span></span><br><span class="line">netstat -nat |<span class="string"> grep ip:20880 </span>|<span class="string"> wc -l</span></span><br></pre></td></tr></table></figure>
<ul>
<li>统计每个状态的数量</li>
</ul>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -n | awk '/^tcp/ &#123;++<span class="keyword">state</span>[<span class="variable">$NF</span>]&#125; END &#123;<span class="keyword">for</span>(key <span class="keyword">in</span> <span class="keyword">state</span>) print key,<span class="string">"\t"</span>,<span class="keyword">state</span>[key]&#125;'</span><br></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TIME_WAIT 	 <span class="number">5856</span></span><br><span class="line">CLOSE_WAIT 	 <span class="number">268</span></span><br><span class="line">FIN_WAIT1 	 <span class="number">3</span></span><br><span class="line">ESTABLISHED 	 <span class="number">4837</span></span><br><span class="line">SYN_RECV 	 <span class="number">14</span></span><br><span class="line">CLOSING 	 <span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">t tcp</span></span><br><span class="line"><span class="ruby">-u udp</span></span><br><span class="line"><span class="ruby">-n numeric，使用数字显示，不用别名</span></span><br><span class="line"><span class="ruby">-l listening,正在监听</span></span><br><span class="line"><span class="ruby">-p programs,显示pid和名称</span></span><br></pre></td></tr></table></figure>
<p>一般用于检验本机各端口的网络连接情况。netstat是在内核中访问网络及相关信息的程序，它能提供TCP连接，TCP和UDP监听，进程内存管理的相关报告。</p>
<p><strong>命令参数：</strong></p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">a或–all 显示所有连线中的Socket。</span></span><br><span class="line"><span class="ruby">-A&lt;网络类型&gt;或–&lt;网络类型&gt; 列出该网络类型连线中的相关地址。</span></span><br><span class="line"><span class="ruby">-c或–continuous 持续列出网络状态。</span></span><br><span class="line"><span class="ruby">-C或–cache 显示路由器配置的快取信息。</span></span><br><span class="line"><span class="ruby">-e或–extend 显示网络其他相关信息。</span></span><br><span class="line"><span class="ruby">-F或–fib 显示FIB。</span></span><br><span class="line"><span class="ruby">-g或–groups 显示多重广播功能群组组员名单。</span></span><br><span class="line"><span class="ruby">-h或–help 在线帮助。</span></span><br><span class="line"><span class="ruby">-i或–interfaces 显示网络界面信息表单。</span></span><br><span class="line"><span class="ruby">-l或–listening 显示监控中的服务器的Socket。</span></span><br><span class="line"><span class="ruby">-M或–masquerade 显示伪装的网络连线。</span></span><br><span class="line"><span class="ruby">-n或–numeric 直接使用IP地址，而不通过域名服务器。</span></span><br><span class="line"><span class="ruby">-N或–netlink或–symbolic 显示网络硬件外围设备的符号连接名称。</span></span><br><span class="line"><span class="ruby">-o或–timers 显示计时器。</span></span><br><span class="line"><span class="ruby">-p或–programs 显示正在使用Socket的程序识别码和程序名称。</span></span><br><span class="line"><span class="ruby">-r或–route 显示Routing Table。</span></span><br><span class="line"><span class="ruby">-s或–statistice 显示网络工作信息统计表。</span></span><br><span class="line"><span class="ruby">-t或–tcp 显示TCP传输协议的连线状况。</span></span><br><span class="line"><span class="ruby">-u或–udp 显示UDP传输协议的连线状况。</span></span><br><span class="line"><span class="ruby">-v或–verbose 显示指令执行过程。</span></span><br><span class="line"><span class="ruby">-V或–version 显示版本信息。</span></span><br><span class="line"><span class="ruby">-w或–raw 显示RAW传输协议的连线状况。</span></span><br><span class="line"><span class="ruby">-x或–unix 此参数的效果和指定”-A unix”参数相同。</span></span><br><span class="line"><span class="ruby">–ip或–inet 此参数的效果和指定”-A inet”参数相同。</span></span><br></pre></td></tr></table></figure>
<p><strong>输出结果：</strong></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">一个是Active Internet connections，称为有源TCP连接，其中<span class="string">"Recv-Q"</span>和<span class="string">"Send-Q"</span>指的是接收队列和发送队列。这些数字一般都应该是<span class="number">0</span>。如果不是则表示软件包正在队列中堆积。这种情况只能在非常少的情况见到。</span><br><span class="line"></span><br><span class="line">另一个是Active UNIX domain sockets，称为有源Unix域套接口(和网络套接字一样，但是只能用于本机通信，性能可以提高一倍)。</span><br><span class="line"></span><br><span class="line">Proto显示连接使用的协议,RefCnt表示连接到本套接口上的进程号,Types显示套接口的类型,State显示套接口当前的状态,Path表示连接到套接口的其它进程使用的路径名。</span><br><span class="line"></span><br><span class="line">状态说明：</span><br><span class="line">LISTEN：侦听来自远方的TCP端口的连接请求</span><br><span class="line">SYN-SENT：再发送连接请求后等待匹配的连接请求（如果有大量这样的状态包，检查是否中招了）</span><br><span class="line">SYN-RECEIVED：再收到和发送一个连接请求后等待对方对连接请求的确认（如有大量此状态，估计被flood攻击了）</span><br><span class="line">ESTABLISHED：代表一个打开的连接</span><br><span class="line">FIN-<span class="built_in">WAIT</span><span class="number">-1</span>：等待远程TCP连接中断请求，或先前的连接中断请求的确认</span><br><span class="line">FIN-<span class="built_in">WAIT</span><span class="number">-2</span>：从远程TCP等待连接中断请求</span><br><span class="line"><span class="built_in">CLOSE</span>-<span class="built_in">WAIT</span>：等待从本地用户发来的连接中断请求</span><br><span class="line">CLOSING：等待远程TCP对连接中断的确认</span><br><span class="line">LAST-ACK：等待原来的发向远程TCP的连接中断请求的确认（不是什么好东西，此项出现，检查是否被攻击）</span><br><span class="line"><span class="built_in">TIME</span>-<span class="built_in">WAIT</span>：等待足够的时间以确保远程TCP接收到连接中断请求的确认</span><br><span class="line">CLOSED：没有任何连接状态</span><br></pre></td></tr></table></figure>
<ul>
<li>找出运行在指定端口的进程</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -anpt | <span class="keyword">grep</span> <span class="string">':20130'</span></span><br><span class="line">netstat -nat | <span class="keyword">grep</span> <span class="string">"172.16.49.161:20130"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>其它使用场景</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat |awk <span class="string">'&#123;print $6&#125;'</span>|<span class="keyword">sort</span>|uniq -<span class="keyword">c</span>    不同网络状态结果统计</span><br><span class="line">netstat -anop | <span class="keyword">grep</span> <span class="number">6379</span>     应用连接Redis情况</span><br><span class="line">netstat -<span class="keyword">pt</span>             输出中显示 PID 和进程名称</span><br><span class="line">netstat -s              查看网络统计信息</span><br><span class="line">netstat -<span class="keyword">nu</span>             显示当前UDP连接状况</span><br><span class="line">netstat -nt             显示当前TCP连接状况</span><br><span class="line">netstat -i              显示网卡列表</span><br></pre></td></tr></table></figure>
<h3 id="3、-iostat"><a href="#3、-iostat" class="headerlink" title="3、 iostat"></a>3、 iostat</h3><p>iostat是I/O statistics（输入/输出统计）的缩写，主要的功能是对系统的磁盘I/O操作进行监视。它的输出主要显示磁盘读写操作的统计信息，同时也会给出CPU使用情况。同vmstat一样，iostat也不能对某个进程进行深入分析，仅对系统的整体情况进行分析。</p>
<p><strong>命令参数：</strong></p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">c 显示CPU使用情况</span></span><br><span class="line"><span class="ruby">-d 显示磁盘使用情况</span></span><br><span class="line"><span class="ruby">-k 以 KB 为单位显示</span></span><br><span class="line"><span class="ruby">-m 以 M 为单位显示</span></span><br><span class="line"><span class="ruby">-N 显示磁盘阵列(LVM) 信息</span></span><br><span class="line"><span class="ruby">-n 显示NFS 使用情况</span></span><br><span class="line"><span class="ruby">-p[磁盘] 显示磁盘和分区的情况</span></span><br><span class="line"><span class="ruby">-t 显示终端和CPU的信息</span></span><br><span class="line"><span class="ruby">-x 显示详细信息</span></span><br><span class="line"><span class="ruby">-V 显示版本信息</span></span><br></pre></td></tr></table></figure>
<p><strong>输出结果：</strong></p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">cpu属性值说明：</span><br><span class="line"></span><br><span class="line">%user：CPU处在用户模式下的时间百分比。</span><br><span class="line">%nice：CPU处在带NICE值的用户模式下的时间百分比。</span><br><span class="line">%system：CPU处在系统模式下的时间百分比。</span><br><span class="line">%iowait：CPU等待输入输出完成时间的百分比。</span><br><span class="line">%steal：管理程序维护另一个虚拟处理器时，虚拟CPU的无意识等待时间百分比。</span><br><span class="line">%idle：CPU空闲时间百分比。</span><br><span class="line"></span><br><span class="line">备注：如果%iowait的值过高，表示硬盘存在<span class="keyword">I</span>/<span class="keyword">O</span>瓶颈，%idle值高，表示CPU较空闲，如果%idle值高但系统响应慢时，有可能是CPU等待分配内存，此时应加大内存容量。%idle值如果持续低于<span class="number">10</span>，那么系统的CPU处理能力相对较低，表明系统中最需要解决的资源是CPU。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">disk属性值说明：（iostat -x）</span><br><span class="line"></span><br><span class="line">rrqm/s:  每秒进行 merge 的读操作数目。即 rmerge/s</span><br><span class="line">wrqm/s:  每秒进行 merge 的写操作数目。即 wmerge/s</span><br><span class="line">r/s:  每秒完成的读 <span class="keyword">I</span>/<span class="keyword">O</span> 设备次数。即 rio/s</span><br><span class="line">w/s:  每秒完成的写 <span class="keyword">I</span>/<span class="keyword">O</span> 设备次数。即 wio/s</span><br><span class="line">rsec/s:  每秒读扇区数。即 rsect/s</span><br><span class="line">wsec/s:  每秒写扇区数。即 wsect/s</span><br><span class="line">rkB/s:  每秒读<span class="keyword">K</span>字节数。是 rsect/s 的一半，因为每扇区大小为<span class="number">512</span>字节。</span><br><span class="line">wkB/s:  每秒写<span class="keyword">K</span>字节数。是 wsect/s 的一半。</span><br><span class="line">avgrq-sz:  平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的数据大小 (扇区)。</span><br><span class="line">avgqu-sz:  平均<span class="keyword">I</span>/<span class="keyword">O</span>队列长度。</span><br><span class="line">await:  平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的等待时间 (毫秒)。</span><br><span class="line">svctm: 平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的服务时间 (毫秒)。</span><br><span class="line">%util:  一秒中有百分之多少的时间用于 <span class="keyword">I</span>/<span class="keyword">O</span> 操作，即被io消耗的cpu百分比</span><br><span class="line"></span><br><span class="line">备注：如果 %util 接近 <span class="number">100</span>%，说明产生的<span class="keyword">I</span>/<span class="keyword">O</span>请求太多，<span class="keyword">I</span>/<span class="keyword">O</span>系统已经满负荷，该磁盘可能存在瓶颈。如果 svctm 比较接近 await，说明 <span class="keyword">I</span>/<span class="keyword">O</span> 几乎没有等待时间；如果 await 远大于 svctm，说明<span class="keyword">I</span>/<span class="keyword">O</span> 队列太长，io响应太慢，则需要进行必要优化。如果avgqu-sz比较大，也表示有当量io在等待。</span><br></pre></td></tr></table></figure>
<ul>
<li>定时显示所有信息（每隔 2秒刷新显示，且显示3次）</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<ul>
<li>以kB为单位显示所有信息</li>
</ul>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">iostat</span> -k <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="4、traceroute"><a href="#4、traceroute" class="headerlink" title="4、traceroute"></a>4、traceroute</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute www<span class="selector-class">.baidu</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure>
<h3 id="5、telnet"><a href="#5、telnet" class="headerlink" title="5、telnet"></a>5、telnet</h3><ul>
<li>退出，ctrl+]  出现telnet后，再输入quit</li>
</ul>
<h1 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h1><h2 id="lsof-一切皆文件"><a href="#lsof-一切皆文件" class="headerlink" title="lsof (一切皆文件)"></a>lsof (一切皆文件)</h2><p><a href="http://man.linuxde.net/lsof" target="_blank" rel="external">命令详情</a></p>
<p>查看你进程开打的文件，打开文件的进程，进程打开的端口(TCP、UDP)</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查看sys.log文件被哪个进程打开</span></span><br><span class="line">lsof sys.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查看端口被哪个进程占用</span></span><br><span class="line">lsof  -i：端口号</span><br></pre></td></tr></table></figure>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查看各个进程打开的文件数量</span></span><br><span class="line">lsof -<span class="keyword">n</span> |awk '&#123;<span class="keyword">print</span> <span class="variable">$2&#125;</span> <span class="string">" "</span> <span class="variable">$3</span>'|<span class="keyword">sort</span>|uniq -c |<span class="keyword">sort</span> -nr|<span class="keyword">more</span></span><br></pre></td></tr></table></figure>
<h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">df</span> -hl</span><br><span class="line">df -h  查看磁盘的使用情况</span><br><span class="line">磁盘的使用情况</span><br></pre></td></tr></table></figure>
<h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">du</span> -hl</span><br><span class="line">当前目录下的最叶子目录的大小</span><br></pre></td></tr></table></figure>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">du -<span class="keyword">sch </span>*</span><br><span class="line">当前目录下的各目录的大小</span><br></pre></td></tr></table></figure>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>文件查找</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find</span> . -name <span class="string">"*蝙蝠侠*"</span></span><br><span class="line"># 找出当前目录以及其所有子目录下所有名字中包含“蝙蝠侠”三字的文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> . -inmae <span class="string">'*hello*'</span> -maxdepth <span class="number">1</span></span><br><span class="line">不区分大小写，在当前目录查找，不包括子目录</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> . -name <span class="string">"*.rmvb"</span> -maxdepth <span class="number">1</span></span><br><span class="line"># 找出当前目录（不包括子目录）下所有名字中后缀为<span class="string">".rmvb"</span>的文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> . -name sys.<span class="built_in">log</span></span><br><span class="line">当前目录下查找sys.<span class="built_in">log</span>文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> . -name <span class="string">"sy*log"</span></span><br><span class="line">查找文件支持通配符</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> . -size +<span class="number">20</span>M</span><br><span class="line">查找当前目录下大小超过<span class="number">20</span>M的文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> . -size +<span class="number">20</span>M | xargs <span class="keyword">ls</span> -<span class="keyword">lh</span></span><br><span class="line">查找当前目录下大小超过<span class="number">20</span>M的文件，并计算文件大小</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> -<span class="built_in">type</span> <span class="keyword">f</span> -<span class="built_in">printf</span> <span class="string">'%s %p\n'</span> |<span class="keyword">sort</span> -nr | head</span><br><span class="line">查找占用空间最大的<span class="number">10</span>个文件</span><br></pre></td></tr></table></figure>
<h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--递归查找目录下含有该字符串的所有文件</span><br><span class="line"><span class="keyword">grep</span> -rn <span class="string">"data_chushou_pay_info"</span>  /home/hadoop/nisj/automationDemand/</span><br><span class="line"></span><br><span class="line">--查找当前目录下后缀名过滤的文件</span><br><span class="line"><span class="keyword">grep</span> -rn <span class="string">"data_chushou_pay_info"</span> *.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>
<h2 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h2><p>从指定点开始将文件标准输出</p>
<ul>
<li>显示文件最后5行内容</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -<span class="keyword">n</span> 5 <span class="keyword">test</span>.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<ul>
<li>实时显示文件内容</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f <span class="keyword">test</span>.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping baidu<span class="selector-class">.com</span> &gt; <span class="number">1</span><span class="selector-class">.txt</span> &amp;</span><br><span class="line">后台以守护进程的方式，将ping命令的返回结果写入 <span class="number">1</span>.txt</span><br></pre></td></tr></table></figure>
<h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每行按空格或TAB分割，输出文本中的1、4项</span></span><br><span class="line"> <span class="attribute">awk</span> <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$4</span>&#125;'</span> log.txt</span><br></pre></td></tr></table></figure>
<h2 id="dirname"><a href="#dirname" class="headerlink" title="dirname"></a>dirname</h2><p>在命令行状态下单纯执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> `dirname <span class="variable">$0</span>`</span><br></pre></td></tr></table></figure></p>
<p>是毫无意义的。</p>
<p>因为他返回当前路径的”.”。<strong>这个命令写在脚本文件里才有作用，他返回这个脚本文件放置的目录，并可以根据这个目录来定位所要运行程序的相对位置（绝对位置除外）。</strong></p>
<ul>
<li>参考<code>/Users/zhouxiaowu/Dropbox/commonShell</code>  运行  <code>dirnameDemo.sh</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BASE_DIR=`dirname <span class="variable">$0</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$BASE_DIR</span></span><br><span class="line"><span class="built_in">cd</span> `dirname <span class="variable">$0</span>`</span><br><span class="line"><span class="built_in">echo</span> `<span class="built_in">pwd</span>`</span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line"><span class="regexp">/Users/</span>zhouxiaowu<span class="regexp">/Dropbox/</span>commonShell</span><br></pre></td></tr></table></figure>
<p>这样就可以知道一些和脚本一起部署的文件的位置了，只要知道相对位置就可以根据这个目录来定位，而可以不用关心绝对位置。这样脚本的可移植性就提高了，扔到任何一台服务器，（如果是部署脚本）都可以执行。</p>
<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [<span class="string">-hnV</span>][<span class="symbol">-e&lt;script&gt;</span>][<span class="string">-f&lt;script文件&gt;</span>][<span class="symbol">文本文件</span>]</span><br></pre></td></tr></table></figure>
<h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby"> -e&lt;script&gt;或--expression=&lt;script&gt; 以选项中指定的script来处理输入的文本文件。</span></span><br><span class="line"><span class="ruby">- -f&lt;script文件&gt;或--file=&lt;script文件&gt; 以选项中指定的script文件来处理输入的文本文件。</span></span><br><span class="line"><span class="ruby">- -h或--help 显示帮助。</span></span><br><span class="line"><span class="ruby">- -n或--quiet或--silent 仅显示script处理后的结果。</span></span><br><span class="line"><span class="ruby">- -V或--version 显示版本信息。</span></span><br></pre></td></tr></table></figure>
<h3 id="动作说明"><a href="#动作说明" class="headerlink" title="动作说明"></a>动作说明</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- <span class="selector-tag">a</span> ：新增， <span class="selector-tag">a</span> 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～</span><br><span class="line">- c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</span><br><span class="line">- d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；</span><br><span class="line">- <span class="selector-tag">i</span> ：插入， <span class="selector-tag">i</span> 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</span><br><span class="line">- <span class="selector-tag">p</span> ：打印，亦即将某个选择的数据印出。通常 <span class="selector-tag">p</span> 会与参数 sed -n 一起运行～</span><br><span class="line">- s ：取代，可以直接进行取代的工作，通常这个 s 的动作可以搭配正规表示法！例如 <span class="number">1</span>,<span class="number">20s</span>/old/new/g 就是啦！</span><br></pre></td></tr></table></figure>
<h3 id="批量替换文件内容"><a href="#批量替换文件内容" class="headerlink" title="批量替换文件内容"></a>批量替换文件内容</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">格式: sed -i <span class="string">"s/查找字段/替换字段/g"</span> `grep 查找字段 -rl 路径`</span><br><span class="line">（centos测试有效，mac未生效）</span><br><span class="line"></span><br><span class="line">替换/root/test目录下的所有文件，book替换为apple　　</span><br><span class="line">sed -i <span class="string">"s/book/apple/g"</span> `grep book -rl /root/test`</span><br></pre></td></tr></table></figure>
<ul>
<li>在testfile文件的第四行后添加一行</li>
</ul>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e <span class="number">4</span>a\<span class="keyword">new</span><span class="type">Line</span> testfile</span><br></pre></td></tr></table></figure>
<ul>
<li>全部替换，并不会改变文件内容</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'s/book/books/g'</span> <span class="keyword">file</span></span><br><span class="line"></span><br><span class="line">sed -e <span class="string">'s/book/books/g'</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
<ul>
<li>从第2处开始替换</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> sksksksksksk | sed <span class="string">'s/sk/SK/2g'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>列印行号，同时，请将第 2~5 行删除</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl <span class="regexp">/etc/</span>passwd | sed <span class="string">'2,5d'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>只要删除第 2 行</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl <span class="regexp">/etc/</span>passwd | sed <span class="string">'2d'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>要删除第 3 到最后一行</li>
</ul>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nl</span> /etc/passwd | sed <span class="string">'3,<span class="variable">$d</span>'</span></span><br></pre></td></tr></table></figure>
<h1 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">w                       查看活动用户</span><br><span class="line">id &lt;用户名&gt;              查看指定用户信息</span><br><span class="line">last                    查看用户登录日志</span><br><span class="line">cut -d: -f1 /etc/passwd    查看系统所有用户</span><br><span class="line">cut -d: -f1 /etc<span class="built_in">/group </span>    查看系统所有组</span><br><span class="line">crontab -l              查看当前用户的计划任务</span><br></pre></td></tr></table></figure>
<h1 id="命令行操作"><a href="#命令行操作" class="headerlink" title="命令行操作"></a>命令行操作</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctrl+<span class="selector-tag">a</span> 跳到行首</span><br><span class="line">ctrl+e 跳到行尾</span><br><span class="line">ctrl+u 删除整行</span><br></pre></td></tr></table></figure>
<h1 id="输出重定向"><a href="#输出重定向" class="headerlink" title="输出重定向"></a>输出重定向</h1><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">date &gt; <span class="keyword">test</span>.<span class="keyword">log</span> 标准输出覆盖方式</span><br><span class="line">date &gt;&gt; <span class="keyword">test</span>.<span class="keyword">log</span> 标准输出追加方式</span><br><span class="line">datea 2&gt;<span class="keyword">test</span>.<span class="keyword">log</span> 错误输出覆盖方式，&gt;后要紧挨着文件</span><br><span class="line">datea 2&gt;&gt;<span class="keyword">test</span>.<span class="keyword">log</span> 错误输出追加方式,&gt;后要紧挨着文件</span><br><span class="line"></span><br><span class="line">ifconfig &gt;&gt; <span class="keyword">test</span>.<span class="keyword">log</span> 2&gt;&amp;1   如果是正确输出留空格，错误输出到标准输出中，紧挨着</span><br><span class="line"></span><br><span class="line">ifconfig &amp;&gt;&gt; <span class="keyword">test</span>.<span class="keyword">log</span> 以追加的方式，错误和正确都输出到文件</span><br><span class="line"></span><br><span class="line">ifconfig &gt;&gt; 文件1 2&gt;&gt;文件2 以追加的方式，正确和错误分别到不同的文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">ls</span> &amp;&gt;/dev/null 正确和错误都到null</span><br></pre></td></tr></table></figure>
<h1 id="输入重定向"><a href="#输入重定向" class="headerlink" title="输入重定向"></a>输入重定向</h1><ul>
<li><code>wc</code>命令，输完，ctrl+d 统计</li>
<li><code>wc &lt; test.log</code> 统计文件的行、单词、字符</li>
</ul>
<h1 id="管道符"><a href="#管道符" class="headerlink" title="管道符"></a>管道符</h1><h2 id="逻辑与或"><a href="#逻辑与或" class="headerlink" title="逻辑与或"></a>逻辑与或</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">date ; <span class="keyword">ls</span> ;   分号，顺序执行</span><br><span class="line"></span><br><span class="line"><span class="keyword">ls</span> &amp;&amp; date 命令1 &amp;&amp; 命令2 命令1正确执行，才会执行2</span><br><span class="line"></span><br><span class="line">ll || date 命令1正确执行，命令2不会执行</span><br><span class="line"></span><br><span class="line">lsasdfsf  &amp;&amp; <span class="keyword">echo</span> <span class="string">"yes"</span> || <span class="keyword">echo</span> <span class="string">"no"</span>  判断命令是否正确</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">ls</span> || <span class="keyword">echo</span> <span class="string">"no"</span> &amp;&amp; <span class="keyword">echo</span> <span class="string">"yes"</span> 等同于 （<span class="keyword">ls</span> || <span class="keyword">echo</span> <span class="string">"no"</span>） &amp;&amp; <span class="keyword">echo</span> <span class="string">"yes"</span></span><br></pre></td></tr></table></figure>
<h2 id="管道符-1"><a href="#管道符-1" class="headerlink" title="管道符"></a>管道符</h2><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ll | <span class="type">more</span></span><br><span class="line">netstat -an | <span class="type">grep</span> ESTABLISHED | <span class="type">wc</span> -l   统计多少行</span><br></pre></td></tr></table></figure>
<h2 id="统配符"><a href="#统配符" class="headerlink" title="统配符"></a>统配符</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls aa<span class="bullet">*  *</span> 0或多个字符</span><br><span class="line">ls aa? 一个</span><br><span class="line">ls aa[0-9] 一个选项</span><br><span class="line">ls aa[<span class="string">0-9</span>][<span class="symbol">0-9</span>]</span><br><span class="line">ls aa[^0-9] 取非</span><br><span class="line">ls aa[^0-9]*</span><br></pre></td></tr></table></figure>
<h2 id="变量，反引号，"><a href="#变量，反引号，" class="headerlink" title="变量，反引号，$()"></a>变量，反引号，$()</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aa=123</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$aa</span>  输出123</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$aa</span>"</span> 123</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'$aa'</span> <span class="string">'$aa'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">aa</span>=`ls`  反引号，先执行结果，再赋值变量</span><br><span class="line">echo <span class="variable">$aa</span></span><br></pre></td></tr></table></figure>
<h3 id="单小括号"><a href="#单小括号" class="headerlink" title="$() 单小括号"></a><code>$()</code> 单小括号</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aa=<span class="variable">$(ls)</span>  和反引号一样，先执行结果，再赋值变量</span><br><span class="line">echo $aa</span><br></pre></td></tr></table></figure>
<h1 id="shell脚本"><a href="#shell脚本" class="headerlink" title="shell脚本"></a>shell脚本</h1><h2 id="查当前脚本所在路径"><a href="#查当前脚本所在路径" class="headerlink" title="查当前脚本所在路径"></a>查当前脚本所在路径</h2><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script_pwd = $( cd $(<span class="keyword">dirname</span> $0) &amp;&amp; <span class="keyword">pwd</span> )</span><br></pre></td></tr></table></figure>
<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><h3 id="文件存在、权限判断"><a href="#文件存在、权限判断" class="headerlink" title="文件存在、权限判断 [  ]"></a>文件存在、权限判断 [  ]</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">d 文件是否存在，为目录</span></span><br><span class="line"><span class="ruby">-e 文件是否存在</span></span><br><span class="line"><span class="ruby">-f 文件是否存在，为文件</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">-r 文件是否存在，有读权限  不会区分当前用户是否有读权限</span></span><br><span class="line"><span class="ruby">-w 文件是否存在，有写权限</span></span><br><span class="line"><span class="ruby">-x 文件是否存在，有可执行权限</span></span><br></pre></td></tr></table></figure>
<ul>
<li>[] 在shell中是个命令，它左右必须有空格,才能识别里面的字符串</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ -<span class="keyword">f</span> hello.<span class="keyword">sh</span> ] &amp;&amp; <span class="keyword">echo</span> <span class="string">"yes"</span> || <span class="keyword">echo</span> <span class="string">"no"</span>   测试文件是否存在  注意不能颠倒 &amp;&amp; || 顺序</span><br><span class="line"></span><br><span class="line">[ -<span class="keyword">w</span> hello.<span class="keyword">sh</span> ] &amp;&amp; <span class="keyword">echo</span> <span class="string">"yes"</span> || <span class="keyword">echo</span> <span class="string">"no"</span></span><br></pre></td></tr></table></figure>
<h3 id="文件比较"><a href="#文件比较" class="headerlink" title="文件比较"></a>文件比较</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">nf 新</span></span><br><span class="line"><span class="ruby">-ef 相同</span></span><br><span class="line"><span class="ruby">-of 旧</span></span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ ./hello.<span class="keyword">sh</span> -ef ./hello.<span class="keyword">sh</span> ] &amp;&amp; <span class="keyword">echo</span> yes || <span class="keyword">echo</span> <span class="keyword">no</span>   两个文件是否相同</span><br></pre></td></tr></table></figure>
<h3 id="整数比较"><a href="#整数比较" class="headerlink" title="整数比较"></a>整数比较</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">eq 相等</span></span><br><span class="line"><span class="ruby">-ne 不等</span></span><br><span class="line"><span class="ruby">-gt 大于</span></span><br><span class="line"><span class="ruby">-lt 小于</span></span><br><span class="line"><span class="ruby">-ge 大于等于</span></span><br><span class="line"><span class="ruby">-le 小于等于</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[</span> <span class="number">23</span> <span class="bullet">-ge</span> <span class="number">22</span> <span class="string">]</span>  <span class="string">&amp;&amp;</span> <span class="string">echo</span> <span class="literal">yes</span> <span class="string">||</span> <span class="string">echo</span> <span class="literal">no</span>    <span class="string">整数比较</span></span><br></pre></td></tr></table></figure>
<h3 id="字符串比较"><a href="#字符串比较" class="headerlink" title="字符串比较"></a>字符串比较</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-z 为空</span><br><span class="line">-n 不为空</span><br><span class="line"><span class="section">== 相等</span></span><br><span class="line">!= 不等</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">name</span>=hhh</span><br><span class="line">[ -n <span class="string">"<span class="variable">$name</span>"</span> ] &amp;&amp; echo <span class="literal">yes</span> || echo <span class="literal">no</span>  不为空，输出<span class="literal">yes</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">aa</span>=22 ; <span class="attribute">bb</span>=22</span><br><span class="line">[ <span class="string">"<span class="variable">$aa</span>"</span>==<span class="string">"<span class="variable">$bb</span>"</span> ] &amp;&amp; echo <span class="literal">yes</span> || echo <span class="literal">no</span>  字符串比较是否相等</span><br><span class="line">[ <span class="string">"<span class="variable">$aa</span>"</span> -eq <span class="string">"<span class="variable">$bb</span>"</span> ] &amp;&amp; echo <span class="literal">yes</span> || echo <span class="literal">no</span> 数值整数比较</span><br></pre></td></tr></table></figure>
<h3 id="与或非条件"><a href="#与或非条件" class="headerlink" title="与或非条件"></a>与或非条件</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">a 与</span></span><br><span class="line"><span class="ruby">-o 或</span></span><br><span class="line"><span class="ruby">! 非</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">aa</span>=11</span><br><span class="line">[ -n <span class="string">"<span class="variable">$aa</span>"</span> -a <span class="string">"<span class="variable">$aa</span>"</span> -gt 23 ] &amp;&amp; echo <span class="literal">yes</span> || echo <span class="literal">no</span>  字符串不为空，数值大于23，输出<span class="literal">yes</span></span><br></pre></td></tr></table></figure>
<h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><p><strong>单分支</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ 条件 ] ；<span class="keyword">then</span></span><br><span class="line">	程序</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">或者 ， [] 等于 <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ 条件 ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">	程序</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>判断当前用户 <code>Dropbox/commonShell/isZhouxiaowu.sh</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">判断是否zhouxiaowu用户</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">获取当前的用户名</span></span><br><span class="line">u=$(env | grep USER= | cut -d "=" -f 2)</span><br><span class="line">echo $u</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">判断是否等于zhouxiaowu</span></span><br><span class="line">if [ "$u" == "zhouxiaowu" ] ; then</span><br><span class="line">        echo "yes is zhouxiaowu!"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<ul>
<li>获取磁盘使用量，做告警<code>Dropbox/commonShell/diskWarning.sh</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取磁盘的使用量，awk获取第5个单词，cut按%字符分隔，取第1个</span></span><br><span class="line">amount=$(df -h | grep disk1 | awk <span class="string">'&#123;print $5&#125;'</span> | cut -d <span class="string">"%"</span> -f 1)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$amount</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$amount</span> -gt 90 ] ; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"磁盘使用量超过90%"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p><strong>双分支</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ 条件 ]</span><br><span class="line"> 	<span class="keyword">then</span></span><br><span class="line"> 		执行语句</span><br><span class="line"> 	<span class="keyword">else</span></span><br><span class="line">     	执行语句</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>判读是否目录<code>Dropbox/commonShell/isDir.sh</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入读取</span></span><br><span class="line"><span class="built_in">read</span> -t 30 -p <span class="string">"文件名："</span> dir</span><br><span class="line"><span class="comment"># echo $dir</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断是否目录</span></span><br><span class="line"><span class="keyword">if</span> [ -d <span class="string">"<span class="variable">$dir</span>"</span> ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">" is dir"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">" is not dir"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>判断tomcat是否启动 <code>Dropbox/commonShell/isTomcatStarted.sh</code></li>
</ul>
<p><strong>多分支</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ 条件1 ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">		执行语句</span><br><span class="line"><span class="keyword">elif</span> [ 条件2 ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">		执行语句</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">		执行语句</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $?  输出脚本的<span class="keyword">exit</span> 返回</span><br></pre></td></tr></table></figure>
<h3 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a>case语句</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> $变量 <span class="keyword">in</span></span><br><span class="line">	<span class="string">"值1"</span>)</span><br><span class="line">		执行语句</span><br><span class="line">		;;</span><br><span class="line">	<span class="string">"值2"</span>)</span><br><span class="line">		执行语句</span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		默认语句</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<h5 id="for语句"><a href="#for语句" class="headerlink" title="for语句"></a>for语句</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量 <span class="keyword">in</span> 值1 值2 值3 ...</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		执行语句</span><br><span class="line">	<span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(( <span class="built_in">i</span>=<span class="number">0</span>;<span class="built_in">i</span>&lt;=<span class="number">100</span>;<span class="built_in">i</span>=<span class="built_in">i</span>+<span class="number">1</span> ))</span><br><span class="line">	do</span><br><span class="line">		执行语句</span><br><span class="line">	done</span><br></pre></td></tr></table></figure>
<p>写在一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ` seq 10000 `; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">"hello sxt <span class="variable">$i</span>"</span> &gt;&gt; test.txt;<span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<ul>
<li>批量解压文件 <code>Dropbox/commonShell/for_tar.sh</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /Users/zhouxiaowu/install/test_tar</span><br><span class="line"></span><br><span class="line">ls *.tar.gz &gt; ls.log</span><br><span class="line">ls *.tgz &gt;&gt; ls.log</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $( cat ls.log  )</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"file is  <span class="variable">$i</span>"</span></span><br><span class="line">		tar -zxf <span class="variable">$i</span> &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">rm ls.log</span><br></pre></td></tr></table></figure>
<p><strong>注意 i 不需要 $，引用变量才需要，定义和赋值变量不需要</strong></p>
<ul>
<li>1到100求和</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">s=0</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(( i=0;i&lt;=100;i=i+1  ))</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		s=$(( <span class="variable">$s</span>+<span class="variable">$i</span>  ))</span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$s</span></span><br></pre></td></tr></table></figure>
<h5 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [ 条件语句 ]</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		执行语句</span><br><span class="line">	<span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<ul>
<li>1到100求和</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">i=1</span><br><span class="line">s=0</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -le 100 ]</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">                s=$(( <span class="variable">$s</span>+<span class="variable">$i</span> ))</span><br><span class="line">                i=$(( <span class="variable">$i</span>+1 ))</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$s</span></span><br></pre></td></tr></table></figure>
<p><strong>注意赋值 s=$(( $s+$i ))</strong></p>
<h5 id="until语句"><a href="#until语句" class="headerlink" title="until语句"></a>until语句</h5><ul>
<li>条件不成立执行</li>
</ul>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">until</span> [ 条件语句 ]</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		执行语句</span><br><span class="line">	done</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从1到100求和</span></span><br><span class="line"></span><br><span class="line">s=0</span><br><span class="line">i=1</span><br><span class="line"></span><br><span class="line">until [ <span class="variable">$i</span> -gt 100 ]</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">                s=$(( <span class="variable">$s</span>+<span class="variable">$i</span> ))</span><br><span class="line">                i=$(( <span class="variable">$i</span>+1 ))</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"the sum is <span class="variable">$s</span>"</span></span><br></pre></td></tr></table></figure>
<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">env</span> 查看环境变量</span><br></pre></td></tr></table></figure>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bash</span></span><br><span class="line"><span class="keyword">bash</span></span><br><span class="line"><span class="keyword">pstree </span>查看pstree</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#系统下的所有变量</span></span><br><span class="line">set</span><br><span class="line"><span class="builtin-name">set</span> -u 报错提示</span><br><span class="line">unset aa  删除变量</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 不能有空格</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 字母和下划线开头，字母数字下划线组成</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 自定义变量只对当前shell生效</span></span><br><span class="line">x=5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 变量调用</span></span><br><span class="line">echo $x</span><br></pre></td></tr></table></figure>
<ul>
<li><p>PATH环境变量</p>
</li>
<li><p>PS1环境变量</p>
</li>
</ul>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ echo $PS1</span><br><span class="line">$&#123;ret_status&#125; %&#123;$fg[cyan]%&#125;%c%&#123;$reset_color%&#125; $(git_prompt_info)</span><br></pre></td></tr></table></figure>
<h5 id="变量叠加"><a href="#变量叠加" class="headerlink" title="变量叠加"></a>变量叠加</h5><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x=123</span><br><span class="line"><span class="comment"># 一般用这种</span></span><br><span class="line">x=<span class="string">"$x"</span>456</span><br><span class="line">x=<span class="variable">$(x)</span>789</span><br></pre></td></tr></table></figure>
<h5 id="0-1-2的含义解释"><a href="#0-1-2的含义解释" class="headerlink" title="$@,$0,$1,$2的含义解释"></a><code>$@,$0,$1,$2的含义解释</code></h5><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$?  最后运行的命令的结束代码（返回值），正确为<span class="number">0</span>,不确定非<span class="number">0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$ 查看Shell本身的PID</span><br><span class="line">$!  查看Shell后台Process的PID</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"pid is $$"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">0   Shell本身的文件名</span></span><br><span class="line"><span class="meta">$</span><span class="bash">1～<span class="variable">$n</span>  添加到Shell的各参数值。<span class="variable">$1</span>是第1参数、<span class="variable">$2</span>是第2参数…。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">-  使用Set命令设定的Flag一览</span></span><br><span class="line"><span class="meta">$</span><span class="bash">*   所有参数列表。如<span class="string">"$*"</span>用「<span class="string">"」括起来的情况、以"</span><span class="variable">$1</span> <span class="variable">$2</span> … <span class="variable">$n</span><span class="string">"的形式输出所有参数。</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">@   所有参数列表。如<span class="string">"<span class="variable">$@</span>"</span>用「<span class="string">"」括起来的情况、以"</span><span class="variable">$1</span><span class="string">" "</span><span class="variable">$2</span><span class="string">" … "</span><span class="variable">$n</span><span class="string">" 的形式输出所有参数。</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"><span class="comment">#   添加到Shell的参数个数</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">"$*"</span></span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$y</span></span><br><span class="line">	<span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">➜  commonShell ./param3.sh <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>  $*</span><br><span class="line"><span class="number">1</span>  $@</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"$$"</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"$!"</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"$?"</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"$*"</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"<span class="variable">$#</span>"</span>  个数2</span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"<span class="variable">$0</span>"</span>  输出Dropbox/commonShell/var.sh</span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"<span class="variable">$1</span>"</span>  输出qq</span><br><span class="line"><span class="built_in">printf</span> <span class="string">"The complete list is %s\n"</span> <span class="string">"<span class="variable">$2</span>"</span>  输出123</span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ Dropbox/commonShell/var.<span class="keyword">sh</span> qq <span class="number">123</span></span><br><span class="line"></span><br><span class="line">The <span class="built_in">complete</span> <span class="keyword">list</span> <span class="keyword">is</span> <span class="number">1626</span></span><br><span class="line">The <span class="built_in">complete</span> <span class="keyword">list</span> <span class="keyword">is</span></span><br><span class="line">The <span class="built_in">complete</span> <span class="keyword">list</span> <span class="keyword">is</span> <span class="number">0</span></span><br><span class="line">The <span class="built_in">complete</span> <span class="keyword">list</span> <span class="keyword">is</span> qq <span class="number">123</span>  $*输出</span><br><span class="line">The <span class="built_in">complete</span> <span class="keyword">list</span> <span class="keyword">is</span> qq  $@输出</span><br><span class="line">The <span class="built_in">complete</span> <span class="keyword">list</span> <span class="keyword">is</span> <span class="number">123</span></span><br></pre></td></tr></table></figure>
<h5 id="点号"><a href="#点号" class="headerlink" title="点号"></a>点号</h5><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">. /<span class="class"><span class="keyword">lib</span>/<span class="title">init</span>/<span class="title">vars</span>.<span class="title">sh</span></span></span><br><span class="line">. /<span class="class"><span class="keyword">lib</span>/<span class="title">lsb</span>/<span class="title">init</span>-<span class="title">functions</span>&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">以往执行文件时都是用./file_name的形式，查阅了资料得知：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、 如果我们要执行某个文件，但是此文件不可执行，此时我们要用chmod u+x file_name来使文件具有可执行权限</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、可是有时我们不想更改此文件的执行权限，但又想执行此文件，可以采用(点号--空格--文件名)的形式来执行一个脚本（只有root用户才可以这么做）</span><br></pre></td></tr></table></figure>
<h5 id="语系变量locale"><a href="#语系变量locale" class="headerlink" title="语系变量locale"></a>语系变量locale</h5><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">locale</span><br><span class="line"></span><br><span class="line">LANG=<span class="string">"zh_CN.UTF-8"</span> 定义系统主语系</span><br><span class="line">LC_COLLATE=<span class="string">"zh_CN.UTF-8"</span></span><br><span class="line">LC_CTYPE=<span class="string">"zh_CN.UTF-8"</span></span><br><span class="line">LC_MESSAGES=<span class="string">"zh_CN.UTF-8"</span></span><br><span class="line">LC_MONETARY=<span class="string">"zh_CN.UTF-8"</span></span><br><span class="line">LC_NUMERIC=<span class="string">"zh_CN.UTF-8"</span></span><br><span class="line">LC_TIME=<span class="string">"zh_CN.UTF-8"</span></span><br><span class="line">LC_ALL= 定义整体语系</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$LANG</span> 查看系统当前语系</span><br><span class="line"></span><br><span class="line"><span class="built_in">local</span> -a | more 查看linux支持的所有语系</span><br><span class="line"></span><br><span class="line">zhcon 插件</span><br></pre></td></tr></table></figure>
<h5 id="read"><a href="#read" class="headerlink" title="read"></a>read</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -p提示 -t时间内输入 name变量</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"please input your name : "</span> -t 30 name</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$name</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 安全输入</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"please input your passwd : "</span> -s passwd</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"\n"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$passwd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 输入字符个数</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"please input sex M/F : "</span> -n 1 sex</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"\n"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$sex</span></span><br></pre></td></tr></table></figure>
<h4 id="数值运算"><a href="#数值运算" class="headerlink" title="数值运算"></a>数值运算</h4><h5 id="1-2-双小括号"><a href="#1-2-双小括号" class="headerlink" title="$(( $1+$2 ))  双小括号"></a><code>$(( $1+$2 ))</code>  双小括号</h5><p><strong>注意两边留空格</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">num1=<span class="variable">$1</span></span><br><span class="line">num2=<span class="variable">$2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#数值计算</span></span><br><span class="line">sum=$(( <span class="variable">$1</span> + <span class="variable">$2</span> ))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"sum is <span class="variable">$sum</span>"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo $(( (<span class="number">11</span>+<span class="number">3</span>)*<span class="number">3</span>/<span class="number">2</span> ))  <span class="number">21</span></span><br><span class="line">echo $(( <span class="number">10</span>%<span class="number">3</span> ))  <span class="number">1</span></span><br><span class="line">echo $(( <span class="number">1</span>&amp;&amp;<span class="number">0</span> )) <span class="number">0</span></span><br><span class="line">echo $(( <span class="number">1</span>||<span class="number">0</span> )) <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h5 id="运算符-中括号"><a href="#运算符-中括号" class="headerlink" title="$[运算符]` 中括号"></a>$[运算符]` 中括号</h5><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dd</span>=$[<span class="variable">$aa</span>+<span class="variable">$bb</span>]</span><br></pre></td></tr></table></figure>
<h5 id="expr-aa-bb"><a href="#expr-aa-bb" class="headerlink" title="$(expr $aa + $bb)"></a><code>$(expr $aa + $bb)</code></h5><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dd</span>=$(expr <span class="variable">$aa</span> + <span class="variable">$bb</span>)  +两侧必须有空格</span><br></pre></td></tr></table></figure>
<h5 id="declare变量声明"><a href="#declare变量声明" class="headerlink" title="declare变量声明"></a>declare变量声明</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">declare [<span class="string">+/-</span>][<span class="symbol">选项</span>] 变量名</span><br><span class="line"><span class="bullet">- </span>设定</span><br><span class="line"><span class="bullet">+ </span>取消变量的类型熟悉性</span><br><span class="line">-a 数组</span><br><span class="line">-i integer</span><br><span class="line">-x 环境变量</span><br><span class="line">-r 只读</span><br><span class="line">-p 输出类型  declare -p cc</span><br></pre></td></tr></table></figure>
<ul>
<li>定义数组</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">movie[0]=aa</span><br><span class="line">movie[1]=bb</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;movie&#125;</span> 输出aa,第0个</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;movie[1]&#125;</span> 第1个</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;movie[*]&#125;</span> 全部</span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -a movie[2]=live</span><br></pre></td></tr></table></figure>
<ul>
<li>环境变量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> -x <span class="built_in">test</span>=123</span><br><span class="line">和<span class="built_in">export</span> <span class="built_in">test</span> 相似</span><br><span class="line"><span class="built_in">declare</span> -p  查看全部变量</span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -xr <span class="built_in">test</span>=456 只读 环境变量</span><br><span class="line"><span class="built_in">declare</span> +r <span class="built_in">test</span> 提示只读</span><br></pre></td></tr></table></figure>
<h5 id="变量置换方式-y-新值-大括号，默认值"><a href="#变量置换方式-y-新值-大括号，默认值" class="headerlink" title="变量置换方式 ${y-新值}大括号，默认值"></a>变量置换方式 <code>${y-新值}</code>大括号，默认值</h5><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">x</span>=<span class="variable">$&#123;y-新值&#125;</span> y没有设置，<span class="attribute">x</span>=新值；y存在，y为空值,x为空;设置y,x$y</span><br><span class="line"></span><br><span class="line"><span class="attribute">x</span>=<span class="variable">$&#123;y-2&#125;</span></span><br><span class="line">echo <span class="variable">$x</span>  为2</span><br><span class="line"></span><br><span class="line"><span class="attribute">y</span>=<span class="string">""</span></span><br><span class="line"><span class="attribute">x</span>=<span class="variable">$&#123;y-2&#125;</span></span><br><span class="line">echo <span class="variable">$x</span>  为空</span><br></pre></td></tr></table></figure>
<h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>1、查看所有安装的软件包</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rpm -qa</span></span><br></pre></td></tr></table></figure>
<p>2、查看环境变量</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">env</span></span><br></pre></td></tr></table></figure>
<p>3、Mac 删除git文件夹，删除svn文件夹</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd到该文件夹</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除文件夹下的所有 .svn 文件</span></span><br><span class="line"><span class="built_in">find</span> . -<span class="built_in">name</span> <span class="string">".svn"</span> | xargs rm -Rf</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除文件夹下的所有 .git 文件</span></span><br><span class="line"><span class="built_in">find</span> . -<span class="built_in">name</span> <span class="string">".git"</span> | xargs rm -Rf</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="更多资料："><a href="#更多资料：" class="headerlink" title="更多资料："></a>更多资料：</h3><p><a href="https://app.yinxiang.com/Home.action#n=b0fcd794-072a-4fab-9ac6-012b7b0ad147&amp;ses=4&amp;sh=2&amp;sds=5&amp;" target="_blank" rel="external">https://app.yinxiang.com/Home.action#n=b0fcd794-072a-4fab-9ac6-012b7b0ad147&amp;ses=4&amp;sh=2&amp;sds=5&amp;</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ops/" rel="tag"># ops</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/13/anatomy/" rel="next" title="anatomy">
                <i class="fa fa-chevron-left"></i> anatomy
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/05/13/常用脚本/" rel="prev" title="常用脚本">
                常用脚本 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/xiaowu_avatar.jpg"
                alt="周小伍 Joey" />
            
              <p class="site-author-name" itemprop="name">周小伍 Joey</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">150</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">43</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CPU相关、进程"><span class="nav-number">1.</span> <span class="nav-text">CPU相关、进程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#查看cpu硬件配置"><span class="nav-number">1.1.</span> <span class="nav-text">查看cpu硬件配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#top-命令"><span class="nav-number">1.2.</span> <span class="nav-text">top  命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#统计一个进程下的线程数"><span class="nav-number">1.3.</span> <span class="nav-text">统计一个进程下的线程数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看所有进程"><span class="nav-number">1.4.</span> <span class="nav-text">查看所有进程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ulimit-a-（显示当前的各种用户进程限制）"><span class="nav-number">1.5.</span> <span class="nav-text">ulimit -a （显示当前的各种用户进程限制）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#内存相关"><span class="nav-number">2.</span> <span class="nav-text">内存相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#vmstat"><span class="nav-number">2.1.</span> <span class="nav-text">vmstat</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IO及网络"><span class="nav-number">3.</span> <span class="nav-text">IO及网络</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#网络协议"><span class="nav-number">3.1.</span> <span class="nav-text">网络协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#OSI-七层模型-（应表会，传网数物）"><span class="nav-number">3.1.1.</span> <span class="nav-text">OSI 七层模型 （应表会，传网数物）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP-四层协议"><span class="nav-number">3.1.2.</span> <span class="nav-text">TCP/IP 四层协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用网络命令"><span class="nav-number">3.2.</span> <span class="nav-text">常用网络命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#清理dns缓存"><span class="nav-number">3.2.1.</span> <span class="nav-text">清理dns缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#curl"><span class="nav-number">3.2.2.</span> <span class="nav-text">curl</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#参考"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">参考</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tsar-–traffic：显示网络带宽"><span class="nav-number">3.2.3.</span> <span class="nav-text">tsar –traffic：显示网络带宽</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#netstat"><span class="nav-number">3.2.4.</span> <span class="nav-text">netstat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、-iostat"><span class="nav-number">3.2.5.</span> <span class="nav-text">3、 iostat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、traceroute"><span class="nav-number">3.2.6.</span> <span class="nav-text">4、traceroute</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、telnet"><span class="nav-number">3.2.7.</span> <span class="nav-text">5、telnet</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件"><span class="nav-number">4.</span> <span class="nav-text">文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#lsof-一切皆文件"><span class="nav-number">4.1.</span> <span class="nav-text">lsof (一切皆文件)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#df"><span class="nav-number">4.2.</span> <span class="nav-text">df</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#du"><span class="nav-number">4.3.</span> <span class="nav-text">du</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#find"><span class="nav-number">4.4.</span> <span class="nav-text">find</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#grep"><span class="nav-number">4.5.</span> <span class="nav-text">grep</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tail"><span class="nav-number">4.6.</span> <span class="nav-text">tail</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#awk"><span class="nav-number">4.7.</span> <span class="nav-text">awk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dirname"><span class="nav-number">4.8.</span> <span class="nav-text">dirname</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sed"><span class="nav-number">4.9.</span> <span class="nav-text">sed</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#参数说明"><span class="nav-number">4.9.1.</span> <span class="nav-text">参数说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动作说明"><span class="nav-number">4.9.2.</span> <span class="nav-text">动作说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#批量替换文件内容"><span class="nav-number">4.9.3.</span> <span class="nav-text">批量替换文件内容</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#用户"><span class="nav-number">5.</span> <span class="nav-text">用户</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#命令行操作"><span class="nav-number">6.</span> <span class="nav-text">命令行操作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#输出重定向"><span class="nav-number">7.</span> <span class="nav-text">输出重定向</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#输入重定向"><span class="nav-number">8.</span> <span class="nav-text">输入重定向</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#管道符"><span class="nav-number">9.</span> <span class="nav-text">管道符</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#逻辑与或"><span class="nav-number">9.1.</span> <span class="nav-text">逻辑与或</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#管道符-1"><span class="nav-number">9.2.</span> <span class="nav-text">管道符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#统配符"><span class="nav-number">9.3.</span> <span class="nav-text">统配符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#变量，反引号，"><span class="nav-number">9.4.</span> <span class="nav-text">变量，反引号，$()</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单小括号"><span class="nav-number">9.4.1.</span> <span class="nav-text">$() 单小括号</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell脚本"><span class="nav-number">10.</span> <span class="nav-text">shell脚本</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#查当前脚本所在路径"><span class="nav-number">10.1.</span> <span class="nav-text">查当前脚本所在路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#条件判断"><span class="nav-number">10.2.</span> <span class="nav-text">条件判断</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文件存在、权限判断"><span class="nav-number">10.2.1.</span> <span class="nav-text">文件存在、权限判断 [  ]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件比较"><span class="nav-number">10.2.2.</span> <span class="nav-text">文件比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#整数比较"><span class="nav-number">10.2.3.</span> <span class="nav-text">整数比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串比较"><span class="nav-number">10.2.4.</span> <span class="nav-text">字符串比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#与或非条件"><span class="nav-number">10.2.5.</span> <span class="nav-text">与或非条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#if语句"><span class="nav-number">10.2.6.</span> <span class="nav-text">if语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case语句"><span class="nav-number">10.2.7.</span> <span class="nav-text">case语句</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#for语句"><span class="nav-number">10.2.7.0.1.</span> <span class="nav-text">for语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#while语句"><span class="nav-number">10.2.7.0.2.</span> <span class="nav-text">while语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#until语句"><span class="nav-number">10.2.7.0.3.</span> <span class="nav-text">until语句</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#变量"><span class="nav-number">10.2.7.1.</span> <span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#变量叠加"><span class="nav-number">10.2.7.1.1.</span> <span class="nav-text">变量叠加</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-1-2的含义解释"><span class="nav-number">10.2.7.1.2.</span> <span class="nav-text">$@,$0,$1,$2的含义解释</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#点号"><span class="nav-number">10.2.7.1.3.</span> <span class="nav-text">点号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#语系变量locale"><span class="nav-number">10.2.7.1.4.</span> <span class="nav-text">语系变量locale</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#read"><span class="nav-number">10.2.7.1.5.</span> <span class="nav-text">read</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数值运算"><span class="nav-number">10.2.7.2.</span> <span class="nav-text">数值运算</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2-双小括号"><span class="nav-number">10.2.7.2.1.</span> <span class="nav-text">$(( $1+$2 ))  双小括号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#运算符-中括号"><span class="nav-number">10.2.7.2.2.</span> <span class="nav-text">$[运算符]` 中括号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#expr-aa-bb"><span class="nav-number">10.2.7.2.3.</span> <span class="nav-text">$(expr $aa + $bb)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#declare变量声明"><span class="nav-number">10.2.7.2.4.</span> <span class="nav-text">declare变量声明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#变量置换方式-y-新值-大括号，默认值"><span class="nav-number">10.2.7.2.5.</span> <span class="nav-text">变量置换方式 ${y-新值}大括号，默认值</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其它"><span class="nav-number">10.2.8.</span> <span class="nav-text">其它</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#更多资料："><span class="nav-number">10.2.9.</span> <span class="nav-text">更多资料：</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">周小伍 Joey</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">270.1k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://joeyblog.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2018/05/13/linux-commands/';
          this.page.identifier = '2018/05/13/linux-commands/';
          this.page.title = 'linux常用命令';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://joeyblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  










  





  

  

  

  

  

  

</body>
</html>
